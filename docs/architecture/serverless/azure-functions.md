---
title: Функции Azure — бессерверные приложения
description: Функции Azure предоставляют бессерверные возможности на нескольких языках (C#, JavaScript, Java) и платформах для обеспечения управляемого событиями кода мгновенного масштабирования.
author: JEREMYLIKNESS
ms.author: jeliknes
ms.date: 06/26/2018
ms.openlocfilehash: 8764e6a33f3fdd53e60fa767d0fb584a9c07de7e
ms.sourcegitcommit: cdf5084648bf5e77970cbfeaa23f1cab3e6e234e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "76920969"
---
# <a name="azure-functions"></a>Проверка

Функции Azure предоставляют бессерверные возможности вычислений. Функция вызывается *триггером* (например, доступ к конечной точке HTTP или срабатывание по таймеру) и выполняет блок кода или бизнес-логику. Функции также поддерживают специализированные *привязки*, которые подключаются к таким ресурсам, как хранилище и очереди.

![Логотип Функций Azure](./media/azure-functions-logo.png)

Существует две версии платформы "Функции Azure". Традиционная версия поддерживает полную.NET Framework, а новая среда выполнения — кроссплатформенные приложения .NET Core. Помимо C# поддерживаются дополнительные языки, такие как JavaScript, F# и Java. Функции, созданные на портале, предоставляют расширенный синтаксис написания скриптов. Функции, созданные как отдельные проекты, могут быть развернуты с полной поддержкой и возможностями платформы.

Дополнительные сведения см. в [документации по Функциям Azure](https://docs.microsoft.com/azure/azure-functions).

## <a name="functions-v1-vs-v2"></a>Функции версии 1 и 2

Существует две версии среды выполнения Функций Azure: 1.x и 2.x. Версия 1.x является общедоступной. Она поддерживает разработку на .NET на портале или на компьютерах с Windows и использует .NET Framework. Версия 1.x поддерживает C#, JavaScript и F#, а также в экспериментальном режиме Python, PHP, TypeScript, Batch, Bash и PowerShell.

[Версия 2.x также теперь общедоступна](https://azure.microsoft.com/blog/introducing-azure-functions-2-0/). Она использует .NET Core и поддерживает кроссплатформенную разработку на компьютерах с Windows, macOS и Linux. В версии 2.x добавлена первоклассная поддержка Java, но она пока еще не поддерживает ни один из экспериментальных языков. Версия 2.x использует новую модель расширяемости привязки, которая обеспечивает поддержку сторонних расширений для платформы, независимые версии привязок и более рациональную среду выполнения.

> **В версии 1.x существует известная ошибка с [поддержкой перенаправления привязки](https://github.com/Azure/azure-functions-host/issues/992).** Эта ошибка характерна для разработки на .NET. Она влияет на проекты с зависимостями от библиотек, версия которых отличается от библиотек, включенных в среду выполнения. Команда по разработке функций взяла на себя обязательство добиться конкретного прогресса в решении проблемы. Команда рассмотрит перенаправления привязки в версии 2.x, прежде чем она станет общедоступной. Официальное заявление команды с предлагаемыми исправлениями и решениями можно найти здесь: [Assembly resolution in Azure Functions](https://github.com/Azure/azure-functions-host/wiki/Assembly-Resolution-in-Azure-Functions) (Разрешение сборок в Функциях Azure).

Дополнительные сведения см. в статье [Azure Functions runtime versions overview](https://docs.microsoft.com/azure/azure-functions/functions-versions) (Обзор версий среды выполнения для решения "Функции Azure").

## <a name="programming-language-support"></a>Поддержка языков программирования

В общедоступной, предварительной и экспериментальной версиях поддерживаются следующие языки.

|Язык      |1.x         |2.x      |
|--------------|------------|---------|
|**C#**        |GA          |Предварительный просмотр  |
|**JavaScript**|GA          |Предварительный просмотр  |
|**F#**        |GA          |         |
|**Java**      |            |Предварительный просмотр  |
|**Python**    |Экспериментальный|         |
|**PHP**       |Экспериментальный|         |
|**TypeScript**|Экспериментальный|         |
|**Batch**     |Экспериментальный|         |
|**Bash**      |Экспериментальный|         |
|**PowerShell**|Экспериментальный|         |

Дополнительные сведения см. в [списке поддерживаемых языков](https://docs.microsoft.com/azure/azure-functions/supported-languages).

## <a name="app-service-plans"></a>Планы службы приложений

Функции поддерживаются *планом службы приложений*. План определяет ресурсы, используемые приложением-функцией. Можно назначить планы для региона, определить размер и количество используемых виртуальных машин, а также выбрать ценовую категорию. Для истинного бессерверного подхода в приложениях-функциях может использоваться план **потребления**. План потребления будет автоматически масштабировать серверную часть в зависимости от нагрузки.

Обзор планов Службы приложений Azure см. в [этой статье](https://docs.microsoft.com/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview).

## <a name="create-your-first-function"></a>Создание первой функции

Существует три стандартных способа создания приложений-функций.

- Создание скриптов для функций на портале.
- Создание требуемых ресурсов с помощью Azure CLI.
- Создание функций локально с помощью избранной интегрированной среды разработки и их публикация в Azure.

Дополнительные сведения о создании функции с помощью скрипта на портале см. в статье [Создание первой функции на портале Azure](https://docs.microsoft.com/azure/azure-functions/functions-create-first-azure-function).

Чтобы выполнить сборку с помощью Azure CLI, ознакомьтесь со статьей [Краткое руководство. Создание первой функции из командной строки с помощью Azure CLI](https://docs.microsoft.com/azure/azure-functions/functions-create-first-azure-function-azure-cli).

Сведения о создании функции из Visual Studio см. в статье [Создание первой функции с помощью Visual Studio](https://docs.microsoft.com/azure/azure-functions/functions-create-your-first-function-visual-studio).

## <a name="understand-triggers-and-bindings"></a>Общие сведения о триггерах и привязках

Функции вызываются *триггером* и могут иметь только один триггер. Помимо вызова функции определенные триггеры также выступают в качестве привязок. В дополнение к триггеру можно также определить несколько привязок. *Привязки* предоставляют декларативный способ подключения данных к коду. Они могут передаваться (входные) или получать данные (выходные). Триггеры и привязки упрощают работу с функциями. Привязки устраняют затраты на создание подключения к базе данных или файловой системе вручную. Вся информация, необходимая для привязок, содержится в специальном файле *functions.JSON* для скриптов или объявляется с атрибутами в коде.

Некоторые распространенные триггеры:

- хранилище BLOB-объектов: вызов функции, когда файл или папка передаются или изменяются в хранилище;
- HTTP: вызов функции, например REST API;
- очередь: вызов функции при наличии элементов в очереди;
- таймер: вызов функции регулярно.

Примеры привязок:

- CosmosDB: простое подключение к базе данных для передачи или сохранения файлов;
- Хранилище таблиц: работа с хранилищем пар "ключ — значение" из приложения-функции;
- Хранилище очередей: простое извлечение элементов из очереди или размещение новых элементов в очереди.

В следующем примере файла *functions.JSON* определены триггер и привязка:

```json
{
  "bindings": [
    {
      "name": "myBlob",
      "type": "blobTrigger",
      "direction": "in",
      "path": "images/{name}",
      "connection": "AzureWebJobsStorage"
    },
    {
      "name": "$return",
      "type": "queue",
      "direction": "out",
      "queueName": "images",
      "connection": "AzureWebJobsStorage"
    }
  ],
  "disabled": false
}
```

В этом примере функция активируется в результате внесения изменения в хранилище BLOB-объектов в контейнере `images`. Для файла передается информация, поэтому триггер также выступает в качестве привязки. Существует другая привязка для размещения информации в очереди с именем `images`.

Ниже приведен скрипт C# для функции.

```csharp
public static string Run(Stream myBlob, string name, TraceWriter log)
{
    log.Info($"C# Blob trigger function Processed blob\n Name:{name} \n Size: {myBlob.Length} Bytes");
    return name;
}
```

Этот пример представляет собой простую функцию, которая принимает имя файла, который был изменен или передан в хранилище BLOB-объектов, и помещает его в очередь для последующей обработки.

Полный список триггеров и привязок Функций Azure см. в [этой статье](https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings).

## <a name="proxies"></a>Прокси-элементы

Прокси-серверы обеспечивают функции перенаправления для приложения. Они предоставляют конечную точку и сопоставляют ее с другим ресурсом. С помощью прокси-серверов вы можете:

- Перенаправлять входящий запрос на другую конечную точку.
- Изменять входящий запрос, прежде чем он будет передан.
- Изменять или предоставлять ответ.

Прокси-серверы используются в следующих сценариях:

- Упрощение, сокращение или изменение URL-адреса.
- Обеспечение единообразного префикса API для нескольких серверных служб.
- Имитация ответа на разрабатываемую конечную точку.
- Предоставление статического ответа на хорошо известную конечную точку.
- Поддержание согласованности конечной точки API во время перемещения или переноса серверной части.

Прокси-серверы хранятся как определения JSON. Пример:

```json
{
  "$schema": "http://json.schemastore.org/proxies",
  "proxies": {
    "Domain Redirect": {
      "matchCondition": {
        "route": "/{shortUrl}"
      },
      "backendUri": "http://%WEBSITE_HOSTNAME%/api/UrlRedirect/{shortUrl}"
    },
    "Root": {
      "matchCondition": {
        "route": "/"
      },
      "responseOverrides": {
        "response.statusCode": "301",
        "response.statusReason": "Moved Permanently",
        "response.headers.location": "https://docs.microsoft.com/"
      }
    }
  }
}
```

Прокси-сервер `Domain Redirect` использует сокращенный маршрут и сопоставляет его с более длинным ресурсом функции. Преобразование выглядит следующим образом:

`https://--shorturl--/123` -> `https://--longurl--.azurewebsites.net/api/UrlRedirect/123`

Прокси-сервер `Root` получает все, что отправлено на корневой URL-адрес (`https://--shorturl--/`), и перенаправляет на сайт документации.

Пример использования прокси-серверов показан в видео [Azure: Bring your app to the cloud with serverless Azure Functions](https://channel9.msdn.com/events/Connect/2017/E102) (Перенос приложения в облако с помощью бессерверных Функций Azure). В режиме реального времени приложение ASP.NET Core, работающее на локальном SQL Server, переносится в облако Azure. Прокси-серверы помогают выполнить рефакторинг традиционного проекта веб-API для использования функций.

Дополнительные сведения о Прокси-серверах Функций Azure см. в [этой статье](https://docs.microsoft.com/azure/azure-functions/functions-proxies).

>[!div class="step-by-step"]
>[Назад](azure-serverless-platform.md)
>[Вперед](application-insights.md)
