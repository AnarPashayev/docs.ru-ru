---
title: Миграция Windows 10
description: Подробное углубление в таких функциях Windows 10, как упаковка и программирование XAML.
ms.date: 09/16/2019
ms.openlocfilehash: cd17088b086a32fd3bb37e617d3a1047acedde0e
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2020
ms.locfileid: "97866671"
---
# <a name="windows-10-migration"></a>Миграция Windows 10

Рассмотрим следующую ситуацию: у вас есть рабочее настольное приложение, разработанное в Windows 7 дней. Она использует технологию WPF, доступную в этот момент, и работает нормально, но имеет устаревший пользовательский интерфейс и поведение при запуске в Windows 10. Это похоже на просмотр футуристических фильма, такого как матрица, и вы видите Neo с помощью устройства Nokia 8110. Эта пленка работает отлично от 20 лет, но она, скорее всего, будет использовать модернизации устройства.

С выпуском Windows 10 Корпорация Майкрософт представила множество нововведений для поддержки таких сценариев, как планшеты и сенсорные устройства, и обеспечения оптимальной работы для пользователей операционной системы Майкрософт. Например, администратор может сделать следующее:

- Войдите с помощью Windows Hello, используя свое лицо.
- Используйте перо, чтобы нарисовать или вводить текст, который автоматически распознается и цифровым.
- Запустите локально настроенные модели AI, созданные в облаке с помощью WinML.

Все эти функции включены для разработчиков Windows с помощью библиотек среда выполнения Windows (WinRT). Вы можете воспользоваться преимуществами этих функций в существующих классических приложениях, так как библиотеки доступны также как для .NET Framework, так и для .NET Core. Вы даже можете модернизировать пользовательский интерфейс, используя острова XAML и улучшая визуальные элементы и поведение приложений в соответствии со временем.

Важно отметить, что нет необходимости отказаться от .NET Framework технологии, чтобы следовать этому пути модернизации. Вы можете спокойно остаться там и воспользоваться всеми преимуществами Windows 10 без необходимости перехода на .NET Core. Таким образом, вы получаете как мощь, так и гибкость, чтобы выбрать путь модернизации.

## <a name="winrt-apis"></a>API-интерфейсы WinRT

Интерфейсы API WinRT представляют собой объектно-ориентированные и хорошо структурированные прикладные программные интерфейсы (API), предоставляющие разработчикам Windows 10 доступ ко всем необходимым операционным системам. С помощью API-интерфейсов WinRT можно интегрировать такие функции, как push-уведомления, API-интерфейсы устройств, рукописный ввод Майкрософт и WinML, а также другие приложения для настольных приложений.

Как правило, API-интерфейсы WinRT можно вызывать из классического приложения для настольных систем. Тем не менее две основные области представляют исключение из этого правила:

* API, для которых требуется удостоверение пакета.
* API, для которых требуется визуализация, например XAML или композиция.

### <a name="universal-windows-platform-uwp-packages"></a>Пакеты универсальная платформа Windows (UWP)

#### <a name="application-package-identity"></a>Удостоверение пакета приложения

Приложения UWP имеют систему развертывания, в которой операционная система управляет установкой и удалением приложения. Для этого требуется декларативная установка, а это означает, что во время установки не выполняется пользовательский код. Вместо этого все, что приложение хочет интегрировать с системой, например протоколы, типы файлов и расширения, объявляется в манифесте приложения. Во время развертывания конвейер развертывания настраивает эти точки интеграции. Единственный способ, которым операционная система может управлять всеми этими функциями и контролировать ее, заключается в том, чтобы каждый "пакет" имел удостоверение, уникальный идентификатор приложения.

Для некоторых API-интерфейсов WinRT это удостоверение пакета должно работать должным образом. Однако классические приложения, такие как собственные приложения C++ или .NET, используют разные системы развертывания, для которых не требуется удостоверение пакета. Если вы хотите использовать эти API-интерфейсы WinRT в классическом приложении, необходимо предоставить им удостоверение пакета.

Один из способов продолжения — создать дополнительный проект упаковки. Внутри проекта упаковки укажите исходный проект исходного кода и укажите сведения об удостоверении, которые необходимо предоставить.Если вы устанавливаете пакет и запускаете установленное приложение, он автоматически получает идентификацию, позволяющую коду вызывать все API-интерфейсы WinRT, для которых требуется удостоверение.

```xml
<?xml version="1.0" encoding="utf-8"?>
<Package xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
         xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10">
    <Identity Name="YOUR-APP-GUID "
              Publisher="CN=YOUR COMPANY"
              Version="1.x.x.x" />
</Package>
```

Вы можете проверить, какие API требуют удостоверения упакованного приложения, проверив, помечен ли тип, содержащий API, атрибутом [дуалапипартитион](xref:Windows.Foundation.Metadata.DualApiPartitionAttribute) .Если это так, можно вызвать метод, если используется неупакованное традиционное классическое приложение. В противном случае вы должны преобразовать классическое приложение в UWP с помощью проекта упаковки.

<https://docs.microsoft.com/windows/desktop/apiindex/uwp-apis-callable-from-a-classic-desktop-app>

#### <a name="benefits-of-packaging"></a>Преимущества упаковки

Помимо предоставления доступа к этим API, вы получаете дополнительные преимущества, создавая пакет приложения Windows для настольного приложения, в том числе:

* **Упрощенное развертывание**. Приложения имеют отличное удобство развертывания, гарантируя, что пользователи могут уверенно устанавливать приложение и обновлять его. Если пользователь решает удалить приложение, он полностью удаляется без трассировки, которая не позволяет устранить проблему с Windows ROT.

* **Автоматическое обновление и лицензирование**. Приложение может участвовать в встроенных средствах лицензирования и автоматического обновления Microsoft Store. Автоматическое обновление — очень надежный и эффективный механизм, поскольку загружаются только измененные части файлов.

* **Увеличение аудитории и упрощение монетизации**. Возможно, это не так, но если вы решили распространить приложение с помощью Microsoft Store вы достигли миллионов пользователей Windows 10.

* **Добавление возможностей UWP**. Вы можете добавить функции UWP в пакет приложения в удобном для вас темпе.

#### <a name="prepare-for-packaging"></a>Подготовка к упаковке

Прежде чем приступить к упаковке классического приложения, необходимо устранить некоторые моменты, прежде чем начать процесс. Приложение должно учитывать любые правила и политики Microsoft Store и работать в модели приложений UWP. Например, он должен выполняться в .NET Framework 4.6.2 или более поздней версии и записывать в `HKEY_CURRENT_USER` куст реестра, а папки AppData будут виртуализированы в локальное расположение приложения, определяемое пользователем.

Целью разработки упаковки является отделение состояния приложения от состояния системы с сохранением совместимости с другими приложениями. Windows 10 достигает этой цели, помещая приложение в пакет UWP. Он обнаруживает и перенаправляет некоторые изменения в файловой системе и реестре во время выполнения, чтобы удовлетворить обещание надежного и чистого поведения установки и удаления приложения, предоставляемого пакетом.

Пакеты, создаваемые для настольного приложения, являются приложениями с полным доверием только для настольных систем, которые не являются изолированными, хотя к приложению применяется упрощенная виртуализация для операций записи в `HKCU` и `AppData` . Эта виртуализация позволяет им взаимодействовать с другими приложениями так же, как и классические приложения.

##### <a name="installation"></a>Установка

Пакеты приложений устанавливаются в папке *% ProgramFiles% \\ виндовсаппс \\ PACKAGE_NAME* с именем исполняемого файла  `app_name.exe` . Каждая папка пакета содержит манифест (с именем `AppxManifest.xml` ), содержащий специальное пространство имен XML для упакованных приложений. Внутри этого файла манифеста находится  `<EntryPoint>`   элемент, который ссылается на приложение с полным доверием. При запуске этого приложения оно не выполняется в контейнере приложения, а выполняется от имени пользователя как обычно.

После развертывания пакета файлы помечаются как доступные только для чтения и блокируются операционной системой. Windows не позволяет запускать приложения, если в эти файлы внесены несанкционированные изменения.

##### <a name="file-system"></a>Файловая система

ОПЕРАЦИОННАЯ система поддерживает различные уровни операций файловой системы для упакованных настольных приложений в зависимости от расположения папки.

При попытке доступа к папке *AppData* пользователя система создает частное расположение на уровне пользователя для каждого приложения в фоновом режиме. Это создает впечатление, что упакованное приложение изменяет реальную *AppData* , когда фактически изменяет закрытую копию. Перенаправляя операции записи таким образом, система может отслеживать все изменения, вносимые приложением в файлы. Затем они могут очищать все эти файлы при удалении системы с уменьшением количества системных «ROT» и улучшении процесса удаления приложений для пользователя.

##### <a name="registry"></a>Реестр

Пакеты приложений содержат файл Registry. dat, который служит логическим эквивалентом  `HKLM\Software`   в реальном реестре. Во время выполнения этот виртуальный реестр объединяет содержимое этого куста с собственным кустом системы, чтобы обеспечить их единообразное представление.

Все операции записи сохраняются во время обновления пакета и удаляются только при удалении приложения.

##### <a name="uninstallation"></a>Удаление

Когда пользователь удаляет пакет, все файлы и папки, расположенные в,  `C:\Program Files\WindowsApps\package_name` удаляются, а также перенаправляемые записи в AppData или реестр, записанные во время процесса.

Дополнительные сведения о том, как упакованное приложение обрабатывает установку, доступ к файлам, реестр и удаление, см. в разделе <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-behind-the-scenes> .

Вы можете получить полный список вещей для проверки <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-prepare> .

## <a name="how-to-add-winrt-apis-to-your-desktop-project"></a>Добавление API-интерфейсов WinRT в проект для настольных систем

В этом разделе можно найти пошаговое руководство по интеграции всплывающих уведомлений в существующее приложение WPF. Хотя это и просто с точки зрения кода, оно помогает проиллюстрировать весь процесс. Уведомления — это один из многих доступных API-интерфейсов WinRT, которые можно использовать в приложении .NET. В этом случае для API требуется удостоверение пакета. Этот процесс более прост, если интерфейсы API не нуждаются в удостоверении пакета.

Возьмем существующий пример приложения WPF, который считывает файлы и отображает его содержимое на экране. Целью является отображение всплывающего уведомления при запуске приложения.

![Снимок экрана с примером приложения](./media/windows-migration/sample-application.png)

Во-первых, следует вернуть следующую ссылку, требуется ли удостоверение пакета для интерфейса API Windows 10, который вы будете использовать:

<https://docs.microsoft.com/windows/apps/desktop/modernize/desktop-to-uwp-supported-api>

В нашем примере будет использоваться <xref:Windows.UI.Notifications.Notification?displayProperty=nameWithType> API, для которого требуется упакованное удостоверение:

![Класс уведомлений в документации Майкрософт](./media/windows-migration/notification-class-documentation.png)

Чтобы получить доступ к API WinRT, добавьте ссылку на `Microsoft.Windows.SDK.Contracts`   пакет NuGet, и этот пакет будет выполнять волшебное действие в фоновом режиме (см. подробности в разделе <https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/> ).

Теперь вы готовы приступить к добавлению кода.

Создайте `ShowToastNotification` метод, который будет вызываться при запуске приложения. Он просто создает всплывающее уведомление из XML-шаблона:

```csharp
private void ShowNotification(string title, string content, string image)
{
    string xmlString = $@"<toast><visual><binding template = 'ToastGeneric'><text>{title}</text><text>{content}</text><image src=>'{image}'</image></binding></visual></toast>";
    XmlDocument toastXml = new XmlDocument();
    toastXml.LoadXml(xmlString);
    ToastNotification toast = new ToastNotification(toastXml);
    ToastNotificationManager.CreateToastNotifier().Show(toast);
}
```

Несмотря на то, что сборка проекта выполняется, ошибки возникают из-за того, что API уведомлений требует удостоверения пакета и вы не предоставиле его. Чтобы устранить эту проблему, добавьте проект упаковки Windows в решение:

![Снимок экрана: диалоговое окно "Добавление нового проекта" в Visual Studio](./media/windows-migration/add-packaging-project.png)

Выберите минимальную версию Windows, которую требуется поддерживать, и версию, для которой выполняется настройка. Не все API-интерфейсы WinRT поддерживаются во всех версиях Windows 10. Каждое обновление Windows 10 добавляет новые API, которые доступны только из этой версии. поддержка нижнего уровня недоступна.

![Выбор минимальной версии Windows](./media/windows-migration/select-versions.png)

Следующим шагом является Добавление приложения WPF в проект упаковки Windows путем добавления ссылки на проект:

![Добавление приложения WPF в проект упаковки Windows](./media/windows-migration/add-application.png)

![Диспетчер ссылок](./media/windows-migration/reference-manager.png)

Проект упаковки Windows может упаковывать несколько приложений, поэтому следует задать, какой из них является точкой входа:

![Настройка точки входа](./media/windows-migration/set-entry-point.png)

Следующим шагом является установка проекта WPF в качестве запускаемого проекта в конфигурации решения. Можно нажать клавишу F5 для компиляции и построения и просмотра результатов.

![Пример приложения работает и отображает результаты](./media/windows-migration/sample-app-result.png)

Давайте создадим пакет, чтобы можно было установить приложение. Щелкните правой кнопкой мыши **магазин**  >  **создать пакеты приложений**.

![Диалоговое окно создания пакетов приложений](./media/windows-migration/create-app-packages.png)

Выберите вариант загрузки неопубликованных приложений, чтобы развернуть приложение с компьютера:

![Выбор варианта загрузки неопубликованных приложений](./media/windows-migration/select-sideloading-option.png)

Выберите архитектуру приложения для своего приложения:

![Выбор архитектуры приложения](./media/windows-migration/select-app-architecture.png)

Наконец, создайте пакет, щелкнув **создать**.

## <a name="xaml-islands"></a>XAML Islands

Острова XAML — это набор компонентов, позволяющих разработчикам классических приложений Windows использовать элементы управления XAML UWP в существующих приложениях Win32, включая Windows Forms и WPF.

![Структура островов XAML](./media/windows-migration/xaml-islands.png)

Вы можете создать образ приложения Win32, используя стандартные элементы управления, а также «остров» пользовательского интерфейса UWP, содержащего элементы управления из современного мира. Концепция похожа на веб-страницу, которая показывает содержимое из `different page.`

Помимо добавления функций из API Windows 10, вы можете добавлять элементы XAML UWP внутри приложения с помощью XAML-ва.

В обновлении Windows 10 1903 появился набор API-интерфейсов, позволяющих размещать содержимое XAML UWP в окнах Win32. Только приложения, работающие в Windows 10 1903, могут использовать острова XAML.

### <a name="the-road-to-xaml-islands"></a>Пути к островам XAML

Пути к островам XAML началися в 2012, когда корпорация Майкрософт представила API-интерфейсы WinRT в качестве платформы для модернизировать приложений Win32 (Windows Forms, WPF и собственных приложений Win32). Однако новые элементы управления пользовательского интерфейса в WinRT были доступны для новых приложений, но не для существующих.

В 2015 вместе с Windows 10 родился UWP. UWP позволяет создавать приложения, работающие на устройствах Windows, таких как XBox, Mobile и Desktop. Один год позже, корпорация Майкрософт объявила о настольном Bridge (прежнее название — Project Centennial). Desktop Bridge — это набор средств, которые позволяли разработчикам перенести существующие приложения Win32 в Microsoft Store. В 2017 были добавлены дополнительные возможности, позволяющие разработчикам усовершенствовать приложения Win32, использующие некоторые из новых API Windows 10, такие как живые плитки и уведомления в центре действий. Но все еще не новые элементы управления ИП.

В сборке 2018 Корпорация Майкрософт объявила о том, как разработчики могут использовать новые элементы управления XAML Windows 10 в своих текущих приложениях Win32 без полной миграции своих приложений в UWP. Оно было обозначено как острова UWP XAML.

### <a name="how-it-works"></a>Принцип работы

В обновлении Windows 10 1903 введено несколько API размещения XAML. Два из них: `WindowsXamlManager`   и  `DesktopWindowXamlSource` .

 `WindowsXamlManager`   Класс ОБРАБАТЫВАЕТ ПЛАТФОРМУ XAML UWP. Его `InitializeForCurrentThread` метод загружает ПЛАТФОРМУ XAML UWP в текущем потоке приложения Win32.

 `DesktopWindowXamlSource`   — Это экземпляр содержимого острова XAML. У него есть `Content` свойство, для которого вы отвечаете за создание экземпляра и настройку. Объект `DesktopWindowXamlSource`   визуализирует и получает свои входные данные из HWND. Ему необходимо определить, какой другой HWND будет прикрепляться к острову XAML, и вы несете ответственность за изменение размеров и размещение HWND родителя.

Разработчики WPF или Windows Forms обычно не работают с HWND внутри своего кода, поэтому может быть трудно понять и обработать указатели HWND и базовые провода для взаимодействия с платформами Win32 и UWP.

#### <a name="the-xaml-islands-net-wrappers"></a>Оболочки XAML острова .NET

В наборе средств Windows Community Toolkit предусмотрены наборы оболочек .NET для WPF или Windows Forms, упрощающие использование островов XAML. Эти оболочки управляют дескрипторами HWND, управлением фокусами, помимо прочего. Разработчики Windows Forms и WPF должны использовать эти оболочки.

Набор средств Windows Community Toolkit предлагает два типа элементов управления: обтекаемые элементы управления и элементы управления размещением.

##### <a name="wrapped-controls"></a>Обтекаемые элементы управления

Эти элементы управления с оболочкой заключают некоторые элементы управления UWP в Windows Forms или элементы управления WPF, скрывая основные понятия UWP для этих разработчиков. Эти элементы управления:

* WebView и Вебвиевкомпатибле
* InkCanvas и Инктулбар
* MediaPlayerElement
* MapControl

Добавьте `Microsoft.Toolkit.Wpf.UI.Controls` пакет в проект, включите ссылку на пространство имен и начните использовать их.

```xml
<Window
        ...
        xmlns:uwpControls="clr-namespace:Microsoft.Toolkit.Wpf.UI.Controls;assembly=Microsoft.Toolkit.Wpf.UI.Controls">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="\*"/>
    </Grid.RowDefinitions>
    <uwpControls:InkToolbar TargetInkCanvas="{x:Reference Name=inkCanvas}"/>
    <uwpControls:InkCanvas Grid.Row="1" x:Name="inkCanvas" />
</Grid>
```

##### <a name="hosting-controls"></a>Элементы управления размещением

Мощь островов XAML распространяется на большинство элементов управления первого производителя, сторонние элементы управления и пользовательские элементы управления, разработанные для UWP, которые можно интегрировать в Windows Forms и WPF как «острова» с полностью функциональным интерфейсом пользователя. `WindowsXamlHost`Элемент управления для WPF и Windows Forms позволяет сделать это.

Например, чтобы использовать `WindowsXamlHost` элемент управления в WPF, добавьте ссылку на `Microsoft.Toolkit.Wpf.UI.XamlHost` пакет, предоставляемый набором средств сообщества Windows.

После помещения `WindowsXamlHost` в код пользовательского интерфейса укажите тип UWP, который требуется загрузить. Можно выбрать использование упакованного элемента управления `Button` , например или более сложного, состоящего из нескольких различных элементов управления, которые являются настраиваемым элементом управления UWP.

В следующем примере показано, как добавить UWP `Button` :

```xml
<Window
        ...
        xmlns:xamlhost="clr-namespace:Microsoft.Toolkit.Wpf.UI.XamlHost;assembly=Microsoft.Toolkit.Wpf.UI.XamlHost">

<xamlhost:WindowsXamlHost x:Name="myUwpButton"
                          InitialTypeName="Windows.UI.Xaml.Controls.Button" />
```

Есть четкая рекомендация по подходу, и лучше иметь один и более крупный остров XAML, содержащий пользовательский составной элемент управления, чем несколько островов с одним элементом управления на каждом.

Одной из основных функций XAML является привязка, и она работает между кодом Win32 и островом. Таким образом, можно выполнить привязку, например, Win32 `Textbox` с UWP `Textbox` . Важно учитывать, что эти привязки являются односторонними привязками от UWP к Win32, поэтому при обновлении `Textbox` внутри кода XAML текстовое поле Win32 будет обновляться, но не наоборот.

Пошаговое руководство по использованию островов XAML см. в следующих статьях:

<https://docs.microsoft.com/windows/apps/desktop/modernize/host-standard-control-with-xaml-islands>

#### <a name="adding-uwp-xaml-custom-controls"></a>Добавление пользовательских элементов управления XAML UWP

Пользовательский элемент управления XAML — это элемент управления (или пользовательский элемент управления), созданный вами или третьими сторонами (включая элементы управления Винуи 2. x). Чтобы разместить пользовательский элемент управления UWP в Windows Forms или приложении WPF, вам потребуется:

- Для использования `WindowsXamlHost` элемента управления UWP в приложении .NET Core 3. x.
- Создание проекта приложения UWP, определяющего `XamlApplication` объект.

Проект WPF или Windows Forms должен иметь доступ к экземпляру `Microsoft.Toolkit.Win32.UI.XamlHost.XamlApplication` класса, предоставленного набором средств сообщества Windows. Этот объект выступает в качестве корневого поставщика метаданных для загрузки метаданных пользовательских типов универсального кода пользователя UWP в сборки в текущем каталоге приложения. Для этого рекомендуется добавить пустой проект приложения (универсальное приложение Windows) в то же решение, что и проект WPF или Windows Forms, и изменить класс приложения по умолчанию в этом проекте.

Пользовательское управление XAML UWP может быть включено в это приложение UWP или в независимый проект библиотеки классов UWP, на который вы ссылаетесь в том же решении, что и проект WPF или Windows Forms.

Подробное описание пошагового процесса можно узнать по адресу:

<https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands>

#### <a name="the-windows-ui-library-winui-2"></a>Библиотека пользовательского интерфейса Windows (Винуи 2)

Помимо входящих в систему элементов управления Windows 10, одна группа XAML UWP также доставляет дополнительные элементы управления в библиотеку пользовательского интерфейса Windows (**винуи 2**). Винуи 2 предоставляет официальные собственные элементы управления пользовательского интерфейса Майкрософт и функции для приложений Windows UWP, и эти элементы управления могут использоваться внутри островов XAML.

Винуи 2 — это открытый исходный код, и вы можете найти информацию по адресу <https://github.com/microsoft/microsoft-ui-xaml> .

В следующей статье показано, как разместить элемент управления XAML UWP из библиотеки Винуи 2: <https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands>

### <a name="do-you-need-xaml-islands"></a>Требуются острова XAML

Острова XAML предназначены для существующих приложений Win32, которые хотят улучшить взаимодействие с пользователем, используя новые элементы управления UWP и поведения без полной перезаписи приложения. Вы уже могли [использовать API Windows 10](/windows/uwp/porting/desktop-to-uwp-enhance), но вплоть до островов XAML — только интерфейсы API, не связанные с UI.

Если вы разрабатываете новое приложение Windows, то, вероятно [, это](/windows/uwp/get-started/universal-application-platform-guide)   правильный подход.

### <a name="the-road-ahead-xaml-islands-winui-30"></a>Предшествующие нам острова XAML: Винуи 3,0

Начиная с Windows 8, платформа пользовательского интерфейса Windows, включая платформу пользовательского интерфейса XAML, уровень визуальной композиции и обработку ввода, поставлялась как неотъемлемая часть Windows. Это означает, что чтобы воспользоваться преимуществами последних улучшений в технологиях пользовательского интерфейса, необходимо выполнить обновление до последней версии пользовательского интерфейса, что замедляет работу инноваций при разработке приложений. Для отделения этих двух циклов развития и совершенствования инноваций Корпорация Майкрософт активно работает над проектом Винуи.

Начиная с Винуи 2 в 2018 Корпорация Майкрософт приступила к отправке некоторых новых элементов управления и функций пользовательского интерфейса XAML в виде отдельных пакетов NuGet, которые создаются на основе пакета SDK для UWP.

![Структура Винуи 2,0](./media/windows-migration/winui2.png)

Винуи 3 находится под активной разработкой и значительно расширяет область Винуи для включения полной платформы пользовательского интерфейса, которая будет полностью отделена от пакета SDK для UWP:

![Структура Винуи 3,0](./media/windows-migration/winui3.png)

Платформа XAML теперь будет разрабатываться на сайте GitHub и поставляться с использованием аппаратного контроллера управления в качестве пакетов [NuGet](/nuget/what-is-nuget)   .

Существующие API XAML UWP, поставляемые в составе ОС, больше не будут получать обновления возможностей. Они по-прежнему получат обновления для системы безопасности и критические исправления в соответствии с жизненным циклом поддержки Windows 10.

Универсальная платформа Windows содержит не только платформу XAML (например, модель приложений и безопасности, конвейер носителей, интеграцию оболочки Xbox и Windows 10, широкие возможности поддержки устройств) и продолжат развиваться. Все новые функции XAML будут просто разработаны и поставляться как часть Винуи.

#### <a name="winui-3-in-desktop-app-and-winui-xaml-islands"></a>Винуи 3 в классических приложениях и Винуи о-ва XAML

Как видите, Винуи 3 — это эволюция XAML UWP, который естественным образом работает в модели приложения UWP и все его требования (MSIX пакетный идентификатор, песочница, CoreWindow и т. д.). Чтобы использовать только Винуи 3 в модели приложений Win32, содержимое Винуи должно размещаться в другой платформе пользовательского интерфейса (Windows Forms, WPF и т. д.) с помощью **Винуи островов XAML**. Это правильный путь, если вы хотите развивать свои приложения и технологии Mix. Однако если вы хотите заменить весь старый пользовательский интерфейс для Винуи, приложение не должно загружать платформы пользовательского интерфейса для простого размещения Винуи.

Винуи 3 будет решать эту критическую реакцию, добавляя **винуи в классические приложения**. Это позволит приложениям Win32 использовать Винуи 3 в качестве изолированной платформы пользовательского интерфейса. нет необходимости загружать Windows Forms или WPF.

В рамках этого агрегата Винуи 3 позволяет разработчикам легко сочетать и сопоставлять правильные сочетания:

* Модель приложения: UWP, Win32
* Платформа: .NET Core или native
* Язык: .NET (C \# , Visual Basic), Стандартный C++
* Упаковка: MSIX, AppX для Microsoft Store, распаковка
* Взаимодействие. Используйте Винуи 3 для расширения существующих приложений WPF, WinForms и MFC с помощью Винуи островов XAML.

Если вы хотите получить дополнительные сведения, корпорация Майкрософт попытается поделиться этой схемой в <https://github.com/microsoft/microsoft-ui-xaml/blob/master/docs/roadmap.md> .

>[!div class="step-by-step"]
>[Назад](migrate-modern-applications.md)
>[Вперед](example-migration-core.md)
