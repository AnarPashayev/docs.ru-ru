---
title: Развертывание существующих приложений .NET в качестве контейнеров Windows
description: Модернизация существующих приложений .NET с помощью облака Azure и контейнеров Windows | Развертывание существующих приложений .NET в качестве контейнеров Windows
ms.date: 04/29/2018
ms.openlocfilehash: 28568ca363bfc8100f78b100f8a7f0242c4f04c9
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2020
ms.locfileid: "73089560"
---
# <a name="deploy-existing-net-apps-as-windows-containers"></a><span data-ttu-id="5e348-103">Развертывание существующих приложений .NET в качестве контейнеров Windows</span><span class="sxs-lookup"><span data-stu-id="5e348-103">Deploy existing .NET apps as Windows containers</span></span>

<span data-ttu-id="5e348-104">Развертывания на основе контейнеров Windows применимы к оптимизированным для облака приложениям и полностью облачным приложениям.</span><span class="sxs-lookup"><span data-stu-id="5e348-104">Deployments that are based on Windows Containers are applicable to Cloud-Optimized applications and Cloud-Native applications.</span></span>

<span data-ttu-id="5e348-105">Однако в этом руководстве и особенно в следующих разделах основное внимание уделяется использованию контейнеров Windows для *оптимизированных для облака* приложений, для которых не требуется повторное проектирование.</span><span class="sxs-lookup"><span data-stu-id="5e348-105">However, in this guide and especially in the following sections, it mostly focuses on using Windows Containers for *Cloud-Optimized* applications where you don’t need to rearchitect your application.</span></span>

## <a name="what-are-containers-linux-or-windows"></a><span data-ttu-id="5e348-106">Что такое контейнеры</span><span class="sxs-lookup"><span data-stu-id="5e348-106">What are containers?</span></span> <span data-ttu-id="5e348-107">(Linux или Windows)</span><span class="sxs-lookup"><span data-stu-id="5e348-107">(Linux or Windows)</span></span>

<span data-ttu-id="5e348-108">Контейнеры предоставляют способ помещения приложения в собственный изолированный пакет.</span><span class="sxs-lookup"><span data-stu-id="5e348-108">Containers are a way to wrap up an application into its own isolated package.</span></span> <span data-ttu-id="5e348-109">На приложение не влияют приложения или процессы, которые существуют вне его контейнера.</span><span class="sxs-lookup"><span data-stu-id="5e348-109">In its container, the application is not affected by applications or processes that exist outside of the container.</span></span> <span data-ttu-id="5e348-110">Все, от чего зависит успешное выполнение приложения как процесса, находится внутри его контейнера.</span><span class="sxs-lookup"><span data-stu-id="5e348-110">Everything the application depends on to run successfully as a process is inside the container.</span></span> <span data-ttu-id="5e348-111">Всякий раз, когда контейнер перемещается, требования к приложению всегда будут выполнены с точки зрения прямых зависимостей, так как в нем содержится все, необходимое для выполнения приложения (зависимости библиотек, среды выполнения и т. д.).</span><span class="sxs-lookup"><span data-stu-id="5e348-111">Wherever the container might move, the requirements of the application will always be met, in terms of direct dependencies, because it is bundled with everything that it needs to run (library dependencies, runtimes, and so on).</span></span>

<span data-ttu-id="5e348-112">Основная характеристика контейнера заключается в том, что благодаря ему среда одинакова в разных развертываниях, так как сам контейнер поставляется со всеми необходимыми зависимостями.</span><span class="sxs-lookup"><span data-stu-id="5e348-112">The main characteristic of a container is that it makes the environment the same across different deployments because the container itself comes with all the dependencies it needs.</span></span> <span data-ttu-id="5e348-113">Можно отладить приложение на одном компьютере, а затем развернуть его на другом компьютере и получить ту же среду.</span><span class="sxs-lookup"><span data-stu-id="5e348-113">You can debug the application on your machine, and then deploy it to another machine, with the same environment guaranteed.</span></span>

<span data-ttu-id="5e348-114">Контейнер представляет собой экземпляр образа контейнера.</span><span class="sxs-lookup"><span data-stu-id="5e348-114">A container is an instance of a container image.</span></span> <span data-ttu-id="5e348-115">Образ контейнера — это способ упаковки приложения или службы (например, моментального снимка) для надежного и воспроизводимого развертывания.</span><span class="sxs-lookup"><span data-stu-id="5e348-115">A container image is a way to package an app or service (like a snapshot), and then deploy it in a reliable and reproducible way.</span></span> <span data-ttu-id="5e348-116">Можно сказать, что Docker является не только технологией, но и целой философией и процессом.</span><span class="sxs-lookup"><span data-stu-id="5e348-116">You could say that Docker is not only a technology-it's also a philosophy and a process.</span></span>

<span data-ttu-id="5e348-117">С ростом популярности контейнеров они становятся общеотраслевой "единицей развертывания".</span><span class="sxs-lookup"><span data-stu-id="5e348-117">As containers daily become more common, they are becoming an industry-wide "unit of deployment."</span></span>

## <a name="benefits-of-containers-docker-engine-on-linux-or-windows"></a><span data-ttu-id="5e348-118">Преимущества контейнеров (модуль Docker в Linux или Windows)</span><span class="sxs-lookup"><span data-stu-id="5e348-118">Benefits of containers (Docker Engine on Linux or Windows)</span></span>

<span data-ttu-id="5e348-119">Создание приложений с использованием контейнеров, которые также можно определить как компактные строительные блоки, значительно повышает гибкость при создании, доставке и запуске любого приложения в любой инфраструктуре.</span><span class="sxs-lookup"><span data-stu-id="5e348-119">Building applications by using containers-which also might be defined as lightweight building blocks-offers a significant increase in agility for building, shipping, and running any application, across any infrastructure.</span></span>

<span data-ttu-id="5e348-120">При использовании контейнеров можно перенести любое приложение из среды разработки в рабочую среду с минимальным объемом изменений кода или без них благодаря интеграции Docker со средствами разработчика Майкрософт, операционными системами и облаком.</span><span class="sxs-lookup"><span data-stu-id="5e348-120">With containers, you can take any app from development to production with little or no code change, thanks to Docker integration across Microsoft developer tools, operating systems, and cloud.</span></span>

<span data-ttu-id="5e348-121">У вас, вероятно, уже есть метод для развертывания приложений ASP.NET на обычных виртуальных машинах.</span><span class="sxs-lookup"><span data-stu-id="5e348-121">When you deploy to plain VMs, you probably already have a method in place for deploying ASP.NET apps to your VMs.</span></span> <span data-ttu-id="5e348-122">Однако вполне вероятно, что ваш метод включает в себя несколько шагов, выполняемых в ручном режиме, или сложные автоматизированные процессы с использованием средства развертывания, такого как Puppet или аналогичного.</span><span class="sxs-lookup"><span data-stu-id="5e348-122">It's likely, though, that your method involves multiple manual steps or complex automated processes by using a deployment tool like Puppet, or a similar tool.</span></span> <span data-ttu-id="5e348-123">Возможно, потребуется изменить элементы конфигурации, скопировать содержимое приложения между серверами и запустить интерактивные программы установки на основе конфигурации MSI-файла, а затем выполнить тестирование.</span><span class="sxs-lookup"><span data-stu-id="5e348-123">You might need to perform tasks like modifying configuration items, copying application content between servers, and running interactive setup programs based on .msi setups, followed by testing.</span></span> <span data-ttu-id="5e348-124">Все эти шаги в развертывании увеличивают время выполнения и риски возникновения сбоев развертывания.</span><span class="sxs-lookup"><span data-stu-id="5e348-124">All those steps in the deployment add time and risk to deployments.</span></span> <span data-ttu-id="5e348-125">Сбои будут возникать всякий раз, когда зависимость отсутствует в целевой среде.</span><span class="sxs-lookup"><span data-stu-id="5e348-125">You will get failures whenever a dependency is not present in the target environment.</span></span>

<span data-ttu-id="5e348-126">В контейнерах Windows процесс упаковки приложений полностью автоматизирован.</span><span class="sxs-lookup"><span data-stu-id="5e348-126">In Windows Containers, the process of packaging applications is fully automated.</span></span> <span data-ttu-id="5e348-127">Контейнеры Windows основаны на платформе Docker, которая предлагает автоматические обновления и откаты для развертываний контейнеров.</span><span class="sxs-lookup"><span data-stu-id="5e348-127">Windows Containers is based on the Docker platform, which offers automatic updates and rollbacks for container deployments.</span></span> <span data-ttu-id="5e348-128">Основное улучшение, которое обеспечивает модуль Docker, заключается в том, что вы создаете образы, которые похожи на мгновенные снимки вашего приложения со всеми его зависимостями.</span><span class="sxs-lookup"><span data-stu-id="5e348-128">The main improvement you get from using the Docker engine is that you create images, which are like snapshots of your application, with all its dependencies.</span></span> <span data-ttu-id="5e348-129">Это образы DOCKER (в данном случае образ контейнера Windows).</span><span class="sxs-lookup"><span data-stu-id="5e348-129">The images are Docker images (a Windows container image, in this case).</span></span> <span data-ttu-id="5e348-130">Образы запускают приложения ASP.NET в контейнерах, не возвращаясь к исходному коду.</span><span class="sxs-lookup"><span data-stu-id="5e348-130">The images run ASP.NET apps in containers, without going back to source code.</span></span> <span data-ttu-id="5e348-131">Моментальный снимок контейнера преобразуется в единицу развертывания.</span><span class="sxs-lookup"><span data-stu-id="5e348-131">The container snapshot becomes the unit of deployment.</span></span>

<span data-ttu-id="5e348-132">Многие организации контейнеризируют существующие монолитные приложения по следующим причинам:</span><span class="sxs-lookup"><span data-stu-id="5e348-132">Many organizations are containerizing existing monolithic applications for the following reasons:</span></span>

- <span data-ttu-id="5e348-133">**Гибкость выпуска за счет улучшенной функции развертывания**.</span><span class="sxs-lookup"><span data-stu-id="5e348-133">**Release agility through improved deployment**.</span></span> <span data-ttu-id="5e348-134">Контейнеры обеспечивают контракт о согласованном развертывании между процессами разработки и эксплуатации.</span><span class="sxs-lookup"><span data-stu-id="5e348-134">Containers offer a consistent deployment contract between development and operations.</span></span> <span data-ttu-id="5e348-135">При работе с контейнерами разработчики никогда не жалуются, что приложение работает только на локальном компьютере, но не в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="5e348-135">When you use containers, you won't hear developers say, "It works on my machine, why not in production?"</span></span> <span data-ttu-id="5e348-136">Они могут сказать: "приложение выполняется как контейнер, поэтому оно будет работать в рабочей среде".</span><span class="sxs-lookup"><span data-stu-id="5e348-136">They can say, "It runs as a container, so it will run in production."</span></span> <span data-ttu-id="5e348-137">Упакованное приложение со всеми его зависимостями можно выполнять в любой поддерживаемой среде на основе контейнера.</span><span class="sxs-lookup"><span data-stu-id="5e348-137">The packaged application, with all its dependencies, can be executed in any supported container-based environment.</span></span> <span data-ttu-id="5e348-138">Оно будет работать должным образом во всех целевых средах развертывания (разработки, контроля качества, промежуточной и рабочей).</span><span class="sxs-lookup"><span data-stu-id="5e348-138">It will run the way it was intended to run in all deployment targets (dev, QA, staging, production).</span></span> <span data-ttu-id="5e348-139">Контейнеры устраняют большинство трудностей, которые возникают при перемещении с одного этапа на другой, что значительно улучшает эффективность развертывания и позволяет ускорить поставку.</span><span class="sxs-lookup"><span data-stu-id="5e348-139">Containers eliminate most frictions when they move from one stage to the next, which greatly improves deployment, and you can ship faster.</span></span>

- <span data-ttu-id="5e348-140">**Сокращение расходов**.</span><span class="sxs-lookup"><span data-stu-id="5e348-140">**Cost reductions**.</span></span> <span data-ttu-id="5e348-141">Контейнеры позволяют снизить затраты за счет консолидации и удаления существующего оборудования либо выполнения приложений с более высокой плотностью на единицу оборудования.</span><span class="sxs-lookup"><span data-stu-id="5e348-141">Containers lead to lower costs, either by the consolidation and removal of existing hardware, or from running applications at a higher density per unit of hardware.</span></span>

- <span data-ttu-id="5e348-142">**Мобильность.**</span><span class="sxs-lookup"><span data-stu-id="5e348-142">**Portability**.</span></span> <span data-ttu-id="5e348-143">Контейнеры являются модульными и переносимыми.</span><span class="sxs-lookup"><span data-stu-id="5e348-143">Containers are modular and portable.</span></span> <span data-ttu-id="5e348-144">Контейнеры Docker поддерживаются в любой серверной операционной системе (Linux и Windows), в любом крупном публичном облаке (Microsoft Azure, Amazon AWS, Google и IBM), а также в локальных, частных или гибридных облачных средах.</span><span class="sxs-lookup"><span data-stu-id="5e348-144">Docker containers are supported on any server operating system (Linux and Windows), in any major public cloud (Microsoft Azure, Amazon AWS, Google, IBM), and in on-premises and private or hybrid cloud environments.</span></span>

- <span data-ttu-id="5e348-145">**Контроль**.</span><span class="sxs-lookup"><span data-stu-id="5e348-145">**Control**.</span></span> <span data-ttu-id="5e348-146">Контейнеры обеспечивают гибкую и безопасную среду, контролируемую на уровне контейнера.</span><span class="sxs-lookup"><span data-stu-id="5e348-146">Containers offer a flexible and secure environment that's controlled at the container level.</span></span> <span data-ttu-id="5e348-147">Контейнер можно защитить, изолировать и даже ограничить путем установки политик ограничения выполнения в контейнере.</span><span class="sxs-lookup"><span data-stu-id="5e348-147">A container can be secured, isolated, and even limited by setting execution constraint policies on the container.</span></span> <span data-ttu-id="5e348-148">Как описано в разделе о контейнерах Windows, контейнеры Windows Server 2016 и Hyper-V предлагают дополнительные варианты корпоративной поддержки.</span><span class="sxs-lookup"><span data-stu-id="5e348-148">As detailed in the section about Windows Containers, Windows Server 2016 and Hyper-V containers offer additional enterprise support options.</span></span>

<span data-ttu-id="5e348-149">Значительные улучшения в аспектах гибкости, переносимости и управления в конечном счете приводят к значительному снижению затрат при использовании контейнеров для разработки и обслуживания приложений.</span><span class="sxs-lookup"><span data-stu-id="5e348-149">Significant improvements in agility, portability, and control ultimately lead to significant cost reductions when you use containers to develop and maintain applications.</span></span>

## <a name="what-is-docker"></a><span data-ttu-id="5e348-150">Что такое Docker?</span><span class="sxs-lookup"><span data-stu-id="5e348-150">What is Docker?</span></span>

<span data-ttu-id="5e348-151">[Docker](https://www.docker.com/) — это [проект с открытым исходным кодом](https://github.com/docker/docker) для автоматизации развертывания приложений в виде переносимых автономных контейнеров, выполняемых в облаке или локальной среде.</span><span class="sxs-lookup"><span data-stu-id="5e348-151">[Docker](https://www.docker.com/) is an [open-source project](https://github.com/docker/docker) that automates the deployment of applications as portable, self-sufficient containers that can run in the cloud or on-premises.</span></span> <span data-ttu-id="5e348-152">Docker — это также [компания](https://www.docker.com/), разрабатывающая эту технологию.</span><span class="sxs-lookup"><span data-stu-id="5e348-152">Docker is also a [company](https://www.docker.com/) that promotes and evolves this technology.</span></span> <span data-ttu-id="5e348-153">Компания работает в сотрудничестве с поставщиками облачных технологий и приложений для Linux и Windows, включая Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="5e348-153">The company works in collaboration with cloud, Linux, and Windows vendors, including Microsoft.</span></span>

![Схема, показывающая, как среда Docker развертывает контейнеры в гибридном облаке.](./media/deploy-existing-net-apps-as-windows-containers/docker-deploys-containers-all-layers.png)

<span data-ttu-id="5e348-155">**Рис. 4-6.**</span><span class="sxs-lookup"><span data-stu-id="5e348-155">**Figure 4-6.**</span></span> <span data-ttu-id="5e348-156">Docker развертывает контейнеры на всех уровнях гибридного облака</span><span class="sxs-lookup"><span data-stu-id="5e348-156">Docker deploys containers at all layers of the hybrid cloud</span></span>

<span data-ttu-id="5e348-157">Для пользователей, знакомых с виртуальными машинами, контейнеры могут показаться похожими.</span><span class="sxs-lookup"><span data-stu-id="5e348-157">To someone familiar with virtual machines, containers might appear to be remarkably similar.</span></span> <span data-ttu-id="5e348-158">Контейнер работает под управлением операционной системы, содержит файловую систему, и к нему можно получить сетевой доступ, чем он напоминает физический или виртуальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="5e348-158">A container runs an operating system, has a file system, and can be accessed over a network, just like a physical or virtual computer system.</span></span> <span data-ttu-id="5e348-159">Однако у контейнеров и виртуальных машин совершенно разные технология и принцип работы.</span><span class="sxs-lookup"><span data-stu-id="5e348-159">However, the technology and concepts behind containers are vastly different from virtual machines.</span></span> <span data-ttu-id="5e348-160">С точки зрения разработчика контейнер должен рассматриваться скорее как единый процесс.</span><span class="sxs-lookup"><span data-stu-id="5e348-160">From a developer point of view, a container must be treated more like a single process.</span></span> <span data-ttu-id="5e348-161">Фактически контейнер имеет единую точку входа для каждого процесса.</span><span class="sxs-lookup"><span data-stu-id="5e348-161">In fact, a container has a single entry point for one process.</span></span>

<span data-ttu-id="5e348-162">Контейнеры Docker (или просто *контейнеры*) работают в исходном формате в Linux и Windows.</span><span class="sxs-lookup"><span data-stu-id="5e348-162">Docker containers (for simplicity, *containers*) can run natively on Linux and Windows.</span></span> <span data-ttu-id="5e348-163">Обычные контейнеры Windows могут работать только на узлах Windows (сервер узла или виртуальная машина), а обычные контейнеры Linux могут работать только на узлах Linux.</span><span class="sxs-lookup"><span data-stu-id="5e348-163">When running regular containers, Windows containers can run only on Windows hosts (a host server or a VM), and Linux containers can run only on Linux hosts.</span></span> <span data-ttu-id="5e348-164">Однако в последних версиях контейнеров Windows Server и Hyper-V контейнер Linux также может работать на Windows Server благодаря технологии изоляции Hyper-V, которая в настоящее время доступна только при использовании контейнеров Windows Server.</span><span class="sxs-lookup"><span data-stu-id="5e348-164">However, in recent versions of Windows Server and Hyper-V containers, a Linux container also can run natively on Windows Server by using the Hyper-V isolation technology that currently is available only in Windows Server Containers.</span></span>

<span data-ttu-id="5e348-165">В ближайшем будущем смешанные среды, содержащие контейнеры Linux и Windows, станут возможными и даже распространенными.</span><span class="sxs-lookup"><span data-stu-id="5e348-165">In the near future, mixed environments that have both Linux and Windows containers will be possible and even common.</span></span>

## <a name="benefits-of-windows-containers-for-your-existing-net-applications"></a><span data-ttu-id="5e348-166">Преимущества контейнеров Windows для имеющихся приложений .NET</span><span class="sxs-lookup"><span data-stu-id="5e348-166">Benefits of Windows Containers for your existing .NET applications</span></span>

<span data-ttu-id="5e348-167">Преимущества использования контейнеров Windows в основном аналогичны получаемым от контейнеров в целом.</span><span class="sxs-lookup"><span data-stu-id="5e348-167">The benefits of using Windows Containers are fundamentally the same benefits you get from containers in general.</span></span> <span data-ttu-id="5e348-168">Использование контейнеров Windows значительно повышает гибкость, мобильность и эффективность управления.</span><span class="sxs-lookup"><span data-stu-id="5e348-168">Using Windows Containers is about greatly improving agility, portability, and control.</span></span>

<span data-ttu-id="5e348-169">Имеющиеся приложения .NET относятся к приложениям, созданным с помощью платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="5e348-169">Existing .NET applications refer to those applications that were created using the .NET Framework.</span></span> <span data-ttu-id="5e348-170">Например, это могут быть традиционные веб-приложения ASP.NET, не использующие платформу .NET Core, которая является более новой и работает на платформах Linux, Windows и MacOS.</span><span class="sxs-lookup"><span data-stu-id="5e348-170">For example, they might be traditional ASP.NET web applications-they don't use .NET Core, which is newer and runs cross-platform on Linux, Windows, and MacOS.</span></span>

<span data-ttu-id="5e348-171">Основной зависимостью в .NET Framework является Windows.</span><span class="sxs-lookup"><span data-stu-id="5e348-171">The main dependency in the .NET Framework is Windows.</span></span> <span data-ttu-id="5e348-172">Есть также дополнительные зависимости, например IIS и System.Web в традиционной платформе ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5e348-172">It also has secondary dependencies, like IIS, and System.Web in traditional ASP.NET.</span></span>

<span data-ttu-id="5e348-173">Приложение .NET Framework должно работать в Windows.</span><span class="sxs-lookup"><span data-stu-id="5e348-173">A .NET Framework application must run on Windows, period.</span></span> <span data-ttu-id="5e348-174">Если вы хотите контейнеризировать имеющиеся приложения .NET Framework и не можете или не хотите инвестировать в миграцию в .NET Core (если приложение работает правильно, не переносите его), единственный вариант — использовать контейнеры Windows.</span><span class="sxs-lookup"><span data-stu-id="5e348-174">If you want to containerize existing .NET Framework applications and you can't or don't want to invest in a migration to .NET Core ("If it works properly, don't migrate it"), the only choice you have for containers is to use Windows Containers.</span></span>

<span data-ttu-id="5e348-175">Таким образом, одним из основных преимуществ контейнеров Windows является то, что они предлагают способ модернизации имеющихся приложений .NET Framework, работающих с использованием контейнеризации в Windows.</span><span class="sxs-lookup"><span data-stu-id="5e348-175">So, one of the main benefits of Windows Containers is that they offer you a way to modernize your existing .NET Framework applications that are running on Windows-through containerization.</span></span> <span data-ttu-id="5e348-176">В конечном счете, контейнеры Windows обеспечивают требуемые преимущества — гибкость, мобильность и более эффективное управление.</span><span class="sxs-lookup"><span data-stu-id="5e348-176">Ultimately, Windows Containers gets you the benefits that you are looking for by using containers-agility, portability, and better control.</span></span>

## <a name="choose-an-os-to-target-with-net-based-containers"></a><span data-ttu-id="5e348-177">Выбор целевой ОС для контейнеров на основе .NET</span><span class="sxs-lookup"><span data-stu-id="5e348-177">Choose an OS to target with .NET-based containers</span></span>

<span data-ttu-id="5e348-178">Учитывая разнообразие операционных систем, поддерживаемых Docker, и различия между .NET Framework и .NET Core, следует выбирать определенные ОС и определенные версии в зависимости от используемой платформы.</span><span class="sxs-lookup"><span data-stu-id="5e348-178">Given the diversity of operating systems that are supported by Docker, as well as the differences between .NET Framework and .NET Core, you should target a specific OS and specific versions based on the framework you are using.</span></span>

<span data-ttu-id="5e348-179">Для Windows можно использовать Windows Server Core или Windows Nano Server.</span><span class="sxs-lookup"><span data-stu-id="5e348-179">For Windows, you can use Windows Server Core or Windows Nano Server.</span></span> <span data-ttu-id="5e348-180">Эти версии Windows предоставляют разные особенности (например, IIS или резидентный веб-сервер, такой как Kestrel), которые могут быть необходимы в приложениях .NET Framework или .NET Core соответственно.</span><span class="sxs-lookup"><span data-stu-id="5e348-180">These Windows versions provide different characteristics (like IIS versus a self-hosted web server like Kestrel) that might be needed by .NET Framework or .NET Core applications.</span></span>

<span data-ttu-id="5e348-181">Для Linux доступно и поддерживается множество дистрибутивов в официальных образах Docker .NET (например, Debian).</span><span class="sxs-lookup"><span data-stu-id="5e348-181">For Linux, multiple distros are available and supported in official .NET Docker images (like Debian).</span></span>

<span data-ttu-id="5e348-182">На рис. 4-7 показаны версии ОС, которые можно настроить как целевые в зависимости от версии .NET Framework приложения.</span><span class="sxs-lookup"><span data-stu-id="5e348-182">Figure 4-7 shows OS versions that you can target, depending on the app's version of the .NET Framework.</span></span>

![Схема, показывающая, на какую ОС ориентироваться на основе версии .NET Framework.](./media/deploy-existing-net-apps-as-windows-containers/dotnet-framework-operating-systems.png)

<span data-ttu-id="5e348-184">**Рис. 4-7**.</span><span class="sxs-lookup"><span data-stu-id="5e348-184">**Figure 4-7.**</span></span> <span data-ttu-id="5e348-185">Схема, показывающая, на какую ОС ориентироваться на основе версии .NET Framework</span><span class="sxs-lookup"><span data-stu-id="5e348-185">Operating systems to target based on .NET Framework version</span></span>

<span data-ttu-id="5e348-186">В сценариях миграции имеющихся приложений или приложений прежних версий, основанных на приложениях .NET Framework, основными зависимостями являются Windows и IIS.</span><span class="sxs-lookup"><span data-stu-id="5e348-186">In migration scenarios for existing or legacy applications that are based on .NET Framework applications, the main dependencies are on Windows and IIS.</span></span> <span data-ttu-id="5e348-187">Единственным вариантом является использование образов Docker на основе Windows Server Core и платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="5e348-187">Your only option is to use Docker images based on Windows Server Core and the .NET Framework.</span></span>

<span data-ttu-id="5e348-188">При добавлении имени образа в файл Dockerfile можно выбрать операционную систему и версию, используя тег, как показано в следующих примерах для образов контейнера Windows на базе .NET Framework:</span><span class="sxs-lookup"><span data-stu-id="5e348-188">When you add the image name to your Dockerfile file, you can select the operating system and version by using a tag, as in the following examples for .NET Framework-based Windows container images:</span></span>

> | <span data-ttu-id="5e348-189">**Тег**</span><span class="sxs-lookup"><span data-stu-id="5e348-189">**Tag**</span></span> | <span data-ttu-id="5e348-190">**Система и версия**</span><span class="sxs-lookup"><span data-stu-id="5e348-190">**System and version**</span></span> |
> |---|---|
> | <span data-ttu-id="5e348-191">**microsoft/dotnet-framework:4.x-windowsservercore**</span><span class="sxs-lookup"><span data-stu-id="5e348-191">**microsoft/dotnet-framework:4.x-windowsservercore**</span></span> | <span data-ttu-id="5e348-192">.NET Framework 4.x в Windows Server Core</span><span class="sxs-lookup"><span data-stu-id="5e348-192">.NET Framework 4.x on Windows Server Core</span></span> |
> | <span data-ttu-id="5e348-193">**microsoft/aspnet:4.x-windowsservercore**</span><span class="sxs-lookup"><span data-stu-id="5e348-193">**microsoft/aspnet:4.x-windowsservercore**</span></span> | <span data-ttu-id="5e348-194">.NET Framework 4. x с дополнительной настройкой ASP.NET в Windows Server Core</span><span class="sxs-lookup"><span data-stu-id="5e348-194">.NET Framework 4.x with additional ASP.NET customization, on Windows Server Core</span></span> |

<span data-ttu-id="5e348-195">Для .NET Core (кроссплатформенные приложения для Linux и Windows) теги будут выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5e348-195">For .NET Core (cross-platform for Linux and Windows), the tags would look like the following:</span></span>

> | <span data-ttu-id="5e348-196">**Тег**</span><span class="sxs-lookup"><span data-stu-id="5e348-196">**Tag**</span></span> | <span data-ttu-id="5e348-197">**Система и версия**</span><span class="sxs-lookup"><span data-stu-id="5e348-197">**System and version**</span></span>
> |---|---|
> | <span data-ttu-id="5e348-198">**microsoft/dotnet:2.0.0-runtime**</span><span class="sxs-lookup"><span data-stu-id="5e348-198">**microsoft/dotnet:2.0.0-runtime**</span></span> | <span data-ttu-id="5e348-199">Среда выполнения .NET Core 2.0, только в Linux</span><span class="sxs-lookup"><span data-stu-id="5e348-199">.NET Core 2.0 runtime-only on Linux</span></span> |
> | <span data-ttu-id="5e348-200">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span><span class="sxs-lookup"><span data-stu-id="5e348-200">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span></span> | <span data-ttu-id="5e348-201">Среда выполнения .NET Core 2.0, только в Windows Nano Server</span><span class="sxs-lookup"><span data-stu-id="5e348-201">.NET Core 2.0 runtime-only on Windows Nano Server</span></span> |

### <a name="multi-arch-images"></a><span data-ttu-id="5e348-202">Мультиархитектурный образ</span><span class="sxs-lookup"><span data-stu-id="5e348-202">Multi-arch images</span></span>

<span data-ttu-id="5e348-203">Начиная с середины 2017 года в Docker можно также использовать новую функцию, называемую [мультиархитектурные образы](https://github.com/moby/moby/issues/15866).</span><span class="sxs-lookup"><span data-stu-id="5e348-203">Beginning in mid-2017, you also can use a new feature in Docker called [multi-arch](https://github.com/moby/moby/issues/15866) images.</span></span> <span data-ttu-id="5e348-204">Образы Docker в .NET Core могут использовать мультиархитектурные теги.</span><span class="sxs-lookup"><span data-stu-id="5e348-204">.NET Core Docker images can use multi-arch tags.</span></span> <span data-ttu-id="5e348-205">В файлах Dockerfile больше не нужно определять целевую операционную систему.</span><span class="sxs-lookup"><span data-stu-id="5e348-205">Your Dockerfile files no longer need to define the operating system that you are targeting.</span></span> <span data-ttu-id="5e348-206">Функция мультиархитектурности позволяет использовать один тег в нескольких конфигурациях компьютера.</span><span class="sxs-lookup"><span data-stu-id="5e348-206">The multi-arch feature allows a single tag to be used across multiple machine configurations.</span></span> <span data-ttu-id="5e348-207">Например, эта функция позволяет использовать один общий тег: **microsoft/dotnet:2.0.0-runtime**.</span><span class="sxs-lookup"><span data-stu-id="5e348-207">For instance, with multi-arch, you can use one common tag: **microsoft/dotnet:2.0.0-runtime**.</span></span> <span data-ttu-id="5e348-208">Если извлечь этот тег из среды контейнеров Linux, вы получите образ на основе Debian.</span><span class="sxs-lookup"><span data-stu-id="5e348-208">If you pull that tag from a Linux container environment, you get the Debian-based image.</span></span> <span data-ttu-id="5e348-209">Если извлечь этот тег из среды контейнеров Windows, вы получите образ на основе Nano Server.</span><span class="sxs-lookup"><span data-stu-id="5e348-209">If you pull that tag from a Windows container environment, you get the Nano Server-based image.</span></span>

<span data-ttu-id="5e348-210">Так как традиционная платформа .NET Framework поддерживает только Windows, для образов .NET Framework функцию мультиархитектурности использовать нельзя.</span><span class="sxs-lookup"><span data-stu-id="5e348-210">For .NET Framework images, because the traditional .NET Framework supports only Windows, you cannot use the multi-arch feature.</span></span>

## <a name="windows-container-types"></a><span data-ttu-id="5e348-211">Типы контейнеров Windows</span><span class="sxs-lookup"><span data-stu-id="5e348-211">Windows container types</span></span>

<span data-ttu-id="5e348-212">Как и в случае с контейнерами Linux, управление контейнерами Windows Server осуществляется с помощью модуля Docker.</span><span class="sxs-lookup"><span data-stu-id="5e348-212">Like Linux containers, Windows Server containers are managed by using Docker Engine.</span></span> <span data-ttu-id="5e348-213">В отличие от контейнеров Linux, контейнеры Windows включают в себя два различных типа контейнеров или среды выполнения — контейнеры Windows Server и изоляцию Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="5e348-213">Unlike Linux containers, Windows containers include two different container types, or run times-Windows Server containers and Hyper-V isolation.</span></span>

<span data-ttu-id="5e348-214">**Контейнеры Windows Server**: изолируют приложение с помощью технологии изоляции процесса и пространства имен.</span><span class="sxs-lookup"><span data-stu-id="5e348-214">**Windows Server containers**: Provides application isolation through process and namespace isolation technology.</span></span> <span data-ttu-id="5e348-215">Контейнер Windows Server использует ядро совместно с узлом контейнеров и всеми остальными контейнерами на узле.</span><span class="sxs-lookup"><span data-stu-id="5e348-215">A Windows Server container shares a kernel with the container host and all containers that are running on the host.</span></span> <span data-ttu-id="5e348-216">Эти контейнеры не обеспечивают надежную границу безопасности и не должны использоваться для изоляции ненадежного кода.</span><span class="sxs-lookup"><span data-stu-id="5e348-216">These containers do not provide a hostile security boundary and should not be used to isolate untrusted code.</span></span> <span data-ttu-id="5e348-217">Из-за общего пространства ядра для этих контейнеров требуется одинаковая версия ядра и конфигурация.</span><span class="sxs-lookup"><span data-stu-id="5e348-217">Because of the shared kernel space, these containers require the same kernel version and configuration.</span></span>

<span data-ttu-id="5e348-218">**Изоляция Hyper-V**: увеличивает изоляцию, обеспеченную контейнерами Windows Server, запуская каждый контейнер в оптимизированной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="5e348-218">**Hyper-V isolation**: Expands on the isolation provided by Windows Server Containers by running each container on a highly optimized VM.</span></span> <span data-ttu-id="5e348-219">В этой конфигурации ядро узла контейнера не используется совместно с другими контейнерами на том же узле.</span><span class="sxs-lookup"><span data-stu-id="5e348-219">In this configuration, the kernel of the container host is not shared with other containers on the same host.</span></span> <span data-ttu-id="5e348-220">Эти контейнеры предназначены для неблагоприятных мультитенантных размещений с аналогичными гарантиями безопасности виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5e348-220">These containers are designed for hostile multitenant hosting, with the same security assurances of a VM.</span></span> <span data-ttu-id="5e348-221">Так как эти контейнеры не используют ядро совместно с узлом или другими контейнерами на узле, они могут запускать ядра с различными версиями и конфигурациями (с поддерживаемыми версиями).</span><span class="sxs-lookup"><span data-stu-id="5e348-221">Because these containers don't share the kernel with the host or other containers on the host, they can run kernels with different versions and configurations (with supported versions).</span></span> <span data-ttu-id="5e348-222">Например, все контейнеры Windows в Windows 10 реализуют изоляцию Hyper-V для использования версии ядра и конфигурации Windows Server.</span><span class="sxs-lookup"><span data-stu-id="5e348-222">For example, all Windows containers on Windows 10 use Hyper-V isolation to utilize the Windows Server kernel version and configuration.</span></span>

<span data-ttu-id="5e348-223">Решение о запуске контейнера в Windows с изоляцией Hyper-V или без нее принимается во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e348-223">Running a container on Windows with or without Hyper-V isolation is a run-time decision.</span></span> <span data-ttu-id="5e348-224">Сначала можно создать контейнер с изоляцией Hyper-V, а во время выполнения запустить этот контейнер в качестве контейнера Windows Server.</span><span class="sxs-lookup"><span data-stu-id="5e348-224">You might choose to create the container with Hyper-V isolation initially, and at run time, choose to run it as a Windows Server container instead.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5e348-225">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="5e348-225">Additional resources</span></span>

- <span data-ttu-id="5e348-226">**Документация по контейнерам Windows**</span><span class="sxs-lookup"><span data-stu-id="5e348-226">**Windows Containers documentation**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/>

- <span data-ttu-id="5e348-227">**Основы контейнеров Windows**</span><span class="sxs-lookup"><span data-stu-id="5e348-227">**Windows Containers fundamentals**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/about/>

- <span data-ttu-id="5e348-228">**Infographic: Майкрософт и контейнеры**</span><span class="sxs-lookup"><span data-stu-id="5e348-228">**Infographic: Microsoft and containers**</span></span>

    <https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf>

## <a name="the-container-ecosystem-in-azure"></a><span data-ttu-id="5e348-229">Экосистема контейнеров в Azure</span><span class="sxs-lookup"><span data-stu-id="5e348-229">The container ecosystem in Azure</span></span>

<span data-ttu-id="5e348-230">В предыдущих разделах рассмотрены преимущества контейнеров Docker, а также подробно описаны конкретные образы контейнеров для приложений .NET.</span><span class="sxs-lookup"><span data-stu-id="5e348-230">In previous sections, it’s been explained what the benefits of Docker containers are as well as details on the specific container images for .NET applications.</span></span> <span data-ttu-id="5e348-231">Вся эта общая информация является основополагающей для разработки или контейнеризации приложения.</span><span class="sxs-lookup"><span data-stu-id="5e348-231">All that generic information is fundamental in order to develop or containerize an application.</span></span>
<span data-ttu-id="5e348-232">Однако при рассмотрении рабочей среды развертывания или сред контроля качества, разработки и тестирования Microsoft Azure предоставляет открытый и широкий выбор вариантов, полную экосистему контейнеров в облаке (показано на схеме ниже).</span><span class="sxs-lookup"><span data-stu-id="5e348-232">However, when thinking about the production deployment environment or even QA and Dev/Test environments, Microsoft Azure provides an open and broad variety of choices, a full container ecosystem in the cloud (shown in the diagram below).</span></span> <span data-ttu-id="5e348-233">В зависимости от потребностей конкретного приложения следует выбрать тот или иной продукт Azure.</span><span class="sxs-lookup"><span data-stu-id="5e348-233">Depending on your specific application’s needs, you should choose one or another Azure product.</span></span>

![Схема экосистемы контейнеров в Azure](./media/deploy-existing-net-apps-as-windows-containers/azure-container-ecosystem.png)

<span data-ttu-id="5e348-235">**Рис. 4-7.5.**</span><span class="sxs-lookup"><span data-stu-id="5e348-235">**Figure 4-7.5.**</span></span> <span data-ttu-id="5e348-236">Экосистема контейнеров в Azure</span><span class="sxs-lookup"><span data-stu-id="5e348-236">The container ecosystem in Azure</span></span>

<span data-ttu-id="5e348-237">Поддерживающие контейнеры продукты из экосистемы контейнеров в Azure, которые считаются инфраструктурой:</span><span class="sxs-lookup"><span data-stu-id="5e348-237">From the container ecosystem in Azure, the following products supporting containers that are considered infrastructure:</span></span>

- <span data-ttu-id="5e348-238">**Экземпляры контейнеров Azure (ACI)**</span><span class="sxs-lookup"><span data-stu-id="5e348-238">**Azure Container Instances (ACI)**</span></span>
- <span data-ttu-id="5e348-239">**Виртуальные машины Azure** (с поддержкой контейнеров).</span><span class="sxs-lookup"><span data-stu-id="5e348-239">**Azure Virtual Machines** (With container's support)</span></span>
- <span data-ttu-id="5e348-240">**Масштабируемые наборы виртуальных машин Azure** (с поддержкой контейнеров).</span><span class="sxs-lookup"><span data-stu-id="5e348-240">**Azure Virtual Machine Scale Sets** (With container's support)</span></span>

<span data-ttu-id="5e348-241">Из этих трех вариантов служба ACI обеспечивает большое преимущество, которое заключается в том, что вам не нужно поддерживать базовую ОС, не нужно выполнять обновления и исправления и т. д. Тем не менее ACI по-прежнему позиционируется на уровне инфраструктуры, как подробно описано в следующих разделах этой книги.</span><span class="sxs-lookup"><span data-stu-id="5e348-241">From those three, ACI provides a great benefit, which is the fact that you don't need to maintain the underlying OS, no need for you to upgrade/patch, etc. but ACI still is positioned in the infrastructure level, as better explained in the upcoming sections of this book.</span></span>

<span data-ttu-id="5e348-242">Продукты в Azure, поддерживающие контейнеры, которые в то же время позиционируются на уровне PaaS (платформа как услуга):</span><span class="sxs-lookup"><span data-stu-id="5e348-242">The products in Azure supporting containers that are at the same time positioned more in the PaaS (Platform as a Service) level are:</span></span>

- <span data-ttu-id="5e348-243">**служба приложений Azure**;</span><span class="sxs-lookup"><span data-stu-id="5e348-243">**Azure App Service**</span></span>
- <span data-ttu-id="5e348-244">**Служба Kubernetes Azure (AKS и ACS)** .</span><span class="sxs-lookup"><span data-stu-id="5e348-244">**Azure Kubernetes Service (AKS and ACS)**</span></span>
- <span data-ttu-id="5e348-245">**Пакетная служба Azure**</span><span class="sxs-lookup"><span data-stu-id="5e348-245">**Azure Batch**</span></span>

<span data-ttu-id="5e348-246">Реестр контейнеров Azure — это высокомасштабируемый реестр контейнеров, размещенный в Azure, который можно использовать во всех предыдущих продуктах при регистрации и развертывании пользовательских образов контейнеров.</span><span class="sxs-lookup"><span data-stu-id="5e348-246">Then, Azure Container Registry is a high scalable container registry hosted in Azure that you can use from all the previous products when registering and deploying your custom container images.</span></span>

<span data-ttu-id="5e348-247">Кроме того, из контейнеров можно использовать другие управляемые службы в Azure, такие как База данных SQL Azure, кэш Redis Azure, Azure Cosmos DB и т. д.</span><span class="sxs-lookup"><span data-stu-id="5e348-247">In addition, from your containers, you can consume other managed services in Azure like Azure SQL Database, Azure Redis cache, Azure Cosmos DB, etc.</span></span> <span data-ttu-id="5e348-248">В Azure Marketplace доступны сторонние решения и платформы, такие как Cloud Foundry и OpenShift, где также можно использовать контейнеры в Azure.</span><span class="sxs-lookup"><span data-stu-id="5e348-248">plus there are third-party solutions/platforms available in Azure Marketplace like Cloud Foundry and OpenShift where you can also use containers within Azure.</span></span>

<span data-ttu-id="5e348-249">В следующих разделах приведены рекомендации корпорации Майкрософт о том, когда следует использовать каждый из этих продуктов и решений Azure, ориентируясь на контейнеры Windows.</span><span class="sxs-lookup"><span data-stu-id="5e348-249">In the next sections, you can explore Microsoft's recommendations on when to use each of those Azure products and solutions specifically when targeting Windows Containers.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5e348-250">[Назад](what-about-cloud-native-applications.md)
>[Вперед](when-not-to-deploy-to-windows-containers.md)</span><span class="sxs-lookup"><span data-stu-id="5e348-250">[Previous](what-about-cloud-native-applications.md)
[Next](when-not-to-deploy-to-windows-containers.md)</span></span>
