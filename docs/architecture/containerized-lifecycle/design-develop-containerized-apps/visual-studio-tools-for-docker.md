---
title: Средства Visual Studio для Docker в Windows
description: Изучите средства Docker, доступные в Visual Studio 2017 версии 15.7 и более поздних.
ms.date: 08/06/2020
ms.custom: vs-dotnet
ms.openlocfilehash: ae20ebf7c3c27d7f2ebe51c33719b82048f86241
ms.sourcegitcommit: 0802ac583585110022beb6af8ea0b39188b77c43
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96032194"
---
# <a name="use-docker-tools-in-visual-studio-on-windows"></a><span data-ttu-id="6c7c8-103">Использование Средств Docker в Visual Studio для Windows</span><span class="sxs-lookup"><span data-stu-id="6c7c8-103">Use Docker Tools in Visual Studio on Windows</span></span>

<span data-ttu-id="6c7c8-104">Разработка с помощью Средств Docker, входящих в состав Visual Studio 2017 версии 15.7 и более поздних, осуществляется так же, как с помощью Visual Studio Code и CLI Docker (по сути, они также основаны на CLI Docker). Однако их проще запускать, с ними проще работать и они повышают продуктивность при выполнении сборки, запуска и компоновки.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-104">The developer workflow when using the Docker Tools included in Visual Studio 2017 version 15.7 and later, is similar to using Visual Studio Code and Docker CLI (in fact, it's based on the same Docker CLI), but it's easier to get started, simplifies the process, and provides greater productivity for the build, run, and compose tasks.</span></span> <span data-ttu-id="6c7c8-105">Они также позволяют запускать и отлаживать контейнеры с помощью стандартных сочетаний клавиш `F5` и `Ctrl+F5` в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-105">It can also run and debug your containers via the usual `F5` and `Ctrl+F5` keys from Visual Studio.</span></span> <span data-ttu-id="6c7c8-106">Вы можете даже отладить все решение, если его контейнеры определены в одном файле `docker-compose.yml` на уровне решения.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-106">You can even debug a whole solution if its containers are defined in the same `docker-compose.yml` file at the solution level.</span></span>

## <a name="configure-your-local-environment"></a><span data-ttu-id="6c7c8-107">Настройка локальной среды</span><span class="sxs-lookup"><span data-stu-id="6c7c8-107">Configure your local environment</span></span>

<span data-ttu-id="6c7c8-108">С помощью последних версий Docker для Windows разрабатывать приложения Docker стало еще легче благодаря простоте настройки, как описано в следующих справочниках.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-108">With the latest versions of Docker for Windows, it's easier than ever to develop Docker applications because the setup is straightforward, as explained in the following references.</span></span>

> [!TIP]
> <span data-ttu-id="6c7c8-109">Дополнительные сведения об установке Docker для Windows см. на странице <https://docs.docker.com/docker-for-windows/>.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-109">To learn more about installing Docker for Windows, go to (<https://docs.docker.com/docker-for-windows/>).</span></span>

## <a name="docker-support-in-visual-studio"></a><span data-ttu-id="6c7c8-110">Поддержка Docker в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6c7c8-110">Docker support in Visual Studio</span></span>

<span data-ttu-id="6c7c8-111">В проект можно добавить два уровня поддержки Docker.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-111">There are two levels of Docker support you can add to a project.</span></span> <span data-ttu-id="6c7c8-112">В проект ASP.NET Core можно просто добавить файл `Dockerfile`.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-112">In ASP.NET Core projects, you can just add a `Dockerfile` file to the project by enabling Docker support.</span></span> <span data-ttu-id="6c7c8-113">Следующий уровень — это поддержка оркестрации контейнеров, в рамках которой в проект добавляется файл `Dockerfile` (если его еще нет), а на уровне решения добавляется файл `docker-compose.yml`.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-113">The next level is container orchestration support, which adds a `Dockerfile` to the project (if it doesn't already exist) and a `docker-compose.yml` file at the solution level.</span></span> <span data-ttu-id="6c7c8-114">Поддержка оркестрации контейнеров с помощью Docker Compose добавляется по умолчанию в Visual Studio 2017 в версиях с 15.0 по 15.7.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-114">Container orchestration support, via Docker Compose, is added by default in Visual Studio 2017 versions 15.0 to 15.7.</span></span> <span data-ttu-id="6c7c8-115">В Visual Studio 2017 версии 15.8 и более поздних поддержка оркестрации контейнеров — необязательная функция.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-115">Container orchestration support is an opt-in feature in Visual Studio 2017 versions 15.8 or later.</span></span> <span data-ttu-id="6c7c8-116">Visual Studio 2019 и более поздних версий также поддерживает развертывание **Kubernetes/Helm**.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-116">Visual Studio 2019 and later supports **Kubernetes/Helm** deployment as well.</span></span>

<span data-ttu-id="6c7c8-117">Для проектов ASP.NET Core команды **Добавить > Поддержка Docker** и **Добавить > Поддержка оркестратора контейнеров** доступны в контекстном меню, открываемом правым щелчком мыши по узлу проекта в **обозревателе решений**, как показано на рис. 4-31:</span><span class="sxs-lookup"><span data-stu-id="6c7c8-117">The **Add > Docker Support** and **Add > Container Orchestrator Support** commands are located on the right-click menu (or context menu) of the project node for an ASP.NET Core project in **Solution Explorer**, as shown in Figure 4-31:</span></span>

![Добавление поддержки Docker из меню в Visual Studio](media/add-docker-support-menu.png)

<span data-ttu-id="6c7c8-119">**Рис. 4-31**.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-119">**Figure 4-31**.</span></span> <span data-ttu-id="6c7c8-120">Добавление поддержки Docker в проект Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="6c7c8-120">Adding Docker support to a Visual Studio 2019 project</span></span>

### <a name="add-docker-support"></a><span data-ttu-id="6c7c8-121">Добавление поддержки Docker</span><span class="sxs-lookup"><span data-stu-id="6c7c8-121">Add Docker support</span></span>

<span data-ttu-id="6c7c8-122">Помимо добавления поддержки Docker в существующее приложение, как это показано в предыдущем разделе, поддержку Docker можно также включить при создании проекта, выбрав **Включить поддержку Docker** в диалоговом окне **Новое веб-приложение ASP.NET Core**, которое открывается после нажатия кнопки **ОК** в диалоговом окне **Новый проект**, как показано на рис. 4-32.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-122">Besides the option to add Docker support to an existing application, as shown in the previous section, you can also enable Docker support during project creation by selecting **Enable Docker Support** in the **New ASP.NET Core Web Application** dialog box that opens after you click **OK** in the **New Project** dialog box, as shown in Figure 4-32.</span></span>

![Включение поддержки Docker для нового веб-приложения ASP.NET Core в Visual Studio](media/enable-docker-support-visual-studio.png)

<span data-ttu-id="6c7c8-124">**Рис. 4-32.**</span><span class="sxs-lookup"><span data-stu-id="6c7c8-124">**Figure 4-32**.</span></span> <span data-ttu-id="6c7c8-125">Включение поддержки Docker во время создания проекта в Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="6c7c8-125">Enable Docker support during project creation in Visual Studio 2019</span></span>

<span data-ttu-id="6c7c8-126">При добавлении или включении поддержки Docker Visual Studio добавляет в проект файл _Dockerfile_, который содержит ссылки на все необходимые проекты из решения.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-126">When you add or enable Docker support, Visual Studio adds a _Dockerfile_ file to the project, that includes references to all required project from the solution.</span></span>

### <a name="add-container-orchestration-support"></a><span data-ttu-id="6c7c8-127">Добавление поддержки оркестрации контейнеров</span><span class="sxs-lookup"><span data-stu-id="6c7c8-127">Add container orchestration support</span></span>

<span data-ttu-id="6c7c8-128">Если требуется создать многоконтейнерное решение, добавьте в проекты поддержку оркестрации контейнеров.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-128">When you want to compose a multi-container solution, add container orchestration support to your projects.</span></span> <span data-ttu-id="6c7c8-129">Это позволит выполнять и отлаживать группу контейнеров (все решение) одновременно, если они определяются в одном файле _docker-compose.yml_.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-129">This lets you run and debug a group of containers (a whole solution) at the same time if they're defined in the same _docker-compose.yml_ file.</span></span>

<span data-ttu-id="6c7c8-130">Чтобы добавить поддержку оркестрации контейнеров, щелкните правой кнопкой мыши узел решения или проекта в **обозревателе решений** и выберите **Добавить > Поддержка оркестрации контейнеров**.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-130">To add container orchestration support, right-click on the solution or project node in **Solution Explorer**, and choose **Add > Container Orchestration Support**.</span></span> <span data-ttu-id="6c7c8-131">Затем выберите **Kubernetes/Helm** или **Docker Compose** для управления контейнерами.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-131">Then choose **Kubernetes/Helm** or **Docker Compose** to manage the containers.</span></span>

<span data-ttu-id="6c7c8-132">После добавления поддержки оркестрации контейнеров в проект в него добавится файл Dockerfile, а в само решение в **обозревателе решений** — папка **docker-compose**, как показано на рис. 4-33:</span><span class="sxs-lookup"><span data-stu-id="6c7c8-132">After you add container orchestration support to your project, you see a Dockerfile added to the project and a **docker-compose** folder added to the solution in **Solution Explorer**, as shown in Figure 4-33:</span></span>

![Файлы Docker в обозревателе решений Visual Studio](media/docker-support-solution-explorer.png)

<span data-ttu-id="6c7c8-134">**Рис. 4-33.**</span><span class="sxs-lookup"><span data-stu-id="6c7c8-134">**Figure 4-33**.</span></span> <span data-ttu-id="6c7c8-135">Файлы Docker в обозревателе решений Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="6c7c8-135">Docker files in Solution Explorer in Visual Studio 2019</span></span>

<span data-ttu-id="6c7c8-136">Если файл _docker-compose.yml_ уже существует, Visual Studio просто добавит в него необходимые строки кода конфигурации.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-136">If _docker-compose.yml_ already exists, Visual Studio just adds the required lines of configuration code to it.</span></span>

## <a name="configure-docker-tools"></a><span data-ttu-id="6c7c8-137">Настройка средств Docker</span><span class="sxs-lookup"><span data-stu-id="6c7c8-137">Configure Docker tools</span></span>

<span data-ttu-id="6c7c8-138">В главном меню выберите **Сервис > Параметры** и разверните узлы **Инструменты для контейнера > Параметры**.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-138">From the main menu, choose **Tools > Options**, and expand **Container Tools > Settings**.</span></span> <span data-ttu-id="6c7c8-139">Появятся параметры инструментов для контейнера.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-139">The container tools settings appear.</span></span>

![Параметры Средств Visual Studio для Docker с тремя страницами: "Общие", "Один проект" и "Docker Compose", описание которых приведено в этой статье.](media/visual-studio-docker-tools-options.png)

<span data-ttu-id="6c7c8-141">**Рис. 4-34**.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-141">**Figure 4-34**.</span></span> <span data-ttu-id="6c7c8-142">Параметры средств Docker</span><span class="sxs-lookup"><span data-stu-id="6c7c8-142">Docker Tools Options</span></span>

<span data-ttu-id="6c7c8-143">Приведенная ниже таблица может помочь вам настроить эти параметры.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-143">The following table might help you decide how to set these options.</span></span>

| <span data-ttu-id="6c7c8-144">Страница/параметр</span><span class="sxs-lookup"><span data-stu-id="6c7c8-144">Page/Setting</span></span>                                |  <span data-ttu-id="6c7c8-145">Параметр по умолчанию</span><span class="sxs-lookup"><span data-stu-id="6c7c8-145">Default Setting</span></span>   | <span data-ttu-id="6c7c8-146">Description</span><span class="sxs-lookup"><span data-stu-id="6c7c8-146">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------------------------------------------- | :----------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="6c7c8-147">**Страница "Общие"**</span><span class="sxs-lookup"><span data-stu-id="6c7c8-147">**General page**</span></span>                            |
| <span data-ttu-id="6c7c8-148">При необходимости установите Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="6c7c8-148">Install Docker Desktop if needed</span></span>            |     <span data-ttu-id="6c7c8-149">Выдавать запрос</span><span class="sxs-lookup"><span data-stu-id="6c7c8-149">Prompt me</span></span>      |
| <span data-ttu-id="6c7c8-150">При необходимости запускать Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="6c7c8-150">Start Docker Desktop if needed</span></span>              |     <span data-ttu-id="6c7c8-151">Выдавать запрос</span><span class="sxs-lookup"><span data-stu-id="6c7c8-151">Prompt me</span></span>      |
| <span data-ttu-id="6c7c8-152">Сделать SSL-сертификат ASP.NET Core доверенным</span><span class="sxs-lookup"><span data-stu-id="6c7c8-152">Trust ASP.NET Core SSL certificate</span></span>          |     <span data-ttu-id="6c7c8-153">Выдавать запрос</span><span class="sxs-lookup"><span data-stu-id="6c7c8-153">Prompt me</span></span>      | <span data-ttu-id="6c7c8-154">Если SSL-сертификат localhost не был помечен как доверенный (с `dotnet dev-certs https --trust`), Visual Studio будет выводить запрос при каждом запуске проекта.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-154">If the localhost SSL certificate hasn't been marked as trusted (with `dotnet dev-certs https --trust`), Visual Studio will prompt every time you run your project.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="6c7c8-155">**Страница "Один проект"**</span><span class="sxs-lookup"><span data-stu-id="6c7c8-155">**Single Project page**</span></span>                     |
| <span data-ttu-id="6c7c8-156">Извлекать необходимые образы Docker при открытии проекта</span><span class="sxs-lookup"><span data-stu-id="6c7c8-156">Pull required Docker images on project open</span></span> |        <span data-ttu-id="6c7c8-157">True</span><span class="sxs-lookup"><span data-stu-id="6c7c8-157">True</span></span>        | <span data-ttu-id="6c7c8-158">Для повышения производительности при запуске проекта Visual Studio будет запускать операцию извлечения Docker в фоновом режиме, чтобы когда код был готов к выполнению, образ уже был скачан или находился в процессе скачивания.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-158">For increased performance when running the project, Visual Studio will start a Docker pull operation in the background so that when you're ready to run your code, the image is already downloaded or in the process of downloading.</span></span> <span data-ttu-id="6c7c8-159">Если вы загружаете проекты просто для просмотра кода, эту возможность можно отключить, чтобы избежать скачивания ненужных образов контейнеров.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-159">If you're just loading projects and browsing code, you can turn this off to avoid downloading container images you don't need.</span></span> <span data-ttu-id="6c7c8-160">Это может замедлять работу пользователей с открытым проектом.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-160">This could slow the open project user experience.</span></span> |
| <span data-ttu-id="6c7c8-161">Извлекать обновленные образы Docker при загрузке проекта</span><span class="sxs-lookup"><span data-stu-id="6c7c8-161">Pull updated Docker images on project load</span></span>  | <span data-ttu-id="6c7c8-162">Проекты .NET Core</span><span class="sxs-lookup"><span data-stu-id="6c7c8-162">.NET Core projects</span></span> | <span data-ttu-id="6c7c8-163">Запрашивать обновления для существующих образов, чтобы получить последние обновления при открытии проекта.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-163">Pull updates to existing images to get the latest updates on project open.</span></span> <span data-ttu-id="6c7c8-164">Это может замедлять работу пользователей с открытым проектом.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-164">This could slow the open project user experience.</span></span>                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="6c7c8-165">Удаление контейнеров при закрытии проекта</span><span class="sxs-lookup"><span data-stu-id="6c7c8-165">Remove containers on project close</span></span>          |        <span data-ttu-id="6c7c8-166">True</span><span class="sxs-lookup"><span data-stu-id="6c7c8-166">True</span></span>        | <span data-ttu-id="6c7c8-167">Очистка при закрытии проекта, это может замедлять работу с проектом, но обычно эта операция выполняется быстро.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-167">Clean up on project close, This could slow the close project user experience but it's usually fast anyway.</span></span>                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="6c7c8-168">Запускать контейнеры при открытии проекта</span><span class="sxs-lookup"><span data-stu-id="6c7c8-168">Run containers on project open</span></span>              |        <span data-ttu-id="6c7c8-169">True</span><span class="sxs-lookup"><span data-stu-id="6c7c8-169">True</span></span>        | <span data-ttu-id="6c7c8-170">Для повышения производительности при запуске проекта Visual Studio запускает все контейнеры в решении.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-170">For increased performance when running the project, Visual Studio will start all containers in the solution.</span></span> <span data-ttu-id="6c7c8-171">Это может замедлять работу пользователей с открытым проектом.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-171">This could slow the open project user experience.</span></span>                                                                                                                                                                                                                                                        |
| <span data-ttu-id="6c7c8-172">**Docker Compose**</span><span class="sxs-lookup"><span data-stu-id="6c7c8-172">**Docker Compose**</span></span>                          |                    | <span data-ttu-id="6c7c8-173">Страница "Docker Compose" содержит те же параметры, что и страница "Один проект", но эти параметры применяются к решениям с несколькими контейнерами.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-173">The Docker Compose page contains the same settings as the Single Project page, but they apply to multi-container solutions.</span></span>                                                                                                                                                                                                                                                                                           |

> [!WARNING]
> <span data-ttu-id="6c7c8-174">Если SSL-сертификат localhost не является доверенным и параметр установлен в значение **Никогда**, то веб-запросы HTTPS могут завершаться сбоем во время выполнения приложения или службы.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-174">If the localhost SSL certificate is not trusted, and you set the option to **Never**, then HTTPS web requests might fail at runtime in your app or service.</span></span> <span data-ttu-id="6c7c8-175">В этом случае снова задайте значение **Выдавать запрос** или, еще лучше, установите доверие к сертификатам на компьютере разработчика с помощью команды `dotnet dev-certs https --trust`.</span><span class="sxs-lookup"><span data-stu-id="6c7c8-175">In that case, set the value back again to **Prompt me** or, better again, trust the certificates in your dev machine using the command `dotnet dev-certs https --trust`.</span></span>

> [!TIP]
> <span data-ttu-id="6c7c8-176">Чтобы получить дополнительные сведения о реализации служб и использовании средств Visual Studio для Docker, ознакомьтесь со следующими статьями:</span><span class="sxs-lookup"><span data-stu-id="6c7c8-176">For further details on the services implementation and use of Visual Studio Tools for Docker, read the following articles:</span></span>
>
> <span data-ttu-id="6c7c8-177">Отладка приложений в локальном контейнере Docker: <https://docs.microsoft.com/visualstudio/containers/edit-and-refresh></span><span class="sxs-lookup"><span data-stu-id="6c7c8-177">Debug apps in a local Docker container: <https://docs.microsoft.com/visualstudio/containers/edit-and-refresh></span></span>
>
> <span data-ttu-id="6c7c8-178">Развертывание контейнера ASP.NET в реестре контейнеров с использованием Visual Studio: <https://docs.microsoft.com/visualstudio/containers/hosting-web-apps-in-docker></span><span class="sxs-lookup"><span data-stu-id="6c7c8-178">Deploy an ASP.NET container to a container registry using Visual Studio: <https://docs.microsoft.com/visualstudio/containers/hosting-web-apps-in-docker></span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6c7c8-179">[Назад](docker-apps-inner-loop-workflow.md)
> [Вперед](set-up-windows-containers-with-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="6c7c8-179">[Previous](docker-apps-inner-loop-workflow.md)
[Next](set-up-windows-containers-with-powershell.md)</span></span>
