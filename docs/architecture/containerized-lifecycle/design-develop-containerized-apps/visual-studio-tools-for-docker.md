---
title: Средства Visual Studio для Docker в Windows
description: Изучите средства Docker, доступные в Visual Studio 2017 версии 15.7 и более поздних.
ms.date: 08/06/2020
ms.custom: vs-dotnet
ms.openlocfilehash: ae20ebf7c3c27d7f2ebe51c33719b82048f86241
ms.sourcegitcommit: 0802ac583585110022beb6af8ea0b39188b77c43
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96032194"
---
# <a name="use-docker-tools-in-visual-studio-on-windows"></a>Использование Средств Docker в Visual Studio для Windows

Разработка с помощью Средств Docker, входящих в состав Visual Studio 2017 версии 15.7 и более поздних, осуществляется так же, как с помощью Visual Studio Code и CLI Docker (по сути, они также основаны на CLI Docker). Однако их проще запускать, с ними проще работать и они повышают продуктивность при выполнении сборки, запуска и компоновки. Они также позволяют запускать и отлаживать контейнеры с помощью стандартных сочетаний клавиш `F5` и `Ctrl+F5` в Visual Studio. Вы можете даже отладить все решение, если его контейнеры определены в одном файле `docker-compose.yml` на уровне решения.

## <a name="configure-your-local-environment"></a>Настройка локальной среды

С помощью последних версий Docker для Windows разрабатывать приложения Docker стало еще легче благодаря простоте настройки, как описано в следующих справочниках.

> [!TIP]
> Дополнительные сведения об установке Docker для Windows см. на странице <https://docs.docker.com/docker-for-windows/>.

## <a name="docker-support-in-visual-studio"></a>Поддержка Docker в Visual Studio

В проект можно добавить два уровня поддержки Docker. В проект ASP.NET Core можно просто добавить файл `Dockerfile`. Следующий уровень — это поддержка оркестрации контейнеров, в рамках которой в проект добавляется файл `Dockerfile` (если его еще нет), а на уровне решения добавляется файл `docker-compose.yml`. Поддержка оркестрации контейнеров с помощью Docker Compose добавляется по умолчанию в Visual Studio 2017 в версиях с 15.0 по 15.7. В Visual Studio 2017 версии 15.8 и более поздних поддержка оркестрации контейнеров — необязательная функция. Visual Studio 2019 и более поздних версий также поддерживает развертывание **Kubernetes/Helm**.

Для проектов ASP.NET Core команды **Добавить > Поддержка Docker** и **Добавить > Поддержка оркестратора контейнеров** доступны в контекстном меню, открываемом правым щелчком мыши по узлу проекта в **обозревателе решений**, как показано на рис. 4-31:

![Добавление поддержки Docker из меню в Visual Studio](media/add-docker-support-menu.png)

**Рис. 4-31**. Добавление поддержки Docker в проект Visual Studio 2019

### <a name="add-docker-support"></a>Добавление поддержки Docker

Помимо добавления поддержки Docker в существующее приложение, как это показано в предыдущем разделе, поддержку Docker можно также включить при создании проекта, выбрав **Включить поддержку Docker** в диалоговом окне **Новое веб-приложение ASP.NET Core**, которое открывается после нажатия кнопки **ОК** в диалоговом окне **Новый проект**, как показано на рис. 4-32.

![Включение поддержки Docker для нового веб-приложения ASP.NET Core в Visual Studio](media/enable-docker-support-visual-studio.png)

**Рис. 4-32.** Включение поддержки Docker во время создания проекта в Visual Studio 2019

При добавлении или включении поддержки Docker Visual Studio добавляет в проект файл _Dockerfile_, который содержит ссылки на все необходимые проекты из решения.

### <a name="add-container-orchestration-support"></a>Добавление поддержки оркестрации контейнеров

Если требуется создать многоконтейнерное решение, добавьте в проекты поддержку оркестрации контейнеров. Это позволит выполнять и отлаживать группу контейнеров (все решение) одновременно, если они определяются в одном файле _docker-compose.yml_.

Чтобы добавить поддержку оркестрации контейнеров, щелкните правой кнопкой мыши узел решения или проекта в **обозревателе решений** и выберите **Добавить > Поддержка оркестрации контейнеров**. Затем выберите **Kubernetes/Helm** или **Docker Compose** для управления контейнерами.

После добавления поддержки оркестрации контейнеров в проект в него добавится файл Dockerfile, а в само решение в **обозревателе решений** — папка **docker-compose**, как показано на рис. 4-33:

![Файлы Docker в обозревателе решений Visual Studio](media/docker-support-solution-explorer.png)

**Рис. 4-33.** Файлы Docker в обозревателе решений Visual Studio 2019

Если файл _docker-compose.yml_ уже существует, Visual Studio просто добавит в него необходимые строки кода конфигурации.

## <a name="configure-docker-tools"></a>Настройка средств Docker

В главном меню выберите **Сервис > Параметры** и разверните узлы **Инструменты для контейнера > Параметры**. Появятся параметры инструментов для контейнера.

![Параметры Средств Visual Studio для Docker с тремя страницами: "Общие", "Один проект" и "Docker Compose", описание которых приведено в этой статье.](media/visual-studio-docker-tools-options.png)

**Рис. 4-34**. Параметры средств Docker

Приведенная ниже таблица может помочь вам настроить эти параметры.

| Страница/параметр                                |  Параметр по умолчанию   | Description                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------------------------------------------- | :----------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Страница "Общие"**                            |
| При необходимости установите Docker Desktop            |     Выдавать запрос      |
| При необходимости запускать Docker Desktop              |     Выдавать запрос      |
| Сделать SSL-сертификат ASP.NET Core доверенным          |     Выдавать запрос      | Если SSL-сертификат localhost не был помечен как доверенный (с `dotnet dev-certs https --trust`), Visual Studio будет выводить запрос при каждом запуске проекта.                                                                                                                                                                                                                                                    |
| **Страница "Один проект"**                     |
| Извлекать необходимые образы Docker при открытии проекта |        True        | Для повышения производительности при запуске проекта Visual Studio будет запускать операцию извлечения Docker в фоновом режиме, чтобы когда код был готов к выполнению, образ уже был скачан или находился в процессе скачивания. Если вы загружаете проекты просто для просмотра кода, эту возможность можно отключить, чтобы избежать скачивания ненужных образов контейнеров. Это может замедлять работу пользователей с открытым проектом. |
| Извлекать обновленные образы Docker при загрузке проекта  | Проекты .NET Core | Запрашивать обновления для существующих образов, чтобы получить последние обновления при открытии проекта. Это может замедлять работу пользователей с открытым проектом.                                                                                                                                                                                                                                                                                          |
| Удаление контейнеров при закрытии проекта          |        True        | Очистка при закрытии проекта, это может замедлять работу с проектом, но обычно эта операция выполняется быстро.                                                                                                                                                                                                                                                                                                            |
| Запускать контейнеры при открытии проекта              |        True        | Для повышения производительности при запуске проекта Visual Studio запускает все контейнеры в решении. Это может замедлять работу пользователей с открытым проектом.                                                                                                                                                                                                                                                        |
| **Docker Compose**                          |                    | Страница "Docker Compose" содержит те же параметры, что и страница "Один проект", но эти параметры применяются к решениям с несколькими контейнерами.                                                                                                                                                                                                                                                                                           |

> [!WARNING]
> Если SSL-сертификат localhost не является доверенным и параметр установлен в значение **Никогда**, то веб-запросы HTTPS могут завершаться сбоем во время выполнения приложения или службы. В этом случае снова задайте значение **Выдавать запрос** или, еще лучше, установите доверие к сертификатам на компьютере разработчика с помощью команды `dotnet dev-certs https --trust`.

> [!TIP]
> Чтобы получить дополнительные сведения о реализации служб и использовании средств Visual Studio для Docker, ознакомьтесь со следующими статьями:
>
> Отладка приложений в локальном контейнере Docker: <https://docs.microsoft.com/visualstudio/containers/edit-and-refresh>
>
> Развертывание контейнера ASP.NET в реестре контейнеров с использованием Visual Studio: <https://docs.microsoft.com/visualstudio/containers/hosting-web-apps-in-docker>

> [!div class="step-by-step"]
> [Назад](docker-apps-inner-loop-workflow.md)
> [Вперед](set-up-windows-containers-with-powershell.md)
