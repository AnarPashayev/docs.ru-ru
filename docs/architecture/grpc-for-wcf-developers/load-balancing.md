---
title: Балансировка нагрузки gRPC-gRPC для разработчиков WCF
description: Выбор подсистемы балансировки нагрузки для работы со службами gRPC Services.
ms.date: 09/02/2019
ms.openlocfilehash: 070fc7fda73988302d15c8cec12b1ac359641317
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73967444"
---
# <a name="load-balancing-grpc"></a>GRPC балансировки нагрузки

Типичное развертывание приложения gRPC включает ряд идентичных экземпляров службы, обеспечивая устойчивость и горизонтальную масштабируемость. Балансировка нагрузки распределяет входящие запросы между этими экземплярами, чтобы обеспечить полное использование всех доступных ресурсов. Чтобы обеспечить невидимость этой балансировки нагрузки для клиента, обычно используется сервер балансировщика нагрузки прокси-сервера для обработки запросов от клиентов и их маршрутизации к экземплярам серверной части.

Подсистемы балансировки нагрузки классифицируются в соответствии с *уровнем* , с которым они работают. Подсистемы балансировки нагрузки уровня 4 работают на *транспортном* уровне, например с сокетами TCP, соединениями и пакетами. Подсистемы балансировки нагрузки уровня 7 работают на уровне *приложения* , специально обрабатывая запросы HTTP/2 для приложений gRPC.

## <a name="l4-load-balancers"></a>Подсистемы балансировки нагрузки на уровне 4

Балансировщик нагрузки уровня 4 принимает запрос TCP-соединения от клиента, открывает другое соединение с одним из внутренних экземпляров и копирует данные между двумя соединениями без реальной обработки. Уровень 4 обеспечивает высокую производительность и низкую задержку, но очень мало средств управления и анализа. Пока клиент остается открытым, все запросы будут направлены на один и тот же экземпляр серверной части.

Примером использования балансировщика нагрузки уровня 4 является [Azure Load Balancer](https://azure.microsoft.com/services/load-balancer/).

## <a name="l7-load-balancers"></a>Подсистемы балансировки нагрузки уровня 7

Балансировщик нагрузки уровня "на уровне 7" анализирует входящие запросы HTTP/2 и передает их на экземпляры серверной части по запросу, независимо от того, как долго соединение удерживает клиент.

Примерами подсистем балансировки нагрузки на уровне 7 являются:

- [Nginx](https://www.nginx.com/)
- [HAproxy](https://www.haproxy.com/)
- [траефик](https://traefik.io/)

Как правило, подсистемы балансировки нагрузки уровня "на уровне 7" являются лучшим выбором для gRPC и других приложений HTTP/2 (и для приложений HTTP, как правило, на самом деле). Подсистемы балансировки нагрузки уровня 4 будут *работать* с gRPC приложениями, но они особенно полезны в тех случаях, когда низкая задержка и низкая нагрузка являются важнейшими по важности.

> [!IMPORTANT]
> На момент написания этой статьи не все подсистемы балансировки нагрузки уровня 7 поддерживают все части спецификации HTTP/2, необходимые для gRPC Services, например конечные заголовки.

При использовании TLS-шифрования подсистемы балансировки нагрузки могут завершить TLS-подключение и передать незашифрованные запросы в серверное приложение или передать зашифрованный запрос вместе. В любом случае для подсистемы балансировки нагрузки необходимо настроить открытый и закрытый ключи сервера, чтобы он мог расшифровывать запросы на обработку.

Сведения о том, как настроить обработку запросов HTTP/2 к серверным службам, см. в документации по предпочтительной подсистеме балансировки нагрузки.

## <a name="load-balancing-within-kubernetes"></a>Балансировка нагрузки в Kubernetes

Описание балансировки нагрузки между внутренними службами в Kubernetes см. в [разделе о](service-mesh.md) связях между службами.

>[!div class="step-by-step"]
>[Назад](service-mesh.md)
>[Вперед](application-performance-management.md)
