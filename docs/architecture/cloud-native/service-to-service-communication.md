---
title: Связь между службами
description: Узнайте, как облачные микрослужбы, нативные на конец, взаимодействуют с другими микрослужбами бэк-энда.
author: robvet
ms.date: 09/09/2019
ms.openlocfilehash: a5124b8b83f62ff17b1230ead63db26e0c1f2a5b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2020
ms.locfileid: "79401763"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="96908-103">Связь между службами</span><span class="sxs-lookup"><span data-stu-id="96908-103">Service-to-service communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="96908-104">Переходя от фронт-энд-клиента, мы теперь обращаемся к бэк-энд микрослужб ы общаться друг с другом.</span><span class="sxs-lookup"><span data-stu-id="96908-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="96908-105">При построении облачного приложения необходимо учитывать, как службы бэк-энда взаимодействуют друг с другом.</span><span class="sxs-lookup"><span data-stu-id="96908-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="96908-106">В идеале, чем меньше межсервисная связь, тем лучше.</span><span class="sxs-lookup"><span data-stu-id="96908-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="96908-107">Однако избежать не всегда возможно, так как службы бэк-энда часто полагаются друг на друга для завершения операции.</span><span class="sxs-lookup"><span data-stu-id="96908-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="96908-108">Существует несколько широко признанных подходов к внедрению межсервисной связи.</span><span class="sxs-lookup"><span data-stu-id="96908-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="96908-109">*Тип взаимодействия связи* часто определяет наилучший подход.</span><span class="sxs-lookup"><span data-stu-id="96908-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="96908-110">Рассмотрим следующие типы взаимодействия:</span><span class="sxs-lookup"><span data-stu-id="96908-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="96908-111">*Запрос* - когда вызов микрослужбы требует ответа от так называемой микрослужбы, такие как: "Эй, дайте мне информацию о покупателе для данного клиента Id".</span><span class="sxs-lookup"><span data-stu-id="96908-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="96908-112">*Командование* - когда вызывающая микрослужба нуждается в другой микрослужбе для выполнения действия, но не требует ответа, например: "Эй, просто отправь этот заказ".</span><span class="sxs-lookup"><span data-stu-id="96908-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="96908-113">*Событие* - когда микрослужба, называемая издателем, поднимает событие, в которое изменилось состояние или произошло действие.</span><span class="sxs-lookup"><span data-stu-id="96908-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="96908-114">Другие микросервисы, называемые абонентами, которые заинтересованы, могут соответствующим образом отреагировать на это событие.</span><span class="sxs-lookup"><span data-stu-id="96908-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="96908-115">Издатель и подписчики не знают друг о друге.</span><span class="sxs-lookup"><span data-stu-id="96908-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="96908-116">Системы микрослужб обычно используют комбинацию этих типов взаимодействия при выполнения операций, требующих взаимодействия между ней.</span><span class="sxs-lookup"><span data-stu-id="96908-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="96908-117">Давайте внимательно рассмотрим каждый из них и как вы могли бы реализовать их.</span><span class="sxs-lookup"><span data-stu-id="96908-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="96908-118">Запросы</span><span class="sxs-lookup"><span data-stu-id="96908-118">Queries</span></span>

<span data-ttu-id="96908-119">Во многих случаях одной микрослужбе может потребоваться *запрос* другой, что требует немедленного ответа для завершения операции.</span><span class="sxs-lookup"><span data-stu-id="96908-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="96908-120">Микросервису корзины для покупок может потребоваться информация о продукте и цена для добавления товара в корзину.</span><span class="sxs-lookup"><span data-stu-id="96908-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="96908-121">Существует ряд подходов к реализации операций запросов.</span><span class="sxs-lookup"><span data-stu-id="96908-121">There are a number of approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="96908-122">Сообщения о запросе/ответе</span><span class="sxs-lookup"><span data-stu-id="96908-122">Request/Response Messaging</span></span>

<span data-ttu-id="96908-123">Один из вариантов реализации этого сценария заключается в том, чтобы микрослужба вызова бэк-энда делала прямые запросы HTTP в микрослужбы, необходимые для запроса, показанные на рисунке 4-8.</span><span class="sxs-lookup"><span data-stu-id="96908-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Прямая связь HTTP](./media/direct-http-communication.png)

<span data-ttu-id="96908-125">**Рисунок 4-8**.</span><span class="sxs-lookup"><span data-stu-id="96908-125">**Figure 4-8**.</span></span> <span data-ttu-id="96908-126">Прямая связь HTTP</span><span class="sxs-lookup"><span data-stu-id="96908-126">Direct HTTP communication</span></span>

<span data-ttu-id="96908-127">Хотя прямые вызовы HTTP между микрослужбами относительно просты в реализации, следует позаботиться о том, чтобы свести к минимуму эту практику.</span><span class="sxs-lookup"><span data-stu-id="96908-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="96908-128">Для начала эти вызовы всегда *синхронны* и будут блокировать операцию до тех пор, пока результат не будет возвращен или время запроса не выйдет.</span><span class="sxs-lookup"><span data-stu-id="96908-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="96908-129">То, что когда-то было автономным, независимыми службами, способными развиваться независимо и часто развертываться, теперь становится связано друг с другом.</span><span class="sxs-lookup"><span data-stu-id="96908-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="96908-130">По мере увеличения связей между микрослужбами их архитектурные преимущества уменьшаются.</span><span class="sxs-lookup"><span data-stu-id="96908-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="96908-131">Выполнение нечастых запросов, в результате которого делается один прямой вызов HTTP в другую микрослужбу, может быть приемлемым для некоторых систем.</span><span class="sxs-lookup"><span data-stu-id="96908-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="96908-132">Однако нерекомендуете количество звонков, которые вызывают прямые http-звонки в несколько микрослужб.</span><span class="sxs-lookup"><span data-stu-id="96908-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="96908-133">Они могут увеличить задержку и негативно повлиять на производительность, масштабируемость и доступность вашей системы.</span><span class="sxs-lookup"><span data-stu-id="96908-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="96908-134">Еще хуже то, что длинная серия прямой http-коммуникации может привести к глубоким и сложным цепочкам синхронных вызовов микросервисов, показанных на рисунке 4-9:</span><span class="sxs-lookup"><span data-stu-id="96908-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Цепочка http-запросов](./media/chaining-http-queries.png)

<span data-ttu-id="96908-136">**Рисунок 4-9**.</span><span class="sxs-lookup"><span data-stu-id="96908-136">**Figure 4-9**.</span></span> <span data-ttu-id="96908-137">Цепочка http-запросов</span><span class="sxs-lookup"><span data-stu-id="96908-137">Chaining HTTP queries</span></span>

<span data-ttu-id="96908-138">Вы, конечно, можете себе представить риск в дизайне показано на предыдущем изображении.</span><span class="sxs-lookup"><span data-stu-id="96908-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="96908-139">Что произойдет, если шаг \#3 выйдет из строя?</span><span class="sxs-lookup"><span data-stu-id="96908-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="96908-140">Или \#Шаг 8 терпит неудачу?</span><span class="sxs-lookup"><span data-stu-id="96908-140">Or Step \#8 fails?</span></span> <span data-ttu-id="96908-141">Как вы восстанавливаетесь?</span><span class="sxs-lookup"><span data-stu-id="96908-141">How do you recover?</span></span> <span data-ttu-id="96908-142">Что делать, если шаг \#6 медленный, потому что основная служба занята?</span><span class="sxs-lookup"><span data-stu-id="96908-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="96908-143">Как вы продолжаете?</span><span class="sxs-lookup"><span data-stu-id="96908-143">How do you continue?</span></span> <span data-ttu-id="96908-144">Даже если все работает правильно, подумайте о задержке, которую понесет этот вызов, которая является суммой задержки каждого шага.</span><span class="sxs-lookup"><span data-stu-id="96908-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="96908-145">Большая степень соединения на предыдущем изображении позволяет предположить, что службы не были оптимально смоделированы.</span><span class="sxs-lookup"><span data-stu-id="96908-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="96908-146">Было бы обязывать команду вернуться к их дизайну.</span><span class="sxs-lookup"><span data-stu-id="96908-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="96908-147">Шаблон материализованного представления</span><span class="sxs-lookup"><span data-stu-id="96908-147">Materialized View pattern</span></span>

<span data-ttu-id="96908-148">Популярным вариантом удаления связи микрослужб является [шаблон Materialized View.](https://docs.microsoft.com/azure/architecture/patterns/materialized-view)</span><span class="sxs-lookup"><span data-stu-id="96908-148">A popular option for removing microservice coupling is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="96908-149">С помощью этого шаблона микрослужба хранит свою собственную локальную денормализованную копию данных, принадлежащих другим службам.</span><span class="sxs-lookup"><span data-stu-id="96908-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="96908-150">Вместо того, чтобы микрослужба Shopping Basket, задающая запрос на каталог продуктов и микросервисы ценообразования, она сохраняет свою собственную локальную копию этих данных.</span><span class="sxs-lookup"><span data-stu-id="96908-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="96908-151">Этот шаблон устраняет ненужное соединение и повышает надежность и время отклика.</span><span class="sxs-lookup"><span data-stu-id="96908-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="96908-152">Вся операция выполняется внутри одного процесса.</span><span class="sxs-lookup"><span data-stu-id="96908-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="96908-153">Мы исследуем эту модель и другие проблемы данных в главе 5.</span><span class="sxs-lookup"><span data-stu-id="96908-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="96908-154">Шаблон агрегатора услуг</span><span class="sxs-lookup"><span data-stu-id="96908-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="96908-155">Еще одним вариантом устранения связи между микросервисами и микросервисами является [микросервис Агрегатора,](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/)показанный фиолетовым цветом на рисунке 4-10.</span><span class="sxs-lookup"><span data-stu-id="96908-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span>

![Услуги агрегатора](./media/aggregator-service.png)

<span data-ttu-id="96908-157">**Рисунок 4-10**.</span><span class="sxs-lookup"><span data-stu-id="96908-157">**Figure 4-10**.</span></span> <span data-ttu-id="96908-158">Микросервис агрегатора</span><span class="sxs-lookup"><span data-stu-id="96908-158">Aggregator microservice</span></span>

<span data-ttu-id="96908-159">Шаблон изолирует операцию, которая делает вызовы к нескольким бэк-энд микрослужб, централизация его логики в специализированной микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="96908-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="96908-160">Фиолетовый агрегатор кассатов на предыдущей цифре оркеструет рабочий процесс для операции Checkout.</span><span class="sxs-lookup"><span data-stu-id="96908-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="96908-161">Она включает в себя вызовы в несколько бэк-энд микрослужб в последовательном порядке.</span><span class="sxs-lookup"><span data-stu-id="96908-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="96908-162">Данные из рабочего процесса агрегируются и возвращаются вызывающему.</span><span class="sxs-lookup"><span data-stu-id="96908-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="96908-163">Несмотря на то, что она по-прежнему реализует прямые http-звонки, микрослужба агрегатора снижает прямую зависимость между бэк-эндом микрослужб.</span><span class="sxs-lookup"><span data-stu-id="96908-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span>

### <a name="requestreply-pattern"></a><span data-ttu-id="96908-164">Шаблон запроса/ответа</span><span class="sxs-lookup"><span data-stu-id="96908-164">Request/Reply Pattern</span></span>

<span data-ttu-id="96908-165">Другим подходом к разъединению синхронных сообщений HTTP является [шаблон запроса и ответа,](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html)который использует общение очередей.</span><span class="sxs-lookup"><span data-stu-id="96908-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="96908-166">Связь с помощью очереди всегда является односторонним каналом, при этом производитель отправляет сообщение, а потребитель получает его.</span><span class="sxs-lookup"><span data-stu-id="96908-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="96908-167">С помощью этого шаблона выполняется как очередь запросов, так и очередь ответа, показанная на рисунке 4-11.</span><span class="sxs-lookup"><span data-stu-id="96908-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Шаблон запроса-ответа](./media/request-reply-pattern.png)

<span data-ttu-id="96908-169">**Рисунок 4-11**.</span><span class="sxs-lookup"><span data-stu-id="96908-169">**Figure 4-11**.</span></span> <span data-ttu-id="96908-170">Шаблон запроса-ответа</span><span class="sxs-lookup"><span data-stu-id="96908-170">Request-reply pattern</span></span>

<span data-ttu-id="96908-171">В данном месте производитель сообщений создает сообщение на основе запроса, содержащее уникальный идентификатор корреляции, и помещает его в очередь запроса.</span><span class="sxs-lookup"><span data-stu-id="96908-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="96908-172">Потребляющая служба разлагает сообщения, обрабатывает их и помещает ответ в очередь ответа с тем же идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="96908-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="96908-173">Служба производителя разлагает сообщение, сопоставляет его с идентификатором корреляции и продолжает обработку.</span><span class="sxs-lookup"><span data-stu-id="96908-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="96908-174">В следующем разделе мы подробно покрываем очереди.</span><span class="sxs-lookup"><span data-stu-id="96908-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="96908-175">Команды</span><span class="sxs-lookup"><span data-stu-id="96908-175">Commands</span></span>

<span data-ttu-id="96908-176">Другим типом взаимодействия связи является *команда.*</span><span class="sxs-lookup"><span data-stu-id="96908-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="96908-177">Для выполнения действия микрослужбе может потребоваться другая микрослужба.</span><span class="sxs-lookup"><span data-stu-id="96908-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="96908-178">Микрослужба заказа может понадобиться для создания отгрузки для заказа.</span><span class="sxs-lookup"><span data-stu-id="96908-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="96908-179">На рисунке 4-12 одна микрослужба, называемая "Производитель", отправляет сообщение другому микросервису, потребителю, повелевая ему что-то делать.</span><span class="sxs-lookup"><span data-stu-id="96908-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span>

![Взаимодействие командования с очередью](./media/command-interaction-with-queue.png)

<span data-ttu-id="96908-181">**Рис. 4-12**.</span><span class="sxs-lookup"><span data-stu-id="96908-181">**Figure 4-12**.</span></span> <span data-ttu-id="96908-182">Взаимодействие командования с очередью</span><span class="sxs-lookup"><span data-stu-id="96908-182">Command interaction with a queue</span></span>

<span data-ttu-id="96908-183">Чаще всего, Производитель не требует ответа и может *стрелять и забыть* сообщение.</span><span class="sxs-lookup"><span data-stu-id="96908-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="96908-184">Если ответ необходим, потребитель отправляет отдельное сообщение продюсеру на другом канале.</span><span class="sxs-lookup"><span data-stu-id="96908-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="96908-185">Командное сообщение лучше всего отправлять асинхронно с очередью сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="96908-186">поддерживается легким брокером сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="96908-187">На предыдущей диаграмме обратите внимание, как очередь отделяет и отделяет обе службы.</span><span class="sxs-lookup"><span data-stu-id="96908-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="96908-188">Очередь сообщений — это посредник, через который производитель и потребитель передают сообщение.</span><span class="sxs-lookup"><span data-stu-id="96908-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="96908-189">Очереди реализуют асинхронный шаблон обмена сообщениями по точкам.</span><span class="sxs-lookup"><span data-stu-id="96908-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="96908-190">Производитель знает, куда должна быть отправлена команда и маршруты надлежащим образом.</span><span class="sxs-lookup"><span data-stu-id="96908-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="96908-191">Очередь гарантирует, что сообщение обрабатывается именно одним из экземпляров потребителя, которые читают из канала.</span><span class="sxs-lookup"><span data-stu-id="96908-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="96908-192">В этом сценарии, либо производитель или потребитель службы может масштабироваться, не затрагивая других.</span><span class="sxs-lookup"><span data-stu-id="96908-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="96908-193">Кроме того, технологии могут быть разрозненными с каждой стороны, а это означает, что у нас может быть микрослужба Java, вызывающая микрослужбу [Голанг.](https://golang.org)</span><span class="sxs-lookup"><span data-stu-id="96908-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span>

<span data-ttu-id="96908-194">В главе 1 мы говорили о *поддержке услуг*.</span><span class="sxs-lookup"><span data-stu-id="96908-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="96908-195">Службы поддержки — вспомогательные ресурсы, от которых зависят облачные системы.</span><span class="sxs-lookup"><span data-stu-id="96908-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="96908-196">Очереди сообщений являются службами поддержки.</span><span class="sxs-lookup"><span data-stu-id="96908-196">Message queues are backing services.</span></span> <span data-ttu-id="96908-197">Облако Azure поддерживает два типа очередей сообщений, которые могут использовать облачные системы для реализации командных сообщений: очереди хранения данных Azure и очереди служб ы Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="96908-198">Очереди службы хранилища Azure</span><span class="sxs-lookup"><span data-stu-id="96908-198">Azure Storage Queues</span></span>

<span data-ttu-id="96908-199">Очереди хранения Azure предлагают простую инфраструктуру очередей, которая является быстрой, доступной и поддерживаемой учетными записями хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="96908-200">[Очереди хранения данных Azure оснащены](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) механизмом очередей на основе REST с надежными и постоянными сообщениями.</span><span class="sxs-lookup"><span data-stu-id="96908-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="96908-201">Они обеспечивают минимальный набор функций, но стоят недорого и хранят миллионы сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="96908-202">Их мощность составляет до 500 ТБ.</span><span class="sxs-lookup"><span data-stu-id="96908-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="96908-203">Одно сообщение может быть размером до 64 кБ.</span><span class="sxs-lookup"><span data-stu-id="96908-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="96908-204">Вы можете получить доступ к сообщениям из любой точки мира с помощью аутентифицированных звонков с помощью HTTP или HTTPS.</span><span class="sxs-lookup"><span data-stu-id="96908-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="96908-205">Очереди хранения могут масштабироваться до большого количества одновременных клиентов для обработки спайков трафика.</span><span class="sxs-lookup"><span data-stu-id="96908-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="96908-206">Тем не менее, есть ограничения с услугой:</span><span class="sxs-lookup"><span data-stu-id="96908-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="96908-207">Заказ сообщений не гарантируется.</span><span class="sxs-lookup"><span data-stu-id="96908-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="96908-208">Сообщение может сохраняться только в течение семи дней, прежде чем оно будет автоматически удалено.</span><span class="sxs-lookup"><span data-stu-id="96908-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="96908-209">Поддержка государственного управления, дублирования обнаружения или транзакций недоступна.</span><span class="sxs-lookup"><span data-stu-id="96908-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="96908-210">На рисунке 4-13 показана иерархия очереди хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Иерархия очередей хранения](./media/storage-queue-hierarchy.png)

<span data-ttu-id="96908-212">**Рис. 4-13**.</span><span class="sxs-lookup"><span data-stu-id="96908-212">**Figure 4-13**.</span></span> <span data-ttu-id="96908-213">Иерархия очередей хранения</span><span class="sxs-lookup"><span data-stu-id="96908-213">Storage queue hierarchy</span></span>

<span data-ttu-id="96908-214">На предыдущем рисунке обратите внимание на то, как очереди хранения хранят свои сообщения в основной учетной записи хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="96908-215">Для разработчиков корпорация Майкрософт предоставляет несколько библиотек для обработки очередей хранения данных.</span><span class="sxs-lookup"><span data-stu-id="96908-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="96908-216">Большинство основных платформ поддерживаются, включая .NET, Java, JavaScript, Ruby, Python и Go.</span><span class="sxs-lookup"><span data-stu-id="96908-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="96908-217">Разработчики никогда не должны напрямую общаться с этими библиотеками.</span><span class="sxs-lookup"><span data-stu-id="96908-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="96908-218">Это позволит тесно соединить ваш код микрослужбы с службой Azure Storage Queue.</span><span class="sxs-lookup"><span data-stu-id="96908-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="96908-219">Лучше изолировать детали реализации API.</span><span class="sxs-lookup"><span data-stu-id="96908-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="96908-220">Введите слой посредничества, или промежуточный API, который предоставляет общие операции и инкапсулирует конкретную библиотеку.</span><span class="sxs-lookup"><span data-stu-id="96908-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="96908-221">Эта свободная связь позволяет вам поменять одну службу очередей на другую без внесения изменений в код службы магистральных линий.</span><span class="sxs-lookup"><span data-stu-id="96908-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span>

<span data-ttu-id="96908-222">Очереди хранилища Azure — это экономичный вариант для реализации командных сообщений в облачных приложениях.</span><span class="sxs-lookup"><span data-stu-id="96908-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="96908-223">Особенно, когда размер очереди превысит 80 ГБ, или простой набор функций является приемлемым.</span><span class="sxs-lookup"><span data-stu-id="96908-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="96908-224">Вы платите только за хранение сообщений; нет фиксированных почасовых платежей.</span><span class="sxs-lookup"><span data-stu-id="96908-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="96908-225">Очереди служебной шины Azure</span><span class="sxs-lookup"><span data-stu-id="96908-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="96908-226">Для более сложных требований к обмену сообщениями рассмотрим очереди автобусов Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="96908-227">Расположенный на вершине надежной инфраструктуры сообщений, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) поддерживает *модель обмена сообщениями по средних раз.*</span><span class="sxs-lookup"><span data-stu-id="96908-227">Sitting atop a robust message infrastructure, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="96908-228">Сообщения надежно хранятся в брокере (очередь) до получения потребителем.</span><span class="sxs-lookup"><span data-stu-id="96908-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="96908-229">Очередь гарантирует доставку сообщений First-In/First-Out (FIFO), уважая порядок добавления сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="96908-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="96908-230">Размер сообщения может быть гораздо больше, до 256 кБ.</span><span class="sxs-lookup"><span data-stu-id="96908-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="96908-231">Сообщения сохраняются в очереди в течение неограниченного периода времени.</span><span class="sxs-lookup"><span data-stu-id="96908-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="96908-232">Service Bus поддерживает не только вызовы на основе HTTP, но и обеспечивает полную поддержку [протокола АМПЗ.](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview)</span><span class="sxs-lookup"><span data-stu-id="96908-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMPQ protocol](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="96908-233">АМПЗ является открытым стандартом для всех поставщиков, который поддерживает двоичный протокол и более высокую степень надежности.</span><span class="sxs-lookup"><span data-stu-id="96908-233">AMPQ is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="96908-234">Service Bus предоставляет богатый набор функций, включая [поддержку транзакций](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) и [функцию обнаружения дубликата.](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection)</span><span class="sxs-lookup"><span data-stu-id="96908-234">Service Bus provides a rich set of features, including [transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="96908-235">Очередь гарантирует "не чаще одного раза доставки" за сообщение.</span><span class="sxs-lookup"><span data-stu-id="96908-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="96908-236">Он автоматически отбрасывает уже отправленное сообщение.</span><span class="sxs-lookup"><span data-stu-id="96908-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="96908-237">Если производитель сомневается, он может отправить одно и то же сообщение, и Сервисный автобус гарантирует, что будет обработана только одна копия.</span><span class="sxs-lookup"><span data-stu-id="96908-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="96908-238">Дублирование обнаружения освобождает вас от необходимости строить дополнительную инфраструктуру сантехники.</span><span class="sxs-lookup"><span data-stu-id="96908-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="96908-239">Еще две функции предприятия - раздел и сеансы.</span><span class="sxs-lookup"><span data-stu-id="96908-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="96908-240">Обычная очередь Service Bus обрабатывается одним брокером сообщений и хранится в одном хранилище сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="96908-241">Но, [Раздел saбиста обслуживания](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) распространяет очередь через множественные маклеры сообщений и магазины сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-241">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="96908-242">Общая пропускная способность больше не ограничивается производительностью одного брокера сообщений или магазина обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="96908-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="96908-243">Временное отключение хранилища сообщений не делает недоступной разделенную очередь.</span><span class="sxs-lookup"><span data-stu-id="96908-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="96908-244">[Служба автобусных сессий](https://codingcanvas.com/azure-service-bus-sessions/) обеспечивают способ групповых сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="96908-245">Представьте себе сценарий рабочего процесса, в котором сообщения должны обрабатываться вместе, а операция завершена в конце.</span><span class="sxs-lookup"><span data-stu-id="96908-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="96908-246">Чтобы воспользоваться преимуществами, сеансы должны быть явно включены для очереди, и каждое связанное сообщение должно содержать тот же идентификатор сеанса.</span><span class="sxs-lookup"><span data-stu-id="96908-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="96908-247">Тем не менее, есть некоторые важные предостережения: размер очередей Service Bus ограничен 80 ГБ, что намного меньше, чем то, что доступно в очередях магазинов.</span><span class="sxs-lookup"><span data-stu-id="96908-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="96908-248">Кроме того, очереди Сервисного автобуса несут базовую стоимость и плату за операцию.</span><span class="sxs-lookup"><span data-stu-id="96908-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="96908-249">На рисунке 4-14 описывается архитектура высокого уровня очереди сервисных автобусов.</span><span class="sxs-lookup"><span data-stu-id="96908-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![Очередь служебной шины](./media/service-bus-queue.png)

<span data-ttu-id="96908-251">**Рис. 4-14**.</span><span class="sxs-lookup"><span data-stu-id="96908-251">**Figure 4-14**.</span></span> <span data-ttu-id="96908-252">Очередь служебной шины</span><span class="sxs-lookup"><span data-stu-id="96908-252">Service Bus queue</span></span>

<span data-ttu-id="96908-253">В предыдущем рисунке обратите внимание на отношение по точкам.</span><span class="sxs-lookup"><span data-stu-id="96908-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="96908-254">Два экземпляра одного и того же поставщика заглатывают сообщения в единую очередь Service Bus.</span><span class="sxs-lookup"><span data-stu-id="96908-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="96908-255">Каждое сообщение потребляется только одним из трех экземпляров потребителя справа.</span><span class="sxs-lookup"><span data-stu-id="96908-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="96908-256">Далее мы обсудим, как реализовать сообщения, где разные потребители могут быть заинтересованы в одном и том же сообщении.</span><span class="sxs-lookup"><span data-stu-id="96908-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="96908-257">События</span><span class="sxs-lookup"><span data-stu-id="96908-257">Events</span></span>

<span data-ttu-id="96908-258">Очереди сообщений — это эффективный способ реализации коммуникации, в которой производитель может асинхронно отправлять сообщение потребителю.</span><span class="sxs-lookup"><span data-stu-id="96908-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="96908-259">Однако, что происходит, когда *многие различные потребители* заинтересованы в одном и том же сообщении?</span><span class="sxs-lookup"><span data-stu-id="96908-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="96908-260">Выделенная очередь сообщений для каждого потребителя не будет масштабироваться хорошо и станет трудно управлять.</span><span class="sxs-lookup"><span data-stu-id="96908-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span>

<span data-ttu-id="96908-261">Для решения этого сценария мы переходим к третьему типу взаимодействия сообщений, *событию*.</span><span class="sxs-lookup"><span data-stu-id="96908-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="96908-262">Одна микрослужба сообщает о том, что было совершено действие.</span><span class="sxs-lookup"><span data-stu-id="96908-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="96908-263">Другие микрослужбы, если они заинтересованы, реагируют на действие или событие.</span><span class="sxs-lookup"><span data-stu-id="96908-263">Other microservices, if interested, react to the action, or event.</span></span>

<span data-ttu-id="96908-264">Eventing — это двухэтапный процесс.</span><span class="sxs-lookup"><span data-stu-id="96908-264">Eventing is a two-step process.</span></span> <span data-ttu-id="96908-265">Для данного изменения состояния микрослужба публикует событие брокеру сообщений, делая его доступным для любой другой заинтересованной микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="96908-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="96908-266">Заинтересованная микроуслуга уведомляется, подписавшись на событие в сообщении брокера.</span><span class="sxs-lookup"><span data-stu-id="96908-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="96908-267">Шаблон [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) используется для реализации [коммуникации на основе событий.](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications)</span><span class="sxs-lookup"><span data-stu-id="96908-267">You use the [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="96908-268">На рисунке 4-15 показана микрослужба по покупке, публикуевав случай с двумя другими микрослужбами, подписавшимися на него.</span><span class="sxs-lookup"><span data-stu-id="96908-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Обмен сообщениями с инициативой события](./media/event-driven-messaging.png)

<span data-ttu-id="96908-270">**Рис. 4-15**.</span><span class="sxs-lookup"><span data-stu-id="96908-270">**Figure 4-15**.</span></span> <span data-ttu-id="96908-271">Обмен сообщениями с инициативой события</span><span class="sxs-lookup"><span data-stu-id="96908-271">Event-Driven messaging</span></span>

<span data-ttu-id="96908-272">Обратите внимание на компонент *шины событий,* который находится в середине канала связи.</span><span class="sxs-lookup"><span data-stu-id="96908-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="96908-273">Это пользовательский класс, который инкапсулирует сообщение брокера и отсоединяет его от базового приложения.</span><span class="sxs-lookup"><span data-stu-id="96908-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="96908-274">Заказали и инвентаризации микрослужб самостоятельно управлять событием без знания друг друга, ни микрослужбы корзины покупок.</span><span class="sxs-lookup"><span data-stu-id="96908-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="96908-275">Когда зарегистрированное событие публикуется в автобусе события, они действуют на него.</span><span class="sxs-lookup"><span data-stu-id="96908-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="96908-276">С eventing, мы переходим от технологии очередей к *темам*.</span><span class="sxs-lookup"><span data-stu-id="96908-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="96908-277">[Тема](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) похожа на очередь, но поддерживает шаблон обмена сообщениями от одного к многим.</span><span class="sxs-lookup"><span data-stu-id="96908-277">A [topic](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="96908-278">Одна микрослужба публикует сообщение.</span><span class="sxs-lookup"><span data-stu-id="96908-278">One microservice publishes a message.</span></span> <span data-ttu-id="96908-279">Несколько подподписки микрослужб могут выбрать для получения и действовать на этом сообщении.</span><span class="sxs-lookup"><span data-stu-id="96908-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="96908-280">На рисунке 4-16 показана тема архитектуры.</span><span class="sxs-lookup"><span data-stu-id="96908-280">Figure 4-16 shows a topic architecture.</span></span>

![Архитектура темы](./media/topic-architecture.png)

<span data-ttu-id="96908-282">**Рис. 4-16**.</span><span class="sxs-lookup"><span data-stu-id="96908-282">**Figure 4-16**.</span></span> <span data-ttu-id="96908-283">Архитектура темы</span><span class="sxs-lookup"><span data-stu-id="96908-283">Topic architecture</span></span>

<span data-ttu-id="96908-284">На предыдущем рисунке издатели отправляют сообщения на эту тему.</span><span class="sxs-lookup"><span data-stu-id="96908-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="96908-285">В конце абоненты получают сообщения от подписок.</span><span class="sxs-lookup"><span data-stu-id="96908-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="96908-286">В середине, тема препровождает сообщения к подпискам на основе набора *правил,* показанных в темно-синих коробках.</span><span class="sxs-lookup"><span data-stu-id="96908-286">In the middle, the topic forwards messages to subscriptions based on a set of *rules*, shown in dark blue boxes.</span></span> <span data-ttu-id="96908-287">Правила выступают в качестве фильтра, который перенаправляет определенные сообщения в подписку.</span><span class="sxs-lookup"><span data-stu-id="96908-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="96908-288">Здесь мероприятие "CreateOrder" будет отправлено \#в \#Подписку 1 и \#Подписку 3, но не на подписку 2.</span><span class="sxs-lookup"><span data-stu-id="96908-288">Here, a "CreateOrder" event would be sent to Subscription \#1 and Subscription \#3, but not to Subscription \#2.</span></span> <span data-ttu-id="96908-289">Мероприятие "OrderCompleted" будет отправлено \#в \#подписку 2 и подписку 3.</span><span class="sxs-lookup"><span data-stu-id="96908-289">An "OrderCompleted" event would be sent to Subscription \#2 and Subscription \#3.</span></span>

<span data-ttu-id="96908-290">Облако Azure поддерживает два различных тематических сервиса: Темы для обслуживания служб Azure и Azure EventGrid.</span><span class="sxs-lookup"><span data-stu-id="96908-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="96908-291">Разделы служебной шины Azure</span><span class="sxs-lookup"><span data-stu-id="96908-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="96908-292">Расположенные на вершине той же надежной модели сообщений посреднической связи очередей Azure Service Bus являются [темы автобусов Azure.](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions)</span><span class="sxs-lookup"><span data-stu-id="96908-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="96908-293">Тема может получать сообщения от нескольких независимых издателей и отправлять сообщения до 2000 подписчиков.</span><span class="sxs-lookup"><span data-stu-id="96908-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="96908-294">Подписки могут быть динамически добавлены или удалены во время выполнения, не останавливая систему или воссоздание темы.</span><span class="sxs-lookup"><span data-stu-id="96908-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="96908-295">Многие расширенные функции из очередей Azure Service Bus также доступны для тематических тем, включая [поддержку обнаружения и](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) [транзакций.](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions)</span><span class="sxs-lookup"><span data-stu-id="96908-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) and [Transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="96908-296">По умолчанию темы Service Bus обрабатываются одним брокером сообщений и хранятся в одном хранилище сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="96908-297">Но, [Сервис Ный раздел масштабов](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) темы, распространяя его во многих брокеров сообщений и магазинов сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-297">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="96908-298">[Запланированная доставка сообщений](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) помечает сообщение с определенным временем обработки.</span><span class="sxs-lookup"><span data-stu-id="96908-298">[Scheduled Message Delivery](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="96908-299">Сообщение не будет отображаться в теме до этого времени.</span><span class="sxs-lookup"><span data-stu-id="96908-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="96908-300">[Отсрочка сообщений](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) позволяет отложить поиск сообщения на более позднее время.</span><span class="sxs-lookup"><span data-stu-id="96908-300">[Message Deferral](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="96908-301">Оба они обычно используются в сценариях обработки рабочего процесса, где операции обрабатываются в определенном порядке.</span><span class="sxs-lookup"><span data-stu-id="96908-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="96908-302">Вы можете отложить обработку полученных сообщений до завершения предыдущей работы.</span><span class="sxs-lookup"><span data-stu-id="96908-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="96908-303">Темы Сервисного автобуса — это надежная и проверенная технология, позволяющая публиковать/подписывать связь в облачных системах.</span><span class="sxs-lookup"><span data-stu-id="96908-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="96908-304">Сетка событий Azure</span><span class="sxs-lookup"><span data-stu-id="96908-304">Azure Event Grid</span></span>

<span data-ttu-id="96908-305">В то время как Azure Service Bus является проверенным в бою брокером обмена сообщениями с полным набором корпоративных функций, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) — это новый парень в блоке.</span><span class="sxs-lookup"><span data-stu-id="96908-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="96908-306">На первый взгляд, Event Grid может выглядеть как просто еще одна тема на основе системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="96908-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="96908-307">Тем не менее, это разные во многих отношениях.</span><span class="sxs-lookup"><span data-stu-id="96908-307">However, it's different in many ways.</span></span> <span data-ttu-id="96908-308">Сосредоточенный на рабочих нагрузках, управляемых событиями, он обеспечивает обработку событий в режиме реального времени, глубокую интеграцию Azure и открытую платформу - все это на инфраструктуре без серверов.</span><span class="sxs-lookup"><span data-stu-id="96908-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="96908-309">Он предназначен для современных облачных и без серверных приложений</span><span class="sxs-lookup"><span data-stu-id="96908-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="96908-310">Как централизованная *задняя плоскость*или труба, Event Grid реагирует на события внутри ресурсов Azure и от ваших собственных служб.</span><span class="sxs-lookup"><span data-stu-id="96908-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="96908-311">Уведомления о событиях публикуются в тему Event Grid Topic, которая, в свою очередь, направляет каждое событие в подписку.</span><span class="sxs-lookup"><span data-stu-id="96908-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="96908-312">Подписчики отображают карту подписок и потребляют события.</span><span class="sxs-lookup"><span data-stu-id="96908-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="96908-313">Как и Service Bus, Event Grid поддерживает *отфильтрованную модель абонента,* в которой подписка устанавливает правило для событий, которые она хочет получить.</span><span class="sxs-lookup"><span data-stu-id="96908-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="96908-314">Event Grid обеспечивает быструю пропускную связь с гарантией 10 миллионов событий в секунду, что позволяет осуществлять доставку в режиме реального времени , что намного больше, чем может генерировать Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="96908-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="96908-315">Сладким местом для Event Grid является его глубокая интеграция в структуру инфраструктуры Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="96908-316">Ресурс Azure, такой как Cosmos DB, может публиковать встроенные события непосредственно в другие заинтересованные ресурсы Azure без необходимости в пользовательском коде.</span><span class="sxs-lookup"><span data-stu-id="96908-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="96908-317">Event Grid может публиковать события из группы ресурсов Azure, группы ресурсов или службы, предоставляя разработчикам возможность контролировать жизненный цикл облачных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="96908-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="96908-318">Однако Event Grid не ограничивается Azure.</span><span class="sxs-lookup"><span data-stu-id="96908-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="96908-319">Это открытая платформа, которая может использовать пользовательские события HTTP, опубликованные из приложений или сторонних служб и маршрут событий для внешних абонентов.</span><span class="sxs-lookup"><span data-stu-id="96908-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="96908-320">При публикации и подписке на местные события из ресурсов Azure кодирование не требуется.</span><span class="sxs-lookup"><span data-stu-id="96908-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="96908-321">С помощью простой конфигурации можно интегрировать события с одного ресурса Azure в другой, используя встроенную сантехнику для тем и подписки.</span><span class="sxs-lookup"><span data-stu-id="96908-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="96908-322">На рисунке 4-17 показана анатомия Event Grid.</span><span class="sxs-lookup"><span data-stu-id="96908-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Анатомия сетки событий](./media/event-grid-anatomy.png)

<span data-ttu-id="96908-324">**Рис. 4-17**.</span><span class="sxs-lookup"><span data-stu-id="96908-324">**Figure 4-17**.</span></span> <span data-ttu-id="96908-325">Анатомия сетки событий</span><span class="sxs-lookup"><span data-stu-id="96908-325">Event Grid anatomy</span></span>

<span data-ttu-id="96908-326">Основным отличием EventGrid от Service Bus является базовый *шаблон обмена сообщениями.*</span><span class="sxs-lookup"><span data-stu-id="96908-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="96908-327">Service Bus реализует старую *модель притяжения* стиля, в которой нижепом абонент активно опросы тему подписки на новые сообщения.</span><span class="sxs-lookup"><span data-stu-id="96908-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="96908-328">С другой стороны, этот подход дает абоненту полный контроль над темпами, с которыми он обрабатывает сообщения.</span><span class="sxs-lookup"><span data-stu-id="96908-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="96908-329">Он контролирует, когда и сколько сообщений для обработки в любой момент времени.</span><span class="sxs-lookup"><span data-stu-id="96908-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="96908-330">Непрочитае сообщения остаются в подписке до обработки.</span><span class="sxs-lookup"><span data-stu-id="96908-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="96908-331">Существенным недостатком является задержка между моментом возникновения события и операцией опроса, которая тянет это сообщение к абоненту для обработки.</span><span class="sxs-lookup"><span data-stu-id="96908-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="96908-332">Кроме того, накладные расходы на постоянное голосование на следующее мероприятие потребляет ресурсы и деньги.</span><span class="sxs-lookup"><span data-stu-id="96908-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="96908-333">EventGrid, однако, отличается.</span><span class="sxs-lookup"><span data-stu-id="96908-333">EventGrid, however, is different.</span></span> <span data-ttu-id="96908-334">Он реализует *модель push,* в которой события отправляются в EventHandlers в качестве полученных, предоставляя почти в режиме реального времени доставку событий.</span><span class="sxs-lookup"><span data-stu-id="96908-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="96908-335">Это также снижает стоимость, поскольку служба срабатывает только тогда, когда она необходима для потребления события - не постоянно, как с опроса.</span><span class="sxs-lookup"><span data-stu-id="96908-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="96908-336">Тем не менее, обработчик событий должен обрабатывать входящие нагрузки и обеспечивать механизмы регулирования, чтобы защитить себя от перегружены.</span><span class="sxs-lookup"><span data-stu-id="96908-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="96908-337">Многие службы Azure, потребляющие эти события, такие как Функции Azure и логические приложения, предоставляют возможности автоматического автоматического масштабирования для обработки повышенных нагрузок.</span><span class="sxs-lookup"><span data-stu-id="96908-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="96908-338">Event Grid — это полностью управляемый облачный сервис без серверов.</span><span class="sxs-lookup"><span data-stu-id="96908-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="96908-339">Он динамически масштабируется на основе вашего трафика и взимает плату только за ваше фактическое использование, а не предварительно приобретенные мощности.</span><span class="sxs-lookup"><span data-stu-id="96908-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="96908-340">Первые 100 000 операций в месяц являются бесплатными – операции определяются как вход события (входящие уведомления о событиях), попытки доставки подписок, вызовы управления и фильтрация по субъекту.</span><span class="sxs-lookup"><span data-stu-id="96908-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="96908-341">С 99,99% доступности, EventGrid гарантирует доставку события в течение 24-часового периода, со встроенной функциональностью повтора для неудачной доставки.</span><span class="sxs-lookup"><span data-stu-id="96908-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="96908-342">Недоставленные сообщения могут быть перемещены в очередь «мертвого письма» для разрешения.</span><span class="sxs-lookup"><span data-stu-id="96908-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="96908-343">В отличие от Azure Service Bus, Event Grid настроен анаментируется для быстрой работы и не поддерживает такие функции, как упорядоченные сообщения, транзакции и сеансы.</span><span class="sxs-lookup"><span data-stu-id="96908-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="96908-344">Потоковые сообщения в облаке Azure</span><span class="sxs-lookup"><span data-stu-id="96908-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="96908-345">Служба обслуживания Azure и Event Grid обеспечивают большую поддержку приложениям, которые разоблачают отдельные, дискретные события, такие как новый документ, вставленный в DB Космоса.</span><span class="sxs-lookup"><span data-stu-id="96908-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document has been inserted into a Cosmos DB.</span></span> <span data-ttu-id="96908-346">Но что делать, если ваша облачная система должна обрабатывать *поток связанных событий?*</span><span class="sxs-lookup"><span data-stu-id="96908-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="96908-347">Потоки событий являются более [сложными.](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems)</span><span class="sxs-lookup"><span data-stu-id="96908-347">[Event streams](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) are more complex.</span></span> <span data-ttu-id="96908-348">Они обычно упорядочены по времени, взаимосвязаны и должны обрабатываться как группа.</span><span class="sxs-lookup"><span data-stu-id="96908-348">They're typically time-ordered, interrelated, and must be processed as a group.</span></span>

<span data-ttu-id="96908-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) — это платформа для потоковой передачи данных и служба приема событий, которая собирает, преобразует и хранит события.</span><span class="sxs-lookup"><span data-stu-id="96908-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="96908-350">Он дорабатывается для захвата потоковых данных, таких как непрерывные уведомления о событиях, испускаемые из контекста телеметрии.</span><span class="sxs-lookup"><span data-stu-id="96908-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="96908-351">Услуга очень масштабируема и может хранить и [обрабатывать миллионы событий в секунду.](https://docs.microsoft.com/azure/event-hubs/event-hubs-about)</span><span class="sxs-lookup"><span data-stu-id="96908-351">The service is highly scalable and can store and [process millions of events per second](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="96908-352">Показано на рисунке 4-18, это часто входная дверь для конвейера событий, разъединяя поток глотать от потребления событий.</span><span class="sxs-lookup"><span data-stu-id="96908-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![концентратору событий Azure](./media/azure-event-hub.png)

<span data-ttu-id="96908-354">**Рис. 4-18**.</span><span class="sxs-lookup"><span data-stu-id="96908-354">**Figure 4-18**.</span></span> <span data-ttu-id="96908-355">концентратору событий Azure</span><span class="sxs-lookup"><span data-stu-id="96908-355">Azure Event Hub</span></span>

<span data-ttu-id="96908-356">Концентратор событий поддерживает низкую задержку и настраиваемое время удержания.</span><span class="sxs-lookup"><span data-stu-id="96908-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="96908-357">В отличие от очередей и тем, концентраторы событий хранят данные о событиях после их прочтения потребителем.</span><span class="sxs-lookup"><span data-stu-id="96908-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="96908-358">Эта функция позволяет другим аналитическим службам данных, как внутренним, так и внешним, воспроизводить данные для дальнейшего анализа.</span><span class="sxs-lookup"><span data-stu-id="96908-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="96908-359">События, хранящиеся в концентраторе событий, удаляются только по истечении периода хранения, который является одним днем по умолчанию, но настраивается.</span><span class="sxs-lookup"><span data-stu-id="96908-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="96908-360">Концентратор событий поддерживает общие протоколы публикации событий, включая HTTPS и АМЗП.</span><span class="sxs-lookup"><span data-stu-id="96908-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="96908-361">Он также поддерживает Кафку 1.0.</span><span class="sxs-lookup"><span data-stu-id="96908-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="96908-362">[Существующие приложения Kafka могут общаться с Event Hub,](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) используя протокол Kafka, предоставляя альтернативу управлению большими кластерами Kafka.</span><span class="sxs-lookup"><span data-stu-id="96908-362">[Existing Kafka applications can communicate with Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="96908-363">Многие облачные системы с открытым исходным кодом охватывают Kafka.</span><span class="sxs-lookup"><span data-stu-id="96908-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="96908-364">Концентраторы событий реализуют потоковую передачу сообщений через [разделенную модель потребителя,](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) в которой каждый потребитель читает только определенный подмножество или раздел потока сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-364">Event Hubs implements message streaming through a [partitioned consumer model](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="96908-365">Это позволяет получить непревзойденные преимущества горизонтального масштабирования для обработки событий и другие ориентированные на работу с потоками функции, недоступные в очередях и разделах.</span><span class="sxs-lookup"><span data-stu-id="96908-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="96908-366">Секция — это упорядоченная последовательность событий, хранящаяся в концентраторе событий.</span><span class="sxs-lookup"><span data-stu-id="96908-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="96908-367">По мере поступления новых событий они добавляются к концу этой последовательности.</span><span class="sxs-lookup"><span data-stu-id="96908-367">As newer events arrive, they're added to the end of this sequence.</span></span><span data-ttu-id="96908-368">На рисунке 4-19 показана разделвивание в концентраторе событий.</span><span class="sxs-lookup"><span data-stu-id="96908-368"> Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Разделки концентратора событий](./media/event-hub-partitioning.png)

<span data-ttu-id="96908-370">**Рис. 4-19**.</span><span class="sxs-lookup"><span data-stu-id="96908-370">**Figure 4-19**.</span></span> <span data-ttu-id="96908-371">Разделки концентратора событий</span><span class="sxs-lookup"><span data-stu-id="96908-371">Event Hub partitioning</span></span>

<span data-ttu-id="96908-372">Вместо того, чтобы читать с одного ресурса, каждая группа потребителей читает через подмножество или раздел потока сообщений.</span><span class="sxs-lookup"><span data-stu-id="96908-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span>

<span data-ttu-id="96908-373">Для облачных приложений, которые должны передавать большое количество событий, Azure Event Hub может стать надежным и доступным решением.</span><span class="sxs-lookup"><span data-stu-id="96908-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="96908-374">[Предыдущий](front-end-communication.md)
>[Следующий](rest-grpc.md)</span><span class="sxs-lookup"><span data-stu-id="96908-374">[Previous](front-end-communication.md)
[Next](rest-grpc.md)</span></span>
