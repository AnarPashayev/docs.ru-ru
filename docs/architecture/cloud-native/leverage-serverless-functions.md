---
title: Использование бессерверных функций
description: Использование бессерверных и функций Azure в собственных облачных приложениях
ms.date: 05/13/2020
ms.openlocfilehash: 8e5c60d29cd8d635f79f42c232b33f060949e2b5
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2020
ms.locfileid: "91155371"
---
# <a name="leveraging-serverless-functions"></a><span data-ttu-id="ea131-103">Использование бессерверных функций</span><span class="sxs-lookup"><span data-stu-id="ea131-103">Leveraging serverless functions</span></span>

<span data-ttu-id="ea131-104">В спектре от управления физическими компьютерами до использования облачных возможностей бессерверные функции находятся в крайнем конце.</span><span class="sxs-lookup"><span data-stu-id="ea131-104">In the spectrum from managing physical machines to leveraging cloud capabilities, serverless lives at the extreme end.</span></span> <span data-ttu-id="ea131-105">Единственной обязанностью является ваш код, и вы платите только за время выполнения кода.</span><span class="sxs-lookup"><span data-stu-id="ea131-105">Your only responsibility is your code, and you only pay when your code runs.</span></span> <span data-ttu-id="ea131-106">Функции Azure предоставляют возможность создания бессерверных функций в собственных облачных приложениях.</span><span class="sxs-lookup"><span data-stu-id="ea131-106">Azure Functions provides a way to build serverless capabilities into your cloud-native applications.</span></span>

## <a name="what-is-serverless"></a><span data-ttu-id="ea131-107">Что значит "без сервера"?</span><span class="sxs-lookup"><span data-stu-id="ea131-107">What is serverless?</span></span>

<span data-ttu-id="ea131-108">Бессерверные технологии — это относительно новая модель службы облачных вычислений.</span><span class="sxs-lookup"><span data-stu-id="ea131-108">Serverless is a relatively new service model of cloud computing.</span></span> <span data-ttu-id="ea131-109">Это не означает, что серверы являются необязательными. код по-прежнему работает на сервере где-то еще.</span><span class="sxs-lookup"><span data-stu-id="ea131-109">It doesn't mean that servers are optional - your code still runs on a server somewhere.</span></span> <span data-ttu-id="ea131-110">Различие состоит в том, что группа приложений больше не связана с управлением серверной инфраструктурой.</span><span class="sxs-lookup"><span data-stu-id="ea131-110">The distinction is that the application team no longer concerns itself with managing server infrastructure.</span></span> <span data-ttu-id="ea131-111">Вместо этого ответственность за это несет поставщик облачных вычислений.</span><span class="sxs-lookup"><span data-stu-id="ea131-111">Instead, the cloud vendor own this responsibility.</span></span> <span data-ttu-id="ea131-112">Команда разработчиков повышает производительность за счет предоставления бизнес-решений клиентам, а не коммуникации.</span><span class="sxs-lookup"><span data-stu-id="ea131-112">The development team increases its productivity by delivering business solutions to customers, not plumbing.</span></span>

<span data-ttu-id="ea131-113">Бессерверные вычисления используют контейнеры, активируемые событиями без отслеживания состояния, для размещения служб.</span><span class="sxs-lookup"><span data-stu-id="ea131-113">Serverless computing uses event-triggered stateless containers to host your services.</span></span> <span data-ttu-id="ea131-114">Они могут масштабироваться и в для удовлетворения спроса по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="ea131-114">They can scale out and in to meet demand as-needed.</span></span> <span data-ttu-id="ea131-115">Бессерверные платформы, такие как функции Azure, тесно интегрируются с другими службами Azure, такими как очереди, события и хранилище.</span><span class="sxs-lookup"><span data-stu-id="ea131-115">Serverless platforms like Azure Functions have tight integration with other Azure services like queues, events, and storage.</span></span>

## <a name="what-challenges-are-solved-by-serverless"></a><span data-ttu-id="ea131-116">Какие проблемы решаются независимо от сервера?</span><span class="sxs-lookup"><span data-stu-id="ea131-116">What challenges are solved by serverless?</span></span>

<span data-ttu-id="ea131-117">Бессерверные платформы изменяют множество ресурсоемких и дорогостоящих проблем:</span><span class="sxs-lookup"><span data-stu-id="ea131-117">Serverless platforms address many time-consuming and expensive concerns:</span></span>

- <span data-ttu-id="ea131-118">Приобретение компьютеров и лицензий на программное обеспечение</span><span class="sxs-lookup"><span data-stu-id="ea131-118">Purchasing machines and software licenses</span></span>
- <span data-ttu-id="ea131-119">Корпус, обеспечение безопасности, Настройка и обслуживание компьютеров и их сети, мощности и требований к/C</span><span class="sxs-lookup"><span data-stu-id="ea131-119">Housing, securing, configuring, and maintaining the machines and their networking, power, and A/C requirements</span></span>
- <span data-ttu-id="ea131-120">Установка исправлений и обновление операционных систем и программного обеспечения</span><span class="sxs-lookup"><span data-stu-id="ea131-120">Patching and upgrading operating systems and software</span></span>
- <span data-ttu-id="ea131-121">Настройка веб-серверов или служб компьютеров для размещения программного обеспечения приложения</span><span class="sxs-lookup"><span data-stu-id="ea131-121">Configuring web servers or machine services to host application software</span></span>
- <span data-ttu-id="ea131-122">Настройка программного обеспечения приложения на платформе</span><span class="sxs-lookup"><span data-stu-id="ea131-122">Configuring application software within its platform</span></span>

<span data-ttu-id="ea131-123">Многие компании распределяют большие бюджеты для поддержки проблем с инфраструктурой оборудования.</span><span class="sxs-lookup"><span data-stu-id="ea131-123">Many companies allocate large budgets to support hardware infrastructure concerns.</span></span> <span data-ttu-id="ea131-124">Переход в облако поможет снизить затраты. Перемещение приложений на сервер может помочь устранить их.</span><span class="sxs-lookup"><span data-stu-id="ea131-124">Moving to the cloud can help reduce these costs; shifting applications to serverless can help eliminate them.</span></span>

## <a name="what-is-the-difference-between-a-microservice-and-a-serverless-function"></a><span data-ttu-id="ea131-125">В чем разница между микрослужбой и бессерверной функцией?</span><span class="sxs-lookup"><span data-stu-id="ea131-125">What is the difference between a microservice and a serverless function?</span></span>

<span data-ttu-id="ea131-126">Обычно микрослужба включает бизнес-возможности, такие как покупательская корзина для веб-сайта электронной коммерции.</span><span class="sxs-lookup"><span data-stu-id="ea131-126">Typically, a microservice encapsulates a business capability, such as a shopping cart for an online eCommerce site.</span></span> <span data-ttu-id="ea131-127">Она предоставляет несколько операций, которые позволяют пользователю управлять своими покупками.</span><span class="sxs-lookup"><span data-stu-id="ea131-127">It exposes multiple operations that enable a user to manage their shopping experience.</span></span> <span data-ttu-id="ea131-128">Однако функция является небольшим простым блоком кода, который выполняет однозначную операцию в ответ на событие.</span><span class="sxs-lookup"><span data-stu-id="ea131-128">A function, however, is a small, lightweight block of code that executes a single-purpose operation in response to an event.</span></span>
<span data-ttu-id="ea131-129">Микрослужбы обычно создаются для реагирования на запросы, часто из интерфейса.</span><span class="sxs-lookup"><span data-stu-id="ea131-129">Microservices are typically constructed to respond to requests, often from an interface.</span></span> <span data-ttu-id="ea131-130">Запросы могут быть на базе HTTP gRPC или на основе запросов.</span><span class="sxs-lookup"><span data-stu-id="ea131-130">Requests can be HTTP Rest- or gRPC-based.</span></span> <span data-ttu-id="ea131-131">Бессерверные службы реагируют на события.</span><span class="sxs-lookup"><span data-stu-id="ea131-131">Serverless services respond to events.</span></span> <span data-ttu-id="ea131-132">Ее архитектура, управляемая событиями, идеально подходит для обработки кратковременных фоновых задач.</span><span class="sxs-lookup"><span data-stu-id="ea131-132">Its event-driven architecture is ideal for processing short-running, background tasks.</span></span>

## <a name="what-scenarios-are-appropriate-for-serverless"></a><span data-ttu-id="ea131-133">Какие сценарии подходят для бессерверных задач?</span><span class="sxs-lookup"><span data-stu-id="ea131-133">What scenarios are appropriate for serverless?</span></span>

<span data-ttu-id="ea131-134">Бессерверные программы предоставляют отдельные кратковременные функции, которые вызываются в ответ на триггер.</span><span class="sxs-lookup"><span data-stu-id="ea131-134">Serverless exposes individual short-running functions that are invoked in response to a trigger.</span></span> <span data-ttu-id="ea131-135">Это делает их идеальным решением для обработки фоновых задач.</span><span class="sxs-lookup"><span data-stu-id="ea131-135">This makes them ideal for processing background tasks.</span></span>

<span data-ttu-id="ea131-136">Приложению может потребоваться отправить сообщение электронной почты в качестве шага в рабочем процессе.</span><span class="sxs-lookup"><span data-stu-id="ea131-136">An application might need to send an email as a step in a workflow.</span></span> <span data-ttu-id="ea131-137">Вместо отправки уведомления в рамках запроса микрослужбы поместите сведения о сообщении в очередь.</span><span class="sxs-lookup"><span data-stu-id="ea131-137">Instead of sending the notification as part of a microservice request, place the message details onto a queue.</span></span> <span data-ttu-id="ea131-138">Функция Azure может вывести сообщение из очереди и асинхронно отправить сообщение.</span><span class="sxs-lookup"><span data-stu-id="ea131-138">An Azure Function can dequeue the message and asynchronously send the email.</span></span> <span data-ttu-id="ea131-139">Это может повысить производительность и масштабируемость микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="ea131-139">Doing so could improve the performance and scalability of the microservice.</span></span> <span data-ttu-id="ea131-140">Можно реализовать [Выравнивание нагрузки на основе очередей](/azure/architecture/patterns/queue-based-load-leveling) , чтобы избежать узких мест, связанных с отправкой сообщений электронной почты.</span><span class="sxs-lookup"><span data-stu-id="ea131-140">[Queue-based load leveling](/azure/architecture/patterns/queue-based-load-leveling) can be implemented to avoid bottlenecks related to sending the emails.</span></span> <span data-ttu-id="ea131-141">Кроме того, эту автономную службу можно повторно использовать в качестве служебной программы во многих разных приложениях.</span><span class="sxs-lookup"><span data-stu-id="ea131-141">Additionally, this stand-alone service could be reused as a utility across many different applications.</span></span>

<span data-ttu-id="ea131-142">Асинхронный обмен сообщениями из очередей и разделов является распространенным шаблоном для активации бессерверных функций.</span><span class="sxs-lookup"><span data-stu-id="ea131-142">Asynchronous messaging from queues and topics is a common pattern to trigger serverless functions.</span></span> <span data-ttu-id="ea131-143">Однако функции Azure могут инициироваться другими событиями, например изменениями в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="ea131-143">However, Azure Functions can be triggered by other events, such as changes to Azure Blob Storage.</span></span> <span data-ttu-id="ea131-144">Служба, поддерживающая передачу изображений, может иметь функцию Azure, отвечающую за оптимизацию размера образа.</span><span class="sxs-lookup"><span data-stu-id="ea131-144">A service that supports image uploads could have an Azure Function responsible for optimizing the image size.</span></span> <span data-ttu-id="ea131-145">Функция может быть активирована непосредственно путем вставки в хранилище BLOB-объектов Azure, что усложняет работу операций микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="ea131-145">The function could be triggered directly by inserts into Azure Blob Storage, keeping complexity out of the microservice operations.</span></span>

<span data-ttu-id="ea131-146">Многие службы имеют длительно работающие процессы в рамках рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="ea131-146">Many services have long-running processes as part of their workflows.</span></span> <span data-ttu-id="ea131-147">Часто эти задачи выполняются как часть взаимодействия пользователя с приложением.</span><span class="sxs-lookup"><span data-stu-id="ea131-147">Often these tasks are done as part of the user's interaction with the application.</span></span> <span data-ttu-id="ea131-148">Эти задачи могут заставить пользователя ожидать, негативно влияя на их работу.</span><span class="sxs-lookup"><span data-stu-id="ea131-148">These tasks can force the user to wait, negatively impacting their experience.</span></span> <span data-ttu-id="ea131-149">Бессерверные вычисления предоставляют отличный способ перемещения более медленных задач за пределы цикла взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="ea131-149">Serverless computing provides a great way to move slower tasks outside of the user interaction loop.</span></span> <span data-ttu-id="ea131-150">Эти задачи можно масштабировать по запросу, не требуя масштабирования всего приложения.</span><span class="sxs-lookup"><span data-stu-id="ea131-150">These tasks can scale with demand without requiring the entire application to scale.</span></span>

## <a name="when-should-you-avoid-serverless"></a><span data-ttu-id="ea131-151">Когда следует избегать бессерверных проблем?</span><span class="sxs-lookup"><span data-stu-id="ea131-151">When should you avoid serverless?</span></span>

<span data-ttu-id="ea131-152">Бессерверные решения подготавливаются и масштабируются по запросу.</span><span class="sxs-lookup"><span data-stu-id="ea131-152">Serverless solutions provision and scale on demand.</span></span> <span data-ttu-id="ea131-153">При вызове нового экземпляра холодный запуск является распространенной проблемой.</span><span class="sxs-lookup"><span data-stu-id="ea131-153">When a new instance is invoked, cold starts are a common issue.</span></span> <span data-ttu-id="ea131-154">Холодный запуск — это период времени, требуемый для инициализации этого экземпляра.</span><span class="sxs-lookup"><span data-stu-id="ea131-154">A cold start is the period of time it takes to provision this instance.</span></span> <span data-ttu-id="ea131-155">Обычно эта задержка может составлять несколько секунд, но она может быть длиннее в зависимости от различных факторов.</span><span class="sxs-lookup"><span data-stu-id="ea131-155">Normally, this delay might be a few seconds, but can be longer depending on various factors.</span></span> <span data-ttu-id="ea131-156">После подготовки один экземпляр сохраняется в активном состоянии до тех пор, пока он получает периодические запросы.</span><span class="sxs-lookup"><span data-stu-id="ea131-156">Once provisioned, a single instance is kept alive as long as it receives periodic requests.</span></span> <span data-ttu-id="ea131-157">Но если служба вызывается реже, Azure может удалить ее из памяти и требовать холодного запуска при повторном вызове.</span><span class="sxs-lookup"><span data-stu-id="ea131-157">But, if a service is called less frequently, Azure may remove it from memory and require a cold start when reinvoked.</span></span> <span data-ttu-id="ea131-158">Холодный запуск также требуется, когда функция масштабируется до нового экземпляра.</span><span class="sxs-lookup"><span data-stu-id="ea131-158">Cold starts are also required when a function scales out to a new instance.</span></span>

<span data-ttu-id="ea131-159">На рис. 3-10 показан шаблон холодного запуска.</span><span class="sxs-lookup"><span data-stu-id="ea131-159">Figure 3-10 shows a cold-start pattern.</span></span> <span data-ttu-id="ea131-160">Обратите внимание на дополнительные шаги, необходимые для холодного приложения.</span><span class="sxs-lookup"><span data-stu-id="ea131-160">Note the extra steps required when the app is cold.</span></span>

<span data-ttu-id="ea131-161">![Холодный и горячий запуск ](./media/cold-start-warm-start.png)
 **рис. 3-10**.</span><span class="sxs-lookup"><span data-stu-id="ea131-161">![Cold versus warm start](./media/cold-start-warm-start.png)
**Figure 3-10**.</span></span> <span data-ttu-id="ea131-162">Холодный запуск и горячий запуск.</span><span class="sxs-lookup"><span data-stu-id="ea131-162">Cold start versus warm start.</span></span>

<span data-ttu-id="ea131-163">Чтобы избежать холодного запуска, вы можете переключиться с [плана потребления на выделенный план](https://azure.microsoft.com/blog/understanding-serverless-cold-start/).</span><span class="sxs-lookup"><span data-stu-id="ea131-163">To avoid cold starts entirely, you might switch from a [consumption plan to a dedicated plan](https://azure.microsoft.com/blog/understanding-serverless-cold-start/).</span></span> <span data-ttu-id="ea131-164">Вы также можете настроить один или несколько [предварительно подготовленных экземпляров](/azure/azure-functions/functions-premium-plan#pre-warmed-instances) с помощью обновления плана Premium.</span><span class="sxs-lookup"><span data-stu-id="ea131-164">You can also configure one or more [pre-warmed instances](/azure/azure-functions/functions-premium-plan#pre-warmed-instances) with the premium plan upgrade.</span></span> <span data-ttu-id="ea131-165">В таких случаях, когда необходимо добавить другой экземпляр, он уже готов к работе.</span><span class="sxs-lookup"><span data-stu-id="ea131-165">In these cases, when you need to add another instance, it's already up and ready to go.</span></span> <span data-ttu-id="ea131-166">Эти параметры могут помочь устранить проблемы холодного запуска, связанные с бессерверными вычислениями.</span><span class="sxs-lookup"><span data-stu-id="ea131-166">These options can help mitigate the cold start issue associated with serverless computing.</span></span>

<span data-ttu-id="ea131-167">Поставщики облачных служб выставляют счета за бессерверные ресурсы в зависимости от времени выполнения вычислений и потребленной памяти.</span><span class="sxs-lookup"><span data-stu-id="ea131-167">Cloud providers bill for serverless based on compute execution time and consumed memory.</span></span> <span data-ttu-id="ea131-168">Длительные операции или рабочие нагрузки с высоким потреблением памяти не всегда являются лучшими кандидатами для бессерверных.</span><span class="sxs-lookup"><span data-stu-id="ea131-168">Long running operations or high memory consumption workloads aren't always the best candidates for serverless.</span></span> <span data-ttu-id="ea131-169">Бессерверные функции применяют небольшие фрагменты работы, которые могут быть быстро завершены.</span><span class="sxs-lookup"><span data-stu-id="ea131-169">Serverless functions favor small chunks of work that can complete quickly.</span></span> <span data-ttu-id="ea131-170">Большинству бессерверных платформ требуется, чтобы отдельные функции были выполнены в течение нескольких минут.</span><span class="sxs-lookup"><span data-stu-id="ea131-170">Most serverless platforms require individual functions to complete within a few minutes.</span></span> <span data-ttu-id="ea131-171">По умолчанию для функций Azure устанавливается длительность ожидания в 5 минут, что может быть настроено до 10 минут.</span><span class="sxs-lookup"><span data-stu-id="ea131-171">Azure Functions defaults to a 5-minute time-out duration, which can be configured up to 10 minutes.</span></span> <span data-ttu-id="ea131-172">План функций Azure Premium может также устранить эту ошибку, а время ожидания по умолчанию — 30 минут с неограниченным большим ограничением, которое можно настроить.</span><span class="sxs-lookup"><span data-stu-id="ea131-172">The Azure Functions premium plan can mitigate this issue as well, defaulting time-outs to 30 minutes with an unbounded higher limit that can be configured.</span></span> <span data-ttu-id="ea131-173">Время вычислений не является календарным временем.</span><span class="sxs-lookup"><span data-stu-id="ea131-173">Compute time isn't calendar time.</span></span> <span data-ttu-id="ea131-174">Более сложные функции, использующие [Azure устойчивые функции Framework](/azure/azure-functions/durable/durable-functions-overview?tabs=csharp) , могут приостановить выполнение в течение нескольких дней.</span><span class="sxs-lookup"><span data-stu-id="ea131-174">More advanced functions using the [Azure Durable Functions framework](/azure/azure-functions/durable/durable-functions-overview?tabs=csharp) may pause execution over a course of several days.</span></span> <span data-ttu-id="ea131-175">Выставление счетов основано на фактическом времени выполнения, когда функция выходит из спящего режима и продолжает обработку.</span><span class="sxs-lookup"><span data-stu-id="ea131-175">The billing is based on actual execution time - when the function wakes up and resumes processing.</span></span>

<span data-ttu-id="ea131-176">Наконец, использование функций Azure для задач приложения усложняет сложность.</span><span class="sxs-lookup"><span data-stu-id="ea131-176">Finally, leveraging Azure Functions for application tasks adds complexity.</span></span> <span data-ttu-id="ea131-177">Разумно сначала спроектировать приложение с помощью модульной, слабо связанной архитектуры.</span><span class="sxs-lookup"><span data-stu-id="ea131-177">It's wise to first architect your application with a modular, loosely coupled design.</span></span> <span data-ttu-id="ea131-178">Затем выясните, есть ли у сервера преимущества, которые будут предлагаться, чтобы выровнять дополнительную сложность.</span><span class="sxs-lookup"><span data-stu-id="ea131-178">Then, identify if there are benefits serverless would offer that justify the additional complexity.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="ea131-179">[Назад](leverage-containers-orchestrators.md)
>[Вперед](combine-containers-serverless-approaches.md)</span><span class="sxs-lookup"><span data-stu-id="ea131-179">[Previous](leverage-containers-orchestrators.md)
[Next](combine-containers-serverless-approaches.md)</span></span>
