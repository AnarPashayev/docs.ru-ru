---
title: Azure Monitor
description: Использование Azure Monitor, чтобы получить представление о работающей системе.
ms.date: 01/19/2021
ms.openlocfilehash: a93b71db642e05a830b20b80d8387c24d35ea8c1
ms.sourcegitcommit: f2ab02d9a780819ca2e5310bbcf5cfe5b7993041
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "99506179"
---
# <a name="azure-monitor"></a>Azure Monitor

Ни один другой поставщик облачных решений не является устаревшим решением для мониторинга облачных приложений, чем найдено в Azure. Azure Monitor — это имя-пользователя для набора средств, предназначенных для обеспечения видимости состояния системы. Он помогает понять, как работают облачные службы и заранее выявляет проблемы, влияющие на них. На рис. 7-12 представлен высокий уровень представления Azure Monitor.

![Высокоуровневое представление Azure Monitor. ](./media/azure-monitor.png)
 **Рис. 7-12**. Высокоуровневое представление Azure Monitor.

## <a name="gathering-logs-and-metrics"></a>Сбор журналов и метрик

Первым шагом в любом решении для мониторинга является сбор максимально возможного объема данных. Чем больше собранных данных, тем глубже ценная информация. Работа с системными инструментами традиционно была сложной задачей. Протокол SNMP был стандартным протоколом для сбора информации на уровне компьютера, но он требовал значительных знаний и конфигурации. К счастью, большая часть этой жесткой работы была устранена, так как наиболее распространенные метрики автоматически собираются Azure Monitor.

Метрики и события уровня приложения не могут быть инструментированы автоматически, поскольку они относятся к развертываемому приложению. Для сбора этих метрик доступны [пакеты SDK и API](/azure/azure-monitor/app/api-custom-events-metrics) , которые позволяют напрямую сообщать такую информацию, например, когда клиент регистрируется или завершает заказ. Исключения также могут быть перехвачены и возвращены в Azure Monitor с помощью Application Insights. Пакеты SDK поддерживают большинство языков в собственных облачных приложениях, в том числе Go, Python, JavaScript и .NET.

Основная цель сбора сведений о состоянии приложения — обеспечить хорошую работу конечных пользователей. Какой лучший способ узнать, возникают ли проблемы у пользователей, чем [за пределами веб-тестов](/azure/azure-monitor/app/monitor-web-app-availability)? Эти тесты могут быть простыми при проверке связи с веб-сайтом из расположений по всему миру или в том случае, если агенты входят в систему на сайте и имитируют действия пользователя.

## <a name="reporting-data"></a>Данные отчетов

После сбора данных их можно обменять, суммировать и отображать на диаграммах, что позволяет пользователям мгновенно видеть, когда возникают проблемы. Эти диаграммы могут быть собраны на панели мониторинга или в книги, многостраничный отчет, предназначенный для описания некоторых аспектов системы.

Ни одно современное приложение не было бы полным без искусственного интеллекта или машинного обучения. Для этого данные [могут быть переданы](https://www.youtube.com/watch?v=Cuza-I1g9tw) различным средствам машинного обучения в Azure, что позволяет извлекать тенденции и информацию, которые в противном случае были бы скрыты.

Application Insights предоставляет мощный (похожий на SQL) язык запросов, именуемый *Kusto* , который может запрашивать записи, суммировать их и даже строить диаграммы. Например, следующий запрос найдет все записи за 2007 ноября, сгруппировать их по штату и выстроить 10 лучших в виде круговой диаграммы.

```kusto
StormEvents
| where StartTime >= datetime(2007-11-01) and StartTime < datetime(2007-12-01)
| summarize count() by State
| top 10 by count_
| render piechart
```

На рис. 7-13 показаны результаты этого запроса Application Insights.

![Application Insights результаты запроса ](./media/application_insights_example.png)
 **рис. 7-13**. Application Insights результаты запроса.

Существует [Playground для экспериментов с запросами Kusto](https://dataexplorer.azure.com/clusters/help/databases/Samples) . Для чтения [образцов запросов](/azure/kusto/query/samples) также можно использовать инструкции.

## <a name="dashboards"></a>Панели мониторинга

Существует несколько различных технологий панели мониторинга, которые можно использовать для отображения информации от Azure Monitor. Возможно, проще всего просто выполнить запросы в Application Insights и [отобразить данные в диаграмме](/azure/azure-monitor/learn/tutorial-app-dashboards).

![Пример Application Insights диаграмм, внедренных на главную панель мониторинга Azure ](./media/azure_dashboard.png)
 **рис. 7-14**. Пример Application Insights диаграмм, внедренных в основную панель мониторинга Azure.

Эти диаграммы затем можно внедрить в портал Azure правильно с помощью функции панели мониторинга. Для пользователей с более точными требованиями, например для детализации на нескольких уровнях данных, Azure Monitor данные доступны для [Power BI](https://powerbi.microsoft.com/). Power BI является ведущим в отрасли, корпоративным классом, средством бизнес-аналитики, которое может выполнять статистическую обработку данных из множества различных источников данных.

![Пример Power BI панели мониторинга](./media/powerbidashboard.png)

**Рис. 7-15**. Пример Power BI панели мониторинга.

## <a name="alerts"></a>видны узлы

Иногда нет достаточных панелей мониторинга данных. Если никто не находится в спящем режиме для просмотра панелей мониторинга, это может быть несколько часов, прежде чем проблема будет устранена или даже обнаружена. В конце концов, Azure Monitor также предоставляет решение для [оповещений](/azure/azure-monitor/platform/alerts-overview)с высшим делением. Оповещения могут инициироваться с помощью широкого диапазона условий, в том числе:

- Значения метрик
- Запросы поиска по журналам
- События в журнале действий
- Работоспособность базовой платформы Azure
- Тесты на доступность веб-сайта

При активации оповещения могут выполнять разнообразные задачи. С простой стороны, оповещения могут просто отправить уведомление по электронной почте в список рассылки или текстовое сообщение отдельному пользователю. Дополнительные вовлеченные предупреждения могут активировать рабочий процесс в средстве, например PagerDuty, что известно о том, кто находится в вызове конкретного приложения. Оповещения могут активировать действия в [Microsoft Flow](https://flow.microsoft.com/) разблокировки неограниченных возможностей для рабочих процессов.

Как правило, оповещения могут быть расширены с помощью подробных сведений об основных причинах предупреждений и действиях, которые необходимо выполнить для их устранения. Самые преждевременные облачные развертывания приложений могут отказаться от самовосстанавливающих задач, которые выполняют такие действия, как удаление неисправных узлов из масштабируемого набора или активация действия автоматического масштабирования. В итоге может больше не потребоваться пробудить сотрудника по телефону в 2AM, чтобы устранить проблему с активным сайтом, так как система сможет скорректировать себя, чтобы компенсировать или по крайней мере ковылять, пока кто-то не приступит к работе на следующий утром.

Azure Monitor автоматически использует машинное обучение, чтобы понять нормальные рабочие параметры развернутых приложений. Такой подход позволяет ему обнаруживать службы, работающие за пределами их обычных параметров. Например, типичный трафик в будний день на сайте может составлять 10 000 запросов в минуту. А затем, в течение данной недели, число запросов в минуту достигнет очень необычных 20 000 запросов. [Интеллектуальное обнаружение](/azure/azure-monitor/app/proactive-diagnostics) заметит это отклонение от нормы и выдаст предупреждение. В то же время анализ тенденций достаточно интеллектуально, чтобы избежать срабатывания ложных срабатываний при ожидаемой нагрузке трафика.

## <a name="references"></a>Ссылки

- [Azure Monitor](/azure/azure-monitor/overview)

>[!div class="step-by-step"]
>[Назад](monitoring-azure-kubernetes.md)
>[Вперед](identity.md)
