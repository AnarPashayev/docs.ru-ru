---
title: Использование контейнеров и оркестраторов
description: Использование контейнеров Docker и оркестрантов Kubernetes в Azure
ms.date: 06/30/2019
ms.openlocfilehash: 44b2fff8c9c88717d83e41a421b9817e2cc68135
ms.sourcegitcommit: e3cbf26d67f7e9286c7108a2752804050762d02d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2020
ms.locfileid: "80989042"
---
# <a name="leveraging-containers-and-orchestrators"></a><span data-ttu-id="8e785-103">Использование контейнеров и оркестраторов</span><span class="sxs-lookup"><span data-stu-id="8e785-103">Leveraging containers and orchestrators</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="8e785-104">Контейнеры и оркестранты предназначены для решения проблем, характерных для монолитных подходов развертывания.</span><span class="sxs-lookup"><span data-stu-id="8e785-104">Containers and orchestrators are designed to solve problems common to monolithic deployment approaches.</span></span>

## <a name="challenges-with-monolithic-deployments"></a><span data-ttu-id="8e785-105">Проблемы с монолитным развертыванием</span><span class="sxs-lookup"><span data-stu-id="8e785-105">Challenges with monolithic deployments</span></span>

<span data-ttu-id="8e785-106">Традиционно большинство приложений были развернуты в виде единого устройства.</span><span class="sxs-lookup"><span data-stu-id="8e785-106">Traditionally, most applications have been deployed as a single unit.</span></span> <span data-ttu-id="8e785-107">Такие приложения называются монолитом.</span><span class="sxs-lookup"><span data-stu-id="8e785-107">Such applications are referred to as a monolith.</span></span> <span data-ttu-id="8e785-108">Этот общий подход к развертыванию приложений в единичные единицы, даже если они состоят из нескольких модулей или сборок, известен как монолитная архитектура, как показано на рисунке 3-1.</span><span class="sxs-lookup"><span data-stu-id="8e785-108">This general approach of deploying applications as single units even if they're composed of multiple modules or assemblies is known as monolithic architecture, as shown in Figure 3-1.</span></span>

![Монолитная архитектура.](./media/monolithic-architecture.png)

<span data-ttu-id="8e785-110">**Рисунок 3-1**.</span><span class="sxs-lookup"><span data-stu-id="8e785-110">**Figure 3-1**.</span></span> <span data-ttu-id="8e785-111">Монолитная архитектура.</span><span class="sxs-lookup"><span data-stu-id="8e785-111">Monolithic architecture.</span></span>

<span data-ttu-id="8e785-112">Хотя они имеют преимущество простоты, монолитные архитектуры сталкиваются с рядом проблем:</span><span class="sxs-lookup"><span data-stu-id="8e785-112">Although they have the benefit of simplicity, monolithic architectures face a number of challenges:</span></span>

### <a name="deployments"></a><span data-ttu-id="8e785-113">Развернутые приложения</span><span class="sxs-lookup"><span data-stu-id="8e785-113">Deployments</span></span>

<span data-ttu-id="8e785-114">Развертывание в монолитных приложениях обычно требует перезапуска всего приложения, даже если заменяется только один небольшой модуль.</span><span class="sxs-lookup"><span data-stu-id="8e785-114">Deploying to monolithic applications typically requires restarting the entire application, even if only one small module is being replaced.</span></span> <span data-ttu-id="8e785-115">В зависимости от количества машин, размещающих приложение, это может привести к простою во время развертывания.</span><span class="sxs-lookup"><span data-stu-id="8e785-115">Depending on the number of machines hosting the application, this can result in downtime during deployments.</span></span>

### <a name="hosting"></a><span data-ttu-id="8e785-116">Hosting</span><span class="sxs-lookup"><span data-stu-id="8e785-116">Hosting</span></span>

<span data-ttu-id="8e785-117">Монолитные приложения размещаются полностью на одном экземпляре машины.</span><span class="sxs-lookup"><span data-stu-id="8e785-117">Monolithic applications are hosted entirely on a single machine instance.</span></span> <span data-ttu-id="8e785-118">Для этого может потребоваться оборудование с более высокой производительности, чем потребуется любому модулю в распределенном приложении.</span><span class="sxs-lookup"><span data-stu-id="8e785-118">This may require higher-capability hardware than any module in a distributed application would need.</span></span> <span data-ttu-id="8e785-119">Кроме того, если какая-либо часть приложения становится узким местом, все приложение должно быть развернуто в дополнительные узлы машины для масштабирования.</span><span class="sxs-lookup"><span data-stu-id="8e785-119">Also, if any part of the app becomes a bottleneck, the entire application must be deployed to additional machine nodes in order to scale out.</span></span>

### <a name="environment"></a><span data-ttu-id="8e785-120">Среда</span><span class="sxs-lookup"><span data-stu-id="8e785-120">Environment</span></span>

<span data-ttu-id="8e785-121">Монолитные приложения обычно развертываются в существующую среду хостинга (операционная система, установленные фреймворки и т.д.).</span><span class="sxs-lookup"><span data-stu-id="8e785-121">Monolithic applications are typically deployed into an existing hosting environment (operating system, installed frameworks, etc.).</span></span> <span data-ttu-id="8e785-122">Эта среда может не соответствовать среде, в которой приложение было разработано или протестировано.</span><span class="sxs-lookup"><span data-stu-id="8e785-122">This environment may not match the environment in which the application was developed or tested.</span></span> <span data-ttu-id="8e785-123">Несоответствия в среде приложения являются общим источником проблем для монолитных развертываний.</span><span class="sxs-lookup"><span data-stu-id="8e785-123">Inconsistencies in the application's environment are a common source of problems for monolithic deployments.</span></span>

### <a name="coupling"></a><span data-ttu-id="8e785-124">Муфта</span><span class="sxs-lookup"><span data-stu-id="8e785-124">Coupling</span></span>

<span data-ttu-id="8e785-125">Монолитные приложения, вероятно, будут иметь большое сочетание между различными частями приложения, а также между приложением и его средой.</span><span class="sxs-lookup"><span data-stu-id="8e785-125">Monolithic applications are likely to have a great deal of coupling between different parts of the application, and between the application and its environment.</span></span> <span data-ttu-id="8e785-126">Это может затруднить более позднюю инпланисти конкретной услуги или проблемы, с тем чтобы повысить ее масштабируемость или своп в альтернативной реализации.</span><span class="sxs-lookup"><span data-stu-id="8e785-126">This can make it difficult to factor out a particular service or concern later, in order to increase its scalability or swap in an alternative implementation.</span></span> <span data-ttu-id="8e785-127">Это соединение также приводит к гораздо большим потенциальным последствиям для изменений в системе, требующих тщательного тестирования в больших приложениях.</span><span class="sxs-lookup"><span data-stu-id="8e785-127">This coupling also leads to much larger potential impacts for changes to the system, requiring extensive testing in larger applications.</span></span>

### <a name="technology-choice"></a><span data-ttu-id="8e785-128">Выбор технологий</span><span class="sxs-lookup"><span data-stu-id="8e785-128">Technology choice</span></span>

<span data-ttu-id="8e785-129">Монолитные приложения строятся и развертываются как единое целое.</span><span class="sxs-lookup"><span data-stu-id="8e785-129">Monolithic applications are built and deployed as a unit.</span></span> <span data-ttu-id="8e785-130">Это обеспечивает простоту и единообразие, но может быть препятствием для инноваций.</span><span class="sxs-lookup"><span data-stu-id="8e785-130">This offers simplicity and uniformity but can be a barrier to innovation.</span></span> <span data-ttu-id="8e785-131">Хотя новая функция или модуль в системе может быть лучше подходит для более современной платформы или платформы, она, вероятно, будет построена с использованием текущего подхода приложения ради согласованности, а также простоты разработки и развертывания.</span><span class="sxs-lookup"><span data-stu-id="8e785-131">Although a new feature or module in the system might be better-suited to a more modern platform or framework, it's likely to be built using the application's current approach for the sake of consistency as well as ease of development and deployment.</span></span>

## <a name="what-are-the-benefits-of-containers-and-orchestrators"></a><span data-ttu-id="8e785-132">Каковы преимущества контейнеров и оркестрантов?</span><span class="sxs-lookup"><span data-stu-id="8e785-132">What are the benefits of containers and orchestrators?</span></span>

<span data-ttu-id="8e785-133">Docker является самой популярной платформой управления контейнерами и визуализации и позволяет быстро работать с контейнерами на Linux и Windows.</span><span class="sxs-lookup"><span data-stu-id="8e785-133">Docker is the most popular container management and imaging platform and allows you to quickly work with containers on Linux and Windows.</span></span> <span data-ttu-id="8e785-134">Контейнеры обеспечивают отдельные, но воспроизводимые среды применения, которые работают одинаково в любой системе.</span><span class="sxs-lookup"><span data-stu-id="8e785-134">Containers provide separate but reproducible application environments that run the same way on any system.</span></span> <span data-ttu-id="8e785-135">Это делает их идеальными для разработки и хостинга приложений и компонентов приложений в облачных приложениях.</span><span class="sxs-lookup"><span data-stu-id="8e785-135">This makes them perfect for developing and hosting applications and app components in cloud-native applications.</span></span> <span data-ttu-id="8e785-136">Контейнеры изолированы друг от друга, поэтому два контейнера на одном и том же аппаратуру могут иметь различные версии программного обеспечения и даже установленную операционную систему, без зависимостей, вызывающих конфликты.</span><span class="sxs-lookup"><span data-stu-id="8e785-136">Containers are isolated from one another, so two containers on the same host hardware can have different versions of software and even operating system installed, without the dependencies causing conflicts.</span></span>

<span data-ttu-id="8e785-137">Более того, контейнеры определяются простыми файлами, которые могут быть проверены в исходном управлении.</span><span class="sxs-lookup"><span data-stu-id="8e785-137">What's more, containers are defined by simple files that can be checked into source control.</span></span> <span data-ttu-id="8e785-138">В отличие от полных серверов, даже виртуальных машин, которые часто требуют ручной работы для применения обновлений или установки дополнительных услуг, контейнерная инфраструктура может быть легко под контролем версии.</span><span class="sxs-lookup"><span data-stu-id="8e785-138">Unlike full servers, even virtual machines, which frequently require manual work to apply updates or install additional services, container infrastructure can easily be version-controlled.</span></span> <span data-ttu-id="8e785-139">Таким образом, приложения, созданные для работы в контейнерах, могут быть разработаны, протестированы и развернуты с помощью автоматизированных инструментов в рамках конвейера сборки.</span><span class="sxs-lookup"><span data-stu-id="8e785-139">Thus, apps built to run in containers can be developed, tested, and deployed using automated tools as part of a build pipeline.</span></span>

<span data-ttu-id="8e785-140">Контейнеры неизменяемы.</span><span class="sxs-lookup"><span data-stu-id="8e785-140">Containers are immutable.</span></span> <span data-ttu-id="8e785-141">Если у вас есть определение контейнера, вы можете воссоздать этот контейнер, и он будет работать точно так же.</span><span class="sxs-lookup"><span data-stu-id="8e785-141">Once you have the definition of a container, you can recreate that container and it will run exactly the same way.</span></span> <span data-ttu-id="8e785-142">Эта неизменяемость поддается дизайну на основе компонентов.</span><span class="sxs-lookup"><span data-stu-id="8e785-142">This immutability lends itself to component-based design.</span></span> <span data-ttu-id="8e785-143">Если некоторые части приложения меняются не так часто, как другие, зачем перераспределять все приложение, когда можно просто развернуть части, которые изменяются чаще всего?</span><span class="sxs-lookup"><span data-stu-id="8e785-143">If some parts of an application don't change as often as others, why redeploy the entire app when you can just deploy the parts that change most frequently?</span></span> <span data-ttu-id="8e785-144">Различные функции и кросс-резка проблемы приложения могут быть разбиты на отдельные единицы.</span><span class="sxs-lookup"><span data-stu-id="8e785-144">Different features and cross-cutting concerns of an app can be broken up into separate units.</span></span> <span data-ttu-id="8e785-145">На рисунке 3-2 показано, как монолитное приложение может воспользоваться преимуществами контейнеров и микрослужб, делегируя определенные функции или функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="8e785-145">Figure 3-2 shows how a monolithic app can take advantage of containers and microservices by delegating certain features or functionality.</span></span> <span data-ttu-id="8e785-146">Оставшаяся функциональность в самом приложении также была контейнеризирована.</span><span class="sxs-lookup"><span data-stu-id="8e785-146">The remaining functionality in the app itself has also been containerized.</span></span>

<span data-ttu-id="8e785-147">![Разбивка монолитного приложения для использования микрослужб в задней части. ](./media/breaking-up-monolith-with-backend-microservices.png)
 **Рисунок 3-2**.</span><span class="sxs-lookup"><span data-stu-id="8e785-147">![Breaking up a monolithic app to use microservices in the back end.](./media/breaking-up-monolith-with-backend-microservices.png)
**Figure 3-2**.</span></span> <span data-ttu-id="8e785-148">Разбивка монолитного приложения для использования микрослужб в задней части.</span><span class="sxs-lookup"><span data-stu-id="8e785-148">Breaking up a monolithic app to use microservices in the back end.</span></span>

<span data-ttu-id="8e785-149">Облачные приложения, созданные с использованием отдельных контейнеров, выигрывают от возможности развертывания столько или меньше приложения по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="8e785-149">Cloud-native apps built using separate containers benefit from the ability to deploy as much or as little of an application as needed.</span></span> <span data-ttu-id="8e785-150">Индивидуальные службы могут размещаться на узлах с ресурсами, подходящими для каждой службы.</span><span class="sxs-lookup"><span data-stu-id="8e785-150">Individual services can be hosted on nodes with resources appropriate to each service.</span></span> <span data-ttu-id="8e785-151">Среда, в которой работает каждая служба, неизменяема, может быть разделена между разработчиком, тестом и производством и может быть легко версия.</span><span class="sxs-lookup"><span data-stu-id="8e785-151">The environment each service runs in is immutable, can be shared between dev, test, and production, and can easily be versioned.</span></span> <span data-ttu-id="8e785-152">Соединение между различными областями приложения происходит явно как звонки или сообщения между службами, а не компиляция времени зависимостей в монолите.</span><span class="sxs-lookup"><span data-stu-id="8e785-152">Coupling between different areas of the application occurs explicitly as calls or messages between services, not compile-time dependencies within the monolith.</span></span> <span data-ttu-id="8e785-153">И любая часть общего приложения может выбрать технологию, которая имеет наибольший смысл для этой функции или возможности, не требуя изменений в остальной части приложения.</span><span class="sxs-lookup"><span data-stu-id="8e785-153">And any given part of the overall app can choose the technology that makes the most sense for that feature or capability without requiring changes to the rest of the app.</span></span>

## <a name="what-are-the-scaling-benefits"></a><span data-ttu-id="8e785-154">Каковы преимущества масштабирования?</span><span class="sxs-lookup"><span data-stu-id="8e785-154">What are the scaling benefits?</span></span>

<span data-ttu-id="8e785-155">Услуги, построенные на контейнерах, могут использовать преимущества масштабирования, предоставляемые инструментами оркестровки, такими как Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="8e785-155">Services built on containers can leverage scaling benefits provided by orchestration tools like Kubernetes.</span></span> <span data-ttu-id="8e785-156">По дизайну контейнеры знают только о себе.</span><span class="sxs-lookup"><span data-stu-id="8e785-156">By design containers only know about themselves.</span></span> <span data-ttu-id="8e785-157">Как только вы начинаете иметь несколько контейнеров, которые должны работать вместе, это может быть целесообразно организовать их на более высоком уровне.</span><span class="sxs-lookup"><span data-stu-id="8e785-157">Once you start to have multiple containers that need to work together, it can be worthwhile to organize them at a higher level.</span></span> <span data-ttu-id="8e785-158">Организация большого количества контейнеров и их общих зависимостей, таких как конфигурация сети, является местом, где инструменты оркестровки приходят, чтобы спасти день!</span><span class="sxs-lookup"><span data-stu-id="8e785-158">Organizing large numbers of containers and their shared dependencies, such as network configuration, is where orchestration tools come in to save the day!</span></span> <span data-ttu-id="8e785-159">Kubernetes — это платформа контейнерной оркестровки, предназначенная для автоматизации развертывания, масштабирования и управления контейнерными приложениями.</span><span class="sxs-lookup"><span data-stu-id="8e785-159">Kubernetes is a container orchestration platform designed to automate deployment, scaling, and management of containerized applications.</span></span> <span data-ttu-id="8e785-160">Он создает слой абстракции поверх групп контейнеров и организует их в *стручки.*</span><span class="sxs-lookup"><span data-stu-id="8e785-160">It creates an abstraction layer on top of groups of containers and organizes them into *pods*.</span></span> <span data-ttu-id="8e785-161">Стручки работают на рабочих машинах, называемых *узлами.*</span><span class="sxs-lookup"><span data-stu-id="8e785-161">Pods run on worker machines referred to as *nodes*.</span></span> <span data-ttu-id="8e785-162">Вся организованная группа называется *кластером.*</span><span class="sxs-lookup"><span data-stu-id="8e785-162">The whole organized group is referred to as a *cluster*.</span></span> <span data-ttu-id="8e785-163">На рисунке 3-3 показаны различные компоненты кластера Кубернете.</span><span class="sxs-lookup"><span data-stu-id="8e785-163">Figure 3-3 shows the different components of a Kubernetes cluster.</span></span>

<span data-ttu-id="8e785-164">![Компоненты кластера Kubernetes. ](./media/kubernetes-cluster-components.png)
 **Рисунок 3-3**.</span><span class="sxs-lookup"><span data-stu-id="8e785-164">![Kubernetes cluster components.](./media/kubernetes-cluster-components.png)
**Figure 3-3**.</span></span> <span data-ttu-id="8e785-165">Компоненты кластера Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="8e785-165">Kubernetes cluster components.</span></span>

<span data-ttu-id="8e785-166">Kubernetes оказывает встроенную поддержку масштабированию кластеров для удовлетворения спроса.</span><span class="sxs-lookup"><span data-stu-id="8e785-166">Kubernetes has built-in support for scaling clusters to meet demand.</span></span> <span data-ttu-id="8e785-167">В сочетании с контейнерными микрослужбами это обеспечивает возможность облачных приложений быстро и эффективно реагировать на всплески спроса с помощью дополнительных ресурсов, когда и где они необходимы.</span><span class="sxs-lookup"><span data-stu-id="8e785-167">Combined with containerized micro-services, this provides cloud-native applications with the ability to quickly and efficiently respond to spikes in demand with additional resources when and where they're needed.</span></span>

### <a name="declarative-versus-imperative"></a><span data-ttu-id="8e785-168">Декларативное против императив</span><span class="sxs-lookup"><span data-stu-id="8e785-168">Declarative versus imperative</span></span>

<span data-ttu-id="8e785-169">Kubernetes поддерживает как декларативную, так и императивную конфигурацию объектов.</span><span class="sxs-lookup"><span data-stu-id="8e785-169">Kubernetes supports both declarative and imperative object configuration.</span></span> <span data-ttu-id="8e785-170">Императивный подход включает в себя запуск различных команд, которые говорят Kubernetes, что делать на каждом этапе пути.</span><span class="sxs-lookup"><span data-stu-id="8e785-170">The imperative approach involves running various commands that tell Kubernetes what to do each step of the way.</span></span> <span data-ttu-id="8e785-171">*Запустите* это изображение.</span><span class="sxs-lookup"><span data-stu-id="8e785-171">*Run* this image.</span></span> <span data-ttu-id="8e785-172">*Удалите* этот стручок.</span><span class="sxs-lookup"><span data-stu-id="8e785-172">*Delete* this pod.</span></span> <span data-ttu-id="8e785-173">*Разоблачить* этот порт.</span><span class="sxs-lookup"><span data-stu-id="8e785-173">*Expose* this port.</span></span> <span data-ttu-id="8e785-174">При декларативном подходе используется файл конфигурации, описывающий *то, что вы хотите,* а не *что делать,* и Kubernetes выясняет, что делать для достижения желаемого конечного состояния.</span><span class="sxs-lookup"><span data-stu-id="8e785-174">With the declarative approach, you use a configuration file that describes *what you want* instead of *what to do* and Kubernetes figures out what to do to achieve the desired end state.</span></span> <span data-ttu-id="8e785-175">Если вы уже настроили кластер с помощью императивных `kubectl get svc SERVICENAME -o yaml > service.yaml`команд, можно экспортировать декларативный манифест с помощью .</span><span class="sxs-lookup"><span data-stu-id="8e785-175">If you've already configured your cluster using imperative commands, you can export a declarative manifest by using `kubectl get svc SERVICENAME -o yaml > service.yaml`.</span></span> <span data-ttu-id="8e785-176">Это позволит создать файл манифеста, как этот:</span><span class="sxs-lookup"><span data-stu-id="8e785-176">This will produce a manifest file like this one:</span></span>

```yaml
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: "2019-09-13T13:58:47Z"
  labels:
    component: apiserver
    provider: kubernetes
  name: kubernetes
  namespace: default
  resourceVersion: "153"
  selfLink: /api/v1/namespaces/default/services/kubernetes
  uid: 9b1fac62-d62e-11e9-8968-00155d38010d
spec:
  clusterIP: 10.96.0.1
  ports:
  - name: https
    port: 443
    protocol: TCP
    targetPort: 6443
  sessionAffinity: None
  type: ClusterIP
status:
  loadBalancer: {}
```

<span data-ttu-id="8e785-177">При использовании декларативной конфигурации можно просмотреть изменения, `kubectl diff -f FOLDERNAME` которые будут внесены перед их совершением, используя против папки, где находятся файлы конфигурации.</span><span class="sxs-lookup"><span data-stu-id="8e785-177">When using declarative configuration, you can preview the changes that will be made before committing them by using `kubectl diff -f FOLDERNAME` against the folder where your configuration files are located.</span></span> <span data-ttu-id="8e785-178">Как только вы уверены, что хотите `kubectl apply -f FOLDERNAME`применить изменения, запустите.</span><span class="sxs-lookup"><span data-stu-id="8e785-178">Once you're sure you want to apply the changes, run `kubectl apply -f FOLDERNAME`.</span></span> <span data-ttu-id="8e785-179">Добавьте `-R` к рекурсивному процессу иерархию папок.</span><span class="sxs-lookup"><span data-stu-id="8e785-179">Add `-R` to recursively process a folder hierarchy.</span></span>

<span data-ttu-id="8e785-180">В дополнение к службам можно использовать декларативную конфигурацию для других функций Kubernetes, таких как *развертывания.*</span><span class="sxs-lookup"><span data-stu-id="8e785-180">In addition to services, you can use declarative configuration for other Kubernetes features, such as *deployments*.</span></span> <span data-ttu-id="8e785-181">Декларативные развертывания используются контроллерами развертывания для обновления кластерных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="8e785-181">Declarative deployments are used by deployment controllers to update cluster resources.</span></span> <span data-ttu-id="8e785-182">Развертывания используются для развертывания новых изменений, масштабирования для поддержки большей нагрузки или отката к предыдущему пересмотру.</span><span class="sxs-lookup"><span data-stu-id="8e785-182">Deployments are used to roll out new changes, scale up to support more load, or roll back to a previous revision.</span></span> <span data-ttu-id="8e785-183">Если кластер нестабилен, декларативные развертывания обеспечивают механизм автоматического возвращения кластера в нужное состояние.</span><span class="sxs-lookup"><span data-stu-id="8e785-183">If a cluster is unstable, declarative deployments provide a mechanism for automatically bringing the cluster back to a desired state.</span></span>

<span data-ttu-id="8e785-184">Использование декларативной конфигурации позволяет представлять инфраструктуру в качестве кода, который может быть зарегистрирован и версияна вместе с кодом приложения.</span><span class="sxs-lookup"><span data-stu-id="8e785-184">Using declarative configuration allows infrastructure to be represented as code that can be checked in and versioned alongside the application code.</span></span> <span data-ttu-id="8e785-185">Это обеспечивает улучшенный контроль изменений и лучшую поддержку непрерывного развертывания с помощью сборки и развертывания конвейера, привязанного к изменениям управления исходными данными.</span><span class="sxs-lookup"><span data-stu-id="8e785-185">This provides improved change control and better support for continuous deployment using a build and deploy pipeline tied to source control changes.</span></span>

## <a name="what-scenarios-are-ideal-for-containers-and-orchestrators"></a><span data-ttu-id="8e785-186">Какие сценарии идеально подходят для контейнеров и оркестрантов?</span><span class="sxs-lookup"><span data-stu-id="8e785-186">What scenarios are ideal for containers and orchestrators?</span></span>

<span data-ttu-id="8e785-187">Следующие сценарии идеально подходят для использования контейнеров и оркестрантов.</span><span class="sxs-lookup"><span data-stu-id="8e785-187">The following scenarios are ideal for using containers and orchestrators.</span></span>

### <a name="applications-requiring-high-uptime-and-scalability"></a><span data-ttu-id="8e785-188">Приложения, требующие высокого времени простоя и масштабируемости</span><span class="sxs-lookup"><span data-stu-id="8e785-188">Applications requiring high uptime and scalability</span></span>

<span data-ttu-id="8e785-189">Отдельные приложения с высокими требованиями к простоям и масштабируемости являются идеальными кандидатами для облачных архитектур с использованием микрослужб, контейнеров и оркестрантов.</span><span class="sxs-lookup"><span data-stu-id="8e785-189">Individual applications that have high uptime and scalability requirements are ideal candidates for cloud-native architectures using microservices, containers, and orchestrators.</span></span> <span data-ttu-id="8e785-190">Эти приложения могут быть разработаны в контейнерах с использованием версий сред, могут быть тщательно протестированы перед началом производства, и могут быть развернуты в производство с нулевым временем простоя.</span><span class="sxs-lookup"><span data-stu-id="8e785-190">These applications can be developed in containers using versioned environments, can be extensively tested before going to production, and can be deployed to production with zero downtime.</span></span> <span data-ttu-id="8e785-191">Использование кластеров Kubernetes гарантирует, что такие приложения могут также масштабироваться по требованию и автоматически восстанавливаться после сбоев узлов.</span><span class="sxs-lookup"><span data-stu-id="8e785-191">The use of Kubernetes clusters ensures such apps can also scale on demand and recover automatically from node failures.</span></span>

### <a name="large-numbers-of-applications"></a><span data-ttu-id="8e785-192">Большое количество приложений</span><span class="sxs-lookup"><span data-stu-id="8e785-192">Large numbers of applications</span></span>

<span data-ttu-id="8e785-193">Организации, которые развертывают и должны впоследствии поддерживать большое количество приложений, пользуются контейнерами и оркестрантами.</span><span class="sxs-lookup"><span data-stu-id="8e785-193">Organizations that deploy and must subsequently maintain large numbers of applications benefit from containers and orchestrators.</span></span> <span data-ttu-id="8e785-194">Предостережающее усилие создания контейнерных сред и кластеров Kubernetes является в первую очередь фиксированной стоимостью.</span><span class="sxs-lookup"><span data-stu-id="8e785-194">The up front effort of setting up containerized environments and Kubernetes clusters is primarily a fixed cost.</span></span> <span data-ttu-id="8e785-195">Развертывание, обслуживание и обновление отдельных приложений имеет стоимость, которая зависит от количества приложений, которые необходимо поддерживать.</span><span class="sxs-lookup"><span data-stu-id="8e785-195">Deploying, maintaining, and updating individual applications has a cost that varies with the number of applications that must be maintained.</span></span> <span data-ttu-id="8e785-196">Помимо довольно небольшого количества приложений, сложность обслуживания пользовательских приложений вручную превышает затраты на реализацию решения с использованием контейнеров и оркестрантов.</span><span class="sxs-lookup"><span data-stu-id="8e785-196">Beyond a certain fairly small number of applications, the complexity of maintaining custom applications manually exceeds the cost of implementing a solution using containers and orchestrators.</span></span>

## <a name="when-should-you-avoid-using-containers-and-orchestrators"></a><span data-ttu-id="8e785-197">Когда следует избегать использования контейнеров и оркестрантов?</span><span class="sxs-lookup"><span data-stu-id="8e785-197">When should you avoid using containers and orchestrators?</span></span>

<span data-ttu-id="8e785-198">Если вы не желаете или не можете создать свое приложение в соответствии с принципами Twelve-Factor App, вам, вероятно, будет лучше избегать контейнеров и оркестрантов.</span><span class="sxs-lookup"><span data-stu-id="8e785-198">If you're unwilling or unable to build your application following Twelve-Factor App principles, you'll probably be better off avoiding containers and orchestrators.</span></span> <span data-ttu-id="8e785-199">В этих случаях, возможно, лучше двигаться вперед с VM-платформы хостинга, или, возможно, некоторые гибридные системы, в которых вы можете спина от определенных частей функциональности в отдельные контейнеры или даже без серверов функций.</span><span class="sxs-lookup"><span data-stu-id="8e785-199">In these cases, it may be best to move forward with a VM-based hosting platform, or possibly some hybrid system in which you can spin off certain pieces of functionality into separate containers or even serverless functions.</span></span>

## <a name="development-resources"></a><span data-ttu-id="8e785-200">Ресурсы развития</span><span class="sxs-lookup"><span data-stu-id="8e785-200">Development resources</span></span>

<span data-ttu-id="8e785-201">В этом разделе показан краткий список ресурсов разработки, которые могут помочь вам начать использовать контейнеры и оркестранты для следующего приложения.</span><span class="sxs-lookup"><span data-stu-id="8e785-201">This section shows a short list of development resources that may help you get started using containers and orchestrators for your next application.</span></span> <span data-ttu-id="8e785-202">Если вы ищете рекомендации о том, как создать приложение для архитектуры микрослужб на основе облачных услуг, прочитайте спутник этой [книги, .NET Microservices: Architecture for Containerized .NET Applications.](https://aka.ms/microservicesebook)</span><span class="sxs-lookup"><span data-stu-id="8e785-202">If you're looking for guidance on how to design your cloud-native microservices architecture app, read this book's companion, [.NET Microservices: Architecture for Containerized .NET Applications](https://aka.ms/microservicesebook).</span></span>

### <a name="local-kubernetes-development"></a><span data-ttu-id="8e785-203">Местное развитие Кубернете</span><span class="sxs-lookup"><span data-stu-id="8e785-203">Local Kubernetes Development</span></span>

<span data-ttu-id="8e785-204">Развертывание Kubernetes обеспечивает большую ценность в производственных средах, но вы также можете запустить их локально.</span><span class="sxs-lookup"><span data-stu-id="8e785-204">Kubernetes deployments provide great value in production environments, but you can also run them locally.</span></span> <span data-ttu-id="8e785-205">Хотя большую часть времени это хорошо, чтобы иметь возможность работать на отдельных приложений или микрослужб независимо, иногда это хорошо, чтобы иметь возможность запустить всю систему локально так же, как он будет работать при развертывании в производство.</span><span class="sxs-lookup"><span data-stu-id="8e785-205">Although much of the time it's good to be able to work on individual apps or microservices independently, sometimes it's good to be able to run the whole system locally just as it will run when deployed to production.</span></span> <span data-ttu-id="8e785-206">Есть несколько способов для достижения этой цели, два из которых Minikube и Docker Desktop.</span><span class="sxs-lookup"><span data-stu-id="8e785-206">There are several ways to achieve this, two of which are Minikube and Docker Desktop.</span></span> <span data-ttu-id="8e785-207">Visual Studio также предоставляет инструменты для разработки Docker.</span><span class="sxs-lookup"><span data-stu-id="8e785-207">Visual Studio also provides tooling for Docker development.</span></span>

### <a name="minikube"></a><span data-ttu-id="8e785-208">Minikube</span><span class="sxs-lookup"><span data-stu-id="8e785-208">Minikube</span></span>

<span data-ttu-id="8e785-209">Что такое Миникубе?</span><span class="sxs-lookup"><span data-stu-id="8e785-209">What is Minikube?</span></span> <span data-ttu-id="8e785-210">В проекте Minikube говорится: «Миникубе реализует локальный кластер Kubernetes на macOS, Linux и Windows».</span><span class="sxs-lookup"><span data-stu-id="8e785-210">The Minikube project says "Minikube implements a local Kubernetes cluster on macOS, Linux, and Windows."</span></span> <span data-ttu-id="8e785-211">Его основные цели – «быть лучшим инструментом для разработки местных приложений Kubernetes и поддерживать все функции Kubernetes, которые подходят».</span><span class="sxs-lookup"><span data-stu-id="8e785-211">Its primary goals are "to be the best tool for local Kubernetes application development and to support all Kubernetes features that fit."</span></span> <span data-ttu-id="8e785-212">Установка Minikube отделена от Docker, но Minikube поддерживает различные гипервизоры, чем поддерживает Docker Desktop.</span><span class="sxs-lookup"><span data-stu-id="8e785-212">Installing Minikube is separate from Docker, but Minikube supports different hypervisors than Docker Desktop supports.</span></span> <span data-ttu-id="8e785-213">Следующие функции Kubernetes в настоящее время поддерживаются Minikube:</span><span class="sxs-lookup"><span data-stu-id="8e785-213">The following Kubernetes features are currently supported by Minikube:</span></span>

- <span data-ttu-id="8e785-214">DNS</span><span class="sxs-lookup"><span data-stu-id="8e785-214">DNS</span></span>
- <span data-ttu-id="8e785-215">Узловые порты</span><span class="sxs-lookup"><span data-stu-id="8e785-215">NodePorts</span></span>
- <span data-ttu-id="8e785-216">ConfigMaps и секреты</span><span class="sxs-lookup"><span data-stu-id="8e785-216">ConfigMaps and secrets</span></span>
- <span data-ttu-id="8e785-217">Панели мониторинга</span><span class="sxs-lookup"><span data-stu-id="8e785-217">Dashboards</span></span>
- <span data-ttu-id="8e785-218">Контейнерные время выполнения: Докер, ркт, CRI-O и контейнерные</span><span class="sxs-lookup"><span data-stu-id="8e785-218">Container runtimes: Docker, rkt, CRI-O, and containerd</span></span>
- <span data-ttu-id="8e785-219">Включение интерфейса контейнерной сети (CNI)</span><span class="sxs-lookup"><span data-stu-id="8e785-219">Enabling Container Network Interface (CNI)</span></span>
- <span data-ttu-id="8e785-220">Входящий трафик</span><span class="sxs-lookup"><span data-stu-id="8e785-220">Ingress</span></span>

<span data-ttu-id="8e785-221">После установки Minikube вы можете быстро начать `minikube start` использовать его, запустив команду, которая загружает изображение и начинает локальное кластер Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="8e785-221">After installing Minikube, you can quickly start using it by running the `minikube start` command, which downloads an image and start the local Kubernetes cluster.</span></span> <span data-ttu-id="8e785-222">После запуска кластера с ним взаимодействуют, используя `kubectl` стандартные команды Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="8e785-222">Once the cluster is started, you interact with it using the standard Kubernetes `kubectl` commands.</span></span>

### <a name="docker-desktop"></a><span data-ttu-id="8e785-223">Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="8e785-223">Docker Desktop</span></span>

<span data-ttu-id="8e785-224">Вы также можете работать с Kubernetes непосредственно с Docker Desktop на Windows.</span><span class="sxs-lookup"><span data-stu-id="8e785-224">You can also work with Kubernetes directly from Docker Desktop on Windows.</span></span> <span data-ttu-id="8e785-225">Это единственный вариант, если вы используете Windows Контейнеры, и является отличным выбором для не-Windows контейнеров, а также.</span><span class="sxs-lookup"><span data-stu-id="8e785-225">This is your only option if you're using Windows Containers, and is a great choice for non-Windows containers as well.</span></span> <span data-ttu-id="8e785-226">Стандартное приложение конфигурации Docker Desktop используется для настройки Kubernetes, работая с Docker Desktop.</span><span class="sxs-lookup"><span data-stu-id="8e785-226">The standard Docker Desktop configuration app is used to configure Kubernetes running from Docker Desktop.</span></span>

![Настройка Kubernetes в Docker Desktop](./media/docker-desktop-kubernetes.png)

<span data-ttu-id="8e785-228">**Рисунок 3-4**.</span><span class="sxs-lookup"><span data-stu-id="8e785-228">**Figure 3-4**.</span></span> <span data-ttu-id="8e785-229">Настройка Kubernetes в Docker Desktop.</span><span class="sxs-lookup"><span data-stu-id="8e785-229">Configuring Kubernetes in Docker Desktop.</span></span>

<span data-ttu-id="8e785-230">Docker Desktop уже является самым популярным инструментом для настройки и локального запуска контейнеризированных приложений.</span><span class="sxs-lookup"><span data-stu-id="8e785-230">Docker Desktop is already the most popular tool for configuring and running containerized apps locally.</span></span> <span data-ttu-id="8e785-231">Работая с Docker Desktop, вы можете разрабатывать локально против того же набора изображений контейнеров Docker, которые вы развернете в производстве.</span><span class="sxs-lookup"><span data-stu-id="8e785-231">When you work with Docker Desktop, you can develop locally against the exact same set of Docker container images that you'll deploy to production.</span></span> <span data-ttu-id="8e785-232">Docker Desktop предназначен для локального создания, тестирования и отправки контейнерных приложений.</span><span class="sxs-lookup"><span data-stu-id="8e785-232">Docker Desktop is designed to "build, test, and ship" containerized apps locally.</span></span> <span data-ttu-id="8e785-233">После отправки изображений в реестр изображений, таких как реестр контейнеров Azure или Docker Hub, сервисы, такие как Azure Kubernetes Service (AKS), управляют приложением в производственном секторе.</span><span class="sxs-lookup"><span data-stu-id="8e785-233">Once the images have been shipped to an image registry like Azure Container Registry or Docker Hub, then services like Azure Kubernetes Service (AKS) manage the application in production.</span></span>

### <a name="visual-studio-docker-tooling"></a><span data-ttu-id="8e785-234">Визуальная студия Докер Инструментирование</span><span class="sxs-lookup"><span data-stu-id="8e785-234">Visual Studio Docker Tooling</span></span>

<span data-ttu-id="8e785-235">Visual Studio поддерживает разработку Docker для веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="8e785-235">Visual Studio supports Docker development for web applications.</span></span> <span data-ttu-id="8e785-236">При создании нового приложения ASP.NET Core вам предоставляется возможность настроить его с поддержкой Docker в рамках процесса создания проекта, как показано на рисунке 3-5.</span><span class="sxs-lookup"><span data-stu-id="8e785-236">When you create a new ASP.NET Core application, you're given the option to configure it with Docker support as part of the project creation process, as shown in Figure 3-5.</span></span>

![Визуальная студия Включить Докер поддержки](./media/visual-studio-enable-docker-support.png)

<span data-ttu-id="8e785-238">**Рисунок 3-5**.</span><span class="sxs-lookup"><span data-stu-id="8e785-238">**Figure 3-5**.</span></span> <span data-ttu-id="8e785-239">Визуальная студия Включить Докер поддержки</span><span class="sxs-lookup"><span data-stu-id="8e785-239">Visual Studio Enable Docker Support</span></span>

<span data-ttu-id="8e785-240">При выборе этой опции проект создается с корнем, `Dockerfile` который может быть использован для создания и размещения приложения в контейнере Docker.</span><span class="sxs-lookup"><span data-stu-id="8e785-240">When this option is selected, the project is created with a `Dockerfile` in its root, which can be used to build and host the app in a Docker container.</span></span> <span data-ttu-id="8e785-241">Пример Dockerfile показан на рисунке 3-6.</span><span class="sxs-lookup"><span data-stu-id="8e785-241">An example Dockerfile is shown in Figure 3-6.</span></span>

```docker
FROM mcr.microsoft.com/dotnet/core/aspnet:3.0-stretch-slim AS base
WORKDIR /app
EXPOSE 80
EXPOSE 443

FROM mcr.microsoft.com/dotnet/core/sdk:3.0-stretch AS build
WORKDIR /src
COPY ["WebApplication3/WebApplication3.csproj", "WebApplication3/"]
RUN dotnet restore "WebApplication3/WebApplication3.csproj"
COPY . .
WORKDIR "/src/WebApplication3"
RUN dotnet build "WebApplication3.csproj" -c Release -o /app

FROM build AS publish
RUN dotnet publish "WebApplication3.csproj" -c Release -o /app

FROM base AS final
WORKDIR /app
COPY --from=publish /app .
ENTRYPOINT ["dotnet", "WebApplication3.dll"]
```

<span data-ttu-id="8e785-242">**Рисунок 3-6**.</span><span class="sxs-lookup"><span data-stu-id="8e785-242">**Figure 3-6**.</span></span> <span data-ttu-id="8e785-243">Визуальная студия генерируется Dockerfile</span><span class="sxs-lookup"><span data-stu-id="8e785-243">Visual Studio generated Dockerfile</span></span>

<span data-ttu-id="8e785-244">Поведение по умолчанию при запуске приложения настроено на использование Docker.</span><span class="sxs-lookup"><span data-stu-id="8e785-244">The default behavior when the app runs is configured to use Docker as well.</span></span> <span data-ttu-id="8e785-245">На рисунке 3-7 показаны различные варианты выполнения, доступные в новом проекте ASP.NET Core, созданном при добавленной поддержке Docker.</span><span class="sxs-lookup"><span data-stu-id="8e785-245">Figure 3-7 shows the different run options available from a new ASP.NET Core project created with Docker support added.</span></span>

![Визуальная студия Докер Выполнить Варианты](./media/visual-studio-docker-run-options.png)

<span data-ttu-id="8e785-247">**Рисунок 3-7**.</span><span class="sxs-lookup"><span data-stu-id="8e785-247">**Figure 3-7**.</span></span> <span data-ttu-id="8e785-248">Визуальная студия Докер Выполнить Варианты</span><span class="sxs-lookup"><span data-stu-id="8e785-248">Visual Studio Docker Run Options</span></span>

<span data-ttu-id="8e785-249">Помимо локальной разработки, [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/) предоставляет нескольким разработчикам удобный способ работы с собственными конфигурациями Kubernetes в Azure.</span><span class="sxs-lookup"><span data-stu-id="8e785-249">In addition to local development, [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/) provides a convenient way for multiple developers to work with their own Kubernetes configurations within Azure.</span></span> <span data-ttu-id="8e785-250">Как вы можете видеть на рисунке 3-7, вы также можете запустить приложение в пространствах Azure Dev.</span><span class="sxs-lookup"><span data-stu-id="8e785-250">As you can see in Figure 3-7, you can also run the application in Azure Dev Spaces.</span></span>

<span data-ttu-id="8e785-251">Если при его создании поддержка Docker не добавляется в приложение ASP.NET Core, вы всегда можете добавить его позже.</span><span class="sxs-lookup"><span data-stu-id="8e785-251">If you don't add Docker support to your ASP.NET Core application when you create it, you can always add it later.</span></span> <span data-ttu-id="8e785-252">С Visual Studio Solution Explorer, нажмите право на проект и выберите **Добавить** > **Docker поддержки**, как показано на рисунке 3-8.</span><span class="sxs-lookup"><span data-stu-id="8e785-252">From the Visual Studio Solution Explorer, right click on the project and select **Add** > **Docker Support**, as shown in Figure 3-8.</span></span>

![Визуальная студия Добавить Докер поддержка](./media/visual-studio-add-docker-support.png)

<span data-ttu-id="8e785-254">**Рисунок 3-8**.</span><span class="sxs-lookup"><span data-stu-id="8e785-254">**Figure 3-8**.</span></span> <span data-ttu-id="8e785-255">Визуальная студия Добавить Докер поддержка</span><span class="sxs-lookup"><span data-stu-id="8e785-255">Visual Studio Add Docker Support</span></span>

<span data-ttu-id="8e785-256">В дополнение к поддержке Docker, вы также можете добавить поддержку оркестровки контейнеров, также показанную на рисунке 3-8.</span><span class="sxs-lookup"><span data-stu-id="8e785-256">In addition to Docker support, you can also add Container Orchestration Support, also shown in Figure 3-8.</span></span> <span data-ttu-id="8e785-257">По умолчанию оркестрант использует Kubernetes и Helm.</span><span class="sxs-lookup"><span data-stu-id="8e785-257">By default, the orchestrator uses Kubernetes and Helm.</span></span> <span data-ttu-id="8e785-258">После того, как вы выбрали `azds.yaml` оркестратора, файл добавляется `charts` в корень проекта и папка добавляется, содержащий диаграммы helm, используемые для настройки и развертывания приложения в Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="8e785-258">Once you've chosen the orchestrator, a `azds.yaml` file is added to the project root and a `charts` folder is added containing the Helm charts used to configure and deploy the application to Kubernetes.</span></span> <span data-ttu-id="8e785-259">На рисунке 3-9 показаны полученные файлы в новом проекте.</span><span class="sxs-lookup"><span data-stu-id="8e785-259">Figure 3-9 shows the resulting files in a new project.</span></span>

![Визуальная студия Добавить оркестраторподдержки](./media/visual-studio-add-orchestrator-support.png)

<span data-ttu-id="8e785-261">**Рисунок 3-9**.</span><span class="sxs-lookup"><span data-stu-id="8e785-261">**Figure 3-9**.</span></span> <span data-ttu-id="8e785-262">Визуальная студия Добавить оркестраторподдержки</span><span class="sxs-lookup"><span data-stu-id="8e785-262">Visual Studio Add Orchestrator Support</span></span>

## <a name="references"></a><span data-ttu-id="8e785-263">Ссылки</span><span class="sxs-lookup"><span data-stu-id="8e785-263">References</span></span>

- [<span data-ttu-id="8e785-264">Что такое Kubernetes?</span><span class="sxs-lookup"><span data-stu-id="8e785-264">What is Kubernetes?</span></span>](https://blog.newrelic.com/engineering/what-is-kubernetes/)
- [<span data-ttu-id="8e785-265">Установка Kubernetes с Minikube</span><span class="sxs-lookup"><span data-stu-id="8e785-265">Installing Kubernetes with Minikube</span></span>](https://kubernetes.io/docs/setup/learning-environment/minikube/)
- [<span data-ttu-id="8e785-266">МиниКубе - Докер Настольный стол</span><span class="sxs-lookup"><span data-stu-id="8e785-266">MiniKube vs Docker Desktop</span></span>](https://medium.com/containers-101/local-kubernetes-for-windows-minikube-vs-docker-desktop-25a1c6d3b766)
- [<span data-ttu-id="8e785-267">Инструменты Visual Studio для Docker</span><span class="sxs-lookup"><span data-stu-id="8e785-267">Visual Studio Tools for Docker</span></span>](https://docs.microsoft.com/dotnet/standard/containerized-lifecycle-architecture/design-develop-containerized-apps/visual-studio-tools-for-docker)

>[!div class="step-by-step"]
><span data-ttu-id="8e785-268">[Назад](scale-applications.md)
>[Вперед](leverage-serverless-functions.md)</span><span class="sxs-lookup"><span data-stu-id="8e785-268">[Previous](scale-applications.md)
[Next](leverage-serverless-functions.md)</span></span>
