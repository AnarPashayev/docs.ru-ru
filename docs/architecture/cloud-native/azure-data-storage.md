---
title: Хранение данных в Azure
description: Создание архитектуры облачных приложений .NET для Azure | Хранение данных в Azure
ms.date: 06/30/2019
ms.openlocfilehash: 1a86cecf005c6dbdfda5cf4cacfafaad4711c076
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2019
ms.locfileid: "73841897"
---
# <a name="data-storage-in-azure"></a>Хранение данных в Azure

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

Как мы видели во всей этой книге, Облако изменяет способ разработки, развертывания и управления приложениями. При переходе в облако критический вопрос заключается в том, как переместить данные? К счастью, Облако Azure предлагает множество вариантов.

Вы можете просто подготавливать виртуальную машину Azure и установить выбранную базу данных. Это называется ["инфраструктура как услуга" (IaaS)](https://www.techopedia.com/definition/141/infrastructure-as-a-service-iaas). Такой подход упрощает перемещение локальной базы данных в облако, как есть, но сдвигает нагрузку на управление виртуальной машиной и базой данных.

Вместо этого лучше использовать полностью управляемую [базу данных как службу (DBaaS)](https://www.stratoscale.com/blog/dbaas/what-is-database-as-a-service/) . Вы получаете множество встроенных функций, когда размещение, Обслуживание и лицензирование управляются корпорацией Майкрософт. В Azure реализованы различные типы полностью управляемых хранилищ данных, каждый из которых имеет определенные преимущества. Все они поддерживают JIT-поддержку и модель с оплатой по мере использования.

Далее мы рассмотрим параметры DBaaS, доступные в Azure. Вы узнаете о том, как корпорация Майкрософт будет продолжать работу с "открытой платформой", предлагая управляемую поддержку многих реляционных баз данных с открытым исходным кодом и NoSQL, а также сделав основные вклады в различные основы с открытым кодом в качестве активного элемента.

## <a name="azure-sql-database"></a>База данных SQL Azure

[База данных SQL Azure](https://docs.microsoft.com/azure/sql-database/) — это многофункциональная реляционная база данных общего назначения как услуга (DBaaS) на основе ядро СУБД Microsoft SQL Server. Она полностью управляется корпорацией Майкрософт и представляет собой высокопроизводительную, надежную и безопасную облачную базу данных. Служба использует многие функции, имеющиеся в локальной версии SQL Server.

Вы можете подготавливать сервер базы данных SQL и базу данных за считаные минуты. Когда спрос на приложение растет от нескольких клиентов до миллионов, база данных SQL Azure масштабируется в режиме реального времени с минимальным временем простоя. Вы можете динамически добавлять или удалять ресурсы, включая мощность ЦП, память, пропускную способность ввода-вывода и хранилище, выделенное для баз данных.

На рис. 5-12 показаны варианты развертывания для базы данных SQL Azure.

![Варианты развертывания SQL Azure](./media/azure-sql-database-deployment-options.png)

**Рис. 5-12**. Варианты развертывания SQL Azure

Обратите внимание на альтернативные варианты, приведенные на предыдущем рисунке при развертывании базы данных SQL:

- [Отдельная база данных](https://docs.microsoft.com/azure/sql-database/sql-database-single-database) с собственным набором ресурсов, управляемых [сервером базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-servers). Одна база данных похожа на [автономную базу данных](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases) , в локальном SQL Serverном развертывании.

- [Эластичный пул](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool) , в котором коллекция баз данных SQL совместно используют один сервер базы данных SQL по заданной цене. При необходимости отдельные базы данных могут быть перемещены в пул эластичных БД и из него, чтобы оптимизировать производительность для группы баз данных.

- [Управляемый экземпляр](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance) , в котором представляет собой набор системных и пользовательских баз данных, обеспечивает совместимость почти 100% с локальной SQL Server. Этот параметр поддерживает большие базы данных размером до 35 ТБ и размещается в [виртуальной сети Azure](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) для лучшей изоляции.

База данных SQL Azure — это полностью управляемая [платформа как услуга (PaaS) ядро СУБД](https://docs.microsoft.com/azure/sql-database/sql-database-paas) , которая обрабатывает обновление, установку исправлений, резервное копирование и мониторинг без участия пользователя. Она всегда запускает последнюю стабильную версию SQL Server ядро СУБД и исправленную ОС и гарантирует доступность 99,99%. Одна из функций, [Активная Георепликация](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication), позволяет создавать базы данных-получатели, доступные для чтения, в том же или другом центре обработки данных Azure. При сбое можно инициировать отработку отказа в базу данных-получатель. На этом этапе другие вторичные реплики автоматически связываются с новым первичным. В одном или в разных регионах поддерживается до четырех вторичных реплик, и эти получатели также можно использовать для запросов доступа только для чтения.

База данных SQL Azure включает [встроенные функции мониторинга и интеллектуальной настройки](https://docs.microsoft.com/azure/sql-database/sql-database-monitoring-tuning-index) , которые позволяют максимально повысить производительность и сократить эксплуатационные расходы. Например, функция [автоматической настройки](https://docs.microsoft.com/azure/sql-database/sql-database-automatic-tuning) обеспечивает непрерывную настройку производительности на основе искусственного интеллекта и машинного обучения. Служба узнает от выполняемых рабочих нагрузок и может применять рекомендации по настройке. Чем длиннее база данных SQL Azure с включенной автоматической настройкой, тем лучше она работает.

[Сервер базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-serverless) (доступен для предварительного просмотра во время записи этой книги) — это уровень вычислений для отдельных баз данных, которые автоматически масштабируются на основе спроса на рабочую нагрузку и выставляются за секунду. Уровень вычислений "бессерверный" также автоматически приостанавливает базы данных в течение неактивных периодов, чтобы взиматься только плата за хранилище. Он автоматически возобновляется при возврате действия.

Наконец, есть новая ценовая категория для [базы данных SQL Azure](https://azure.microsoft.com/services/sql-database/) . Он основан на высокомасштабируемой архитектуре хранения и позволяет базе данных увеличиваться по мере необходимости, устраняя необходимость предварительной подготовки ресурсов хранилища. Вы можете масштабировать ресурсы вычислений и хранилища независимо, обеспечивая гибкость для оптимизации производительности каждой рабочей нагрузки. Масштабирование базы данных SQL Azure оптимизировано для обработки [OLTP](https://en.wikipedia.org/wiki/Online_transaction_processing) и аналитических рабочих нагрузок с высокой пропускной способностью с хранилищем до 100 ТБ.  При использовании рабочих нагрузок с большим объемом чтения масштабирование обеспечивает быстрое масштабирование путем подготовки дополнительных реплик чтения, необходимых для разгрузки рабочих нагрузок чтения.

Помимо традиционного стека Microsoft SQL Server в Azure также реализованы управляемые версии нескольких популярных баз данных с открытым исходным кодом.

## <a name="azure-database-for-mysql"></a>База данных Azure для MySQL

[MySQL](https://en.wikipedia.org/wiki/MySQL) является [реляционной базой данных](https://en.wikipedia.org/wiki/Relational_database_management_system)с [открытым исходным кодом](https://en.wikipedia.org/wiki/Open-source_software). Это компонент в [стеке программного обеспечения лампы](https://en.wikipedia.org/wiki/LAMP_(software_bundle)) , который используется многими крупными организациями, включая Facebook, Twitter и YouTube. Выпуск Community Edition предоставляется бесплатно, а выпуск Enterprise Edition требует приобретения лицензии. Продукт, изначально созданный в 1995, был приобретен компанией Sun Microsystems в 2008, полученной Oracle в 2010.

[База данных Azure для MySQL](https://azure.microsoft.com/services/mysql/) — это полностью управляемая служба реляционной базы данных, готовая к работе в корпоративной среде, на основе ядра MySQL сервера с открытым кодом. Реализуя выпуск MySQL Community, он включает следующие возможности PaaS без дополнительных затрат:

- Встроенная [Высокая доступность](https://docs.microsoft.com/azure/mysql/concepts-high-availability).

- Прогнозируемая производительность с [оплатой по мере](https://docs.microsoft.com/azure/mysql/concepts-pricing-tiers)использования.

- [Масштабировать](https://docs.microsoft.com/azure/mysql/concepts-high-availability) по мере необходимости в течение нескольких секунд.

- Защита конфиденциальных данных при хранении и перемещении.

- [Автоматическое резервное копирование](https://docs.microsoft.com/azure/mysql/concepts-backup) и [Восстановление до точки во времени](https://docs.microsoft.com/azure/mysql/concepts-backup) до 35 дней.

- Безопасность и соответствие требованиям корпоративного уровня.

Эти встроенные функции PaaS важны для организаций, которые имеют сотни баз данных "тактических" (нестратегических) в своих центрах обработки данных, но не имеют ресурсов для выполнения исправлений, резервного копирования, обеспечения безопасности и мониторинга производительности.

Кроме того, [служба Azure Data Migration Service](https://azure.microsoft.com/services/database-migration/) может перенести данные из нескольких источников базы данных в платформы данных Azure с минимальным временем простоя. Служба создает отчеты об оценке и предоставляет рекомендации по изменениям, необходимым для выполнения миграции, как малых, так и больших.

Управляемый [сервер MySQL Azure](https://docs.microsoft.com/azure/mysql/concepts-servers) является центральной точкой администрирования службы. Это тот же модуль MySQL Server, который используется для локальных развертываний. С его помощью можно создать отдельную базу данных для каждого сервера, чтобы использовать все ресурсы или создать несколько баз данных на каждом сервере для совместного использования ресурсов. Ваша команда может продолжить разработку приложений с помощью средств с открытым исходным кодом и выбранной платформы без необходимости изучать новые навыки или управлять виртуальными машинами и инфраструктурой.

## <a name="azure-database-for-mariadb"></a>База данных Azure для MariaDB

[MariaDB](https://mariadb.com/) Сервер — это еще один популярный сервер базы данных с открытым кодом. Она была создана как вилка MySQL исходными разработчиками MySQL в тот момент, когда Oracle приобрел Sun Microsystems, который владеет MySQL. Цель заключается в том, чтобы MariaDB оставался открытым исходным кодом.

Поскольку MariaDB является [вилкой MySQL](https://blog.panoply.io/a-comparative-vmariadb-vs-mysql), определения данных и таблиц совместимы, а клиентские протоколы, структуры и интерфейсы API — Close-компиляция. Соединители данных MySQL будут работать MariaDB без изменений.

MariaDB имеет высокую важность и используется многими крупными предприятиями. Несмотря на то, что Oracle продолжит поддерживать, улучшать и поддерживать MySQL, MariaDB управляется MariaDB Foundation, что позволяет получить общедоступные материалы по продукту и документации.

[База данных Azure для MariaDB](https://azure.microsoft.com/services/mariadb/) — это полностью управляемая база данных как услуга в облаке Azure. Он основан на ядре сервера [MariaDB Community Edition](https://mariadb.org/download/) . Она может обслуживать критически важные рабочие нагрузки с прогнозируемой производительностью и динамической масштабируемостью. Подобно другим платформам баз данных Azure, она включает многие возможности платформы как услуги без дополнительных затрат:

- Встроенная [Высокая доступность](https://docs.microsoft.com/azure/mariadb/concepts-high-availability).

- Прогнозируемая производительность с [оплатой по мере](https://docs.microsoft.com/azure/mariadb/concepts-pricing-tiers)использования.

- [Масштабирование](https://docs.microsoft.com/azure/mariadb/concepts-high-availability) по мере необходимости в течение нескольких секунд.

- Безопасная Защита конфиденциальных данных при хранении и перемещении.

- [Автоматическое резервное копирование](https://docs.microsoft.com/azure/mariadb/concepts-backup) и [Восстановление до точки во времени](https://docs.microsoft.com/azure/mariadb/concepts-backup) до 35 дней.

- Безопасность и соответствие требованиям корпоративного уровня.

## <a name="azure-database-for-postgresql"></a>База данных Azure для PostgreSQL

[PostgreSQL](https://www.postgresql.org/) — это еще одна популярная реляционная база данных с открытым исходным кодом в течение более 30 лет активной разработки. Это общецелевая и объектно-реляционная система управления базами данных. Его лицензирование считается «широкие», и продукт можно использовать, изменять и распространять в любой форме. Многие крупные предприятия, включая Apple, Red Hat и Fujitsu, имеют встроенные продукты, использующие PostgreSQL.

[База данных Azure для PostgreSQL](https://azure.microsoft.com/services/postgresql/) — это полностью управляемая служба реляционных баз данных, основанная на ядре СУБД Postgres с открытым исходным кодом. Он может обслуживать критически важные рабочие нагрузки с прогнозируемой производительностью, безопасностью, высокой доступностью и динамической масштабируемостью. Он поддерживает несколько платформ и языков с открытым кодом (включая C++Java, Python, Node, C\#и PHP). Это позволяет выполнять [миграцию](https://datamigration.microsoft.com/scenario/postgresql-to-azurepostgresql?step=1) баз данных PostgreSQL с помощью интерфейса командной строки или [службы Azure Data Migration Service](https://azure.microsoft.com/services/database-migration/).

Служба включает [встроенные средства анализа](https://docs.microsoft.com/azure/postgresql/concepts-monitoring) , которые изменяют уникальные шаблоны баз данных и предоставляют настраиваемые рекомендации и аналитические сведения для повышения производительности базы данных PostgreSQL. [Advanced Threat protection](https://docs.microsoft.com/azure/postgresql/concepts-data-access-and-security-threat-protection) отслеживает базу данных по часам и обнаруживает потенциальные вредоносные действия, уведомляя вас об обнаружении, чтобы вы могли сразу же прибегнуть к работе.

База данных Azure для PostgreSQL доступна в виде двух вариантов развертывания: один сервер и горизонтальное масштабирование (Цитус), доступные для предварительного просмотра во время записи этой книги.

- Вариант развертывания с [одним сервером](https://docs.microsoft.com/azure/postgresql/concepts-servers) является центральной точкой администрирования для нескольких баз данных. Это тот же механизм сервера PostgreSQL, что и для локальных развертываний. С его помощью можно создать отдельную базу данных для каждого сервера, чтобы использовать все ресурсы или создать несколько баз данных для совместного использования ресурсов. Цены структурированы для каждого сервера на основе ядер и хранилища.

- [Параметр «Цитус](https://azure.microsoft.com/blog/get-high-performance-scaling-for-your-azure-database-workloads-with-hyperscale/) » на основе технологии [Цитус Data](https://www.citusdata.com/) . Он обеспечивает высокопроизводительное масштабирование, горизонтально развернув отдельную базу данных на сотнях узлов, чтобы обеспечить располагают высокую производительность и масштабируемость. Этот параметр позволяет подсистеме разместить больше данных в памяти, параллельно выполнять запросы на сотни узлов и быстрее индексировать данные. Функция масштабирования совместима с последними нововведениями, версиями и инструментами для PostgreSQL, поэтому вы можете использовать имеющийся опыт PostgreSQL.

## <a name="cosmos-db"></a>Cosmos DB

Azure Cosmos DB представляет собой полностью управляемую глобально распределенную службу базы данных NoSQL, которая обеспечивает низкую задержку, масштабируемость, согласованность управляемых данных и высокую доступность. Коротко говоря, если приложение должно гарантировать быстрое время отклика в любой точке мира, если оно должно быть всегда в сети и требует неограниченного и эластичного масштабирования пропускной способности и хранилища, Cosmos DB является отличным выбором. На рис. 5-13 показан общий обзор Cosmos DB.

![Общие сведения о Cosmos DB](./media/cosmos-db-overview.png)

**Рис. 5-13**. Обзор Cosmos DB

Обратите внимание на рис. 5-13 Cosmos DB является надежной и высокоуниверсальной службой баз данных с множеством встроенных возможностей облака. В этом разделе мы рассмотрим их Подробнее.

### <a name="global-support"></a>Глобальная поддержка

Вы можете глобально распределять базы данных Cosmos по всем регионам Azure по всему миру, размещая данные ближе к пользователям, повышая время отклика и уменьшая задержку. Можно добавить или удалить базу данных из региона без приостановки или повторного развертывания приложения. В фоновом режиме Cosmos DB прозрачно реплицирует данные во все настроенные регионы.

Cosmos DB поддерживает кластеризацию [Active/Active](https://kemptechnologies.com/white-papers/unfog-confusion-active-passive-activeactive-load-balancing/) на глобальном уровне, позволяя настраивать любые или все регионы базы данных для поддержки операций записи и чтения.

Функция использования [нескольких основных](https://docs.microsoft.com/azure/cosmos-db/how-to-multi-master) протоколов в Cosmos DB обеспечивает следующие функциональные возможности:

- Неограниченная эластичная запись и масштабируемость чтения.

- 99,999% доступности для чтения и записи по всему миру.

- Гарантированные операции чтения и записи, обслуживаемые менее чем на 10 миллисекунд, на 99-м процентиль.

На внутреннем уровне Cosmos DB обрабатывает репликацию данных между регионами с гарантиями уровня согласованности и финансовыми резервными соглашениями об уровнях обслуживания.

С помощью Cosmos DB [API-интерфейсов с несколькими](https://docs.microsoft.com/azure/cosmos-db/distribute-data-globally)адресами приложение может автоматически получать информацию о ближайшем регионе Azure и отсылать запросы к ней. Ближайший регион определяется Cosmos DB без каких-либо изменений конфигурации. Если регион станет недоступным, Cosmos DB поддерживает автоматическую отработку отказа, а функция множественной адресации автоматически направит запрос в ближайший доступный регион.

### <a name="multi-model-support"></a>Поддержка нескольких моделей

Cosmos DB — это *Платформа данных с несколькими моделями* , позволяющая взаимодействовать с данными с помощью ряда поддерживаемых моделей NoSQL, включая документы, пары "ключ-значение", представления расширенных столбцов и графов. На внутреннем уровне данные хранятся в простом формате [структуры](https://docs.microsoft.com/dotnet/csharp/programming-guide/classes-and-structs/using-structs) , который состоит из примитивных типов данных, включая строки, логические значения и числа. Для каждого запроса ядро СУБД преобразует данные в выбранное представление модели. Вы можете выбрать собственный Cosmos DB API на основе SQL или любой [интерфейс API совместимости](https://www.wikiwand.com/en/Cosmos_DB) , показанный на рис. 5-14.

![Поставщики Cosmos DB](./media/cosmos-db-providers.png)

**Рис. 5-14**. поставщики Cosmos DB

Обратите внимание на рис. 5-14, как Cosmos DB поддерживает [хранилище таблиц](https://azure.microsoft.com/services/storage/tables/). Как Cosmos DB, так и [хранилище таблиц Azure](https://docs.microsoft.com/azure/cosmos-db/table-storage-overview) используют одну и ту же базовую модель таблицы и предоставляют многие из одних и тех же операций с таблицами. Однако [Cosmos DB API таблиц](https://docs.microsoft.com/azure/cosmos-db/table-introduction) предоставляет множество улучшений уровня "Премиум", недоступных в API службы хранилища Azure. Эти функции отличаются на рис. 5-15.

![API таблиц Azure](./media/azure-table-api.png)

**Рис. 5-15**. Azure API таблиц

Приложения, написанные для хранилища таблиц Azure, можно перенести в Azure Cosmos DB с помощью API таблиц без изменений кода.

В сценариях приложений [серия статей Brownfield](https://en.wikipedia.org/wiki/Brownfield_(software_development)) группы разработчиков могут перенести существующие базы данных Mongo, Gremlin или Cassandra в Cosmos DB с минимальными изменениями существующих данных или кода приложения. В сценариях [нуля](https://en.wikipedia.org/wiki/Greenfield_project) группы разработчиков могут выбрать модель данных, которая наилучшим образом соответствует их требованиям и предпочтениям, включая полностью Поддерживаемые параметры с открытым исходным кодом для платформ MongoDB, Cassandra и Gremlin.

### <a name="consistency-models"></a>Модели согласованности

Ранее в *реляционном и NoSQL* разделе мы обсуждали тему *согласованности данных*, которая является термином, указывающим на целостность данных. Распределенные базы данных, использующие репликацию для обеспечения высокой доступности, низкой задержки или и того и другого, должны обеспечить фундаментальный компромисс между согласованностью чтения, доступностью и задержкой.

Большинство распределенных баз данных позволяют разработчикам выбирать между двумя моделями согласованности: [строгая согласованность](https://en.wikipedia.org/wiki/Strong_consistency) и [Окончательная согласованность](https://en.wikipedia.org/wiki/Eventual_consistency). *Строгая согласованность* является золотым стандартом для программирования данных. Это гарантирует, что результат запроса всегда будет возвращать самые актуальные данные, даже если система должна вызвать задержку, ожидающую обновления, для репликации во всех копиях базы данных. С другой стороны, система, настроенная для *окончательной согласованности* , будет возвращать данные немедленно, даже если эти данные не являются самой последней копией. Этот параметр обеспечивает повышенную доступность, большую масштабируемость и повышает производительность.

Azure Cosmos DB предлагает широкий спектр [пяти четко определенных моделей согласованности](https://docs.microsoft.com/azure/cosmos-db/consistency-levels) , показанных на рисунке 5-16. Эти параметры позволяют делать точные варианты и детальные компромиссы относительно доступности и производительности в зависимости от потребностей вашего приложения. Эти модели четко определены, интуитивно понятны и поддерживаются соглашениями об уровне обслуживания (SLA).

![Уровни согласованности Cosmos DB](./media/cosmos-db-consistency-levels.png)

**Рис. 5-16**. Cosmos DB уровней согласованности

### <a name="partitioning"></a>Секционирование

Azure Cosmos DB использует автоматическое [секционирование](https://docs.microsoft.com/azure/cosmos-db/partitioning-overview) для масштабирования базы данных в соответствии с потребностями производительности приложения.

Управление данными в Cosmos DB данных осуществляется путем создания [баз данных, контейнеров и элементов](https://docs.microsoft.com/azure/cosmos-db/databases-containers-items), показанных на рисунке 5-17.

![Cosmos DB сущности](./media/cosmos-db-entities.png)

**Рис. 5-17**. Иерархия сущностей Cosmos DB

Обратите внимание на рис. 5-17, как начать с создания базы данных Cosmos DB в учетной записи базы данных. Эта база данных станет единицей управления для набора контейнеров. Контейнер — это не зависящее от схемы группирование элементов, которые могут быть выражены в виде коллекции, таблицы или графа на основе выбранного поставщика API (рассматривается в предыдущем разделе). Элементы — это данные, которые добавляются в контейнер и представляются в виде документов, строк, узлов или границ. По умолчанию все элементы, добавляемые в контейнер, автоматически индексируются без необходимости явного управления индексами или схемой.

Чтобы секционировать контейнер, элементы делятся на отдельные подмножества, называемые [логическими секциями](https://docs.microsoft.com/azure/cosmos-db/partition-data). Логические секции создаются на основе значения ключа секции, связанного с каждым элементом в контейнере. На рис. 5-18 показано, как все элементы в логической секции имеют одинаковое значение ключа секции.

![Механизм секционирования Cosmos DB](./media/cosmos-db-partitioning.png)

**Рис. 5-18**. механизм секционирования Cosmos DB

Обратите внимание на рис. 5-18, как каждый элемент включает ключ раздела «City» или «аэропорт». Этот ключ секции определяет логическую секцию элемента. Каждый код города назначается логической секции в контейнере на левой стороне и с кодом аэропорта в контейнере справа. Сочетание значения ключа секции со значением идентификатора элемента создает индекс элемента, однозначно определяющий элемент.

На внутреннем уровне Cosmos DB автоматически управляет размещением [логических секций](https://docs.microsoft.com/azure/cosmos-db/partition-data) в [физических секциях](https://docs.microsoft.com/azure/cosmos-db/partition-data) для эффективного удовлетворения требований к масштабируемости и производительности контейнера. По мере увеличения пропускной способности и требований к хранению приложений Azure Cosmos DB перемещает логические секции для повторного распределения нагрузки между большим количеством серверов. Эти операции перераспределения управляются Cosmos DB и выполняются без прерывания или простоя.

## <a name="azure-redis-cache"></a>Кэш Redis для Azure

Преимущества кэширования для повышения производительности и масштабируемости хорошо понятны.

Для собственного облачного приложения общее расположение для добавления кэширования находится внутри шлюза API. Шлюз выступает в качестве внешнего интерфейса для всех входящих запросов. Путем добавления кэширования можно повысить производительность и скорость реагирования, возвращая кэшированные данные и избегая обращений к локальной базе данных или подчиненной службе. На рис. 5-19 показана архитектура кэширования для собственного облачного приложения.

![Кэширование в собственном приложении для облака](./media/caching-in-a-cloud-native-app.png)

**Рис. 5-19**. кэширование в собственном приложении в облаке

Шаблон общего кэширования — это [шаблон](https://docs.microsoft.com/azure/architecture/patterns/cache-aside), расположенный в кэше. Для входящего запроса сначала вы запрашиваете кэш для ответа, как показано на шаге #1 на рис. 5-19. Если объект найден, данные возвращаются немедленно. Если данные не существуют в кэше (называемые [промахом кэша](https://www.techopedia.com/definition/6308/cache-miss)), они извлекаются из локальной базы данных или подчиненной службы (шаг #2), записываются в кэш для будущих запросов (шаг #3) и возвращаются вызывающему. Необходимо принять меры для периодического исключения кэшированных данных, чтобы система оставалась единообразной и точной.

Кроме того, обратите внимание на рис. 5-19, как кэш не реализуется локально в пределах службы, а используется как облачная служба резервного копирования, как описано в главе 1.

[Кэш Redis для Azure](https://azure.microsoft.com/services/cache/) — это кэширование данных и служба посредника обмена сообщениями. Он обеспечивает высокую пропускную способность и низкую задержку при доступе к данным для приложений. Она полностью управляется корпорацией Майкрософт, размещается в Azure и доступна для любого приложения в или за пределами Azure.

На внутреннем уровне кэш Azure для Redis поддерживается [сервером Redis](https://redis.io/) с открытым исходным кодом и изначально поддерживает такие структуры данных, как [строки](https://redis.io/topics/data-types#strings), [хэши](https://redis.io/topics/data-types#hashes), [списки](https://redis.io/topics/data-types#sets), [наборы](https://redis.io/topics/data-types#sets)и [отсортированные наборы](https://redis.io/topics/data-types#sorted-sets). Если приложение использует Redis, оно будет работать как есть с кэшем Azure для Redis.

Кэш Azure для Redis также можно использовать в качестве кэша данных в памяти, распределенной нереляционной базы данных и брокера сообщений. Он доступен в трех разных ценовых категориях. Уровень "Премиум" включает многие функции корпоративного уровня, такие как кластеризация, сохраняемость данных, Георепликация и безопасность и изоляция виртуальных сетей.

>[!div class="step-by-step"]
>[Назад](data-patterns.md)
>[Вперед](resiliency.md)
