---
title: Масштабирование контейнеров и бессерверных приложений
description: Масштабирование собственных приложений в облаке с помощью службы Azure Kubernetes для удовлетворения потребностей пользователей путем увеличения числа отдельных ресурсов компьютера или увеличения количества компьютеров в кластере приложений.
ms.date: 09/23/2019
ms.openlocfilehash: 2d0537fb3ed56beb4eccbf9b8c34a5d87793413b
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2019
ms.locfileid: "73841015"
---
# <a name="scaling-containers-and-serverless-applications"></a><span data-ttu-id="9e1d9-103">Масштабирование контейнеров и бессерверных приложений</span><span class="sxs-lookup"><span data-stu-id="9e1d9-103">Scaling containers and serverless applications</span></span>

<span data-ttu-id="9e1d9-104">Существует два типичных способа масштабирования приложения: масштабирование и масштабирование. Первое относится к добавлению возможностей на один узел, а Последнее — к добавлению к общему количеству узлов.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-104">There are two typical ways to scale an application: scaling up and scaling out. The former refers to adding capabilities to one host, while the latter refers to adding to the total number of hosts.</span></span> <span data-ttu-id="9e1d9-105">Обычная аналогия, с помощью которой можно подумать об этом, заключается в том, как получить себя и некоторых друзей по всему городу.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-105">A common analogy to use to think about this is how to get yourself and some friends across town.</span></span> <span data-ttu-id="9e1d9-106">Если это только один дружественный специалист, вы можете перейдете на свой автомобиль с двумя местами.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-106">If it's just one friend, you could hop into your two-seat race car.</span></span> <span data-ttu-id="9e1d9-107">Но если он равен трем или четырем, то, возможно, потребуется сделать одно из Сувс или микроавтобуса, увеличив масштаб, чтобы увеличить емкость.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-107">But if it's three or four, you might need to take one of your SUVs or a minivan, scaling up to increase capacity.</span></span> <span data-ttu-id="9e1d9-108">Однако когда общее число переходит к десятке или более, вам, вероятно, придется использовать несколько транспортных средств (если кто-то не управляет шиной), демонстрирующий концепцию масштабирования путем добавления дополнительных экземпляров (в данном случае больше автомобилей).</span><span class="sxs-lookup"><span data-stu-id="9e1d9-108">When your total number jumps up to a dozen or more, though, you probably need to take multiple vehicles (unless someone drives a bus), which demonstrates the concept of scaling out by adding more instances (in this case, more vehicles).</span></span> <span data-ttu-id="9e1d9-109">Давайте посмотрим, как это применяется к нашим приложениям.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-109">Let's see how this applies to our applications.</span></span>

## <a name="the-simple-solution-scaling-up"></a><span data-ttu-id="9e1d9-110">Простое решение: увеличение масштаба</span><span class="sxs-lookup"><span data-stu-id="9e1d9-110">The simple solution: scaling up</span></span>

<span data-ttu-id="9e1d9-111">Процесс обновления существующих серверов для получения дополнительных ресурсов (ЦП, памяти, скорости операций ввода-вывода на диск и скорости сетевого ввода-вывода) называется *масштабированием*.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-111">The process of upgrading existing servers to give them more resources (CPU, memory, disk I/O speed, network I/O speed) is known as *scaling up*.</span></span> <span data-ttu-id="9e1d9-112">В собственных облачных приложениях масштабирование обычно не относится к приобретению и установке фактического оборудования на физических компьютерах, так же как выбор более производительного плана из списка доступных вариантов.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-112">In cloud-native applications, scaling up doesn't typically refer to purchasing and installing actual hardware on physical machines so much as choosing a more capable plan from a list of options available.</span></span> <span data-ttu-id="9e1d9-113">Облачные приложения обычно масштабируются путем изменения размера виртуальной машины (ВМ), используемой для размещения отдельных узлов в их пуле узлов Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-113">Cloud-native apps typically scale up by modifying the virtual machine (VM) size used to host the individual nodes in their Kubernetes node pool.</span></span> <span data-ttu-id="9e1d9-114">Основные понятия Kubernetes, такие как узлы, кластеры и модули Pod, описаны [Далее в следующем разделе](leverage-containers-orchestrators.md).</span><span class="sxs-lookup"><span data-stu-id="9e1d9-114">Kubernetes concepts like nodes, clusters, and pods are described further in [the next section](leverage-containers-orchestrators.md).</span></span> <span data-ttu-id="9e1d9-115">Azure поддерживает широкий спектр размеров виртуальных машин под управлением [Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sizes?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) и [Linux](https://docs.microsoft.com/azure/virtual-machines/linux/sizes).</span><span class="sxs-lookup"><span data-stu-id="9e1d9-115">Azure supports a wide variety of VM sizes running both [Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sizes?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) and [Linux](https://docs.microsoft.com/azure/virtual-machines/linux/sizes).</span></span> <span data-ttu-id="9e1d9-116">Чтобы масштабировать приложение по вертикали, создайте пул узлов с большим размером виртуальной машины узла, а затем перенесите рабочие нагрузки в новый пул.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-116">To vertically scale your application, create a new node pool with a larger node VM size and then migrate workloads to the new pool.</span></span> <span data-ttu-id="9e1d9-117">Для этого требуется [несколько пулов узлов для кластера AKS](https://docs.microsoft.com/azure/aks/use-multiple-node-pools)— компонент, который сейчас находится в предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-117">This requires [multiple node pools for your AKS cluster](https://docs.microsoft.com/azure/aks/use-multiple-node-pools), a feature that is currently in preview.</span></span> <span data-ttu-id="9e1d9-118">Бессерверные приложения масштабируются вверх, выбрав [план Premium](https://docs.microsoft.com/azure/azure-functions/functions-scale) и размеры экземпляров уровня "Премиум" или выбрав другой выделенный план службы приложений.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-118">Serverless apps scale up by choosing a [premium plan](https://docs.microsoft.com/azure/azure-functions/functions-scale) and premium instance sizes or by choosing a different dedicated app service plan.</span></span>

## <a name="scaling-out-cloud-native-apps"></a><span data-ttu-id="9e1d9-119">Масштабирование собственных приложений в облаке</span><span class="sxs-lookup"><span data-stu-id="9e1d9-119">Scaling out cloud-native apps</span></span>

<span data-ttu-id="9e1d9-120">Облачные приложения поддерживают масштабирование путем добавления дополнительных узлов или модулей для запросов на обслуживание.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-120">Cloud-native apps support scaling out by adding additional nodes or pods to service requests.</span></span> <span data-ttu-id="9e1d9-121">Это можно сделать вручную, изменив параметры конфигурации приложения (например, [масштабирование пула узлов](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)) или с помощью *автомасштабирования*.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-121">This can be accomplished manually by adjusting configuration settings for the app (for example, [scaling a node pool](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)), or through *autoscaling*.</span></span> <span data-ttu-id="9e1d9-122">Автомасштабирование корректирует ресурсы, используемые приложением, чтобы реагировать на запросы, аналогично тому, как термостата реагирует на температуру, вызывая для дополнительного нагрева или охлаждения.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-122">Autoscaling adjusts the resources used by an app in order to respond to demand, similar to how a thermostat responds to temperature by calling for additional heating or cooling.</span></span> <span data-ttu-id="9e1d9-123">При использовании автомасштабирования ручное масштабирование отключено.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-123">When using autoscaling, manual scaling is disabled.</span></span>

<span data-ttu-id="9e1d9-124">Кластеры AKS могут масштабироваться одним из двух способов:</span><span class="sxs-lookup"><span data-stu-id="9e1d9-124">AKS clusters can scale in one of two ways:</span></span>

- <span data-ttu-id="9e1d9-125">[Автомасштабирование кластера](https://docs.microsoft.com/azure/aks/cluster-autoscaler) наблюдает за модулями Pod, которые не могут быть запланированы на узлах из-за ограничений ресурсов.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-125">The [cluster autoscaler](https://docs.microsoft.com/azure/aks/cluster-autoscaler) watches for pods that can't be scheduled on nodes because of resource constraints.</span></span> <span data-ttu-id="9e1d9-126">При необходимости в нем добавляются дополнительные узлы.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-126">It adds additional nodes as required.</span></span>
- <span data-ttu-id="9e1d9-127">**Горизонтальный Автомасштабирование Pod** использует сервер метрик в кластере Kubernetes для отслеживания требований к ресурсам для модулей Pod.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-127">The **horizontal pod autoscaler** uses the Metrics Server in a Kubernetes cluster to monitor the resource demands of pods.</span></span> <span data-ttu-id="9e1d9-128">Если службе требуется больше ресурсов, автомасштабирование увеличивает число модулей.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-128">If a service needs more resources, the autoscaler increases the number of pods.</span></span>

<span data-ttu-id="9e1d9-129">На рис. 3-13 показана связь между этими двумя службами масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-129">Figure 3-13 shows the relationship between these two scaling services.</span></span>

![Масштабирование плана службы приложений.](./media/aks-cluster-autoscaler.png)

<span data-ttu-id="9e1d9-131">**Рис. 3-13**.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-131">**Figure 3-13**.</span></span> <span data-ttu-id="9e1d9-132">Масштабирование плана службы приложений.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-132">Scaling out an App Service plan.</span></span>

<span data-ttu-id="9e1d9-133">Эти службы также могут уменьшить число модулей Pod или узлов по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-133">These services can also reduce the number of pods or nodes as needed.</span></span> <span data-ttu-id="9e1d9-134">Эти две службы могут работать вместе и часто развертываться вместе в кластере.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-134">These two services can work together and are often deployed together in a cluster.</span></span> <span data-ttu-id="9e1d9-135">В сочетании горизонтальное Автомасштабирование Pod сосредоточено на запуске числа модулей, необходимых для удовлетворения требований приложения.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-135">When combined, the horizontal pod autoscaler is focused on running the number of pods required to meet application demand.</span></span> <span data-ttu-id="9e1d9-136">Автомасштабирование кластера посвящено запуску количества узлов, необходимых для поддержки запланированных модулей Pod.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-136">The cluster autoscaler is focused on running the number of nodes required to support the scheduled pods.</span></span>

### <a name="scaling-azure-functions"></a><span data-ttu-id="9e1d9-137">Масштабирование функций Azure</span><span class="sxs-lookup"><span data-stu-id="9e1d9-137">Scaling Azure Functions</span></span>

<span data-ttu-id="9e1d9-138">Функции Azure автоматически поддерживают масштабирование. План потребления по умолчанию добавляет (и удаляет) ресурсы динамически в зависимости от числа инициированных событий.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-138">Azure Functions automatically supports scaling out. The default consumption plan adds (and removes) resources dynamically based on the number of triggering events coming in.</span></span> <span data-ttu-id="9e1d9-139">Плата за вычислительные ресурсы используются только при выполнении функций в зависимости от числа выполнений, времени выполнения и используемой памяти.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-139">You're only charged for compute resources being used when your functions are running based on the number of executions, execution time, and memory used.</span></span> <span data-ttu-id="9e1d9-140">Используя план Premium, вы получаете те же функции, но можете управлять используемыми размерами экземпляров, иметь уже загруженные экземпляры (чтобы избежать задержек при холодном запуске) и настраивать выделенные виртуальные машины, на которых будут выполняться ваши функции.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-140">Using the premium plan, you get these same features but you can also control the instance sizes that are used, have instances already warmed up (to avoid cold start delays), and configure dedicated VMs on which to run your functions.</span></span> <span data-ttu-id="9e1d9-141">Хотя конфигурация по умолчанию должна обеспечивать экономичное и масштабируемое решение для большинства приложений, вариант Premium позволяет разработчикам гибко работать с пользовательскими требованиями к функциям Azure.</span><span class="sxs-lookup"><span data-stu-id="9e1d9-141">While the default configuration should provide an economical and scalable solution for most apps, the premium option allows developers flexibility for custom Azure Functions requirements.</span></span>

## <a name="references"></a><span data-ttu-id="9e1d9-142">Ссылки</span><span class="sxs-lookup"><span data-stu-id="9e1d9-142">References</span></span>

- [<span data-ttu-id="9e1d9-143">AKS нескольких пулов узлов</span><span class="sxs-lookup"><span data-stu-id="9e1d9-143">AKS Multiple Node Pools</span></span>](https://docs.microsoft.com/azure/aks/use-multiple-node-pools)
- [<span data-ttu-id="9e1d9-144">Автомасштабирование кластера AKS</span><span class="sxs-lookup"><span data-stu-id="9e1d9-144">AKS Cluster Autoscaler</span></span>](https://docs.microsoft.com/azure/aks/cluster-autoscaler)
- [<span data-ttu-id="9e1d9-145">Руководство. масштабирование приложений в AKS</span><span class="sxs-lookup"><span data-stu-id="9e1d9-145">Tutorial: Scale applications in AKS</span></span>](https://docs.microsoft.com/azure/aks/tutorial-kubernetes-scale)
- [<span data-ttu-id="9e1d9-146">Масштабирование и размещение функций Azure</span><span class="sxs-lookup"><span data-stu-id="9e1d9-146">Azure Functions scale and hosting</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-scale)

>[!div class="step-by-step"]
><span data-ttu-id="9e1d9-147">[Назад](deploy-containers-azure.md)
>[Вперед](other-deployment-options.md)</span><span class="sxs-lookup"><span data-stu-id="9e1d9-147">[Previous](deploy-containers-azure.md)
[Next](other-deployment-options.md)</span></span>
