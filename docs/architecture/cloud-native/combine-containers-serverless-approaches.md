---
title: Объединение контейнеров и бессерверных подходов для облачных служб
description: Объединение контейнеров и Kubernetes с бессерверными подходами
ms.date: 05/13/2020
ms.openlocfilehash: b1b85519ce02ddd1d69735d872cf24fadcc81ef7
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2020
ms.locfileid: "91160896"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="1bf3f-103">Сочетание контейнеров и бессерверных подходов</span><span class="sxs-lookup"><span data-stu-id="1bf3f-103">Combining containers and serverless approaches</span></span>

<span data-ttu-id="1bf3f-104">Облачные приложения обычно реализуют службы, использующие контейнеры и оркестрации.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-104">Cloud-native applications typically implement services leveraging containers and orchestration.</span></span> <span data-ttu-id="1bf3f-105">Зачастую существуют возможности предоставления некоторых служб приложения в виде функций Azure.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-105">There are often opportunities to expose some of the application's services as Azure Functions.</span></span> <span data-ttu-id="1bf3f-106">Однако с облачным приложением, развернутым в Kubernetes, было бы неплохо использовать функции Azure в этом же наборе инструментов.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-106">However, with a cloud-native app deployed to Kubernetes, it would be nice to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="1bf3f-107">К счастью, вы можете включить функции Azure в контейнеры DOCKER и развернуть их с помощью тех же процессов и средств, что и в остальной части вашего приложения на основе Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-107">Fortunately, you can wrap Azure Functions inside Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="1bf3f-108">Когда имеет смысл использовать контейнеры без сервера?</span><span class="sxs-lookup"><span data-stu-id="1bf3f-108">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="1bf3f-109">Функция Azure не имеет сведений о платформе, на которой она развернута.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-109">Your Azure Function has no knowledge of the platform on which it's deployed.</span></span> <span data-ttu-id="1bf3f-110">В некоторых сценариях могут присутствовать определенные требования и необходимо настроить среду, в которой будет выполняться код функции.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-110">For some scenarios, you may have specific requirements and need to customize the environment on which your function code will run.</span></span> <span data-ttu-id="1bf3f-111">Вам потребуется пользовательский образ, который поддерживает зависимости или конфигурацию, не поддерживаемую изображением по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-111">You'll need a custom image that supports dependencies or a configuration not supported by the default image.</span></span> <span data-ttu-id="1bf3f-112">В таких случаях имеет смысл развернуть функцию в пользовательском контейнере DOCKER.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-112">In these cases, it makes sense to deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="1bf3f-113">Когда следует избегать использования контейнеров с функциями Azure?</span><span class="sxs-lookup"><span data-stu-id="1bf3f-113">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="1bf3f-114">Если вы хотите использовать выставление счетов за потребление, вы не сможете запустить функцию в контейнере.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-114">If you want to use consumption billing, you won't be able to run your function in a container.</span></span> <span data-ttu-id="1bf3f-115">Более того, если вы развертываете функцию в кластере Kubernetes, вы больше не сможете воспользоваться встроенным масштабированием, предоставляемым функциями Azure.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-115">What's more, if you deploy your function to a Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="1bf3f-116">Вам потребуется использовать функции масштабирования Kubernetes, описанные выше в этой главе.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-116">You'll need to use Kubernetes' scaling features, described earlier in this chapter.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="1bf3f-117">Объединение бессерверных и контейнеров DOCKER</span><span class="sxs-lookup"><span data-stu-id="1bf3f-117">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="1bf3f-118">Чтобы включить функцию Azure в контейнер DOCKER, установите [Azure functions Core Tools](https://github.com/Azure/azure-functions-core-tools) и выполните следующую команду:</span><span class="sxs-lookup"><span data-stu-id="1bf3f-118">To wrap an Azure Function in a Docker container, install the [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) and then run the following command:</span></span>

```console
func init ProjectName --worker-runtime dotnet --docker
```

<span data-ttu-id="1bf3f-119">При создании проекта он будет включать в себя Dockerfile и рабочую среду выполнения, настроенную для `dotnet` .</span><span class="sxs-lookup"><span data-stu-id="1bf3f-119">When the project is created, it will include a Dockerfile and the worker runtime configured to `dotnet`.</span></span> <span data-ttu-id="1bf3f-120">Теперь можно создать и протестировать функцию локально.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-120">Now, you can create and test your function locally.</span></span> <span data-ttu-id="1bf3f-121">Выполните сборку и запустите ее с  `docker build` помощью `docker run` команд и.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-121">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="1bf3f-122">Подробные инструкции по созданию функций Azure с поддержкой DOCKER см. в руководстве [Создание функции в Linux с помощью пользовательского образа](/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="1bf3f-122">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="1bf3f-123">Объединение бессерверных и Kubernetes с Кеда</span><span class="sxs-lookup"><span data-stu-id="1bf3f-123">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="1bf3f-124">В этой главе вы увидели, что платформа функций Azure автоматически масштабируется для удовлетворения спроса.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-124">In this chapter, you've seen that the Azure Functions' platform automatically scales out to meet demand.</span></span> <span data-ttu-id="1bf3f-125">Однако при развертывании контейнерных функций для AKS теряются встроенные функции масштабирования.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-125">When deploying containerized functions to AKS, however, you lose the built-in scaling functionality.</span></span> <span data-ttu-id="1bf3f-126">К аварийному поступилию, [Kubernetes на основе событий (Кеда)](/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="1bf3f-126">To the rescue comes [Kubernetes-based Event Driven (KEDA)](/azure/azure-functions/functions-kubernetes-keda).</span></span> <span data-ttu-id="1bf3f-127">Он обеспечивает детальное автоматическое масштабирование для `event-driven Kubernetes workloads,` включения контейнерных функций.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-127">It enables fine-grained autoscaling for `event-driven Kubernetes workloads,` including containerized functions.</span></span>

<span data-ttu-id="1bf3f-128">Кеда предоставляет функции масштабирования, управляемые событиями, для среды выполнения функций в контейнере DOCKER.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-128">KEDA provides event-driven scaling functionality to the Functions' runtime in a Docker container.</span></span> <span data-ttu-id="1bf3f-129">Кеда может масштабироваться от нулевых экземпляров (если события не происходят) в `n instances` зависимости от нагрузки.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-129">KEDA can scale from zero instances (when no events are occurring) out to `n instances`, based on load.</span></span> <span data-ttu-id="1bf3f-130">Он включает Автомасштабирование, предоставляя пользовательские метрики для автомасштабирования Kubernetes (горизонтальный Автомасштабирование Pod).</span><span class="sxs-lookup"><span data-stu-id="1bf3f-130">It enables autoscaling by exposing custom metrics to the Kubernetes autoscaler (Horizontal Pod Autoscaler).</span></span> <span data-ttu-id="1bf3f-131">Использование контейнеров Функций с KEDA позволяет реплицировать возможности бессерверных функций в любом кластере Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="1bf3f-131">Using Functions containers with KEDA makes it possible to replicate serverless function capabilities in any Kubernetes cluster.</span></span>

<span data-ttu-id="1bf3f-132">Стоит отметить, что проект Кеда теперь управляется облачной средой Cloud Foundation (КНКФ).</span><span class="sxs-lookup"><span data-stu-id="1bf3f-132">It is worth noting that the KEDA project is now managed by the Cloud Native Computing Foundation (CNCF).</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="1bf3f-133">[Назад](leverage-serverless-functions.md)
>[Вперед](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="1bf3f-133">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>
