---
title: Сочетание контейнеров и бессерверных подходов
description: Объединение контейнеров и Kubernetes с бессерверными подходами
ms.date: 06/30/2019
ms.openlocfilehash: 58aff43adbdd2e629370cc685f32c7b61c25f85e
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2019
ms.locfileid: "73840595"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="a038c-103">Сочетание контейнеров и бессерверных подходов</span><span class="sxs-lookup"><span data-stu-id="a038c-103">Combining containers and serverless approaches</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="a038c-104">Часто приложения на основе микрослужб сильно полагаются на контейнеры, оркестрации и передачу сообщений для обмена данными между узлами.</span><span class="sxs-lookup"><span data-stu-id="a038c-104">Frequently, microservices-based applications rely heavily on containers, orchestration, and message-passing for communication between nodes.</span></span> <span data-ttu-id="a038c-105">Эта система обмена сообщениями является идеальной задачей для функций Azure, но с остальной частью приложения, настроенного и развернутого с помощью Kubernetes и связанных с ним средств, было бы неплохо иметь возможность использовать функции Azure в этом же наборе инструментов.</span><span class="sxs-lookup"><span data-stu-id="a038c-105">This messaging is an ideal task for Azure Functions, but with the rest of the application configured and deployed using Kubernetes and related tools, it would be nice to be able to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="a038c-106">К счастью, вы можете обернуть функции Azure в контейнеры DOCKER и развертывать их с помощью тех же процессов и средств, что и в остальной части вашего приложения на основе Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="a038c-106">Fortunately, you can wrap Azure Functions in Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="a038c-107">Когда имеет смысл использовать контейнеры без сервера?</span><span class="sxs-lookup"><span data-stu-id="a038c-107">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="a038c-108">По умолчанию бессерверные функции не имеют сведений о платформе, на которой они будут выполняться.</span><span class="sxs-lookup"><span data-stu-id="a038c-108">By default, your serverless functions have no knowledge of the platform on which they'll run.</span></span> <span data-ttu-id="a038c-109">Однако в некоторых случаях могут потребоваться особые требования, которые позволят вам настроить образ контейнера, в котором будет выполняться код.</span><span class="sxs-lookup"><span data-stu-id="a038c-109">However, in some cases you may have specific requirements that make it important for you to customize the container image in which your code will run.</span></span> <span data-ttu-id="a038c-110">Вы можете использовать пользовательский образ, так как функция зависит от конкретной языковой версии или имеет зависимости или требования к конфигурации, которые не поддерживаются образом по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a038c-110">You may want to use a custom image because your function relies on a specific language version or has dependencies or configuration requirements that aren't supported by the default image.</span></span> <span data-ttu-id="a038c-111">В таких случаях может быть целесообразно настроить собственный контейнер и развернуть функцию в пользовательском контейнере DOCKER.</span><span class="sxs-lookup"><span data-stu-id="a038c-111">In these cases, it may make sense to customize your own container and deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="a038c-112">Когда следует избегать использования контейнеров с функциями Azure?</span><span class="sxs-lookup"><span data-stu-id="a038c-112">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="a038c-113">Если вы ожидаете использовать для вашей функции выставление счетов в плане потребления, вы не сможете сделать это, если используете собственный контейнер.</span><span class="sxs-lookup"><span data-stu-id="a038c-113">If you're expecting to benefit from the consumption plan billing for your function, you won't be able to do so if you're using your own container.</span></span> <span data-ttu-id="a038c-114">Более того, если вы выходите за рамки использования контейнера DOCKER и развертываете функции в своем собственном кластере Kubernetes, вы больше не сможете воспользоваться встроенным масштабированием, предоставляемым функциями Azure.</span><span class="sxs-lookup"><span data-stu-id="a038c-114">What's more, if you go beyond just using a Docker container and deploy your functions to your own Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="a038c-115">Вам потребуется использовать функции масштабирования Kubernetes, описанные ниже.</span><span class="sxs-lookup"><span data-stu-id="a038c-115">You'll need to use Kubernetes' scaling features, described below.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="a038c-116">Объединение бессерверных и контейнеров DOCKER</span><span class="sxs-lookup"><span data-stu-id="a038c-116">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="a038c-117">Чтобы включить функцию Azure в контейнер DOCKER, установите Azure Functions Core Tools и выполните следующую команду:</span><span class="sxs-lookup"><span data-stu-id="a038c-117">To wrap an Azure Function in a Docker container, install the Azure Functions Core Tools and then run the following command:</span></span>

```console
func init ProjectName --docker
```

<span data-ttu-id="a038c-118">Выберите нужную рабочую среду из следующих вариантов:</span><span class="sxs-lookup"><span data-stu-id="a038c-118">Choose which worker runtime you want from the following options:</span></span>

- <span data-ttu-id="a038c-119">`dotnet` (C#)</span><span class="sxs-lookup"><span data-stu-id="a038c-119">`dotnet` (C#)</span></span>
- <span data-ttu-id="a038c-120">`node` (JavaScript)</span><span class="sxs-lookup"><span data-stu-id="a038c-120">`node` (JavaScript)</span></span>
- `python`

<span data-ttu-id="a038c-121">При создании проекта он будет включать в себя Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="a038c-121">When the project is created, it will include a Dockerfile.</span></span> <span data-ttu-id="a038c-122">Теперь можно создать и протестировать функцию локально.</span><span class="sxs-lookup"><span data-stu-id="a038c-122">Now, you can create and test your function locally.</span></span> <span data-ttu-id="a038c-123">Выполните сборку и запустите ее с помощью команд `docker build` и `docker run`.</span><span class="sxs-lookup"><span data-stu-id="a038c-123">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="a038c-124">Подробные инструкции по созданию функций Azure с поддержкой DOCKER см. в руководстве [Создание функции в Linux с помощью пользовательского образа](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="a038c-124">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="a038c-125">Объединение бессерверных и Kubernetes с Кеда</span><span class="sxs-lookup"><span data-stu-id="a038c-125">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="a038c-126">Функции Azure масштабируются автоматически, чтобы удовлетворить спрос на основе частоты событий, предназначенных для данной функции.</span><span class="sxs-lookup"><span data-stu-id="a038c-126">Azure functions scale automatically to meet demand based on the rate of events that are targeting a given function.</span></span> <span data-ttu-id="a038c-127">Кроме того, можно использовать Kubernetes для размещения функций и использовать автоматическое масштабирование, управляемое событиями на основе Kubernetes, или Кеда.</span><span class="sxs-lookup"><span data-stu-id="a038c-127">Additionally, you can leverage Kubernetes to host your functions and use Kubernetes-based Event Driven Autoscaling, or KEDA.</span></span> <span data-ttu-id="a038c-128">Если события не происходят, Кеда может масштабироваться до 0 экземпляров, а затем в ответ на события он может масштабировать количество контейнеров в соответствии с потребностями, используя горизонтальный Автомасштабирование Pod.</span><span class="sxs-lookup"><span data-stu-id="a038c-128">When no events are occurring, KEDA can scale down to 0 instances, and then in response to events it can scale up the number of containers to meet the demand using its horizontal pod autoscaler.</span></span> <span data-ttu-id="a038c-129">Дополнительные [сведения о масштабировании функций Azure с помощью Кеда](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="a038c-129">[Learn more about scaling Azure functions with KEDA](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span></span>

## <a name="references"></a><span data-ttu-id="a038c-130">Ссылки</span><span class="sxs-lookup"><span data-stu-id="a038c-130">References</span></span>

- [<span data-ttu-id="a038c-131">Запуск функций Azure в контейнере DOCKER</span><span class="sxs-lookup"><span data-stu-id="a038c-131">Run Azure Functions in a Docker Container</span></span>](https://markheath.net/post/azure-functions-docker)
- [<span data-ttu-id="a038c-132">Создание функции в Linux с помощью пользовательского образа</span><span class="sxs-lookup"><span data-stu-id="a038c-132">Create a function on Linux using a custom image</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image)
- [<span data-ttu-id="a038c-133">Функции Azure с автомасштабированием, управляемым событиями Kubernetes</span><span class="sxs-lookup"><span data-stu-id="a038c-133">Azure Functions with Kubernetes Event Driven Autoscaling</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda)

>[!div class="step-by-step"]
><span data-ttu-id="a038c-134">[Назад](leverage-serverless-functions.md)
>[Вперед](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="a038c-134">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>
