---
title: Инфраструктура связи для слоя взаимодействия между службами
description: Узнайте о том, как технологии сервисной сетки упрощают связь с облачными микрослужбами
author: robvet
ms.date: 03/03/2020
ms.openlocfilehash: 6b177ef33b804ec35f3acb919539a97683e5a487
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2020
ms.locfileid: "80523523"
---
# <a name="service-mesh-communication-infrastructure"></a><span data-ttu-id="5db7f-103">Инфраструктура связи для слоя взаимодействия между службами</span><span class="sxs-lookup"><span data-stu-id="5db7f-103">Service Mesh communication infrastructure</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="5db7f-104">На протяжении этой главы мы исследовали проблемы микрослужбы связи.</span><span class="sxs-lookup"><span data-stu-id="5db7f-104">Throughout this chapter, we've explored the challenges of microservice communication.</span></span> <span data-ttu-id="5db7f-105">Мы сказали, что группы разработчиков должны быть чувствительны к тому, как службы бэк-энда взаимодействуют друг с другом.</span><span class="sxs-lookup"><span data-stu-id="5db7f-105">We said that development teams need to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="5db7f-106">В идеале, чем меньше межсервисная связь, тем лучше.</span><span class="sxs-lookup"><span data-stu-id="5db7f-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="5db7f-107">Однако избежать не всегда возможно, так как службы обратного конца часто полагаются друг на друга для завершения операций.</span><span class="sxs-lookup"><span data-stu-id="5db7f-107">However, avoidance isn't always possible as back-end services often rely on one another to complete operations.</span></span>

<span data-ttu-id="5db7f-108">Мы изучили различные подходы к внедрению синхронной связи HTTP и асинхронных сообщений.</span><span class="sxs-lookup"><span data-stu-id="5db7f-108">We explored different approaches for implementing synchronous HTTP communication and asynchronous messaging.</span></span> <span data-ttu-id="5db7f-109">В каждом из случаев разработчик обременен реализацией коммуникационного кода.</span><span class="sxs-lookup"><span data-stu-id="5db7f-109">In each of the cases, the developer is burdened with implementing communication code.</span></span> <span data-ttu-id="5db7f-110">Коммуникационный код является сложным и трудоемким.</span><span class="sxs-lookup"><span data-stu-id="5db7f-110">Communication code is complex and time intensive.</span></span> <span data-ttu-id="5db7f-111">Неправильные решения могут привести к значительным проблемам с производительностью.</span><span class="sxs-lookup"><span data-stu-id="5db7f-111">Incorrect decisions can lead to significant performance issues.</span></span>

<span data-ttu-id="5db7f-112">Более современный подход к микросервисным коммуникационным центрам вокруг новой и быстро развивающейся технологии под названием *Service Mesh*.</span><span class="sxs-lookup"><span data-stu-id="5db7f-112">A more modern approach to microservice communication centers around a new and rapidly evolving technology entitled *Service Mesh*.</span></span> <span data-ttu-id="5db7f-113">[Сетка обслуживания](https://www.nginx.com/blog/what-is-a-service-mesh/) — это настраиваемый уровень инфраструктуры со встроенными возможностями для обработки связи между службами, устойчивостью и множеством проблем, связанных с перекрестным сокращением.</span><span class="sxs-lookup"><span data-stu-id="5db7f-113">A [service mesh](https://www.nginx.com/blog/what-is-a-service-mesh/) is a configurable infrastructure layer with built-in capabilities to handle service-to-service communication, resiliency, and many cross-cutting concerns.</span></span> <span data-ttu-id="5db7f-114">Он переносит ответственность за эти проблемы из микрослужб и в уровень сетки обслуживания.</span><span class="sxs-lookup"><span data-stu-id="5db7f-114">It moves the responsibility for these concerns out of the microservices and into service mesh layer.</span></span> <span data-ttu-id="5db7f-115">Связь абстрагируется от ваших микрослужб.</span><span class="sxs-lookup"><span data-stu-id="5db7f-115">Communication is abstracted away from your microservices.</span></span>

<span data-ttu-id="5db7f-116">Ключевым компонентом сетки службявляется прокси.</span><span class="sxs-lookup"><span data-stu-id="5db7f-116">A key component of a service mesh is a proxy.</span></span> <span data-ttu-id="5db7f-117">В облачном приложении экземпляр прокси обычно расположен с каждой микрослужбой.</span><span class="sxs-lookup"><span data-stu-id="5db7f-117">In a cloud-native application, an instance of a proxy is typically colocated with each microservice.</span></span> <span data-ttu-id="5db7f-118">Хотя они выполняются в отдельных процессах, они тесно связаны между собой и имеют один и тот же жизненный цикл.</span><span class="sxs-lookup"><span data-stu-id="5db7f-118">While they execute in separate processes, the two are closely linked and share the same lifecycle.</span></span> <span data-ttu-id="5db7f-119">Этот шаблон, известный как [шаблон Sidecar,](https://docs.microsoft.com/azure/architecture/patterns/sidecar)и показан на рисунке 4-24.</span><span class="sxs-lookup"><span data-stu-id="5db7f-119">This pattern, known as the [Sidecar pattern](https://docs.microsoft.com/azure/architecture/patterns/sidecar), and is shown in Figure 4-24.</span></span>

![Сервисная сетка с боквейным автомобилем](./media/service-mesh-with-side-car.png)

<span data-ttu-id="5db7f-121">**Рис. 4-24**.</span><span class="sxs-lookup"><span data-stu-id="5db7f-121">**Figure 4-24**.</span></span> <span data-ttu-id="5db7f-122">Сервисная сетка с боквейным автомобилем</span><span class="sxs-lookup"><span data-stu-id="5db7f-122">Service mesh with a side car</span></span>

<span data-ttu-id="5db7f-123">Обратите внимание на предыдущую цифру, как сообщения перехватываются прокси, который работает рядом с каждой микрослужбой.</span><span class="sxs-lookup"><span data-stu-id="5db7f-123">Note in the previous figure how messages are intercepted by a proxy that runs alongside each microservice.</span></span> <span data-ttu-id="5db7f-124">Каждый прокси может быть настроен с правилами дорожного движения, специфичными для микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="5db7f-124">Each proxy can be configured with traffic rules specific to the microservice.</span></span> <span data-ttu-id="5db7f-125">Он понимает сообщения и может направлять их через ваши службы и внешний мир.</span><span class="sxs-lookup"><span data-stu-id="5db7f-125">It understands messages and can route them across your services and the outside world.</span></span>

<span data-ttu-id="5db7f-126">Наряду с управлением коммуникациями от обслуживания к службе, Сервисная сетка обеспечивает поддержку для обнаружения служб и балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="5db7f-126">Along with managing service-to-service communication, the Service Mesh provides support for service discovery and load balancing.</span></span>

<span data-ttu-id="5db7f-127">После настройки сетка обслуживания очень функционален.</span><span class="sxs-lookup"><span data-stu-id="5db7f-127">Once configured, a service mesh is highly functional.</span></span> <span data-ttu-id="5db7f-128">Сетка извлекает соответствующий пул экземпляров из конечной точки обнаружения службы.</span><span class="sxs-lookup"><span data-stu-id="5db7f-128">The mesh retrieves a corresponding pool of instances from a service discovery endpoint.</span></span> <span data-ttu-id="5db7f-129">Он отправляет запрос в определенный экземпляр службы, записывая задержку и тип ответа результата.</span><span class="sxs-lookup"><span data-stu-id="5db7f-129">It sends a request to a specific service instance, recording the latency and response type of the result.</span></span> <span data-ttu-id="5db7f-130">Он выбирает экземпляр, который, скорее всего, может вернуть быстрый ответ на основе различных факторов, включая наблюдаемую задержку последних запросов.</span><span class="sxs-lookup"><span data-stu-id="5db7f-130">It chooses the instance most likely to return a fast response based on different factors, including the observed latency for recent requests.</span></span>

<span data-ttu-id="5db7f-131">Сетка службы управляет проблемами трафика, связи и сетей на уровне приложений.</span><span class="sxs-lookup"><span data-stu-id="5db7f-131">A service mesh manages traffic, communication, and networking concerns at the application level.</span></span> <span data-ttu-id="5db7f-132">Он понимает сообщения и запросы.</span><span class="sxs-lookup"><span data-stu-id="5db7f-132">It understands messages and requests.</span></span> <span data-ttu-id="5db7f-133">Сервисная сетка обычно интегрируется с контейнерным оркестратором.</span><span class="sxs-lookup"><span data-stu-id="5db7f-133">A service mesh typically integrates with a container orchestrator.</span></span> <span data-ttu-id="5db7f-134">Kubernetes поддерживает расширяемую архитектуру, в которой может быть добавлена сервисная сетка.</span><span class="sxs-lookup"><span data-stu-id="5db7f-134">Kubernetes supports an extensible architecture in which a service mesh can be added.</span></span>

<span data-ttu-id="5db7f-135">В главе 6 мы глубоко погружаемся в технологии Сервисной сетки, включая обсуждение его архитектуры и доступных реализаций с открытым исходным кодом.</span><span class="sxs-lookup"><span data-stu-id="5db7f-135">In chapter 6, we deep-dive into Service Mesh technologies including a discussion on its architecture and available open-source implementations.</span></span>

## <a name="summary"></a><span data-ttu-id="5db7f-136">Сводка</span><span class="sxs-lookup"><span data-stu-id="5db7f-136">Summary</span></span>

<span data-ttu-id="5db7f-137">В этой главе мы обсудили модели облачной коммуникации.</span><span class="sxs-lookup"><span data-stu-id="5db7f-137">In this chapter, we discussed cloud-native communication patterns.</span></span> <span data-ttu-id="5db7f-138">Мы начали с изучения того, как клиенты-фронтовые компании общаются с бэк-энд-микрослужбами.</span><span class="sxs-lookup"><span data-stu-id="5db7f-138">We started by examining how front-end clients communicate with back-end microservices.</span></span> <span data-ttu-id="5db7f-139">По пути мы говорили о платформах API Gateway и коммуникации в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="5db7f-139">Along the way, we talked about API Gateway platforms and real-time communication.</span></span> <span data-ttu-id="5db7f-140">Затем мы рассмотрели, как микрослужбы взаимодействуют с другими бэк-энд-сервисами.</span><span class="sxs-lookup"><span data-stu-id="5db7f-140">We then looked at how microservices communicate with other back-end services.</span></span> <span data-ttu-id="5db7f-141">Мы рассмотрели как синхронную коммуникацию HTTP, так и асинхронные сообщения между службами.</span><span class="sxs-lookup"><span data-stu-id="5db7f-141">We looked at both synchronous HTTP communication and asynchronous messaging across services.</span></span> <span data-ttu-id="5db7f-142">Мы рассмотрели gRPC, предстоящую технологию в облачном мире.</span><span class="sxs-lookup"><span data-stu-id="5db7f-142">We covered gRPC, an upcoming technology in the cloud-native world.</span></span> <span data-ttu-id="5db7f-143">Наконец, мы представили новую и быстро развивающуюся технологию под названием Service Mesh, которая может упорядочить связь микрослужб.</span><span class="sxs-lookup"><span data-stu-id="5db7f-143">Finally, we introduced a new and rapidly evolving technology entitled Service Mesh that can streamline microservice communication.</span></span>

<span data-ttu-id="5db7f-144">Особое внимание было уделено управляемым службам Azure, которые могут помочь внедрить коммуникации в облачных системах:</span><span class="sxs-lookup"><span data-stu-id="5db7f-144">Special emphasis was on managed Azure services that can help implement communication in cloud-native systems:</span></span>

- [<span data-ttu-id="5db7f-145">Шлюз приложений Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-145">Azure Application Gateway</span></span>](https://docs.microsoft.com/azure/application-gateway/overview)
- [<span data-ttu-id="5db7f-146">Управление API Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-146">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="5db7f-147">Служба SignalR Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-147">Azure SignalR Service</span></span>](https://azure.microsoft.com/services/signalr-service/)
- [<span data-ttu-id="5db7f-148">Очереди службы хранилища Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-148">Azure Storage Queues</span></span>](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction)
- [<span data-ttu-id="5db7f-149">Служебная шина Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-149">Azure Service Bus</span></span>](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview)
- [<span data-ttu-id="5db7f-150">Сетка событий Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-150">Azure Event Grid</span></span>](https://docs.microsoft.com/azure/event-grid/overview)
- [<span data-ttu-id="5db7f-151">Концентратор событий Azure</span><span class="sxs-lookup"><span data-stu-id="5db7f-151">Azure Event Hub</span></span>](https://azure.microsoft.com/services/event-hubs/)

<span data-ttu-id="5db7f-152">Далее мы перейдем к распределенным данным в облачных системах, а также к преимуществам и проблемам, которые они представляют.</span><span class="sxs-lookup"><span data-stu-id="5db7f-152">We next move to distributed data in cloud-native systems and the benefits and challenges that it presents.</span></span>

### <a name="references"></a><span data-ttu-id="5db7f-153">Ссылки</span><span class="sxs-lookup"><span data-stu-id="5db7f-153">References</span></span>

- [<span data-ttu-id="5db7f-154">Microservices .NET: Архитектура для контейнерных приложений .NET</span><span class="sxs-lookup"><span data-stu-id="5db7f-154">.NET Microservices: Architecture for Containerized .NET applications</span></span>](https://dotnet.microsoft.com/download/thank-you/microservices-architecture-ebook)

- [<span data-ttu-id="5db7f-155">Проектирование Межсервисной коммуникации для микросервисов</span><span class="sxs-lookup"><span data-stu-id="5db7f-155">Designing Interservice Communication for Microservices</span></span>](https://docs.microsoft.com/azure/architecture/microservices/design/interservice-communication)

- [<span data-ttu-id="5db7f-156">Служба Azure SignalR, полностью управляемая служба для добавления функциональности в режиме реального времени</span><span class="sxs-lookup"><span data-stu-id="5db7f-156">Azure SignalR Service, a fully managed service to add real-time functionality</span></span>](https://azure.microsoft.com/blog/azure-signalr-service-a-fully-managed-service-to-add-real-time-functionality/)

- [<span data-ttu-id="5db7f-157">Контроллер входа в шлюз Azure API</span><span class="sxs-lookup"><span data-stu-id="5db7f-157">Azure API Gateway Ingress Controller</span></span>](https://azure.github.io/application-gateway-kubernetes-ingress/)

- [<span data-ttu-id="5db7f-158">О поступлениях в azure Kubernetes Service (AKS)</span><span class="sxs-lookup"><span data-stu-id="5db7f-158">About Ingress in Azure Kubernetes Service (AKS)</span></span>](https://vincentlauzon.com/2018/10/10/about-ingress-in-azure-kubernetes-service-aks/)

- [<span data-ttu-id="5db7f-159">gRPC Документация</span><span class="sxs-lookup"><span data-stu-id="5db7f-159">gRPC Documentation</span></span>](https://grpc.io/docs/guides/)

- [<span data-ttu-id="5db7f-160">gRPC для разработчиков WCF</span><span class="sxs-lookup"><span data-stu-id="5db7f-160">gRPC for WCF Developers</span></span>](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/)

- [<span data-ttu-id="5db7f-161">Сравнение услуг gRPC с HTTP AIS</span><span class="sxs-lookup"><span data-stu-id="5db7f-161">Comparing gRPC Services with HTTP APIs</span></span>](https://docs.microsoft.com/aspnet/core/grpc/comparison?view=aspnetcore-3.0)

- [<span data-ttu-id="5db7f-162">Создание gRPC Услуг с помощью видео .NET</span><span class="sxs-lookup"><span data-stu-id="5db7f-162">Building gRPC Services with .NET video</span></span>](https://channel9.msdn.com/Shows/The-Cloud-Native-Show/Building-Microservices-with-gRPC-and-NET)

>[!div class="step-by-step"]
><span data-ttu-id="5db7f-163">[Предыдущий](grpc.md)
>[Следующий](Database-per-microservice.md)</span><span class="sxs-lookup"><span data-stu-id="5db7f-163">[Previous](grpc.md)
[Next](Database-per-microservice.md)</span></span>
