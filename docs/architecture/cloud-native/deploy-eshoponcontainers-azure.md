---
title: Развертывание eShopOnContainers в Azure
description: Развертывание приложения eShopOnContainers с помощью службы Kubernetes Azure, Helm и Девспацес.
ms.date: 06/30/2019
ms.openlocfilehash: 21033cc904dc595193c69f3452ce2522740f8ff6
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2019
ms.locfileid: "73840493"
---
# <a name="deploying-eshoponcontainers-to-azure"></a>Развертывание eShopOnContainers в Azure

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

Логика, поддерживающая приложение eShopOnContainers, может поддерживаться в Azure с помощью различных служб. Рекомендуется использовать Kubernetes с помощью службы Kubernetes Azure (AKS). Это можно сочетать с развертыванием Helm, чтобы обеспечить легко повторяемую конфигурацию инфраструктуры. При необходимости разработчики могут использовать Azure Dev Spaces для Kubernetes в рамках процесса разработки. Другим вариантом является размещение функциональных возможностей приложения с помощью бессерверных функций Azure, таких как функции Azure и Azure Logic Apps.

## <a name="azure-kubernetes-service"></a>Служба контейнеров Azure

Если вы хотите разместить приложение eShopOnContainers в собственном кластере AKS, сначала необходимо создать кластер. Это можно сделать с помощью портал Azure, который поможет выполнить необходимые действия. также можно использовать Azure CLI, чтобы обеспечить возможность управления доступом на основе ролей (RBAC) и маршрутизацию приложений. В документации по eShopOnContainers описаны шаги, связанные с созданием собственного кластера AKS. После создания кластера необходимо включить доступ к панели мониторинга Kubernetes, после чего вы сможете перейти на панель мониторинга Kubernetes для управления кластером.

После создания и настройки кластера можно развернуть приложение на нем с помощью Helm и.

## <a name="deploying-to-azure-kubernetes-service-using-helm"></a>Развертывание в службе Azure Kubernetes с помощью Helm

Основные развертывания в AKS могут использовать пользовательские сценарии CLI или простые файлы развертывания, но более сложные приложения должны использовать средство управления зависимостями, например Helm. Helm поддерживается облачной вычислительной средой и помогает определять, устанавливать и обновлять приложения Kubernetes. Helm состоит из клиента командной строки Helm, который использует диаграммы Helm и компонент в составе кластера. Helm диаграммы используют стандартные файлы YAML для описания связанного набора ресурсов Kubernetes и, как правило, являются версиями вместе с приложением, которое они описывают. Helm диаграммы находятся в диапазоне от простых до сложных в зависимости от требований установки, которые они описывают.

Диаграммы eShopOnContainers Helm находятся в папке/K8S/Helm. На рис. 2-6 показано, как различные компоненты приложения организованы в структуру папок, используемую Helm для определения и управления развертываниями.

![архитектура eShopOnContainers](./media/eshoponcontainers-helm-folder.png)
**рис. 2-6**. Папка eShopOnContainers Helm.

Каждый отдельный компонент устанавливается с помощью команды `helm install`. Эти команды легко создать в скриптах, а eShopOnContainers предоставляет сценарий "развернуть все", который выполняет перебор различных компонентов и устанавливает их с помощью соответствующих диаграмм Helm. Результатом является повторяемый процесс, имеющий версию приложения в системе управления версиями, который любой участник группы может развернуть в кластере AKS с помощью однострочной команды сценария. Это позволяет разработчикам легко диагностировать и тестировать отдельные изменения в собственных облачных приложениях на основе микрослужб. Azure Dev Spaces

## <a name="azure-dev-spaces"></a>Azure Dev Spaces

Azure Dev Spaces помогает отдельным разработчикам размещать собственные уникальные версии кластеров AKS в Azure во время разработки. Это снизит требования к локальному компьютеру и позволит участникам группы быстро увидеть, как их изменения будут вести себя в реальной среде AKS. Azure Dev Spaces предлагает разработчикам интерфейс командной строки, который используется для управления пространствами разработки и для развертывания в определенном дочернем пространстве разработки по мере необходимости. На каждое дочернее пространство разработки ссылается с помощью уникального поддомена URL-адресов, что позволяет разработчикам параллельно развертывать измененные кластеры, чтобы отдельные разработчики могли избежать конфликтов между работой, выполняемой друг с другом. На рис. 2-7 можно увидеть, как разработчик Лилия развернул собственную версию микрослужбы велосипедов в своем пространстве разработки. Затем она может проверить свои изменения с помощью настраиваемого URL-адреса, начинающегося с имени своего пространства (susie.s.dev.myapp.eus.azds.io).

![архитектура eShopOnContainers](./media/azure-devspaces-one.png)
**рис. 2-7**. Разработчик Лилия развертывает собственную версию микрослужбы велосипедов и тестирует ее.

В то же время разработчик Джон настраивает микрослужбу резервирования и должен протестировать свои изменения. Он может развернуть свои изменения в своем собственном пространстве разработки без конфликта с изменениями Лилия, как показано на рис. 2-8. Он может проверить свои изменения с помощью собственного URL-адреса, который имеет префикс с именем своего пространства (john.s.dev.myapp.eus.azds.io).

![архитектура eShopOnContainers](./media/azure-devspaces-two.png)
**рис. 2-8**. Разработчик Джон развертывает собственную версию микрослужбы резервирования и тестирует ее без конфликтов с другими разработчиками.

С помощью Azure Dev Spaces команды могут работать непосредственно с AKS, одновременно изменяя, развертывая и тестируя свои изменения. Такой подход сокращает потребность в отдельных выделенных средах размещения, так как каждый разработчик эффективно имеет собственную среду AKS. Разработчики могут работать с Azure Dev Spaces с помощью интерфейса командной строки или запускать свое приложение для Azure Dev Spaces непосредственно из Visual Studio. [Узнайте больше о том, как Azure Dev Spaces работает и настроена.](https://docs.microsoft.com/azure/dev-spaces/how-dev-spaces-works)

## <a name="azure-functions-and-logic-apps-serverless"></a>Функции и Logic Apps Azure (бессерверные)

Образец eShopOnContainers включает поддержку отслеживания маркетинговых кампаний. Функция Azure используется для извлечения сведений о маркетинговой кампании для заданного идентификатора кампании. Вместо создания полного ASP.NET Core приложения для этой цели будет проще и достаточно одной конечной точки функции Azure. Функции Azure имеют гораздо более простую модель сборки и развертывания, чем полные ASP.NET Core приложения, особенно при настройке для работы в Kubernetes. Развертывание функции в скрипте осуществляется с помощью шаблонов Azure Resource Manager (ARM) и Azure CLI. Эта кампания содержит сведения о том, что микрослужба не подходит для клиентов и не имеет тех же требований, что и Интернет-магазин, что делает его хорошим кандидатом для функций Azure. Для правильной работы функции требуется определенная конфигурация, например данные строки подключения к базе данных и параметры базового URI изображения. Вы настраиваете функции Azure на портале Azure.

## <a name="references"></a>Ссылки

- [eShopOnContainers: Создание кластера Kubernetes в AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)
- [eShopOnContainers: Azure Dev Spaces](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Azure-Dev-Spaces)
- [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/about)

>[!div class="step-by-step"]
>[Назад](map-eshoponcontainers-azure-services.md)
>[Вперед](centralized-configuration.md)
