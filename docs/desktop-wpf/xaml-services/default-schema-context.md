---
title: Контекст схемы языка XAML по умолчанию и контекст схемы языка XAML WPF
ms.date: 03/30/2017
ms.assetid: 04e06a15-09b3-4210-9bdf-9a64c2eccb83
ms.openlocfilehash: 2e92372de61230a98a02282cc28fc3f479cd94eb
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "81433082"
---
# <a name="default-xaml-schema-context-and-wpf-xaml-schema-context"></a>Контекст схемы языка XAML по умолчанию и контекст схемы языка XAML WPF
Контекст схемы XAML — это концептуальная сущность, которая квалифицирует то, как производство XAML, использующего определенный словарь XAML, взаимодействует с поведением написания объектов, включая то, как разрешится отображение шрифтов, как загружаются сборки, как интерпретируются определенные настройки чтения и записи. В этой теме описаны особенности службы .NET XAML и связанный с ним контекст схемы XAML по умолчанию, основанный на системе типа CLR. В этой теме также описывается контекст схемы XAML, который используется для WPF.

## <a name="default-xaml-schema-context"></a>Контекст схемы XAML по умолчанию

.NET XAML Services реализует и использует контекст схемы XAML по умолчанию. Поведение контекста схемы XAML по умолчанию не всегда <xref:System.Xaml.XamlSchemaContext> полностью отображается в API класса. Однако во многих случаях поведение, на которое влияет контекст схемы XAML по умолчанию, можно наблюдать через <xref:System.Xaml.XamlMember> <xref:System.Xaml.XamlType>общий API системы типа XAML, например, членов или aPI, разоблочаемых на считывателях XAML и авторах XAML, использующих контекст схемы XAML по умолчанию.

Можно <xref:System.Xaml.XamlSchemaContext> создать, который инкапсулирует поведение по умолчанию, вызывая <xref:System.Xaml.XamlSchemaContext> конструктор. Это явно создает контекст схемы XAML по умолчанию. Тот же контекст схемы XAML по умолчанию создается неявно, если вы инициализируете считыватель XAML или xAML writer с помощью AIS, которые явно не принимают параметр <xref:System.Xaml.XamlSchemaContext> ввода.

Контекст схемы XAML по умолчанию опирается на отражение CLR для своего поведения отображения типов. Это включает в себя <xref:System.Type>изучение <xref:System.Reflection.PropertyInfo> определения <xref:System.Reflection.MethodInfo>CLR , и связанных или . Кроме того, атрибуция CLR на типы или члены используется для заполнения специфики для типа XAML или информации о членах XAML, которая использует тип поддержки CLR. Контекст схемы XAML по умолчанию не требует методов расширения системы типов, таких как `Invoker` шаблон, поскольку необходимая информация доступна из системы типа CLR.

Для логики загрузки сборки контекст схемы XAML по умолчанию основывается главным образом на любых значениях сборки, предусмотренных в отображении пространства имен XAML. Кроме <xref:System.Xaml.XamlReaderSettings.LocalAssembly%2A> того, можно намекнуть на сборку для загрузки, для сценариев, таких как загрузка внутренних типов.

## <a name="wpf-xaml-schema-context"></a>WPF XAML Схема Контекст

Контекст схемы WPF XAML описан в этой теме, поскольку реализация WPF представляет интересную иллюстрацию видов функций, которые могут быть введены путем внедрения контекста схемы XAML по умолчанию. Кроме того, концепция контекста схемы XAML не очень подробно обсуждается в документации WPF, которая касается WPF XAML; поведение, которое позволяет контекст схемы XAML, может быть полностью понятнее только в том случае, если оно интегрировано с обсуждением того, как работает контекст схемы XAML по умолчанию. Контекст схемы WPF XAML реализует следующее поведение.

**Осматриваемый переопределяет:** WPF имеет несколько моделей содержимого для XAML, где <xref:System.Windows.Markup.ContentPropertyAttribute> есть свойства содержимого XAML, которые функционируют без отнесенных. <xref:System.Xaml.XamlType.LookupContentProperty%2A>переопределения для WPF реализовать это поведение.

**Отсрочка для выражений WPF:** WPF имеет несколько классов выражений, которые откладывают значение до тех пор, пока не доступен контекст времени выполнения. Кроме того, расширение шаблона — это поведение в срок выполнения, которое опирается на методы отсрочки.

**Оптимизация поиска системы типа:** WPF имеет обширную словарную лексику XAML и объектную модель, включая определения членов базового класса, которые наследуют буквально сотни классов, определяемых WPF. Кроме того, сам WPF распространяется на несколько собраний. WPF оптимизирует поиск типа, используя таблицы поиска и другие методы. Это обеспечивает улучшение производительности по сравнению с контекстом схемы XAML по умолчанию и его поиском типа на основе CLR. В тех случаях, когда типы не существуют в таблице поиска, поведение использует методы контекста схемы XAML, похожие на контекст схемы XAML по умолчанию.

**Расширение XamlType и XamlMember:** WPF расширяет концепции свойств с свойствами зависимости и понятиями событий с маршрутными событиями. Чтобы придать этим концепциям большую видимость для операций обработки XAML, WPF расширяет <xref:System.Xaml.XamlType> и <xref:System.Xaml.XamlMember>добавляет внутренние свойства, которые сообщают свойство зависимости и маршрутные характеристики событий.

### <a name="accessing-the-wpf-xaml-schema-context"></a>Доступ к контексту схемы WPF XAML

Если вы используете методы XAML, <xref:System.Windows.Markup.XamlReader?displayProperty=nameWithType> основанные на WPF или, <xref:System.Windows.Markup.XamlWriter?displayProperty=nameWithType>контекст схемы WPF XAML уже используется на тех реализациях XAML reader и XAML..

Если вы используете другие реализации XAML reader или XAML writer, которые не инициализируются с контекстом схемы WPF XAML, вы можете получить рабочий контекст схемы WPF XAML от <xref:System.Windows.Markup.XamlReader.GetWpfSchemaContext%2A?displayProperty=nameWithType>. Затем это значение можно использовать в качестве инициализации для другого API, использующему <xref:System.Xaml.XamlSchemaContext>a. Например, можно <xref:System.Xaml.XamlXmlReader.%23ctor%2A> позвонить для инициализации и пройти контекст схемы WPF XAML. Или можно использовать контекст схемы WPF XAML для операций системы типа XAML. Это может включать в <xref:System.Xaml.XamlType> себя <xref:System.Xaml.XamlMember>строительство <xref:System.Xaml.XamlSchemaContext.GetXamlType%2A?displayProperty=nameWithType>инициализации или , или вызова .

Обратите внимание, что если вы получаете доступ к некоторым аспектам WPF XAML с точки зрения чистого потока узлов XAML, некоторые возможности платформы WPF, возможно, еще не действовали. Например, шаблоны WPF для элементов управления еще не применяются. Таким образом, если вы получаете доступ к свойству, которое во время выполнения может быть заселено полным визуальным деревом, можно увидеть только значение свойства, которое ссылается на шаблон. Контекст службы, предусмотренный для расширений разметки WPF, также может быть неточным, если он предоставляется из ситуации, не работающей, и может привести к исключениям при попытке написать график объекта.

## <a name="xaml-and-assembly-loading"></a>XAML и сборка загрузки

Загрузка сборки для XAML и .NET XAML Services <xref:System.AppDomain>интегрируется с концепцией CLR, определяемой . Контекст схемы XAML интерпретирует, как загрузить сборки или найти типы во время <xref:System.AppDomain> выполнения или время проектирования, основываясь на использовании и других факторах. Логика немного отличается в зависимости от того, XAML является свободным XAML для считывателя XAML, является XAML, составленный в DLL, `XamlBuildTask`или BAML генерируется `PresentationBuildTask`WPF.

Контекст схемы XAML для WPF интегрируется с моделью применения <xref:System.AppDomain> WPF, которая, в свою очередь, использует, а также другие факторы, которые являются деталями реализации WPF.

#### <a name="xaml-reader-input-loose-xaml"></a>Ввод чтения XAML (свободный XAML)

01. Контекст схемы XAML итерируется <xref:System.AppDomain> через приложение, ища уже загруженную сборку, которая соответствует всем аспектам имени, начиная с самой недавно загруженной сборки. При обнаружении совпадения эта сборка используется для разрешения.

02. В противном случае, один из <xref:System.Reflection.Assembly> следующих методов, основанных на CLR API, используется для загрузки сборки:

    - Если имя квалифицировано в отображении, позвоните <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType> по квалифицированной фамилии.

    - Если предыдущий шаг не удается, используйте короткое имя <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType>(и маркер клавиши общего пользования, если он присутствует), чтобы вызвать .

    - Если имя неквалифицировано в отображении, позвоните <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType>.

#### <a name="xamlbuildtask"></a>XamlBuildTask

`XamlBuildTask`используется для Фонда связи Windows (WCF) и Фонда рабочего процесса Windows.

Обратите внимание, что `XamlBuildTask` ссылки на сборку всегда полностью квалифицированы.

1. Позвоните <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType> по квалифицированной фамилии.

2. Если предыдущий шаг не удается, используйте короткое имя <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType>(и маркер клавиши общего пользования, если он присутствует), чтобы вызвать .

#### <a name="baml-presentationbuildtask"></a>БАМЛ (ПрезентацияBuildTask)

Сборка ДЛЯ BAML состоит из двух аспектов: загрузка начальной сборки, содержащей BAML в качестве компонента, и загрузка сборки для поддержки типов для любых типов, на которые ссылается производство BAML.

##### <a name="assembly-load-for-initial-markup"></a>Сборочная нагрузка для первоначальной разметки:

Ссылка на сборку для загрузки разметки всегда неквалифицирована.

1. Контекст схемы WPF XAML итерируется через <xref:System.AppDomain> приложение WPF, ища уже загруженную сборку, которая соответствует всем аспектам имени, начиная с самой недавно загруженной сборки. При обнаружении совпадения эта сборка используется для разрешения.

2. Если предыдущий шаг не удается, используйте короткое имя <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType>(и маркер клавиши общего пользования, если он присутствует), чтобы вызвать .

##### <a name="assembly-references-by-baml-types"></a>Ссылки на сборку по типам BAML:

Ссылки на сборку типов, используемых в производстве BAML, всегда полностью квалифицированы, как выход задачи сборки.

01. Контекст схемы WPF XAML итерируется через <xref:System.AppDomain> приложение WPF, ища уже загруженную сборку, которая соответствует всем аспектам имени, начиная с самой недавно загруженной сборки. При обнаружении совпадения эта сборка используется для разрешения.

02. В противном случае для загрузки сборки используется один из следующих методов:

    - Позвоните <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType> по квалифицированной фамилии.
  
    - Если короткое имя и комбинация маркеров общего ключа совпадают с сборкой, из которую был загружен BAML, используйте эту сборку.

    - Используйте короткое имя и <xref:System.Reflection.Assembly.Load%28System.String%29?displayProperty=nameWithType>открытый маркер ключа для вызова.

## <a name="see-also"></a>См. также

- [Общее представление о понятиях и структурах потока узлов XAML](understanding-xaml-node-stream-structures-and-concepts.md)
