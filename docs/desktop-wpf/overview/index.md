---
title: Что такое Windows Presentation Foundation
description: В этой статье приводятся общие сведения о платформе Windows Presentation Foundation (WPF) в контексте ее применения вместе с .NET Core и предоставляемых функций.
ms.date: 07/18/2019
ms.topic: overview
ms.openlocfilehash: 37443b692ba840da847b2a21c3220f2c36025c12
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/15/2020
ms.locfileid: "90551866"
---
# <a name="what-is-windows-presentation-foundation"></a>Что такое Windows Presentation Foundation

Добро пожаловать в руководство по классическим приложениям для Windows Presentation Foundation (WPF), платформы пользовательского интерфейса для создания клиентских приложений для настольных систем под управлением Windows. Платформа разработки WPF поддерживает широкий набор компонентов для разработки приложений, включая модель приложения, элементы управления, графику и привязку данных. WPF использует расширяемый язык разметки для приложений (XAML), чтобы предоставить декларативную модель для программирования приложений.

[!INCLUDE [desktop guide under construction](../../../includes/desktop-guide-preview-note.md)]

Существует две реализации WPF:

01. Реализация с открытым исходным кодом, размещенная на [GitHub](https://github.com/dotnet/wpf). Эта версия работает на платформе .NET Core 3.0. Для работы визуального конструктора WPF для XAML требуется [версия Visual Studio 2019 не ниже 16.3](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019+desktopguide).

01. Реализация .NET Framework, поддерживаемая в Visual Studio 2019 и Visual Studio 2017.

Это руководство по классическим приложениям ориентировано на .NET Core 3.0 и WPF. Дополнительные сведения о доступной документации по .NET Framework см. в статье [Платформа Windows Presentation Foundation](/dotnet/desktop/wpf/).

## <a name="xaml"></a>XAML

XAML — это декларативный язык на основе XML, который используется на платформе WPF для определения ресурсов или элементов пользовательского интерфейса, а также решения других задач. Определяемые в XAML элементы представляют создание экземпляров объектов из сборки. В этом заключается отличие XAML от большинства других языков разметки, которые представляют собой интерпретируемые во время выполнения языки без прямой связи с резервной системой типов.

В следующем примере показано, как можно создать кнопку как часть пользовательского интерфейса. На этом примере демонстрируется принцип представления объекта в XAML. Здесь `Button` — это тип, а `Content` — свойство.

```xaml
<StackPanel>
    <Button Content="Click Me!" />
</StackPanel>
```

<!--For more information, see [XAML overview (WPF)](../../../framework/wpf/advanced/xaml-overview-wpf.md).-->

### <a name="xaml-extensions"></a>Расширения XAML

XAML поддерживает синтаксис для расширений разметки. Расширения разметки можно использовать для предоставления значений свойств в форме атрибутов, элементов свойств или обоими способами.

Например, в приведенном выше коде XAML определяется кнопка, для которой в качестве отображаемого содержимого используется строка символов `"Click Me!"`. При этом вместо нее может использоваться расширение разметки. Расширение разметки определяется с помощью открывающих и закрывающих фигурных скобок `{ }`. Затем тип расширения разметки определяется по токену строки, следующему сразу после открывающей фигурной скобки.

```xaml
<StackPanel>
    <Button Content="{MarkupType}" />
</StackPanel>
```

В WPF поддерживаются разные расширения разметки для XAML, например `{Binding}` для привязки данных.

Дополнительные сведения см. в разделе [Расширения разметки и XAML WPF](/dotnet/desktop/wpf/advanced/markup-extensions-and-wpf-xaml).

## <a name="property-system"></a>Система свойств

WPF предоставляет набор служб, которые можно использовать для расширения функциональных возможностей [свойства](../../standard/base-types/common-type-system.md#properties) типа. В совокупности эти службы называются *системой свойств WPF*. Свойство, поддерживаемое системой свойств WPF, называется свойством зависимостей.

Свойства зависимостей дополняют функциональные возможности свойства, предоставляя тип <xref:System.Windows.DependencyProperty> для реализации поддержки свойства. Тип свойства зависимостей является альтернативной реализацией стандартного шаблона для резервирования свойства с закрытым полем.

### <a name="dependency-property"></a>Свойство зависимостей

В WPF свойства зависимостей обычно представляются как стандартные [свойства](../../standard/base-types/common-type-system.md#properties) .NET. На базовом уровне можно взаимодействовать с этими свойствами непосредственно и не знать, что они реализуются как свойства зависимостей.

Свойства зависимостей предназначены для предоставления способа вычисления значения свойства по значениям других входных данных. Такие входные данные могут включать в себя системные свойства, такие как темы и предпочтения пользователя, а также JIT-свойства из привязок данных и анимаций.

Свойство зависимостей может быть реализовано для проверки, определения значений по умолчанию и выполнения обратных вызовов, которые позволяют отслеживать изменения в других свойствах. Производные классы также могут изменять некоторые специфические характеристики существующего свойства путем переопределения метаданных свойства зависимостей вместо того, чтобы создавать новые или переопределять существующие свойства.

### <a name="dependency-object"></a>Объект зависимости

Еще одним важным элементом системы свойств WPF является <xref:System.Windows.DependencyObject>. Этот тип определяет базовый класс для регистрации свойства зависимостей и использования в качестве его владельца. Методы <xref:System.Windows.DependencyObject.GetValue%2A> и <xref:System.Windows.DependencyObject.SetValue%2A> обеспечивают реализацию резервирования свойства зависимостей для экземпляра объекта зависимости.

В следующем примере показан объект зависимости, который определяет один идентификатор свойства зависимости с именем `ValueProperty`. Свойство зависимостей создается с использованием свойства .NET `Value`.

```csharp
public class TextField: DependencyObject
{
    public static readonly DependencyProperty ValueProperty =
        DependencyProperty.Register("Value", typeof(string), typeof(TextField), new PropertyMetadata(""));

    public string Value
    {
        get { return (string)GetValue(ValueProperty); }
        set { SetValue(ValueProperty, value); }
    }
}
```

Свойство зависимостей определяется как статический член типа объекта зависимости, как `TextField` в приведенном выше примере. Свойство зависимостей должно быть зарегистрировано в объекте зависимости.

В приведенном выше примере свойство `Value` заключает в оболочку свойство зависимостей, предоставляя стандартный шаблон свойства .NET, который вы наверняка уже использовали.

<!--For more information, see [Dependency properties overview](../../../framework/wpf/advanced/dependency-properties-overview.md).-->

## <a name="events"></a>События

WPF предоставляет систему событий, размещаемую поверх событий среды CLR .NET, с которыми вы уже знакомы. Такие события WPF называются перенаправленными событиями.

Перенаправленное событие — это событие CLR, поддерживаемое экземпляром класса `RoutedEvent` и регистрируемое в системе событий WPF. Экземпляр `RoutedEvent`, полученный из регистрации события, обычно сохраняется в качестве поля `public static readonly` класса, который регистрирует перенаправленное событие и, таким образом, *владеет* им. Соединение с событием CLR с таким же именем (которое иногда называется событием *программы-оболочки*) выполняется путем переопределения реализаций `add` и `remove` для события CLR. Концептуально механизм подключения и резервирования перенаправленного события похож на то, как [свойство зависимостей](#dependency-property) является свойством CLR, которое резервируется классом `DependencyProperty` и регистрируется в системе свойств WPF.

Основное преимущество системы перенаправленных событий заключается в том, что события *поднимаются* по дереву элементов элемента управления в поисках обработчика. Например, поскольку в WPF реализована обширная модель управления содержимым, вы можете задать элемент управления "Изображение" в качестве содержимого элемента управления "Кнопка". При щелчке кнопки мыши на элементе управления "Изображение" вы предполагаете, что будут использоваться события мыши, в результате чего срабатывает проверка попаданий и вызывается событие `Click` кнопки. В традиционной модели событий CLR это ограничение можно обойти, присоединив один и тот же обработчик к изображению и кнопке. Однако в системе перенаправленных событий события мыши, вызываемые для элемента управления "Изображение" (например, при выборе изображения), поднимаются по дереву до родительского элемента управления "Кнопка".

<!--For more information, including other types of event models, see [Events overview](../../../framework/wpf/advanced/routed-events-overview.md).-->

## <a name="data-binding"></a>привязка данных,

Привязка данных WPF предоставляет приложениям простой и последовательный способ представления данных и взаимодействия с ними. Элемент можно привязывать к данным из источников самого разного типа в форме объектов CLR и XML. WPF также предоставляет механизм передачи данных с помощью операций перетаскивания.

Привязка данных — это процесс установления соединения между пользовательским интерфейсом приложения и бизнес-логикой. Если для привязки заданы правильные настройки, а изменения значений данных сопровождаются правильными уведомлениями, привязанные к данным элементы автоматически отражают изменения. Привязка данных может также означать, что если внешнее представление данных в элементе изменяется, то базовые данные могут автоматически обновляться для отражения изменений. Например, если пользователь изменяет значение в элементе TextBox, базовое значение данных автоматически обновляется, чтобы отразить это изменение.

Привязку данных можно настроить в XAML с помощью расширения разметки `{Binding}`. В следующем примере показана привязка к свойству `ButtonText` объекта данных. В случае сбоя привязки используется значение `Click Me!`.

```xaml
<StackPanel>
    <Button Content="{Binding ButtonText, FallbackValue='Click Me!'}" />
</StackPanel>
```

Более подробную информацию см. в разделе [Общие сведения о привязке данных](../data/data-binding-overview.md).

## <a name="ui-components"></a>Компоненты пользовательского интерфейса

WPF содержит большинство распространенных компонентов пользовательского интерфейса, которые используются практически во всех Windows-приложениях, например `Button`, `Label`, `TextBox`, `Menu` и `ListBox`. Исторически эти объекты называются элементами управления. Хотя в пакете SDK для WPF по-прежнему используется термин "элемент управления" для обобщенного обозначения любого класса, который представляет видимый объект в приложении, важно отметить, что класс с визуальным представлением не обязательно должен наследовать от класса `Control`. Классы, наследуемые от класса `Control`, содержат шаблон `ControlTemplate`, который позволяет существенно изменить внешний вид элемента управления, не создавая новый подкласс.

## <a name="styles-and-templates"></a>Стили и шаблоны

Стилизация и использование шаблонов WPF относятся к набору возможностей (стили, шаблоны, триггеры и раскадровки), которые позволяют разработчикам приложений, документации или пользовательского интерфейса создавать визуально привлекательные приложения, а также определять стандартизированный внешний вид своих продуктов.

Еще одна особенность модели стилизации WPF заключается в разделении представления и логики. Это означает, что дизайнеры могут работать над внешним видом приложения с использованием XAML, тогда как разработчики могут определять логику программирования другим способом.

Также важно иметь представление о ресурсах, которые позволяют повторно использовать стили и шаблоны.

Дополнительные сведения см. в разделе [Стили и шаблоны](../fundamentals/styles-templates-overview.md).

## <a name="resources"></a>Ресурсы

Ресурс WPF — это объект, который можно повторно использовать в разных местах приложения. В качестве примеров ресурсов можно привести стили, шаблоны и цветные кисти. Определять ресурсы и задавать ссылки на них можно как в коде, так и в формате XAML.

Каждый элемент уровня платформы (<xref:System.Windows.FrameworkElement> или <xref:System.Windows.FrameworkContentElement>) имеет свойство `Resources`, которое представляет собой тип <xref:System.Windows.ResourceDictionary>, содержащий определенные ресурсы. Поскольку все элементы наследуются от элемента уровня платформы, для определения ресурсов можно использовать любые элементы. Тем не менее, чаще всего ресурсы определяются в корневом элементе документа XAML.

<!--For more information, see [XAML Resources](../../../framework/wpf/advanced/xaml-resources.md).-->

## <a name="next-steps"></a>Следующие шаги

- [Создание приложения WPF.](/visualstudio/get-started/csharp/tutorial-wpf?bc=%252fdotnet%252fbreadcrumb%252ftoc.json&toc=%252fdotnet%252fdesktop-wpf%252ftoc.json)
- [Отличия от платформы .NET Framework.](../migration/differences-from-net-framework.md)
- [Дополнительные сведения о XAML.](../fundamentals/xaml.md)
