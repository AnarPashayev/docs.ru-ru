---
title: Анализ кода в .NET
titleSuffix: ''
description: Сведения об анализе исходного кода в пакете SDK для .NET.
ms.date: 12/04/2020
ms.topic: overview
ms.custom: updateeachrelease
helpviewer_keywords:
- code analysis
- code analyzers
ms.openlocfilehash: 2f59b97de6f92e5a9bf927e1318286e400017dad
ms.sourcegitcommit: 81f1bba2c97a67b5ca76bcc57b37333ffca60c7b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "97009850"
---
# <a name="overview-of-net-source-code-analysis"></a><span data-ttu-id="46a81-103">Обзор анализа исходного кода .NET</span><span class="sxs-lookup"><span data-stu-id="46a81-103">Overview of .NET source code analysis</span></span>

<span data-ttu-id="46a81-104">Анализаторы .NET Compiler Platform (Roslyn) проверяют качество кода C# или Visual Basic и выявляют в нем проблемы.</span><span class="sxs-lookup"><span data-stu-id="46a81-104">.NET compiler platform (Roslyn) analyzers inspect your C# or Visual Basic code for code quality and code style issues.</span></span> <span data-ttu-id="46a81-105">Начиная с .NET 5,0 эти анализаторы входят в состав пакета SDK для .NET, и вам не нужно устанавливать их отдельно.</span><span class="sxs-lookup"><span data-stu-id="46a81-105">Starting in .NET 5.0, these analyzers are included with the .NET SDK and you don't need to install them separately.</span></span> <span data-ttu-id="46a81-106">Если проект предназначен для .NET 5 или более поздней версии, анализ кода включен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="46a81-106">If your project targets .NET 5 or later, code analysis is enabled by default.</span></span> <span data-ttu-id="46a81-107">Если проект предназначен для другой реализации .NET, например .NET Core, .NET Standard или .NET Framework, необходимо вручную включить анализ кода, задав для свойства [енабленетанализерс](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) значение `true` .</span><span class="sxs-lookup"><span data-stu-id="46a81-107">If your project target a different .NET implementation, for example, .NET Core, .NET Standard, or .NET Framework, you must manually enable code analysis by setting the [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) property to `true`.</span></span>

<span data-ttu-id="46a81-108">Если вы не хотите переходить на пакет SDK для .NET 5 + или если предпочитаете использовать модель на основе пакетов NuGet, анализаторы также доступны в [пакете NuGet Microsoft. CodeAnalysis. нетанализерс](https://www.nuget.org/packages/Microsoft.CodeAnalysis.NetAnalyzers).</span><span class="sxs-lookup"><span data-stu-id="46a81-108">If you don't want to move to the .NET 5+ SDK or if you prefer a NuGet package-based model, the analyzers are also available in the [Microsoft.CodeAnalysis.NetAnalyzers NuGet package](https://www.nuget.org/packages/Microsoft.CodeAnalysis.NetAnalyzers).</span></span> <span data-ttu-id="46a81-109">Вы можете предпочесть модели на основе пакетов для обновления версий по требованию.</span><span class="sxs-lookup"><span data-stu-id="46a81-109">You might prefer a package-based model for on-demand version updates.</span></span>

> [!NOTE]
> <span data-ttu-id="46a81-110">Анализаторы .NET являются независимыми от целевой платформы.</span><span class="sxs-lookup"><span data-stu-id="46a81-110">.NET analyzers are target-framework agnostic.</span></span> <span data-ttu-id="46a81-111">То есть проект не обязан ориентироваться на конкретную реализацию .NET.</span><span class="sxs-lookup"><span data-stu-id="46a81-111">That is, your project does not need to target a specific .NET implementation.</span></span> <span data-ttu-id="46a81-112">Анализаторы работают для проектов, предназначенных для, а также для `net5.0` более ранних версий .NET, таких как `netcoreapp3.1` и `net472` .</span><span class="sxs-lookup"><span data-stu-id="46a81-112">The analyzers work for projects that target `net5.0` as well as earlier .NET versions, such as `netcoreapp3.1` and `net472`.</span></span>

<span data-ttu-id="46a81-113">Если анализатор обнаруживает нарушения правил, они включаются в отчет как предложение, предупреждение или ошибку в зависимости от того, как [настроено](configuration-options.md)каждое правило.</span><span class="sxs-lookup"><span data-stu-id="46a81-113">If rule violations are found by an analyzer, they're reported as a suggestion, warning, or error, depending on how each rule is [configured](configuration-options.md).</span></span> <span data-ttu-id="46a81-114">Нарушения анализа кода отображаются с префиксом "CA" или "IDE", чтобы отличать их от ошибок компилятора.</span><span class="sxs-lookup"><span data-stu-id="46a81-114">Code analysis violations appear with the prefix "CA" or "IDE" to differentiate them from compiler errors.</span></span>

## <a name="code-quality-analysis"></a><span data-ttu-id="46a81-115">Анализ качества кода</span><span class="sxs-lookup"><span data-stu-id="46a81-115">Code quality analysis</span></span>

<span data-ttu-id="46a81-116">Правила *анализа качества кода* ("какскскскс") проверяют код C# или Visual Basic для обеспечения безопасности, производительности, проектирования и других проблем.</span><span class="sxs-lookup"><span data-stu-id="46a81-116">*Code quality analysis* ("CAxxxx") rules inspect your C# or Visual Basic code for security, performance, design and other issues.</span></span> <span data-ttu-id="46a81-117">По умолчанию для проектов, предназначенных для .NET 5,0 или более поздней версии, включен анализ.</span><span class="sxs-lookup"><span data-stu-id="46a81-117">Analysis is enabled, by default, for projects that target .NET 5.0 or later.</span></span> <span data-ttu-id="46a81-118">Вы можете включить анализ кода для проектов, предназначенных для более ранних версий .NET, задав для свойства [енабленетанализерс](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) значение `true` .</span><span class="sxs-lookup"><span data-stu-id="46a81-118">You can enable code analysis on projects that target earlier .NET versions by setting the [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) property to `true`.</span></span> <span data-ttu-id="46a81-119">Можно также отключить анализ кода для проекта, задав для значение `EnableNETAnalyzers` `false` .</span><span class="sxs-lookup"><span data-stu-id="46a81-119">You can also disable code analysis for your project by setting `EnableNETAnalyzers` to `false`.</span></span>

> [!TIP]
> <span data-ttu-id="46a81-120">Если вы используете Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="46a81-120">If you're using Visual Studio:</span></span>
>
> - <span data-ttu-id="46a81-121">Многие правила анализатора связаны с *исправлениями кода* , которые можно применить для устранения проблемы.</span><span class="sxs-lookup"><span data-stu-id="46a81-121">Many analyzer rules have associated *code fixes* that you can apply to correct the problem.</span></span> <span data-ttu-id="46a81-122">Исправления кода отображаются в меню значка лампочки.</span><span class="sxs-lookup"><span data-stu-id="46a81-122">Code fixes are shown in the light bulb icon menu.</span></span>
> - <span data-ttu-id="46a81-123">Можно включить или отключить анализ кода, щелкнув правой кнопкой мыши проект в Обозреватель решений и выбрав **Свойства**  >  вкладка **анализ кода** > **включить анализаторы .NET**.</span><span class="sxs-lookup"><span data-stu-id="46a81-123">You can enable or disable code analysis by right-clicking on a project in Solution Explorer and selecting **Properties** > **Code Analysis** tab > **Enable .NET analyzers**.</span></span>

### <a name="enabled-rules"></a><span data-ttu-id="46a81-124">Включенные правила</span><span class="sxs-lookup"><span data-stu-id="46a81-124">Enabled rules</span></span>

<span data-ttu-id="46a81-125">По умолчанию в .NET 5,0 включены следующие правила.</span><span class="sxs-lookup"><span data-stu-id="46a81-125">The following rules are enabled, by default, in .NET 5.0.</span></span>

| <span data-ttu-id="46a81-126">ИД диагностики</span><span class="sxs-lookup"><span data-stu-id="46a81-126">Diagnostic ID</span></span> | <span data-ttu-id="46a81-127">Категория</span><span class="sxs-lookup"><span data-stu-id="46a81-127">Category</span></span> | <span data-ttu-id="46a81-128">Статус</span><span class="sxs-lookup"><span data-stu-id="46a81-128">Severity</span></span> | <span data-ttu-id="46a81-129">Описание</span><span class="sxs-lookup"><span data-stu-id="46a81-129">Description</span></span> |
| - | - | - | - |
| [<span data-ttu-id="46a81-130">CA1416</span><span class="sxs-lookup"><span data-stu-id="46a81-130">CA1416</span></span>](/visualstudio/code-quality/ca1416) | <span data-ttu-id="46a81-131">Совместимость</span><span class="sxs-lookup"><span data-stu-id="46a81-131">Interoperability</span></span> | <span data-ttu-id="46a81-132">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-132">Warning</span></span> | <span data-ttu-id="46a81-133">Анализатор совместимости платформ</span><span class="sxs-lookup"><span data-stu-id="46a81-133">Platform compatibility analyzer</span></span> |
| [<span data-ttu-id="46a81-134">CA1417</span><span class="sxs-lookup"><span data-stu-id="46a81-134">CA1417</span></span>](/visualstudio/code-quality/ca1417) | <span data-ttu-id="46a81-135">Совместимость</span><span class="sxs-lookup"><span data-stu-id="46a81-135">Interoperability</span></span> | <span data-ttu-id="46a81-136">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-136">Warning</span></span> | <span data-ttu-id="46a81-137">Не используйте `OutAttribute` в строковых параметрах для P/Invoke</span><span class="sxs-lookup"><span data-stu-id="46a81-137">Do not use `OutAttribute` on string parameters for P/Invokes</span></span> |
| [<span data-ttu-id="46a81-138">CA1831</span><span class="sxs-lookup"><span data-stu-id="46a81-138">CA1831</span></span>](/visualstudio/code-quality/ca1831) | <span data-ttu-id="46a81-139">Производительность</span><span class="sxs-lookup"><span data-stu-id="46a81-139">Performance</span></span> | <span data-ttu-id="46a81-140">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-140">Warning</span></span> | <span data-ttu-id="46a81-141">Используйте `AsSpan` вместо индексаторов на основе диапазона для строки, если это уместно</span><span class="sxs-lookup"><span data-stu-id="46a81-141">Use `AsSpan` instead of range-based indexers for string when appropriate</span></span> |
| [<span data-ttu-id="46a81-142">CA2013</span><span class="sxs-lookup"><span data-stu-id="46a81-142">CA2013</span></span>](/visualstudio/code-quality/ca2013) | <span data-ttu-id="46a81-143">Надежность</span><span class="sxs-lookup"><span data-stu-id="46a81-143">Reliability</span></span> | <span data-ttu-id="46a81-144">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-144">Warning</span></span> | <span data-ttu-id="46a81-145">Не используйте `ReferenceEquals` с типами значений</span><span class="sxs-lookup"><span data-stu-id="46a81-145">Do not use `ReferenceEquals` with value types</span></span> |
| [<span data-ttu-id="46a81-146">CA2014</span><span class="sxs-lookup"><span data-stu-id="46a81-146">CA2014</span></span>](/visualstudio/code-quality/ca2014) | <span data-ttu-id="46a81-147">Надежность</span><span class="sxs-lookup"><span data-stu-id="46a81-147">Reliability</span></span> | <span data-ttu-id="46a81-148">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-148">Warning</span></span> | <span data-ttu-id="46a81-149">Не используйте `stackalloc` в циклах</span><span class="sxs-lookup"><span data-stu-id="46a81-149">Do not use `stackalloc` in loops</span></span> |
| [<span data-ttu-id="46a81-150">CA2015</span><span class="sxs-lookup"><span data-stu-id="46a81-150">CA2015</span></span>](/visualstudio/code-quality/ca2015) | <span data-ttu-id="46a81-151">Надежность</span><span class="sxs-lookup"><span data-stu-id="46a81-151">Reliability</span></span> | <span data-ttu-id="46a81-152">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-152">Warning</span></span> | <span data-ttu-id="46a81-153">Не определяйте методы завершения для типов, производных от <xref:System.Buffers.MemoryManager%601></span><span class="sxs-lookup"><span data-stu-id="46a81-153">Do not define finalizers for types derived from <xref:System.Buffers.MemoryManager%601></span></span> |
| [<span data-ttu-id="46a81-154">CA2200</span><span class="sxs-lookup"><span data-stu-id="46a81-154">CA2200</span></span>](/visualstudio/code-quality/ca2200) | <span data-ttu-id="46a81-155">Использование</span><span class="sxs-lookup"><span data-stu-id="46a81-155">Usage</span></span> | <span data-ttu-id="46a81-156">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-156">Warning</span></span> | <span data-ttu-id="46a81-157">Повторно порождайте исключения для сохранения сведений стека</span><span class="sxs-lookup"><span data-stu-id="46a81-157">Rethrow to preserve stack details</span></span>
| [<span data-ttu-id="46a81-158">CA2247</span><span class="sxs-lookup"><span data-stu-id="46a81-158">CA2247</span></span>](/visualstudio/code-quality/ca2247) | <span data-ttu-id="46a81-159">Использование</span><span class="sxs-lookup"><span data-stu-id="46a81-159">Usage</span></span> | <span data-ttu-id="46a81-160">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-160">Warning</span></span> | <span data-ttu-id="46a81-161">Аргумент, переданный в конструктор TaskCompletionSource, должен быть <xref:System.Threading.Tasks.TaskCreationOptions> перечислением, а не <xref:System.Threading.Tasks.TaskContinuationOptions></span><span class="sxs-lookup"><span data-stu-id="46a81-161">Argument passed to TaskCompletionSource constructor should be <xref:System.Threading.Tasks.TaskCreationOptions> enum instead of <xref:System.Threading.Tasks.TaskContinuationOptions></span></span> |

<span data-ttu-id="46a81-162">Можно изменить серьезность этих правил, чтобы отключить их или повысить их уровень до ошибок.</span><span class="sxs-lookup"><span data-stu-id="46a81-162">You can change the severity of these rules to disable them or elevate them to errors.</span></span> <span data-ttu-id="46a81-163">Можно также [включить дополнительные правила](#enable-additional-rules).</span><span class="sxs-lookup"><span data-stu-id="46a81-163">You can also [enable more rules](#enable-additional-rules).</span></span>

- <span data-ttu-id="46a81-164">Список правил, которые входят в состав каждой версии пакета SDK для .NET, см. в разделе [выпуски анализатора](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span><span class="sxs-lookup"><span data-stu-id="46a81-164">For a list of rules that are included with each .NET SDK version, see [Analyzer releases](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span></span>
- <span data-ttu-id="46a81-165">Список всех правил качества кода см. в разделе [Правила качества кода](quality-rules/index.md).</span><span class="sxs-lookup"><span data-stu-id="46a81-165">For a list of all the code quality rules, see [Code quality rules](quality-rules/index.md).</span></span>

### <a name="enable-additional-rules"></a><span data-ttu-id="46a81-166">Включить дополнительные правила</span><span class="sxs-lookup"><span data-stu-id="46a81-166">Enable additional rules</span></span>

<span data-ttu-id="46a81-167">*Режим анализа* означает предопределенную конфигурацию анализа кода, в которой включены все правила, некоторые или все.</span><span class="sxs-lookup"><span data-stu-id="46a81-167">*Analysis mode* refers to a predefined code analysis configuration where none, some, or all rules are enabled.</span></span> <span data-ttu-id="46a81-168">В режиме анализа по умолчанию только небольшое количество правил [включается в качестве предупреждений сборки](#enabled-rules).</span><span class="sxs-lookup"><span data-stu-id="46a81-168">In the default analysis mode, only a small number of rules are [enabled as build warnings](#enabled-rules).</span></span> <span data-ttu-id="46a81-169">Можно изменить режим анализа для проекта, задав свойство [аналисисмоде](../../core/project-sdk/msbuild-props.md#analysismode) в файле проекта.</span><span class="sxs-lookup"><span data-stu-id="46a81-169">You can change the analysis mode for your project by setting the [AnalysisMode](../../core/project-sdk/msbuild-props.md#analysismode) property in the project file.</span></span> <span data-ttu-id="46a81-170">Допустимые значения:</span><span class="sxs-lookup"><span data-stu-id="46a81-170">The allowable values are:</span></span>

| <span data-ttu-id="46a81-171">Значение</span><span class="sxs-lookup"><span data-stu-id="46a81-171">Value</span></span> | <span data-ttu-id="46a81-172">Описание</span><span class="sxs-lookup"><span data-stu-id="46a81-172">Description</span></span> |
| - | - |
| `AllDisabledByDefault` | <span data-ttu-id="46a81-173">Это наиболее консервативный режим.</span><span class="sxs-lookup"><span data-stu-id="46a81-173">This is the most conservative mode.</span></span> <span data-ttu-id="46a81-174">По умолчанию все правила отключены.</span><span class="sxs-lookup"><span data-stu-id="46a81-174">All rules are disabled by default.</span></span> <span data-ttu-id="46a81-175">Можно выборочно [принять](configuration-options.md) отдельные правила, чтобы включить их.</span><span class="sxs-lookup"><span data-stu-id="46a81-175">You can selectively [opt into](configuration-options.md) individual rules to enable them.</span></span><br /><br />`<AnalysisMode>AllDisabledByDefault</AnalysisMode>` |
| `AllEnabledByDefault` | <span data-ttu-id="46a81-176">Это самый агрессивный режим.</span><span class="sxs-lookup"><span data-stu-id="46a81-176">This is the most aggressive mode.</span></span> <span data-ttu-id="46a81-177">Все правила включены как предупреждения сборки.</span><span class="sxs-lookup"><span data-stu-id="46a81-177">All rules are enabled as build warnings.</span></span> <span data-ttu-id="46a81-178">Можно выборочно [отказаться от](configuration-options.md) отдельных правил, чтобы отключить их.</span><span class="sxs-lookup"><span data-stu-id="46a81-178">You can selectively [opt out of](configuration-options.md) individual rules to disable them.</span></span><br /><br />`<AnalysisMode>AllEnabledByDefault</AnalysisMode>` |
| `Default` | <span data-ttu-id="46a81-179">Режим по умолчанию, где несколько правил включены как предупреждения, другие включаются только в качестве предложений интегрированной среды разработки Visual Studio с соответствующими исправлениями кода, а остальные отключаются полностью.</span><span class="sxs-lookup"><span data-stu-id="46a81-179">The default mode, where a handful of rules are enabled as warnings, others are enabled only as Visual Studio IDE suggestions with corresponding code fixes, and the rest are disabled completely.</span></span> <span data-ttu-id="46a81-180">Вы можете выборочно [принять или отказаться от](configuration-options.md) отдельных правил, чтобы отключить их.</span><span class="sxs-lookup"><span data-stu-id="46a81-180">You can selectively [opt into or out of](configuration-options.md) individual rules to disable them.</span></span><br /><br />`<AnalysisMode>Default</AnalysisMode>` |

<span data-ttu-id="46a81-181">Чтобы найти уровень серьезности по умолчанию для каждого доступного правила и определить, включено ли правило в режиме анализа по умолчанию, см. [полный список правил](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span><span class="sxs-lookup"><span data-stu-id="46a81-181">To find the default severity for each available rule and whether or not the rule is enabled in the default analysis mode, see the [full list of rules](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span></span>

### <a name="treat-warnings-as-errors"></a><span data-ttu-id="46a81-182">Рассматривать предупреждения как ошибки</span><span class="sxs-lookup"><span data-stu-id="46a81-182">Treat warnings as errors</span></span>

<span data-ttu-id="46a81-183">При использовании `-warnaserror` флага при построении проектов все предупреждения анализа кода также обрабатываются как ошибки.</span><span class="sxs-lookup"><span data-stu-id="46a81-183">If you use the `-warnaserror` flag when you build your projects, all code analysis warnings are also treated as errors.</span></span> <span data-ttu-id="46a81-184">Если вы не хотите, чтобы предупреждения качества кода обрабатывались как ошибки в присутствии `-warnaserror` , можно задать `CodeAnalysisTreatWarningsAsErrors` для свойства MSBuild значение `false` в файле проекта.</span><span class="sxs-lookup"><span data-stu-id="46a81-184">If you do not want code quality warnings (CAxxxx) to be treated as errors in presence of `-warnaserror`, you can set the `CodeAnalysisTreatWarningsAsErrors` MSBuild property to `false` in your project file.</span></span>

```xml
<PropertyGroup>
  <CodeAnalysisTreatWarningsAsErrors>false</CodeAnalysisTreatWarningsAsErrors>
</PropertyGroup>
```

<span data-ttu-id="46a81-185">Вы по-прежнему увидите предупреждения анализа кода, но они не нарушат сборку.</span><span class="sxs-lookup"><span data-stu-id="46a81-185">You'll still see any code analysis warnings, but they won't break your build.</span></span>

### <a name="latest-updates"></a><span data-ttu-id="46a81-186">Последние обновления</span><span class="sxs-lookup"><span data-stu-id="46a81-186">Latest updates</span></span>

<span data-ttu-id="46a81-187">По умолчанию при обновлении до более новых версий пакета SDK для .NET вы получите последние правила анализа кода и серьезность правил по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="46a81-187">By default, you'll get the latest code analysis rules and default rule severities as you upgrade to newer versions of the .NET SDK.</span></span> <span data-ttu-id="46a81-188">Если вы не хотите этого делать, например, если вы хотите убедиться, что новые правила не включены или отключены, их можно переопределить одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="46a81-188">If you don't want this behavior, for example, if you want to ensure that no new rules are enabled or disabled, you can override it in one of the following ways:</span></span>

- <span data-ttu-id="46a81-189">Задайте `AnalysisLevel` для свойства MSBuild определенное значение, чтобы заблокировать предупреждения для этого набора.</span><span class="sxs-lookup"><span data-stu-id="46a81-189">Set the `AnalysisLevel` MSBuild property to a specific value to lock the warnings to that set.</span></span> <span data-ttu-id="46a81-190">При обновлении до более нового пакета SDK вы по-прежнему получаете исправления ошибок для этих предупреждений, но новые предупреждения не будут включены, а существующие предупреждения не будут отключены.</span><span class="sxs-lookup"><span data-stu-id="46a81-190">When you upgrade to a newer SDK, you'll still get bug fixes for those warnings, but no new warnings will be enabled and no existing warnings will be disabled.</span></span> <span data-ttu-id="46a81-191">Например, чтобы заблокировать набор правил для тех, которые поставляются с пакетом SDK для .NET версии 5,0, добавьте следующую запись в файл проекта.</span><span class="sxs-lookup"><span data-stu-id="46a81-191">For example, to lock the set of rules to those that ship with version 5.0 of the .NET SDK, add the following entry to your project file.</span></span>

  ```xml
  <PropertyGroup>
    <AnalysisLevel>5.0</AnalysisLevel>
  </PropertyGroup>
  ```

  > [!TIP]
  > <span data-ttu-id="46a81-192">Значение свойства по умолчанию `AnalysisLevel` — `latest` , что означает, что вы всегда получаете последние правила анализа кода при переходе на более новые версии пакета SDK для .NET.</span><span class="sxs-lookup"><span data-stu-id="46a81-192">The default value for the `AnalysisLevel` property is `latest`, which means you always get the latest code analysis rules as you move to newer versions of the .NET SDK.</span></span>

  <span data-ttu-id="46a81-193">Дополнительные сведения и список возможных значений см. в разделе [аналисислевел](../../core/project-sdk/msbuild-props.md#analysislevel).</span><span class="sxs-lookup"><span data-stu-id="46a81-193">For more information, and to see a list of possible values, see [AnalysisLevel](../../core/project-sdk/msbuild-props.md#analysislevel).</span></span>

- <span data-ttu-id="46a81-194">Установите [пакет NuGet Microsoft. CodeAnalysis. нетанализерс](https://github.com/dotnet/roslyn-analyzers#microsoftcodeanalysisnetanalyzers) для отделения обновлений правил от обновлений пакета SDK для .NET.</span><span class="sxs-lookup"><span data-stu-id="46a81-194">Install the [Microsoft.CodeAnalysis.NetAnalyzers NuGet package](https://github.com/dotnet/roslyn-analyzers#microsoftcodeanalysisnetanalyzers) to decouple rule updates from .NET SDK updates.</span></span> <span data-ttu-id="46a81-195">При установке пакета отключаются встроенные анализаторы SDK и создается предупреждение о сборке, если пакет SDK содержит более новую версию сборки анализатора, чем версия пакета NuGet.</span><span class="sxs-lookup"><span data-stu-id="46a81-195">Installing the package turns off the built-in SDK analyzers and generates a build warning if the SDK contains a newer analyzer assembly version than that of the NuGet package.</span></span>

## <a name="code-style-analysis"></a><span data-ttu-id="46a81-196">Анализ в стиле кода</span><span class="sxs-lookup"><span data-stu-id="46a81-196">Code-style analysis</span></span>

<span data-ttu-id="46a81-197">Правила *анализа в стиле кода* ("идекскскскс") позволяют определять и поддерживать единообразный стиль кода в базе кода.</span><span class="sxs-lookup"><span data-stu-id="46a81-197">*Code-style analysis* ("IDExxxx") rules enable you to define and maintain consistent code style in your codebase.</span></span> <span data-ttu-id="46a81-198">Параметры включения по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="46a81-198">The default enablement settings are:</span></span>

- <span data-ttu-id="46a81-199">Сборка из командной строки. по умолчанию для всех проектов .NET в сборках из командной строки отключен анализ в стиле кода.</span><span class="sxs-lookup"><span data-stu-id="46a81-199">Command-line build: Code-style analysis is disabled, by default, for all .NET projects on command-line builds.</span></span>
- <span data-ttu-id="46a81-200">Visual Studio: анализ в стиле кода включен по умолчанию для всех проектов .NET в Visual Studio в виде [быстрых действий по оптимизации кода](/visualstudio/ide/code-generation-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="46a81-200">Visual Studio: Code-style analysis is enabled, by default, for all .NET projects inside Visual Studio as [code refactoring quick actions](/visualstudio/ide/code-generation-in-visual-studio).</span></span>

<span data-ttu-id="46a81-201">Начиная с .NET 5,0, можно включить анализ в стиле кода для сборки как в командной строке, так и в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="46a81-201">Starting in .NET 5.0, you can enable code-style analysis on build, both at the command line and inside Visual Studio.</span></span> <span data-ttu-id="46a81-202">Нарушения стиля кода отображаются как предупреждения или ошибки с префиксом "IDE".</span><span class="sxs-lookup"><span data-stu-id="46a81-202">Code style violations appear as warnings or errors with an "IDE" prefix.</span></span> <span data-ttu-id="46a81-203">Это позволяет применять единообразные стили кода во время сборки.</span><span class="sxs-lookup"><span data-stu-id="46a81-203">This enables you to enforce consistent code styles at build time.</span></span>

<span data-ttu-id="46a81-204">Полный список правил анализа в стиле кода см. в разделе [правила стиля кода](style-rules/index.md).</span><span class="sxs-lookup"><span data-stu-id="46a81-204">For a full list of code-style analysis rules, see [Code style rules](style-rules/index.md).</span></span>

### <a name="enable-on-build"></a><span data-ttu-id="46a81-205">Включить при сборке</span><span class="sxs-lookup"><span data-stu-id="46a81-205">Enable on build</span></span>

<span data-ttu-id="46a81-206">Чтобы включить анализ в стиле кода для сборки, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="46a81-206">Follow these steps to enable code-style analysis on build:</span></span>

1. <span data-ttu-id="46a81-207">Задайте для свойства MSBuild [енфорцекодестилеинбуилд](../../core/project-sdk/msbuild-props.md#enforcecodestyleinbuild) значение `true` .</span><span class="sxs-lookup"><span data-stu-id="46a81-207">Set the MSBuild property [EnforceCodeStyleInBuild](../../core/project-sdk/msbuild-props.md#enforcecodestyleinbuild) to `true`.</span></span>

1. <span data-ttu-id="46a81-208">В *editorconfig* -файле [Настройте](configuration-options.md) каждое правило стиля кода "IDE", которое вы хотите запускать при сборке как предупреждение или ошибку.</span><span class="sxs-lookup"><span data-stu-id="46a81-208">In an *.editorconfig* file, [configure](configuration-options.md) each "IDE" code style rule that you wish to run on build as a warning or an error.</span></span> <span data-ttu-id="46a81-209">Пример:</span><span class="sxs-lookup"><span data-stu-id="46a81-209">For example:</span></span>

   ```ini
   [*.{cs,vb}]
   # IDE0040: Accessibility modifiers required (escalated to a build warning)
   dotnet_diagnostic.IDE0040.severity = warning
   ```

   <span data-ttu-id="46a81-210">Кроме того, можно настроить всю категорию "Style" как предупреждение или ошибку, по умолчанию, а затем выборочно отключить правила, которые не нужно запускать при сборке.</span><span class="sxs-lookup"><span data-stu-id="46a81-210">Alternatively, you can configure the entire "Style" category to be a warning or error, by default, and then selectively turn off rules that you don't want to run on build.</span></span> <span data-ttu-id="46a81-211">Пример:</span><span class="sxs-lookup"><span data-stu-id="46a81-211">For example:</span></span>

   ```ini
   [*.{cs,vb}]

   # Default severity for analyzer diagnostics with category 'Style' (escalated to build warnings)
   dotnet_analyzer_diagnostic.category-Style.severity = warning

   # IDE0040: Accessibility modifiers required (disabled on build)
   dotnet_diagnostic.IDE0040.severity = silent
   ```

> [!NOTE]
> <span data-ttu-id="46a81-212">Функция анализа в стиле кода экспериментальна и может изменяться в выпусках .NET 5 и .NET 6.</span><span class="sxs-lookup"><span data-stu-id="46a81-212">The code-style analysis feature is experimental and may change between the .NET 5 and .NET 6 releases.</span></span>

## <a name="suppress-a-warning"></a><span data-ttu-id="46a81-213">Подавлять предупреждение</span><span class="sxs-lookup"><span data-stu-id="46a81-213">Suppress a warning</span></span>

<span data-ttu-id="46a81-214">Чтобы отключить нарушение правил, задайте для этого идентификатора правила степень серьезности `none` в файле EditorConfig.</span><span class="sxs-lookup"><span data-stu-id="46a81-214">To suppress a rule violation, set the severity option for that rule ID to `none` in an EditorConfig file.</span></span> <span data-ttu-id="46a81-215">Пример:</span><span class="sxs-lookup"><span data-stu-id="46a81-215">For example:</span></span>

```ini
dotnet_diagnostic.CA1822.severity = none
```

<span data-ttu-id="46a81-216">Visual Studio предоставляет дополнительные способы отключения предупреждений из правил анализа кода.</span><span class="sxs-lookup"><span data-stu-id="46a81-216">Visual Studio provides additional ways to suppress warnings from code analysis rules.</span></span> <span data-ttu-id="46a81-217">Дополнительные сведения см. в разделе [подавлять нарушения](/visualstudio/code-quality/use-roslyn-analyzers#suppress-violations).</span><span class="sxs-lookup"><span data-stu-id="46a81-217">For more information, see [Suppress violations](/visualstudio/code-quality/use-roslyn-analyzers#suppress-violations).</span></span>

<span data-ttu-id="46a81-218">Дополнительные сведения о серьезности правил см. в разделе [Настройка серьезности правила](configuration-options.md#severity-level).</span><span class="sxs-lookup"><span data-stu-id="46a81-218">For more information about rule severities, see [Configure rule severity](configuration-options.md#severity-level).</span></span>

## <a name="third-party-analyzers"></a><span data-ttu-id="46a81-219">Сторонние анализаторы</span><span class="sxs-lookup"><span data-stu-id="46a81-219">Third-party analyzers</span></span>

<span data-ttu-id="46a81-220">Помимо официальных анализаторов .NET, можно также установить сторонние анализаторы, такие как [StyleCop](https://www.nuget.org/packages/StyleCop.Analyzers/), [Рослинатор](https://www.nuget.org/packages/Roslynator.Analyzers/), [xUnit Analyzers](https://www.nuget.org/packages/xunit.analyzers/)и [анализатор Sonar](https://www.nuget.org/packages/SonarAnalyzer.CSharp/).</span><span class="sxs-lookup"><span data-stu-id="46a81-220">In addition to the official .NET analyzers, you can also install third party analyzers, such as [StyleCop](https://www.nuget.org/packages/StyleCop.Analyzers/), [Roslynator](https://www.nuget.org/packages/Roslynator.Analyzers/), [XUnit Analyzers](https://www.nuget.org/packages/xunit.analyzers/), and [Sonar Analyzer](https://www.nuget.org/packages/SonarAnalyzer.CSharp/).</span></span>

## <a name="see-also"></a><span data-ttu-id="46a81-221">См. также</span><span class="sxs-lookup"><span data-stu-id="46a81-221">See also</span></span>

- [<span data-ttu-id="46a81-222">Справочник по правилам анализа качества кода</span><span class="sxs-lookup"><span data-stu-id="46a81-222">Code quality analysis rule reference</span></span>](quality-rules/index.md)
- [<span data-ttu-id="46a81-223">Справочник по правилам анализа стиля кода</span><span class="sxs-lookup"><span data-stu-id="46a81-223">Code style analysis rule reference</span></span>](style-rules/index.md)
- [<span data-ttu-id="46a81-224">Анализ кода в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="46a81-224">Code analysis in Visual Studio</span></span>](/visualstudio/code-quality/roslyn-analyzers-overview)
- [<span data-ttu-id="46a81-225">Пакет SDK для .NET Compiler Platform</span><span class="sxs-lookup"><span data-stu-id="46a81-225">.NET Compiler Platform SDK</span></span>](../../csharp/roslyn-sdk/index.md)
- [<span data-ttu-id="46a81-226">Учебник. Создание средства для анализа и исправления кода</span><span class="sxs-lookup"><span data-stu-id="46a81-226">Tutorial: Write your first analyzer and code fix</span></span>](../../csharp/roslyn-sdk/tutorials/how-to-write-csharp-analyzer-code-fix.md)
