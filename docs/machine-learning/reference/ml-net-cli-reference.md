---
title: Команда auto-train в программе командной строки ML.NET
description: Обзор, примеры и справочник по командам auto-train в программе командной строки ML.NET.
ms.date: 04/16/2019
ms.custom: ''
ms.openlocfilehash: 8363a16ab5e793e715131ac37283106517850439
ms.sourcegitcommit: 33c8d6f7342a4bb2c577842b7f075b0e20a2fa40
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/12/2019
ms.locfileid: "70929199"
---
# <a name="the-auto-train-command-in-mlnet-cli"></a>Команда auto-train в интерфейсе командной строки ML.NET

> [!NOTE]
> Этот раздел относится к ML.NET CLI и ML.NET AutoML, находящимся в данный момент в предварительной версии; материалы могут быть изменены.

Команда `auto-train` — это основная команда, предоставляемая программой командной строки ML.NET. Она позволяет создать модель ML.NET хорошего качества (сериализованную модель в ZIP-файле) и пример кода на C# для выполнения и оценки модели. Кроме того, создается код на C#, чтобы создать и обучить эту модель, позволяющий выяснить, какой алгоритм и параметры система обучения использует для создания этой "наилучшей модели".

Вы можете создать эти ресурсы из собственных наборов данных без самостоятельного написания кода, что также повышает производительность вашего труда, даже если вы уже знакомы с ML.NET.

Сейчас ML.NET CLI поддерживает следующие задачи машинного обучения:

- `binary-classification`
- `multiclass-classification`
- `regression`

- Будущее: Другие задачи машинного обучения, такие как
  - `recommendation`
  - `anomaly-detection`
  - `clustering`

Пример использования в командной строке:

```console
> mlnet auto-train --task regression --dataset "cars.csv" --label-column-name price
```

Команда `mlnet auto-train` создает следующие ресурсы:

- готовый к использованию ZIP-файл сериализованной модели ("модели высшего качества");
- код C# для запуска или оценки созданной модели (для прогнозирования в приложениях пользователей);
- код на C# с кодом обучения, используемый для создания этой модели (в целях обучения).

Первые два ресурса можно использовать непосредственно в приложениях конечных пользователей (веб-приложениях и службах ASP.NET Core, классических приложениях и т. д.) для прогнозирования с помощью созданной модели машинного обучения.

Третий ресурс, код обучения, рассказывает о том, какой код ML.NET API использовался интерфейсом командной строки для обучения в формируемой модели, поэтому можно выяснить, какой конкретный алгоритм обучения и гиперпараметры были выбраны интерфейсом командной строки и подсистемой ML.NET AutoML.

## <a name="the-auto-train-command-uses-the-automl-engine"></a>Команда auto-train использует ядро AutoML

Интерфейс командной строки использует ядро ML.NET AutoML (пакет NuGet) для интеллектуального поиска оптимальной модели, как показано на следующей схеме:

![изображение](./media/ml-net-automl-working-diagram.png "Ядро AutoML, работающее в программе командной строки ML.NET")

При запуске программы командной строки ML.NET с командой auto-train вы увидите, что она проходит множество итераций с сочетаниями различных алгоритмов и конфигураций.

## <a name="reference-for-auto-train-command"></a>Справочник по команде auto-train

## <a name="examples"></a>Примеры

Самый простой пример команды CLI для задачи бинарной классификации (ядро AutoML должно вывести большую часть параметров из предоставленных данных):

```console
> mlnet auto-train --task binary-classification --dataset "customer-feedback.tsv" --label-column-name Sentiment
```

Другой простой пример команды интерфейса командной строки для решения задачи регрессии:

``` console
> mlnet auto-train --task regression --dataset "cars.csv" --label-column-name Price
```

Создание и обучение модели бинарной классификации с набором данных для обучения, проверочным набором данных и дальнейшей настройкой явных аргументов:

```console
> mlnet auto-train --task binary-classification --dataset "/MyDataSets/Population-Training.csv" --test-dataset "/MyDataSets/Population-Test.csv" --label-column-name "InsuranceRisk" --cache on --max-exploration-time 600
```

## <a name="name"></a>name

`mlnet auto-train` — обучает несколько моделей (n итераций) на основе предоставленного набора данных и наконец выбирает лучшую модель, сохраняет ее как сериализуемый ZIP-файл, а также создает связанный код на C# для оценки и обучения.

## <a name="synopsis"></a>Краткий обзор

```console
> mlnet auto-train

--task | --mltask | -T <value>

--dataset | -d <value>

[
 [--validation-dataset | -v <value>]
  --test-dataset | -t <value>
]

--label-column-name | -n <value>
|
--label-column-index | -i <value>

[--ignore-columns | -I <value>]

[--has-header | -h <value>]

[--max-exploration-time | -x <value>]

[--verbosity | -V <value>]

[--cache | -c <value>]

[--name | -N <value>]

[--output-path | -o <value>]

[--help | -h]

```

Недопустимые входные параметры должны заставлять программу командной строки перечислять допустимые входные данные и выводить сообщение об ошибке, объясняющее, какой аргумент отсутствует, если это так.

## <a name="options"></a>Параметры

 ----------------------------------------------------------

`--task | --mltask | -T` (строка)

Одна строка, описывающая задачу машинного обучения для решения. Например, это может быть любая из следующих задач (программа командной строки со временем будет поддерживать все задачи, поддерживаемые в AutoML):

- `regression` — выберите, если модель машинного обучения будет использоваться для прогнозирования числовых значений.
- `binary-classification` — выберите, если результат модели машинного обучения имеет два возможных категориальных логических значения (0 или 1).
- `multiclass-classification` — выберите, если результат модели машинного обучения имеет несколько возможных категориальных значений.

В будущих выпусках будут поддерживаться дополнительные задачи машинного обучения и сценарии, например `recommendations`, `clustering` и `ranking`.

 В этом аргументе должна указываться только одна задача машинного обучения.

 ----------------------------------------------------------

`--dataset | -d` (строка)

Этот аргумент содержит путь к файлу в одном из следующих форматов:

- *А. Файл полного набора данных:* Если используется этот параметр и пользователь не задает `--test-dataset` и `--validation-dataset`, внутри для проверки модели используется кросс-валидация с K-сверткой или автоматизированное разделение данных. В этом случае пользователю будет достаточно указать путь к файлу набора данных.

- *Б. Файл набора данных для обучения:* Если пользователь также предоставляет наборы данных для валидации модели (с помощью `--test-dataset` и при необходимости `--validation-dataset`), то аргумент `--dataset` указывает лишь "набор данных для обучения". Например при использовании подхода 80–20 % для валидации качества модели и получения показателей точности "набор данных для обучения" будет содержать 80 % данных, а на "проверочный набор данных" придется 20 % данных.

----------------------------------------------------------

`--test-dataset | -t` (строка)

Путь к файлу набора данных теста, например при использовании подхода 80–20 % при выполнении регулярных валидаций для получения показателей точности.

При использовании `--test-dataset` параметр `--dataset` также является обязательным.

Аргумент `--test-dataset` является необязательным, если только не используется --validation-dataset. В этом случае пользователь должен использовать три аргумента.

----------------------------------------------------------

`--validation-dataset | -v` (строка)

Путь к файлу валидационного набора данных. В любом случае валидационный набор данных является необязательным.

При использовании `validation dataset` должно быть следующее поведение:

- Аргументы `test-dataset` и `--dataset` также являются обязательными.

- Набор данных `validation-dataset` используется для оценки ошибки прогноза для выбора модели.

- `test-dataset` используется для оценки ошибки обобщения конечной выбранной модели. В идеале проверочный набор должен храниться в "хранилище" и добавляться только в конце анализа данных.

Обычно при использовании `validation dataset` с `test dataset` этап валидации состоит из двух частей.

1. В первой части вы просто смотрите на модели и выбираете наиболее эффективный подход с использованием проверочных данных (=валидация).
2. Затем можно оценить точность выбранного подхода (= проверка).

Таким образом, разделение данных может быть задано как 80-10-10 или 75-15-10. Например:

- Файл `training-dataset` должен содержать 75 % данных.
- Файл `validation-dataset` должен содержать 15 % данных.
- Файл `test-dataset` должен содержать 10 % данных.

В любом случае эти проценты выбираются с помощью интерфейса командной строки, который будет предоставлять уже разделенные файлы.

----------------------------------------------------------

`--label-column-name | -n` (строка)

С помощью этого аргумента можно указать определенную цель и целевой столбец (переменную, которую необходимо прогнозировать), используя имя столбца в заголовке набора данных.

Этот аргумент используется только для контролируемых задач машинного обучения, таких как *задачи классификации*. Он не может использоваться для задач машинного обучения без учителя, например *кластеризации*.

----------------------------------------------------------

`--label-column-index | -i` (int)

С помощью этого аргумента можно задать определенную цель и целевой столбца (переменную, которую требуется спрогнозировать) с помощью числового индекса столбца в файле набора данных (значения индексов столбцов начинаются с 1).

*Примечание.* Если пользователь также задал `--label-column-name`, используется `--label-column-name`.

Этот аргумент используется только для контролируемых задач машинного обучения, таких как *задачи классификации*. Он не может использоваться для задач машинного обучения без учителя, например *кластеризации*.

----------------------------------------------------------

`--ignore-columns | -I` (строка)

С помощью этого аргумента можно игнорировать существующие столбцы в файле набора данных; они не загружаются и не используются процессами обучения.

Укажите имена столбцов, которые требуется игнорировать. Используйте ", " (запятая с пробелом) или " " (пробел) для разделения нескольких имен столбцов. Можно использовать кавычки для имен столбцов, содержащих пробелы (например, "Вход в систему").

Пример

`--ignore-columns email, address, id, logged_in`

----------------------------------------------------------

`--has-header | -h` (логическое значение)

Укажите, содержат ли файлы набора данных строку заголовка.
Доступны следующие значения:

- `true`
- `false`

По умолчанию значение равно `true`, если этот аргумент не задан пользователем.

Чтобы использовать аргумент `--label-column-name`, необходимо указать заголовок в файле набора данных и задать `--has-header` как `true` (используется по умолчанию).

----------------------------------------------------------

`--max-exploration-time | -x` (строка)

По умолчанию максимальное время исследования составляет 30 минут.

Этот аргумент задает максимальное время (в секундах) для процесса изучения различных учителей и конфигураций. Заданное время может быть превышено, если указанное время слишком мало (скажем, 2 секунды) для одной итерации. В этом случае фактическое время — это время, необходимое для создания одной модели конфигурации в одной итерации.

Требуемое время для итераций зависит от размера набора данных.

----------------------------------------------------------

`--cache | -c` (строка)

При использовании кэширования весь обучающий набор данных будет загружен в память.

Для малых и средних наборов данных с помощью кэша можно существенно улучшить производительность обучения; это означает, что время обучения может быть короче, чем в ситуации, если кэш не используется.

Тем не менее на большие наборы данных загрузка всех данных в память может повлиять отрицательно, так как может возникнуть нехватка памяти. В случае обучения с большими файлами набора данных без использования кэша ML.NET будет потоком передавать блоки данных с диска при необходимости загрузить дополнительные данные во время обучения.

Можно указать следующие значения:

`on`: принудительно включает кэш при обучении;
`off`: принудительно отключает кэш при обучении;
`auto`: кэш будет использоваться в зависимости от эвристики AutoML. Как правило, для небольших и средних наборов данных будет использоваться кэш; большие наборы данных не будут использовать кэш, если вы укажете `auto`.

Если вы не укажете параметр `--cache`, то для кэша `auto` будет использована конфигурация по умолчанию.

----------------------------------------------------------

`--name | -N` (строка)

Имя для создаваемых выходных проекта или решения. Если имя не задано, используется имя `sample-{mltask}`.

Файл модели ML.NET (ZIP-файл) получит то же имя.

----------------------------------------------------------

`--output-path | -o` (строка)

Корневое расположение или папка для размещения созданных выходных данных. Значением по умолчанию является текущий каталог.

----------------------------------------------------------

`--verbosity | -V` (строка)

Задает уровень детализации стандартных выходных данных.

Допустимыми значениями являются:

- `q[uiet]`
- `m[inimal]` (по умолчанию);
- `diag[nostic]` (уровень ведения журнала).

По умолчанию программа командной строки должна отображать минимальные выходные данные во время работы, например отметить, что она работает и (по возможности) сколько времени уйдет на завершение работы.

----------------------------------------------------------

`-h|--help`

Выводит справку для команды с описанием каждого аргумента.

----------------------------------------------------------

## <a name="see-also"></a>См. также

- [Установка интерфейса командной строки ML.NET](../how-to-guides/install-ml-net-cli.md)
- [Автоматизация обучения модели с помощью интерфейса командной строки ML.NET](../automate-training-with-cli.md)
- [Учебник. Автоматическое создание бинарного классификатора с помощью интерфейса командной строки ML.NET](../tutorials/mlnet-cli.md)
- [Данные телеметрии в интерфейсе командной строки ML.NET](../resources/ml-net-cli-telemetry.md)
