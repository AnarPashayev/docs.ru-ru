---
title: Учебник. Классификация санитарных нарушений с помощью построителя моделей
description: В этом руководстве показано, как с помощью построителя моделей ML.NET создать модель многоклассовой классификации, которая классифицирует серьезность санитарных нарушений в ресторанах Сан-Франциско.
author: luisquintanilla
ms.author: luquinta
ms.date: 11/21/2019
ms.topic: tutorial
ms.custom: mvc,mlnet-tooling
ms.openlocfilehash: e94313277a025d482105a6d78b6608d4df442c43
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "79185836"
---
# <a name="tutorial-classify-the-severity-of-restaurant-health-violations-with-model-builder"></a><span data-ttu-id="a4c8a-103">Учебник. Классификация серьезности санитарных нарушений в ресторанах с помощью построителя моделей</span><span class="sxs-lookup"><span data-stu-id="a4c8a-103">Tutorial: Classify the severity of restaurant health violations with Model Builder</span></span>

<span data-ttu-id="a4c8a-104">Сведения о том, как с помощью построителя моделей создать модель многоклассовой классификации, чтобы определять категорию уровня риска для нарушений, обнаруженных во время санитарных проверок ресторанов.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-104">Learn how to build a multiclass classification model using Model Builder to categorize the risk level of restaurant violations found during health inspections.</span></span>

<span data-ttu-id="a4c8a-105">В этом руководстве вы узнаете, как:</span><span class="sxs-lookup"><span data-stu-id="a4c8a-105">In this tutorial, you learn how to:</span></span>

> [!div class="checklist"]
>
> - <span data-ttu-id="a4c8a-106">Подготовка и анализ данных</span><span class="sxs-lookup"><span data-stu-id="a4c8a-106">Prepare and understand the data</span></span>
> - <span data-ttu-id="a4c8a-107">Выбор сценария</span><span class="sxs-lookup"><span data-stu-id="a4c8a-107">Choose a scenario</span></span>
> - <span data-ttu-id="a4c8a-108">Загрузка данных из базы данных</span><span class="sxs-lookup"><span data-stu-id="a4c8a-108">Load data from a database</span></span>
> - <span data-ttu-id="a4c8a-109">Обучение модели</span><span class="sxs-lookup"><span data-stu-id="a4c8a-109">Train the model</span></span>
> - <span data-ttu-id="a4c8a-110">Оценка модели</span><span class="sxs-lookup"><span data-stu-id="a4c8a-110">Evaluate the model</span></span>
> - <span data-ttu-id="a4c8a-111">Использование модели для прогнозирования</span><span class="sxs-lookup"><span data-stu-id="a4c8a-111">Use the model for predictions</span></span>

> [!NOTE]
> <span data-ttu-id="a4c8a-112">Построитель моделей в настоящее время находится на этапе предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-112">Model Builder is currently in Preview.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="a4c8a-113">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="a4c8a-113">Prerequisites</span></span>

<span data-ttu-id="a4c8a-114">Список необходимых компонентов и инструкции по установке см. в [руководстве по установке построителя моделей](../how-to-guides/install-model-builder.md).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-114">For a list of prerequisites and installation instructions, visit the [Model Builder installation guide](../how-to-guides/install-model-builder.md).</span></span>

## <a name="model-builder-multiclass-classification-overview"></a><span data-ttu-id="a4c8a-115">Обзор многоклассовой классификации в построителе моделей</span><span class="sxs-lookup"><span data-stu-id="a4c8a-115">Model Builder multiclass classification overview</span></span>

<span data-ttu-id="a4c8a-116">В этом примере создается консольное приложение .NET Core на языке C#, которое классифицирует риск санитарных нарушений с помощью модели машинного обучения, созданной в построителе моделей.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-116">This sample creates a C# .NET Core console application that categorizes the risk of health violations using a machine learning model built with Model Builder.</span></span> <span data-ttu-id="a4c8a-117">Исходный код примера из этого руководства можно найти в репозитории [dotnet/machinelearning-samples](https://github.com/dotnet/machinelearning-samples/tree/master/samples/modelbuilder/MulticlassClassification_RestaurantViolations) на сайте GitHub.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-117">You can find the source code for this tutorial at the [dotnet/machinelearning-samples](https://github.com/dotnet/machinelearning-samples/tree/master/samples/modelbuilder/MulticlassClassification_RestaurantViolations) GitHub repository.</span></span>

## <a name="create-a-console-application"></a><span data-ttu-id="a4c8a-118">Создание консольного приложения</span><span class="sxs-lookup"><span data-stu-id="a4c8a-118">Create a console application</span></span>

1. <span data-ttu-id="a4c8a-119">Создайте **консольное приложение .NET Core на C#** с именем RestaurantViolations.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-119">Create a **C# .NET Core console application** called "RestaurantViolations".</span></span> <span data-ttu-id="a4c8a-120">Убедитесь, что флажок **Поместить решение и проект в одной папке** **снят** (VS 2019) или флажок **Создать каталог для решения** **установлен** (VS 2017).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-120">Make sure **Place solution and project in the same directory** is **unchecked** (VS 2019), or **Create directory for solution** is **checked** (VS 2017).</span></span>

## <a name="prepare-and-understand-the-data"></a><span data-ttu-id="a4c8a-121">Подготовка и анализ данных</span><span class="sxs-lookup"><span data-stu-id="a4c8a-121">Prepare and understand the data</span></span>

> <span data-ttu-id="a4c8a-122">Набор данных для обучения и оценки модели машинного обучения создан на основе [данных о санитарной безопасности ресторанов от Департамента здравоохранения Сан-Франциско](https://www.sfdph.org/dph/EH/Food/score/default.asp).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-122">The data set used to train and evaluate the machine learning model is originally from the [San Francisco Department of Public Health Restaurant Safety Scores](https://www.sfdph.org/dph/EH/Food/score/default.asp).</span></span> <span data-ttu-id="a4c8a-123">Для удобства этот набор данных был уплотнен и теперь включает только столбцы, имеющее прямое отношение к обучению модели и прогнозированию.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-123">For convenience, the dataset has been condensed to only include the columns relevant to train the model and make predictions.</span></span> <span data-ttu-id="a4c8a-124">Чтобы узнать больше об этом [наборе данных](https://data.sfgov.org/Health-and-Social-Services/Restaurant-Scores-LIVES-Standard/pyih-qa8i?row_index=0), посетите следующий веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-124">Visit the following website to learn more about the [dataset](https://data.sfgov.org/Health-and-Social-Services/Restaurant-Scores-LIVES-Standard/pyih-qa8i?row_index=0).</span></span>

<span data-ttu-id="a4c8a-125">[Скачайте набор данных об оценке безопасности ресторанов](https://github.com/luisquintanilla/machinelearning-samples/raw/AB1608219/samples/modelbuilder/MulticlassClassification_RestaurantViolations/RestaurantScores.zip) и распакуйте его.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-125">[Download the Restaurant Safety Scores dataset](https://github.com/luisquintanilla/machinelearning-samples/raw/AB1608219/samples/modelbuilder/MulticlassClassification_RestaurantViolations/RestaurantScores.zip) and unzip it.</span></span>

<span data-ttu-id="a4c8a-126">Каждая строка в наборе данных содержит сведения о нарушениях, обнаруженных при проверке Департаментом здравоохранения, и оценку рисков для общественного здоровья и безопасности, которые связаны с этими нарушениями.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-126">Each row in the dataset contains information regarding violations observed during an inspection from the Health Department and a risk assessment of the threat those violations present to public health and safety.</span></span>

| <span data-ttu-id="a4c8a-127">InspectionType</span><span class="sxs-lookup"><span data-stu-id="a4c8a-127">InspectionType</span></span> | <span data-ttu-id="a4c8a-128">ViolationDescription</span><span class="sxs-lookup"><span data-stu-id="a4c8a-128">ViolationDescription</span></span> | <span data-ttu-id="a4c8a-129">RiskCategory</span><span class="sxs-lookup"><span data-stu-id="a4c8a-129">RiskCategory</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a4c8a-130">Routine (плановые) — Unscheduled (внеплановые)</span><span class="sxs-lookup"><span data-stu-id="a4c8a-130">Routine - Unscheduled</span></span> | <span data-ttu-id="a4c8a-131">Недостаточно очищены или продезинфицированы поверхности, взаимодействующие с продуктами</span><span class="sxs-lookup"><span data-stu-id="a4c8a-131">Inadequately cleaned or sanitized food contact surfaces</span></span> | <span data-ttu-id="a4c8a-132">Средний риск</span><span class="sxs-lookup"><span data-stu-id="a4c8a-132">Moderate Risk</span></span> |
| <span data-ttu-id="a4c8a-133">Новый владелец</span><span class="sxs-lookup"><span data-stu-id="a4c8a-133">New Ownership</span></span> | <span data-ttu-id="a4c8a-134">Высокий риск распространения паразитов</span><span class="sxs-lookup"><span data-stu-id="a4c8a-134">High risk vermin infestation</span></span> | <span data-ttu-id="a4c8a-135">Высокий риск</span><span class="sxs-lookup"><span data-stu-id="a4c8a-135">High Risk</span></span> |
| <span data-ttu-id="a4c8a-136">Routine (плановые) — Unscheduled (внеплановые)</span><span class="sxs-lookup"><span data-stu-id="a4c8a-136">Routine - Unscheduled</span></span> | <span data-ttu-id="a4c8a-137">Тряпки для протирки грязные или неправильно хранятся, или недостаточно чистящего средства</span><span class="sxs-lookup"><span data-stu-id="a4c8a-137">Wiping cloths not clean or properly stored or inadequate sanitizer</span></span> | <span data-ttu-id="a4c8a-138">Низкий риск</span><span class="sxs-lookup"><span data-stu-id="a4c8a-138">Low Risk</span></span> |

- <span data-ttu-id="a4c8a-139">**InspectionType**: обозначает тип проверки.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-139">**InspectionType**: the type of inspection.</span></span> <span data-ttu-id="a4c8a-140">Это может быть первичная проверка для нового заведения, плановая проверка, изучение жалобы и многое другое.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-140">This can either be a first-time inspection for a new establishment, a routine inspection, a complaint inspection, and many other types.</span></span>
- <span data-ttu-id="a4c8a-141">**ViolationDescription**: описание нарушения, обнаруженного во время проверки.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-141">**ViolationDescription**: a description of the violation found during inspection.</span></span>
- <span data-ttu-id="a4c8a-142">**RiskCategory**: серьезность рисков для общественного здоровья и безопасности, которые влечет за собой это нарушение.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-142">**RiskCategory**: the risk severity a violation poses to public health and safety.</span></span>

<span data-ttu-id="a4c8a-143">`label` — это столбец для прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-143">The `label` is the column you want to predict.</span></span> <span data-ttu-id="a4c8a-144">При выполнении задачи классификации целью является назначение категории (текстовое или числовое значение).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-144">When performing a classification task, the goal is to assign a category (text or numerical).</span></span> <span data-ttu-id="a4c8a-145">В нашем сценарии классификации серьезность (риск) нарушения может быть низкой, средней или высокой.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-145">In this classification scenario, the severity of the violation is assigned the value of low, moderate, or high risk.</span></span> <span data-ttu-id="a4c8a-146">Для этих целей поле **RiskCategory** имеет формат метки.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-146">Therefore, the **RiskCategory** is the label.</span></span> <span data-ttu-id="a4c8a-147">Признаки (`features`) содержат входные данные, которые вы передаете в модель для прогнозирования метки (`label`).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-147">The `features` are the inputs you give the model to predict the `label`.</span></span> <span data-ttu-id="a4c8a-148">В нашем примере признаками (входными данными) выступают **InspectionType** и **ViolationDescription**, на основе которых прогнозируется значение **RiskCategory**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-148">In this case, the **InspectionType** and **ViolationDescription** are used as features or inputs to predict the **RiskCategory**.</span></span>

## <a name="choose-a-scenario"></a><span data-ttu-id="a4c8a-149">Выбор сценария</span><span class="sxs-lookup"><span data-stu-id="a4c8a-149">Choose a scenario</span></span>

![Мастер построителя моделей в Visual Studio](./media/sentiment-analysis-model-builder/model-builder-screen.png)

<span data-ttu-id="a4c8a-151">Чтобы обучить модель, выберите один из доступных сценариев машинного обучения в построителе моделей.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-151">To train your model, select from the list of available machine learning scenarios provided by Model Builder.</span></span> <span data-ttu-id="a4c8a-152">В нашем примере используется сценарий *Issue Classification* (Классификация проблем).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-152">In this case, the scenario is *Issue Classification*.</span></span>

1. <span data-ttu-id="a4c8a-153">В **обозревателе решений** щелкните правой кнопкой мыши проект *RestaurantViolations* и выберите **Добавить** > **Машинное обучение**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-153">In **Solution Explorer**, right-click the *RestaurantViolations* project, and select **Add** > **Machine Learning**.</span></span>
1. <span data-ttu-id="a4c8a-154">В нашем примере применяется многоклассовая классификация.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-154">For this sample, the scenario is multiclass classification.</span></span> <span data-ttu-id="a4c8a-155">На этапе *Сценарий* в построителе моделей выберите сценарий **Issue Classification** (Классификация проблем).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-155">In the *Scenario* step of Model Builder, select the **Issue Classification** scenario.</span></span>

## <a name="load-the-data"></a><span data-ttu-id="a4c8a-156">Загрузка данных</span><span class="sxs-lookup"><span data-stu-id="a4c8a-156">Load the data</span></span>

<span data-ttu-id="a4c8a-157">Построитель моделей принимает данные из базы данных SQL Server или локального файла в формате `csv` или `tsv`.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-157">Model Builder accepts data from a SQL Server database or a local file in `csv` or `tsv` format.</span></span>

1. <span data-ttu-id="a4c8a-158">На этапе добавления данных в средстве построителя моделей выберите в раскрывающемся списке источников данных пункт **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-158">In the data step of the Model Builder tool, select **SQL Server** from the data source dropdown.</span></span>
1. <span data-ttu-id="a4c8a-159">Нажмите кнопку рядом с текстовым полем **Connect to SQL Server database** (Подключение к базе данных SQL Server).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-159">Select the button next to the **Connect to SQL Server database** text box.</span></span>
    1. <span data-ttu-id="a4c8a-160">В диалоговом окне **Choose Data** (Выбор данных) выберите **Файл базы данных Microsoft SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-160">In the **Choose Data** dialog, select **Microsoft SQL Server Database File**.</span></span>
    1. <span data-ttu-id="a4c8a-161">Снимите флажок **Всегда использовать этот вариант** и щелкните **Продолжить**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-161">Uncheck the **Always use this selection** checkbox and select **Continue**.</span></span>
    1. <span data-ttu-id="a4c8a-162">В диалоговом окне **Свойства подключения** щелкните **Обзор** и выберите скачанный файл *RestaurantScores.mdf*.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-162">In the **Connection Properties** dialog, select **Browse** and select the downloaded *RestaurantScores.mdf* file.</span></span>
    1. <span data-ttu-id="a4c8a-163">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-163">Select **OK**.</span></span>
1. <span data-ttu-id="a4c8a-164">Выберите **Violations** (Нарушения) из раскрывающегося списка **Имя таблицы**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-164">Choose **Violations** from the **Table Name** dropdown.</span></span>
1. <span data-ttu-id="a4c8a-165">Выберите вариант **RiskCategory** в раскрывающемся списке **Прогнозируемые столбцы** (метка).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-165">Choose **RiskCategory** in the **Column to Predict (Label)** dropdown.</span></span>
1. <span data-ttu-id="a4c8a-166">Сохраните выбранные по умолчанию столбцы **InspectionType** и **ViolationDescription**, в раскрывающемся списке **Входные столбцы** (признаки).</span><span class="sxs-lookup"><span data-stu-id="a4c8a-166">Leave the default column selections, **InspectionType** and **ViolationDescription**, checked in the **Input Columns (Features)** dropdown.</span></span>
1. <span data-ttu-id="a4c8a-167">Щелкните ссылку **Обучение**, чтобы перейти к следующему шагу в построителе моделей.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-167">Select the **Train** link to move to the next step in Model Builder.</span></span>

## <a name="train-the-model"></a><span data-ttu-id="a4c8a-168">Обучение модели</span><span class="sxs-lookup"><span data-stu-id="a4c8a-168">Train the model</span></span>

<span data-ttu-id="a4c8a-169">Задачей машинного обучения, используемой в этом руководстве для обучения модели классификации проблем, является многоклассовая классификация.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-169">The machine learning task used to train the issue classification model in this tutorial is multiclass classification.</span></span> <span data-ttu-id="a4c8a-170">В процессе обучения моделей построитель моделей обучает отдельные модели по разным алгоритмам многоклассовой классификации, используя разные параметры, и выбирает среди них оптимальную модель для предоставленного набора данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-170">During the model training process, Model Builder trains separate models using different multiclass classification algorithms and settings to find the best performing model for your dataset.</span></span>

<span data-ttu-id="a4c8a-171">Время, требуемое для обучения модели, пропорционально объему данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-171">The time required for the model to train is proportional to the amount of data.</span></span> <span data-ttu-id="a4c8a-172">Построитель моделей автоматически выбирает значение по умолчанию для параметра **Time to train (seconds)** (Время обучения в секундах) в зависимости от размера источника данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-172">Model Builder automatically selects a default value for **Time to train (seconds)** based on the size of your data source.</span></span>

1. <span data-ttu-id="a4c8a-173">Хотя построитель моделей задает для параметра **Время обучения (в секундах)** значение 10 секунд, увеличьте его до 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-173">Although Model Builder sets the value of **Time to train (seconds)** to 10 seconds, increase it to 30 seconds.</span></span> <span data-ttu-id="a4c8a-174">Обучение в течение более длительного периода времени позволяет построителю моделей исследовать большее количество алгоритмов и комбинаций параметров, чтобы определить наилучшую модель.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-174">Training for a longer period of time allows Model Builder to explore a larger number of algorithms and combination of parameters in search of the best model.</span></span>
1. <span data-ttu-id="a4c8a-175">Выберите **Начать обучение**.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-175">Select **Start Training**.</span></span>

    <span data-ttu-id="a4c8a-176">В процессе обучения сведения о ходе выполнения отображаются в разделе `Progress` шага обучения.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-176">Throughout the training process, progress data is displayed in the `Progress` section of the train step.</span></span>

    - <span data-ttu-id="a4c8a-177">В области **Состояние** отображается текущее состояние процесса обучения.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-177">**Status** displays the completion status of the training process.</span></span>
    - <span data-ttu-id="a4c8a-178">**Best accuracy** (Наибольшая точность) — это точность модели, которую построитель моделей на текущий момент считает лучшей.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-178">**Best accuracy** displays the accuracy of the best performing model found by Model Builder so far.</span></span> <span data-ttu-id="a4c8a-179">Точность зависит от того, насколько правильный прогноз был сделан моделью на основе тестовых данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-179">Higher accuracy means the model predicted more correctly on test data.</span></span>
    - <span data-ttu-id="a4c8a-180">**Best algorithm** (Лучший алгоритм) отображает название алгоритма, который построитель моделей на текущий момент считает лучшим.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-180">**Best algorithm** displays the name of the best-performing algorithm found by Model Builder so far.</span></span>
    - <span data-ttu-id="a4c8a-181">**Last algorithm** (Последний алгоритм) отображает название алгоритма, который построителем моделей для обучения модели последним.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-181">**Last algorithm** displays the name of the algorithm most recently used by Model Builder to train the model.</span></span>

1. <span data-ttu-id="a4c8a-182">Когда обучение завершится, щелкните ссылку **Оценить**, чтобы перейти к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-182">Once training is complete, select the **Evaluate** link to move to the next step.</span></span>

## <a name="evaluate-the-model"></a><span data-ttu-id="a4c8a-183">Оценка модели</span><span class="sxs-lookup"><span data-stu-id="a4c8a-183">Evaluate the model</span></span>

<span data-ttu-id="a4c8a-184">Результатом шага обучения является одна модель с наивысшей точностью.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-184">The result of the training step is the one model that had the best performance.</span></span> <span data-ttu-id="a4c8a-185">На шаге оценки построитель моделей выводит в поле **Лучшая модель** алгоритм, который используется в наиболее оптимальной модели, а в поле **Качество лучшей модели** — метрики оценки.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-185">In the evaluate step of Model Builder, the output section contains the algorithm used by the best performing model in the **Best Model** entry along with metrics in **Best Model Accuracy**.</span></span> <span data-ttu-id="a4c8a-186">Кроме того, отображается сводная таблица с пятью лучшими из рассмотренных моделей и их метриками.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-186">Additionally, a summary table containing up to five models that were explored and their metrics is displayed.</span></span>

<span data-ttu-id="a4c8a-187">Если вас не удовлетворяют метрики точности, самые простые способы повысить точность модели — увеличить длительность обучения или использовать больше данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-187">If you're not satisfied with your accuracy metrics, some easy ways to try to improve model accuracy are to increase the amount of time to train the model or use more data.</span></span> <span data-ttu-id="a4c8a-188">В противном случае щелкните ссылку **Код**, чтобы перейти к завершающему шагу построителя моделей.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-188">Otherwise, select the **code** link to move to the final step in Model Builder.</span></span>

## <a name="add-the-code-to-make-predictions"></a><span data-ttu-id="a4c8a-189">Добавление кода для прогнозирования</span><span class="sxs-lookup"><span data-stu-id="a4c8a-189">Add the code to make predictions</span></span>

<span data-ttu-id="a4c8a-190">В результате процесса обучения создаются два проекта.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-190">Two projects are created as a result of the training process.</span></span>

- <span data-ttu-id="a4c8a-191">RestaurantViolationsML.ConsoleApp: консольное приложение .NET Core на C# с кодом для обучения и использования модели.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-191">RestaurantViolationsML.ConsoleApp: A C# .NET Core Console application that contains the model training and sample consumption code.</span></span>
- <span data-ttu-id="a4c8a-192">RestaurantViolationsML.Model: библиотека классов .NET Standard с моделями данных, которые определяют схему входных и выходных данных модели, а также хранимую версию оптимальной модели во время обучения и вспомогательный класс с именем `ConsumeModel` для формирования прогнозов.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-192">RestaurantViolationsML.Model: A .NET Standard class library containing the data models that define the schema of input and output model data, the saved version of the best performing model during training, and a helper class called `ConsumeModel` to make predictions.</span></span>

1. <span data-ttu-id="a4c8a-193">На шаге кода в построителе моделей щелкните **Добавить проекты**, чтобы добавить автоматически созданные проекты в решение.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-193">In the code step of Model Builder, select **Add Projects** to add the autogenerated projects to the solution.</span></span>
1. <span data-ttu-id="a4c8a-194">Откройте файл *Program.cs* в проекте *RestaurantViolations*.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-194">Open the *Program.cs* file in the *RestaurantViolations* project.</span></span>
1. <span data-ttu-id="a4c8a-195">Добавьте следующее содержимое, используя оператор для ссылки на проект *RestaurantViolationsML.Model*:</span><span class="sxs-lookup"><span data-stu-id="a4c8a-195">Add the following using statement to reference the *RestaurantViolationsML.Model* project:</span></span>

    [!code-csharp [ProgramUsings](~/machinelearning-samples/samples/modelbuilder/MulticlassClassification_RestaurantViolations/RestaurantViolations/Program.cs#L2)]

1. <span data-ttu-id="a4c8a-196">Чтобы сделать прогноз на основе новых данных с помощью модели, создайте новый экземпляр класса `ModelInput` внутри метода `Main` приложения.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-196">To make a prediction on new data using the model, create a new instance of the `ModelInput` class inside the `Main` method of your application.</span></span> <span data-ttu-id="a4c8a-197">Обратите внимание, что категория риска не входит в набор входных данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-197">Notice that the risk category is not part of the input.</span></span> <span data-ttu-id="a4c8a-198">Это сделано для того, чтобы модель сама спрогнозировала ее.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-198">This is because the model generates the prediction for it.</span></span>

    [!code-csharp [TestData](~/machinelearning-samples/samples/modelbuilder/MulticlassClassification_RestaurantViolations/RestaurantViolations/Program.cs#L11-L15)]

1. <span data-ttu-id="a4c8a-199">Используйте метод `Predict` из класса `ConsumeModel`.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-199">Use the `Predict` method from the `ConsumeModel` class.</span></span> <span data-ttu-id="a4c8a-200">Метод `Predict` загружает обученную модель, создает [`PredictionEngine`](xref:Microsoft.ML.PredictionEngine%602) для модели и использует эту подсистему для создания прогнозов на основе новых данных.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-200">The `Predict` method loads the trained model, creates a [`PredictionEngine`](xref:Microsoft.ML.PredictionEngine%602) for the model, and uses it to make predictions on new data.</span></span>

    [!code-csharp [Prediction](~/machinelearning-samples/samples/modelbuilder/MulticlassClassification_RestaurantViolations/RestaurantViolations/Program.cs#L17-L24)]

1. <span data-ttu-id="a4c8a-201">Запустите приложение.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-201">Run the application.</span></span>

    <span data-ttu-id="a4c8a-202">Выходные данные программы должны выглядеть примерно так:</span><span class="sxs-lookup"><span data-stu-id="a4c8a-202">The output generated by the program should look similar to the snippet below:</span></span>

    ```bash
    Inspection Type: Complaint
    Violation Description: Inadequate sewage or wastewater disposal
    Risk Category: Moderate Risk
    ```

<span data-ttu-id="a4c8a-203">Если на созданные проекты нужно будет сослаться позднее в другом решении, их можно найти в каталоге `C:\Users\%USERNAME%\AppData\Local\Temp\MLVSTools`.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-203">If you need to reference the generated projects at a later time inside of another solution, you can find them inside the `C:\Users\%USERNAME%\AppData\Local\Temp\MLVSTools` directory.</span></span>

<span data-ttu-id="a4c8a-204">Поздравляем!</span><span class="sxs-lookup"><span data-stu-id="a4c8a-204">Congratulations!</span></span> <span data-ttu-id="a4c8a-205">Вы успешно создали модель машинного обучения для классификации риска санитарных нарушений с помощью построителя моделей.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-205">You've successfully built a machine learning model to categorize the risk of health violations using Model Builder.</span></span> <span data-ttu-id="a4c8a-206">Исходный код примера из этого руководства можно найти в репозитории [dotnet/machinelearning-samples](https://github.com/dotnet/machinelearning-samples/tree/master/samples/modelbuilder/MulticlassClassification_RestaurantViolations) на сайте GitHub.</span><span class="sxs-lookup"><span data-stu-id="a4c8a-206">You can find the source code for this tutorial at the [dotnet/machinelearning-samples](https://github.com/dotnet/machinelearning-samples/tree/master/samples/modelbuilder/MulticlassClassification_RestaurantViolations) GitHub repository.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a4c8a-207">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="a4c8a-207">Additional resources</span></span>

<span data-ttu-id="a4c8a-208">Дополнительные сведения см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="a4c8a-208">To learn more about topics mentioned in this tutorial, visit the following resources:</span></span>

- [<span data-ttu-id="a4c8a-209">Сценарии для построителя моделей</span><span class="sxs-lookup"><span data-stu-id="a4c8a-209">Model Builder Scenarios</span></span>](../automate-training-with-model-builder.md#scenarios)
- [<span data-ttu-id="a4c8a-210">Многоклассовая классификация</span><span class="sxs-lookup"><span data-stu-id="a4c8a-210">Multiclass Classification</span></span>](../resources/glossary.md#multiclass-classification)
- [<span data-ttu-id="a4c8a-211">Метрики модели многоклассовой классификации</span><span class="sxs-lookup"><span data-stu-id="a4c8a-211">Multiclass Classification Model Metrics</span></span>](../resources/metrics.md#evaluation-metrics-for-multi-class-classification)
