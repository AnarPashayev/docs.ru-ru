---
title: Задачи машинного обучения
description: Изучите возможности задач машинного обучения и связанных задач, поддерживаемых в ML.NET.
ms.custom: seodec18
ms.date: 04/23/2019
author: natke
ms.openlocfilehash: d0634ce8a0559ab3cdb5bf27fc5406ab02af8df6
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73977244"
---
# <a name="machine-learning-tasks-in-mlnet"></a>Задачи машинного обучения в ML.NET

Создавая модель машинного обучения, сначала следует определить цели, которых вы намерены достичь для имеющихся данных. Это позволит вам правильно выбрать задачу машинного обучения для конкретной ситуации. В следующем списке описываются разные задачи машинного обучения, которые вы можете выбрать, и распространенные варианты их использования. Дополнительные сведения о выборе задачи, подходящей для вашего сценария, см. в статье об [алгоритмах](../how-to-choose-an-ml-net-algorithm.md).

Определив задачу для своего сценария, выберите наилучший алгоритм для обучения модели. Далее перечислены доступные алгоритмы для каждой задачи.

## <a name="binary-classification"></a>Двоичная классификация

[Задача контролируемого машинного обучения](glossary.md#supervised-machine-learning), которая прогнозирует распределение элементов данных по двум классам (категориям). На вход алгоритма классификации подается набор примеров с метками, каждая из которых представляет собой целое число 0 или 1. Результатом работы алгоритма двоичной классификации является классификатор, который умеет прогнозировать класс для новых экземпляров без метки. Вот несколько примеров для сценария двоичной классификации:

* [Распределение комментариев Twitter по тональности](../tutorials/sentiment-analysis.md) — позитивные или негативные.
* Диагностика пациента на наличие определенной болезни.
* Принятие решений о присвоении отметки "спам" сообщению электронной почты.
* Определение того, содержит ли фотография определенный элемент, например изображение собаки или фрукта.

Дополнительные сведения см. в [статье о двоичной классификации](https://en.wikipedia.org/wiki/Binary_classification) в Википедии.

### <a name="binary-classification-trainers"></a>Алгоритмы обучения двоичной классификации

Вы можете обучить модель двоичной классификации, используя следующие алгоритмы:

* <xref:Microsoft.ML.Trainers.AveragedPerceptronTrainer>
* <xref:Microsoft.ML.Trainers.SdcaLogisticRegressionBinaryTrainer>
* <xref:Microsoft.ML.Trainers.SdcaNonCalibratedBinaryTrainer>
* <xref:Microsoft.ML.Trainers.SymbolicSgdLogisticRegressionBinaryTrainer>
* <xref:Microsoft.ML.Trainers.LbfgsLogisticRegressionBinaryTrainer>
* <xref:Microsoft.ML.Trainers.LightGbm.LightGbmBinaryTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.FastTreeBinaryTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.FastForestBinaryTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.GamBinaryTrainer>
* <xref:Microsoft.ML.Trainers.FieldAwareFactorizationMachineTrainer>
* <xref:Microsoft.ML.Trainers.PriorTrainer>
* <xref:Microsoft.ML.Trainers.LinearSvmTrainer>

### <a name="binary-classification-inputs-and-outputs"></a>Входные и выходные данные двоичной классификации

Для получения наилучших результатов обучения двоичной классификации обучающие данные должны быть сбалансированы (т. е. число положительных и отрицательных обучающих данных должно быть одинаковым). Отсутствующие значения необходимо обработать до обучения.

Входные данные столбца меток должны иметь тип <xref:System.Boolean>.
Входные данные столбца функций должны быть вектором <xref:System.Single> фиксированного размера.

С помощью этих алгоритмов обучения выводятся следующие столбцы:

| Имя выходного столбца | Тип столбца | ОПИСАНИЕ|
| -- | -- | -- |
| `Score` | <xref:System.Single> | Необработанная оценка, рассчитанная моделью.|
| `PredictedLabel` | <xref:System.Boolean> | Прогнозируемая метка, зависящая от знака оценки. Отрицательная оценка соответствует значению `false`, а положительная — значению `true`.|

## <a name="multiclass-classification"></a>Многоклассовая классификация

[Задача контролируемого машинного обучения](glossary.md#supervised-machine-learning), которая прогнозирует распределение экземпляров данных по нескольким классам (категориям). На вход алгоритма классификации подается набор примеров с метками. Каждая метка обычно запускается как текст. Затем она запускается через TermTransform, который преобразует ее в тип ключа (числовой). Результатом работы алгоритма классификации является классификатор, который умеет прогнозировать класс для новых экземпляров без метки. Вот несколько примеров для сценария многоклассовой классификации:

* определение породы собаки, например "сибирский хаски", "золотистый ретривер", "пудель" и т. д;
* распределение отзывов о фильме по категориям "позитивный", "нейтральный" или "негативный";
* выбор категорий для отзывов о гостиницах, например "местоположение", "цена", "чистота" и т. д.

Дополнительные сведения см. в [статье о многоклассовой классификации](https://en.wikipedia.org/wiki/Multiclass_classification) в Википедии.

>[!NOTE]
>В рамках стратегии one-vs.-rest обновляется любой [алгоритм обучения двоичной классификации](#binary-classification) для работы с многоклассовыми наборами данных. Дополнительные сведения см. в статье (https://en.wikipedia.org/wiki/Multiclass_classification#One-vs.-rest) в Википедии.

### <a name="multiclass-classification-trainers"></a>Алгоритмы обучения многоклассовой классификации

Вы можете обучить модель многоклассовой классификации, используя следующие алгоритмы:

* <xref:Microsoft.ML.Trainers.LightGbm.LightGbmMulticlassTrainer>
* <xref:Microsoft.ML.Trainers.SdcaMaximumEntropyMulticlassTrainer>
* <xref:Microsoft.ML.Trainers.SdcaNonCalibratedMulticlassTrainer>
* <xref:Microsoft.ML.Trainers.LbfgsMaximumEntropyMulticlassTrainer>
* <xref:Microsoft.ML.Trainers.NaiveBayesMulticlassTrainer>
* <xref:Microsoft.ML.Trainers.OneVersusAllTrainer>
* <xref:Microsoft.ML.Trainers.PairwiseCouplingTrainer>

### <a name="multiclass-classification-inputs-and-outputs"></a>Входные и выходные данные многоклассовой классификации

Входные данные столбца меток должны иметь тип [key](xref:Microsoft.ML.Data.KeyDataViewType).
Столбец функций должен быть вектором <xref:System.Single> фиксированного размера.

Этот алгоритм обучения выводит приведенные ниже данные.

| Имя выходных данных | Тип | ОПИСАНИЕ|
| -- | -- | -- |
| `Score` | Вектор <xref:System.Single> | Оценки всех классов. Более высокое значение означает большую вероятность попадания в связанный класс. Если i-й элемент имеет самое большое значение, индекс прогнозируемой метки будет равен i. Обратите внимание, что индекс i отсчитывается от нуля. |
| `PredictedLabel` | Тип [key](xref:Microsoft.ML.Data.KeyDataViewType) | Индекс прогнозируемой метки. Если его значение равно i, фактическая метка будет i-й категорией во входном типе метки с ключевым значением. |

## <a name="regression"></a>Регрессия

[Задача контролируемого машинного обучения](glossary.md#supervised-machine-learning), которая прогнозирует значение метки по набору связанных компонентов. Метка здесь может принимать любое значение, а не просто выбирается из конечного набора значений, как в задачах классификации. Алгоритмы регрессии моделируют зависимость меток от связанных компонентов, чтобы определить закономерности изменения меток при разных значениях компонентов. На вход алгоритма регрессии подается набор примеров с метками известных значений. Результатом работы алгоритма регрессии является функция, которая умеет прогнозировать значения метки для любого нового набора входных компонентов. Вот несколько примеров для сценария регрессии:

* прогнозирование цен на дома по таким атрибутам, как количество комнат, расположение и размер;
* прогнозирование будущей цены акций на основе исторических данных и текущих тенденций рынка;
* прогнозирование продаж товара в зависимости от рекламного бюджета.

### <a name="regression-trainers"></a>Алгоритмы обучения регрессии

Вы можете обучить модель регрессии, используя следующие алгоритмы:

* <xref:Microsoft.ML.Trainers.LbfgsPoissonRegressionTrainer>
* <xref:Microsoft.ML.Trainers.LightGbm.LightGbmRegressionTrainer>
* <xref:Microsoft.ML.Trainers.SdcaRegressionTrainer>
* <xref:Microsoft.ML.Trainers.OlsTrainer>
* <xref:Microsoft.ML.Trainers.OnlineGradientDescentTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.FastTreeRegressionTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.FastTreeTweedieTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.FastForestRegressionTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.GamRegressionTrainer>

### <a name="regression-inputs-and-outputs"></a>Входные и выходные данные регрессии

Входные данные столбца меток должны иметь тип <xref:System.Single>.

Алгоритмы обучения для этой задачи выводят приведенные ниже данные.

| Имя выходных данных | Тип | ОПИСАНИЕ|
| -- | -- | -- |
| `Score` | <xref:System.Single> | Необработанное оценка, спрогнозированная моделью. |

## <a name="clustering"></a>Кластеризация

[Задача неконтролируемого машинного обучения](glossary.md#unsupervised-machine-learning), которая группирует отдельные экземпляры данных в кластеры со сходными характеристиками. Кластеризацию можно также использовать для определения в наборе данных связей, которые невозможно логически отследить просмотром или наблюдением данных. Входные и выходные данные для алгоритма кластеризации зависят от выбранного метода. Вы можете выбрать подход на основе распространения, центроида, возможности подключения или плотности. ML.NET в настоящее время поддерживает только кластеризацию методом К-средних на основе центроида. Примеры сценариев для использования кластеризации:

* распределение посетителей гостиниц на сегменты, исходя из привычек и характеристик выбора гостиниц;
* определение сегментов и демографических характеристик для клиентов, чтобы создавать целевые рекламные кампании;
* определение категорий запасов по параметрам производства.

### <a name="clustering-trainer"></a>Алгоритм обучения кластеризации

Вы можете обучить модель кластеризации, используя следующие алгоритмы:

* <xref:Microsoft.ML.Trainers.KMeansTrainer>

### <a name="clustering-inputs-and-outputs"></a>Входные и выходные данные кластеризации

Входные данные функций должны иметь тип <xref:System.Single>. Метки не требуются.

Этот алгоритм обучения выводит приведенные ниже данные.

| Имя выходных данных | Тип | ОПИСАНИЕ|
| -- | -- | -- |
| `Score` | Вектор <xref:System.Single> | Расстояния от указанной точки данных до центроидов всех кластеров. |
| `PredictedLabel` | Тип [key](xref:Microsoft.ML.Data.KeyDataViewType) | Индекс ближайшего кластера, спрогнозированный моделью. |

## <a name="anomaly-detection"></a>Обнаружение аномалий

Эта задача создает модель обнаружения аномалий с помощью анализа главных компонентов (PCA). Обнаружение аномалий на основе PCA позволяет создавать модели в сценариях, где легко получить данные для обучения из одного класса, такого как допустимые транзакции, однако получить достаточную выборку аномальных значений затруднительно.

Общепринятый метод в машинном обучении, PCA, часто используется в разведочном анализе данных, так как он раскрывает внутреннюю структуру данных и объясняет их вариативность. PCA выполняется путем анализа данных с несколькими переменными. Он выполняет поиск корреляции между переменными и определяет сочетание значений, которые лучше всего фиксируют различия результатов. Эти объединенные значения компонентов используются для создания более компактных компонентов, называемых главными компонентами.

Обнаружение аномалий включает в себя ряд важных задач машинного обучения:

* Выявление потенциально мошеннических транзакций.
* Изучение шаблонов, которые указывают, что произошли сетевые атаки.
* Поиск аномальных кластеров пациентов.
* Проверка значений, введенных в систему.

Так как аномалии по определению довольно-таки редкие события, со сборкой репрезентативной выборки данных, используемых для моделирования, могут быть трудности. Алгоритмы, включенные в эту категорию, специально разработаны для решения основных проблем разработки и обучения моделей с использованием несбалансированных наборов данных.

### <a name="anomaly-detection-trainer"></a>Алгоритм обучения обнаружению аномалий

Вы можете обучить модель обнаружения аномалий, используя следующие алгоритмы:

* <xref:Microsoft.ML.Trainers.RandomizedPcaTrainer>

### <a name="anomaly-detection-inputs-and-outputs"></a>Входные и выходные данные обнаружения аномалий

Входные данные функций должны быть вектором <xref:System.Single> фиксированного размера.

Этот алгоритм обучения выводит приведенные ниже данные.

| Имя выходных данных | Тип | ОПИСАНИЕ|
| -- | -- | -- |
| `Score` | <xref:System.Single> | Неотрицательная неограниченная оценка, вычисленная моделью обнаружения аномалий |

## <a name="ranking"></a>Ранжирование

Задача ранжирования создает средство ранжирования на основе набора примеров с метками. Этот набор примеров состоит из групп экземпляров, которые могут быть оценены с заданными критериями. Метки ранжирования для каждого экземпляра — { 0, 1, 2, 3, 4 }.  Средство ранжирования обучается ранжировать новые группы экземпляров с неизвестными оценками для каждого экземпляра. Алгоритмы обучения ранжированию ML.NET основаны на [ранжировании машинного обучения](https://en.wikipedia.org/wiki/Learning_to_rank).

### <a name="ranking-training-algorithms"></a>Алгоритмы обучения ранжированию

Вы можете обучить модель ранжирования, используя следующие алгоритмы:

* <xref:Microsoft.ML.Trainers.LightGbm.LightGbmRankingTrainer>
* <xref:Microsoft.ML.Trainers.FastTree.FastTreeRankingTrainer>

### <a name="ranking-input-and-outputs"></a>Входные и выходные данные ранжирования

Входные данные метки должны иметь тип [key](xref:Microsoft.ML.Data.KeyDataViewType) или <xref:System.Single>. Значение метки определяет релевантность, где более высокие значения означают более высокую степень релевантности. Если метка имеет тип [key](xref:Microsoft.ML.Data.KeyDataViewType), индексом ключа будет значение релевантности, где наименьший индекс является минимально релевантным. Если метка имеет тип <xref:System.Single>, более высокие значения означают более высокую степень релевантности.

Данные должны быть вектором <xref:System.Single> фиксированного размера, а входной столбец группы строк должен иметь тип [key](xref:Microsoft.ML.Data.KeyDataViewType).

Этот алгоритм обучения выводит приведенные ниже данные.

| Имя выходных данных | Тип | ОПИСАНИЕ|
| -- | -- | -- |
| `Score` | <xref:System.Single> | Неограниченная оценка, вычисленная моделью для определения прогноза |

## <a name="recommendation"></a>Рекомендация

Задача рекомендации позволяет создать список рекомендуемых продуктов или служб. ML.NET использует [факторизацию матрицы (MF)](https://en.wikipedia.org/wiki/Matrix_factorization_%28recommender_systems%29), алгоритм [совместной фильтрации](https://en.wikipedia.org/wiki/Collaborative_filtering) для рекомендаций при наличии исторических данных о рейтинге продуктов в вашем каталоге. Например, у вас есть исторические данные о рейтинге фильмов для ваших пользователей, и вы хотите рекомендовать другие фильмы, которые они, вероятно, просмотрят следующими.

### <a name="recommendation-training-algorithms"></a>Алгоритмы обучения рекомендациям

Вы можете обучить модель рекомендаций, используя следующий алгоритм:

* <xref:Microsoft.ML.Trainers.MatrixFactorizationTrainer>
