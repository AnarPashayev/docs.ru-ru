---
title: Анализ диапазонов данных с помощью индексов и диапазонов
description: В этом учебнике подробно рассказывается, как анализировать данные с помощью индексов и диапазонов и, таким образом, изучать срезы последовательного набора данных.
ms.date: 04/19/2019
ms.custom: mvc
ms.openlocfilehash: 64fae4581e265d4f70b8356d5c651b4fdaca3fe9
ms.sourcegitcommit: dd3b897feb5c4ac39732bb165848e37a344b0765
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/25/2019
ms.locfileid: "64431491"
---
# <a name="indices-and-ranges"></a>Индексы и диапазоны

Диапазоны и индексы обеспечивают лаконичный синтаксис для доступа к отдельным элементам или диапазонам в <xref:System.Array>, <xref:System.Span%601> или <xref:System.ReadOnlySpan%601>. Благодаря этим функциям синтаксис для доступа к отдельным элементам или диапазонам элементов в последовательности становится более четким и понятным.

В этом руководстве вы узнаете, как:

> [!div class="checklist"]
> * Использовать этот синтаксис для диапазонов в последовательности.
> * Проектировать начало и конец каждой последовательности.
> * Составлять сценарии для типов <xref:System.Index> и <xref:System.Range>.

## <a name="language-support-for-indices-and-ranges"></a>Поддержка языков для индексов и диапазонов

Можно указать индекс **с конца**, вставив перед индексом символ `^`. Индексирование с конца начинается с правила, которое `0..^0` указывает весь диапазон. Чтобы перечислить полный массив, начните *с первого элемента* и продолжайте, пока не пройдете *последний элемент*. Можно рассмотреть поведение метода `MoveNext` перечислителя: он возвращает значение false по прохождении последнего элемента перечисления. Индекс `^0` означает "конец", `array[array.Length]` или индекс, который следует за последним элементом. Вы знакомы с выражением `array[2]`, то есть элемент "2 с самого начала". Теперь выражение `array[^2]` означает элемент "2 с конца". 

Вы можете указать **диапазон** с помощью **оператора диапазона**: `..`. Например, оператор `0..^0` указывает весь диапазон массива: 0 от начала до, но не включая 0 с конца. Любой операнд может использовать элемент "от начала" или "с конца". Кроме того, можно опустить один из операндов. По умолчанию оператор `0` используется для начального индекса, а `^0` — для конечного индекса.

```csharp-interactive
string[] words = new string[]
{
                // index from start    index from end
    "The",      // 0                   ^9
    "quick",    // 1                   ^8
    "brown",    // 2                   ^7
    "fox",      // 3                   ^6
    "jumped",   // 4                   ^5
    "over",     // 5                   ^4
    "the",      // 6                   ^3
    "lazy",     // 7                   ^2
    "dog"       // 8                   ^1
};              // 9 (or words.Length) ^0
```

Индекс каждого элемента вводит понятие "от начала" и "от конца", и диапазоны указаны без учета конца диапазона. "Начало" всего массива является первым элементом. "Конец" всего массива следует *после* последнего элемента.

Последнее слово можно получить с помощью индекса `^1`. Добавьте следующий код после инициализации:

[!code-csharp[LastIndex](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_LastIndex)]

Следующий код создает поддиапазон со словами "quick", "brown" и "fox". Он включает в себя элементы от `words[1]` до `words[3]`. Элемент `words[4]` в диапазон не входит. Добавьте в тот же метод указанный ниже код. Скопируйте и вставьте этот код в нижней части интерактивного окна.

[!code-csharp[Range](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_Range)]

Следующий код создает поддиапазон со словами "lazy" и "dog". Он включает элементы `words[^2]` и `words[^1]`. Конечный индекс `words[^0]` не включен. Добавьте также следующий код:

[!code-csharp[LastRange](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_LastRange)]

В следующих примерах создаются диапазоны, которые должны быть открыты для начала, конца или в обоих случаях:

[!code-csharp[PartialRange](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_PartialRanges)]

Диапазоны или индексы можно также объявлять как переменные. Впоследствии такую переменную можно использовать внутри символов `[` и `]`:

[!code-csharp[IndexRangeTypes](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_RangeIndexTypes)]

В предыдущих примерах представлены два проектных решения, которые требуют более подробного объяснения:

- Диапазоны *исключительны*, т. е. элемент с последним индексом в диапазон не входит.
- Индекс `^0` — это *конец* коллекции, а не *последний элемент* в коллекции.

Следующий пример демонстрирует многие возможные причины для таких решений. Измените `x`, `y` и `z` и опробуйте различные комбинации. Поэкспериментируйте со значениями, у которых `x` меньше `y`, а `y` меньше, чем `z` для допустимых сочетаний. Добавьте в новый метод приведенный ниже код. Опробуйте различные комбинации:

[!code-csharp[SemanticsExamples](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_Semantics)]

## <a name="scenarios-for-indices-and-ranges"></a>Сценарии для индексов и диапазонов

Часто для анализа отдельного поддиапазона последовательности используются диапазоны и индексы. В новом синтаксисе легче понять, о каком поддиапазоне идет речь. Локальная функция `MovingAverage` принимает <xref:System.Range> в качестве аргумента. После этого метод перечисляет только это диапазон и вычисляет минимальное, максимальное и среднее значение. Попробуйте добавить в свой проект следующий код:

[!code-csharp[MovingAverages](~/samples/csharp/tutorials/RangesIndexes/IndicesAndRanges.cs#IndicesAndRanges_MovingAverage)]

Готовый код можно загрузить из репозитория [dotnet/samples](https://github.com/dotnet/samples/tree/master/csharp/tutorials/RangesIndexes).
