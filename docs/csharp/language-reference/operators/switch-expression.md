---
title: Выражение switch в справочнике по C#
description: Узнайте, как использовать выражение switch в C# для сопоставления шаблонов и других самоанализов данных.
ms.date: 03/19/2020
ms.openlocfilehash: 2249afc1ff1cc81e9ad423d910ebb95df8c787d4
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2020
ms.locfileid: "87916655"
---
# <a name="switch-expression-c-reference"></a>Выражение switch (справочник по C#)

В этой статье рассматривается выражение `switch`, представленное в C# 8.0. Дополнительные сведения об инструкции `switch` см. в статье [`switch`switch (справочник по C#)](../keywords/switch.md) в разделе [Ключевые слова C#](../keywords/index.md).

## <a name="basic-example"></a>Простой пример

Выражение `switch` предоставляет в контексте выражения семантику, аналогичную `switch`. Оно предоставляет краткий синтаксис, когда ветви switch возвращают значение. В следующем примере показана структура выражения switch. Оно преобразует значения из `enum`, представляя визуальные направления в интерактивном сопоставлении с соответствующим направлением кардинала:

:::code language="csharp" source="snippets/shared/SwitchExpressions.cs" id="SnippetBasicStructure":::

В предыдущем примере показаны основные элементы выражения switch:

- *Выражение диапазона*. В предыдущем примере в качестве выражения диапазона используется переменная `direction`.
- *Ветви выражения switch*. Каждая ветвь выражения switch содержит *шаблон*, необязательное *условие регистра*, маркер `=>` и *выражение*.

Результатом *выражения switch* является значение выражения первой *ветви выражения switch*, чей *шаблон* совпадает с *выражением диапазона*, а *условие регистра*, если таковое есть, принимает `true`. *Выражение* справа от маркера `=>` не может быть оператором выражения.

*Ветви выражения switch* оцениваются в текстовом порядке. Если выбрать нижнюю *ветвь выражения switch* не удается,поскольку верхняя *ветвь выражения switch* соответствует всем его значениям, компилятор выдает ошибку.

## <a name="patterns-and-case-guards"></a>Шаблоны и условия использования

В выражениях switch поддерживаются многие шаблоны. В предыдущем примере использовался *шаблон константы*. *Шаблон константы* сравнивает выражение диапазона со значением. Это значение должно быть константой времени компиляции. *Шаблон типа* сравнивает выражение диапазона с известным типом. В следующем примере из последовательности извлекается третий элемент. В нем используются различные методы, основанные на типе последовательности:

:::code language="csharp" source="snippets/shared/SwitchExpressions.cs" id="SnippetTypePattern":::

Шаблоны могут быть рекурсивными, где шаблон проверяет тип, и если этот тип соответствует, шаблон соответствует одному или нескольким значениям свойств в выражении диапазона. Для расширения предыдущего примера можно использовать рекурсивные шаблоны. Вы добавляете ветви выражения switch для массивов, которые содержат менее 3 элементов. Рекурсивные шаблоны показаны в примере ниже.

:::code language="csharp" source="snippets/shared/SwitchExpressions.cs" id="SnippetRecursivePattern":::

Рекурсивные шаблоны могут проверять свойства выражения диапазона, но не могут выполнять произвольный код. Чтобы обеспечить аналогичные проверки для других типов последовательностей, можно использовать *условие регистра* указанное в предложении `when`.

:::code language="csharp" source="snippets/shared/SwitchExpressions.cs" id="SnippetGuardCase":::

Наконец, для перехвата аргументов можно добавить шаблоны `_` и `null`, которые не обрабатываются ни одной ветвью выражения switch. Это делает выражения switch *исчерпывающими*, что означает, что будет обрабатываться любое возможное значение выражения диапазона. В следующем примере добавляются такие ветви выражения:

:::code language="csharp" source="snippets/shared/SwitchExpressions.cs" id="SnippetExhaustive":::

В предыдущем примере добавляется шаблон `null`, а шаблон типа `IEnumerable<T>` меняется на шаблон `_`. В качестве ветви выражения switch шаблон `null` содержит проверку значения null. Выражение для этой ветви создает исключение <xref:System.ArgumentNullException>. Шаблон `_` соответствует всем входным данным, которые не совпали с предыдущими ветвями. Он должен появиться после проверки `null`, иначе он будет совпадать с входными файлами `null`.

Дополнительные сведения см. в предложении языка C# для [рекурсивных шаблонов](~/_csharplang/proposals/csharp-8.0/patterns.md#switch-expression).

## <a name="see-also"></a>См. также

- [справочник по C#](../index.md)
- [Операторы и выражения C#](index.md)
- [Сопоставление шаблонов](../../pattern-matching.md)
