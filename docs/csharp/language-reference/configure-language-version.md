---
title: Управление версиями языка C# — руководство по C#
description: Дополнительные сведения о том, как версия языка C# определяется на основе вашего проекта и какие причины лежат в основе этого решения. Сведения о ручном переопределении значения по умолчанию.
ms.date: 02/21/2020
ms.openlocfilehash: 2be76fdac471a7175b661d896b0da2910b3609f3
ms.sourcegitcommit: 44a7cd8687f227fc6db3211ccf4783dc20235e51
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/26/2020
ms.locfileid: "77626768"
---
# <a name="c-language-versioning"></a>Управление версиями языка C#

Компилятор C# последней версии определяет версию языка по умолчанию на основе целевой платформы или платформ проекта. Visual Studio не предоставляет пользовательский интерфейс для изменения этого значения, но его можно изменить, отредактировав файл *CSPROJ*. Выбор значения по умолчанию гарантирует, что вы используете последнюю версию языка, совместимую с вашей целевой платформой. Вы получите преимущество в виде доступа к последним функциям языка, совместимым с целевым объектом проекта. Этот вариант по умолчанию также гарантирует, что вы не будете использовать язык, который требует такие типы или поведение во время выполнения, которые недоступны в целевой платформе. Выбор более новой версии языка, чем значение по умолчанию, может усложнить диагностику ошибок во время компиляции и выполнения.

C#8.0 (и более поздних версий) поддерживается только в .NET Core 3.x и более новых версиях. Для многих новых функций нужны функции среды выполнения и библиотеки, появившиеся в .NET Core 3. x:

- Для реализации члена интерфейса по умолчанию нужны новые функции среды CLR .NET Core 3.0.
- Для асинхронных потоков нужны новые типы <xref:System.IAsyncDisposable?displayProperty=nameWithType>, <xref:System.Collections.Generic.IAsyncEnumerable%601?displayProperty=nameWithType> и <xref:System.Collections.Generic.IAsyncEnumerator%601?displayProperty=nameWithType>.
- Для индексов и диапазонов нужны новые типы <xref:System.Index?displayProperty=nameWithType> и <xref:System.Range?displayProperty=nameWithType>.
- Ссылочные типы, допускающие значение NULL, используют несколько [атрибутов](../nullable-attributes.md) для предоставления улучшенных предупреждений. Эти атрибуты были добавлены в .NET Core 3.0. Другие целевые платформы не были помечены ни одним из этих атрибутов. Это означает, что предупреждения, допускающие значение NULL, могут неточно отражать потенциальные проблемы.

## <a name="defaults"></a>Значения по умолчанию

Компилятор определяет значение по умолчанию на основе следующих правил:

|Целевая платформа|version|Версия языка C# по умолчанию|
|----------------|-------|---------------------------|
|.NET Core|3.x|C# 8.0|
|.NET Core|2.x|C# 7.3|
|.NET Standard|2.1|C# 8.0|
|.NET Standard|2.0|C# 7.3|
|.NET Standard|1.x|C# 7.3|
|.NET Framework|все|C# 7.3|

Если проект предназначен для платформы в предварительной версии с поддержкой соответствующего языка в предварительной версии, будет использоваться язык, поддерживаемый в предварительной версии. Вы можете использовать новейшие возможности в этой предварительной версии в любой среде, не затрагивая проекты, предназначенные для выпущенной версии .NET Core.

## <a name="override-a-default"></a>Переопределение значения по умолчанию

Если необходимо явно указать версию C#, это можно сделать несколькими способами:

- Вручную изменить [файл проекта](#edit-the-project-file).
- Задать версию языка [для нескольких проектов в подкаталоге](#configure-multiple-projects).
- настройка [параметра компилятора `-langversion`](compiler-options/langversion-compiler-option.md).

### <a name="edit-the-project-file"></a>Изменение файла проекта

Версию языка можно задать в файле проекта. Например, если доступ к предварительной версии функций должен быть задан явным образом, можно добавить следующий элемент:

```xml
<PropertyGroup>
   <LangVersion>preview</LangVersion>
</PropertyGroup>
```

Значение `preview` использует последнюю предварительную версию языка C#, которую поддерживает компилятор.

### <a name="configure-multiple-projects"></a>Настройка нескольких проектов

Чтобы настроить несколько проектов, вы можете создать файл **Directory.Build.props**, содержащий элемент `<LangVersion>`. Обычно это делается в каталоге решения. Добавьте следующий код в файл **Directory.Build.props** в каталоге решения:

```xml
<Project>
 <PropertyGroup>
   <LangVersion>preview</LangVersion>
 </PropertyGroup>
</Project>
```

Сборки во всех подкаталогах каталога, который содержит этот файл, будут использовать предварительную версию C#. Дополнительные сведения см. в статье о [настройке сборки](/visualstudio/msbuild/customize-your-build).

## <a name="c-language-version-reference"></a>Справочник по версиям языка C#

В следующей таблице показаны все текущие версии языка C#. Ваш компилятор может не распознавать все значения, если имеет более раннюю версию. При установке .NET Core 3.0 или более поздней версии вы получаете доступ ко всем значениям в таблице.

|Значение|Значение|
|------------|-------------|
|preview|Компилятор допускает использование любого допустимого синтаксиса языка из последней предварительной версии.|
|latest|Компилятор принимает синтаксис из последней выпущенной версии компилятора (включая дополнительный номер версии).|
|latestMajor|Компилятор принимает синтаксис из последней основной версии компилятора.|
|8.0|Компилятор принимает только синтаксис, включенный в спецификацию C# 8.0 или более ранней версии.|
|7.3|Компилятор принимает только синтаксис, включенный в спецификацию C# 7.3 или более ранней версии.|
|7.2|Компилятор принимает только синтаксис, включенный в спецификацию C# 7.2 или более ранней версии.|
|7.1|Компилятор принимает только синтаксис, включенный в спецификацию C# 7.1 или более ранней версии.|
|7|Компилятор принимает только синтаксис, включенный в спецификацию C# 7.0 или более ранней версии.|
|6|Компилятор принимает только синтаксис, включенный в спецификацию C# 6.0 или более ранней версии.|
|5|Компилятор принимает только синтаксис, включенный в спецификацию C# 5.0 или более ранней версии.|
|4|Компилятор принимает только синтаксис, включенный в спецификацию C# 4.0 или более ранней версии.|
|3|Компилятор принимает только синтаксис, включенный в спецификацию C# 3.0 или более ранней версии.|
|ISO-2|Компилятор принимает только синтаксис, включенный в спецификацию ISO/IEC 23270:2006 C# (2.0). |
|ISO-1|Компилятор принимает только синтаксис, включенный в спецификацию ISO/IEC 23270:2003 C# (1.0/1.2). |
