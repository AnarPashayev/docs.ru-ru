---
title: Справочник по C#. Предложение join
ms.date: 07/20/2015
f1_keywords:
- join
- join_CSharpKeyword
helpviewer_keywords:
- join clause [C#]
- join keyword [C#]
ms.assetid: 76e9df84-092c-41a6-9537-c3f1cbd7f0fb
ms.openlocfilehash: 8e52e9db241392b67818b7316767dd97bd38432a
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2020
ms.locfileid: "75713409"
---
# <a name="join-clause-c-reference"></a>Предложение join (Справочник по C#)

Предложение `join` удобно для связывания элементов из разных исходных последовательностей, не имеющих прямых связей в объектной модели. Единственное требование заключается в том, что у элементов в каждом источнике должно быть общим некоторое значение, которое может быть проверено на равенство. Например, у дистрибьютора может быть список поставщиков определенного продукта и список покупателей. Предложение `join` может использоваться, например, для создания списка поставщиков и покупателей этого продукта, которые находятся в одном заданном регионе.

Предложение `join` принимает две исходные последовательности в качестве входных данных. Элементы в каждой последовательности должны являться свойством (или содержать свойство), которое можно сравнить с соответствующим свойством в другой последовательности. Предложение `join` сравнивает указанные ключи на равенство с помощью специального ключевого слова `equals`. Все соединения, выполняемые предложением `join`, являются эквисоединениями. Форма выходных данных предложения `join` зависит от конкретного типа выполняемого соединения. Ниже приведены три наиболее распространенных типа соединения:

- внутреннее соединение,

- групповое соединение,

- Левое внешнее соединение

## <a name="inner-join"></a>внутреннее соединение,

В следующем примере показано простое внутреннее эквисоединение. По этому запросу создается прямая последовательность пар "название продукта/категория". Одна и та же строка, обозначающая категорию, будет присутствовать в нескольких элементах. Если для элемента из `categories` нет соответствующего элемента в `products`, эта категория не будет отображаться в результатах.

[!code-csharp[cscsrefQueryKeywords#24](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsCsrefQueryKeywords/CS/Join.cs#24)]

Дополнительные сведения см. в разделе [Выполнение внутренних соединений](../../linq/perform-inner-joins.md).

## <a name="group-join"></a>групповое соединение,

Предложение `join` с выражением `into` называется групповым соединением.

[!code-csharp[cscsrefQueryKeywords#25](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsCsrefQueryKeywords/CS/Join.cs#25)]

Групповое соединение создает иерархическую последовательность результатов, которая связывает элементы в левой исходной последовательности с одним или несколькими соответствующими элементами в правой исходной последовательности. Групповое соединение не имеет эквивалента в терминах реляционной базы данных. По сути это последовательность массивов объектов.

Если для элементов в левом источнике не удается найти элементы из правой исходной последовательности, предложение `join` создаст пустой массив для этого элемента. Таким образом, групповое соединение — это такое же внутреннее эквисоединение, за исключением того что последовательность результатов организуется в группы.

Если просто выбрать результаты группового соединения, можно получить доступ к элементам, но не определить ключ, по которому они совпадают. Таким образом, удобнее будет выбирать результаты группового соединения в новый тип, который также имеет имя ключа, как показано в предыдущем примере.

Кроме того, результаты группового соединения можно использовать как генераторы других вложенных запросов:

[!code-csharp[cscsrefQueryKeywords#26](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsCsrefQueryKeywords/CS/Join.cs#26)]

Дополнительные сведения см. в разделе [Выполнение групповых соединений](../../linq/perform-grouped-joins.md).

## <a name="left-outer-join"></a>Левое внешнее соединение

В левом внешнем соединении возвращаются все элементы в левой исходной последовательности, даже если в правой последовательности нет соответствующих элементов. Для выполнения левого внешнего соединения в LINQ используйте метод `DefaultIfEmpty` в сочетании с групповым соединением, чтобы указать правый элемент по умолчанию, создаваемый, если левый элемент не имеет совпадений. `null` можно использовать как значение по умолчанию для любого ссылочного типа, кроме того, можно указать определенный пользователем тип по умолчанию. В следующем примере показан определяемый пользователем тип по умолчанию:

[!code-csharp[cscsrefQueryKeywords#27](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsCsrefQueryKeywords/CS/Join.cs#27)]

Дополнительные сведения см. в разделе [Выполнение левых внешних соединений](../../linq/perform-left-outer-joins.md).

## <a name="the-equals-operator"></a>Оператор равенства

Предложение `join` выполняет эквисоединение. Другими словами совпадения могут основываться только на равенстве двух ключей. Другие типы сравнений, такие как "больше чем" или "не равно" не поддерживаются. Чтобы гарантировать, что все соединения являются эквисоединениями, предложение `join` использует ключевое слово `equals` оператора `==`. Ключевое слово `equals` может использоваться только в предложении `join`, и оно отличается от оператора `==` одной важной особенностью. В `equals` левый ключ использует внешнюю исходную последовательность, а правый ключ — внутренний источник. Внешний источник попадает в область только левой части `equals`, а внутренняя исходная последовательность — только в область правой части.

## <a name="non-equijoins"></a>Соединения, не являющиеся уравнивающими

Соединения, не являющиеся эквисоединениями, перекрестные соединения и другие настраиваемые операции соединения можно выполнять с помощью нескольких предложений `from` для независимого ввода новых последовательностей в запрос. Дополнительные сведения см. в разделе [Выполнение пользовательских операций соединения](../../linq/perform-custom-join-operations.md).

## <a name="joins-on-object-collections-vs-relational-tables"></a>Соединения коллекций объектов и реляционных таблиц

В выражении запроса LINQ операции соединения выполняются для коллекций объектов. Коллекции объектов нельзя "соединять" точно так же, как две реляционные таблицы. В LINQ явные предложения `join` требуются, только если две исходные последовательности не связаны каким-либо отношением. При работе с [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] таблицы внешних ключей представлены в объектной модели как свойства основной таблицы. Например, в базе данных Northwind таблица Customer имеет связь типа "внешний ключ" с таблицей Orders. При сопоставлении таблиц с объектной моделью класс Customer имеет свойство Orders, содержащий коллекцию заказов, связанных с клиентом. Фактически соединение уже выполнено автоматически.

Дополнительные сведения о создании запросов по связанным таблицам в контексте [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] см. в статье [Практическое руководство. Сопоставление связей баз данных](../../../framework/data/adonet/sql/linq/how-to-map-database-relationships.md).

## <a name="composite-keys"></a>Составные ключи

Равенство нескольких значений можно проверить с помощью составного ключа. Дополнительные сведения см. в разделе [Соединение с помощью составных ключей](../../linq/join-by-using-composite-keys.md). Составные ключи можно также использовать в предложении `group`.

## <a name="example"></a>Пример

В следующем примере сравниваются результаты внутреннего соединения, группового соединения и левого внешнего соединения для одних и тех же исходных данных с использованием одинаковых совпадающих ключей. В эти примеры для уточнения результатов в окне консоли добавлен дополнительный код.

[!code-csharp[cscsrefQueryKeywords#23](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsCsrefQueryKeywords/CS/Join.cs#23)]

## <a name="remarks"></a>Примечания

Предложение `join`, за которым не следует `into`, преобразуется в вызов метода <xref:System.Linq.Enumerable.Join%2A>. Предложение `join`, за которым следует `into`, преобразуется в вызов метода <xref:System.Linq.Enumerable.GroupJoin%2A>.

## <a name="see-also"></a>См. также

- [Ключевые слова запроса (LINQ)](query-keywords.md)
- [LINQ](../../linq/index.md)
- [Операции соединения](../../programming-guide/concepts/linq/join-operations.md)
- [предложение group](group-clause.md)
- [Выполнение левых внешних соединений](../../linq/perform-left-outer-joins.md)
- [Выполнение внутренних соединений](../../linq/perform-inner-joins.md)
- [Выполнение групповых соединений](../../linq/perform-grouped-joins.md)
- [Упорядочение результатов предложения соединения](../../linq/order-the-results-of-a-join-clause.md)
- [Соединение с помощью составных ключей](../../linq/join-by-using-composite-keys.md)
- [Совместимые системы баз данных для Visual Studio](/visualstudio/data-tools/installing-database-systems-tools-and-samples)
