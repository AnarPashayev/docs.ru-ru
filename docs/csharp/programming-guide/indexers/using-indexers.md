---
title: Руководство по программированию на C#. Использование индексаторов
ms.date: 10/03/2018
helpviewer_keywords:
- indexers [C#], about indexers
ms.assetid: df70e1a2-3ce3-4aba-ad80-4b2f3538699f
ms.openlocfilehash: 17162a0dc959a85c03a5cb5757e2b91fe10b0ab3
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2020
ms.locfileid: "77628167"
---
# <a name="using-indexers-c-programming-guide"></a>Использование индексаторов. Руководство по программированию на C#

Применение индексаторов упрощает работу с синтаксисом, позволяя создавать [классы](../../language-reference/keywords/class.md), [структуры](../../language-reference/builtin-types/struct.md) и [интерфейсы](../../language-reference/keywords/interface.md), к которым клиентские приложения могут обращаться так же, как к массиву. Индексаторы чаще всего реализуются в типах, предназначенных преимущественно для инкапсуляции внутренней коллекции или массива. Допустим, у вас есть класс `TempRecord`, представляющий журнал с 10 измерениями температуры по шкале Фаренгейта за период в 24 часа. Этот класс содержит массив `temps` типа `float[]` для хранения значений температуры. Реализация индексатора в этом классе позволит клиентам получать доступ к значениям температуры в экземпляре `TempRecord`, используя `float temp = tr[4]` вместо `float temp = tr.temps[4]`. Это позволяет не только упростить синтаксис клиентских приложений, но и облегчить понимание кода класса и его предназначения другими разработчиками.  
  
Чтобы объявить индексатор для класса или структуры, используйте ключевое слово [this](../../language-reference/keywords/this.md), как в следующем примере:

```csharp
public int this[int index]    // Indexer declaration  
{  
    // get and set accessors  
}  
```

## <a name="remarks"></a>Remarks

Тип индексатора и типы его параметров должны иметь по крайней мере такой же уровень доступности, как и сам индексатор. Дополнительные сведения об уровнях доступа см. в разделе [Модификаторы доступа](../../language-reference/keywords/access-modifiers.md).  
  
 Дополнительные сведения об использовании индексаторов с интерфейсом см. в разделе [Индексаторы интерфейса](./indexers-in-interfaces.md).  
  
 Сигнатура индексатора определяет число и типы его формальных параметров. В ней не указываются тип индексатора или имена его формальных параметров. Если для одного класса объявляется несколько индексаторов, они должны иметь разные сигнатуры.  
  
 Значение индексатора не классифицируется как переменная и, соответственно, не может передаваться в качестве параметра [ref](../../language-reference/keywords/ref.md) или [out](../../language-reference/keywords/out-parameter-modifier.md).  
  
 Чтобы присвоить индексатору имя, которое можно использовать в других языках, используйте <xref:System.Runtime.CompilerServices.IndexerNameAttribute?displayProperty=nameWithType>, как показано в этом примере:  

```csharp
[System.Runtime.CompilerServices.IndexerName("TheItem")]  
public int this[int index]   // Indexer declaration  
{
    // get and set accessors  
}  
```

Этот индексатор будет иметь имя `TheItem`. Без атрибута имени по умолчанию будет использоваться имя `Item`.  
  
## <a name="example-1"></a>Пример 1  
  
В следующем примере показано, как объявить частное поле массива `temps` и индексатор. Индексатор обеспечивает прямой доступ к экземпляру `tempRecord[i]`. Вместо использования индексатора можно объявить массив как элемент [public](../../language-reference/keywords/public.md) и осуществлять доступ к его элементам напрямую (`tempRecord.temps[i]`).  
  
 Обратите внимание, что при определении прав доступа индексатора, например в инструкции `Console.Write`, вызывается метод доступа [get](../../language-reference/keywords/get.md). Таким образом, если метод доступа `get` отсутствует, возникает ошибка времени компиляции.  
  
 [!code-csharp[csProgGuideIndexers#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideIndexers/CS/Indexers.cs#1)]  
  
## <a name="indexing-using-other-values"></a>Индексирование с использованием других значений

В C# тип параметра индексатора не ограничивается целочисленными значениями. Например, в качестве индексатора могут использоваться строки. Такой индексатор можно реализовать путем поиска строки в коллекции с возвратом соответствующего значения. Поскольку методы доступа можно перегружать, строковые и целочисленные версии могут сосуществовать.  
  
## <a name="example-2"></a>Пример 2  
  
Этот пример объявляет класс, который хранит названия дней недели. Метод доступа `get` принимает название дня в виде строкового значения и возвращает соответствующее целое число. Например, для Sunday возвращается значение 0, для Monday — 1 и т. д.  
  
 [!code-csharp[csProgGuideIndexers#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideIndexers/CS/Indexers.cs#2)]  
  
## <a name="robust-programming"></a>Отказоустойчивость

 Повысить безопасность и надежность индексаторов можно двумя способами:  
  
- Реализуйте стратегию обработки ошибок, предусматривающую действия в ситуациях, когда из клиентского кода передается недопустимое значение индекса. В первом примере из этого раздела класс TempRecord содержит свойство Length, с помощью которого клиентский код проверяет введенное значение, прежде чем передать его в индексатор. Кроме того, код обработки ошибок можно поместить в сам индексатор. Не забудьте задокументировать исключения, которые будут вызываться в методе доступа индексатора, для других пользователей.  
  
- Настройте максимально ограничивающие уровни доступа для методов доступа [get](../../language-reference/keywords/get.md) и [set](../../language-reference/keywords/set.md). Особенно важно сделать это для метода доступа `set`. Дополнительные сведения см. в разделе [Доступность методов доступа](../classes-and-structs/restricting-accessor-accessibility.md).  
  
## <a name="see-also"></a>См. также раздел

- [Руководство по программированию на C#](../index.md)
- [Индексаторы](./index.md)
- [Свойства](../classes-and-structs/properties.md)
