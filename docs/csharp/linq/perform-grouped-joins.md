---
title: Выполнение групповых соединений (LINQ в C#)
description: Узнайте, как выполнять групповые соединения с помощью LINQ в C#.
ms.date: 04/22/2020
ms.assetid: 9667daf9-a5fd-4b43-a5c4-a9c2b744000e
ms.openlocfilehash: 6411479c5fe6cb0ee79a0cd3df6de2f4d42c26a2
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/15/2020
ms.locfileid: "90542813"
---
# <a name="perform-grouped-joins"></a>Выполнение групповых соединений

Групповое соединение можно использовать для создания иерархических структур данных. Каждый элемент из первой коллекции группируется с набором соответствующих элементов из второй коллекции.

Например, класс или таблица реляционной базы данных под названием `Student` может содержать два поля: `Id` и `Name`. Второй класс или таблица реляционной базы данных под названием `Course` может содержать два поля: `StudentId` и `CourseTitle`. Групповое соединение этих двух источников данных, основанное на сравнении `Student.Id` и `Course.StudentId`, приведет к группировке каждого объекта `Student` с коллекцией объектов `Course` (которая может быть пустой).

> [!NOTE]
> Каждый элемент первой коллекции отображается в результирующем наборе группового соединения вне зависимости от того, найдены ли соответствующие ему элементы во второй коллекции. В случае, если такие элементы не найдены, последовательность соответствующих элементов будет пуста. Селектор результата имеет доступ к каждому элементу первой коллекции. При этом следует учесть отличие от селектора результата в негрупповом соединении: в этом случае селектор не имеет доступа к элементам из первой коллекции, для которых нет совпадений во второй коллекции.

> [!WARNING]
> Метод <xref:System.Linq.Enumerable.GroupJoin%2A?displayProperty=nameWithType> не имеет прямого эквивалента в традиционных терминах реляционных баз данных. Однако он реализует расширенный набор внутренних соединений и левых внешних соединений. Обе эти операции можно записать с точки зрения группового соединения. Дополнительные сведения см. в статье [Операции соединения](../programming-guide/concepts/linq/join-operations.md) и в разделе об [операторе GroupJoin](/ef/core/querying/complex-query-operators#groupjoin).

В первом примере этой статьи показано, как выполнить групповое соединение. Во втором примере — как использовать групповое соединение для создания XML-элементов.

## <a name="example---group-join"></a>Пример группового соединения

В приведенном ниже примере выполняется групповое соединение объектов типа `Person` и `Pet` на основе сравнения `Person` свойства `Pet.Owner`. В отличие от негруппового соединения, в котором создается пара элементов для каждого точного совпадения, групповое соединение создает один результирующий объект для каждого элемента первой коллекции, то есть объекта `Person` в данном примере. Соответствующие элементы из второй коллекции (в данном примере — объекты `Pet`) группируются в коллекцию. Наконец, результирующая функция селектора создает для каждого совпадения анонимный тип, состоящий из `Person.FirstName` и коллекции объектов `Pet`.

[!code-csharp[CsLINQProgJoining#5](~/samples/snippets/csharp/concepts/linq/how-to-perform-grouped-joins_1.cs)]

## <a name="example---group-join-to-create-xml"></a>Пример группового соединения для создания XML

Групповые соединения идеально подходят для создания XML с помощью LINQ to XML. Приведенный ниже пример аналогичен предыдущему за исключением того, что вместо создания анонимных типов результирующая функция селектора создает XML-элементы, представляющие соединенные объекты.

[!code-csharp[CsLINQProgJoining#6](~/samples/snippets/csharp/concepts/linq/how-to-perform-grouped-joins_2.cs)]

## <a name="see-also"></a>См. также

- <xref:System.Linq.Enumerable.Join%2A>
- <xref:System.Linq.Enumerable.GroupJoin%2A>
- [Выполнение внутренних соединений](perform-inner-joins.md)
- [Выполнение левых внешних соединений](perform-left-outer-joins.md)
- [Анонимные типы](../programming-guide/classes-and-structs/anonymous-types.md)
