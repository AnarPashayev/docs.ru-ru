---
title: Матричное представление преобразований
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- composite transformations
- transformations [Windows Forms], linear
- matrices
- translations in matrix representation
- transformations [Windows Forms], composite
- vectors
- linear transformations
- transformations [Windows Forms], matrix representation of
- transformations [Windows Forms], translation
- affine transformations
ms.assetid: 0659fe00-9e0c-41c4-9118-016f2404c905
ms.openlocfilehash: 24da407de24a924a68466e4301cc3f4a74cb2e94
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2019
ms.locfileid: "70044248"
---
# <a name="matrix-representation-of-transformations"></a>Матричное представление преобразований
Матрица размером m × n представляет собой набор чисел, упорядоченных по m строкам и n столбцам. На следующем рисунке показаны несколько матриц.  
  
 ![Преобразования](./media/aboutgdip05-art04.gif "AboutGdip05_art04")  
  
 Можно добавить две матрицы одного размера, добавив отдельные элементы. На следующем рисунке показаны два примера добавления матрицы.  
  
 ![Преобразования](./media/aboutgdip05-art05.gif "AboutGdip05_art05")  
  
 Матрицу размером m × n можно умножить на матрицу n × p, а результатом будет матрица m × p. Число столбцов в первой матрице должно совпадать с количеством строк во второй матрице. Например, матрицу размером 4 × 2 можно умножить на матрицу размером 2 × 3, чтобы создать матрицу размером 4 × 3.  
  
 Точки в плоскости, а также строки и столбцы матрицы можно рассматривать как векторы. Например, (2, 5) — это вектор с двумя компонентами, а (3, 7, 1) — вектор с тремя компонентами. Скалярное произведение двух векторов определяется следующим образом:  
  
 (a, б) • (c, d) = AC + BD  
  
 (a, b, c) • (d, e, f) = AD + быть + CF  
  
 Например, точка произведения (2, 3) и (5, 4) имеет значение (2) (5) + (3) (4) = 22. Скалярное произведение (2, 5, 1) и (4, 3, 1) равно (2) (4) + (5) (3) + (1) (1) = 24. Обратите внимание, что скалярное произведение двух векторов является числом, а не другим вектором. Также обратите внимание, что можно вычислить значение с точкой, только если два вектора имеют одинаковое число компонентов.  
  
 Пусть A (i, j) является записью в матрице A в i-ой строке и столбце ЖС. Например, A (3, 2) — это запись в матрице A в третьей строке и втором столбце. Предположим, что A, B и C являются матрицами, а AB = C. Записи в языке C рассчитываются следующим образом:  
  
 C (i, j) = (строка i из A) • (столбец j из B)  
  
 На следующем рисунке показано несколько примеров перемножения матриц.  
  
 ![Преобразования](./media/aboutgdip05-art06.gif "AboutGdip05_art06")  
  
 Если вы считаете, что точка в плоскости является матрицей размером 1 × 2, эту точку можно преобразовать, умножив ее на матрицу размером 2 × 2. На следующем рисунке показано несколько преобразований, примененных к точке (2, 1).  
  
 ![Преобразования](./media/aboutgdip05-art07.gif "AboutGdip05_art07")  
  
 Все преобразования, показанные на предыдущем рисунке, являются линейными преобразованиями. Некоторые другие преобразования, такие как перевод, не являются линейными и не могут быть выражены умножением матрицы 2 × 2. Предположим, что вы хотите начать с точки (2, 1), повернуть ее 90 градусов, перевести 3 единицы в направлении x и перевести 4 единицы в направлении по оси y. Это можно сделать с помощью умножения матрицы, за которым следует Добавление матрицы.  
  
 ![Преобразования](./media/aboutgdip05-art08.gif "AboutGdip05_art08")  
  
 Линейное преобразование (умножение матрицы 2 × 2), за которым следует перевод (сложение матрицы размером 1 × 2), называется аффинное преобразованием. Альтернатива хранению аффинных преобразований в паре матриц (одна для линейной части и другая для перевода) заключается в хранении всего преобразования в матрице размером 3 × 3. Чтобы сделать эту работу, точка на плоскости должна храниться в матрице размером 1 × 3 с фиктивной третьей координатой. Обычная методика — сделать все 3 Координаты равными 1. Например, точка (2, 1) представлена матрицей [2 1 1]. На следующем рисунке показано аффинное преобразование (поворот 90 градусов; сдвиг на три единицы в направлении по оси x, 4 единицы в направлении оси y), выраженный в виде умножения на одну матрицу размером 3 × 3.  
  
 ![Преобразования](./media/aboutgdip05-art09.gif "AboutGdip05_art09")  
  
 В предыдущем примере точка (2, 1) сопоставляется с точкой (2, 6). Обратите внимание, что третий столбец матрицы размером 3 × 3 содержит числа 0, 0, 1. Это всегда будет иметь место для матрицы аффинного преобразования, 3 × 3. Важные числа — это шесть чисел в столбцах 1 и 2. Верхняя левая часть матрицы 2 × 2 представляет линейную часть преобразования, а первые две записи в третьей строке представляют перевод.  
  
 ![Преобразования](./media/aboutgdip05-art10.gif "AboutGdip05_art10")  
  
 В GDI+ можно сохранить аффинное преобразование в <xref:System.Drawing.Drawing2D.Matrix> объекте. Поскольку третий столбец матрицы, представляющий аффинное преобразование, всегда имеет значение (0, 0, 1), при создании <xref:System.Drawing.Drawing2D.Matrix> объекта в первых двух столбцах указывается только шесть чисел. Оператор `Matrix myMatrix = new Matrix(0, 1, -1, 0, 3, 4)` конструирует матрицу, показанную на предыдущем рисунке.  
  
## <a name="composite-transformations"></a>Составные преобразования  
 Составное преобразование — это последовательность преобразований, в одну за которой следуют другие. Рассмотрим матрицы и преобразования в следующем списке:  
  
|||  
|-|-|  
|Матрица A|Поворот на 90 градусов|  
|Матрица B|Масштабирование по коэффициенту 2 в направлении по оси x|  
|Матрица C|Переводить 3 единицы по оси y|  
  
 Если начать с точки (2, 1), представленной матрицей [2 1 1], и умножить ее на, то B, затем на C, точка (2, 1) пройдет три преобразования в указанном порядке.  
  
 [2 1 1] ABC = [-2 5 1]  
  
 Вместо того чтобы хранить три части составного преобразования в трех отдельных матрицах, можно умножить, B и C, чтобы получить одну матрицу размером 3 × 3, которая хранит все составное преобразование. Предположим, ABC = D. Затем точка, умноженная на D, дает тот же результат, что и точка, умноженная на, а затем на B, а затем на C.  
  
 [2 1 1] D = [-2 5 1]  
  
 На следующем рисунке показаны матрицы A, B, C и D.  
  
 ![Преобразования](./media/aboutgdip05-art12.gif "AboutGdip05_art12")  
  
 Тот факт, что матрица составного преобразования может быть сформирована путем умножения единичных матриц преобразования, означает, что любая последовательность аффинных преобразований может храниться в одном <xref:System.Drawing.Drawing2D.Matrix> объекте.  
  
> [!CAUTION]
> Порядок составного преобразования важен. Как правило, поворот, масштабирование, преобразование не не отличается от масштабирования, затем поворота и преобразования. Аналогично, важен порядок умножения матриц. Как правило, ABC не совпадает с БПЗ.  
  
 <xref:System.Drawing.Drawing2D.Matrix.RotateAt%2A> <xref:System.Drawing.Drawing2D.Matrix.Translate%2A> <xref:System.Drawing.Drawing2D.Matrix.Scale%2A> <xref:System.Drawing.Drawing2D.Matrix.Multiply%2A> <xref:System.Drawing.Drawing2D.Matrix.Shear%2A> <xref:System.Drawing.Drawing2D.Matrix.Rotate%2A>Класс предоставляет несколько методов для создания составного преобразования:,,,, и. <xref:System.Drawing.Drawing2D.Matrix> В следующем примере создается матрица составного преобразования, которая сначала поворачивает 30 градусов, затем масштабируется по коэффициенту 2 в направлении по оси y, а затем преобразует 5 единиц в направлении по оси x:  
  
 [!code-csharp[System.Drawing.CoordinateSystems#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.CoordinateSystems/CS/Class1.cs#11)]
 [!code-vb[System.Drawing.CoordinateSystems#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.CoordinateSystems/VB/Class1.vb#11)]  
  
 На следующем рисунке показана матрица.  
  
 ![Преобразования](./media/aboutgdip05-art13.gif "AboutGdip05_art13")  
  
## <a name="see-also"></a>См. также

- [Системы координат и преобразования](coordinate-systems-and-transformations.md)
- [Использование преобразований в управляемом GDI+](using-transformations-in-managed-gdi.md)
