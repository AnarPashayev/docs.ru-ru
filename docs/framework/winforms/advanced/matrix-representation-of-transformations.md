---
title: Матричное представление преобразований
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- composite transformations
- transformations [Windows Forms], linear
- matrices
- translations in matrix representation
- transformations [Windows Forms], composite
- vectors
- linear transformations
- transformations [Windows Forms], matrix representation of
- transformations [Windows Forms], translation
- affine transformations
ms.assetid: 0659fe00-9e0c-41c4-9118-016f2404c905
ms.openlocfilehash: ceaad7b4bb5a70a890d261e39bc608becb388c17
ms.sourcegitcommit: b1cfd260928d464d91e20121f9bdba7611c94d71
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2019
ms.locfileid: "67505639"
---
# <a name="matrix-representation-of-transformations"></a><span data-ttu-id="a791b-102">Матричное представление преобразований</span><span class="sxs-lookup"><span data-stu-id="a791b-102">Matrix Representation of Transformations</span></span>
<span data-ttu-id="a791b-103">Матрица m n × — это набор чисел, расположенных в строках m и n столбцах.</span><span class="sxs-lookup"><span data-stu-id="a791b-103">An m×n matrix is a set of numbers arranged in m rows and n columns.</span></span> <span data-ttu-id="a791b-104">Ниже показано несколько матрицы.</span><span class="sxs-lookup"><span data-stu-id="a791b-104">The following illustration shows several matrices.</span></span>  
  
 <span data-ttu-id="a791b-105">![Преобразования](./media/aboutgdip05-art04.gif "AboutGdip05_art04")</span><span class="sxs-lookup"><span data-stu-id="a791b-105">![Transformations](./media/aboutgdip05-art04.gif "AboutGdip05_art04")</span></span>  
  
 <span data-ttu-id="a791b-106">Можно добавить двух матриц такого же размера, путем добавления отдельных элементов.</span><span class="sxs-lookup"><span data-stu-id="a791b-106">You can add two matrices of the same size by adding individual elements.</span></span> <span data-ttu-id="a791b-107">Ниже показаны два примера сложения матриц.</span><span class="sxs-lookup"><span data-stu-id="a791b-107">The following illustration shows two examples of matrix addition.</span></span>  
  
 <span data-ttu-id="a791b-108">![Преобразования](./media/aboutgdip05-art05.gif "AboutGdip05_art05")</span><span class="sxs-lookup"><span data-stu-id="a791b-108">![Transformations](./media/aboutgdip05-art05.gif "AboutGdip05_art05")</span></span>  
  
 <span data-ttu-id="a791b-109">Матрица m n × можно будет умножено на матрицу n × p, а результатом является матрица m × p.</span><span class="sxs-lookup"><span data-stu-id="a791b-109">An m×n matrix can be multiplied by an n×p matrix, and the result is an m×p matrix.</span></span> <span data-ttu-id="a791b-110">Число столбцов в первой матрице должен быть таким же, как количество строк в матрице второй.</span><span class="sxs-lookup"><span data-stu-id="a791b-110">The number of columns in the first matrix must be the same as the number of rows in the second matrix.</span></span> <span data-ttu-id="a791b-111">Например матрицу 4 × 2 умножается на 2 × 3 матрицу, чтобы создать матрицу 4 × 3.</span><span class="sxs-lookup"><span data-stu-id="a791b-111">For example, a 4×2 matrix can be multiplied by a 2×3 matrix to produce a 4×3 matrix.</span></span>  
  
 <span data-ttu-id="a791b-112">Точки на плоскости и строки и столбцы матрицы могут рассматриваться как векторы.</span><span class="sxs-lookup"><span data-stu-id="a791b-112">Points in the plane and rows and columns of a matrix can be thought of as vectors.</span></span> <span data-ttu-id="a791b-113">Например (2, 5) — это вектор с двумя компонентами и (3, 7, 1) представляет собой вектор с тремя компонентами.</span><span class="sxs-lookup"><span data-stu-id="a791b-113">For example, (2, 5) is a vector with two components, and (3, 7, 1) is a vector with three components.</span></span> <span data-ttu-id="a791b-114">Скалярное произведение двух векторов определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a791b-114">The dot product of two vectors is defined as follows:</span></span>  
  
 <span data-ttu-id="a791b-115">(a, b) • (c, d) = ac + bd</span><span class="sxs-lookup"><span data-stu-id="a791b-115">(a, b) • (c, d) = ac + bd</span></span>  
  
 <span data-ttu-id="a791b-116">(a, b, c) • (d, e, f) = ad + быть + cf</span><span class="sxs-lookup"><span data-stu-id="a791b-116">(a, b, c) • (d, e, f) = ad + be + cf</span></span>  
  
 <span data-ttu-id="a791b-117">Например, скалярное произведение (2, 3) и (5, 4) — (2)(5) + (3)(4) = 22.</span><span class="sxs-lookup"><span data-stu-id="a791b-117">For example, the dot product of (2, 3) and (5, 4) is (2)(5) + (3)(4) = 22.</span></span> <span data-ttu-id="a791b-118">Скалярное произведение (2, 5, 1) и (4, 3, 1) — (2)(4) + (5)(3) + (1)(1) = 24.</span><span class="sxs-lookup"><span data-stu-id="a791b-118">The dot product of (2, 5, 1) and (4, 3, 1) is (2)(4) + (5)(3) + (1)(1) = 24.</span></span> <span data-ttu-id="a791b-119">Обратите внимание, что скалярное произведение двух векторов является числом, не вектор.</span><span class="sxs-lookup"><span data-stu-id="a791b-119">Note that the dot product of two vectors is a number, not another vector.</span></span> <span data-ttu-id="a791b-120">Обратите внимание на то, что скалярное произведение можно вычислить только в том случае, если два вектора имеют одинаковый номер компонентов.</span><span class="sxs-lookup"><span data-stu-id="a791b-120">Also note that you can calculate the dot product only if the two vectors have the same number of components.</span></span>  
  
 <span data-ttu-id="a791b-121">A(i, j) быть ввода матрицы A i-ой строки и столбца ый.</span><span class="sxs-lookup"><span data-stu-id="a791b-121">Let A(i, j) be the entry in matrix A in the ith row and the jth column.</span></span> <span data-ttu-id="a791b-122">Например, объект (3, 2) — запись в матрице, А в третьей строке и столбце 2-й.</span><span class="sxs-lookup"><span data-stu-id="a791b-122">For example A(3, 2) is the entry in matrix A in the 3rd row and the 2nd column.</span></span> <span data-ttu-id="a791b-123">Предположим, что A, B и C, матрицы и AB = C. Операции C вычисляются следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a791b-123">Suppose A, B, and C are matrices, and AB = C. The entries of C are calculated as follows:</span></span>  
  
 <span data-ttu-id="a791b-124">C (i, j) = (строки i A) • (столбец j B)</span><span class="sxs-lookup"><span data-stu-id="a791b-124">C(i, j) = (row i of A) • (column j of B)</span></span>  
  
 <span data-ttu-id="a791b-125">Ниже показано несколько примеров перемножения матриц.</span><span class="sxs-lookup"><span data-stu-id="a791b-125">The following illustration shows several examples of matrix multiplication.</span></span>  
  
 <span data-ttu-id="a791b-126">![Преобразования](./media/aboutgdip05-art06.gif "AboutGdip05_art06")</span><span class="sxs-lookup"><span data-stu-id="a791b-126">![Transformations](./media/aboutgdip05-art06.gif "AboutGdip05_art06")</span></span>  
  
 <span data-ttu-id="a791b-127">Если вы считаете, что точки на плоскости как матрицу 1 × 2, можно преобразовать эту точку путем его умножения матрицу 2 × 2.</span><span class="sxs-lookup"><span data-stu-id="a791b-127">If you think of a point in a plane as a 1×2 matrix, you can transform that point by multiplying it by a 2×2 matrix.</span></span> <span data-ttu-id="a791b-128">Ниже показано несколько преобразования, примененные к точке (2, 1).</span><span class="sxs-lookup"><span data-stu-id="a791b-128">The following illustration shows several transformations applied to the point (2, 1).</span></span>  
  
 <span data-ttu-id="a791b-129">![Преобразования](./media/aboutgdip05-art07.gif "AboutGdip05_art07")</span><span class="sxs-lookup"><span data-stu-id="a791b-129">![Transformations](./media/aboutgdip05-art07.gif "AboutGdip05_art07")</span></span>  
  
 <span data-ttu-id="a791b-130">Все преобразования, показанные на рисунке выше, являются линейными преобразованиями.</span><span class="sxs-lookup"><span data-stu-id="a791b-130">All of the transformations shown in the preceding figure are linear transformations.</span></span> <span data-ttu-id="a791b-131">Некоторые другие преобразования, такие как трансляции, не являются линейными и не может быть выражен как умножение на матрицу размером 2 × 2.</span><span class="sxs-lookup"><span data-stu-id="a791b-131">Certain other transformations, such as translation, are not linear, and cannot be expressed as multiplication by a 2×2 matrix.</span></span> <span data-ttu-id="a791b-132">Предположим, что нужно для начала точка (2, 1), повернуть на 90 градусов, сдвинуть на 3 единицы по оси x и 4 единицы по оси y.</span><span class="sxs-lookup"><span data-stu-id="a791b-132">Suppose you want to start with the point (2, 1), rotate it 90 degrees, translate it 3 units in the x direction, and translate it 4 units in the y direction.</span></span> <span data-ttu-id="a791b-133">Это можно сделать с помощью выполнения умножения и сложения матриц.</span><span class="sxs-lookup"><span data-stu-id="a791b-133">You can accomplish this by using a matrix multiplication followed by a matrix addition.</span></span>  
  
 <span data-ttu-id="a791b-134">![Преобразования](./media/aboutgdip05-art08.gif "AboutGdip05_art08")</span><span class="sxs-lookup"><span data-stu-id="a791b-134">![Transformations](./media/aboutgdip05-art08.gif "AboutGdip05_art08")</span></span>  
  
 <span data-ttu-id="a791b-135">Линейное преобразование (умножение на матрицу 2 × 2) и сдвиг (Добавление матрицу 1 × 2) вызывается аффинные преобразования.</span><span class="sxs-lookup"><span data-stu-id="a791b-135">A linear transformation (multiplication by a 2×2 matrix) followed by a translation (addition of a 1×2 matrix) is called an affine transformation.</span></span> <span data-ttu-id="a791b-136">Для хранения всего преобразования в матрицу 3 × 3 является альтернативой аффинные преобразования в пару матриц (одна для линейной) и один для перевода.</span><span class="sxs-lookup"><span data-stu-id="a791b-136">An alternative to storing an affine transformation in a pair of matrices (one for the linear part and one for the translation) is to store the entire transformation in a 3×3 matrix.</span></span> <span data-ttu-id="a791b-137">Чтобы это работало в матрице 1 × 3 с фиктивной третьей координатой должны храниться точки на плоскости.</span><span class="sxs-lookup"><span data-stu-id="a791b-137">To make this work, a point in the plane must be stored in a 1×3 matrix with a dummy 3rd coordinate.</span></span> <span data-ttu-id="a791b-138">Обычно является сделать все сторонние координаты, равным 1.</span><span class="sxs-lookup"><span data-stu-id="a791b-138">The usual technique is to make all 3rd coordinates equal to 1.</span></span> <span data-ttu-id="a791b-139">Например точка (2, 1) будет представлен в матрице [1 1, 2].</span><span class="sxs-lookup"><span data-stu-id="a791b-139">For example, the point (2, 1) is represented by the matrix [2 1 1].</span></span> <span data-ttu-id="a791b-140">На следующем рисунке показан пример аффинного преобразования (поворот на 90 градусов; сдвиг на 3 единицы по оси x и 4 единицы по оси y) выраженное как умножение на матрицу 3 × 3.</span><span class="sxs-lookup"><span data-stu-id="a791b-140">The following illustration shows an affine transformation (rotate 90 degrees; translate 3 units in the x direction, 4 units in the y direction) expressed as multiplication by a single 3×3 matrix.</span></span>  
  
 <span data-ttu-id="a791b-141">![Преобразования](./media/aboutgdip05-art09.gif "AboutGdip05_art09")</span><span class="sxs-lookup"><span data-stu-id="a791b-141">![Transformations](./media/aboutgdip05-art09.gif "AboutGdip05_art09")</span></span>  
  
 <span data-ttu-id="a791b-142">В предыдущем примере точка (2, 1) сопоставляется точка (2, 6).</span><span class="sxs-lookup"><span data-stu-id="a791b-142">In the preceding example, the point (2, 1) is mapped to the point (2, 6).</span></span> <span data-ttu-id="a791b-143">Обратите внимание, что третий столбец матрицы 3 × 3 содержит числа от 0, 0, 1.</span><span class="sxs-lookup"><span data-stu-id="a791b-143">Note that the third column of the 3×3 matrix contains the numbers 0, 0, 1.</span></span> <span data-ttu-id="a791b-144">Это всегда будет в случае матрицы 3 × 3 аффинные преобразования.</span><span class="sxs-lookup"><span data-stu-id="a791b-144">This will always be the case for the 3×3 matrix of an affine transformation.</span></span> <span data-ttu-id="a791b-145">Важные числа — шесть столбцов 1 и 2.</span><span class="sxs-lookup"><span data-stu-id="a791b-145">The important numbers are the six numbers in columns 1 and 2.</span></span> <span data-ttu-id="a791b-146">Часть 2 × 2 верхнего левого матрицы представляет линейную часть преобразования, а первые две записи в третьей строке представляют перевод.</span><span class="sxs-lookup"><span data-stu-id="a791b-146">The upper-left 2×2 portion of the matrix represents the linear part of the transformation, and the first two entries in the 3rd row represent the translation.</span></span>  
  
 <span data-ttu-id="a791b-147">![Преобразования](./media/aboutgdip05-art10.gif "AboutGdip05_art10")</span><span class="sxs-lookup"><span data-stu-id="a791b-147">![Transformations](./media/aboutgdip05-art10.gif "AboutGdip05_art10")</span></span>  
  
 <span data-ttu-id="a791b-148">В GDI + можно хранить аффинные преобразования в <xref:System.Drawing.Drawing2D.Matrix> объекта.</span><span class="sxs-lookup"><span data-stu-id="a791b-148">In GDI+ you can store an affine transformation in a <xref:System.Drawing.Drawing2D.Matrix> object.</span></span> <span data-ttu-id="a791b-149">Так как третий столбец матрицы, задающей аффинное преобразование всегда является (0, 0, 1), укажите только шесть чисел в первых двух столбцах при создании <xref:System.Drawing.Drawing2D.Matrix> объекта.</span><span class="sxs-lookup"><span data-stu-id="a791b-149">Because the third column of a matrix that represents an affine transformation is always (0, 0, 1), you specify only the six numbers in the first two columns when you construct a <xref:System.Drawing.Drawing2D.Matrix> object.</span></span> <span data-ttu-id="a791b-150">Инструкция `Matrix myMatrix = new Matrix(0, 1, -1, 0, 3, 4)` создает матрицу, изображенную на рисунке выше.</span><span class="sxs-lookup"><span data-stu-id="a791b-150">The statement `Matrix myMatrix = new Matrix(0, 1, -1, 0, 3, 4)` constructs the matrix shown in the preceding figure.</span></span>  
  
## <a name="composite-transformations"></a><span data-ttu-id="a791b-151">Составные преобразования</span><span class="sxs-lookup"><span data-stu-id="a791b-151">Composite Transformations</span></span>  
 <span data-ttu-id="a791b-152">Составное преобразование — это последовательность преобразований, один за другим.</span><span class="sxs-lookup"><span data-stu-id="a791b-152">A composite transformation is a sequence of transformations, one followed by the other.</span></span> <span data-ttu-id="a791b-153">Рассмотрим матрицы и преобразования в следующем списке:</span><span class="sxs-lookup"><span data-stu-id="a791b-153">Consider the matrices and transformations in the following list:</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="a791b-154">Матрицы A</span><span class="sxs-lookup"><span data-stu-id="a791b-154">Matrix A</span></span>|<span data-ttu-id="a791b-155">Повернуть на 90 градусов</span><span class="sxs-lookup"><span data-stu-id="a791b-155">Rotate 90 degrees</span></span>|  
|<span data-ttu-id="a791b-156">Матрица B</span><span class="sxs-lookup"><span data-stu-id="a791b-156">Matrix B</span></span>|<span data-ttu-id="a791b-157">Масштабирование с коэффициентом 2 по оси x</span><span class="sxs-lookup"><span data-stu-id="a791b-157">Scale by a factor of 2 in the x direction</span></span>|  
|<span data-ttu-id="a791b-158">Матрица C</span><span class="sxs-lookup"><span data-stu-id="a791b-158">Matrix C</span></span>|<span data-ttu-id="a791b-159">Сдвиг на три единицы по оси y</span><span class="sxs-lookup"><span data-stu-id="a791b-159">Translate 3 units in the y direction</span></span>|  
  
 <span data-ttu-id="a791b-160">Начнем с точкой (2, 1), представленный в матрице [1 1, 2] — и умножьте, B и затем C, точка (2, 1) будут подвергнуты три преобразования в указанном порядке.</span><span class="sxs-lookup"><span data-stu-id="a791b-160">If we start with the point (2, 1) — represented by the matrix [2 1 1] — and multiply by A, then B, then C, the point (2, 1) will undergo the three transformations in the order listed.</span></span>  
  
 <span data-ttu-id="a791b-161">[1 1, 2] ABC = [1 ПО 5-2]</span><span class="sxs-lookup"><span data-stu-id="a791b-161">[2 1 1]ABC = [-2 5 1]</span></span>  
  
 <span data-ttu-id="a791b-162">А не хранить три части составного преобразования в три отдельных матрицы, можно умножить A, B и C вместе для получения в единую матрицу 3 × 3, в которой хранятся все составное преобразование.</span><span class="sxs-lookup"><span data-stu-id="a791b-162">Rather than store the three parts of the composite transformation in three separate matrices, you can multiply A, B, and C together to get a single 3×3 matrix that stores the entire composite transformation.</span></span> <span data-ttu-id="a791b-163">Предположим, что ABC = D. Затем точка, умноженная D дает тот же результат, как точка, умноженное на A, B и C.</span><span class="sxs-lookup"><span data-stu-id="a791b-163">Suppose ABC = D. Then a point multiplied by D gives the same result as a point multiplied by A, then B, then C.</span></span>  
  
 <span data-ttu-id="a791b-164">[2 1 1]D = [-2 5 1]</span><span class="sxs-lookup"><span data-stu-id="a791b-164">[2 1 1]D = [-2 5 1]</span></span>  
  
 <span data-ttu-id="a791b-165">На следующем рисунке показан матрицы A, B, C и D.</span><span class="sxs-lookup"><span data-stu-id="a791b-165">The following illustration shows the matrices A, B, C, and D.</span></span>  
  
 <span data-ttu-id="a791b-166">![Преобразования](./media/aboutgdip05-art12.gif "AboutGdip05_art12")</span><span class="sxs-lookup"><span data-stu-id="a791b-166">![Transformations](./media/aboutgdip05-art12.gif "AboutGdip05_art12")</span></span>  
  
 <span data-ttu-id="a791b-167">Тот факт, что матрица составного преобразования может быть создана путем перемножения матриц отдельных преобразования означает, что любая последовательность аффинных преобразований могут храниться в одном <xref:System.Drawing.Drawing2D.Matrix> объекта.</span><span class="sxs-lookup"><span data-stu-id="a791b-167">The fact that the matrix of a composite transformation can be formed by multiplying the individual transformation matrices means that any sequence of affine transformations can be stored in a single <xref:System.Drawing.Drawing2D.Matrix> object.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="a791b-168">Важен порядок составного преобразования.</span><span class="sxs-lookup"><span data-stu-id="a791b-168">The order of a composite transformation is important.</span></span> <span data-ttu-id="a791b-169">Вообще говоря, повернуть, затем масштабирование, а затем перевести не соответствует как масштабирования, поворота, а затем перевести.</span><span class="sxs-lookup"><span data-stu-id="a791b-169">In general, rotate, then scale, then translate is not the same as scale, then rotate, then translate.</span></span> <span data-ttu-id="a791b-170">Точно так же важен порядок умножения матриц.</span><span class="sxs-lookup"><span data-stu-id="a791b-170">Similarly, the order of matrix multiplication is important.</span></span> <span data-ttu-id="a791b-171">В общем случае ABC не равно BAC.</span><span class="sxs-lookup"><span data-stu-id="a791b-171">In general, ABC is not the same as BAC.</span></span>  
  
 <span data-ttu-id="a791b-172"><xref:System.Drawing.Drawing2D.Matrix> Класс предоставляет несколько методов для составных преобразований: <xref:System.Drawing.Drawing2D.Matrix.Multiply%2A>, <xref:System.Drawing.Drawing2D.Matrix.Rotate%2A>, <xref:System.Drawing.Drawing2D.Matrix.RotateAt%2A>, <xref:System.Drawing.Drawing2D.Matrix.Scale%2A>, <xref:System.Drawing.Drawing2D.Matrix.Shear%2A>, и <xref:System.Drawing.Drawing2D.Matrix.Translate%2A>.</span><span class="sxs-lookup"><span data-stu-id="a791b-172">The <xref:System.Drawing.Drawing2D.Matrix> class provides several methods for building a composite transformation: <xref:System.Drawing.Drawing2D.Matrix.Multiply%2A>, <xref:System.Drawing.Drawing2D.Matrix.Rotate%2A>, <xref:System.Drawing.Drawing2D.Matrix.RotateAt%2A>, <xref:System.Drawing.Drawing2D.Matrix.Scale%2A>, <xref:System.Drawing.Drawing2D.Matrix.Shear%2A>, and <xref:System.Drawing.Drawing2D.Matrix.Translate%2A>.</span></span> <span data-ttu-id="a791b-173">В следующем примере создается матрица составного преобразования, сначала поворачивается на 30 градусов, а затем масштабируется с коэффициентом 2 по оси y и транслирует 5 единиц по оси x:</span><span class="sxs-lookup"><span data-stu-id="a791b-173">The following example creates the matrix of a composite transformation that first rotates 30 degrees, then scales by a factor of 2 in the y direction, and then translates 5 units in the x direction:</span></span>  
  
 [!code-csharp[System.Drawing.CoordinateSystems#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.CoordinateSystems/CS/Class1.cs#11)]
 [!code-vb[System.Drawing.CoordinateSystems#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.CoordinateSystems/VB/Class1.vb#11)]  
  
 <span data-ttu-id="a791b-174">На следующем рисунке матрицы.</span><span class="sxs-lookup"><span data-stu-id="a791b-174">The following illustration shows the matrix.</span></span>  
  
 <span data-ttu-id="a791b-175">![Преобразования](./media/aboutgdip05-art13.gif "AboutGdip05_art13")</span><span class="sxs-lookup"><span data-stu-id="a791b-175">![Transformations](./media/aboutgdip05-art13.gif "AboutGdip05_art13")</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a791b-176">См. также</span><span class="sxs-lookup"><span data-stu-id="a791b-176">See also</span></span>

- [<span data-ttu-id="a791b-177">Системы координат и преобразования</span><span class="sxs-lookup"><span data-stu-id="a791b-177">Coordinate Systems and Transformations</span></span>](coordinate-systems-and-transformations.md)
- [<span data-ttu-id="a791b-178">Использование преобразований в управляемом GDI+</span><span class="sxs-lookup"><span data-stu-id="a791b-178">Using Transformations in Managed GDI+</span></span>](using-transformations-in-managed-gdi.md)
