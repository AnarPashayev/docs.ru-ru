---
title: Пошаговое руководство. Демонстрация визуального наследования
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- form inheritance [Windows Forms], walkthroughs
- visual inheritance
- inheritance [Windows Forms], walkthroughs
- walkthroughs [Windows Forms], visual inheritance
- Windows Forms, inheritance
ms.assetid: 01966086-3142-450e-8210-3fd4cb33f591
ms.openlocfilehash: 32df98852b28963ffb748895156f7d9977c74b92
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2019
ms.locfileid: "70046140"
---
# <a name="walkthrough-demonstrating-visual-inheritance"></a>Пошаговое руководство. Демонстрация визуального наследования

Визуальное наследование позволяет просматривать элементы управления в базовой форме и добавлять новые элементы управления. В этом пошаговом руководстве рассматривается создание базовой формы и ее компиляция  в библиотеку классов. После этого данная библиотека классов импортируется в другой проект и создается новая форма, которая наследуется от базовой формы. В этом пошаговом руководстве описаны следующие процедуры.

- Создание проекта библиотеки классов, содержащей базовую форму.

- Добавление кнопки со свойствами, которые могут изменяться производными классами базовой формы.

- Добавление кнопки, которая не может изменяться наследниками базовой формы.

- Создание проекта, содержащего форму, которая наследуется от `BaseForm`.

В конечном счете в этом пошаговом руководстве показано различие между частным и защищенным элементами управления в производной форме.

> [!CAUTION]
> Не все элементы управления поддерживают визуальное наследование от базовой формы. Не поддерживают сценарий, описанный в этом пошаговом руководстве, следующие элементы управления:
>
> - <xref:System.Windows.Forms.WebBrowser>
>
> - <xref:System.Windows.Forms.ToolStrip>
>
> - <xref:System.Windows.Forms.ToolStripPanel>
>
> - <xref:System.Windows.Forms.TableLayoutPanel>
>
> - <xref:System.Windows.Forms.FlowLayoutPanel>
>
> - <xref:System.Windows.Forms.DataGridView>
>
> Эти элементы управления в производной форме всегда доступны только для чтения, независимо от используемых модификаторов (`private`, `protected` или `public`).

## <a name="create-a-class-library-project-containing-a-base-form"></a>Создание проекта библиотеки классов, содержащего базовую форму

1. В Visual Studio в меню **файл** выберите пункт **создать** > **проект** , чтобы открыть диалоговое окно **Создание проекта** .

2. Создайте приложение Windows Forms с именем `BaseFormLibrary`.

3. Чтобы создать библиотеку классов вместо стандартного Windows Forms приложения, в **Обозреватель решений**щелкните правой кнопкой мыши узел проекта **басеформлибрари** и выберите пункт **Свойства**.

4. В свойствах проекта измените **тип выходных данных** с **приложения Windows** на **библиотеку классов**.

5. В меню **файл** выберите **сохранить все** , чтобы сохранить проект и файлы в расположение по умолчанию.

Следующие две процедуры выполняют добавление кнопок на базовую форму. Чтобы продемонстрировать визуальное наследование, кнопкам будет заданы разные уровни доступа с помощью свойств `Modifiers`.

## <a name="add-a-button-that-inheritors-of-the-base-form-can-modify"></a>Добавление кнопки, которая может быть изменена наследниками базовой формы

1. Откройте **Form1** в конструкторе.

2. На вкладке **все Windows Forms** **панели элементов**дважды щелкните кнопку, чтобы добавить кнопку в форму. Измените положение и размер кнопки с помощью мыши.

3. В окне "Свойства" задайте следующие свойства кнопки.

    - Присвойте свойству **Text** значение **Привет**.

    - Присвойте свойству **(Name)** значение **бтнпротектед**.

    - Присвойте свойству **Modifiers** значение **protected**. Это позволяет формам, наследующим от **Form1** , изменять свойства **бтнпротектед**.

4. Дважды щелкните кнопку " **Привет!** ", чтобы добавить обработчик событий для события **щелчка** .

5. Добавьте следующий код в обработчик событий:

    ```vb
    MessageBox.Show("Hello, World!")
    ```

    ```csharp
    MessageBox.Show("Hello, World!");
    ```

## <a name="add-a-button-that-cannot-be-modified-by-inheritors-of-the-base-form"></a>Добавление кнопки, которая не может быть изменена наследниками базовой формы

1. Переключитесь в режим конструктора, щелкнув вкладку **Form1. vb [Design], Form1.cs [Design] или Form1. ЖСЛ [Design]** над редактором кода или нажав клавишу F7.

2. Добавьте вторую кнопку и задайте ее свойства следующим образом.

    - Присвойте свойству **Text** значение « **пока**».

    - Присвойте свойству **(Name)** значение **бтнпривате**.

    - Присвойте свойству **Modifiers** значение **Private**. Это делает невозможным изменение свойств **бтнпривате**с помощью форм, наследующих от **Form1** .

3. Дважды щелкните кнопку « о продолжении», чтобы добавить обработчик событий для события **щелчка** . Добавьте следующую строку кода в процедуру обработки события.

    ```vb
    MessageBox.Show("Goodbye!")
    ```

    ```csharp
    MessageBox.Show("Goodbye!");
    ```

4. В меню **Сборка** выберите **Build басеформ Library** (сборка библиотеки), чтобы создать библиотеку классов.

     После сборки библиотеки можно создать новый проект, наследуемый от только что созданной формы.

## <a name="create-a-project-containing-a-form-that-inherits-from-the-base-form"></a>Создание проекта, содержащего форму, которая наследуется от базовой формы

1. В меню **файл** выберите **Добавить** , а затем **Новый проект** , чтобы открыть диалоговое окно **Добавление нового проекта** .

2. Создайте приложение Windows Forms с именем `InheritanceTest`.

## <a name="add-an-inherited-form"></a>Добавление наследуемой формы

1. В **Обозреватель решений**щелкните правой кнопкой мыши проект **InheritanceTest** , выберите **Добавить**, а затем щелкните **новый элемент**.

2. В диалоговом окне **Добавление нового элемента** выберите категорию **Windows Forms** (если имеется список категорий), а затем выберите производный шаблон **формы** .

3. Оставьте имя `Form2` по умолчанию и нажмите кнопку **добавить**.

4. В диалоговом окне **Выбор наследования** выберите **Form1** из проекта **басеформлибрари** в качестве формы для наследования и нажмите кнопку **ОК**.

     При этом в проекте **InheritanceTest** создается форма, производная от формы в **басеформлибрари**.

5. Откройте наследуемую форму (**Form2**) в конструкторе, дважды щелкнув ее, если она еще не открыта.

    В конструкторе наследуемые кнопки имеют символ (![Снимок экрана: символ наследования Visual Basic.](./media/walkthrough-demonstrating-visual-inheritance/visual-basic-inheritance-glyph.gif)) в верхнем углу, указывая, что они унаследованы.

6. Нажмите кнопку **Привет** , чтобы увидеть маркеры изменения размера. Так как данная кнопка защищена, то наследники могут ее перемещать, изменять размер, название и вносить другие изменения.

7. Выберите закрытую кнопку и обратите внимание, что у нее нет маркеров изменения размера. Кроме того, в окне **Свойства** свойства этой кнопки отображаются серым цветом, что означает, что их нельзя изменить.

8. При использовании визуального элемента C#:

    1. В **Обозреватель решений**щелкните правой кнопкой мыши **форму Form1** в проекте **InheritanceTest** и выберите пункт **Удалить**. В появившемся окне сообщения нажмите кнопку **ОК** , чтобы подтвердить удаление.

    2. Откройте файл Program.cs и измените строку `Application.Run(new Form1());` на `Application.Run(new Form2());`.

9. В **Обозреватель решений**щелкните правой кнопкой мыши проект **InheritanceTest** и выберите **Назначить запускаемым проектом**.

10. В **Обозреватель решений**щелкните правой кнопкой мыши проект **InheritanceTest** и выберите пункт **Свойства**.

11. На страницах свойств **InheritanceTest** установите **начальный объект** в качестве наследуемой формы (**Form2**).

12. Нажмите клавишу **F5** , чтобы запустить приложение, и обратите внимание на поведение наследуемой формы.

## <a name="next-steps"></a>Следующие шаги

Наследование для пользовательских элементов управления работает таким же образом. Откройте новый проект библиотеки классов и добавьте пользовательский элемент управления. Поместите на него составные элементы управления и скомпилируйте проект. Откройте еще один новый проект библиотеки классов и добавьте ссылку на скомпилированную библиотеку классов. Кроме того, попробуйте добавить наследуемый элемент управления (с помощью диалогового окна " **Добавление новых элементов** ") в проект и с помощью **средства выбора наследования**. Добавьте пользовательский элемент управления и измените `Inherits` оператор (`:` в Visual C#). Дополнительные сведения см. в разделе [Практическое руководство. Наследовать](how-to-inherit-windows-forms.md)Windows Forms.

## <a name="see-also"></a>См. также

- [Практическое руководство. Наследовать Windows Forms](how-to-inherit-windows-forms.md)
- [Визуальное наследование в Windows Forms](windows-forms-visual-inheritance.md)
- [Windows Forms](../index.md)
