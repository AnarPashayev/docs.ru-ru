---
title: Общие сведения о параметрах приложений
description: Сведения о параметрах приложения Windows Forms, например о создании и хранении данных параметров от имени приложения и пользователей.
ms.date: 03/30/2017
f1_keywords:
- ApplicationsSettingsOverview
helpviewer_keywords:
- application settings [Windows Forms], about application settings
- dynamic properties
- user preferences [Windows Forms], tracking
ms.assetid: 0dd8bca5-a6bf-4ac4-8eec-5725d08b38dc
ms.openlocfilehash: 864cab72b26ff7989c570347fb88b4009e7d705a
ms.sourcegitcommit: dc2feef0794cf41dbac1451a13b8183258566c0e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/24/2020
ms.locfileid: "85324214"
---
# <a name="application-settings-overview"></a><span data-ttu-id="fed13-103">Общие сведения о параметрах приложений</span><span class="sxs-lookup"><span data-stu-id="fed13-103">Application Settings Overview</span></span>

<span data-ttu-id="fed13-104">В этой статье описывается, как создавать и хранить данные параметров от имени приложения и пользователей.</span><span class="sxs-lookup"><span data-stu-id="fed13-104">This article discusses how to create and store settings data on behalf of your application and your users.</span></span>

 <span data-ttu-id="fed13-105">Параметры приложения в Windows Forms позволяют легко создавать, хранить и поддерживать настраиваемые приложения и параметры пользователей на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="fed13-105">The Application Settings feature of Windows Forms makes it easy to create, store, and maintain custom application and user preferences on the client computer.</span></span> <span data-ttu-id="fed13-106">С помощью параметров приложения Windows Forms можно хранить не только данные приложения, например строки подключений к базам данных, но и пользовательские данные, такие как предпочтения пользователя приложения.</span><span class="sxs-lookup"><span data-stu-id="fed13-106">With Windows Forms application settings, you can store not only application data such as database connection strings, but also user-specific data, such as user application preferences.</span></span> <span data-ttu-id="fed13-107">Используя Visual Studio или настраиваемый управляемый код, можно создавать новые параметры, читать их и записывать на диск, связывать их со свойствами в формах и проверять данные параметров до загрузки и сохранения.</span><span class="sxs-lookup"><span data-stu-id="fed13-107">Using Visual Studio or custom managed code, you can create new settings, read them from and write them to disk, bind them to properties on your forms, and validate settings data prior to loading and saving.</span></span>

 <span data-ttu-id="fed13-108">Параметры приложения позволяют разработчикам сохранять состояние в своем приложении с помощью очень небольшого объема пользовательского кода и заменяют динамические свойства в предыдущих версиях .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="fed13-108">Application settings enables developers to save state in their application using very little custom code, and is a replacement for dynamic properties in previous versions of the .NET Framework.</span></span> <span data-ttu-id="fed13-109">Параметры приложения содержат много улучшений по сравнению с динамическими свойствами, которые доступны только для чтения. Кроме того, в динамических свойствах используется позднее связывание, и для них требуется дополнительное программирование.</span><span class="sxs-lookup"><span data-stu-id="fed13-109">Application settings contains many improvements over dynamic properties, which are read-only, late-bound, and require more custom programming.</span></span> <span data-ttu-id="fed13-110">Классы динамических свойств были сохранены в .NET Framework 2,0, но они просто являются классами оболочки, которые тонко заключают классы параметров приложения.</span><span class="sxs-lookup"><span data-stu-id="fed13-110">The dynamic property classes have been retained in .NET Framework 2.0, but they are just shell classes that thinly wrap the application settings classes.</span></span>

## <a name="what-are-application-settings"></a><span data-ttu-id="fed13-111">Что такое параметры приложения</span><span class="sxs-lookup"><span data-stu-id="fed13-111">What Are Application Settings?</span></span>
 <span data-ttu-id="fed13-112">Приложениям Windows Forms часто требуются данные, которые крайне важны для запуска приложения, но вы не хотите включать их непосредственно в код приложения.</span><span class="sxs-lookup"><span data-stu-id="fed13-112">Your Windows Forms applications will often require data that's critical to running the application, but which you don't want to include directly in the application's code.</span></span> <span data-ttu-id="fed13-113">Если приложение использует веб-службу или сервер базы данных, эту информацию можно сохранить в отдельном файле, чтобы их можно было изменить в будущем без повторной компиляции.</span><span class="sxs-lookup"><span data-stu-id="fed13-113">If your application uses a Web Service or a database server, you may want to store this information in a separate file, so that you can change it in the future without recompiling.</span></span> <span data-ttu-id="fed13-114">Аналогичным образом приложению может потребоваться сохранить данные, относящиеся к текущему пользователю.</span><span class="sxs-lookup"><span data-stu-id="fed13-114">Similarly, your applications may require storing data that is specific to the current user.</span></span> <span data-ttu-id="fed13-115">В большинстве приложений, например, применяются пользовательские предпочтения, определяющие внешний вид и поведение приложения.</span><span class="sxs-lookup"><span data-stu-id="fed13-115">Most applications, for example, have user preferences that customize the application's appearance and behavior.</span></span>

 <span data-ttu-id="fed13-116">Параметры приложения отвечают обеим потребностям, предоставляя простой способ хранения параметров приложения и пользователей на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="fed13-116">Application settings addresses both needs by providing an easy way to store both application-scoped and user-scoped settings on the client computer.</span></span> <span data-ttu-id="fed13-117">С помощью Visual Studio или редактора кода можно определить значение параметра, указав его имя, тип данных и область действия (приложение или пользователь).</span><span class="sxs-lookup"><span data-stu-id="fed13-117">Using Visual Studio or a code editor, you define a setting for a given property by specifying its name, data type, and scope (application or user).</span></span> <span data-ttu-id="fed13-118">Вы можете даже поместить связанные параметры в именованные группы для повышения простоты и удобочитаемости кода.</span><span class="sxs-lookup"><span data-stu-id="fed13-118">You can even place related settings into named groups for easier use and readability.</span></span> <span data-ttu-id="fed13-119">После определения эти параметры сохраняются и считываются обратно в память автоматически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="fed13-119">Once defined, these settings are persisted and read back into memory automatically at run time.</span></span> <span data-ttu-id="fed13-120">Подключаемая архитектура позволяет изменять механизм сохранения, однако по умолчанию используется локальная файловая система.</span><span class="sxs-lookup"><span data-stu-id="fed13-120">A pluggable architecture enables the persistence mechanism to be changed, but by default, the local file system is used.</span></span>

 <span data-ttu-id="fed13-121">Параметры приложения работают путем сохранения данных в формате XML в различных файлах конфигурации (CONFIG-файлах) в зависимости от того, что является областью действия параметра — приложение или пользователь.</span><span class="sxs-lookup"><span data-stu-id="fed13-121">Application settings works by persisting data as XML to different configuration (.config) files, corresponding to whether the setting is application-scoped or user-scoped.</span></span> <span data-ttu-id="fed13-122">В большинстве случаев параметры приложения доступны только для чтения. Так как они содержат сведения для программы, обычно их не нужно перезаписывать.</span><span class="sxs-lookup"><span data-stu-id="fed13-122">In most cases, the application-scoped settings are read-only; because they are program information, you will typically not need to overwrite them.</span></span> <span data-ttu-id="fed13-123">Параметры пользователей, напротив, можно и считывать, и записывать во время выполнения, даже если приложение работает в режиме частичного доверия.</span><span class="sxs-lookup"><span data-stu-id="fed13-123">By contrast, user-scoped settings can be read and written safely at run time, even if your application runs under partial trust.</span></span> <span data-ttu-id="fed13-124">Дополнительные сведения о частичном доверии см. в разделе [Security in Windows Forms Overview](../security-in-windows-forms-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fed13-124">For more information about partial trust, see [Security in Windows Forms Overview](../security-in-windows-forms-overview.md).</span></span>

 <span data-ttu-id="fed13-125">Параметры хранятся в виде XML-фрагментов в файлах конфигурации.</span><span class="sxs-lookup"><span data-stu-id="fed13-125">Settings are stored as XML fragments in configuration files.</span></span> <span data-ttu-id="fed13-126">Параметры приложения представлены элементом `<applicationSettings>` . Обычно они размещаются в файле *app*.exe.config, где *app* — имя основного исполняемого файла.</span><span class="sxs-lookup"><span data-stu-id="fed13-126">Application-scoped settings are represented by the `<applicationSettings>` element, and generally are placed in *app*.exe.config, where *app* is the name of your main executable file.</span></span> <span data-ttu-id="fed13-127">Параметры пользователей представлены элементом `<userSettings>` и помещаются в файле *user*.config, где *user* — имя пользователя, запустившего приложение.</span><span class="sxs-lookup"><span data-stu-id="fed13-127">User-scoped settings are represented by the `<userSettings>` element and are placed in *user*.config, where *user* is the user name of the person currently running the application.</span></span> <span data-ttu-id="fed13-128">Файл *app*.exe.config необходимо развернуть вместе с приложением. Архитектура параметров создает файлы *user*.config по запросу, когда приложение в первый раз сохраняет параметры для этого пользователя.</span><span class="sxs-lookup"><span data-stu-id="fed13-128">You must deploy the *app*.exe.config file with your application; the settings architecture will create the *user*.config files on demand the first time the application saves settings for that user.</span></span> <span data-ttu-id="fed13-129">Вы можете также определить блок `<userSettings>` в файле *app*.exe.config, чтобы предоставить значения по умолчанию для параметров пользователя.</span><span class="sxs-lookup"><span data-stu-id="fed13-129">You can also define a `<userSettings>` block within *app*.exe.config to provide default values for user-scoped settings.</span></span>

 <span data-ttu-id="fed13-130">Пользовательские элементы управления могут сохранять собственные параметры с помощью реализации интерфейса <xref:System.Configuration.IPersistComponentSettings> , который предоставляет метод <xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A> .</span><span class="sxs-lookup"><span data-stu-id="fed13-130">Custom controls can also save their own settings by implementing the <xref:System.Configuration.IPersistComponentSettings> interface, which exposes the <xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A> method.</span></span> <span data-ttu-id="fed13-131">Элемент управления <xref:System.Windows.Forms.ToolStrip> Windows Forms реализует этот интерфейс, чтобы сохранить положение панелей инструментов и их элементов между сеансами приложения.</span><span class="sxs-lookup"><span data-stu-id="fed13-131">The Windows Forms <xref:System.Windows.Forms.ToolStrip> control implements this interface to save the position of toolbars and toolbar items between application sessions.</span></span> <span data-ttu-id="fed13-132">Дополнительные сведения о пользовательских элементах управления и параметрах приложения см. в разделе [Application Settings for Custom Controls](application-settings-for-custom-controls.md).</span><span class="sxs-lookup"><span data-stu-id="fed13-132">For more information about custom controls and application settings, see [Application Settings for Custom Controls](application-settings-for-custom-controls.md).</span></span>

## <a name="limitations-of-application-settings"></a><span data-ttu-id="fed13-133">Ограничения параметров приложения</span><span class="sxs-lookup"><span data-stu-id="fed13-133">Limitations of Application Settings</span></span>
 <span data-ttu-id="fed13-134">Нельзя использовать параметры приложения в неуправляемом приложении, где размещается .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="fed13-134">You cannot use application settings in an unmanaged application that hosts the .NET Framework.</span></span> <span data-ttu-id="fed13-135">Параметры не будут работать в таких средах, как надстройки Visual Studio, C++ для Microsoft Office, элементы управления, размещенные в Internet Explorer, или надстройки и проекты Microsoft Outlook.</span><span class="sxs-lookup"><span data-stu-id="fed13-135">Settings will not work in such environments as Visual Studio add-ins, C++ for Microsoft Office, control hosting in Internet Explorer, or Microsoft Outlook add-ins and projects.</span></span>

 <span data-ttu-id="fed13-136">В настоящее время нельзя выполнить привязку к некоторым свойствам в Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="fed13-136">You currently cannot bind to some properties in Windows Forms.</span></span> <span data-ttu-id="fed13-137">Наиболее важным примером является свойство <xref:System.Windows.Forms.Form.ClientSize%2A> , так как привязка к этому свойству вызовет непредсказуемое поведение во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="fed13-137">The most notable example is the <xref:System.Windows.Forms.Form.ClientSize%2A> property, as binding to this property would cause unpredictable behavior at run time.</span></span> <span data-ttu-id="fed13-138">Как правило, такого рода проблем можно избежать путем программного сохранения и загрузки этих параметров.</span><span class="sxs-lookup"><span data-stu-id="fed13-138">You can usually work around these issues by saving and loading these settings programmatically.</span></span>

 <span data-ttu-id="fed13-139">Параметры приложения не имеют встроенных средств для автоматического шифрования информации.</span><span class="sxs-lookup"><span data-stu-id="fed13-139">Application settings has no built-in facility for encrypting information automatically.</span></span> <span data-ttu-id="fed13-140">Никогда не следует хранить конфиденциальные данные, такие как пароли к базам данных, в виде открытого текста.</span><span class="sxs-lookup"><span data-stu-id="fed13-140">You should never store security-related information, such as database passwords, in clear text.</span></span> <span data-ttu-id="fed13-141">Если требуется хранить такие сведения, то разработчик приложения обязан обеспечить надлежащую безопасность хранения.</span><span class="sxs-lookup"><span data-stu-id="fed13-141">If you want to store such sensitive information, you as the application developer are responsible for making sure it is secure.</span></span> <span data-ttu-id="fed13-142">Если нужно хранить строки подключений, рекомендуется использовать встроенную систему безопасности Windows и не прибегать к таким средствам, как жесткое программирование паролей в URL-адресах.</span><span class="sxs-lookup"><span data-stu-id="fed13-142">If you want to store connection strings, we recommend that you use Windows Integrated Security and not resort to hard-coding passwords into the URL.</span></span> <span data-ttu-id="fed13-143">Для получения дополнительной информации см. [Code Access Security and ADO.NET](../../data/adonet/code-access-security.md).</span><span class="sxs-lookup"><span data-stu-id="fed13-143">For more information, see [Code Access Security and ADO.NET](../../data/adonet/code-access-security.md).</span></span>

## <a name="getting-started-with-application-settings"></a><span data-ttu-id="fed13-144">Начало работы с параметрами приложения</span><span class="sxs-lookup"><span data-stu-id="fed13-144">Getting Started with Application Settings</span></span>
 <span data-ttu-id="fed13-145">Если используется Visual Studio, вы можете определить параметры в конструкторе Windows Forms с помощью свойства **(ApplicationSettings)** в окне **Свойства** .</span><span class="sxs-lookup"><span data-stu-id="fed13-145">If you use Visual Studio, you can define settings within the Windows Forms Designer using the **(ApplicationSettings)** property in the **Properties** window.</span></span> <span data-ttu-id="fed13-146">При определении параметров таким образом Visual Studio автоматически создает настраиваемый управляемый класс-оболочку, связывающий каждый параметр со свойством класса.</span><span class="sxs-lookup"><span data-stu-id="fed13-146">When you define settings this way, Visual Studio automatically creates a custom managed wrapper class that associates each setting with a class property.</span></span> <span data-ttu-id="fed13-147">Visual Studio также обеспечивает привязку параметра к свойству в форме или элементе управления таким образом, чтобы параметры элемента управления автоматически восстанавливались при отображении содержащей его формы и автоматически сохранялись при закрытии формы.</span><span class="sxs-lookup"><span data-stu-id="fed13-147">Visual Studio also takes care of binding the setting to a property on a form or control so that the control's settings are restored automatically when its form is displayed, and saved automatically when the form is closed.</span></span>

 <span data-ttu-id="fed13-148">Если требуется более детальное управление параметрами, можно определить собственный класс-оболочку параметров приложения.</span><span class="sxs-lookup"><span data-stu-id="fed13-148">If you want more detailed control over your settings, you can define your own custom applications settings wrapper class.</span></span> <span data-ttu-id="fed13-149">Для этого нужно создать класс, производный от <xref:System.Configuration.ApplicationSettingsBase>, добавить свойства, соответствующие каждому параметру, и применить к ним специальные атрибуты.</span><span class="sxs-lookup"><span data-stu-id="fed13-149">This is accomplished by deriving a class from <xref:System.Configuration.ApplicationSettingsBase>, adding a property that corresponds to each setting, and applying special attributes to these properties.</span></span> <span data-ttu-id="fed13-150">Дополнительные сведения о создании классов-оболочек см. в разделе [Application Settings Architecture](application-settings-architecture.md).</span><span class="sxs-lookup"><span data-stu-id="fed13-150">For details about creating wrapper classes, see [Application Settings Architecture](application-settings-architecture.md).</span></span>

 <span data-ttu-id="fed13-151">Вы можете также использовать класс <xref:System.Windows.Forms.Binding> для программной привязки параметров к свойствам в формах и элементах управления.</span><span class="sxs-lookup"><span data-stu-id="fed13-151">You can also use the <xref:System.Windows.Forms.Binding> class to bind settings programmatically to properties on forms and controls.</span></span>

## <a name="see-also"></a><span data-ttu-id="fed13-152">См. также</span><span class="sxs-lookup"><span data-stu-id="fed13-152">See also</span></span>

- <xref:System.Configuration.ApplicationSettingsBase>
- <xref:System.Configuration.SettingsProvider>
- <xref:System.Configuration.LocalFileSettingsProvider>
- <xref:System.Configuration.IPersistComponentSettings>
- [<span data-ttu-id="fed13-153">Практическое руководство. Проверка параметров приложения</span><span class="sxs-lookup"><span data-stu-id="fed13-153">How to: Validate Application Settings</span></span>](how-to-validate-application-settings.md)
- [<span data-ttu-id="fed13-154">Управление параметрами приложения (.NET)</span><span class="sxs-lookup"><span data-stu-id="fed13-154">Managing Application Settings (.NET)</span></span>](/visualstudio/ide/managing-application-settings-dotnet)
- [<span data-ttu-id="fed13-155">Как выполнить: Считывание параметров во время выполнения с помощью C#</span><span class="sxs-lookup"><span data-stu-id="fed13-155">How To: Read Settings at Run Time With C#</span></span>](how-to-read-settings-at-run-time-with-csharp.md)
- [<span data-ttu-id="fed13-156">Использование параметров приложения и параметров пользователя</span><span class="sxs-lookup"><span data-stu-id="fed13-156">Using Application Settings and User Settings</span></span>](using-application-settings-and-user-settings.md)
- [<span data-ttu-id="fed13-157">Архитектура параметров приложения</span><span class="sxs-lookup"><span data-stu-id="fed13-157">Application Settings Architecture</span></span>](application-settings-architecture.md)
- [<span data-ttu-id="fed13-158">Параметры приложения для пользовательских элементов управления</span><span class="sxs-lookup"><span data-stu-id="fed13-158">Application Settings for Custom Controls</span></span>](application-settings-for-custom-controls.md)
