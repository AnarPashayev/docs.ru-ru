---
title: Пример. Отладка пользовательских элементов управления Windows Forms во время разработки
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- debugging [Visual Studio], walkthroughs
- custom controls [Windows Forms], walkthroughs
- visual editors
- debugging [Visual Studio], Windows Forms
- custom controls [Windows Forms], debugging
- designers
- controls [Windows Forms], debugging
- walkthroughs [Windows Forms], debugging
- design-time debugging
ms.assetid: 1fd83ccd-3798-42fc-85a3-6cba99467387
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: a8572c1e70e36faf3a179de7a69e88e9cf1e781b
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73460611"
---
# <a name="walkthrough-debug-custom-windows-forms-controls-at-design-time"></a>Пошаговое руководство. Отладка пользовательских элементов управления Windows Forms во время разработки

При создании пользовательского элемента управления часто возникает необходимость в отладке его поведения во время разработки. Это особенно справедливо при создании пользовательского конструктора для пользовательского элемента управления. Дополнительные сведения см. [в разделе Пошаговое руководство. Создание элемента управления Windows Forms, который использует преимущества функций времени разработки Visual Studio](creating-a-wf-control-design-time-features.md).

Вы можете выполнять отладку пользовательских элементов управления с помощью Visual Studio точно так же, как при отладке любых других классов .NET Framework. Разница заключается в том, что будет выполняться отладка отдельного экземпляра Visual Studio, на котором выполняется код пользовательского элемента управления.

## <a name="create-the-project"></a>Создание проекта

Первым шагом является создание проекта приложения. Этот проект будет использоваться для создания приложения, в котором размещается пользовательский элемент управления.

В Visual Studio создайте проект приложения Windows и назовите его **дебуггинжексампле**.

## <a name="create-the-control-library-project"></a>Создание проекта библиотеки элементов управления

1. Добавьте в решение проект **библиотеки элементов управления Windows** .

2. Добавьте новый элемент **UserControl** в проект дебугконтроллибрари. Назовите его **дебугконтрол**.

3. В **Обозреватель решений**удалите элемент управления проекта по умолчанию, удалив файл кода с базовым именем UserControl1.

4. Постройте решение.

## <a name="checkpoint"></a>Контрольная точка

На этом этапе вы сможете увидеть пользовательский элемент управления на **панели элементов**.

Чтобы проверить ход выполнения, найдите новую вкладку с именем **компоненты дебугконтроллибрари** и щелкните, чтобы выбрать ее. При открытии элемент управления отображается в списке как **дебугконтрол** со значком по умолчанию рядом с ним.

## <a name="add-a-property-to-your-custom-control"></a>Добавление свойства в пользовательский элемент управления

Чтобы продемонстрировать, что код пользовательского элемента управления выполняется во время разработки, добавьте свойство и задайте точку останова в коде, который реализует свойство.

1. Откройте **дебугконтрол** в **редакторе кода**. Добавьте следующий код в определение класса:

    ```vb
    Private demoStringValue As String = Nothing
    <BrowsableAttribute(true)>
    Public Property DemoString() As String

        Get
            Return Me.demoStringValue
        End Get

        Set(ByVal value As String)
            Me.demoStringValue = value
        End Set

    End Property
    ```

    ```csharp
    private string demoStringValue = null;
    [Browsable(true)]
    public string DemoString
    {
        get
        {
            return this.demoStringValue;
        }
        set
        {
            demoStringValue = value;
        }
    }
    ```

2. Постройте решение.

## <a name="add-your-custom-control-to-the-host-form"></a>Добавление пользовательского элемента управления в форму размещения

Чтобы отладить поведение пользовательского элемента управления во время разработки, необходимо разместить экземпляр класса пользовательского элемента управления в форме узла.

1. В проекте "Дебуггинжексампле" откройте Form1 в **конструктор Windows Forms**.

2. На **панели элементов**откройте вкладку **компоненты дебугконтроллибрари** и перетащите экземпляр **дебугконтрол** на форму.

3. Найдите пользовательское свойство `DemoString` в окне **Свойства** . Обратите внимание, что его значение можно изменить так же, как любое другое свойство. Также обратите внимание, что при выборе свойства `DemoString` строка описания свойства отображается в нижней части окна **Свойства** .

## <a name="set-up-the-project-for-design-time-debugging"></a>Настройка проекта для отладки во время разработки

Для отладки поведения пользовательского элемента управления во время разработки будет выполняться отладка отдельного экземпляра Visual Studio, на котором выполняется код пользовательского элемента управления.

1. Щелкните правой кнопкой мыши проект **дебугконтроллибрари** в **Обозреватель решений** и выберите пункт **Свойства**.

2. На странице свойств **дебугконтроллибрари** выберите вкладку **Отладка** .

     В разделе **действие при запуске** выберите **Запуск внешней программы**. Вы будете выполнять отладку отдельного экземпляра Visual Studio, поэтому нажмите кнопку с многоточием (![кнопку с многоточием (...) в окно свойств Visual Studio](./media/visual-studio-ellipsis-button.png)), чтобы найти интегрированную среду разработки Visual Studio. Имя исполняемого файла — **devenv. exe**, и если вы установили в расположение по умолчанию, его путь: *% ProgramFiles (x86)% \ Microsoft Visual Studio\2019\\\<Edition > \Common7\IDE*.

3. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно.

4. Щелкните правой кнопкой мыши проект **дебугконтроллибрари** и выберите **Назначить запускаемым проектом** , чтобы включить эту конфигурацию отладки.

## <a name="debug-your-custom-control-at-design-time"></a>Отладка пользовательского элемента управления во время разработки

Теперь вы готовы к отладке пользовательского элемента управления, как он выполняется в режиме конструктора. При запуске сеанса отладки будет создан новый экземпляр Visual Studio, который будет использоваться для загрузки решения "Дебуггинжексампле". При открытии формы Form1 в **конструкторе форм**будет создан экземпляр пользовательского элемента управления и начнется его выполнение.

1. Откройте исходный файл **дебугконтрол** в **редакторе кода** и поместите точку останова в `Set`ный метод доступа свойства `DemoString`.

2. Нажмите клавишу **F5** , чтобы запустить сеанс отладки. Создается новый экземпляр Visual Studio. Можно различать экземпляры двумя способами:

    - Экземпляр отладки содержит слово, которое **выполняется** в заголовке окна

    - В экземпляре отладки на панели инструментов **отладки** отключена кнопка " **Пуск** "

   Точка останова задается в экземпляре отладки.

3. В новом экземпляре Visual Studio откройте решение "Дебуггинжексампле". Решение можно легко найти, выбрав **последние проекты** в меню **файл** . Файл решения "Дебуггинжексампле. sln" будет указан как самый последний использовавшийся файл.

4. Откройте форму Form1 в **конструкторе форм** и выберите элемент управления **дебугконтрол** .

5. Измените значение свойства `DemoString` . При фиксации изменения экземпляр отладки Visual Studio получает фокус и выполнение останавливается в точке останова. Метод доступа к свойству можно выполнить одним шагом, как и любой другой код.

6. Чтобы прекратить отладку, выйдите из размещенного экземпляра Visual Studio или нажмите кнопку " **прекратить отладку** " в экземпляре отладки.

## <a name="next-steps"></a>Следующие шаги

Теперь, когда вы можете выполнять отладку пользовательских элементов управления во время разработки, существует множество возможностей расширения взаимодействия элемента управления с интегрированной средой разработки Visual Studio.

- Можно использовать свойство <xref:System.ComponentModel.Component.DesignMode%2A> класса <xref:System.ComponentModel.Component> для написания кода, который будет выполняться только во время разработки. Дополнительные сведения см. в разделе <xref:System.ComponentModel.Component.DesignMode%2A>.

- Существует несколько атрибутов, которые можно применить к свойствам элемента управления, чтобы управлять взаимодействием пользовательского элемента управления с конструктором. Эти атрибуты можно найти в пространстве имен <xref:System.ComponentModel?displayProperty=nameWithType>.

- Можно написать пользовательский конструктор для пользовательского элемента управления. Это дает полный контроль над процессом разработки с помощью расширяемой инфраструктуры конструктора, предоставляемой Visual Studio. Дополнительные сведения см. [в разделе Пошаговое руководство. Создание элемента управления Windows Forms, который использует преимущества функций времени разработки Visual Studio](creating-a-wf-control-design-time-features.md).

## <a name="see-also"></a>См. также

- [Пошаговое руководство. Создание элемента управления Windows Forms, в котором используются преимущества функций Visual Studio, применяемых во время разработки](creating-a-wf-control-design-time-features.md)
