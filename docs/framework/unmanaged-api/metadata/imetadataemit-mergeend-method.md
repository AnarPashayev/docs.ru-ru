---
title: Метод IMetaDataEmit::MergeEnd
ms.date: 03/30/2017
api_name:
- IMetaDataEmit.MergeEnd
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataEmit::MergeEnd
helpviewer_keywords:
- MergeEnd method [.NET Framework metadata]
- IMetaDataEmit::MergeEnd method [.NET Framework metadata]
ms.assetid: 2d64315a-1af1-4c60-aedf-f8a781914aea
topic_type:
- apiref
author: mairaw
ms.author: mairaw
ms.openlocfilehash: b4e3045476fc68dbeb545b7394b373be4ff881c8
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64584281"
---
# <a name="imetadataemitmergeend-method"></a>Метод IMetaDataEmit::MergeEnd
Выполняет слияние в текущей области все области метаданных, определяемое один или несколько предыдущих вызовов [IMetaDataEmit::Merge](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
HRESULT MergeEnd ();  
```  
  
## <a name="parameters"></a>Параметры  
 Этот метод не принимает параметров.  
  
## <a name="remarks"></a>Примечания  
 Эта процедура включает фактическое слияние метаданных, всех импорта области, указанные перед вызовы `IMetaDataEmit::Merge`, в текущей области вывода.  
  
 Следующие специальные условия для слияния.  
  
- Идентификатор версии модуля (MVID) никогда не импортируется, так как он уникален для метаданных в импортируемой области.  
  
- Нет существующих свойств на уровне модуля, перезаписываются.  
  
     Если уже были заданы свойства модуля в текущей области, свойства модуля не импортируются. Тем не менее если не были настроены свойства модуля в текущей области, они импортируются только один раз, когда они встречаются впервые. Если эти свойства модуля встречаются снова, они являются дубликатами. Если сравниваются значения всех свойств модуля (за исключением MVID) и не найден, возникает ошибка.  
  
- Для определения типов (`TypeDef`), без дубликатов, объединяются в текущей области. `TypeDef` объекты проверить наличие дублирующихся с каждым *имя полного объекта* + *GUID* + *номер версии*. Если совпадения по имени или идентификатора GUID и любых других двух элементов отличается, возникает ошибка. В противном случае, если все три элемента совпадают, `MergeEnd` проверяет проводится поверхностное для обеспечения записи действительно являются дубликатами; в противном случае возникает ошибка. Эта проверка проводится поверхностное ищет:  
  
    - Же объявления членов, в том же порядке. Члены, помеченные как `mdPrivateScope` (см. в разделе [CorMethodAttr](../../../../docs/framework/unmanaged-api/metadata/cormethodattr-enumeration.md) перечисления) не включаются в эту проверку; они специально объединяются.  
  
    - Тот же макет класса.  
  
     Это означает, что `TypeDef` объект должен быть полностью и согласованно определена в каждой области метаданных в котором она объявлена; если его реализация члена (для класса) распределяются по несколько блоков компиляции, полное определение считается в каждой области, а не добавочное, для каждой области. Например если имена параметров относятся к контракту, они должны выдавать одинаково во всех областях; Если они не существенны, они не должны выдаваться в метаданные.  
  
     Исключение, `TypeDef` объект может иметь добавочных членов, отмеченных как `mdPrivateScope`. Такие, `MergeEnd` добавляет их в текущую область, без учета того, повторяющиеся значения. Так как компилятор распознает частной области, компилятор должен быть отвечают за принудительное применение правил.  
  
- Относительные виртуальные адреса (RVA) не импортируются и объединить; компилятор должен повторно создать эту информацию.  
  
- Настраиваемые атрибуты объединяются только в том случае, если объединить элемента, к которому они подключены. Например настраиваемые атрибуты, связанные с классом объединяются при класса встретилось первым. Если настраиваемые атрибуты, связанные с `TypeDef` или `MemberDef` предназначена для блока компиляции (например, отметка времени компиляции члена), они не объединяются и само компилятор просьбой удалить или обновить эти данные.  
  
## <a name="requirements"></a>Требования  
 **Платформы:** См. раздел [Требования к системе](../../../../docs/framework/get-started/system-requirements.md).  
  
 **Заголовок.** Cor.h  
  
 **Библиотека:** Используется как ресурс в MSCorEE.dll  
  
 **Версии платформы .NET Framework:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]  
  
## <a name="see-also"></a>См. также

- [Интерфейс IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)
- [Интерфейс IMetaDataEmit2](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)
