---
title: Метод IMetaDataDispenserEx::SetOption
ms.date: 03/30/2017
api_name:
- IMetaDataDispenserEx.SetOption
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataDispenserEx::SetOption
helpviewer_keywords:
- IMetaDataDispenserEx::SetOption method [.NET Framework metadata]
- SetOption method [.NET Framework metadata]
ms.assetid: 9f1c7ccd-7fb2-41d8-aa00-24b823376527
topic_type:
- apiref
ms.openlocfilehash: bc30f9fb120db92ccfc1e7dd0560b3fe18c54b29
ms.sourcegitcommit: 9a39f2a06f110c9c7ca54ba216900d038aa14ef3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "74432727"
---
# <a name="imetadatadispenserexsetoption-method"></a>Метод IMetaDataDispenserEx::SetOption
Задает для указанного параметра заданное значение для текущей области метаданных. Параметр определяет, как обрабатываются вызовы к текущей области метаданных.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
HRESULT SetOption (  
    [in] REFGUID optionId,   
    [in] const VARIANT *pValue  
);  
```  
  
## <a name="parameters"></a>Параметры  
 `optionId`  
 окне Указатель на идентификатор GUID, указывающий параметр, который необходимо задать.  
  
 `pValue`  
 окне Значение, используемое для задания параметра. Тип этого значения должен быть вариантом типа указанного параметра.  
  
## <a name="remarks"></a>Примечания  
 В следующей таблице перечислены доступные идентификаторы GUID, на которые может указываться параметр `optionId`, а также соответствующие допустимые значения для параметра `pValue`.  
  
|GUID|Описание|`pValue`, параметр|  
|----------|-----------------|------------------------|  
|метадатачеккдупликатесфор|Определяет, какие элементы проверяются на наличие дубликатов. Каждый раз при вызове метода [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) , который создает новый элемент, можно попросить метод проверить, существует ли уже данный элемент в текущей области. Например, можно проверить существование `mdMethodDef` элементов. в этом случае при вызове [IMetaDataEmit::D ефинемесод](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md)будет проверять, не существует ли метод в текущей области. Эта проверка использует ключ, однозначно определяющий данный метод: родительский тип, имя и сигнатура.|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления [корчеккдупликатесфор](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) .|  
|метадатарефтодефчекк|Определяет, какие элементы, на которые имеются ссылки, преобразуются в определения. По умолчанию ядро метаданных оптимизирует код путем преобразования упоминаемого элемента в его определение, если элемент, на который указывает ссылка, фактически определен в текущей области.|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления [коррефтодефчекк](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) .|  
|метадатанотификатионфортокенмовемент|Определяет, какие повторное сопоставления токенов происходят при слиянии метаданных, создают обратные вызовы. Чтобы установить интерфейс [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) , используйте метод [IMetaDataEmit:: сесандлер](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) .|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления [корнотификатионфортокенмовемент](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) .|  
|метадатасетенк|Управляет поведением функции "изменить и продолжить" (ENC). В каждый момент времени может быть задан только один режим работы.|Параметр должен быть разновидностью типа UI4 и должен содержать значение перечисления [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) . Значение не является битовой маской.|  
|метадатаеррорифемитаутофордер|Элементы управления, которые выдают ошибки, не являющиеся заказами, создают обратные вызовы. Неупорядоченное порождение метаданных неустранимым; Однако при порождении метаданных в порядке, который подходит для механизма метаданных, метаданные более компактны, и поэтому их можно будет более эффективно искать. Используйте метод `IMetaDataEmit::SetHandler`, чтобы установить интерфейс [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) .|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления [кореррорифемитаутофордер](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) .|  
|метадатаимпортоптион|Определяет, какие виды элементов, удаленных во время ENC, извлекаются перечислителем.|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления [перечисления коримпортоптионс](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) .|  
|метадатасреадсафетйоптионс|Определяет, получает ли механизм метаданных блокировки потоков чтения/записи, тем самым обеспечивая потокобезопасность. По умолчанию механизм предполагает, что доступ осуществляется с помощью однопотокового вызова, поэтому блокировки не получаются. Клиенты отвечают за поддержание правильной синхронизации потоков при использовании API метаданных.|Параметр должен быть разновидностью типа UI4 и должен содержать значение перечисления [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) . Значение не является битовой маской.|  
|метадатаженератетцеадаптерс|Определяет, должен ли импортер библиотеки типов создавать адаптеры тесно связанных событий (обработки TCE) для контейнеров точек подключения COM.|Должен быть разновидностью типа BOOL. Если `pValue` имеет значение `true`, программа импорта библиотек типов создает адаптеры обработки TCE.|  
|метадататипелибимпортнамеспаце|Задает пространство имен, отличное от используемого по умолчанию, для импортируемой библиотеки типов.|Значение должно быть либо значением NULL, либо вариантом типа BSTR. Если `pValue` имеет значение null, то текущим пространством имен присваивается значение null. в противном случае для текущего пространства имен задается строка, которая хранится в типе BSTR типа Variant.|  
|метадаталинкероптионс|Определяет, должен ли компоновщик создавать сборку или файл модуля .NET Framework.|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) .|  
|метадатарунтимеверсион|Указывает версию среды CLR, для которой построен этот образ. Версия хранится в виде строки, например "v 1.0.3705".|Должно быть задано значение null, VT_EMPTY значение или вариант типа BSTR. Если `pValue` имеет значение null, версия среды выполнения устанавливается в NULL. Если `pValue` имеет VT_EMPTY, для версии задается значение по умолчанию, которое извлекается из версии Mscorwks. dll, в которой работает код метаданных. В противном случае версия среды выполнения задается как строка, которая хранится в типе BSTR типа Variant.|  
|метадатамержероптионс|Задает параметры для слияния метаданных.|Параметр должен быть разновидностью типа UI4 и должен содержать сочетание значений перечисления `MergeFlags`, описанное в файле Корхдр. h.|  
|метадатапресервелокалрефс|Отключает оптимизацию локальных ссылок в определениях.|Должен содержать сочетание значений перечисления [корлокалрефпресерватион](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) .|  
  
## <a name="requirements"></a>Требования  
 **Платформа:** См. раздел [требования к системе](../../../../docs/framework/get-started/system-requirements.md).  
  
 **Заголовок:** COR. h  
  
 **Библиотека:** Используется в качестве ресурса в MsCorEE. dll  
  
 **Версии платформы .NET Framework:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  
  
## <a name="see-also"></a>См. также

- [Интерфейс IMetaDataDispenserEx](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md)
- [Интерфейс IMetaDataDispenser](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)
