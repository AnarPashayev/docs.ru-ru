---
title: События загрузчика (трассировка событий Windows)
description: Изучите события трассировки событий Windows загрузчика, в том числе события предметной области приложения, события сборки загрузчика CLR, события модуля, события модуля домена CLR и события диапазона модуля.
ms.date: 03/30/2017
helpviewer_keywords:
- loader events [.NET Framework]
- ETW, loader events (CLR)
ms.assetid: cb403cc6-56f8-4609-b467-cdfa09f07909
ms.openlocfilehash: 8220e8e773409be76bc7522d57551f1bddb90e5d
ms.sourcegitcommit: cf5a800a33de64d0aad6d115ffcc935f32375164
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/20/2020
ms.locfileid: "86474362"
---
# <a name="loader-etw-events"></a>События загрузчика (трассировка событий Windows)
Эти события собирают информацию, относящуюся к загрузке и выгрузке доменов приложений, сборок и модулей.  
  
 Все события загрузчика создаются при использовании ключевого слова `LoaderKeyword` (0x8). События `DCStart` и `DCEnd` создаются при использовании ключевого слова `LoaderRundownKeyword` (0x8) с включенным ключевым словом `StartRundown`/`EndRundown` . (Дополнительные сведения см. в разделе [CLR ETW Keywords and Levels](clr-etw-keywords-and-levels.md).)  

## <a name="application-domain-events"></a>События домена приложения
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Событие|Level|  
|-----------------------------------|-----------|-----------|  
|`LoaderKeyword` (0x8)|`AppDomainLoad_V1` и `AppDomainUnLoad_V1`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `StartRundownKeyword`|`AppDomainDCStart_V1`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `EndRundownKeyword`|`AppDomainDCEnd_V1`|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|Событие|Идентификатор события|Описание|  
|-----------|--------------|-----------------|  
|`AppDomainLoad_V1` (регистрируется для всех доменов приложений)|156|Создается каждый раз, когда во время существования процесса создается домен приложения.|  
|`AppDomainUnLoad_V1`|157|Создается каждый раз, когда во время существования процесса уничтожается домен приложения.|  
|`AppDomainDCStart_V1`|157|Перечисляет домены приложений в течение очистки запуска.|  
|`AppDomainDCEnd_V1`|158|Перечисляет домены приложений в течение очистки завершения.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|AppDomainID|win:UInt64|Уникальный идентификатор домена приложения.|  
|AppDomainFlags|win:UInt32|0x1: домен по умолчанию.<br /><br /> 0x2: исполняемый файл.<br /><br /> 0x4: домен приложения, бит 28–31: политика общего доступа этого домена.<br /><br /> 0: общий домен.|  
|AppDomainName|win:UnicodeString|Понятное имя домена приложения. Может измениться в течение времени существования процесса.|  
|AppDomainIndex|win:UInt32|Индекс этого домена приложения.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  

## <a name="clr-loader-assembly-events"></a>События сборки загрузчика среды CLR  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Событие|Level|  
|-----------------------------------|-----------|-----------|  
|`LoaderKeyword` (0x8)|`AssemblyLoad` и `AssemblyUnload`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `StartRundownKeyword`|`AssemblyDCStart`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `EndRundownKeyword`|`AssemblyDCEnd`|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|Событие|Идентификатор события|Описание|  
|-----------|--------------|-----------------|  
|`AssemblyLoad_V1`|154|Наступает, когда сборка загружается.|  
|`AssemblyUnload_V1`|155|Наступает, когда сборка выгружается.|  
|`AssemblyDCStart_V1`|155|Перечисляет сборки во время очистки запуска.|  
|`AssemblyDCEnd_V1`|156|Перечисляет сборки во время очистки завершения.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|AssemblyID|win:UInt64|Уникальный идентификатор сборки.|  
|AppDomainID|win:UInt64|Идентификатор домена этой сборки.|  
|BindingID|win:UInt64|Идентификатор, уникальным образом определяющий привязку сборки.|  
|AssemblyFlags|win:UInt32|0x1: сборка, не зависящая от домена.<br /><br /> 0x2: динамическая сборка.<br /><br /> 0x4: сборка с образом в машинном коде.<br /><br /> 0x8: собираемая сборка.|  
|AssemblyName|win:UnicodeString|Полное имя сборки.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|

## <a name="module-events"></a>События модулей
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Событие|Level|  
|-----------------------------------|-----------|-----------|  
|`LoaderKeyword` (0x8)|`ModuleLoad_V2` и `ModuleUnload_V2`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `StartRundownKeyword`|`ModuleDCStart_V2`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `EndRundownKeyword`|`ModuleDCEnd_V2`|Информационный (4)|  
||||  
  
 В таблице ниже представлены сведения о событии.  
  
|Событие|Идентификатор события|Описание|  
|-----------|--------------|-----------------|  
|`ModuleLoad_V2`|152|Вызывается при загрузке модуля в течение времени существования процесса.|  
|`ModuleUnload_V2`|153|Вызывается при выгрузке модуля в течение времени существования процесса.|  
|`ModuleDCStart_V2`|153|Перечисляет модули во время очистки запуска.|  
|`ModuleDCEnd_V2`|154|Перечисляет модули во время очистки завершения.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|ModuleID|win:UInt64|Уникальный идентификатор модуля.|  
|AssemblyID|win:UInt64|Идентификатор сборки, в которой находится этот модуль.|  
|ModuleFlags|win:UInt32|0x1: модуль, не зависящий от домена.<br /><br /> 0x2: модуль с образом в машинном коде.<br /><br /> 0x4: динамический модуль.<br /><br /> 0x8: модуль манифеста.|  
|Reserved1|win:UInt32|Зарезервированное поле.|  
|ModuleILPath|win:UnicodeString|Путь к образу языка MSIL для модуля или имя динамического модуля, если это динамическая сборка (строка, заканчивающаяся нулем).|  
|ModuleNativePath|win:UnicodeString|Путь к образу модуля в машинном коде, если существует (строка, заканчивающаяся нулем).|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
|ManagedPdbSignature|win:GUID|Подпись GUID управляемой базы данных программы (PDB), которая соответствует этому модулю. (См. раздел «Примечания».)|  
|ManagedPdbAge|win:UInt32|Значение возраста, записанное в управляемую базу данных программы, соответствующую этому модулю. (См. раздел «Примечания».)|  
|ManagedPdbBuildPath|win:UnicodeString|Путь к расположению, где была выполнена сборка управляемой базы данных программы, соответствующей этому модулю. В некоторых случаях это просто имя файла. (См. раздел «Примечания».)|  
|NativePdbSignature|win:GUID|Подпись GUID базы данных программы для средства создания машинных образов (NGen), соответствующая этому модулю, если применимо. (См. раздел «Примечания».)|  
|NativePdbAge|win:UInt32|Значение возраста, записанное в базе данных программы NGen, соответствующей этому модулю, если применимо. (См. раздел «Примечания».)|  
|NativePdbBuildPath|win:UnicodeString|Путь к расположению, где была выполнена сборка базы данных программы NGen, соответствующей этому модулю, если применимо. В некоторых случаях это просто имя файла. (См. раздел «Примечания».)|  
  
### <a name="remarks"></a>Remarks  
  
- Поля, в именах которых есть строка Pdb, могут использоваться средствами профилирования для поиска баз данных программ, соответствующих модулям, которые были загружены во время сеанса профилирования. Значения этих полей соответствуют данным, записанным в разделах IMAGE_DIRECTORY_ENTRY_DEBUG модуля и обычно используемым отладчиками для поиска баз данных программ, соответствующих загруженным модулям.  
  
- Имена полей, которые начинаются с ManagedPdb, ссылаются на управляемую базу данных программы, соответствующую модулю MSIL, который был сформирован управляемым компилятором (например, компилятором C# или Visual Basic). Эта база данных программы использует управляемый формат PDB и описывает порядок сопоставления элементов (файлов, номеров строк и имен символов) из первоначального управляемого исходного кода с элементами MSIL, скомпилированными в модуль MSIL.  
  
- Имена полей, которые начинаются с NativePdb, ссылаются на базу данных программы NGen, созданную путем вызова метода `NGEN createPDB`. Эта база данных программы использует машинный формат PDB и описывает порядок сопоставления элементов (файлов, номеров строк и имен символов) из первоначального управляемого исходного кода с машинными элементами MSIL, скомпилированными в модуль NGen.  

## <a name="clr-domain-module-events"></a>События модулей домена среды CLR
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Событие|Level|  
|-----------------------------------|-----------|-----------|  
|`LoaderKeyword` (0x8)|`DomainModuleLoad_V1`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `StartRundownKeyword`|`DomainModuleDCStart_V1`|Информационный (4)|  
|`LoaderRundownKeyword` (0x8) +<br /><br /> `EndRundownKeyword`|`DomainModuleDCEnd_V1`|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|Событие|Идентификатор события|Описание|  
|-----------|--------------|-----------------|  
|`DomainModuleLoad_V1`|151|Вызывается при загрузке модуля для домена приложения.|  
|`DomainModuleDCStart_V1`|151|Перечисляет модули, загруженные для домена приложения во время очистки запуска, и регистрируется для всех доменов приложений.|  
|`DomainModuleDCEnd_V1`|152|Перечисляет модули, загруженные для домена приложения во время очистки завершения, и регистрируется для всех доменов приложений.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|ModuleID|win:UInt64|Определяет сборку, к которой относится этот модуль.|  
|AssemblyID|win:UInt64|Идентификатор сборки, в которой находится этот модуль.|  
|AppDomainID|win:UInt64|Идентификатор домена приложения, в котором используется этот модуль.|  
|ModuleFlags|win:UInt32|0x1: модуль, не зависящий от домена.<br /><br /> 0x2: модуль с образом в машинном коде.<br /><br /> 0x4: динамический модуль.<br /><br /> 0x8: модуль манифеста.|  
|Reserved1|win:UInt32|Зарезервированное поле.|  
|ModuleILPath|win:UnicodeString|Путь к образу языка MSIL для модуля или имя динамического модуля, если это динамическая сборка (строка, заканчивающаяся нулем).|  
|ModuleNativePath|win:UnicodeString|Путь к образу модуля в машинном коде, если существует (строка, заканчивающаяся нулем).|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  

## <a name="module-range-events"></a>События диапазона модуля
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Событие|Level|  
|-----------------------------------|-----------|-----------|  
|`PerfTrackKeyWord`)|`ModuleRange`|Информационный (4)|  
|`PerfTrackKeyWord`|`ModuleRangeDCStart`|Информационный (4)|  
|`PerfTrackKeyWord`|`ModuleRangeDCEnd`|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|Событие|Идентификатор события|Описание|  
|-----------|--------------|-----------------|  
|`ModuleRange`|158|Это событие присутствует, если загруженный образ генератора образов в машинном коде (NGen) был оптимизирован с помощью IBC, и содержит сведения об активных разделах образа NGen.|  
|`ModuleRangeDCStart`|160|Событие `ModuleRange` , инициируемое в начале очистки.|  
|`ModuleRangeDCEnd`|161|Событие `ModuleRange` , инициируемое в конце очистки.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|ClrInstanceID|win:UInt16|Однозначно определяет конкретный экземпляр среды CLR в процессе, если загружено несколько экземпляров среды CLR.|  
|ModuleID|win:UInt64|Определяет сборку, к которой относится этот модуль.|  
|RangeBegin|win:UInt32|Смещение в модуле, представляющее начало диапазона для указанного типа диапазона.|  
|RangeSize|win:UInt32|Размер указанного диапазона в байтах.|  
|RangeType|win:UInt32|Одно значение, 0x4, используемое для представления неактивных диапазонов IBC. В будущем это поле может представлять больше значений.|  
|RangeSize1|win:UInt32|0 обозначает недопустимые данные.|  
|RangeBegin2|win:UnicodeString||  
  
### <a name="remarks"></a>Remarks  
 Если загруженный образ NGen в процессе .NET Framework был оптимизирован с помощью IBC, событие `ModuleRange` , которое содержит активные диапазоны в образе NGen, регистрируется с идентификаторами `moduleID` и `ClrInstanceID`.  Если образ NGen не оптимизирован с помощью IBC, это событие не регистрируется. Для определения имени модуля это событие необходимо сопоставить с событиями ETW загрузки модуля.  
  
 Размер полезной нагрузки для этого события различен; поле `Count` указывает число смещений диапазона, которые содержатся в событии.  Для определения фактических диапазонов это событие нужно сопоставить с событием Windows `IStart` . Событие загрузки образа Windows регистрируется при каждой загрузке образа и содержит виртуальный адрес загруженного образа.  
  
 События диапазона модуля инициируются при любом уровне ETW не ниже 4 и классифицируются как информационные.  
  
## <a name="see-also"></a>См. также раздел

- [События трассировки событий Windows в среде CLR](clr-etw-events.md)
