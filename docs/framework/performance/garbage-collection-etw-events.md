---
title: События сборки мусора (трассировка событий Windows)
ms.date: 03/30/2017
helpviewer_keywords:
- GC events
- garbage collection events [.NET Framework]
- ETW, garbage collection events (CLR)
ms.assetid: f14b6fd7-0966-4d87-bc89-54ef3a44a94a
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 7f9bf0e309ec8c77d4b1d6afbf111e7eeae629ac
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59149738"
---
# <a name="garbage-collection-etw-events"></a>События сборки мусора (трассировка событий Windows)
<a name="top"></a> Эти события собирают сведения, относящиеся к сборке мусора. Они помогают при диагностике и отладке, в том числе позволяют определить, сколько раз осуществлялась сборка мусора, какой объем памяти был освобожден в ходе сборки мусора и т. д.  
  
 Эта категория состоит из следующих событий:  
  
-   [Событие GCStart_V1](#gcstart_v1_event)  
  
-   [Событие GCEnd_V1](#gcend_v1_event)  
  
-   [Событие GCHeapStats_V1](#gcheapstats_v1_event)  
  
-   [Событие GCCreateSegment_V1](#gccreatesegment_v1_event)  
  
-   [Событие GCFreeSegment_V1](#gcfreesegment_v1_event)  
  
-   [Событие GCRestartEEBegin_V1](#gcrestarteebegin_v1_event)  
  
-   [Событие GCRestartEEEnd_V1](#gcrestarteeend_v1_event)  
  
-   [Событие GCSuspendEE_V1](#gcsuspendee_v1_event)  
  
-   [Событие GCSuspendEEEnd_V1](#gcsuspendeeend_v1_event)  
  
-   [Событие GCAllocationTick_V2](#gcallocationtick_v2_event)  
  
-   [Событие GCFinalizersBegin_V1](#gcfinalizersbegin_v1_event)  
  
-   [Событие GCFinalizersEnd_V1](#gcfinalizersend_v1_event)  
  
-   [Событие GCCreateConcurrentThread_V1](#gccreateconcurrentthread_v1_event)  
  
-   [Событие GCTerminateConcurrentThread_V1](#gcterminateconcurrentthread_v1_event)  
  
<a name="gcstart_v1_event"></a>   
## <a name="gcstartv1-event"></a>Событие GCStart_V1  
 В таблице ниже показаны ключевое слово и уровень. (Дополнительные сведения см. в разделе [CLR ETW Keywords and Levels](../../../docs/framework/performance/clr-etw-keywords-and-levels.md).)  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCStart_V1`|1|Сборка мусора начата.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|Количество|win:UInt32|Сборка мусора, *n*-я по счету.|  
|Глубина|win:UInt32|Поколение, для которого выполняется сборка.|  
|Причина|win:UInt32|Причина запуска сборки мусора:<br /><br /> 0x0 — выделение кучи маленьких объектов.<br /><br /> 0x1 — принудительная.<br /><br /> 0x2 — недостаточно памяти.<br /><br /> 0x3 — пусто.<br /><br /> 0x4 — выделение кучи больших объектов.<br /><br /> 0x5 — недостаточно места (для кучи маленьких объектов).<br /><br /> 0x6 — недостаточно места (для кучи больших объектов).<br /><br /> 0x7 — принудительная, но не блокирующий.|  
|Тип|win:UInt32|0x0 — блокировка сборки мусора вне фоновой сборки мусора.<br /><br /> 0x1 — фоновая сборка мусора.<br /><br /> 0x2 — блокировка сборки мусора в ходе фоновой сборки мусора.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 [К началу](#top)  
  
<a name="gcend_v1_event"></a>   
## <a name="gcendv1-event"></a>Событие GCEnd_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCEnd_V1`|2|Сборка мусора закончена.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|Количество|win:UInt32|Сборка мусора, *n*-я по счету.|  
|Глубина|win:UInt32|Поколение, для которого выполнялась сборка.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 [К началу](#top)  
  
<a name="gcheapstats_v1_event"></a>   
## <a name="gcheapstatsv1-event"></a>Событие GCHeapStats_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Описание|  
|-----------|--------------|-----------------|  
|`GCHeapStats_V1`|4|Показывает статистику кучи по завершении каждой сборки мусора.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|GenerationSize0|win:UInt64|Размер области памяти поколения 0 (в байтах).|  
|TotalPromotedSize0|win:UInt64|Число байт, которые были переданы из поколения 0 в поколение 1.|  
|GenerationSize1|win:UInt64|Размер области памяти поколения 1 (в байтах).|  
|TotalPromotedSize1|win:UInt64|Число байт, которые были переданы из поколения 1 в поколение 2.|  
|GenerationSize2|win:UInt64|Размер области памяти поколения 2 (в байтах).|  
|TotalPromotedSize2|win:UInt64|Число байт, оставшихся в поколении 2 после последней сборки.|  
|GenerationSize3|win:UInt64|Размер кучи больших объектов (в байтах).|  
|TotalPromotedSize3|win:UInt64|Число байт, оставшихся в куче больших объектов после последней сборки.|  
|FinalizationPromotedSize|win:UInt64|Общий размер (в байтах) объектов, которые готовы к завершению.|  
|FinalizationPromotedCount|win:UInt64|Количество объектов, которые готовы к завершению.|  
|PinnedObjectCount|win:UInt32|Количество закрепленных (неподвижных) объектов.|  
|SinkBlockCount|win:UInt32|Количество используемых блоков синхронизации.|  
|GCHandleCount|win:UInt32|Число используемых дескрипторов сборки мусора.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 [К началу](#top)  
  
<a name="gccreatesegment_v1_event"></a>   
## <a name="gccreatesegmentv1-event"></a>Событие GCCreateSegment_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCCreateSegment_V1`|5|Был создан новый сегмент сборки мусора. Кроме того, при включении трассировки для уже работающего процесса это событие создается для каждого существующего сегмента.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|Адрес|win:UInt64|Адрес сегмента.|  
|Размер|win:UInt64|Размер сегмента.|  
|Тип|win:UInt32|0x0 — куча маленьких объектов.<br /><br /> 0x1 — куча больших объектов.<br /><br /> 0x2 — куча только для чтения.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 Обратите внимание, что размер сегментов, выделенных сборщиком мусора, зависит от реализации и может быть изменен в любое время, в том числе при периодических обновлениях. Приложение не должно делать никаких допущений относительно размера определенного сегмента, полагаться на него или пытаться настроить объем памяти, доступный для выделения сегментов.  
  
 [К началу](#top)  
  
<a name="gcfreesegment_v1_event"></a>   
## <a name="gcfreesegmentv1-event"></a>Событие GCFreeSegment_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCFreeSegment_V1`|6|Сегмент сборки мусора был освобожден.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|Адрес|win:UInt64|Адрес сегмента.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 [К началу](#top)  
  
<a name="gcrestarteebegin_v1_event"></a>   
## <a name="gcrestarteebeginv1-event"></a>Событие GCRestartEEBegin_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCRestartEEBegin_V1`|7|Началось возобновление приостановленной среды CLR.|  
  
 Нет данных события.  
  
 [К началу](#top)  
  
<a name="gcrestarteeend_v1_event"></a>   
## <a name="gcrestarteeendv1-event"></a>Событие GCRestartEEEnd_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCRestartEEEnd_V1`|3|Возобновление приостановленной среды CLR завершено.|  
  
 Нет данных события.  
  
 [К началу](#top)  
  
<a name="gcsuspendee_v1_event"></a>   
## <a name="gcsuspendeev1-event"></a>Событие GCSuspendEE_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCSuspendEE_V1`|9|Началась приостановка механизма выполнения сборки мусора.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|Причина|win:UInt16|0x0 — другое.<br /><br /> 0x1 — сборка мусора.<br /><br /> 0x2 — завершение работы домена приложения.<br /><br /> 0x3 — свертка кода.<br /><br /> 0x4 — завершение работы.<br /><br /> 0x5 — отладчик.<br /><br /> 0x6 — подготовка к сборке мусора.|  
|Количество|win:UInt32|Счетчик сборки мусора на текущий момент времени. Обычно после этого отображается последующее событие запуска сборки мусора, а значение увеличивается на 1 в соответствии с увеличением индекса сборки мусора в ходе этого процесса.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 [К началу](#top)  
  
<a name="gcsuspendeeend_v1_event"></a>   
## <a name="gcsuspendeeendv1-event"></a>Событие GCSuspendEEEnd_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCSuspendEEEnd_V1`|8|Завершена приостановка механизма выполнения сборки мусора.|  
  
 Нет данных события.  
  
 [К началу](#top)  
  
<a name="gcallocationtick_v2_event"></a>   
## <a name="gcallocationtickv2-event"></a>Событие GCAllocationTick_V2  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCAllocationTick_V2`|10|Каждый раз выделяется около 100 КБ.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|AllocationAmount|win:UInt32|Размер выделения в байтах. Это значение является точным для выделений, размер которых меньше длины ULONG (4 294 967 295 байт). Если выделение больше, это поле содержит усеченное значение. Используйте `AllocationAmount64` для очень больших выделений.|  
|AllocationKind|win:UInt32|0x0 — выделение для маленького объекта (выделение в куче маленьких объектов).<br /><br /> 0x1 — выделение для большого объекта (выделение в куче больших объектов).|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
|AllocationAmount64|win:UInt64|Размер выделения в байтах. Это значение является точным для очень больших выделений.|  
|TypeId|win:Pointer|Адрес MethodTable. Если в ходе этого события было выделено несколько типов объектов, указывается адрес MethodTable, соответствующий последнему выделенному объекту (объекту, вызвавшему превышение порогового значения 100 КБ).|  
|TypeName|win:UnicodeString|Имя выделенного типа. Если в ходе этого события было выделено несколько типов объектов, указывается тип последнего выделенного объекта (объекта, вызвавшего превышение порогового значения 100 КБ).|  
|HeapIndex|win:UInt32|Куча, в которой был выделен объект. Это значение равно 0 (нулю) при выполнении сборки мусора на рабочей станции.|  
  
 [К началу](#top)  
  
<a name="gcfinalizersbegin_v1_event"></a>   
## <a name="gcfinalizersbeginv1-event"></a>Событие GCFinalizersBegin_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCFinalizersBegin_V1`|14|Начало выполнения методов завершения.|  
  
 Нет данных события.  
  
 [К началу](#top)  
  
<a name="gcfinalizersend_v1_event"></a>   
## <a name="gcfinalizersendv1-event"></a>Событие GCFinalizersEnd_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCFinalizersEnd_V1`|13|Завершение выполнения методов завершения.|  
  
 В таблице ниже представлены данные события.  
  
|Имя поля|Тип данных|Описание|  
|----------------|---------------|-----------------|  
|Количество|win:UInt32|Число выполненных методов завершения.|  
|ClrInstanceID|win:UInt16|Уникальный идентификатор экземпляра CLR или CoreCLR.|  
  
 [К началу](#top)  
  
<a name="gccreateconcurrentthread_v1_event"></a>   
## <a name="gccreateconcurrentthreadv1-event"></a>Событие GCCreateConcurrentThread_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
|`ThreadingKeyword` (0x10000)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCCreateConcurrentThread_V1`|11|Был создан параллельный поток сборки мусора.|  
  
 Нет данных события.  
  
 [К началу](#top)  
  
<a name="gcterminateconcurrentthread_v1_event"></a>   
## <a name="gcterminateconcurrentthreadv1-event"></a>Событие GCTerminateConcurrentThread_V1  
 В таблице ниже показаны ключевое слово и уровень.  
  
|Ключевое слово для вызова события|Уровень|  
|-----------------------------------|-----------|  
|`GCKeyword` (0x1)|Информационный (4)|  
|`ThreadingKeyword` (0x10000)|Информационный (4)|  
  
 В таблице ниже представлены сведения о событии.  
  
|событие|Идентификатор события|Условие вызова|  
|-----------|--------------|-----------------|  
|`GCTerminateConcurrentThread_V1`|12|Параллельный поток сборки мусора был завершен.|  
  
 Нет данных события.  
  
## <a name="see-also"></a>См. также

- [События трассировки событий Windows в среде CLR](../../../docs/framework/performance/clr-etw-events.md)
