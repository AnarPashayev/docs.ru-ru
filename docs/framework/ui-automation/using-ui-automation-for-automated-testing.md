---
title: Использование Автоматизации Пользовательского Интерфейса для автоматизированного тестирования
ms.date: 03/30/2017
helpviewer_keywords:
- automated testing
- testing, UI Automation
- UI Automation, automated testing
ms.assetid: 3a0435c0-a791-4ad7-ba92-a4c1d1231fde
ms.openlocfilehash: 1137052c13571cf31fdf98512f2fe62533387e80
ms.sourcegitcommit: d55e14eb63588830c0ba1ea95a24ce6c57ef8c8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2019
ms.locfileid: "67802253"
---
# <a name="using-ui-automation-for-automated-testing"></a><span data-ttu-id="da985-102">Использование Автоматизации Пользовательского Интерфейса для автоматизированного тестирования</span><span class="sxs-lookup"><span data-stu-id="da985-102">Using UI Automation for Automated Testing</span></span>
> [!NOTE]
>  <span data-ttu-id="da985-103">Эта документация предназначена для разработчиков .NET Framework, желающих использовать управляемые классы [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , заданные в пространстве имен <xref:System.Windows.Automation> .</span><span class="sxs-lookup"><span data-stu-id="da985-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="da985-104">Для получения последних сведений о [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], см. в разделе [API автоматизации Windows: Модели автоматизации пользовательского интерфейса](https://go.microsoft.com/fwlink/?LinkID=156746).</span><span class="sxs-lookup"><span data-stu-id="da985-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="da985-105">В этом обзоре описывается, как можно использовать [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] в качестве платформы для программного доступа в скриптах автоматического тестирования.</span><span class="sxs-lookup"><span data-stu-id="da985-105">This overview describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] can be useful as a framework for programmatic access in automated testing scenarios.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="da985-106">предоставляет унифицированную объектную модель, поддерживающую все платформы [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] для представления сложных и широких функциональных возможностей доступным и легко автоматизируемым образом.</span><span class="sxs-lookup"><span data-stu-id="da985-106">provides a unified object model that enables all [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] frameworks to expose complex and rich functionality in an accessible and easily automated manner.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="da985-107">была разработана для замены Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="da985-107">was developed as a successor to Microsoft Active Accessibility.</span></span> <span data-ttu-id="da985-108">Active Accessibility — это существующая платформа обеспечивает решение по обеспечению доступности приложений и элементов управления.</span><span class="sxs-lookup"><span data-stu-id="da985-108">Active Accessibility is an existing framework designed to provide a solution for making controls and applications accessible.</span></span> <span data-ttu-id="da985-109">Active Accessibility не была разработана с помощью автоматизации тестирования, несмотря на то, что она стала выполнять эту роль из-за очень схожих требований доступности и автоматизации.</span><span class="sxs-lookup"><span data-stu-id="da985-109">Active Accessibility was not designed with test automation in mind even though it evolved into that role due to the very similar requirements of accessibility and automation.</span></span> <span data-ttu-id="da985-110">Помимо предоставления более качественных решений для специальных возможностей, модель[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]также специально разрабатывалась в целях предоставления надежной функциональности для автоматического тестирования.</span><span class="sxs-lookup"><span data-stu-id="da985-110">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], in addition to providing more refined solutions for accessibility, is also specifically designed to provide robust functionality for automated testing.</span></span> <span data-ttu-id="da985-111">Например Active Accessibility полагается на единый интерфейс для предоставления информации о пользовательском Интерфейсе и сбора сведений, необходимых для продуктов; [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] разделяет эти две модели.</span><span class="sxs-lookup"><span data-stu-id="da985-111">For example, Active Accessibility relies on a single interface to both expose information about the UI and collect the information needed by AT products; [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] separates the two models.</span></span>  
  
 <span data-ttu-id="da985-112">Чтобы модель [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] можно было использовать в качестве средства автоматических тестов, для ее реализации требуется как клиент, так и поставщик.</span><span class="sxs-lookup"><span data-stu-id="da985-112">Both a provider and client are required to implement [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] for it to be useful as an automated test tool.</span></span> <span data-ttu-id="da985-113">Поставщики автоматизации пользовательского интерфейса — это приложения, такие как Microsoft Word, Excel, а также другие сторонние приложения или элементы управления на основе операционной системы [!INCLUDE[TLA#tla_win](../../../includes/tlasharptla-win-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="da985-113">UI Automation providers are applications such as Microsoft Word, Excel, and other third-party applications or controls based on the [!INCLUDE[TLA#tla_win](../../../includes/tlasharptla-win-md.md)] operating system.</span></span> <span data-ttu-id="da985-114">Клиенты автоматизации пользовательского интерфейса включают скрипты автоматических тестов приложения и приложения специальных возможностей.</span><span class="sxs-lookup"><span data-stu-id="da985-114">UI Automation clients include automated test scripts and assistive technology applications.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="da985-115">Цель этого обзора заключается в том, чтобы показать новые и улучшенные возможности автоматического тестирования [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-115">The intent of this overview is to showcase the new and improved automated testing capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span> <span data-ttu-id="da985-116">В данном обзоре не предполагается предоставлять сведения о специальных возможностях, и тема доступности будет затрагиваться только там, где это необходимо.</span><span class="sxs-lookup"><span data-stu-id="da985-116">This overview is not intended to provide information on accessibility features and will not address accessibility other than where necessary.</span></span>  
  
<a name="Using_UI_Automation_During_Development"></a>   
## <a name="ui-automation-in-a-provider"></a><span data-ttu-id="da985-117">Модель автоматизации пользовательского интерфейса в поставщике</span><span class="sxs-lookup"><span data-stu-id="da985-117">UI Automation in a Provider</span></span>  
 <span data-ttu-id="da985-118">Для автоматизации [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] разработчик приложения или элемента управления должен рассмотреть, какие действия может выполнять конечный пользователь в объекте [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] , используя стандартное взаимодействие с помощью клавиатуры и мыши.</span><span class="sxs-lookup"><span data-stu-id="da985-118">For a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to be automated, a developer of an application or control must look at what actions an end-user can perform on the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] object using standard keyboard and mouse interaction.</span></span>  
  
 <span data-ttu-id="da985-119">После определения этих ключевых действий в элементе управления необходимо реализовать соответствующие шаблоны элементов управления [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] (то есть шаблоны элементов управления, отражающие функциональность и поведение элемента [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] ).</span><span class="sxs-lookup"><span data-stu-id="da985-119">Once these key actions have been identified, the corresponding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns (that is, the control patterns that mirror the functionality and behavior of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] element) should be implemented on the control.</span></span> <span data-ttu-id="da985-120">Например, взаимодействие пользователя с элементом управления "поле со списком" (таким как диалоговое окно запуска) обычно включает развертывание и свертывание поля со списком для отображения или скрытия списка элементов, выбор элемента из списка или добавление нового значения путем ввода с клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="da985-120">For example, user interaction with a combo box control (such as the run dialog) typically involves expanding and collapsing the combo box to hide or display a list of items, selecting an item from that list, or adding a new value via keyboard input.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="da985-121">В других моделях специальных возможностей разработчики должны собирать сведения непосредственно из отдельных кнопок, меню и других элементов управления.</span><span class="sxs-lookup"><span data-stu-id="da985-121">With other accessibility models, developers must gather information directly from individual buttons, menus, or other controls.</span></span> <span data-ttu-id="da985-122">К несчастью, каждый тип элемента управления поставляется в десятках вспомогательных вариантов.</span><span class="sxs-lookup"><span data-stu-id="da985-122">Unfortunately, every control type comes in dozens of minor variations.</span></span> <span data-ttu-id="da985-123">Другими словами, даже если десять вариантов кнопки работают одинаково и выполняют ту же функцию, все они должны рассматриваться как отдельные элементы управления.</span><span class="sxs-lookup"><span data-stu-id="da985-123">In other words, even though ten variations of a pushbutton may all work the same way and perform the same function, they must all be treated as unique controls.</span></span> <span data-ttu-id="da985-124">Нет способа узнать, что эти элементы управления функционально эквивалентны.</span><span class="sxs-lookup"><span data-stu-id="da985-124">There is no way to know that these controls are functionally equivalent.</span></span> <span data-ttu-id="da985-125">Шаблоны элементов управления были разработаны для представления такого общего поведения элементов управления.</span><span class="sxs-lookup"><span data-stu-id="da985-125">Control patterns were developed to represent these common control behaviors.</span></span> <span data-ttu-id="da985-126">Для получения дополнительной информации см. [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-126">For more information, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>  
  
<a name="Implementing_UI_Automation"></a>   
### <a name="implementing-ui-automation"></a><span data-ttu-id="da985-127">Реализация автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="da985-127">Implementing UI Automation</span></span>  
 <span data-ttu-id="da985-128">Как упоминалось ранее, без единой модели, предоставляемой [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], средствам тестирования и разработчикам необходимо знать информацию о среде, чтобы представлять свойства и поведение элементов управления в этой среде.</span><span class="sxs-lookup"><span data-stu-id="da985-128">As mentioned earlier, without the unified model provided by [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], test tools and developers are required to know framework-specific information in order to expose properties and behaviors of controls in that framework.</span></span> <span data-ttu-id="da985-129">Так как может существовать несколько разных инфраструктур пользовательского интерфейса одновременно в операционных системах Windows, включая [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)], [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)], и Windows Presentation Foundation (WPF), может быть сложной задачей для проверки нескольких приложений с элементы управления, выглядящих одинаковыми.</span><span class="sxs-lookup"><span data-stu-id="da985-129">Since there can be several different UI frameworks present at any single time within Windows operating systems, including [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)], [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)], and Windows Presentation Foundation (WPF), it can be a daunting task to test multiple applications with controls that seem similar.</span></span> <span data-ttu-id="da985-130">Например, в следующей таблице перечислены относящиеся к конкретной инфраструктуре имена свойств, необходимые для извлечения имени (или текста), связанного с элементом управления "Кнопка", и приведено единственное эквивалентное свойство [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="da985-130">For example, the following table outlines the framework-specific property names required to retrieve the name (or text) associated with a button control and shows the single equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property.</span></span>  
  
|<span data-ttu-id="da985-131">Тип элемента управления модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="da985-131">UI Automation Control Type</span></span>|<span data-ttu-id="da985-132">Инфраструктура пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="da985-132">UI Framework</span></span>|<span data-ttu-id="da985-133">Свойство инфраструктуры</span><span class="sxs-lookup"><span data-stu-id="da985-133">Framework Specific Property</span></span>|<span data-ttu-id="da985-134">Свойство модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="da985-134">UI Automation Property</span></span>|  
|--------------------------------|------------------|---------------------------------|----------------------------|  
|<span data-ttu-id="da985-135">Кнопка</span><span class="sxs-lookup"><span data-stu-id="da985-135">Button</span></span>|<span data-ttu-id="da985-136">Windows Presentation Foundation (WPF)</span><span class="sxs-lookup"><span data-stu-id="da985-136">Windows Presentation Foundation</span></span>|<span data-ttu-id="da985-137">Content</span><span class="sxs-lookup"><span data-stu-id="da985-137">Content</span></span>|<span data-ttu-id="da985-138">NameProperty</span><span class="sxs-lookup"><span data-stu-id="da985-138">NameProperty</span></span>|  
|<span data-ttu-id="da985-139">Кнопка</span><span class="sxs-lookup"><span data-stu-id="da985-139">Button</span></span>|<span data-ttu-id="da985-140">Win32</span><span class="sxs-lookup"><span data-stu-id="da985-140">Win32</span></span>|<span data-ttu-id="da985-141">Заголовок</span><span class="sxs-lookup"><span data-stu-id="da985-141">Caption</span></span>|<span data-ttu-id="da985-142">NameProperty</span><span class="sxs-lookup"><span data-stu-id="da985-142">NameProperty</span></span>|  
|<span data-ttu-id="da985-143">Изображение</span><span class="sxs-lookup"><span data-stu-id="da985-143">Image</span></span>|<span data-ttu-id="da985-144">HTML</span><span class="sxs-lookup"><span data-stu-id="da985-144">HTML</span></span>|<span data-ttu-id="da985-145">alt</span><span class="sxs-lookup"><span data-stu-id="da985-145">alt</span></span>|<span data-ttu-id="da985-146">NameProperty</span><span class="sxs-lookup"><span data-stu-id="da985-146">NameProperty</span></span>|  
  
 <span data-ttu-id="da985-147">Поставщики автоматизации пользовательского интерфейса отвечают за сопоставление свойств элементов управления, относящихся к инфраструктуре, с эквивалентными свойствами [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="da985-147">UI Automation providers are responsible for mapping the framework-specific properties of their controls to the equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
 <span data-ttu-id="da985-148">Сведения о реализации [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] в поставщике см. в разделе [UI Automation Providers for Managed Code](../../../docs/framework/ui-automation/ui-automation-providers-for-managed-code.md).</span><span class="sxs-lookup"><span data-stu-id="da985-148">Information on implementing [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] in a provider can be found at [UI Automation Providers for Managed Code](../../../docs/framework/ui-automation/ui-automation-providers-for-managed-code.md).</span></span> <span data-ttu-id="da985-149">Сведения о реализации шаблонов элементов управления см. в разделах [UI Automation Control Patterns](../../../docs/framework/ui-automation/ui-automation-control-patterns.md) и [UI Automation Text Pattern](../../../docs/framework/ui-automation/ui-automation-text-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="da985-149">Information on implementing control patterns is available at [UI Automation Control Patterns](../../../docs/framework/ui-automation/ui-automation-control-patterns.md) and [UI Automation Text Pattern](../../../docs/framework/ui-automation/ui-automation-text-pattern.md).</span></span>  
  
<a name="Testing_with_UI_Automation"></a>   
## <a name="ui-automation-in-a-client"></a><span data-ttu-id="da985-150">Модель автоматизации пользовательского интерфейса в клиенте</span><span class="sxs-lookup"><span data-stu-id="da985-150">UI Automation in a Client</span></span>  
 <span data-ttu-id="da985-151">Цель многих средств и сценариев автоматического тестирования состоит в согласованной и воспроизводимой обработке пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="da985-151">The goal of many automated test tools and scenarios is the consistent and repeatable manipulation of the user interface.</span></span> <span data-ttu-id="da985-152">Это может включать модульное тестирование определенных элементов управления с помощью записи и воспроизведения скриптов тестирования, которые выполняют итерацию по ряду универсальных действий в группе элементов управления.</span><span class="sxs-lookup"><span data-stu-id="da985-152">This can involve unit testing specific controls through to the recording and playback of test scripts that iterate through a series of generic actions on a group of controls.</span></span>  
  
 <span data-ttu-id="da985-153">Осложнение, вытекающее из автоматических приложений, заключается в трудности синхронизации тестирования с динамической целью.</span><span class="sxs-lookup"><span data-stu-id="da985-153">A complication that arises from automated applications is the difficulty synchronizing a test with a dynamic target.</span></span> <span data-ttu-id="da985-154">Например, элемент управления "Список", такой как в диспетчере задач Windows, отображает список запущенных приложений.</span><span class="sxs-lookup"><span data-stu-id="da985-154">For example, a list box control, such as one contained in the Windows Task Manager, that displays a list of currently running applications.</span></span> <span data-ttu-id="da985-155">Поскольку элементы в этом списке динамически обновляются независимо от тестового приложения, невозможно повторять выбор определенного элемента в списке с каким-либо постоянством.</span><span class="sxs-lookup"><span data-stu-id="da985-155">Since the items in the list box are dynamically updated outside the control of the test application, attempting to repeat the selection of a specific item in the list box with any consistency is impossible.</span></span> <span data-ttu-id="da985-156">Аналогичные проблемы также могут возникнуть при попытке повторить простые изменения фокуса в [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] , который находится вне рамок влияния тестового приложения.</span><span class="sxs-lookup"><span data-stu-id="da985-156">Similar issues can also arise when attempting to repeat simple focus changes in a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] that is outside the control of the test application.</span></span>  
  
<a name="Programmatic_Access"></a>   
### <a name="programmatic-access"></a><span data-ttu-id="da985-157">Программный доступ</span><span class="sxs-lookup"><span data-stu-id="da985-157">Programmatic Access</span></span>  
 <span data-ttu-id="da985-158">Программный доступ предоставляет возможность имитировать через код любое взаимодействие, обеспечиваемое традиционным вводом с помощью мыши и клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="da985-158">Programmatic access provides the ability to imitate, through code, any interaction and experience exposed by traditional mouse and keyboard input.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="da985-159">обеспечивает программный доступ с помощью пяти следующих компонентов.</span><span class="sxs-lookup"><span data-stu-id="da985-159">enables programmatic access through five components:</span></span>  
  
- <span data-ttu-id="da985-160">Дерево [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] упрощает навигацию по структуре [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-160">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree facilitates navigation through the structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="da985-161">Это дерево строится из коллекции hWnd.</span><span class="sxs-lookup"><span data-stu-id="da985-161">The tree is built from the collection of hWnd's.</span></span> <span data-ttu-id="da985-162">Дополнительные сведения см. в разделе [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-162">For more information, see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</span></span>  
  
- <span data-ttu-id="da985-163">Элементы автоматизации — это отдельные компоненты в [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-163">Automation elements are individual components in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="da985-164">Часто они могут быть более детализированы, чем hWnd.</span><span class="sxs-lookup"><span data-stu-id="da985-164">These can often be more granular than an hWnd.</span></span> <span data-ttu-id="da985-165">Для получения дополнительной информации см. [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-165">For more information, see [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md).</span></span>  
  
- <span data-ttu-id="da985-166">Свойства автоматизации предоставляют определенные сведения об элементах [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="da985-166">Automation properties provide specific information about [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="da985-167">Дополнительные сведения см. в разделе [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-167">For more information, see [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).</span></span>  
  
- <span data-ttu-id="da985-168">Шаблоны элементов управления задают определенный аспект функциональности элемента управления; они могут состоять из свойств, методов, событий и сведений о структуре.</span><span class="sxs-lookup"><span data-stu-id="da985-168">Control patterns define a particular aspect of a control's functionality; they can consist of property, method, event, and structure information.</span></span> <span data-ttu-id="da985-169">Для получения дополнительной информации см. [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-169">For more information, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>  
  
- <span data-ttu-id="da985-170">События автоматизации обеспечивают уведомления и информацию.</span><span class="sxs-lookup"><span data-stu-id="da985-170">Automation events provide event notifications and information.</span></span> <span data-ttu-id="da985-171">Для получения дополнительной информации см. [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-171">For more information, see [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md).</span></span>  
  
<a name="Key_properties_critical_to_test_automation"></a>   
### <a name="key-properties-for-test-automation"></a><span data-ttu-id="da985-172">Ключевые свойства для автоматизации тестирования</span><span class="sxs-lookup"><span data-stu-id="da985-172">Key Properties for Test Automation</span></span>  
 <span data-ttu-id="da985-173">Возможность уникально идентифицировать и затем находить любой элемент управления в [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] служит основой для работы приложений автоматизированного тестирования в этом [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-173">The ability to uniquely identify and subsequently locate any control within the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] provides the basis for automated test applications to operate on that [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="da985-174">Существует несколько свойств [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] , используемых клиентами и поставщиками, которые помогают в этом.</span><span class="sxs-lookup"><span data-stu-id="da985-174">There are several [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] properties used by clients and providers that assist in this.</span></span>  
  
#### <a name="automationid"></a><span data-ttu-id="da985-175">AutomationId</span><span class="sxs-lookup"><span data-stu-id="da985-175">AutomationID</span></span>  
 <span data-ttu-id="da985-176">Уникально идентифицирует элемент автоматизации среди элементов того же уровня.</span><span class="sxs-lookup"><span data-stu-id="da985-176">Uniquely identifies an automation element from its siblings.</span></span> <span data-ttu-id="da985-177">Элемент<xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> не локализован, в отличие от свойства, такого как <xref:System.Windows.Automation.AutomationElement.NameProperty> , которое обычно локализуется, если продукт поставляется на нескольких языках.</span><span class="sxs-lookup"><span data-stu-id="da985-177"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is not localized, unlike a property such as <xref:System.Windows.Automation.AutomationElement.NameProperty> that is typically localized if a product gets shipped in multiple languages.</span></span> <span data-ttu-id="da985-178">См. раздел [Use the AutomationID Property](../../../docs/framework/ui-automation/use-the-automationid-property.md).</span><span class="sxs-lookup"><span data-stu-id="da985-178">See [Use the AutomationID Property](../../../docs/framework/ui-automation/use-the-automationid-property.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="da985-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> не гарантирует уникальную идентификацию по всему дереву автоматизации.</span><span class="sxs-lookup"><span data-stu-id="da985-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the automation tree.</span></span> <span data-ttu-id="da985-180">Например, приложение может содержать элемент управления меню с несколькими пунктами меню верхнего уровня, которые, в свою очередь, имеют несколько дочерних пунктов меню.</span><span class="sxs-lookup"><span data-stu-id="da985-180">For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items.</span></span> <span data-ttu-id="da985-181">Эти пункты меню второго уровня могут идентифицироваться по универсальной схеме, такой как "элемент1, элемент2, элемент3 и т. д.", что допускает повторяющиеся идентификаторы дочерних элементов в разных пунктах меню верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="da985-181">These secondary menu items may be identified by a generic scheme such as "Item1, Item 2, Item3, etc.", allowing duplicate identifiers for children across top-level menu items.</span></span>  
  
#### <a name="controltype"></a><span data-ttu-id="da985-182">ControlType</span><span class="sxs-lookup"><span data-stu-id="da985-182">ControlType</span></span>  
 <span data-ttu-id="da985-183">Определяет тип элемента управления, представленного элементом автоматизации.</span><span class="sxs-lookup"><span data-stu-id="da985-183">Identifies the type of control represented by an automation element.</span></span> <span data-ttu-id="da985-184">Из знания типа элемента управления могут быть получены важные сведения.</span><span class="sxs-lookup"><span data-stu-id="da985-184">Significant information can be inferred from knowledge of the control type.</span></span> <span data-ttu-id="da985-185">См. раздел [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-185">See [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md).</span></span>  
  
#### <a name="nameproperty"></a><span data-ttu-id="da985-186">NameProperty</span><span class="sxs-lookup"><span data-stu-id="da985-186">NameProperty</span></span>  
 <span data-ttu-id="da985-187">Это текстовая строка, которая определяет или описывает элемент управления.</span><span class="sxs-lookup"><span data-stu-id="da985-187">This is a text string that identifies or explains a control.</span></span> <span data-ttu-id="da985-188">Свойство<xref:System.Windows.Automation.AutomationElement.NameProperty> следует использовать с осторожностью, поскольку оно может быть локализовано.</span><span class="sxs-lookup"><span data-stu-id="da985-188"><xref:System.Windows.Automation.AutomationElement.NameProperty> should be used with caution since it can be localized.</span></span> <span data-ttu-id="da985-189">См. раздел [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-189">See [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).</span></span>  
  
<a name="Steps_Required_To_Automate_the_UI_in_a_Test_Application"></a>   
### <a name="implementing-ui-automation-in-a-test-application"></a><span data-ttu-id="da985-190">Реализация автоматизации пользовательского интерфейса в тестовом приложении</span><span class="sxs-lookup"><span data-stu-id="da985-190">Implementing UI Automation in a Test Application</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="da985-191">Добавление ссылок для автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="da985-191">Add the UI Automation References.</span></span>|<span data-ttu-id="da985-192">Ниже перечислены библиотеки DLL [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , необходимые для клиентов автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="da985-192">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dll's necessary for UI Automation clients are listed here.</span></span><br /><br /> <span data-ttu-id="da985-193">-UIAutomationClient.dll предоставляет доступ к [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] клиентским API-интерфейсам.</span><span class="sxs-lookup"><span data-stu-id="da985-193">-   UIAutomationClient.dll provides access to the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] client-side APIs.</span></span><br /><span data-ttu-id="da985-194">-UIAutomationClientSideProvider.dll предоставляет возможность автоматизировать [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] элементов управления.</span><span class="sxs-lookup"><span data-stu-id="da985-194">-   UIAutomationClientSideProvider.dll provides the ability to automate [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls.</span></span> <span data-ttu-id="da985-195">См. раздел [UI Automation Support for Standard Controls](../../../docs/framework/ui-automation/ui-automation-support-for-standard-controls.md).</span><span class="sxs-lookup"><span data-stu-id="da985-195">See [UI Automation Support for Standard Controls](../../../docs/framework/ui-automation/ui-automation-support-for-standard-controls.md).</span></span><br /><span data-ttu-id="da985-196">-UIAutomationTypes.dll предоставляет доступ к определенным типам, определенным в [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-196">-   UIAutomationTypes.dll provides access to the specific types defined in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>|  
|<span data-ttu-id="da985-197">Добавление пространства имен <xref:System.Windows.Automation></span><span class="sxs-lookup"><span data-stu-id="da985-197">Add the <xref:System.Windows.Automation> namespace.</span></span>|<span data-ttu-id="da985-198">Это пространство имен содержит все клиенты автоматизации пользовательского интерфейса, необходимые для использования возможностей [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , за исключением обработки текста.</span><span class="sxs-lookup"><span data-stu-id="da985-198">This namespace contains everything UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] except text handling.</span></span>|  
|<span data-ttu-id="da985-199">Добавление пространства имен <xref:System.Windows.Automation.Text></span><span class="sxs-lookup"><span data-stu-id="da985-199">Add the <xref:System.Windows.Automation.Text> namespace.</span></span>|<span data-ttu-id="da985-200">Это пространство имен содержит все клиенты автоматизации пользовательского интерфейса, необходимые для использования возможностей [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] обработки текста.</span><span class="sxs-lookup"><span data-stu-id="da985-200">This namespace contains everything a UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text handling.</span></span>|  
|<span data-ttu-id="da985-201">Поиск нужных элементов управления</span><span class="sxs-lookup"><span data-stu-id="da985-201">Find controls of interest</span></span>|<span data-ttu-id="da985-202">Скрипты автоматических тестов находят элементы автоматизации пользовательского интерфейса, представляющие нужные элементы управления в дереве автоматизации.</span><span class="sxs-lookup"><span data-stu-id="da985-202">Automated test scripts locate UI Automation elements that represent controls of interest within the automation tree.</span></span><br /><br /> <span data-ttu-id="da985-203">Существует несколько способов получения элементов автоматизации пользовательского интерфейса с помощью кода.</span><span class="sxs-lookup"><span data-stu-id="da985-203">There are multiple ways to obtain UI Automation elements with code.</span></span><br /><br /> <span data-ttu-id="da985-204">-Query [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] с помощью <xref:System.Windows.Automation.Condition> инструкции.</span><span class="sxs-lookup"><span data-stu-id="da985-204">-   Query the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] using a <xref:System.Windows.Automation.Condition> statement.</span></span> <span data-ttu-id="da985-205">Обычно здесь используется не зависящее от языка свойство <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> .</span><span class="sxs-lookup"><span data-stu-id="da985-205">This is typically where the language-neutral <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is used.</span></span> <span data-ttu-id="da985-206">**Примечание.**  <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> Можно получить с помощью такого средства, как Inspect.exe, которое способно детализировать [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] свойства элемента управления.</span><span class="sxs-lookup"><span data-stu-id="da985-206">**Note:**  An <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> can be obtained using a tool such as Inspect.exe that is able to itemize the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties of a control.</span></span> <br /><br /> <span data-ttu-id="da985-207">— Используйте <xref:System.Windows.Automation.TreeWalker> класс для обхода всего [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] дерево или его подмножеством.</span><span class="sxs-lookup"><span data-stu-id="da985-207">-   Use the <xref:System.Windows.Automation.TreeWalker> class to traverse the entire [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree or a subset thereof.</span></span><br /><span data-ttu-id="da985-208">-Отслеживать фокус.</span><span class="sxs-lookup"><span data-stu-id="da985-208">-   Track focus.</span></span><br /><span data-ttu-id="da985-209">— Используйте hWnd элемента управления.</span><span class="sxs-lookup"><span data-stu-id="da985-209">-   Use the hWnd of the control.</span></span><br /><span data-ttu-id="da985-210">— Используйте местоположение на экране, например расположение курсора мыши.</span><span class="sxs-lookup"><span data-stu-id="da985-210">-   Use screen location, such as the location of the mouse cursor.</span></span><br /><br /> <span data-ttu-id="da985-211">См. раздел [Obtaining UI Automation Elements](../../../docs/framework/ui-automation/obtaining-ui-automation-elements.md).</span><span class="sxs-lookup"><span data-stu-id="da985-211">See [Obtaining UI Automation Elements](../../../docs/framework/ui-automation/obtaining-ui-automation-elements.md)</span></span>|  
|<span data-ttu-id="da985-212">Получение шаблонов элементов управления</span><span class="sxs-lookup"><span data-stu-id="da985-212">Obtain Control Patterns</span></span>|<span data-ttu-id="da985-213">Шаблоны элементов управления предоставляют общие расширения функциональности для функциональных возможностей схожих элементов управления.</span><span class="sxs-lookup"><span data-stu-id="da985-213">Control patterns expose common behaviors for functionally similar controls.</span></span><br /><br /> <span data-ttu-id="da985-214">После нахождения элемента управления, требующего проверки, скрипты автоматических тестов получают интересующие шаблоны элементов управления из этих элементов автоматизации пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="da985-214">After locating the controls that require testing, automated test scripts obtain the control patterns of interest from those UI Automation elements.</span></span> <span data-ttu-id="da985-215">Например, шаблон элемента управления <xref:System.Windows.Automation.InvokePattern> для типичной функциональности кнопки или шаблон элемента управления <xref:System.Windows.Automation.WindowPattern> для функциональности окна.</span><span class="sxs-lookup"><span data-stu-id="da985-215">For example, the <xref:System.Windows.Automation.InvokePattern> control pattern for typical button functionality or the <xref:System.Windows.Automation.WindowPattern> control pattern for window functionality.</span></span><br /><br /> <span data-ttu-id="da985-216">См. раздел [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-216">See [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>|  
|<span data-ttu-id="da985-217">Автоматизация пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="da985-217">Automate the UI</span></span>|<span data-ttu-id="da985-218">Скрипты автоматических тестов теперь могут управлять любым интересующим [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] в платформе [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] , используя сведения и функциональные возможности, предоставляемые шаблонами элементов управления [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="da985-218">Automated test scripts can now control any [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] of interest from a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] framework using the information and functionality exposed by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns.</span></span>|  
  
<a name="Supporting_tools"></a>   
## <a name="related-tools-and-technologies"></a><span data-ttu-id="da985-219">Связанные инструменты и технологии</span><span class="sxs-lookup"><span data-stu-id="da985-219">Related Tools and Technologies</span></span>  
 <span data-ttu-id="da985-220">Существует множество связанных инструментов и технологий, которые поддерживают автоматическое тестирование с помощью [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-220">There are a number of related tools and technologies that support automated testing with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
- <span data-ttu-id="da985-221">Inspect.exe — [!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)] приложения, который может использоваться для сбора [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] сведения для поставщика и клиента разработки и отладки.</span><span class="sxs-lookup"><span data-stu-id="da985-221">Inspect.exe is a [!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)] application that can be used to gather [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information for both provider and client development and debugging.</span></span> <span data-ttu-id="da985-222">Inspect.exe включается в [!INCLUDE[TLA#tla_winfxsdk](../../../includes/tlasharptla-winfxsdk-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-222">Inspect.exe is included in the [!INCLUDE[TLA#tla_winfxsdk](../../../includes/tlasharptla-winfxsdk-md.md)].</span></span>  
  
- <span data-ttu-id="da985-223">MSAABridge предоставляет [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] сведения клиентам Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="da985-223">MSAABridge exposes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information to Active Accessibility clients.</span></span> <span data-ttu-id="da985-224">Основная цель соединения мостом [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] для Active Accessibility — разрешить существующие клиенты Active Accessibility возможность взаимодействовать с любой платформой, реализующей [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da985-224">The primary goal of bridging [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to Active Accessibility is to allow existing Active Accessibility clients the ability to interact with any framework that has implemented [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
<a name="Security"></a>   
## <a name="security"></a><span data-ttu-id="da985-225">Безопасность</span><span class="sxs-lookup"><span data-stu-id="da985-225">Security</span></span>  
 <span data-ttu-id="da985-226">Сведения о безопасности см. в разделе [UI Automation Security Overview](../../../docs/framework/ui-automation/ui-automation-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da985-226">For security information, see [UI Automation Security Overview](../../../docs/framework/ui-automation/ui-automation-security-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="da985-227">См. также</span><span class="sxs-lookup"><span data-stu-id="da985-227">See also</span></span>

- [<span data-ttu-id="da985-228">Основы модели автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="da985-228">UI Automation Fundamentals</span></span>](../../../docs/framework/ui-automation/index.md)
