---
title: Получение элементов автоматизации пользовательского интерфейса
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, obtaining elements
- elements, UI Automation, obtaining
ms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171
ms.openlocfilehash: eab4e59ee219808a4c0ae9ca5331a14928b66b5c
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79180003"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="60bb5-102">Получение элементов автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="60bb5-102">Obtaining UI Automation Elements</span></span>
> [!NOTE]
> <span data-ttu-id="60bb5-103">Эта документация предназначена для разработчиков .NET Framework, желающих использовать управляемые классы [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , заданные в пространстве имен <xref:System.Windows.Automation> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="60bb5-104">Последние сведения о [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]см. в разделе [API автоматизации Windows. Автоматизация пользовательского интерфейса](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="60bb5-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="60bb5-105">В этом разделе описываются различные способы получения объектов <xref:System.Windows.Automation.AutomationElement> для элементов [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="60bb5-105">This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="60bb5-106">Если клиентское приложение может пытаться искать элементы в собственном пользовательском интерфейсе, вы должны выполнять все вызовы [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] в отдельном потоке.</span><span class="sxs-lookup"><span data-stu-id="60bb5-106">If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread.</span></span> <span data-ttu-id="60bb5-107">Для получения дополнительной информации см. [UI Automation Threading Issues](ui-automation-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="60bb5-107">For more information, see [UI Automation Threading Issues](ui-automation-threading-issues.md).</span></span>  
  
<a name="The_Root_Element"></a>
## <a name="root-element"></a><span data-ttu-id="60bb5-108">Корневой элемент</span><span class="sxs-lookup"><span data-stu-id="60bb5-108">Root Element</span></span>  
 <span data-ttu-id="60bb5-109">Любой поиск объектов <xref:System.Windows.Automation.AutomationElement> должен иметь отправную точку.</span><span class="sxs-lookup"><span data-stu-id="60bb5-109">All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place.</span></span> <span data-ttu-id="60bb5-110">Это может быть любой элемент, включая рабочий стол, окно приложения или элемент управления.</span><span class="sxs-lookup"><span data-stu-id="60bb5-110">This can be any element, including the desktop, an application window, or a control.</span></span>  
  
 <span data-ttu-id="60bb5-111">Корневой элемент для рабочего стола, все элементы из которого являются потомками, получается из статического свойства <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-111">The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> property.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="60bb5-112">В целом вы должны пытаться получить только прямые потомки <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-112">In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span> <span data-ttu-id="60bb5-113">Поиск потомков может выполнять итерацию по сотням или даже тысячам элементов, что может привести к переполнению стека.</span><span class="sxs-lookup"><span data-stu-id="60bb5-113">A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.</span></span> <span data-ttu-id="60bb5-114">Если вы пытаетесь получить определенный элемент на более низком уровне, необходимо запустить поиск из окна приложения или из контейнера на более низком уровне.</span><span class="sxs-lookup"><span data-stu-id="60bb5-114">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>  
  
<a name="Using_Conditions"></a>
## <a name="conditions"></a><span data-ttu-id="60bb5-115">Условия</span><span class="sxs-lookup"><span data-stu-id="60bb5-115">Conditions</span></span>  
 <span data-ttu-id="60bb5-116">В большинстве методик, которые можно использовать для получения элементов [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , вы должны указывать объект <xref:System.Windows.Automation.Condition>, представляющий собой набор условий, определяющих, какие элементы нужно получить.</span><span class="sxs-lookup"><span data-stu-id="60bb5-116">For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.</span></span>  
  
 <span data-ttu-id="60bb5-117">Простейшим условием является <xref:System.Windows.Automation.Condition.TrueCondition>, предопределенный объект, указывающий, что должны быть возвращены все элементы в области поиска.</span><span class="sxs-lookup"><span data-stu-id="60bb5-117">The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned.</span></span> <span data-ttu-id="60bb5-118">Условие<xref:System.Windows.Automation.Condition.FalseCondition>, противоположное <xref:System.Windows.Automation.Condition.TrueCondition>, менее целесообразно, так как может помешать поиску каких-либо элементов.</span><span class="sxs-lookup"><span data-stu-id="60bb5-118"><xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.</span></span>  
  
 <span data-ttu-id="60bb5-119">Три прочих предопределенных условия можно использовать отдельно или в сочетании с другими условиями: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>и <xref:System.Windows.Automation.Automation.RawViewCondition>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-119">Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>.</span></span> <span data-ttu-id="60bb5-120">Условие, используемое само по себе, эквивалентно , так как оно не фильтрует элементы по их свойству  или  .</span><span class="sxs-lookup"><span data-stu-id="60bb5-120"><xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.</span></span>  
  
 <span data-ttu-id="60bb5-121">Прочие условия создаются из одного или нескольких объектов <xref:System.Windows.Automation.PropertyCondition> , каждый из которых задает значение свойства.</span><span class="sxs-lookup"><span data-stu-id="60bb5-121">Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value.</span></span> <span data-ttu-id="60bb5-122">Например, <xref:System.Windows.Automation.PropertyCondition> может указывать, что элемент включен или что он поддерживает определенный шаблон элемента управления.</span><span class="sxs-lookup"><span data-stu-id="60bb5-122">For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.</span></span>  
  
 <span data-ttu-id="60bb5-123">Условия могут объединяться с помощью булевой логики для формирования объектов типов <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>и <xref:System.Windows.Automation.NotCondition>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-123">Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.</span></span>  
  
<a name="Search_Scope"></a>
## <a name="search-scope"></a><span data-ttu-id="60bb5-124">Область поиска</span><span class="sxs-lookup"><span data-stu-id="60bb5-124">Search Scope</span></span>  
 <span data-ttu-id="60bb5-125">Поиск, выполняемый с помощью метода <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> или <xref:System.Windows.Automation.AutomationElement.FindAll%2A> , должен иметь область, а также отправную точку.</span><span class="sxs-lookup"><span data-stu-id="60bb5-125">Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.</span></span>  
  
 <span data-ttu-id="60bb5-126">Область определяет пространство вокруг отправной точки, в котором производится поиск.</span><span class="sxs-lookup"><span data-stu-id="60bb5-126">The scope defines the space around the starting-place that is to be searched.</span></span> <span data-ttu-id="60bb5-127">Область может включать сам элемент, элементы того же уровня, его родительский элемент, его предки, его непосредственные дочерние элементы и его потомки.</span><span class="sxs-lookup"><span data-stu-id="60bb5-127">This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.</span></span>  
  
 <span data-ttu-id="60bb5-128">Область поиска определяется побитовым сочетанием значений из перечисления <xref:System.Windows.Automation.TreeScope> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-128">The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.</span></span>  
  
<a name="Finding_a_Known_Element"></a>
## <a name="finding-a-known-element"></a><span data-ttu-id="60bb5-129">Поиск известного элемента</span><span class="sxs-lookup"><span data-stu-id="60bb5-129">Finding a Known Element</span></span>  
 <span data-ttu-id="60bb5-130">Чтобы найти известный элемент, определяемый по его свойству <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>или некоторому другому свойству или сочетанию свойств, проще всего использовать метод <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-130">To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method.</span></span> <span data-ttu-id="60bb5-131">Если искомый элемент — окно приложения, отправной точкой поиска может быть <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-131">If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span>  
  
 <span data-ttu-id="60bb5-132">Этот способ поиска элементов [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] особенно целесообразен в скриптах автоматических тестов.</span><span class="sxs-lookup"><span data-stu-id="60bb5-132">This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.</span></span>  
  
<a name="Finding_Elements_in_a_Subtree"></a>
## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="60bb5-133">Поиск элементов в поддереве</span><span class="sxs-lookup"><span data-stu-id="60bb5-133">Finding Elements in a Subtree</span></span>  
 <span data-ttu-id="60bb5-134">Чтобы найти все элементы, удовлетворяющие определенным условиям, относящиеся к известному элементу, можно использовать метод <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-134">To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span></span> <span data-ttu-id="60bb5-135">Например, этот метод можно использовать для извлечения элементов списка или элементов меню из списка или меню, а также для поиска всех элементов управления в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="60bb5-135">For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>  
  
<a name="Walking_a_Subtree"></a>
## <a name="walking-a-subtree"></a><span data-ttu-id="60bb5-136">Обход поддерева</span><span class="sxs-lookup"><span data-stu-id="60bb5-136">Walking a Subtree</span></span>  
 <span data-ttu-id="60bb5-137">Если нет предварительных сведений о приложениях, с которыми может использоваться ваш клиент, вы можете построить поддерево всех интересующих элементов с помощью класса <xref:System.Windows.Automation.TreeWalker> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-137">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class.</span></span> <span data-ttu-id="60bb5-138">Приложение может сделать это в ответ на событие изменения фокуса; т. е. когда приложение или элемент управления получает фокус ввода, клиент автоматизации пользовательского интерфейса проверяет дочерние элементы и, возможно, все потомки элемента, получившего фокус.</span><span class="sxs-lookup"><span data-stu-id="60bb5-138">Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>  
  
 <span data-ttu-id="60bb5-139">Кроме того, <xref:System.Windows.Automation.TreeWalker> может использоваться для определения предков элемента.</span><span class="sxs-lookup"><span data-stu-id="60bb5-139">Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element.</span></span> <span data-ttu-id="60bb5-140">Например, обходя дерево, можно определить родительское окно элемента управления.</span><span class="sxs-lookup"><span data-stu-id="60bb5-140">For example, by walking up the tree you can identify the parent window of a control.</span></span>  
  
 <span data-ttu-id="60bb5-141">Вы можете использовать <xref:System.Windows.Automation.TreeWalker> либо создавая объект класса (определяющий интересующие элементы, передавая <xref:System.Windows.Automation.Condition>), либо используя один из следующих предопределенных объектов, которые заданы как поля <xref:System.Windows.Automation.TreeWalker>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-141">You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.</span></span>  
  
|||  
|-|-|  
|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|<span data-ttu-id="60bb5-142">Поиск только тех элементов, свойство <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> которых имеет значение `true`.</span><span class="sxs-lookup"><span data-stu-id="60bb5-142">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|<span data-ttu-id="60bb5-143">Поиск только тех элементов, свойство <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> которых имеет значение `true`.</span><span class="sxs-lookup"><span data-stu-id="60bb5-143">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|<span data-ttu-id="60bb5-144">Поиск всех элементов.</span><span class="sxs-lookup"><span data-stu-id="60bb5-144">Finds all elements.</span></span>|  
  
 <span data-ttu-id="60bb5-145">После получения объекта <xref:System.Windows.Automation.TreeWalker>использовать его несложно.</span><span class="sxs-lookup"><span data-stu-id="60bb5-145">After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward.</span></span> <span data-ttu-id="60bb5-146">Просто вызывайте методы `Get` для навигации по элементам поддерева.</span><span class="sxs-lookup"><span data-stu-id="60bb5-146">Simply call the `Get` methods to navigate among elements of the subtree.</span></span>  
  
 <span data-ttu-id="60bb5-147">Метод <xref:System.Windows.Automation.TreeWalker.Normalize%2A> может использоваться для перехода к элементу в поддереве из другого элемента, который не является частью представления.</span><span class="sxs-lookup"><span data-stu-id="60bb5-147">The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="60bb5-148">Предположим, что вы создали представление поддерева с помощью <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-148">For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span></span> <span data-ttu-id="60bb5-149">Далее ваше приложение получает уведомление, что полоса прокрутки получила фокус ввода.</span><span class="sxs-lookup"><span data-stu-id="60bb5-149">Your application then receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="60bb5-150">Поскольку полоса прокрутки не является элементом содержимого, она отсутствует в представлении поддерева.</span><span class="sxs-lookup"><span data-stu-id="60bb5-150">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="60bb5-151">Однако вы можете передать элемент <xref:System.Windows.Automation.AutomationElement> , представляющий полосу прокрутки, в метод <xref:System.Windows.Automation.TreeWalker.Normalize%2A> и получить его ближайшего предка, который находится в представлении содержимого.</span><span class="sxs-lookup"><span data-stu-id="60bb5-151">However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.</span></span>  
  
<a name="Other_Ways_to_Retrieve_an_Element"></a>
## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="60bb5-152">Другие способы получения элемента</span><span class="sxs-lookup"><span data-stu-id="60bb5-152">Other Ways to Retrieve an Element</span></span>  
 <span data-ttu-id="60bb5-153">В дополнение к поиску и навигации вы можете получать элемент <xref:System.Windows.Automation.AutomationElement> следующими способами.</span><span class="sxs-lookup"><span data-stu-id="60bb5-153">In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.</span></span>  
  
### <a name="from-an-event"></a><span data-ttu-id="60bb5-154">Из события</span><span class="sxs-lookup"><span data-stu-id="60bb5-154">From an Event</span></span>  
 <span data-ttu-id="60bb5-155">Когда приложение получает событие [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , в качестве исходного объекта в обработчик событий передается <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="60bb5-155">When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="60bb5-156">Например, если вы подписаны на события изменения фокуса, в качестве исходного объекта в ваш <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> передается элемент, который получил фокус.</span><span class="sxs-lookup"><span data-stu-id="60bb5-156">For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.</span></span>  
  
 <span data-ttu-id="60bb5-157">Дополнительные сведения см. в разделе [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span><span class="sxs-lookup"><span data-stu-id="60bb5-157">For more information, see [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span></span>  
  
### <a name="from-a-point"></a><span data-ttu-id="60bb5-158">Из точки</span><span class="sxs-lookup"><span data-stu-id="60bb5-158">From a Point</span></span>  
 <span data-ttu-id="60bb5-159">Если имеются координаты экрана (например, позиция курсора), можно получить <xref:System.Windows.Automation.AutomationElement> с помощью статического метода <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-159">If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.</span></span>  
  
### <a name="from-a-window-handle"></a><span data-ttu-id="60bb5-160">Из дескриптора окна</span><span class="sxs-lookup"><span data-stu-id="60bb5-160">From a Window Handle</span></span>  
 <span data-ttu-id="60bb5-161">Для получения <xref:System.Windows.Automation.AutomationElement> из HWND используйте статический метод <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-161">To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.</span></span>  
  
### <a name="from-the-focused-control"></a><span data-ttu-id="60bb5-162">Из элемента управления с фокусом</span><span class="sxs-lookup"><span data-stu-id="60bb5-162">From the Focused Control</span></span>  
 <span data-ttu-id="60bb5-163">Вы можете получить <xref:System.Windows.Automation.AutomationElement> , представляющий элемент управления с фокусом, из статического свойства <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> .</span><span class="sxs-lookup"><span data-stu-id="60bb5-163">You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="60bb5-164">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="60bb5-164">See also</span></span>

- [<span data-ttu-id="60bb5-165">Нахождение элемента модели автоматизации пользовательского интерфейса в зависимости от состояния свойства</span><span class="sxs-lookup"><span data-stu-id="60bb5-165">Find a UI Automation Element Based on a Property Condition</span></span>](find-a-ui-automation-element-based-on-a-property-condition.md)
- [<span data-ttu-id="60bb5-166">Навигация между элементами модели автоматизации пользовательского интерфейса с помощью TreeWalker</span><span class="sxs-lookup"><span data-stu-id="60bb5-166">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="60bb5-167">UI Automation Tree Overview</span><span class="sxs-lookup"><span data-stu-id="60bb5-167">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
