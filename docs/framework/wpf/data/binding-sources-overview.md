---
title: Общие сведения об источниках привязки
description: Обнаружение типов объектов, которые можно использовать в качестве источника привязки для приложений в Windows Presentation Foundation (WPF).
ms.date: 03/30/2017
helpviewer_keywords:
- binding data [WPF], binding sources
- data binding [WPF], binding source
- binding sources [WPF]
ms.assetid: 2df2cd11-6aac-4bdf-ab7b-ea5f464cd5ca
ms.openlocfilehash: 11d19d904e632ca2c7c7795946d350d078c38e70
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2020
ms.locfileid: "85619628"
---
# <a name="binding-sources-overview"></a>Общие сведения об источниках привязки
В привязке данных объект источника привязки (источник) ссылается на объект, из которого вы получаете данные. В этом разделе рассматриваются типы объектов, которые можно использовать в качестве источника привязки.

<a name="binding_sources"></a>
## <a name="binding-source-types"></a>Типы источников привязки
 Привязка данных [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] поддерживает указанные далее типы источников привязки.

|Источник привязки|Описание|
|--------------------|-----------------|
|объекты среды CLR|Можно выполнить привязку к открытым свойствам, вложенным свойствам, а также индексаторам любого объекта среды CLR. Обработчик привязки использует отражение CLR для получения значений свойств. Кроме того, объекты, которые реализуют <xref:System.ComponentModel.ICustomTypeDescriptor> или имеют зарегистрированные, <xref:System.ComponentModel.TypeDescriptionProvider> также работают с механизмом привязки.<br /><br /> Дополнительные сведения о том, как реализовать класс, который можно использовать в качестве источника привязки, см. в разделе [Использование класса в качестве источника привязки](#classes).|
|динамические объекты|Можно выполнить привязку к доступным свойствам и индексаторам объекта, реализующего <xref:System.Dynamic.IDynamicMetaObjectProvider> интерфейс. Если можно обратиться к члену кода, к нему можно выполнить привязку. Например, если динамический объект позволяет получить доступ к члену в коде с помощью `someObjet.AProperty`, к нему можно выполнить привязку, задав в качестве пути привязки `AProperty`.|
|Объекты ADO.NET|Можно выполнить привязку к объектам ADO.NET, таким как <xref:System.Data.DataTable> . ADO.NET <xref:System.Data.DataView> реализует <xref:System.ComponentModel.IBindingList> интерфейс, который предоставляет уведомления об изменениях, которые прослушивает механизм привязки.|
|Объекты XML|Можно выполнять привязку и выполнять `XPath` запросы к <xref:System.Xml.XmlNode> , <xref:System.Xml.XmlDocument> или <xref:System.Xml.XmlElement> . Удобный способ доступа к XML-данным, который является источником привязки в разметке, — использование <xref:System.Windows.Data.XmlDataProvider> объекта. Дополнительные сведения см. в разделе [Привязка к XML-данным с помощью XMLDataProvider и запросов XPath](how-to-bind-to-xml-data-using-an-xmldataprovider-and-xpath-queries.md).<br /><br /> Можно также выполнить привязку к <xref:System.Xml.Linq.XElement> или к <xref:System.Xml.Linq.XDocument> результатам запросов, выполняемых с объектами этих типов, с помощью LINQ to XML. Удобный способ использования LINQ to XML для доступа к XML-данным, который является источником привязки в разметке, — использование <xref:System.Windows.Data.ObjectDataProvider> объекта. Дополнительные сведения см. в разделе [Привязка к XDocument, XElement или LINQ для результатов запросов XML](how-to-bind-to-xdocument-xelement-or-linq-for-xml-query-results.md).|
|Объекты <xref:System.Windows.DependencyObject>|Можно выполнить привязку к свойствам зависимостей любого <xref:System.Windows.DependencyObject> . Пример см. в разделе [Как привязать свойства двух элементов управления](how-to-bind-the-properties-of-two-controls.md).|

<a name="classes"></a>
## <a name="implementing-a-class-for-the-binding-source"></a>Использование класса в качестве источника привязки
 Можно создать собственную привязку. В этом разделе обсуждаются вопросы, которые нужно знать, если реализуется класс, используемый в качестве источника привязки.

### <a name="providing-change-notifications"></a>Предоставление уведомлений об изменениях
 Если вы используете либо <xref:System.Windows.Data.BindingMode.OneWay> <xref:System.Windows.Data.BindingMode.TwoWay> привязку, либо (так как вы хотите [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] обновлять при динамическом изменении свойств источника привязки), необходимо реализовать подходящий механизм уведомления об изменении свойства. Рекомендуемый механизм заключается в реализации интерфейса в среде CLR или динамическом классе <xref:System.ComponentModel.INotifyPropertyChanged> . Дополнительные сведения см. в разделе [Реализация уведомления об изменении свойств](how-to-implement-property-change-notification.md).

 При создании объекта CLR, который не реализует <xref:System.ComponentModel.INotifyPropertyChanged> , необходимо организовать собственную систему уведомлений, чтобы убедиться, что данные, используемые в привязке, остаются актуальными. Можно предоставить уведомление об изменениях с помощью шаблона `PropertyChanged` для каждого свойства, для которого требуются уведомления об изменении. Для поддержки этого шаблона необходимо определить событие *PropertyName*Changed для каждого свойства, где *PropertyName* — это имя свойства. Событие вызывается каждый раз при изменении свойства.

 Если источник привязки реализует один из этих механизмов уведомлений, обновления целевого объекта выполняются автоматически. Если по какой либо причине источник привязки не предоставляет правильные уведомления об изменении свойств, можно использовать <xref:System.Windows.Data.BindingExpression.UpdateTarget%2A> метод для явного обновления свойства Target.

### <a name="other-characteristics"></a>Другие характеристики
 Ниже приведены другие важные замечания.

- Если вы хотите создать объект в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] , класс должен иметь конструктор без параметров. В некоторых языках .NET, таких как C#, конструктор без параметров может быть создан для вас.

- Свойства, используемые в качестве свойств источника привязки, должны быть открытыми свойствами класса. Явно определенные свойства интерфейса не могут использоваться для целей привязки, также как и защищенные, закрытые или виртуальные свойства, не имеющие базовой реализации.

- Привязка к открытым полям невозможна.

- Тип свойства, объявленного в классе, является типом, передаваемым привязке. Однако тип используемой привязки в конечном счете зависит от типа свойства целевого объекта привязки, а не свойства источника привязки. Если есть разница в типе, может потребоваться написать преобразователь для обработки того, как пользовательское свойство изначально передается привязке. Для получения дополнительной информации см. <xref:System.Windows.Data.IValueConverter>.

<a name="objects"></a>
## <a name="using-entire-objects-as-a-binding-source"></a>Использование всего объекта в качестве источника привязки
 В качестве источника привязки можно использовать весь объект. Можно указать источник привязки с помощью <xref:System.Windows.Data.Binding.Source%2A> <xref:System.Windows.FrameworkElement.DataContext%2A> свойства или, а затем предоставить пустое объявление привязки: `{Binding}` . Сценарии, в которых это полезно, включают привязку к объектам строкового типа, привязку к объектам с несколькими интересующими вас свойствами или привязку к коллекции объектов. Пример привязки к целому объекту коллекции см. в разделе [Использование шаблона "главный — подчиненный" с иерархическими данными](how-to-use-the-master-detail-pattern-with-hierarchical-data.md).

 Обратите внимание, что может потребоваться применить пользовательскую логику, чтобы данные имели смысл для свойства целевого объекта привязки. Пользовательская логика может быть в виде пользовательского преобразователя (если преобразование типа по умолчанию не существует) или <xref:System.Windows.DataTemplate> . Дополнительные сведения о преобразователях см. в подразделе "Преобразование данных" раздела [Общие сведения о привязке данных](../../../desktop-wpf/data/data-binding-overview.md). Дополнительные сведения о шаблонах данных см. в разделе [Общие сведения](data-templating-overview.md)о создании шаблонов данных.

<a name="collections"></a>
## <a name="using-collection-objects-as-a-binding-source"></a>Объекты коллекции, используемые в качестве источника привязки
 Часто объект, который требуется использовать в качестве источника привязки, является коллекцией пользовательских объектов. Каждый объект играет роль источника для одного экземпляра повторной привязки. Например, у вас может быть коллекция `CustomerOrders`, состоящая из объектов `CustomerOrder`, где приложение перемещается по коллекции, чтобы определить, сколько существует заказов и данных, содержащихся в каждом объекте.

 Можно перечислить любую коллекцию, которая реализует интерфейс <xref:System.Collections.IEnumerable>. Однако, чтобы настроить динамические привязки таким образом, чтобы вставки или удаления в коллекции автоматически обновляются [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , коллекция должна реализовать <xref:System.Collections.Specialized.INotifyCollectionChanged> интерфейс. Этот интерфейс предоставляет событие, которое должно вызываться при каждом изменении коллекции.

 <xref:System.Collections.ObjectModel.ObservableCollection%601>Класс является встроенной реализацией коллекции данных, предоставляющей <xref:System.Collections.Specialized.INotifyCollectionChanged> интерфейс. Отдельные объекты данных в коллекции должны удовлетворять требованиям, описанным в предыдущих разделах. Пример см. в разделе [Создание и привязка ObservableCollection](how-to-create-and-bind-to-an-observablecollection.md). Перед реализацией собственной коллекции рассмотрите возможность использования <xref:System.Collections.ObjectModel.ObservableCollection%601> или одного из существующих классов коллекций, таких как <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ObjectModel.Collection%601> и <xref:System.ComponentModel.BindingList%601>, среди многих других.

 WPF никогда не реализует прямую привязку к коллекции. Если в качестве источника привязки указана коллекция, WPF фактически выполняет привязку к представлению коллекции по умолчанию. Сведения о представлениях по умолчанию см. в разделе [Общие сведения о привязке данных](../../../desktop-wpf/data/data-binding-overview.md).

 Если у вас есть расширенный сценарий и вы хотите реализовать собственную коллекцию, рассмотрите возможность использования <xref:System.Collections.IList> интерфейса. <xref:System.Collections.IList>предоставляет неуниверсальную коллекцию объектов, к которым можно получить доступ по отдельности по индексу, что может повысить производительность.

<a name="permissions"></a>
## <a name="permission-requirements-in-data-binding"></a>Требования к разрешениям в привязке данных
 При привязке данных необходимо учитывать уровень доверия приложения. В следующей таблице перечислены типы свойств, к которым можно выполнить привязку в приложении, выполняющемся в режиме полного доверия или частичного доверия.

|Тип свойства<br /><br /> (Все модификаторы доступа)|Свойство динамического объекта|Свойство динамического объекта|Свойство CLR|Свойство CLR|Свойство зависимостей|Свойство зависимостей|
|------------------------------------------------|-----------------------------|-----------------------------|------------------|------------------|-------------------------|-------------------------|
|**Уровень доверия**|**Полное доверие**|**Частичное доверие**|**Полное доверие**|**Частичное доверие**|**Полное доверие**|**Частичное доверие**|
|Открытый класс|Да|Да|Да|Да|Да|Да|
|Закрытый класс|Да|Нет|Да|Нет|Да|Да|

 В этой таблице описаны следующие важные моменты для требований к разрешениям в привязке данных.

- Для свойств CLR привязка данных работает, пока механизм привязки может получить доступ к свойству источника привязки с помощью отражения. В противном случае обработчик привязки выдает предупреждение о том, что свойство не найдено, и использует запасное значение или значение по умолчанию, если оно доступно.

- Можно выполнить привязку к свойствам динамических объектов, определенных во время компиляции или во время выполнения.

- Всегда можно осуществить привязку к свойствам зависимостей.

 Требование разрешения для привязки XML аналогично. В песочнице с частичным доверием <xref:System.Windows.Data.XmlDataProvider> происходит сбой, если у него нет разрешений на доступ к указанным данным.

 Объекты анонимных типов являются внутренними. Можно выполнить привязку к свойствам анонимных типов только при работе в режиме полного доверия. Дополнительные сведения об анонимных типах см. в разделах [Анонимные типы (руководство по программированию на C#)](../../../csharp/programming-guide/classes-and-structs/anonymous-types.md) или [Анонимные типы (Visual Basic)](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) (Visual Basic).

 Дополнительные сведения о безопасности частичного доверия см. в разделе [Безопасность частичного доверия в WPF](../wpf-partial-trust-security.md).

## <a name="see-also"></a>См. также

- <xref:System.Windows.Data.ObjectDataProvider>
- <xref:System.Windows.Data.XmlDataProvider>
- [Укажите источник привязки](how-to-specify-the-binding-source.md)
- [Общие сведения о привязке данных](../../../desktop-wpf/data/data-binding-overview.md)
- [Общие сведения о привязке данных WPF с помощью LINQ to XML](wpf-data-binding-with-linq-to-xml-overview.md)
- [Оптимизация производительности привязки данных](../advanced/optimizing-performance-data-binding.md)
