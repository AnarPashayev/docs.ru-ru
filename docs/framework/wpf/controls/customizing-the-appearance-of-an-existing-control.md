---
title: Настройка внешнего вида существующего элемента управления путем создания объекта ControlTemplate
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- control contract [WPF]
- controls [WPF], visual structure changes
- ControlTemplate [WPF], customizing for existing controls
- skinning controls [WPF]
- controls [WPF], appearance specified by state
- templates [WPF], custom for existing controls
ms.assetid: 678dd116-43a2-4b8c-82b5-6b826f126e31
ms.openlocfilehash: 6d7401f9614e663351968dc6a2f85548735a176d
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73460419"
---
# <a name="customizing-the-appearance-of-an-existing-control-by-creating-a-controltemplate"></a><span data-ttu-id="f74b8-102">Настройка внешнего вида существующего элемента управления путем создания объекта ControlTemplate</span><span class="sxs-lookup"><span data-stu-id="f74b8-102">Customizing the Appearance of an Existing Control by Creating a ControlTemplate</span></span>
<a name="introduction"></a><span data-ttu-id="f74b8-103"><xref:System.Windows.Controls.ControlTemplate> задает визуальную структуру и визуальное поведение элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-103">A <xref:System.Windows.Controls.ControlTemplate> specifies the visual structure and visual behavior of a control.</span></span> <span data-ttu-id="f74b8-104">Внешний вид элемента управления можно настроить, присвоив ему новый <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-104">You can customize the appearance of a control by giving it a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="f74b8-105">При создании <xref:System.Windows.Controls.ControlTemplate>вы заменяете внешний вид существующего элемента управления, не изменяя его функциональность.</span><span class="sxs-lookup"><span data-stu-id="f74b8-105">When you create a <xref:System.Windows.Controls.ControlTemplate>, you replace the appearance of an existing control without changing its functionality.</span></span> <span data-ttu-id="f74b8-106">Например, можно сделать так, чтобы кнопки в приложении округлялись вместо квадратной фигуры по умолчанию, но кнопка по-прежнему будет вызывать событие <xref:System.Windows.Controls.Primitives.ButtonBase.Click>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-106">For example, you can make the buttons in your application round instead of the default square shape, but the button will still raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span>

 <span data-ttu-id="f74b8-107">В этом разделе объясняются различные части <xref:System.Windows.Controls.ControlTemplate>, демонстрируется создание простого <xref:System.Windows.Controls.ControlTemplate> для <xref:System.Windows.Controls.Button>и объясняется, как определить контракт элемента управления, чтобы можно было настроить его внешний вид.</span><span class="sxs-lookup"><span data-stu-id="f74b8-107">This topic explains the various parts of a <xref:System.Windows.Controls.ControlTemplate>, demonstrates creating a simple <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>, and explains how to understand the control contract of a control so that you can customize its appearance.</span></span> <span data-ttu-id="f74b8-108">Поскольку вы создаете <xref:System.Windows.Controls.ControlTemplate> в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], можно изменить внешний вид элемента управления без написания кода.</span><span class="sxs-lookup"><span data-stu-id="f74b8-108">Because you create a <xref:System.Windows.Controls.ControlTemplate> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can change a control's appearance without writing any code.</span></span> <span data-ttu-id="f74b8-109">Для создания пользовательских шаблонов элементов управления можно также использовать конструктор, например Blend для Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f74b8-109">You can also use a designer, such as Blend for Visual Studio, to create custom control templates.</span></span> <span data-ttu-id="f74b8-110">В этом разделе приведены примеры в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], которые настраивают внешний вид <xref:System.Windows.Controls.Button> и список полных примеров в конце раздела.</span><span class="sxs-lookup"><span data-stu-id="f74b8-110">This topic shows examples in the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] that customize the appearance of a <xref:System.Windows.Controls.Button> and lists the complete example at the end of the topic.</span></span> <span data-ttu-id="f74b8-111">Дополнительные сведения об использовании Blend для Visual Studio см. [в разделе Стилизация элемента управления, поддерживающего шаблоны](https://go.microsoft.com/fwlink/?LinkId=161153).</span><span class="sxs-lookup"><span data-stu-id="f74b8-111">For more information about using Blend for Visual Studio, see [Styling a control that supports templates](https://go.microsoft.com/fwlink/?LinkId=161153).</span></span>

 <span data-ttu-id="f74b8-112">На следующих иллюстрациях показан <xref:System.Windows.Controls.Button>, использующий <xref:System.Windows.Controls.ControlTemplate>, созданный в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f74b8-112">The following illustrations show a <xref:System.Windows.Controls.Button> that uses the <xref:System.Windows.Controls.ControlTemplate> that is created in this topic.</span></span>

 <span data-ttu-id="f74b8-113">![Кнопка, использующая пользовательский шаблон элемента управления.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="f74b8-113">![A button with a custom control template.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>
<span data-ttu-id="f74b8-114">Кнопка, использующая пользовательский шаблон элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-114">A button that uses a custom control template</span></span>

 <span data-ttu-id="f74b8-115">![Кнопка с красной границей.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="f74b8-115">![A button with a red border.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>
<span data-ttu-id="f74b8-116">Кнопка, использующая пользовательский шаблон элемента управления, когда на ней находится указатель мыши</span><span class="sxs-lookup"><span data-stu-id="f74b8-116">A button that uses a custom control template and has the mouse pointer over it</span></span>

<a name="prerequisites"></a>
## <a name="prerequisites"></a><span data-ttu-id="f74b8-117">Необходимые компоненты</span><span class="sxs-lookup"><span data-stu-id="f74b8-117">Prerequisites</span></span>
 <span data-ttu-id="f74b8-118">В этом разделе предполагается, что пользователь понимает процесс создания и использования элементов управления и стилей, который рассматривался в разделе [Элементы управления](index.md).</span><span class="sxs-lookup"><span data-stu-id="f74b8-118">This topic assumes that you understand how to create and use controls and styles as discussed in [Controls](index.md).</span></span> <span data-ttu-id="f74b8-119">Концепции, обсуждаемые в этом разделе, применяются к элементам, которые наследуются от класса <xref:System.Windows.Controls.Control>, за исключением <xref:System.Windows.Controls.UserControl>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-119">The concepts discussed in this topic apply to elements that inherit from the <xref:System.Windows.Controls.Control> class, except for the <xref:System.Windows.Controls.UserControl>.</span></span> <span data-ttu-id="f74b8-120">К <xref:System.Windows.Controls.UserControl>нельзя применить <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-120">You cannot apply a <xref:System.Windows.Controls.ControlTemplate> to a <xref:System.Windows.Controls.UserControl>.</span></span>

<a name="when_you_should_create_a_controltemplate"></a>
## <a name="when-you-should-create-a-controltemplate"></a><span data-ttu-id="f74b8-121">Когда следует создавать объект ControlTemplate</span><span class="sxs-lookup"><span data-stu-id="f74b8-121">When You Should Create a ControlTemplate</span></span>
 <span data-ttu-id="f74b8-122">Элементы управления имеют множество свойств, таких как <xref:System.Windows.Controls.Border.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>и <xref:System.Windows.Controls.Control.FontFamily%2A>, которые можно задать, чтобы указать различные аспекты внешнего вида элемента управления, но изменения, которые можно выполнить путем установки этих свойств, ограничены.</span><span class="sxs-lookup"><span data-stu-id="f74b8-122">Controls have many properties, such as <xref:System.Windows.Controls.Border.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontFamily%2A>, that you can set to specify different aspects of the control's appearance, but the changes that you can make by setting these properties are limited.</span></span> <span data-ttu-id="f74b8-123">Например, можно задать для свойства <xref:System.Windows.Controls.Control.Foreground%2A> значение Blue, а <xref:System.Windows.Controls.Control.FontStyle%2A> курсивом на <xref:System.Windows.Controls.CheckBox>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-123">For example, you can set the <xref:System.Windows.Controls.Control.Foreground%2A> property to blue and <xref:System.Windows.Controls.Control.FontStyle%2A> to italic on a <xref:System.Windows.Controls.CheckBox>.</span></span>

 <span data-ttu-id="f74b8-124">Без возможности создания новых <xref:System.Windows.Controls.ControlTemplate> для элементов управления все элементы управления в каждом [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ном приложении будут иметь одинаковый общий внешний вид, что ограничит возможность создания приложения с пользовательским видом и поведением.</span><span class="sxs-lookup"><span data-stu-id="f74b8-124">Without the ability to create a new <xref:System.Windows.Controls.ControlTemplate> for controls, all controls in every [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application would have the same general appearance, which would limit the ability to create an application with a custom look and feel.</span></span> <span data-ttu-id="f74b8-125">По умолчанию каждый <xref:System.Windows.Controls.CheckBox> имеет аналогичные характеристики.</span><span class="sxs-lookup"><span data-stu-id="f74b8-125">By default, every <xref:System.Windows.Controls.CheckBox> has similar characteristics.</span></span> <span data-ttu-id="f74b8-126">Например, содержимое <xref:System.Windows.Controls.CheckBox> всегда находится справа от индикатора выбора, а галочка всегда используется для указания того, что <xref:System.Windows.Controls.CheckBox> выбрано.</span><span class="sxs-lookup"><span data-stu-id="f74b8-126">For example, the content of the <xref:System.Windows.Controls.CheckBox> is always to the right of the selection indicator, and the check mark is always used to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>

 <span data-ttu-id="f74b8-127">Вы создаете <xref:System.Windows.Controls.ControlTemplate>, если хотите настроить внешний вид элемента управления, помимо того, что устанавливает другие свойства элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-127">You create a <xref:System.Windows.Controls.ControlTemplate> when you want to customize the control's appearance beyond what setting the other properties on the control will do.</span></span> <span data-ttu-id="f74b8-128">В примере <xref:System.Windows.Controls.CheckBox>Предположим, что содержимое флажка должно располагаться над индикатором выбора, и необходимо указать X, чтобы показать, что <xref:System.Windows.Controls.CheckBox> выбрано.</span><span class="sxs-lookup"><span data-stu-id="f74b8-128">In the example of the <xref:System.Windows.Controls.CheckBox>, suppose that you want the content of the check box to be above the selection indicator and you want an X to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span> <span data-ttu-id="f74b8-129">Эти изменения указываются в <xref:System.Windows.Controls.ControlTemplate> <xref:System.Windows.Controls.CheckBox>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-129">You specify these changes in the <xref:System.Windows.Controls.ControlTemplate> of the <xref:System.Windows.Controls.CheckBox>.</span></span>

 <span data-ttu-id="f74b8-130">На следующем рисунке показана <xref:System.Windows.Controls.CheckBox>, использующая <xref:System.Windows.Controls.ControlTemplate>по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f74b8-130">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a default <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 <span data-ttu-id="f74b8-131">![Элемент управления CheckBox, использующий шаблон элемента управления по умолчанию.](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span><span class="sxs-lookup"><span data-stu-id="f74b8-131">![A checkbox with the default control template.](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span></span>
<span data-ttu-id="f74b8-132">Элемент управления CheckBox, использующий шаблон элемента управления по умолчанию</span><span class="sxs-lookup"><span data-stu-id="f74b8-132">A CheckBox that uses the default control template</span></span>

 <span data-ttu-id="f74b8-133">На следующем рисунке показана <xref:System.Windows.Controls.CheckBox>, использующая пользовательский <xref:System.Windows.Controls.ControlTemplate> для размещения содержимого <xref:System.Windows.Controls.CheckBox> над индикатором выбора и отображения X при выборе <xref:System.Windows.Controls.CheckBox>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-133">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a custom <xref:System.Windows.Controls.ControlTemplate> to place the content of the <xref:System.Windows.Controls.CheckBox> above the selection indicator and displays an X when the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>

 <span data-ttu-id="f74b8-134">![Элемент управления CheckBox, использующий пользовательский шаблон элемента управления.](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span><span class="sxs-lookup"><span data-stu-id="f74b8-134">![A checkbox with a custom control template.](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span></span>
<span data-ttu-id="f74b8-135">Элемент управления CheckBox, использующий пользовательский шаблон элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-135">A CheckBox that uses a custom control template</span></span>

 <span data-ttu-id="f74b8-136"><xref:System.Windows.Controls.ControlTemplate> для <xref:System.Windows.Controls.CheckBox> в этом образце относительно сложны, поэтому в этом разделе используется более простой пример создания <xref:System.Windows.Controls.ControlTemplate> для <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-136">The <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.CheckBox> in this sample is relatively complex, so this topic uses a simpler example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>.</span></span>

<a name="changing_the_visual_structure_of_a_control"></a>
## <a name="changing-the-visual-structure-of-a-control"></a><span data-ttu-id="f74b8-137">Изменение визуальной структуры элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-137">Changing the Visual Structure of a Control</span></span>
 <span data-ttu-id="f74b8-138">В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]элемент управления часто является составным <xref:System.Windows.FrameworkElement> объектами.</span><span class="sxs-lookup"><span data-stu-id="f74b8-138">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], a control is often a composite <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="f74b8-139">При создании <xref:System.Windows.Controls.ControlTemplate>вы объединяете <xref:System.Windows.FrameworkElement> объекты для создания одного элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-139">When you create a <xref:System.Windows.Controls.ControlTemplate>, you combine <xref:System.Windows.FrameworkElement> objects to build a single control.</span></span> <span data-ttu-id="f74b8-140">У <xref:System.Windows.Controls.ControlTemplate> должен быть только один <xref:System.Windows.FrameworkElement> в качестве корневого элемента.</span><span class="sxs-lookup"><span data-stu-id="f74b8-140">A <xref:System.Windows.Controls.ControlTemplate> must have only one <xref:System.Windows.FrameworkElement> as its root element.</span></span> <span data-ttu-id="f74b8-141">Корневой элемент обычно содержит другие объекты <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-141">The root element usually contains other <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="f74b8-142">Комбинация объектов составляет визуальную структуру элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-142">The combination of objects makes up the control's visual structure.</span></span>

 <span data-ttu-id="f74b8-143">В следующем примере создается настраиваемый <xref:System.Windows.Controls.ControlTemplate> для <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-143">The following example creates a custom <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="f74b8-144"><xref:System.Windows.Controls.ControlTemplate> создает визуальную структуру <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-144">The <xref:System.Windows.Controls.ControlTemplate> creates the visual structure of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="f74b8-145">В этом примере не меняется внешний вид кнопки при перемещении на нее указателя мыши или при ее нажатии.</span><span class="sxs-lookup"><span data-stu-id="f74b8-145">This example does not change the button's appearance when you move the mouse pointer over it or click it.</span></span> <span data-ttu-id="f74b8-146">Изменение внешнего вида кнопки при ее переходе в другое состояние рассматривается далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f74b8-146">Changing the button's appearance when it is in a different state is discussed later in this topic.</span></span>

 <span data-ttu-id="f74b8-147">В данном примере визуальная структура состоит из следующих частей:</span><span class="sxs-lookup"><span data-stu-id="f74b8-147">In this example, the visual structure consists of the following parts:</span></span>

- <span data-ttu-id="f74b8-148"><xref:System.Windows.Controls.Border> с именем `RootElement`, который служит корневым <xref:System.Windows.FrameworkElement>шаблона.</span><span class="sxs-lookup"><span data-stu-id="f74b8-148">A <xref:System.Windows.Controls.Border> named `RootElement` that serves as the template's root <xref:System.Windows.FrameworkElement>.</span></span>

- <span data-ttu-id="f74b8-149"><xref:System.Windows.Controls.Grid>, являющийся дочерним элементом `RootElement`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-149">A <xref:System.Windows.Controls.Grid> that is a child of `RootElement`.</span></span>

- <span data-ttu-id="f74b8-150"><xref:System.Windows.Controls.ContentPresenter>, отображающая содержимое кнопки.</span><span class="sxs-lookup"><span data-stu-id="f74b8-150">A <xref:System.Windows.Controls.ContentPresenter> that displays the button's content.</span></span> <span data-ttu-id="f74b8-151"><xref:System.Windows.Controls.ContentPresenter> позволяет отображать любой тип объекта.</span><span class="sxs-lookup"><span data-stu-id="f74b8-151">The <xref:System.Windows.Controls.ContentPresenter> enables any type of object to be displayed.</span></span>

 [!code-xaml[VSMButtonTemplate#BasicTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#basictemplate)]

### <a name="preserving-the-functionality-of-a-controls-properties-by-using-templatebinding"></a><span data-ttu-id="f74b8-152">Сохранение функциональности свойств элемента управления с помощью TemplateBinding</span><span class="sxs-lookup"><span data-stu-id="f74b8-152">Preserving the Functionality of a Control's Properties by Using TemplateBinding</span></span>
 <span data-ttu-id="f74b8-153">При создании нового <xref:System.Windows.Controls.ControlTemplate>может потребоваться использовать открытые свойства для изменения внешнего вида элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-153">When you create a new <xref:System.Windows.Controls.ControlTemplate>, you still might want to use the public properties to change the control's appearance.</span></span> <span data-ttu-id="f74b8-154">Расширение разметки [TemplateBinding](../advanced/templatebinding-markup-extension.md) привязывает свойство элемента, который находится в <xref:System.Windows.Controls.ControlTemplate>, к открытому свойству, определенному элементом управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-154">The [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension binds a property of an element that is in the <xref:System.Windows.Controls.ControlTemplate> to a public property that is defined by the control.</span></span> <span data-ttu-id="f74b8-155">Использование расширения [TemplateBinding](../advanced/templatebinding-markup-extension.md) позволяет свойствам элемента управления действовать в качестве параметров шаблона.</span><span class="sxs-lookup"><span data-stu-id="f74b8-155">When you use [TemplateBinding](../advanced/templatebinding-markup-extension.md), you enable properties on the control to act as parameters to the template.</span></span> <span data-ttu-id="f74b8-156">Это означает, что при задании свойства элемента управления соответствующее значение передается в элемент, который содержит [TemplateBinding](../advanced/templatebinding-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="f74b8-156">That is, when a property on a control is set, that value is passed on to the element that has the [TemplateBinding](../advanced/templatebinding-markup-extension.md) on it.</span></span>

 <span data-ttu-id="f74b8-157">В следующем примере повторяется часть предыдущего примера, в которой используется расширение разметки [TemplateBinding](../advanced/templatebinding-markup-extension.md) для привязки свойств элементов, которые находятся в <xref:System.Windows.Controls.ControlTemplate>, к общим свойствам, определенным кнопкой.</span><span class="sxs-lookup"><span data-stu-id="f74b8-157">The following example repeats the part of the preceding example that uses the [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the button.</span></span>

 [!code-xaml[VSMButtonTemplate#TemplateBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#templatebinding)]

 <span data-ttu-id="f74b8-158">В этом примере <xref:System.Windows.Controls.Grid> имеет шаблон свойства <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType>, привязанный к <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-158">In this example, the <xref:System.Windows.Controls.Grid> has its <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> property template bound to <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f74b8-159">Поскольку <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> является привязанным шаблоном, можно создать несколько кнопок, использующих один и тот же <xref:System.Windows.Controls.ControlTemplate>, и задать для <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> различные значения для каждой кнопки.</span><span class="sxs-lookup"><span data-stu-id="f74b8-159">Because <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> is template bound, you can create multiple buttons that use the same <xref:System.Windows.Controls.ControlTemplate> and set the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> to different values on each button.</span></span> <span data-ttu-id="f74b8-160">Если <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> не был привязан к свойству элемента в <xref:System.Windows.Controls.ControlTemplate>, установка <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> кнопки не повлияет на внешний вид кнопки.</span><span class="sxs-lookup"><span data-stu-id="f74b8-160">If <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> was not template bound to a property of an element in the <xref:System.Windows.Controls.ControlTemplate>, setting the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> of a button would have no impact on the button's appearance.</span></span>

 <span data-ttu-id="f74b8-161">Следует отметить, что не требуется, чтобы имена этих двух свойств совпадали.</span><span class="sxs-lookup"><span data-stu-id="f74b8-161">Note that the names of the two properties do not need to be identical.</span></span> <span data-ttu-id="f74b8-162">В предыдущем примере свойство <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> <xref:System.Windows.Controls.Button> является шаблоном, привязанным к свойству <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> <xref:System.Windows.Controls.ContentPresenter>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-162">In the preceding example, the <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.Button> is template bound to the <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.ContentPresenter>.</span></span> <span data-ttu-id="f74b8-163">Это позволяет располагать содержимое кнопки горизонтально.</span><span class="sxs-lookup"><span data-stu-id="f74b8-163">This enables the content of the button to be positioned horizontally.</span></span> <span data-ttu-id="f74b8-164"><xref:System.Windows.Controls.ContentPresenter> не имеет свойства с именем `HorizontalContentAlignment`, но <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> можно привязать к <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-164"><xref:System.Windows.Controls.ContentPresenter> does not have a property named `HorizontalContentAlignment`, but <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> can be bound to <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f74b8-165">Перед привязкой свойства к шаблону следует убедиться, что целевое и исходное свойства имеют один и тот же тип.</span><span class="sxs-lookup"><span data-stu-id="f74b8-165">When you template bind a property, be sure that the target and source properties are the same type.</span></span>

 <span data-ttu-id="f74b8-166">Класс <xref:System.Windows.Controls.Control> определяет несколько свойств, которые должны использоваться шаблоном элемента управления для получения влияния на элемент управления, когда они заданы.</span><span class="sxs-lookup"><span data-stu-id="f74b8-166">The <xref:System.Windows.Controls.Control> class defines several properties that must be used by the control template to have an effect on the control when they are set.</span></span> <span data-ttu-id="f74b8-167">То, как <xref:System.Windows.Controls.ControlTemplate> использует свойство, зависит от свойства.</span><span class="sxs-lookup"><span data-stu-id="f74b8-167">How the <xref:System.Windows.Controls.ControlTemplate> uses the property depends on the property.</span></span> <span data-ttu-id="f74b8-168"><xref:System.Windows.Controls.ControlTemplate> должен использовать свойство одним из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="f74b8-168">The <xref:System.Windows.Controls.ControlTemplate> must use the property in one of the following ways:</span></span>

- <span data-ttu-id="f74b8-169">Элемент в шаблоне <xref:System.Windows.Controls.ControlTemplate> привязывается к свойству.</span><span class="sxs-lookup"><span data-stu-id="f74b8-169">An element in the <xref:System.Windows.Controls.ControlTemplate> template binds to the property.</span></span>

- <span data-ttu-id="f74b8-170">Элемент в <xref:System.Windows.Controls.ControlTemplate> наследует свойство от родительского <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-170">An element in the <xref:System.Windows.Controls.ControlTemplate> inherits the property from a parent <xref:System.Windows.FrameworkElement>.</span></span>

 <span data-ttu-id="f74b8-171">В следующей таблице перечислены визуальные свойства, наследуемые элементом управления от класса <xref:System.Windows.Controls.Control>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-171">The following table lists the visual properties inherited by a control from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="f74b8-172">В таблице также указывается, использует ли шаблон элемента управления по умолчанию значение наследуемого свойства или оно должно быть привязано к шаблону.</span><span class="sxs-lookup"><span data-stu-id="f74b8-172">It also indicates whether the default control template of a control uses the inherited property value or if it must be template bound.</span></span>

|<span data-ttu-id="f74b8-173">свойство;</span><span class="sxs-lookup"><span data-stu-id="f74b8-173">Property</span></span>|<span data-ttu-id="f74b8-174">Способ использования</span><span class="sxs-lookup"><span data-stu-id="f74b8-174">Usage method</span></span>|
|--------------|------------------|
|<xref:System.Windows.Controls.Control.Background%2A>|<span data-ttu-id="f74b8-175">Привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-175">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.BorderThickness%2A>|<span data-ttu-id="f74b8-176">Привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-176">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.BorderBrush%2A>|<span data-ttu-id="f74b8-177">Привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-177">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontFamily%2A>|<span data-ttu-id="f74b8-178">Наследование свойства или привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-178">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontSize%2A>|<span data-ttu-id="f74b8-179">Наследование свойства или привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-179">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontStretch%2A>|<span data-ttu-id="f74b8-180">Наследование свойства или привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-180">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontWeight%2A>|<span data-ttu-id="f74b8-181">Наследование свойства или привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-181">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.Foreground%2A>|<span data-ttu-id="f74b8-182">Наследование свойства или привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-182">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A>|<span data-ttu-id="f74b8-183">Привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-183">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.Padding%2A>|<span data-ttu-id="f74b8-184">Привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-184">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.VerticalContentAlignment%2A>|<span data-ttu-id="f74b8-185">Привязка к шаблону</span><span class="sxs-lookup"><span data-stu-id="f74b8-185">Template binding</span></span>|

 <span data-ttu-id="f74b8-186">В таблице перечислены только визуальные свойства, унаследованные от класса <xref:System.Windows.Controls.Control>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-186">The table lists only the visual properties inherited from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="f74b8-187">Помимо свойств, перечисленных в таблице, элемент управления может также наследовать свойства <xref:System.Windows.FrameworkElement.DataContext%2A>, <xref:System.Windows.FrameworkElement.Language%2A>и <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> из родительского элемента Framework.</span><span class="sxs-lookup"><span data-stu-id="f74b8-187">Apart from the properties listed in the table, a control may also inherit the <xref:System.Windows.FrameworkElement.DataContext%2A>, <xref:System.Windows.FrameworkElement.Language%2A>, and <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> properties from the parent framework element.</span></span>

 <span data-ttu-id="f74b8-188">Кроме того, если <xref:System.Windows.Controls.ContentPresenter> находится в <xref:System.Windows.Controls.ControlTemplate> <xref:System.Windows.Controls.ContentControl>, <xref:System.Windows.Controls.ContentPresenter> будет автоматически привязан к свойствам <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> и <xref:System.Windows.Controls.ContentControl.Content%2A>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-188">Also, if the <xref:System.Windows.Controls.ContentPresenter> is in the <xref:System.Windows.Controls.ControlTemplate> of a <xref:System.Windows.Controls.ContentControl>, the <xref:System.Windows.Controls.ContentPresenter> will automatically bind to the <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> and <xref:System.Windows.Controls.ContentControl.Content%2A> properties.</span></span> <span data-ttu-id="f74b8-189">Аналогичным образом <xref:System.Windows.Controls.ItemsPresenter>, который находится в <xref:System.Windows.Controls.ControlTemplate> <xref:System.Windows.Controls.ItemsControl>, автоматически привязывается к свойствам <xref:System.Windows.Controls.ItemsControl.Items%2A> и <xref:System.Windows.Controls.ItemsPresenter>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-189">Likewise, an <xref:System.Windows.Controls.ItemsPresenter> that is in the <xref:System.Windows.Controls.ControlTemplate> of an <xref:System.Windows.Controls.ItemsControl> will automatically bind to the <xref:System.Windows.Controls.ItemsControl.Items%2A> and <xref:System.Windows.Controls.ItemsPresenter> properties.</span></span>

 <span data-ttu-id="f74b8-190">В следующем примере создаются две кнопки, использующие <xref:System.Windows.Controls.ControlTemplate>, определенные в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="f74b8-190">The following example creates two buttons that use the <xref:System.Windows.Controls.ControlTemplate> defined in the preceding example.</span></span> <span data-ttu-id="f74b8-191">В примере задаются свойства <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>и <xref:System.Windows.Controls.Control.FontSize%2A> для каждой кнопки.</span><span class="sxs-lookup"><span data-stu-id="f74b8-191">The example sets the <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontSize%2A> properties on each button.</span></span> <span data-ttu-id="f74b8-192">Установка свойства <xref:System.Windows.Controls.Control.Background%2A> оказывает воздействие, так как оно привязано к шаблону в <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-192">Setting the <xref:System.Windows.Controls.Control.Background%2A> property has an effect because it is template bound in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="f74b8-193">Несмотря на то, что свойства <xref:System.Windows.Controls.Control.Foreground%2A> и <xref:System.Windows.Controls.Control.FontSize%2A> не привязаны к шаблону, их установка оказывает воздействие, поскольку их значения наследуются.</span><span class="sxs-lookup"><span data-stu-id="f74b8-193">Even though the <xref:System.Windows.Controls.Control.Foreground%2A> and <xref:System.Windows.Controls.Control.FontSize%2A> properties are not template bound, setting them has an effect because their values are inherited.</span></span>

 [!code-xaml[VSMButtonTemplate#ButtonDeclaration](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#buttondeclaration)]

 <span data-ttu-id="f74b8-194">В предыдущем примере получался результат, аналогичный показанному на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="f74b8-194">The preceding example produces output that is similar to the following illustration.</span></span>

 <span data-ttu-id="f74b8-195">![Две кнопки, одна синяя, а другая — фиолетовая.](./media/ndp-buttontwo.png "NDP_ButtonTwo")</span><span class="sxs-lookup"><span data-stu-id="f74b8-195">![Two buttons, one blue and one purple.](./media/ndp-buttontwo.png "NDP_ButtonTwo")</span></span>
<span data-ttu-id="f74b8-196">Две кнопки с различными цветами фона</span><span class="sxs-lookup"><span data-stu-id="f74b8-196">Two buttons with different background colors</span></span>

<a name="changing_the_appearance_of_a_control_depending_on_its_state"></a>
## <a name="changing-the-appearance-of-a-control-depending-on-its-state"></a><span data-ttu-id="f74b8-197">Изменение внешнего вида элемента управления в зависимости от его состояния</span><span class="sxs-lookup"><span data-stu-id="f74b8-197">Changing the Appearance of a Control Depending on Its State</span></span>
 <span data-ttu-id="f74b8-198">Разница между кнопкой с внешним видом по умолчанию и кнопкой из предыдущего примера состоит в том, что кнопка по умолчанию слегка изменяется при переходе в другое состояние.</span><span class="sxs-lookup"><span data-stu-id="f74b8-198">The difference between a button with its default appearance and the button in the preceding example is that the default button subtly changes when it is in different states.</span></span> <span data-ttu-id="f74b8-199">Например, внешний вид кнопки по умолчанию изменяется при нажатии этой кнопки или при наведении на нее указателя мыши.</span><span class="sxs-lookup"><span data-stu-id="f74b8-199">For example, the default button's appearance changes when the button is pressed, or when the mouse pointer is over the button.</span></span> <span data-ttu-id="f74b8-200">Хотя <xref:System.Windows.Controls.ControlTemplate> не изменяет функциональность элемента управления, он изменяет визуальное поведение элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-200">Although the <xref:System.Windows.Controls.ControlTemplate> does not change the functionality of a control, it does change the control's visual behavior.</span></span> <span data-ttu-id="f74b8-201">Визуальное поведение описывает внешний вид элемента управления в определенных состояниях.</span><span class="sxs-lookup"><span data-stu-id="f74b8-201">A visual behavior describes the control appearance when it is in a certain state.</span></span> <span data-ttu-id="f74b8-202">Чтобы лучше понять разницу между функциональностью и визуальным поведением элемента управления, рассмотрим пример с кнопкой.</span><span class="sxs-lookup"><span data-stu-id="f74b8-202">To understand the difference between the functionality and visual behavior of a control, consider the button example.</span></span> <span data-ttu-id="f74b8-203">Функциональность кнопки заключается в вызове события <xref:System.Windows.Controls.Primitives.ButtonBase.Click> при щелчке, но визуальное поведение кнопки заключается в том, чтобы изменить внешний вид, на который указывает или нажата кнопка.</span><span class="sxs-lookup"><span data-stu-id="f74b8-203">The button's functionality is to raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event when it is clicked, but the button's visual behavior is to change its appearance when it is pointed to or pressed.</span></span>

 <span data-ttu-id="f74b8-204">Чтобы задать внешний вид элемента управления, когда он находится в определенном состоянии, используются <xref:System.Windows.VisualState> объекты.</span><span class="sxs-lookup"><span data-stu-id="f74b8-204">You use <xref:System.Windows.VisualState> objects to specify the appearance of a control when it is in a certain state.</span></span> <span data-ttu-id="f74b8-205"><xref:System.Windows.VisualState> содержит <xref:System.Windows.Media.Animation.Storyboard>, который изменяет внешний вид элементов в <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-205">A <xref:System.Windows.VisualState> contains a <xref:System.Windows.Media.Animation.Storyboard> that changes the appearance of the elements that are in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="f74b8-206">Для этого не нужно писать код, так как логика элемента управления меняет состояние с помощью <xref:System.Windows.VisualStateManager>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-206">You do not have to write any code to make this occur because the control's logic changes state by using the <xref:System.Windows.VisualStateManager>.</span></span> <span data-ttu-id="f74b8-207">Когда элемент управления переходит в состояние, заданное свойством <xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType>, начинается <xref:System.Windows.Media.Animation.Storyboard>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-207">When the control enters the state that is specified by the <xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType> property, the <xref:System.Windows.Media.Animation.Storyboard> begins.</span></span> <span data-ttu-id="f74b8-208">Когда элемент управления выходит из состояния, <xref:System.Windows.Media.Animation.Storyboard> останавливается.</span><span class="sxs-lookup"><span data-stu-id="f74b8-208">When the control exits the state, the <xref:System.Windows.Media.Animation.Storyboard> stops.</span></span>

 <span data-ttu-id="f74b8-209">В следующем примере показаны <xref:System.Windows.VisualState>, которые изменяют внешний вид <xref:System.Windows.Controls.Button> при наведении на нее указателя мыши.</span><span class="sxs-lookup"><span data-stu-id="f74b8-209">The following example shows the <xref:System.Windows.VisualState> that changes the appearance of a <xref:System.Windows.Controls.Button> when the mouse pointer is over it.</span></span> <span data-ttu-id="f74b8-210"><xref:System.Windows.Media.Animation.Storyboard> изменяет цвет границы кнопки, изменяя цвет `BorderBrush`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-210">The <xref:System.Windows.Media.Animation.Storyboard> changes the button's border color by changing the color of the `BorderBrush`.</span></span> <span data-ttu-id="f74b8-211">Если вы ссылаетесь на <xref:System.Windows.Controls.ControlTemplate> пример в начале этого раздела, вы помните, что `BorderBrush` является именем <xref:System.Windows.Media.SolidColorBrush>, назначенного <xref:System.Windows.Controls.Border.Background%2A> <xref:System.Windows.Controls.Border>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-211">If you refer to the <xref:System.Windows.Controls.ControlTemplate> example at the beginning of this topic, you will recall that `BorderBrush` is the name of the <xref:System.Windows.Media.SolidColorBrush> that is assigned to the <xref:System.Windows.Controls.Border.Background%2A> of the <xref:System.Windows.Controls.Border>.</span></span>

 [!code-xaml[VSMButtonTemplate#4](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#4)]

 <span data-ttu-id="f74b8-212">Элемент управления отвечает за определение состояний как часть своего контракта, что подробно рассматривается в подразделе [Настройка других элементов управления через понимание контракта элемента управления](#customizing_other_controls_by_understanding_the_control_contract) далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f74b8-212">The control is responsible for defining the states as part of its control contract, which is discussed in detail in [Customizing Other Controls by Understanding the Control Contract](#customizing_other_controls_by_understanding_the_control_contract) later in this topic.</span></span> <span data-ttu-id="f74b8-213">В следующей таблице перечислены состояния, указанные для <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-213">The following table lists the states that are specified for the <xref:System.Windows.Controls.Button>.</span></span>

|<span data-ttu-id="f74b8-214">Имя VisualState</span><span class="sxs-lookup"><span data-stu-id="f74b8-214">VisualState Name</span></span>|<span data-ttu-id="f74b8-215">Имя VisualStateGroup</span><span class="sxs-lookup"><span data-stu-id="f74b8-215">VisualStateGroup Name</span></span>|<span data-ttu-id="f74b8-216">Описание</span><span class="sxs-lookup"><span data-stu-id="f74b8-216">Description</span></span>|
|----------------------|---------------------------|-----------------|
|<span data-ttu-id="f74b8-217">Норм.</span><span class="sxs-lookup"><span data-stu-id="f74b8-217">Normal</span></span>|<span data-ttu-id="f74b8-218">CommonStates</span><span class="sxs-lookup"><span data-stu-id="f74b8-218">CommonStates</span></span>|<span data-ttu-id="f74b8-219">Состояние по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f74b8-219">The default state.</span></span>|
|<span data-ttu-id="f74b8-220">MouseOver</span><span class="sxs-lookup"><span data-stu-id="f74b8-220">MouseOver</span></span>|<span data-ttu-id="f74b8-221">CommonStates</span><span class="sxs-lookup"><span data-stu-id="f74b8-221">CommonStates</span></span>|<span data-ttu-id="f74b8-222">Указатель мыши расположен над элементом управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-222">The mouse pointer is positioned over the control.</span></span>|
|<span data-ttu-id="f74b8-223">Нажато</span><span class="sxs-lookup"><span data-stu-id="f74b8-223">Pressed</span></span>|<span data-ttu-id="f74b8-224">CommonStates</span><span class="sxs-lookup"><span data-stu-id="f74b8-224">CommonStates</span></span>|<span data-ttu-id="f74b8-225">Элемент управления нажат.</span><span class="sxs-lookup"><span data-stu-id="f74b8-225">The control is pressed.</span></span>|
|<span data-ttu-id="f74b8-226">Отключено.</span><span class="sxs-lookup"><span data-stu-id="f74b8-226">Disabled</span></span>|<span data-ttu-id="f74b8-227">CommonStates</span><span class="sxs-lookup"><span data-stu-id="f74b8-227">CommonStates</span></span>|<span data-ttu-id="f74b8-228">Элемент управления отключен.</span><span class="sxs-lookup"><span data-stu-id="f74b8-228">The control is disabled.</span></span>|
|<span data-ttu-id="f74b8-229">Focused</span><span class="sxs-lookup"><span data-stu-id="f74b8-229">Focused</span></span>|<span data-ttu-id="f74b8-230">FocusStates</span><span class="sxs-lookup"><span data-stu-id="f74b8-230">FocusStates</span></span>|<span data-ttu-id="f74b8-231">Элемент управления имеет фокус.</span><span class="sxs-lookup"><span data-stu-id="f74b8-231">The control has focus.</span></span>|
|<span data-ttu-id="f74b8-232">Без фокуса ввода</span><span class="sxs-lookup"><span data-stu-id="f74b8-232">Unfocused</span></span>|<span data-ttu-id="f74b8-233">FocusStates</span><span class="sxs-lookup"><span data-stu-id="f74b8-233">FocusStates</span></span>|<span data-ttu-id="f74b8-234">Элемент управления не имеет фокуса.</span><span class="sxs-lookup"><span data-stu-id="f74b8-234">The control does not have focus.</span></span>|

 <span data-ttu-id="f74b8-235"><xref:System.Windows.Controls.Button> определяет две группы состояний: Группа `CommonStates` содержит `Normal`, `MouseOver`, `Pressed`и `Disabled` состояния.</span><span class="sxs-lookup"><span data-stu-id="f74b8-235">The <xref:System.Windows.Controls.Button> defines two state groups: the `CommonStates` group contains the `Normal`, `MouseOver`, `Pressed`, and `Disabled` states.</span></span> <span data-ttu-id="f74b8-236">Группа `FocusStates` содержит состояния `Focused` и `Unfocused`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-236">The `FocusStates` group contains the `Focused` and `Unfocused` states.</span></span> <span data-ttu-id="f74b8-237">Состояния, входящие в одну группу, являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="f74b8-237">States in the same state group are mutually exclusive.</span></span> <span data-ttu-id="f74b8-238">Элемент управления всегда находится строго в одном состоянии из каждой группы.</span><span class="sxs-lookup"><span data-stu-id="f74b8-238">The control is always in exactly one state per group.</span></span> <span data-ttu-id="f74b8-239">Например, <xref:System.Windows.Controls.Button> может иметь фокус, даже если указатель мыши находится не над ним, так что <xref:System.Windows.Controls.Button> в `Focused` состоянии может находиться в `MouseOver`, `Pressed`или `Normal`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-239">For example, a <xref:System.Windows.Controls.Button> can have focus even when the mouse pointer is not over it, so a <xref:System.Windows.Controls.Button> in the `Focused` state can be in the `MouseOver`, `Pressed`, or `Normal` state.</span></span>

 <span data-ttu-id="f74b8-240"><xref:System.Windows.VisualState> объекты добавляются к <xref:System.Windows.VisualStateGroup> объектам.</span><span class="sxs-lookup"><span data-stu-id="f74b8-240">You add <xref:System.Windows.VisualState> objects to <xref:System.Windows.VisualStateGroup> objects.</span></span> <span data-ttu-id="f74b8-241"><xref:System.Windows.VisualStateGroup> объекты добавляются в присоединенное к <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="f74b8-241">You add <xref:System.Windows.VisualStateGroup> objects to the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property.</span></span> <span data-ttu-id="f74b8-242">В следующем примере определяются объекты <xref:System.Windows.VisualState> для состояний `Normal`, `MouseOver`и `Pressed`, которые находятся в группе `CommonStates`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-242">The following example defines the <xref:System.Windows.VisualState> objects for the `Normal`, `MouseOver`, and `Pressed` states, which are all in the `CommonStates` group.</span></span> <span data-ttu-id="f74b8-243"><xref:System.Windows.VisualState.Name%2A> каждого <xref:System.Windows.VisualState> совпадает с именем в предыдущей таблице.</span><span class="sxs-lookup"><span data-stu-id="f74b8-243">The <xref:System.Windows.VisualState.Name%2A> of each <xref:System.Windows.VisualState> matches the name in the preceding table.</span></span> <span data-ttu-id="f74b8-244">Состояние `Disabled` и состояния из группы `FocusStates` опущены для сохранения краткости примера, но они включены в полный пример, приведенный в конце этого раздела.</span><span class="sxs-lookup"><span data-stu-id="f74b8-244">The `Disabled` state and the states in the `FocusStates` group are omitted to keep the example short, but they are included in the entire example at the end of this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="f74b8-245">Не забудьте задать <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> присоединенное свойство в корневой <xref:System.Windows.FrameworkElement> <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-245">Be sure to set the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property on the root <xref:System.Windows.FrameworkElement> of the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 [!code-xaml[VSMButtonTemplate#VisualStates](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualstates)]

 <span data-ttu-id="f74b8-246">В предыдущем примере получался результат, аналогичный показанному на следующих рисунках.</span><span class="sxs-lookup"><span data-stu-id="f74b8-246">The preceding example produces output that is similar to the following illustrations.</span></span>

 <span data-ttu-id="f74b8-247">![Кнопка, использующая пользовательский шаблон элемента управления.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="f74b8-247">![A button with a custom control template.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>
<span data-ttu-id="f74b8-248">Кнопка, использующая пользовательский шаблон элемента управления в нормальном состоянии</span><span class="sxs-lookup"><span data-stu-id="f74b8-248">A button that uses a custom control template in the normal state</span></span>

 <span data-ttu-id="f74b8-249">![Кнопка с красной границей.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="f74b8-249">![A button with a red border.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>
<span data-ttu-id="f74b8-250">Кнопка, использующая пользовательский шаблон элемента управления в состоянии, когда указатель мыши находится над кнопкой</span><span class="sxs-lookup"><span data-stu-id="f74b8-250">A button that uses a custom control template in the mouse over state</span></span>

 <span data-ttu-id="f74b8-251">![Граница прозрачна на нажатой кнопке.](./media/ndp-buttonpressed.png "NDP_ButtonPressed")</span><span class="sxs-lookup"><span data-stu-id="f74b8-251">![The border is transparent on a pressed button.](./media/ndp-buttonpressed.png "NDP_ButtonPressed")</span></span>
<span data-ttu-id="f74b8-252">Кнопка, использующая пользовательский шаблон элемента управления в состоянии, когда она нажата</span><span class="sxs-lookup"><span data-stu-id="f74b8-252">A button that uses a custom control template in the pressed state</span></span>

 <span data-ttu-id="f74b8-253">Визуальные состояния элементов управления, включенных в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], см. в разделе [Стили и шаблоны элемента Control](control-styles-and-templates.md).</span><span class="sxs-lookup"><span data-stu-id="f74b8-253">To find the visual states for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](control-styles-and-templates.md).</span></span>

<a name="specifying_the_behavior_of_a_control_when_it_transitions_between_states"></a>
## <a name="specifying-the-behavior-of-a-control-when-it-transitions-between-states"></a><span data-ttu-id="f74b8-254">Задание поведения элемента управления, когда он переходит между состояниями</span><span class="sxs-lookup"><span data-stu-id="f74b8-254">Specifying the Behavior of a Control When It Transitions Between States</span></span>
 <span data-ttu-id="f74b8-255">В предыдущем примере внешний вид кнопки изменяется, когда пользователь нажимает ее, но если кнопка остается нажатой менее полной секунды, то пользователь не видит эффекта нажатия.</span><span class="sxs-lookup"><span data-stu-id="f74b8-255">In the preceding example, the appearance of the button also changes when the user clicks it, but unless the button is pressed for a full second, the user does not see the effect.</span></span> <span data-ttu-id="f74b8-256">По умолчанию для запуска анимации требуется одна секунда.</span><span class="sxs-lookup"><span data-stu-id="f74b8-256">By default, the animation takes one second to occur.</span></span> <span data-ttu-id="f74b8-257">Поскольку пользователи, скорее всего, щелкают и освобождают кнопку в гораздо меньше времени, визуальная обратная связь не будет действовать, если вы оставите <xref:System.Windows.Controls.ControlTemplate> в своем состоянии по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f74b8-257">Because users are likely to click and release a button in much less time, the visual feedback will not be effective if you leave the <xref:System.Windows.Controls.ControlTemplate> in its default state.</span></span>

 <span data-ttu-id="f74b8-258">Можно указать время, затрачиваемое на выполнение анимации, чтобы плавно перевести элемент управления из одного состояния в другое, добавив <xref:System.Windows.VisualTransition> объекты в <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-258">You can specify the amount of time that it takes an animation to occur to smoothly transition a control from one state to another by adding <xref:System.Windows.VisualTransition> objects to the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="f74b8-259">При создании <xref:System.Windows.VisualTransition>необходимо указать один или несколько из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="f74b8-259">When you create a <xref:System.Windows.VisualTransition>, you specify one or more of the following:</span></span>

- <span data-ttu-id="f74b8-260">время, которое занимает переход между состояниями;</span><span class="sxs-lookup"><span data-stu-id="f74b8-260">The time it takes for a transition between states to occur.</span></span>

- <span data-ttu-id="f74b8-261">дополнительные изменения внешнего вида элемента управления, возникающие во время перехода;</span><span class="sxs-lookup"><span data-stu-id="f74b8-261">Additional changes in the control's appearance that occur at the time of the transition.</span></span>

- <span data-ttu-id="f74b8-262">Состояние, к которому применяется <xref:System.Windows.VisualTransition>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-262">Which states the <xref:System.Windows.VisualTransition> is applied to.</span></span>

### <a name="specifying-the-duration-of-a-transition"></a><span data-ttu-id="f74b8-263">Задание продолжительности перехода</span><span class="sxs-lookup"><span data-stu-id="f74b8-263">Specifying the Duration of a Transition</span></span>
 <span data-ttu-id="f74b8-264">Можно указать, как долго выполняется переход, установив свойство <xref:System.Windows.VisualTransition.GeneratedDuration%2A>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-264">You can specify how long a transition takes by setting the <xref:System.Windows.VisualTransition.GeneratedDuration%2A> property.</span></span> <span data-ttu-id="f74b8-265">В предыдущем примере имеется <xref:System.Windows.VisualState>, указывающий, что граница кнопки становится прозрачной при нажатии кнопки, но анимация занимает слишком много времени, чтобы быть заметной при быстром нажатии и отпускании кнопки.</span><span class="sxs-lookup"><span data-stu-id="f74b8-265">The preceding example has a <xref:System.Windows.VisualState> that specifies that the button's border becomes transparent when the button is pressed, but the animation takes too long to be noticeable if the button is quickly pressed and released.</span></span> <span data-ttu-id="f74b8-266">Можно использовать <xref:System.Windows.VisualTransition>, чтобы указать период времени, в течение которого элемент управления переходит в состояние нажатия.</span><span class="sxs-lookup"><span data-stu-id="f74b8-266">You can use a <xref:System.Windows.VisualTransition> to specify the amount of time it takes the control to transition into the pressed state.</span></span> <span data-ttu-id="f74b8-267">В следующем примере задается, что переход элемента управления в нажатое состояние занимает одну сотую секунды.</span><span class="sxs-lookup"><span data-stu-id="f74b8-267">The following example specifies that the control takes one hundredth of a second to go into the pressed state.</span></span>

 [!code-xaml[VSMButtonTemplate#PressedTransition](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#pressedtransition)]

### <a name="specifying-changes-to-the-controls-appearance-during-a-transition"></a><span data-ttu-id="f74b8-268">Задание изменений внешнего вида элемента управления во время перехода</span><span class="sxs-lookup"><span data-stu-id="f74b8-268">Specifying Changes to the Control's Appearance During a Transition</span></span>
 <span data-ttu-id="f74b8-269"><xref:System.Windows.VisualTransition> содержит <xref:System.Windows.Media.Animation.Storyboard>, который начинается при переходе элемента управления между состояниями.</span><span class="sxs-lookup"><span data-stu-id="f74b8-269">The <xref:System.Windows.VisualTransition> contains a <xref:System.Windows.Media.Animation.Storyboard> that begins when the control transitions between states.</span></span> <span data-ttu-id="f74b8-270">Например, можно указать, что определенная анимация происходит при переходе элемента управления из состояния `MouseOver` в состояние `Normal`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-270">For example, you can specify that a certain animation occurs when the control transitions from the `MouseOver` state to the `Normal` State.</span></span> <span data-ttu-id="f74b8-271">В следующем примере создается <xref:System.Windows.VisualTransition>, указывающий, что когда пользователь перемещает указатель мыши за пределы кнопки, граница кнопки меняется на синий, затем на желтый, затем на черный через 1,5 секунд.</span><span class="sxs-lookup"><span data-stu-id="f74b8-271">The following example creates a <xref:System.Windows.VisualTransition> that specifies that when the user moves the mouse pointer away from the button, the button's border changes to blue, then to yellow, then to black in 1.5 seconds.</span></span>

 [!code-xaml[VSMButtonTemplate#8](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#8)]

### <a name="specifying-when-a-visualtransition-is-applied"></a><span data-ttu-id="f74b8-272">Указание места применения VisualTransition</span><span class="sxs-lookup"><span data-stu-id="f74b8-272">Specifying When a VisualTransition Is Applied</span></span>
 <span data-ttu-id="f74b8-273"><xref:System.Windows.VisualTransition> может быть ограничена только определенными состояниями, или его можно применять при каждом переходе элемента управления между состояниями.</span><span class="sxs-lookup"><span data-stu-id="f74b8-273">A <xref:System.Windows.VisualTransition> can be restricted to apply to only certain states, or it can be applied any time the control transitions between states.</span></span> <span data-ttu-id="f74b8-274">В предыдущем примере <xref:System.Windows.VisualTransition> применяется при переходе элемента управления из состояния `MouseOver` в состояние `Normal`; в приведенном выше примере <xref:System.Windows.VisualTransition> применяется при переходе элемента управления в состояние `Pressed`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-274">In the preceding example, the <xref:System.Windows.VisualTransition> is applied when the control goes from the `MouseOver` state to the `Normal` state; in the example before that, the <xref:System.Windows.VisualTransition> is applied when the control goes into the `Pressed` state.</span></span> <span data-ttu-id="f74b8-275">Вы ограничиваете применение <xref:System.Windows.VisualTransition>, устанавливая свойства <xref:System.Windows.VisualTransition.To%2A> и <xref:System.Windows.VisualTransition.From%2A>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-275">You restrict when a <xref:System.Windows.VisualTransition> is applied by setting the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties.</span></span> <span data-ttu-id="f74b8-276">В таблице ниже приведено описание уровней ограничений от наибольшего до наименьшего.</span><span class="sxs-lookup"><span data-stu-id="f74b8-276">The following table describes the levels of restriction from most restrictive to least restrictive.</span></span>

|<span data-ttu-id="f74b8-277">Тип ограничения</span><span class="sxs-lookup"><span data-stu-id="f74b8-277">Type of restriction</span></span>|<span data-ttu-id="f74b8-278">Состояние, из которого выполняется переход</span><span class="sxs-lookup"><span data-stu-id="f74b8-278">Value of From</span></span>|<span data-ttu-id="f74b8-279">Состояние, в которое выполняется переход</span><span class="sxs-lookup"><span data-stu-id="f74b8-279">Value of To</span></span>|
|-------------------------|-------------------|-----------------|
|<span data-ttu-id="f74b8-280">Из указанного состояния в другое указанное состояние</span><span class="sxs-lookup"><span data-stu-id="f74b8-280">From a specified state to another specified state</span></span>|<span data-ttu-id="f74b8-281">Имя <xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="f74b8-281">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="f74b8-282">Имя <xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="f74b8-282">The name of a <xref:System.Windows.VisualState></span></span>|
|<span data-ttu-id="f74b8-283">Из любого состояния в указанное состояние</span><span class="sxs-lookup"><span data-stu-id="f74b8-283">From any state to a specified state</span></span>|<span data-ttu-id="f74b8-284">Не задано</span><span class="sxs-lookup"><span data-stu-id="f74b8-284">Not set</span></span>|<span data-ttu-id="f74b8-285">Имя <xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="f74b8-285">The name of a <xref:System.Windows.VisualState></span></span>|
|<span data-ttu-id="f74b8-286">Из указанного состояния в любое состояние</span><span class="sxs-lookup"><span data-stu-id="f74b8-286">From a specified state to any state</span></span>|<span data-ttu-id="f74b8-287">Имя <xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="f74b8-287">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="f74b8-288">Не задано</span><span class="sxs-lookup"><span data-stu-id="f74b8-288">Not set</span></span>|
|<span data-ttu-id="f74b8-289">Из любого состояния в любое другое состояние</span><span class="sxs-lookup"><span data-stu-id="f74b8-289">From any state to any other state</span></span>|<span data-ttu-id="f74b8-290">Не задано</span><span class="sxs-lookup"><span data-stu-id="f74b8-290">Not set</span></span>|<span data-ttu-id="f74b8-291">Не задано</span><span class="sxs-lookup"><span data-stu-id="f74b8-291">Not set</span></span>|

 <span data-ttu-id="f74b8-292">В <xref:System.Windows.VisualStateGroup>, которые ссылаются на одно и то же состояние, можно использовать несколько <xref:System.Windows.VisualTransition> объектов, но они будут использоваться в порядке, указанном в предыдущей таблице.</span><span class="sxs-lookup"><span data-stu-id="f74b8-292">You can have multiple <xref:System.Windows.VisualTransition> objects in a <xref:System.Windows.VisualStateGroup> that refer to the same state, but they will be used in the order that the previous table specifies.</span></span> <span data-ttu-id="f74b8-293">В следующем примере имеется два <xref:System.Windows.VisualTransition> объектов.</span><span class="sxs-lookup"><span data-stu-id="f74b8-293">In the following example, there are two <xref:System.Windows.VisualTransition> objects.</span></span> <span data-ttu-id="f74b8-294">Когда элемент управления переходит из состояния `Pressed` в состояние `MouseOver`, используется <xref:System.Windows.VisualTransition>, в котором заданы как <xref:System.Windows.VisualTransition.From%2A>, так и <xref:System.Windows.VisualTransition.To%2A>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-294">When the control transitions from the `Pressed` state to the `MouseOver` state, the <xref:System.Windows.VisualTransition> that has both <xref:System.Windows.VisualTransition.From%2A> and <xref:System.Windows.VisualTransition.To%2A> set is used.</span></span> <span data-ttu-id="f74b8-295">Когда элемент управления переходит из состояния, отличного от `Pressed`, в состояние `MouseOver`, используется другой объект.</span><span class="sxs-lookup"><span data-stu-id="f74b8-295">When the control transitions from a state that is not `Pressed` to the `MouseOver` state, the other state is used.</span></span>

 [!code-xaml[VSMButtonTemplate#7](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#7)]

 <span data-ttu-id="f74b8-296"><xref:System.Windows.VisualStateGroup> имеет свойство <xref:System.Windows.VisualStateGroup.Transitions%2A>, содержащее объекты <xref:System.Windows.VisualTransition>, которые применяются к <xref:System.Windows.VisualState> объектам в <xref:System.Windows.VisualStateGroup>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-296">The <xref:System.Windows.VisualStateGroup> has a <xref:System.Windows.VisualStateGroup.Transitions%2A> property that contains the <xref:System.Windows.VisualTransition> objects that apply to the <xref:System.Windows.VisualState> objects in the <xref:System.Windows.VisualStateGroup>.</span></span> <span data-ttu-id="f74b8-297">Как автор <xref:System.Windows.Controls.ControlTemplate>, вы можете включать любые <xref:System.Windows.VisualTransition>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-297">As the <xref:System.Windows.Controls.ControlTemplate> author, you are free to include any <xref:System.Windows.VisualTransition> you want.</span></span> <span data-ttu-id="f74b8-298">Однако если для свойств <xref:System.Windows.VisualTransition.To%2A> и <xref:System.Windows.VisualTransition.From%2A> заданы имена состояний, которые не находятся в <xref:System.Windows.VisualStateGroup>, <xref:System.Windows.VisualTransition> игнорируется.</span><span class="sxs-lookup"><span data-stu-id="f74b8-298">However, if the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties are set to state names that are not in the <xref:System.Windows.VisualStateGroup>, the <xref:System.Windows.VisualTransition> is ignored.</span></span>

 <span data-ttu-id="f74b8-299">В следующем примере показаны <xref:System.Windows.VisualStateGroup> для `CommonStates`.</span><span class="sxs-lookup"><span data-stu-id="f74b8-299">The following example shows the <xref:System.Windows.VisualStateGroup> for the `CommonStates`.</span></span> <span data-ttu-id="f74b8-300">В примере определяется <xref:System.Windows.VisualTransition> для каждого из следующих переходов кнопки.</span><span class="sxs-lookup"><span data-stu-id="f74b8-300">The example defines a <xref:System.Windows.VisualTransition> for each of the button's following transitions.</span></span>

- <span data-ttu-id="f74b8-301">в состояние `Pressed`;</span><span class="sxs-lookup"><span data-stu-id="f74b8-301">To the `Pressed` state.</span></span>

- <span data-ttu-id="f74b8-302">в состояние `MouseOver`;</span><span class="sxs-lookup"><span data-stu-id="f74b8-302">To the `MouseOver` state.</span></span>

- <span data-ttu-id="f74b8-303">из состояния `Pressed` в состояние `MouseOver`;</span><span class="sxs-lookup"><span data-stu-id="f74b8-303">From the `Pressed` state to the `MouseOver` state.</span></span>

- <span data-ttu-id="f74b8-304">из состояния `MouseOver` в состояние `Normal`;</span><span class="sxs-lookup"><span data-stu-id="f74b8-304">From the `MouseOver` state to the `Normal` state.</span></span>

 [!code-xaml[VSMButtonTemplate#VisualTransitions](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualtransitions)]

<a name="customizing_other_controls_by_understanding_the_control_contract"></a>
## <a name="customizing-other-controls-by-understanding-the-control-contract"></a><span data-ttu-id="f74b8-305">Настройка других элементов управления через понимание контракта элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-305">Customizing Other Controls by Understanding the Control Contract</span></span>
 <span data-ttu-id="f74b8-306">Элемент управления, использующий <xref:System.Windows.Controls.ControlTemplate> для указания его визуальной структуры (с помощью <xref:System.Windows.FrameworkElement> объектов) и визуального поведения (с помощью <xref:System.Windows.VisualState> объектов) использует модель управления частями.</span><span class="sxs-lookup"><span data-stu-id="f74b8-306">A control that uses a <xref:System.Windows.Controls.ControlTemplate> to specify its visual structure (by using <xref:System.Windows.FrameworkElement> objects) and visual behavior (by using <xref:System.Windows.VisualState> objects) uses the parts control model.</span></span> <span data-ttu-id="f74b8-307">Множество элементов управления, имеющихся в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4, используют эту модель.</span><span class="sxs-lookup"><span data-stu-id="f74b8-307">Many of the controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 use this model.</span></span> <span data-ttu-id="f74b8-308">Части, которые необходимо учитывать автору <xref:System.Windows.Controls.ControlTemplate>, взаимодействуют через контракт управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-308">The parts that a <xref:System.Windows.Controls.ControlTemplate> author needs to be aware of are communicated through the control contract.</span></span> <span data-ttu-id="f74b8-309">Поняв части контракта элемента управления, можно настроить внешний вид любого элемента управления, использующего модель частей элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-309">When you understand the parts of a control contract, you can customize the appearance of any control that uses the parts control model.</span></span>

 <span data-ttu-id="f74b8-310">Контракт элемента управления имеет три элемента:</span><span class="sxs-lookup"><span data-stu-id="f74b8-310">A control contract has three elements:</span></span>

- <span data-ttu-id="f74b8-311">визуальный элемент, используемый логикой элемента управления;</span><span class="sxs-lookup"><span data-stu-id="f74b8-311">The visual elements that the control's logic uses.</span></span>

- <span data-ttu-id="f74b8-312">состояния элемента управления и группа, к которой принадлежит каждое состояние;</span><span class="sxs-lookup"><span data-stu-id="f74b8-312">The states of the control and the group each state belongs to.</span></span>

- <span data-ttu-id="f74b8-313">общие свойства, визуально воздействующие на элемент управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-313">The public properties that visually affect the control.</span></span>

### <a name="visual-elements-in-the-control-contract"></a><span data-ttu-id="f74b8-314">Визуальные элементы в контракте элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-314">Visual Elements in the Control Contract</span></span>
 <span data-ttu-id="f74b8-315">Иногда логика элемента управления взаимодействует с <xref:System.Windows.FrameworkElement>, который находится в <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-315">Sometimes a control's logic interacts with a <xref:System.Windows.FrameworkElement> that is in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="f74b8-316">Например, элемент управления может обрабатывать событие одного из своих элементов.</span><span class="sxs-lookup"><span data-stu-id="f74b8-316">For example, the control might handle an event of one of its elements.</span></span> <span data-ttu-id="f74b8-317">Когда элемент управления планирует найти определенный <xref:System.Windows.FrameworkElement> в <xref:System.Windows.Controls.ControlTemplate>, он должен передать эту информацию автору <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-317">When a control expects to find a particular <xref:System.Windows.FrameworkElement> in the <xref:System.Windows.Controls.ControlTemplate>, it must convey that information to the <xref:System.Windows.Controls.ControlTemplate> author.</span></span> <span data-ttu-id="f74b8-318">Элемент управления использует <xref:System.Windows.TemplatePartAttribute>, чтобы передать ожидаемый тип элемента и имя элемента.</span><span class="sxs-lookup"><span data-stu-id="f74b8-318">The control uses the <xref:System.Windows.TemplatePartAttribute> to convey the type of element that is expected, and what the name of the element should be.</span></span> <span data-ttu-id="f74b8-319"><xref:System.Windows.Controls.Button> не содержит <xref:System.Windows.FrameworkElement> частей в контракте элемента управления, но другие элементы управления, такие как <xref:System.Windows.Controls.ComboBox>, делают.</span><span class="sxs-lookup"><span data-stu-id="f74b8-319">The <xref:System.Windows.Controls.Button> does not have <xref:System.Windows.FrameworkElement> parts in its control contract, but other controls, such as the <xref:System.Windows.Controls.ComboBox>, do.</span></span>

 <span data-ttu-id="f74b8-320">В следующем примере показаны объекты <xref:System.Windows.TemplatePartAttribute>, указанные в классе <xref:System.Windows.Controls.ComboBox>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-320">The following example shows the <xref:System.Windows.TemplatePartAttribute> objects that are specified on the <xref:System.Windows.Controls.ComboBox> class.</span></span> <span data-ttu-id="f74b8-321">Логика <xref:System.Windows.Controls.ComboBox> планирует найти в `PART_Popup`е <xref:System.Windows.Controls.TextBox> с именем `PART_EditableTextBox` и <xref:System.Windows.Controls.Primitives.Popup> с именем <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-321">The logic of <xref:System.Windows.Controls.ComboBox> expects to find a <xref:System.Windows.Controls.TextBox> named `PART_EditableTextBox` and a <xref:System.Windows.Controls.Primitives.Popup> named `PART_Popup` in its <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 [!code-csharp[VSMButtonTemplate#ComboBoxContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#comboboxcontract)]
 [!code-vb[VSMButtonTemplate#ComboBoxContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#comboboxcontract)]

 <span data-ttu-id="f74b8-322">В следующем примере показано упрощенное <xref:System.Windows.Controls.ControlTemplate> для <xref:System.Windows.Controls.ComboBox>, включающего элементы, заданные <xref:System.Windows.TemplatePartAttribute>ными объектами в классе <xref:System.Windows.Controls.ComboBox>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-322">The following example shows a simplified <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.ComboBox> that includes the elements that are specified by the <xref:System.Windows.TemplatePartAttribute> objects on the <xref:System.Windows.Controls.ComboBox> class.</span></span>

 [!code-xaml[VSMButtonTemplate#ComboBoxTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/window1.xaml#comboboxtemplate)]

### <a name="states-in-the-control-contract"></a><span data-ttu-id="f74b8-323">Состояния в контракте элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-323">States in the Control Contract</span></span>
 <span data-ttu-id="f74b8-324">Состояния элемента управления также являются частью контракта элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-324">The states of a control are also a part of the control contract.</span></span> <span data-ttu-id="f74b8-325">Пример создания <xref:System.Windows.Controls.ControlTemplate> для <xref:System.Windows.Controls.Button> показывает, как задать внешний вид <xref:System.Windows.Controls.Button> в зависимости от его состояний.</span><span class="sxs-lookup"><span data-stu-id="f74b8-325">The example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button> shows how to specify the appearance of a <xref:System.Windows.Controls.Button> depending on its states.</span></span> <span data-ttu-id="f74b8-326">Можно создать <xref:System.Windows.VisualState> для каждого заданного состояния и разместить все <xref:System.Windows.VisualState> объекты, совместно использующие <xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A>, в <xref:System.Windows.VisualStateGroup>, как описано в разделе [Изменение внешнего вида элемента управления в зависимости от его состояния](#changing_the_appearance_of_a_control_depending_on_its_state) ранее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="f74b8-326">You create a <xref:System.Windows.VisualState> for each specified state and put all <xref:System.Windows.VisualState> objects that share a <xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A> in a <xref:System.Windows.VisualStateGroup>, as described in [Changing the Appearance of a Control Depending on Its State](#changing_the_appearance_of_a_control_depending_on_its_state) earlier in this topic.</span></span> <span data-ttu-id="f74b8-327">Сторонние элементы управления должны указывать состояния с помощью <xref:System.Windows.TemplateVisualStateAttribute>, что позволяет средствам конструктора, таким как [конструктор XAML](/visualstudio/xaml-tools/designing-xaml-in-visual-studio) в Visual Studio и Blend для Visual Studio, предоставлять состояния элемента управления для создания шаблонов элементов управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-327">Third-party controls should specify states by using the <xref:System.Windows.TemplateVisualStateAttribute>, which enables designer tools, such as the [XAML Designer](/visualstudio/xaml-tools/designing-xaml-in-visual-studio) in Visual Studio and Blend for Visual Studio, to expose the control's states for authoring control templates.</span></span>

 <span data-ttu-id="f74b8-328">Контракты элементов управления, включенных в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], в разделе [Стили и шаблоны элемента Control](control-styles-and-templates.md).</span><span class="sxs-lookup"><span data-stu-id="f74b8-328">To find the control contract for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](control-styles-and-templates.md).</span></span>

### <a name="properties-in-the-control-contract"></a><span data-ttu-id="f74b8-329">Свойства в контракте элемента управления</span><span class="sxs-lookup"><span data-stu-id="f74b8-329">Properties in the Control Contract</span></span>
 <span data-ttu-id="f74b8-330">Общие свойства, визуально влияющие на элемент управления, также включаются в контракт элемента управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-330">The public properties that visually affect the control are also included in the control contract.</span></span> <span data-ttu-id="f74b8-331">Эти свойства можно задать, чтобы изменить внешний вид элемента управления без создания нового <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-331">You can set these properties to change the appearance of the control without creating a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="f74b8-332">Расширение разметки [TemplateBinding](../advanced/templatebinding-markup-extension.md) также можно использовать для привязки свойств элементов, которые находятся в <xref:System.Windows.Controls.ControlTemplate>, к общим свойствам, определенным <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="f74b8-332">You can also use the [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the <xref:System.Windows.Controls.Button>.</span></span>

 <span data-ttu-id="f74b8-333">В следующем примере показан контракт элемента управления "Кнопка".</span><span class="sxs-lookup"><span data-stu-id="f74b8-333">The following example shows the control contract for the button.</span></span>

 [!code-csharp[VSMButtonTemplate#ButtonContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#buttoncontract)]
 [!code-vb[VSMButtonTemplate#ButtonContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#buttoncontract)]

 <span data-ttu-id="f74b8-334">При создании <xref:System.Windows.Controls.ControlTemplate>проще всего начать с существующего <xref:System.Windows.Controls.ControlTemplate> и внести в него изменения.</span><span class="sxs-lookup"><span data-stu-id="f74b8-334">When creating a <xref:System.Windows.Controls.ControlTemplate>, it is often easiest to begin with an existing <xref:System.Windows.Controls.ControlTemplate> and make changes to it.</span></span> <span data-ttu-id="f74b8-335">Для изменения существующего <xref:System.Windows.Controls.ControlTemplate>можно выполнить одно из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="f74b8-335">You can do one of the following to change an existing <xref:System.Windows.Controls.ControlTemplate>:</span></span>

- <span data-ttu-id="f74b8-336">Используйте конструктор, например Blend для Visual Studio, который предоставляет графический пользовательский интерфейс для создания шаблонов элементов управления.</span><span class="sxs-lookup"><span data-stu-id="f74b8-336">Use a designer, such as Blend for Visual Studio, that provides a graphical user interface for creating control templates.</span></span> <span data-ttu-id="f74b8-337">Дополнительные сведения см. в статье [Настройка стиля элемента управления, поддерживающего шаблон](https://go.microsoft.com/fwlink/?LinkId=161153).</span><span class="sxs-lookup"><span data-stu-id="f74b8-337">For more information, see [Styling a control that supports templates](https://go.microsoft.com/fwlink/?LinkId=161153).</span></span>

- <span data-ttu-id="f74b8-338">Получите <xref:System.Windows.Controls.ControlTemplate> по умолчанию и измените его.</span><span class="sxs-lookup"><span data-stu-id="f74b8-338">Get the default <xref:System.Windows.Controls.ControlTemplate> and edit it.</span></span> <span data-ttu-id="f74b8-339">Шаблоны элементов управления по умолчанию, включенных в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], см. в документе [Default WPF Themes](https://go.microsoft.com/fwlink/?LinkID=158252).</span><span class="sxs-lookup"><span data-stu-id="f74b8-339">To find the default control templates that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Default WPF Themes](https://go.microsoft.com/fwlink/?LinkID=158252).</span></span>

<a name="complete_example"></a>
## <a name="complete-example"></a><span data-ttu-id="f74b8-340">Полный пример</span><span class="sxs-lookup"><span data-stu-id="f74b8-340">Complete Example</span></span>
 <span data-ttu-id="f74b8-341">В следующем примере показан полный <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate>, который рассматривается в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f74b8-341">The following example shows the complete <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate> that is discussed in this topic.</span></span>

 [!code-xaml[VSMButtonTemplate#3](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#3)]

## <a name="see-also"></a><span data-ttu-id="f74b8-342">См. также</span><span class="sxs-lookup"><span data-stu-id="f74b8-342">See also</span></span>

- [<span data-ttu-id="f74b8-343">Стилизация и использование шаблонов</span><span class="sxs-lookup"><span data-stu-id="f74b8-343">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
