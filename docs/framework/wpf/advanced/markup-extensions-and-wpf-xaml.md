---
title: Расширения разметки и XAML WPF
ms.date: 03/30/2017
helpviewer_keywords:
- brace character [WPF]
- Binding markup extensions [WPF]
- RelativeSource markup extensions [WPF]
- XAML [WPF], markup extensions
- markup extensions [WPF]
- nesting extension syntax [WPF]
- curly brace characters ({})
- TemplateBinding markup extensions [WPF]
- StaticResource markup extensions [WPF]
- literal curly brace characters ({})
- characters [WPF], curly brace
- DynamicResource markup extensions [WPF]
ms.assetid: 618dc745-8b14-4886-833f-486d2254bb78
ms.openlocfilehash: 7ba2beae4ef8176764a5caaff609c365f283e285
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73459823"
---
# <a name="markup-extensions-and-wpf-xaml"></a><span data-ttu-id="692a7-102">Расширения разметки и XAML WPF</span><span class="sxs-lookup"><span data-stu-id="692a7-102">Markup Extensions and WPF XAML</span></span>
<span data-ttu-id="692a7-103">В этом разделе рассматриваются концепции расширений разметки для XAML, включая их синтаксические правила, назначение и формирующую их объектную модель классов.</span><span class="sxs-lookup"><span data-stu-id="692a7-103">This topic introduces the concept of markup extensions for XAML, including their syntax rules, purpose, and the class object model that underlies them.</span></span> <span data-ttu-id="692a7-104">Расширения разметки — это общая функция языка XAML и реализация служб XAML платформы .NET.</span><span class="sxs-lookup"><span data-stu-id="692a7-104">Markup extensions are a general feature of the XAML language and of the .NET implementation of XAML services.</span></span> <span data-ttu-id="692a7-105">В этом разделе рассматриваются расширения разметки для использования в XAML WPF.</span><span class="sxs-lookup"><span data-stu-id="692a7-105">This topic specifically details markup extensions for use in WPF XAML.</span></span>  

<a name="XAML_Processors_and_Markup_Extensions"></a>   
## <a name="xaml-processors-and-markup-extensions"></a><span data-ttu-id="692a7-106">Обработчики XAML и расширения разметки</span><span class="sxs-lookup"><span data-stu-id="692a7-106">XAML Processors and Markup Extensions</span></span>  
 <span data-ttu-id="692a7-107">В целом средство синтаксического анализа XAML может интерпретировать значение атрибута как строковый литерал, который можно преобразовать в примитив, или преобразовать его в объект каким-либо способом.</span><span class="sxs-lookup"><span data-stu-id="692a7-107">Generally speaking, a XAML parser can either interpret an attribute value as a literal string that can be converted to a primitive, or convert it to an object by some means.</span></span> <span data-ttu-id="692a7-108">Один из таких способов заключается в обращении к преобразователю типов. Это описывается в разделе [Преобразователи типов и XAML](typeconverters-and-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-108">One such means is by referencing a type converter; this is documented in the topic [TypeConverters and XAML](typeconverters-and-xaml.md).</span></span> <span data-ttu-id="692a7-109">Однако существуют сценарии, где требуется другое поведение.</span><span class="sxs-lookup"><span data-stu-id="692a7-109">However, there are scenarios where different behavior is required.</span></span> <span data-ttu-id="692a7-110">Например, обработчику XAML можно указать, что значение атрибута не должно порождать новый объект в графе объектов.</span><span class="sxs-lookup"><span data-stu-id="692a7-110">For example, a XAML processor can be instructed that a value of an attribute should not result in a new object in the object graph.</span></span> <span data-ttu-id="692a7-111">Вместо этого атрибут должен обеспечить граф объектов, который ссылается на уже созданный объект в другой части графа или на статический объект.</span><span class="sxs-lookup"><span data-stu-id="692a7-111">Instead, the attribute should result in an object graph that makes a reference to an already constructed object in another part of the graph, or a static object.</span></span> <span data-ttu-id="692a7-112">В другом сценарии обработчик XAML может получить указание использовать синтаксис, предоставляющий конструктору объекта аргументы, отличные от аргументов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="692a7-112">Another scenario is that a XAML processor can be instructed to use a syntax that provides non-default arguments to the constructor of an object.</span></span> <span data-ttu-id="692a7-113">Это типы сценариев, где расширение разметки может предоставить решение.</span><span class="sxs-lookup"><span data-stu-id="692a7-113">These are the types of scenarios where a markup extension can provide the solution.</span></span>  
  
<a name="Basic_Markup_Extension_Syntax"></a>   
## <a name="basic-markup-extension-syntax"></a><span data-ttu-id="692a7-114">Базовый синтаксис расширения разметки</span><span class="sxs-lookup"><span data-stu-id="692a7-114">Basic Markup Extension Syntax</span></span>  
 <span data-ttu-id="692a7-115">Расширение разметки можно реализовать для предоставления значений атрибутов при использовании атрибутов, свойств при использовании элементов свойств или и того и другого.</span><span class="sxs-lookup"><span data-stu-id="692a7-115">A markup extension can be implemented to provide values for properties in an attribute usage, properties in a property element usage, or both.</span></span>  
  
 <span data-ttu-id="692a7-116">При использовании расширения разметки для предоставления значения атрибута синтаксис, который позволяет обработчику XAML различать последовательность расширения разметки, подразумевает наличие открывающей и закрывающей фигурных скобок ({ и }).</span><span class="sxs-lookup"><span data-stu-id="692a7-116">When used to provide an attribute value, the syntax that distinguishes a markup extension sequence to a XAML processor is the presence of the opening and closing curly braces ({ and }).</span></span> <span data-ttu-id="692a7-117">Затем тип расширения разметки определяется по токену строки, следующему сразу после открывающей фигурной скобки.</span><span class="sxs-lookup"><span data-stu-id="692a7-117">The type of markup extension is then identified by the string token immediately following the opening curly brace.</span></span>  
  
 <span data-ttu-id="692a7-118">При использовании в синтаксисе элемента свойства расширение разметки визуально не отличается от любого другого элемента, используемого для предоставления значения элемента свойства: объявление элемента XAML, которое ссылается на класс расширения разметки как на элемент, заключается в угловые скобки (<>).</span><span class="sxs-lookup"><span data-stu-id="692a7-118">When used in property element syntax, a markup extension is visually the same as any other element used to provide a property element value: a XAML element declaration that references the markup extension class as an element, enclosed within angle brackets (<>).</span></span>  
  
<a name="XAML_Defined_Markup_Extensions"></a>   
## <a name="xaml-defined-markup-extensions"></a><span data-ttu-id="692a7-119">Расширения разметки, определенные в XAML</span><span class="sxs-lookup"><span data-stu-id="692a7-119">XAML-Defined Markup Extensions</span></span>  
 <span data-ttu-id="692a7-120">Существует несколько расширений разметки, которые не относятся к реализации WPF XAML, но являются реализациями внутренних параметров или функций XAML как языка.</span><span class="sxs-lookup"><span data-stu-id="692a7-120">Several markup extensions exist that are not specific to the WPF implementation of XAML, but are instead implementations of intrinsics or features of XAML as a language.</span></span> <span data-ttu-id="692a7-121">Эти расширения разметки реализуются в сборке System.Xaml как часть общих служб .NET Framework XAML и находятся в пространстве имен XAML языка XAML.</span><span class="sxs-lookup"><span data-stu-id="692a7-121">These markup extensions are implemented in the System.Xaml assembly as part of the general .NET Framework XAML services, and are within the XAML language XAML namespace.</span></span> <span data-ttu-id="692a7-122">В обычном синтаксисе разметки эти расширения разметки обычно распознаются по префиксу `x:`.</span><span class="sxs-lookup"><span data-stu-id="692a7-122">In terms of common markup usage, these markup extensions are typically identifiable by the `x:` prefix in the usage.</span></span> <span data-ttu-id="692a7-123">Базовый класс <xref:System.Windows.Markup.MarkupExtension> (также определенный в System. XAML) предоставляет шаблон, который все расширения разметки должны использовать для поддержки в средствах чтения и записи XAML, включая в WPF XAML.</span><span class="sxs-lookup"><span data-stu-id="692a7-123">The <xref:System.Windows.Markup.MarkupExtension> base class (also defined in System.Xaml) provides the pattern that all markup extensions should use in order to be supported in XAML readers and XAML writers, including in WPF XAML.</span></span>  
  
- <span data-ttu-id="692a7-124">`x:Type` предоставляет объект <xref:System.Type> для именованного типа.</span><span class="sxs-lookup"><span data-stu-id="692a7-124">`x:Type` supplies the <xref:System.Type> object for the named type.</span></span> <span data-ttu-id="692a7-125">Это средство наиболее часто используется в стилях и шаблонах.</span><span class="sxs-lookup"><span data-stu-id="692a7-125">This facility is used most frequently in styles and templates.</span></span> <span data-ttu-id="692a7-126">Дополнительные сведения см. в разделе [Расширение разметки x:Type](../../xaml-services/x-type-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-126">For details, see [x:Type Markup Extension](../../xaml-services/x-type-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-127">`x:Static` создает статические значения.</span><span class="sxs-lookup"><span data-stu-id="692a7-127">`x:Static` produces static values.</span></span> <span data-ttu-id="692a7-128">Эти значения поступают из сущностей кода типа значения, которые непосредственно не принадлежат к типу значения целевого свойства, но могут быть приведены к нему.</span><span class="sxs-lookup"><span data-stu-id="692a7-128">The values come from value-type code entities that are not directly the type of a target property's value, but can be evaluated to that type.</span></span> <span data-ttu-id="692a7-129">Дополнительные сведения см. в разделе [Расширение разметки x:Static](../../xaml-services/x-static-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-129">For details, see [x:Static Markup Extension](../../xaml-services/x-static-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-130">`x:Null` задает `null` как значение для свойства и может использоваться для атрибутов или значений элементов свойств.</span><span class="sxs-lookup"><span data-stu-id="692a7-130">`x:Null` specifies `null` as a value for a property and can be used either for attributes or property element values.</span></span> <span data-ttu-id="692a7-131">Дополнительные сведения см. в разделе [Расширение разметки x:NULL](../../xaml-services/x-null-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-131">For details, see [x:Null Markup Extension](../../xaml-services/x-null-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-132">`x:Array` обеспечивает поддержку создания общих массивов в синтаксисе XAML для случаев, когда поддержка коллекций, предоставляемая базовыми элементами и моделями элементов управления WPF, намеренно не используется.</span><span class="sxs-lookup"><span data-stu-id="692a7-132">`x:Array` provides support for creation of general arrays in XAML syntax, for cases where the collection support provided by WPF base elements and control models is deliberately not used.</span></span> <span data-ttu-id="692a7-133">Дополнительные сведения см. в разделе [Расширение разметки x:Array](../../xaml-services/x-array-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-133">For details, see [x:Array Markup Extension](../../xaml-services/x-array-markup-extension.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="692a7-134">Префикс `x:` используется для обычного сопоставления пространства имен XAML внутренних параметров языка XAML в корневом элементе файла или рабочей среды XAML.</span><span class="sxs-lookup"><span data-stu-id="692a7-134">The `x:` prefix is used for the typical XAML namespace mapping of the XAML language intrinsics, in the root element of a XAML file or production.</span></span> <span data-ttu-id="692a7-135">Например, шаблоны Visual Studio для приложений WPF инициируют XAML-файл с помощью этого `x:` сопоставления.</span><span class="sxs-lookup"><span data-stu-id="692a7-135">For example, the Visual Studio templates for WPF applications initiate a XAML file using this `x:` mapping.</span></span> <span data-ttu-id="692a7-136">Можно выбрать другой маркер префикса в собственном сопоставлении пространства имен XAML, но в этой документации предполагается использование сопоставления по умолчанию `x:` как средства идентификации этих сущностей, которые являются определенной частью пространства имен XAML для языка XAML, в отличие от пространства имен WPF по умолчанию или других пространств имен XAML, не связанных с конкретной платформой.</span><span class="sxs-lookup"><span data-stu-id="692a7-136">You could choose a different prefix token in your own XAML namespace mapping, but this documentation will assume the default `x:` mapping as a means of identifying those entities that are a defined part of the XAML namespace for the XAML language, as opposed to the WPF default namespace or other XAML namespaces not related to a specific framework.</span></span>  
  
<a name="WPF_Specific_Markup_Extensions"></a>   
## <a name="wpf-specific-markup-extensions"></a><span data-ttu-id="692a7-137">Расширения разметки для WPF</span><span class="sxs-lookup"><span data-stu-id="692a7-137">WPF-Specific Markup Extensions</span></span>  
 <span data-ttu-id="692a7-138">Наиболее распространенными расширениями разметки, используемыми в программировании WPF, являются те, которые поддерживают ссылки на ресурсы (`StaticResource` и `DynamicResource`) и те, которые поддерживают привязку данных (`Binding`).</span><span class="sxs-lookup"><span data-stu-id="692a7-138">The most common markup extensions used in WPF programming are those that support resource references (`StaticResource` and `DynamicResource`), and those that support data binding (`Binding`).</span></span>  
  
- <span data-ttu-id="692a7-139">`StaticResource` обеспечивает значение для свойства, заменяя значение уже заданного ресурса.</span><span class="sxs-lookup"><span data-stu-id="692a7-139">`StaticResource` provides a value for a property by substituting the value of an already defined resource.</span></span> <span data-ttu-id="692a7-140">Оценка `StaticResource` в конечном счете выполняется во время загрузки XAML и не имеет доступа к графу объектов во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="692a7-140">A `StaticResource` evaluation is ultimately made at XAML load time and does not have access to the object graph at run time.</span></span> <span data-ttu-id="692a7-141">Дополнительные сведения см. в разделе [Расширение разметки StaticResource](staticresource-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-141">For details, see [StaticResource Markup Extension](staticresource-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-142">`DynamicResource` обеспечивает значение для свойства в виде ссылки на ресурс, отложенной до времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="692a7-142">`DynamicResource` provides a value for a property by deferring that value to be a run-time reference to a resource.</span></span> <span data-ttu-id="692a7-143">Ссылка на динамический ресурс вызывает новый поиск каждый раз, когда осуществляется доступ к такому ресурсу, и имеет доступ к графу объектов во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="692a7-143">A dynamic resource reference forces a new lookup each time that such a resource is accessed and has access to the object graph at run time.</span></span> <span data-ttu-id="692a7-144">Для получения такого доступа концепция `DynamicResource` поддерживается свойствами зависимостей в системе свойств WPF и вычисляемыми выражениями.</span><span class="sxs-lookup"><span data-stu-id="692a7-144">In order to get this access, `DynamicResource` concept is supported by dependency properties in the WPF property system, and evaluated expressions.</span></span> <span data-ttu-id="692a7-145">Таким образом, вы можете использовать `DynamicResource` только для целевого свойства зависимостей.</span><span class="sxs-lookup"><span data-stu-id="692a7-145">Therefore you can only use `DynamicResource` for a dependency property target.</span></span> <span data-ttu-id="692a7-146">Дополнительные сведения см. в разделе [Расширение разметки DynamicResource](dynamicresource-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-146">For details, see [DynamicResource Markup Extension](dynamicresource-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-147">`Binding` предоставляет для свойства привязанное к данным значение, используя контекст данных, который применяется к родительскому объекту во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="692a7-147">`Binding` provides a data bound value for a property, using the data context that applies to the parent object at run time.</span></span> <span data-ttu-id="692a7-148">Это расширение разметки довольно сложное, поскольку разрешает использовать важный встроенный синтаксис для указания привязки данных.</span><span class="sxs-lookup"><span data-stu-id="692a7-148">This markup extension is relatively complex, because it enables a substantial inline syntax for specifying a data binding.</span></span> <span data-ttu-id="692a7-149">Дополнительные сведения см. в разделе [Привязка расширения разметки](binding-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-149">For details, see [Binding Markup Extension](binding-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-150">`RelativeSource` предоставляет сведения об источнике для <xref:System.Windows.Data.Binding>, который может перемещаться по нескольким возможным связям в дереве объектов времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="692a7-150">`RelativeSource` provides source information for a <xref:System.Windows.Data.Binding> that can navigate several possible relationships in the run-time object tree.</span></span> <span data-ttu-id="692a7-151">Это обеспечивает специализированные источники для привязок, которые создаются в шаблонах для многократного использования или в коде без полных сведений об окружающем дереве объектов.</span><span class="sxs-lookup"><span data-stu-id="692a7-151">This provides specialized sourcing for bindings that are created in multi-use templates or created in code without full knowledge of the surrounding object tree.</span></span> <span data-ttu-id="692a7-152">Дополнительные сведения см. в разделе [Расширение разметки RelativeSource](relativesource-markupextension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-152">For details, see [RelativeSource MarkupExtension](relativesource-markupextension.md).</span></span>  
  
- <span data-ttu-id="692a7-153">`TemplateBinding` позволяет шаблону элемента управления использовать значения для шаблонных свойств, получаемых из определенных объектной моделью свойств класса, который будет использовать этот шаблон.</span><span class="sxs-lookup"><span data-stu-id="692a7-153">`TemplateBinding` enables a control template to use values for templated properties that come from object-model-defined properties of the class that will use the template.</span></span> <span data-ttu-id="692a7-154">Другими словами, свойство в определении шаблона может получить доступ к контексту, который существует только после применения шаблона.</span><span class="sxs-lookup"><span data-stu-id="692a7-154">In other words, the property within the template definition can access a context that only exists once the template is applied.</span></span> <span data-ttu-id="692a7-155">Дополнительные сведения см. в разделе [Расширение разметки TemplateBinding](templatebinding-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-155">For details, see [TemplateBinding Markup Extension](templatebinding-markup-extension.md).</span></span> <span data-ttu-id="692a7-156">Дополнительные сведения о практическом применении `TemplateBinding` см. в разделе [Пример задания стиля с помощью ControlTemplates](https://github.com/Microsoft/WPF-Samples/tree/master/Styles%20&%20Templates/IntroToStylingAndTemplating).</span><span class="sxs-lookup"><span data-stu-id="692a7-156">For more information on the practical use of `TemplateBinding`, see [Styling with ControlTemplates Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Styles%20&%20Templates/IntroToStylingAndTemplating).</span></span>  
  
- <span data-ttu-id="692a7-157">`ColorConvertedBitmap` поддерживает сравнительно сложный сценарий создания образов.</span><span class="sxs-lookup"><span data-stu-id="692a7-157">`ColorConvertedBitmap` supports a relatively advanced imaging scenario.</span></span> <span data-ttu-id="692a7-158">Дополнительные сведения см. в разделе [Расширение разметки ColorConvertedBitmap](colorconvertedbitmap-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-158">For details, see [ColorConvertedBitmap Markup Extension](colorconvertedbitmap-markup-extension.md).</span></span>  
  
- <span data-ttu-id="692a7-159">`ComponentResourceKey` и `ThemeDictionary` поддерживают аспекты поиска ресурсов, в честности ресурсов и тем, упакованных в пользовательские элементы управления.</span><span class="sxs-lookup"><span data-stu-id="692a7-159">`ComponentResourceKey` and `ThemeDictionary` support aspects of resource lookup, particularly for resources and themes that are packaged with custom controls.</span></span> <span data-ttu-id="692a7-160">Дополнительные сведения см. в разделе [Расширение разметки ComponentResourceKey](componentresourcekey-markup-extension.md), [Расширение разметки ThemeDictionary](themedictionary-markup-extension.md) или [Общие сведения о разработке элементов управления](../controls/control-authoring-overview.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-160">For more information, see [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md), [ThemeDictionary Markup Extension](themedictionary-markup-extension.md), or [Control Authoring Overview](../controls/control-authoring-overview.md).</span></span>  
  
<a name="StarExtension"></a>   
## <a name="extension-classes"></a><span data-ttu-id="692a7-161">Классы расширений \*</span><span class="sxs-lookup"><span data-stu-id="692a7-161">\*Extension Classes</span></span>  
 <span data-ttu-id="692a7-162">Как для общего языка XAML, так и для расширений разметки WPF поведение каждого расширения разметки определяется обработчиком XAML через класс `*Extension`, производный от <xref:System.Windows.Markup.MarkupExtension>, и предоставляет реализацию метода <xref:System.Windows.Markup.StaticExtension.ProvideValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="692a7-162">For both the general XAML language and WPF-specific markup extensions, the behavior of each markup extension is identified to a XAML processor through a `*Extension` class that derives from <xref:System.Windows.Markup.MarkupExtension>, and provides an implementation of the <xref:System.Windows.Markup.StaticExtension.ProvideValue%2A> method.</span></span> <span data-ttu-id="692a7-163">Этот метод в каждом расширении предоставляет объект, который возвращается при вычислении расширения разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-163">This method on each extension provides the object that is returned when the markup extension is evaluated.</span></span> <span data-ttu-id="692a7-164">Возвращаемый объект обычно вычисляется, исходя из различных токенов строк, передаваемых в расширение разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-164">The returned object is typically evaluated based on the various string tokens that are passed to the markup extension.</span></span>  
  
 <span data-ttu-id="692a7-165">Например, класс <xref:System.Windows.StaticResourceExtension> предоставляет реализацию фактического уточняющего запроса ресурса, чтобы его <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> реализация возвращала запрошенный объект, а вход этой конкретной реализации — строка, которая используется для поиска ресурс по его `x:Key`у.</span><span class="sxs-lookup"><span data-stu-id="692a7-165">For example, the <xref:System.Windows.StaticResourceExtension> class provides the surface implementation of actual resource lookup so that its <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> implementation returns the object that is requested, with the input of that particular implementation being a string that is used to look up the resource by its `x:Key`.</span></span> <span data-ttu-id="692a7-166">Большая часть подробностей этой реализации не важна при использовании существующего расширения разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-166">Much of this implementation detail is unimportant if you are using an existing markup extension.</span></span>  
  
 <span data-ttu-id="692a7-167">Некоторые расширения разметки не используют аргументы токенов строк.</span><span class="sxs-lookup"><span data-stu-id="692a7-167">Some markup extensions do not use string token arguments.</span></span> <span data-ttu-id="692a7-168">Это происходит либо потому, что они возвращают статическое или согласованное значение, либо потому, что контекст для значения, которое должно быть возвращено, доступен посредством одной из служб, передаваемых через параметр `serviceProvider`.</span><span class="sxs-lookup"><span data-stu-id="692a7-168">This is either because they return a static or consistent value, or because context for what value should be returned is available through one of the services passed through the `serviceProvider` parameter.</span></span>  
  
 <span data-ttu-id="692a7-169">Шаблон именования `*Extension` принят для удобства и согласованности.</span><span class="sxs-lookup"><span data-stu-id="692a7-169">The `*Extension` naming pattern is for convenience and consistency.</span></span> <span data-ttu-id="692a7-170">Он не требуется, чтобы обработчик XAML определил этот класс как поддерживающий расширение разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-170">It is not necessary in order for a XAML processor to identify that class as support for a markup extension.</span></span> <span data-ttu-id="692a7-171">До тех пор, пока база кода включает System. XAML и использует .NET Framework реализации служб XAML, все, что необходимо распознать как расширение разметки XAML, должно быть производным от <xref:System.Windows.Markup.MarkupExtension> и поддерживать синтаксис конструкции.</span><span class="sxs-lookup"><span data-stu-id="692a7-171">So long as your codebase includes System.Xaml and uses .NET Framework XAML Services implementations, all that is necessary to be recognized as a XAML markup extension is to derive from <xref:System.Windows.Markup.MarkupExtension> and to support a construction syntax.</span></span> <span data-ttu-id="692a7-172">WPF определяет классы, разрешающие расширения разметки, которые не соответствуют шаблону именования `*Extension`, например <xref:System.Windows.Data.Binding>.</span><span class="sxs-lookup"><span data-stu-id="692a7-172">WPF defines markup extension-enabling classes that do not follow the `*Extension` naming pattern, for example <xref:System.Windows.Data.Binding>.</span></span> <span data-ttu-id="692a7-173">Обычно причина заключается в том, что класс поддерживает не только расширение разметки, но и сценарии.</span><span class="sxs-lookup"><span data-stu-id="692a7-173">Typically the reason for this is that the class supports scenarios beyond pure markup extension support.</span></span> <span data-ttu-id="692a7-174">В случае <xref:System.Windows.Data.Binding>этот класс поддерживает доступ во время выполнения к методам и свойствам объекта для сценариев, которые ничего не делают с XAML.</span><span class="sxs-lookup"><span data-stu-id="692a7-174">In the case of <xref:System.Windows.Data.Binding>, that class supports run-time access to methods and properties of the object for scenarios that have nothing to do with XAML.</span></span>  
  
### <a name="extension-class-interpretation-of-initialization-text"></a><span data-ttu-id="692a7-175">Интерпретация текста инициализации класса Extension</span><span class="sxs-lookup"><span data-stu-id="692a7-175">Extension Class Interpretation of Initialization Text</span></span>  
 <span data-ttu-id="692a7-176">Токены строки, следующие именем расширения разметки и по-прежнему заключенные в фигурные скобки, интерпретируются обработчиком XAML одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="692a7-176">The string tokens following the markup extension name and still within the braces are interpreted by a XAML processor in one of the following ways:</span></span>  
  
- <span data-ttu-id="692a7-177">Запятая всегда представляет разделитель отдельных токенов.</span><span class="sxs-lookup"><span data-stu-id="692a7-177">A comma always represents the separator or delimiter of individual tokens.</span></span>  
  
- <span data-ttu-id="692a7-178">Если отдельные разделенные токены не содержат знаки равенства, каждый токен считается аргументом конструктора.</span><span class="sxs-lookup"><span data-stu-id="692a7-178">If the individual separated tokens do not contain any equals signs, each token is treated as a constructor argument.</span></span> <span data-ttu-id="692a7-179">Каждый параметр конструктора должен передаваться в качестве типа, ожидаемого сигнатурой, и в соответствующем порядке, ожидаемом сигнатурой.</span><span class="sxs-lookup"><span data-stu-id="692a7-179">Each constructor parameter must be given as the type expected by that signature, and in the proper order expected by that signature.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="692a7-180">Обработчик XAML должен вызвать конструктор, который соответствует количеству аргументов числа пар.</span><span class="sxs-lookup"><span data-stu-id="692a7-180">A XAML processor must call the constructor that matches the argument count of the number of pairs.</span></span> <span data-ttu-id="692a7-181">По этой причине при реализации пользовательского расширения разметки не следует предоставлять несколько конструкторов с одинаковым числом аргументов.</span><span class="sxs-lookup"><span data-stu-id="692a7-181">For this reason, if you are implementing a custom markup extension, do not provide multiple constructors with the same argument count.</span></span> <span data-ttu-id="692a7-182">Поведение для обработчика XAML при наличии нескольких путей конструктора расширения разметки с одинаковым количеством параметров не определено, но следует помнить, что обработчику XAML разрешено создавать исключение для использования при возникновении такой ситуации в определениях типов расширения разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-182">The behavior for how a XAML processor behaves if more than one markup extension constructor path with the same parameter count exists is not defined, but you should anticipate that a XAML processor is permitted to throw an exception on usage if this situation exists in the markup extension type definitions.</span></span>  
  
- <span data-ttu-id="692a7-183">Если отдельные разделенные маркеры содержат знаки равенства, то обработчик XAML сначала вызывает конструктор без параметров для расширения разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-183">If the individual separated tokens contain equals signs, then a XAML processor first calls the parameterless constructor for the markup extension.</span></span> <span data-ttu-id="692a7-184">Затем каждая пара «имя = значение» интерпретируется как имя свойства, которое существует в расширении разметки, и значение для присвоения этому свойству.</span><span class="sxs-lookup"><span data-stu-id="692a7-184">Then, each name=value pair is interpreted as a property name that exists on the markup extension, and a value to assign to that property.</span></span>  
  
- <span data-ttu-id="692a7-185">Если имеется параллельный результат между поведением конструктора и поведением установки свойства в расширении разметки, не имеет значения, какое поведение использовать.</span><span class="sxs-lookup"><span data-stu-id="692a7-185">If there is a parallel result between the constructor behavior and the property setting behavior in a markup extension, it does not matter which behavior you use.</span></span> <span data-ttu-id="692a7-186">Чаще всего пары *свойство*`=`*значение* используются для расширений разметки, которые имеют несколько устанавливаемых свойств, поскольку это делает разметку более продуманной и уменьшает вероятность случайно перепутать параметры конструктора.</span><span class="sxs-lookup"><span data-stu-id="692a7-186">It is more common usage to use the *property*`=`*value* pairs for markup extensions that have more than one settable property, if only because it makes your markup more intentional and you are less likely to accidentally transpose constructor parameters.</span></span> <span data-ttu-id="692a7-187">(При указании пар свойство = значение эти свойства могут быть в любом порядке.) Кроме того, нет никакой гарантии, что расширение разметки предоставляет параметр конструктора, который задает каждое из его устанавливаемых свойств.</span><span class="sxs-lookup"><span data-stu-id="692a7-187">(When you specify property=value pairs, those properties may be in any order.) Also, there is no guarantee that a markup extension supplies a constructor parameter that sets every one of its settable properties.</span></span> <span data-ttu-id="692a7-188">Например, <xref:System.Windows.Data.Binding> является расширением разметки, со множеством свойств, устанавливаемых с помощью расширения в форме *свойства*`=`*значение* , но <xref:System.Windows.Data.Binding> поддерживает только два конструктора: конструктор без параметров и один, который задает Начальный путь.</span><span class="sxs-lookup"><span data-stu-id="692a7-188">For example, <xref:System.Windows.Data.Binding> is a markup extension, with many properties that are settable through the extension in *property*`=`*value* form, but <xref:System.Windows.Data.Binding> only supports two constructors: a parameterless constructor, and one that sets an initial path.</span></span>  
  
- <span data-ttu-id="692a7-189">Литерал запятой нельзя передать в расширение разметки без escape-последовательности.</span><span class="sxs-lookup"><span data-stu-id="692a7-189">A literal comma cannot be passed to a markup extension without escapement.</span></span>  
  
<a name="EscapeSequences"></a>   
## <a name="escape-sequences-and-markup-extensions"></a><span data-ttu-id="692a7-190">Escape-последовательности и расширения разметки</span><span class="sxs-lookup"><span data-stu-id="692a7-190">Escape Sequences and Markup Extensions</span></span>  
 <span data-ttu-id="692a7-191">При обработке атрибутов в обработчик XAML фигурные скобки расцениваются как указание на последовательность расширения разметки.</span><span class="sxs-lookup"><span data-stu-id="692a7-191">Attribute handling in a XAML processor uses the curly braces as indicators of a markup extension sequence.</span></span> <span data-ttu-id="692a7-192">При необходимости можно также получить литеральный символ фигурной скобки, введя escape-последовательность с помощью пары пустых фигурных скобок, за которыми следует литерал фигурной скобки.</span><span class="sxs-lookup"><span data-stu-id="692a7-192">It is also possible to produce a literal curly brace character attribute value if necessary, by entering an escape sequence using an empty curly brace pair followed by the literal curly brace.</span></span> <span data-ttu-id="692a7-193">См. раздел [{} escape-последовательности — расширение разметки](../../xaml-services/escape-sequence-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="692a7-193">See [{} Escape Sequence - Markup Extension](../../xaml-services/escape-sequence-markup-extension.md).</span></span>  
  
<a name="Nesting"></a>   
## <a name="nesting-markup-extensions-in-xaml-usage"></a><span data-ttu-id="692a7-194">Вложенные расширения разметки при использовании XAML</span><span class="sxs-lookup"><span data-stu-id="692a7-194">Nesting Markup Extensions in XAML Usage</span></span>  
 <span data-ttu-id="692a7-195">Поддерживается вложение нескольких расширений разметки, и каждое расширение разметки будет вычисляться последовательно, начиная с самого глубокого.</span><span class="sxs-lookup"><span data-stu-id="692a7-195">Nesting of multiple markup extensions is supported, and each markup extension will be evaluated deepest first.</span></span> <span data-ttu-id="692a7-196">Рассмотрим следующий пример.</span><span class="sxs-lookup"><span data-stu-id="692a7-196">For example, consider the following usage:</span></span>  
  
```xaml  
<Setter Property="Background"  
  Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />  
```  
  
 <span data-ttu-id="692a7-197">При таком использовании инструкция `x:Static` оценивается первой и возвращает строку.</span><span class="sxs-lookup"><span data-stu-id="692a7-197">In this usage, the `x:Static` statement is evaluated first and returns a string.</span></span> <span data-ttu-id="692a7-198">Затем эта строка используется в качестве аргумента для `DynamicResource`.</span><span class="sxs-lookup"><span data-stu-id="692a7-198">That string is then used as the argument for `DynamicResource`.</span></span>  
  
## <a name="markup-extensions-and-property-element-syntax"></a><span data-ttu-id="692a7-199">Расширения разметки и синтаксис элементов свойств</span><span class="sxs-lookup"><span data-stu-id="692a7-199">Markup Extensions and Property Element Syntax</span></span>  
 <span data-ttu-id="692a7-200">При использовании в качестве объектного элемента, заполняющего значение элемента свойства, класс расширения разметки визуально неотличим от обычного объектного элемента с поддержкой типа, который может использоваться в XAML.</span><span class="sxs-lookup"><span data-stu-id="692a7-200">When used as an object element that fills a property element value, a markup extension class is visually indistinguishable from a typical type-backed object element that can be used in XAML.</span></span> <span data-ttu-id="692a7-201">Практическое различие между обычным объектным элементом и расширением разметки заключается в том, что расширение разметки либо вычисляется в типизированное значение, либо откладывается как выражение.</span><span class="sxs-lookup"><span data-stu-id="692a7-201">The practical difference between a typical object element and a markup extension is that the markup extension is either evaluated to a typed value or deferred as an expression.</span></span> <span data-ttu-id="692a7-202">Поэтому механизмы для каких-либо возможных ошибок типов значений свойств для расширения разметки будут отличаться, аналогично тому, как свойство с поздним связыванием обрабатывается в других моделях программирования.</span><span class="sxs-lookup"><span data-stu-id="692a7-202">Therefore the mechanisms for any possible type errors of property values for the markup extension will be different, similar to how a late-bound property is treated in other programming models.</span></span> <span data-ttu-id="692a7-203">Обычный объектный элемент будет вычисляться на соответствие типа целевому свойству, устанавливаемому при анализе XAML.</span><span class="sxs-lookup"><span data-stu-id="692a7-203">An ordinary object element will be evaluated for type match against the target property it is setting when the XAML is parsed.</span></span>  
  
 <span data-ttu-id="692a7-204">Большинство расширений разметки, если они используются в синтаксисе объектных элементов для заполнения элемента свойства, не имеют содержимого или какого-либо другого синтаксиса элементов свойств внутри.</span><span class="sxs-lookup"><span data-stu-id="692a7-204">Most markup extensions, when used in object element syntax to fill a property element, would not have content or any further property element syntax within.</span></span> <span data-ttu-id="692a7-205">Таким образом, будет закрыт тег объектного элемента и не будут предоставлены дочерние элементы.</span><span class="sxs-lookup"><span data-stu-id="692a7-205">Thus you would close the object element tag, and provide no child elements.</span></span> <span data-ttu-id="692a7-206">Всякий раз, когда обработчик XAML обнаруживает объектный элемент, вызывается конструктор для этого класса, который создает экземпляр объекта, созданного из проанализированного элемента.</span><span class="sxs-lookup"><span data-stu-id="692a7-206">Whenever any object element is encountered by a XAML processor, the constructor for that class is called, which instantiates the object created from the parsed element.</span></span> <span data-ttu-id="692a7-207">Класс расширения разметки не отличается: Если вы хотите, чтобы расширение разметки можно было использовать в синтаксисе объектного элемента, необходимо предоставить конструктор без параметров.</span><span class="sxs-lookup"><span data-stu-id="692a7-207">A markup extension class is no different: if you want your markup extension to be usable in object element syntax, you must provide a parameterless constructor.</span></span> <span data-ttu-id="692a7-208">Некоторые существующие расширения разметки имеют по крайней мере одно обязательное значение свойства, которое должно быть указано для эффективной инициализации.</span><span class="sxs-lookup"><span data-stu-id="692a7-208">Some existing markup extensions have at least one required property value that must be specified for effective initialization.</span></span> <span data-ttu-id="692a7-209">В таком случае это значение свойства обычно передается в объектный элемент объекта качестве атрибута свойства.</span><span class="sxs-lookup"><span data-stu-id="692a7-209">If so, that property value is typically given as a property attribute on the object element.</span></span> <span data-ttu-id="692a7-210">В справочных страницах [Возможности пространства имен языка XAML (x:)](../../xaml-services/xaml-namespace-x-language-features.md) и [Расширения XAML WPF](wpf-xaml-extensions.md) будут отмечены расширения разметки, которые имеют обязательные свойства (и имена обязательных свойств).</span><span class="sxs-lookup"><span data-stu-id="692a7-210">In the [XAML Namespace (x:) Language Features](../../xaml-services/xaml-namespace-x-language-features.md) and [WPF XAML Extensions](wpf-xaml-extensions.md) reference pages, markup extensions that have required properties (and the names of required properties) will be noted.</span></span> <span data-ttu-id="692a7-211">В справочных страницах также будут отмечено, если для определенных расширений разметки запрещен синтаксис атрибутов или синтаксис объектных элементов.</span><span class="sxs-lookup"><span data-stu-id="692a7-211">Reference pages will also note if either object element syntax or attribute syntax is disallowed for particular markup extensions.</span></span> <span data-ttu-id="692a7-212">Важным случаем является [расширение разметки x:Array](../../xaml-services/x-array-markup-extension.md), которое не поддерживает синтаксис атрибутов, так как содержимое этого массива должно быть указано в тегах как содержимое.</span><span class="sxs-lookup"><span data-stu-id="692a7-212">A notable case is [x:Array Markup Extension](../../xaml-services/x-array-markup-extension.md), which cannot support attribute syntax because the contents of that array must be specified within the tagging as content.</span></span> <span data-ttu-id="692a7-213">Содержимое массива обрабатывается как общие объекты, поэтому нецелесообразно применение для атрибута преобразователей типа по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="692a7-213">The array contents are handled as general objects, therefore no default type converter for the attribute is feasible.</span></span> <span data-ttu-id="692a7-214">Кроме того, [расширение разметки x:Array](../../xaml-services/x-array-markup-extension.md) требует параметр `type`.</span><span class="sxs-lookup"><span data-stu-id="692a7-214">Also, [x:Array Markup Extension](../../xaml-services/x-array-markup-extension.md) requires a `type` parameter.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="692a7-215">См. также</span><span class="sxs-lookup"><span data-stu-id="692a7-215">See also</span></span>

- [<span data-ttu-id="692a7-216">Общие сведения о языке XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="692a7-216">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
- [<span data-ttu-id="692a7-217">Возможности пространства имен языка XAML (x:)</span><span class="sxs-lookup"><span data-stu-id="692a7-217">XAML Namespace (x:) Language Features</span></span>](../../xaml-services/xaml-namespace-x-language-features.md)
- [<span data-ttu-id="692a7-218">Расширения XAML WPF</span><span class="sxs-lookup"><span data-stu-id="692a7-218">WPF XAML Extensions</span></span>](wpf-xaml-extensions.md)
- [<span data-ttu-id="692a7-219">Расширение разметки StaticResource</span><span class="sxs-lookup"><span data-stu-id="692a7-219">StaticResource Markup Extension</span></span>](staticresource-markup-extension.md)
- [<span data-ttu-id="692a7-220">Привязка расширения разметки</span><span class="sxs-lookup"><span data-stu-id="692a7-220">Binding Markup Extension</span></span>](binding-markup-extension.md)
- [<span data-ttu-id="692a7-221">Расширение разметки DynamicResource</span><span class="sxs-lookup"><span data-stu-id="692a7-221">DynamicResource Markup Extension</span></span>](dynamicresource-markup-extension.md)
- [<span data-ttu-id="692a7-222">Расширение разметки x:Type</span><span class="sxs-lookup"><span data-stu-id="692a7-222">x:Type Markup Extension</span></span>](../../xaml-services/x-type-markup-extension.md)
