---
title: Инициализация для элементов типа Object вне дерева объектов
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- logical tree [WPF]
- visual tree [WPF]
- elements [WPF], initializing
- initializing elements [WPF]
ms.assetid: 7b8dfc9b-46ac-4ce8-b7bb-035734d688b7
ms.openlocfilehash: 4f8ee4b31c135595770338831c23d8a0f419e8cd
ms.sourcegitcommit: 83ecdf731dc1920bca31f017b1556c917aafd7a0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/12/2019
ms.locfileid: "67857013"
---
# <a name="initialization-for-object-elements-not-in-an-object-tree"></a><span data-ttu-id="fddb7-102">Инициализация для элементов типа Object вне дерева объектов</span><span class="sxs-lookup"><span data-stu-id="fddb7-102">Initialization for Object Elements Not in an Object Tree</span></span>
<span data-ttu-id="fddb7-103">За некоторые аспекты инициализации [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] отвечают процессы, которые обычно предполагают, что элемент подключен либо к логическому, либо к визуальному дереву.</span><span class="sxs-lookup"><span data-stu-id="fddb7-103">Some aspects of [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] initialization are deferred to processes that typically rely on that element being connected to either the logical tree or visual tree.</span></span> <span data-ttu-id="fddb7-104">В этом разделе описываются действия, необходимые для инициализации элемента, который не подключен ни к одному из деревьев.</span><span class="sxs-lookup"><span data-stu-id="fddb7-104">This topic describes the steps that may be necessary in order to initialize an element that is not connected to either tree.</span></span>  

## <a name="elements-and-the-logical-tree"></a><span data-ttu-id="fddb7-105">Элементы и логическое дерево</span><span class="sxs-lookup"><span data-stu-id="fddb7-105">Elements and the Logical Tree</span></span>  
 <span data-ttu-id="fddb7-106">При создании экземпляра класса [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] в коде следует иметь в виду, что несколько аспектов инициализации объекта для класса [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] преднамеренно не являются частью кода, выполняющегося при вызове конструктора класса.</span><span class="sxs-lookup"><span data-stu-id="fddb7-106">When you create an instance of a [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] class in code, you should be aware that several aspects of object initialization for a [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] class are deliberately not a part of the code that is executed when calling the class constructor.</span></span> <span data-ttu-id="fddb7-107">Большая часть визуального представления элемента управления, особенно для класса элемента управления, не определяется конструктором.</span><span class="sxs-lookup"><span data-stu-id="fddb7-107">Particularly for a control class, most of the visual representation of that control is not defined by the constructor.</span></span> <span data-ttu-id="fddb7-108">Вместо этого визуальное представление определяется шаблоном элемента управления.</span><span class="sxs-lookup"><span data-stu-id="fddb7-108">Instead, the visual representation is defined by the control's template.</span></span> <span data-ttu-id="fddb7-109">Шаблон может быть получен из различных источников, но наиболее часто он берется из стилей темы.</span><span class="sxs-lookup"><span data-stu-id="fddb7-109">The template potentially comes from a variety of sources, but most often the template is obtained from theme styles.</span></span> <span data-ttu-id="fddb7-110">Шаблоны фактически выполняют позднее связывание. Необходимый шаблон не присоединяется к элементу управления до тех пор, пока элемент управления не будет подготовлен для макета.</span><span class="sxs-lookup"><span data-stu-id="fddb7-110">Templates are effectively late-binding; the necessary template is not attached to the control in question until the control is ready for layout.</span></span> <span data-ttu-id="fddb7-111">А элемент управления не готов для макета до тех пор, пока он не будет присоединен к логическому дереву, которое подключается к отрисовываемой поверхности в корневом элементе.</span><span class="sxs-lookup"><span data-stu-id="fddb7-111">And the control is not ready for layout until it is attached to a logical tree that connects to a rendering surface at the root.</span></span> <span data-ttu-id="fddb7-112">Именно элемент корневого уровня инициирует отрисовку всех дочерних элементов, как определено в логическом дереве.</span><span class="sxs-lookup"><span data-stu-id="fddb7-112">It is that root-level element that initiates the rendering of all of its child elements as defined in the logical tree.</span></span>  
  
 <span data-ttu-id="fddb7-113">Визуальное дерево также участвует в этом процессе.</span><span class="sxs-lookup"><span data-stu-id="fddb7-113">The visual tree also participates in this process.</span></span> <span data-ttu-id="fddb7-114">Элементы, которые являются частью визуального дерева посредством шаблонов, также полностью не создаются до тех пор, пока не произойдет подключение.</span><span class="sxs-lookup"><span data-stu-id="fddb7-114">Elements that are part of the visual tree through the templates are also not fully instantiated until connected.</span></span>  
  
 <span data-ttu-id="fddb7-115">Последствием этого является то, что для определенных операций, зависящих от завершенных визуальных характеристик элемента, требуется выполнение дополнительных действий.</span><span class="sxs-lookup"><span data-stu-id="fddb7-115">The consequences of this behavior are that certain operations that rely on the completed visual characteristics of an element require additional steps.</span></span> <span data-ttu-id="fddb7-116">Примером является попытка получить визуальные характеристики класса, который был создан, но еще не присоединен к дереву.</span><span class="sxs-lookup"><span data-stu-id="fddb7-116">An example is if you are attempting to get the visual characteristics of a class that was constructed but not yet attached to a tree.</span></span> <span data-ttu-id="fddb7-117">Например если вы хотите вызвать <xref:System.Windows.Media.Imaging.RenderTargetBitmap.Render%2A> на <xref:System.Windows.Media.Imaging.RenderTargetBitmap> и визуальный элемент не подключен к дереву, этот элемент не визуально завершена, пока не будут выполнены дополнительные действия по инициализации.</span><span class="sxs-lookup"><span data-stu-id="fddb7-117">For instance, if you want to call <xref:System.Windows.Media.Imaging.RenderTargetBitmap.Render%2A> on a <xref:System.Windows.Media.Imaging.RenderTargetBitmap> and the visual you are passing is an element not connected to a tree, that element is not visually complete until additional initialization steps are completed.</span></span>  
  
### <a name="using-begininit-and-endinit-to-initialize-the-element"></a><span data-ttu-id="fddb7-118">Использование BeginInit и EndInit для инициализации элемента</span><span class="sxs-lookup"><span data-stu-id="fddb7-118">Using BeginInit and EndInit to Initialize the Element</span></span>  
 <span data-ttu-id="fddb7-119">Различные классы в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] реализовать <xref:System.ComponentModel.ISupportInitialize> интерфейс.</span><span class="sxs-lookup"><span data-stu-id="fddb7-119">Various classes in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implement the <xref:System.ComponentModel.ISupportInitialize> interface.</span></span> <span data-ttu-id="fddb7-120">Использовании <xref:System.ComponentModel.ISupportInitialize.BeginInit%2A> и <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> методы интерфейса для обозначения области кода, содержащей действия для инициализации (такие как установка значений свойств, влияющих на отрисовку).</span><span class="sxs-lookup"><span data-stu-id="fddb7-120">You use the <xref:System.ComponentModel.ISupportInitialize.BeginInit%2A> and <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> methods of the interface to denote a region in your code that contains initialization steps (such as setting property values that affect rendering).</span></span> <span data-ttu-id="fddb7-121">После <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> вызывается в последовательности система макета может обработать элемент и начать поиск неявного стиля.</span><span class="sxs-lookup"><span data-stu-id="fddb7-121">After <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> is called in the sequence, the layout system can process the element and start looking for an implicit style.</span></span>  
  
 <span data-ttu-id="fddb7-122">Если элемент при установке свойств на <xref:System.Windows.FrameworkElement> или <xref:System.Windows.FrameworkContentElement> производного класса, то можно вызвать версии класса <xref:System.Windows.FrameworkElement.BeginInit%2A> и <xref:System.Windows.FrameworkElement.EndInit%2A> вместо приведения к <xref:System.ComponentModel.ISupportInitialize>.</span><span class="sxs-lookup"><span data-stu-id="fddb7-122">If the element you are setting properties on is a <xref:System.Windows.FrameworkElement> or <xref:System.Windows.FrameworkContentElement> derived class, then you can call the class versions of <xref:System.Windows.FrameworkElement.BeginInit%2A> and <xref:System.Windows.FrameworkElement.EndInit%2A> rather than casting to <xref:System.ComponentModel.ISupportInitialize>.</span></span>  
  
### <a name="sample-code"></a><span data-ttu-id="fddb7-123">Пример кода</span><span class="sxs-lookup"><span data-stu-id="fddb7-123">Sample Code</span></span>  
 <span data-ttu-id="fddb7-124">Ниже приведен пример кода для консольного приложения, использующего отрисовки API-интерфейсы и <xref:System.Windows.Markup.XamlReader.Load%28System.IO.Stream%29?displayProperty=nameWithType> свободного [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] файл для иллюстрации правильного размещения <xref:System.Windows.FrameworkElement.BeginInit%2A> и <xref:System.Windows.FrameworkElement.EndInit%2A> вокруг остальные вызовы API, измените его свойства, влияют на отрисовку.</span><span class="sxs-lookup"><span data-stu-id="fddb7-124">The following example is sample code for a console application that uses rendering APIs and <xref:System.Windows.Markup.XamlReader.Load%28System.IO.Stream%29?displayProperty=nameWithType> of a loose [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file to illustrate the proper placement of <xref:System.Windows.FrameworkElement.BeginInit%2A> and <xref:System.Windows.FrameworkElement.EndInit%2A> around other API calls that adjust properties that affect rendering.</span></span>  
  
 <span data-ttu-id="fddb7-125">В этом примере иллюстрируется только основная функция.</span><span class="sxs-lookup"><span data-stu-id="fddb7-125">The example illustrates the main function only.</span></span> <span data-ttu-id="fddb7-126">Функции `Rasterize` и `Save` (не показаны) являются служебными функциями, которые отвечают за обработку изображения и ввод-вывод.</span><span class="sxs-lookup"><span data-stu-id="fddb7-126">The functions `Rasterize` and `Save` (not shown) are utility functions that take care of image processing and IO.</span></span>  
  
 [!code-csharp[InitializeElements#Main](~/samples/snippets/csharp/VS_Snippets_Wpf/InitializeElements/CSharp/initializeelements.cs#main)]
 [!code-vb[InitializeElements#Main](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InitializeElements/VisualBasic/initializeelements.vb#main)]  
  
## <a name="see-also"></a><span data-ttu-id="fddb7-127">См. также</span><span class="sxs-lookup"><span data-stu-id="fddb7-127">See also</span></span>

- [<span data-ttu-id="fddb7-128">Деревья в WPF</span><span class="sxs-lookup"><span data-stu-id="fddb7-128">Trees in WPF</span></span>](trees-in-wpf.md)
- [<span data-ttu-id="fddb7-129">Общие сведения об отрисовке графики в WPF</span><span class="sxs-lookup"><span data-stu-id="fddb7-129">WPF Graphics Rendering Overview</span></span>](../graphics-multimedia/wpf-graphics-rendering-overview.md)
- [<span data-ttu-id="fddb7-130">Общие сведения о языке XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="fddb7-130">XAML Overview (WPF)</span></span>](xaml-overview-wpf.md)
