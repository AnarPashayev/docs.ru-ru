---
title: Обработку событий в Visual Basic
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 959ef66f41f6c5f06e18a202109fba058c522d1d
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76735411"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="889a1-102">Обработка событий в Visual Basic и WPF</span><span class="sxs-lookup"><span data-stu-id="889a1-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="889a1-103">В частности, для языка Microsoft Visual Basic .NET можно использовать ключевое слово `Handles` для конкретного языка, чтобы связать обработчики событий с экземплярами, а не присоединять обработчики событий с атрибутами или использовать метод <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="889a1-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="889a1-104">Однако метод присоединения обработчиков к экземплярам `Handles` имеет некоторые ограничения, так как синтаксис `Handles` не поддерживает некоторые возможности перенаправленных событий системы событий [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="889a1-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="889a1-105">Использование ключевого слова Handles в приложениях WPF</span><span class="sxs-lookup"><span data-stu-id="889a1-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="889a1-106">Все обработчики событий, которые подключены к экземплярам и событиям с помощью `Handles`, должны быть определены внутри объявления частичного класса экземпляра, который также является требованием для обработчиков событий, назначенных с помощью значений атрибутов в элементах.</span><span class="sxs-lookup"><span data-stu-id="889a1-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="889a1-107">Можно указать только `Handles` для элемента на странице со значением свойства <xref:System.Windows.FrameworkContentElement.Name%2A> (или объявленной [директивой x:Name](../../../desktop-wpf/xaml-services/xname-directive.md) ).</span><span class="sxs-lookup"><span data-stu-id="889a1-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="889a1-108">Это происходит потому, что <xref:System.Windows.FrameworkContentElement.Name%2A> в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] создает ссылку на экземпляр, необходимую для поддержки формата ссылки на *экземпляр. Event* , который требуется для синтаксиса `Handles`.</span><span class="sxs-lookup"><span data-stu-id="889a1-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="889a1-109">Единственный элемент, который можно использовать для `Handles` без ссылки на <xref:System.Windows.FrameworkContentElement.Name%2A>, — это экземпляр корневого элемента, определяющий разделяемый класс.</span><span class="sxs-lookup"><span data-stu-id="889a1-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="889a1-110">Можно назначить один и тот же обработчик для нескольких элементов, разделяя запятыми ссылки *Instance.Event* после `Handles`.</span><span class="sxs-lookup"><span data-stu-id="889a1-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="889a1-111">Можно использовать `Handles` для назначения более одного обработчика для той же ссылки *Instance.Event*.</span><span class="sxs-lookup"><span data-stu-id="889a1-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="889a1-112">Не следует придавать значения порядку, в котором приведены обработчики в ссылке `Handles`; предполагается, что обработчики, обрабатывающие одно и тоже событие, могут вызываться в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="889a1-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="889a1-113">Чтобы удалить обработчик, который был добавлен с помощью `Handles` в объявлении, можно вызвать <xref:System.Windows.UIElement.RemoveHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="889a1-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="889a1-114">Можно использовать `Handles` для присоединения обработчиков для перенаправленных событий до тех пор, пока обработчики присоединяются к экземплярам, которые определяют обрабатываемое в таблицах элементов событие.</span><span class="sxs-lookup"><span data-stu-id="889a1-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="889a1-115">Для перенаправленных событий обработчики, присоединенные к `Handles`, следуют тем же правилам маршрутизации, что и обработчики, присоединенные как [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] атрибуты, или с общей сигнатурой <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="889a1-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="889a1-116">Это означает, что если событие уже помечено как обработанное (свойство <xref:System.Windows.RoutedEventArgs.Handled%2A> в данных события имеет `True`), обработчики, подключенные к `Handles`, не вызываются в ответ на этот экземпляр события.</span><span class="sxs-lookup"><span data-stu-id="889a1-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="889a1-117">Событие не может быть помечено как обрабатываемое обработчиками экземпляров из другого элемента маршрута или обработкой класса либо из текущего элемента, либо из более ранних элементов маршрута.</span><span class="sxs-lookup"><span data-stu-id="889a1-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="889a1-118">Для событий ввода, которые поддерживают события восходящей и нисходящей маршрутизации, нисходящая маршрутизация может пометить пару событий как обрабатываемую.</span><span class="sxs-lookup"><span data-stu-id="889a1-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="889a1-119">Дополнительные сведения о перенаправленных событиях см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="889a1-119">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="889a1-120">Ограничения ключевого слова Handles при добавлении обработчиков</span><span class="sxs-lookup"><span data-stu-id="889a1-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="889a1-121">Ключевое слово `Handles` не может ссылаться на обработчики для присоединенных событий.</span><span class="sxs-lookup"><span data-stu-id="889a1-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="889a1-122">Необходимо использовать метод доступа `add` для присоединенных событий или атрибуты события *typename.eventname* в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="889a1-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="889a1-123">Дополнительные сведения см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="889a1-123">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="889a1-124">Для перенаправленных событий можно использовать `Handles` только для назначения обработчиков экземплярам, в которых это событие существует в таблице элементов экземпляра.</span><span class="sxs-lookup"><span data-stu-id="889a1-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="889a1-125">Однако в общем случае маршрутизации событий, родительский элемент может быть слушателем события от дочерних элементов, даже если этого события нет в таблице элементов родительского элемента.</span><span class="sxs-lookup"><span data-stu-id="889a1-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="889a1-126">В синтаксисе атрибута это можно указать через форму атрибута *typename.membername*, которая определяет, какой тип фактически определяет обрабатываемое событие.</span><span class="sxs-lookup"><span data-stu-id="889a1-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="889a1-127">Например, родительский `Page` (без определенного `Click` события) может прослушивать события нажатия кнопки, назначив обработчик атрибута в форме `Button.Click`.</span><span class="sxs-lookup"><span data-stu-id="889a1-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="889a1-128">Но `Handles` не поддерживает форму *typename.membername*, так как он должен поддерживать конфликтующую форму *Instance.Event*.</span><span class="sxs-lookup"><span data-stu-id="889a1-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="889a1-129">Дополнительные сведения см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="889a1-129">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="889a1-130">`Handles` не может присоединить обработчики, вызывающиеся для событий, которые уже отмечены как обрабатываемые.</span><span class="sxs-lookup"><span data-stu-id="889a1-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="889a1-131">Вместо этого необходимо использовать код и вызвать перегрузку `handledEventsToo` <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="889a1-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="889a1-132">Не используйте синтаксис `Handles` в Visual Basicном коде при указании обработчика событий для того же события в XAML.</span><span class="sxs-lookup"><span data-stu-id="889a1-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="889a1-133">В таком случае обработчик событий вызывается дважды.</span><span class="sxs-lookup"><span data-stu-id="889a1-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="889a1-134">Как в WPF реализуются функциональные возможности ключевого слова Handles</span><span class="sxs-lookup"><span data-stu-id="889a1-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="889a1-135">При компиляции страницы [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] промежуточный файл объявляет ссылки `Friend` `WithEvents` на каждый элемент на странице, где имеется набор свойств <xref:System.Windows.FrameworkContentElement.Name%2A> (или объявленная [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md)).</span><span class="sxs-lookup"><span data-stu-id="889a1-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="889a1-136">Каждый именованный экземпляр является потенциальным элементом, который можно присвоить обработчику с помощью `Handles`.</span><span class="sxs-lookup"><span data-stu-id="889a1-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="889a1-137">В Visual Studio технология IntelliSense может показывать завершение для тех элементов, которые доступны для ссылки на `Handles` на странице.</span><span class="sxs-lookup"><span data-stu-id="889a1-137">Within Visual Studio, IntelliSense can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="889a1-138">Но для того чтобы промежуточный файл смог заполнить все ссылки `Friends`, может потребоваться один проход компиляции.</span><span class="sxs-lookup"><span data-stu-id="889a1-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="889a1-139">См. также:</span><span class="sxs-lookup"><span data-stu-id="889a1-139">See also</span></span>

- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="889a1-140">Маркировка перенаправленных событий как обработанных и обработка классов</span><span class="sxs-lookup"><span data-stu-id="889a1-140">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="889a1-141">Общие сведения о перенаправленных событиях</span><span class="sxs-lookup"><span data-stu-id="889a1-141">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="889a1-142">Общие сведения о языке XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="889a1-142">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
