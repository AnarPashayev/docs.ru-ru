---
title: Обработка событий в Visual Basic и WPF
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 5625b63f2a2162f8f188476bfd61bde4c717f1dd
ms.sourcegitcommit: f8c36054eab877de4d40a705aacafa2552ce70e9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/31/2019
ms.locfileid: "75559863"
---
# <a name="visual-basic-and-wpf-event-handling"></a>Обработка событий в Visual Basic и WPF
В частности, для языка Microsoft Visual Basic .NET можно использовать ключевое слово `Handles` для конкретного языка, чтобы связать обработчики событий с экземплярами, а не присоединять обработчики событий с атрибутами или использовать метод <xref:System.Windows.UIElement.AddHandler%2A>. Однако метод присоединения обработчиков к экземплярам `Handles` имеет некоторые ограничения, так как синтаксис `Handles` не поддерживает некоторые возможности перенаправленных событий системы событий [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
## <a name="using-handles-in-a-wpf-application"></a>Использование ключевого слова Handles в приложениях WPF  
 Все обработчики событий, которые подключены к экземплярам и событиям с помощью `Handles`, должны быть определены внутри объявления частичного класса экземпляра, который также является требованием для обработчиков событий, назначенных с помощью значений атрибутов в элементах. Можно указать только `Handles` для элемента на странице со значением свойства <xref:System.Windows.FrameworkContentElement.Name%2A> (или объявленной [директивой x:Name](../../../desktop-wpf/xaml-services/xname-directive.md) ). Это происходит потому, что <xref:System.Windows.FrameworkContentElement.Name%2A> в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] создает ссылку на экземпляр, необходимую для поддержки формата ссылки на *экземпляр. Event* , который требуется для синтаксиса `Handles`. Единственный элемент, который можно использовать для `Handles` без ссылки на <xref:System.Windows.FrameworkContentElement.Name%2A>, — это экземпляр корневого элемента, определяющий разделяемый класс.  
  
 Можно назначить один и тот же обработчик для нескольких элементов, разделяя запятыми ссылки *Instance.Event* после `Handles`.  
  
 Можно использовать `Handles` для назначения более одного обработчика для той же ссылки *Instance.Event*. Не следует придавать значения порядку, в котором приведены обработчики в ссылке `Handles`; предполагается, что обработчики, обрабатывающие одно и тоже событие, могут вызываться в любом порядке.  
  
 Чтобы удалить обработчик, который был добавлен с помощью `Handles` в объявлении, можно вызвать <xref:System.Windows.UIElement.RemoveHandler%2A>.  
  
 Можно использовать `Handles` для присоединения обработчиков для перенаправленных событий до тех пор, пока обработчики присоединяются к экземплярам, которые определяют обрабатываемое в таблицах элементов событие. Для перенаправленных событий обработчики, присоединенные к `Handles`, следуют тем же правилам маршрутизации, что и обработчики, присоединенные как [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] атрибуты, или с общей сигнатурой <xref:System.Windows.UIElement.AddHandler%2A>. Это означает, что если событие уже помечено как обработанное (свойство <xref:System.Windows.RoutedEventArgs.Handled%2A> в данных события имеет `True`), обработчики, подключенные к `Handles`, не вызываются в ответ на этот экземпляр события. Событие не может быть помечено как обрабатываемое обработчиками экземпляров из другого элемента маршрута или обработкой класса либо из текущего элемента, либо из более ранних элементов маршрута. Для событий ввода, которые поддерживают события восходящей и нисходящей маршрутизации, нисходящая маршрутизация может пометить пару событий как обрабатываемую. Дополнительные сведения о перенаправленных событиях см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).  
  
## <a name="limitations-of-handles-for-adding-handlers"></a>Ограничения ключевого слова Handles при добавлении обработчиков  
 Ключевое слово `Handles` не может ссылаться на обработчики для присоединенных событий. Необходимо использовать метод доступа `add` для присоединенных событий или атрибуты события *typename.eventname* в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]. Дополнительные сведения см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).  
  
 Для перенаправленных событий можно использовать `Handles` только для назначения обработчиков экземплярам, в которых это событие существует в таблице элементов экземпляра. Однако в общем случае маршрутизации событий, родительский элемент может быть слушателем события от дочерних элементов, даже если этого события нет в таблице элементов родительского элемента. В синтаксисе атрибута это можно указать через форму атрибута *typename.membername*, которая определяет, какой тип фактически определяет обрабатываемое событие. Например, родительский `Page` (без определенного `Click` события) может прослушивать события нажатия кнопки, назначив обработчик атрибута в форме `Button.Click`. Но `Handles` не поддерживает форму *typename.membername*, так как он должен поддерживать конфликтующую форму *Instance.Event*. Дополнительные сведения см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).  
  
 `Handles` не может присоединить обработчики, вызывающиеся для событий, которые уже отмечены как обрабатываемые. Вместо этого необходимо использовать код и вызвать перегрузку `handledEventsToo` <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.  
  
> [!NOTE]
> Не используйте синтаксис `Handles` в Visual Basicном коде при указании обработчика событий для того же события в XAML. В таком случае обработчик событий вызывается дважды.  
  
## <a name="how-wpf-implements-handles-functionality"></a>Как в WPF реализуются функциональные возможности ключевого слова Handles  
 При компиляции страницы [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] промежуточный файл объявляет ссылки `Friend` `WithEvents` на каждый элемент на странице, где имеется набор свойств <xref:System.Windows.FrameworkContentElement.Name%2A> (или объявленная [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md)). Каждый именованный экземпляр является потенциальным элементом, который можно присвоить обработчику с помощью `Handles`.  
  
> [!NOTE]
> В Visual Studio технология IntelliSense может показывать завершение для тех элементов, которые доступны для ссылки на `Handles` на странице. Но для того чтобы промежуточный файл смог заполнить все ссылки `Friends`, может потребоваться один проход компиляции.  
  
## <a name="see-also"></a>См. также:

- <xref:System.Windows.UIElement.AddHandler%2A>
- [Маркировка перенаправленных событий как обработанных и обработка классов](marking-routed-events-as-handled-and-class-handling.md)
- [Общие сведения о перенаправленных событиях](routed-events-overview.md)
- [Общие сведения о языке XAML (WPF)](../../../desktop-wpf/fundamentals/xaml.md)
