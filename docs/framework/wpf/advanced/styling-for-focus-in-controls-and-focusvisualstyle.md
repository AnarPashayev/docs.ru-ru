---
title: Стилизация фокуса в элементах управления и FocusVisualStyle
ms.date: 03/30/2017
helpviewer_keywords:
- keyboard focus [WPF]
- focus [WPF], visual styling
- styles [WPF], focus visual style
ms.assetid: 786ac576-011b-4d72-913b-558deccb9b35
ms.openlocfilehash: 988b084144532df6f7a6073184fcf035b0813bfd
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458675"
---
# <a name="styling-for-focus-in-controls-and-focusvisualstyle"></a>Стилизация фокуса в элементах управления и FocusVisualStyle
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] предоставляет два параллельных механизма для изменения внешнего вида элемента управления при получении фокуса клавиатуры. Первый механизм заключается в использовании методов задания свойств для таких свойств, как <xref:System.Windows.UIElement.IsKeyboardFocused%2A> в стиле или шаблоне, применяемом к элементу управления. Вторым механизмом является предоставление отдельного стиля в качестве значения свойства <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>; "визуальный стиль фокуса" создает отдельное визуальное дерево для декоративного элемента, который рисуется поверх элемента управления, вместо изменения визуального дерева элемента управления или другого элемента пользовательского интерфейса путем его замены. В данном разделе рассматриваются сценарии, для которых подходит любой из этих механизмов.  

<a name="Purpose"></a>   
## <a name="the-purpose-of-focus-visual-style"></a>Назначение визуального стиля фокуса  
 Функция визуального стиля фокуса предоставляет общую "объектную модель" для введения визуальной обратной связи с пользователем на основе навигации с помощью клавиатуры к любому элементу пользовательского интерфейса. Это можно сделать без применения нового шаблона к элементу управления или знания композиции определенного шаблона.  
  
 Но именно потому, что функция визуального стиля фокуса работает без знания шаблонов элементов управления, визуальная обратная связь, которая может отображаться для элемента управления с использованием визуального стиля фокуса, ограничена в обязательном порядке. Эта функция фактически накладывает другое визуальное дерево (декоративный элемент) поверх визуального дерева, созданного при отрисовке элемента управления с помощью его шаблона. Это отдельное визуальное дерево определяется с помощью стиля, который заполняет свойство <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>.  
  
<a name="Default"></a>   
## <a name="default-focus-visual-style-behavior"></a>Поведение визуального стиля фокуса по умолчанию  
 Визуальные стили фокуса действуют только тогда, когда действие фокусировки было инициировано клавиатурой. Любое действие мыши или программное изменение фокуса отключает режим визуальных стилей фокуса. Дополнительные сведения о различиях между режимами фокуса см. в разделе [Общие сведения о фокусе](focus-overview.md).  
  
 Темы для элементов управления включают поведение визуального стиля фокуса по умолчанию, который становится визуальным стилем фокуса для всех элементов управления в теме. Этот стиль темы определяется по значению статического ключа <xref:System.Windows.SystemParameters.FocusVisualStyleKey%2A>. При объявлении собственного визуального стиля фокуса на уровне приложения можно заменить это поведение стиля по умолчанию из темы. Кроме того, при определении целой темы необходимо использовать этот же ключ для определения стиля поведения по умолчанию для всей темы.  
  
 В темах визуальный стиль фокуса по умолчанию обычно очень прост. Ниже приводится приблизительная оценка.  
  
```xaml  
<Style x:Key="{x:Static SystemParameters.FocusVisualStyleKey}">  
  <Setter Property="Control.Template">  
    <Setter.Value>  
      <ControlTemplate>  
        <Rectangle StrokeThickness="1"  
          Stroke="Black"  
          StrokeDashArray="1 2"  
          SnapsToDevicePixels="true"/>  
      </ControlTemplate>  
    </Setter.Value>  
  </Setter>  
</Style>  
```  
  
<a name="When"></a>   
## <a name="when-to-use-focus-visual-styles"></a>Когда следует использовать визуальные стили фокуса  
 Концептуально внешний вид визуальных стилей фокуса, применяемых к элементам управления, должен быть согласованным в различных элементах. Одним из способов обеспечить такую согласованность является изменение визуального стиля фокуса только при составлении целой темы, в которой каждый элемент управления, определенный в теме, получает либо один и тот же визуальный стиль фокуса, либо некоторую вариацию стиля, визуально связанную с другими элементами управления. Кроме того, можно использовать один и тот же стиль (или аналогичные стили) для каждого элемента, фокусируемого с клавиатуры, на странице или в пользовательском интерфейсе.  
  
 Установка <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> для отдельных стилей элемента управления, которые не являются частью темы, не является предполагаемым использованием визуальных стилей фокуса. Это связано с тем, что несогласованность визуального поведения элементов управления может привести к путанице при использовании фокуса клавиатуры. Если вы планируете поведение управления для фокуса клавиатуры, которое намеренно не согласовано в теме, гораздо лучшим подходом является использование триггеров в стилях для отдельных свойств состояния ввода, таких как <xref:System.Windows.UIElement.IsFocused%2A> или <xref:System.Windows.UIElement.IsKeyboardFocused%2A>.  
  
 Визуальные стили фокуса действуют исключительно для фокуса клавиатуры. Таким образом, визуальные стили фокуса являются функцией специальных возможностей. Если требуется изменять пользовательский интерфейс для какого-либо типа фокуса с помощью мыши, клавиатуры или программными средствами, то не следует использовать визуальные стили фокуса. Вместо этого используйте методы задания и триггеры в стилях или шаблонах, которые работают на основе значения общих свойств фокуса, таких как <xref:System.Windows.UIElement.IsFocused%2A> или <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>.  
  
<a name="How"></a>   
## <a name="how-to-create-a-focus-visual-style"></a>Создание визуального стиля фокуса  
 Стиль, создаваемый для визуального стиля фокуса, всегда должен иметь <xref:System.Windows.Style.TargetType%2A> <xref:System.Windows.Controls.Control>. Стиль должен состоять в основном из <xref:System.Windows.Controls.ControlTemplate>. Целевой тип не указывается как тип, где визуальный стиль фокуса назначается <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>у.  
  
 Так как целевой тип всегда <xref:System.Windows.Controls.Control>, необходимо использовать свойства, общие для всех элементов управления (с помощью свойств класса <xref:System.Windows.Controls.Control> и его базовых классов). Необходимо создать шаблон, который будет правильно функционировать как наложение для элемента пользовательского интерфейса и не будет скрывать функциональные области элемента управления. Как правило, это означает, что визуальная обратная связь должна появляться за пределами полей управления или в качестве временных или ненавязчивых эффектов, которые не будут блокировать проверку нажатий в элементе управления, к которому применен визуальный стиль фокуса. Свойства, которые можно использовать в привязке шаблонов, которые полезны для определения размера и расположения шаблона оверлея, включают <xref:System.Windows.FrameworkElement.ActualHeight%2A>, <xref:System.Windows.FrameworkElement.ActualWidth%2A>, <xref:System.Windows.FrameworkElement.Margin%2A>и <xref:System.Windows.Controls.Control.Padding%2A>.  
  
<a name="Alternatives"></a>   
## <a name="alternatives-to-using-a-focus-visual-style"></a>Альтернативные варианты использования визуального стиля фокуса  
 В ситуациях, когда использование визуального стиля фокуса нецелесообразно (при стилизации только отдельных элементов управления или если необходим больший контроль над шаблоном элемента управления), существует множество других доступных свойств и методов, которые могут создавать визуальное поведение в ответ на изменения фокуса.  
  
 Триггеры, методы задания и методы задания событий рассматриваются подробно в разделе [Использование стилей и шаблонов](../../../desktop-wpf/fundamentals/styles-templates-overview.md). Обработка перенаправляемых событий рассматривается в разделе [Общие сведения о перенаправляемых событиях](routed-events-overview.md).  
  
### <a name="iskeyboardfocused"></a>IsKeyboardFocused  
 Если вы особо заинтересованы в фокусе клавиатуры, свойство зависимости <xref:System.Windows.UIElement.IsKeyboardFocused%2A> можно использовать для свойства <xref:System.Windows.Trigger>. Триггер свойства в стиле или шаблоне является более подходящим методом определения поведения фокуса клавиатуры, который применяется только для отдельного элемента управления и может визуально не соответствовать поведению фокуса клавиатуры других элементов управления.  
  
 Другое аналогичное свойство зависимости — <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>, которое может быть полезно использовать, если вы хотите визуально вызвать фокус клавиатуры в процессе компоновки или в функциональной области элемента управления. Например, можно поместить триггер <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> таким образом, чтобы панель, в которой группируются несколько элементов управления, отличалась по-разному, даже если фокус клавиатуры более точно находится на отдельном элементе в пределах этой панели.  
  
 Также можно использовать события <xref:System.Windows.UIElement.GotKeyboardFocus> и <xref:System.Windows.UIElement.LostKeyboardFocus> (а также их эквиваленты предварительной версии). Эти события можно использовать в качестве основания для <xref:System.Windows.EventSetter>или написать обработчики для событий в коде программной части.  
  
### <a name="other-focus-properties"></a>Другие свойства фокуса  
 Если требуется, чтобы все возможные причины изменения фокуса для создания визуального поведения, необходимо создать метод задания или триггера в <xref:System.Windows.UIElement.IsFocused%2A> свойстве зависимости или в <xref:System.Windows.UIElement.GotFocus> или <xref:System.Windows.UIElement.LostFocus> событий, используемых для <xref:System.Windows.EventSetter>.  
  
## <a name="see-also"></a>См. также

- <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>
- [Стилизация и использование шаблонов](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
- [Общие сведения о фокусе](focus-overview.md)
- [Общие сведения о входных данных](input-overview.md)
