---
title: Документы
ms.date: 03/30/2017
helpviewer_keywords:
- documents [WPF], packaging
- documents [WPF], text layout
- documents [WPF], XPS
- 'XPS documents [WPF], , '
- documents [WPF], controls
- documents [WPF], types of
- documents [WPF], browser-viewable
ms.assetid: 6e8db7bc-050a-4070-aa72-bb8c46e87ff8
ms.openlocfilehash: e88604c42b253b48ee605f42f24fe301e339f74b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79174684"
---
# <a name="documents-in-wpf"></a>Документы в WPF
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]предлагает широкий спектр функций документа, которые позволяют создавать контент высокой точности, который предназначен для более легкого доступа и чтения, чем в предыдущих поколениях Windows. В дополнение к расширенным возможностям и повышенному качеству [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] предоставляет интегрированные службы для отображения, упаковки и обеспечения безопасности документов. В этом разделе содержатся вводные сведения о типах и упаковке документов [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  

<a name="types_of_documents"></a>
## <a name="types-of-documents"></a>Типы документов  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] разделяет документы на две основные категории на основе их предполагаемого использования; эти категории документов называются "документы фиксированного формата" и "документы нефиксированного формата".  
  
 Фиксированные документы предназначены для приложений, которые требуют точного "то, что вы видите, что вы получаете" (WYSIWYG) презентации, независимо от дисплея или принтера оборудования, используемого. Документы фиксированного формата используются в компьютерной верстке, текстовой обработке и макетах форм, где строгое соответствие дизайну исходной страницы имеет критическое значение. При использовании такого макета документ фиксированного формата сохраняет точное расположение элементов содержимого независимо от используемого устройства изображения или печати. Так, страница документа фиксированного формата, отображаемая на дисплее 96 точек на дюйм, будет совершенно одинаково отображаться на лазерном принтере 600 точек на дюйм и фотонаборной машине 4800 точек на дюйм. Макет страницы остается неизменным во всех случаях, хотя качество документа повышается с учетом возможностей устройства.  
  
 Для сравнения: документы нефиксированного формата предназначены для повышения удобства просмотра и чтения; их лучше всего использовать, когда в работе с документом важнее всего удобство чтения. Вместо того чтобы использовать какой-либо определенный макет, документы нефиксированного формата динамически корректируют и перемещают содержимое с учетом переменных времени выполнения, таких как размер окна, разрешение устройства и дополнительные пользовательские настройки. Веб-страница — это простой пример документа нефиксированного формата, содержимое на которой динамически форматируется, чтобы уместиться в окне. Документы нефиксированного формата оптимизируют просмотр и чтение для пользователя в зависимости от среды выполнения. Например, один и тот же документ нефиксированного формата будет динамически переформатирован, чтобы обеспечить оптимальную читаемость на дисплее высокого разрешения 19 дюймов или небольшом экране PDA размером 2 x 3 дюйма. Кроме того, документы нефиксированного формата имеют несколько встроенных возможностей, включая поиск, режимы просмотра, оптимизирующие читаемость, и возможность менять размер и внешний вид шрифта.  См. иллюстрации, примеры и подробное описание документов нефиксированного формата в разделе [Общие сведения о документах нефиксированного формата](flow-document-overview.md).  
  
<a name="document_viewer"></a>
## <a name="document-controls-and-text-layout"></a>Элементы управления документами и макеты текста  
 Рамочный механизм .NET предоставляет набор предварительно построенных элементов управления, которые упрощают использование фиксированных документов, документов потока и общего текста в приложении.  Отображение фиксированного содержимого документа поддерживается с помощью элемента <xref:System.Windows.Controls.DocumentViewer> управления.  Отображение содержимого документа потока <xref:System.Windows.Controls.FlowDocumentReader> <xref:System.Windows.Controls.FlowDocumentPageViewer>поддерживается <xref:System.Windows.Controls.FlowDocumentScrollViewer> тремя различными элементами управления: , и какая карта для различных сценариев пользователя (см. разделы ниже).  Другие элементы управления [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] предоставляют упрощенную разметку для стандартных способов использования текста (см. раздел [Текст в пользовательском интерфейсе](#text_in_the_user_interface) ниже).  
  
### <a name="fixed-document-control---documentviewer"></a>Элемент управления документом фиксированного формата DocumentViewer  
 Элемент <xref:System.Windows.Controls.DocumentViewer> управления предназначен <xref:System.Windows.Documents.FixedDocument> для отображения содержимого. Элемент <xref:System.Windows.Controls.DocumentViewer> управления обеспечивает интуитивно понятный пользовательский интерфейс, обеспечивающий встроенную поддержку общих операций, включая вывод печати, копирование в буфер обмена, масштабирование и функции поиска текста. Элемент управления предоставляет доступ к страницам содержимого через знакомый механизм прокрутки. Как [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] и <xref:System.Windows.Controls.DocumentViewer> все элементы управления, поддерживает полный или частичный рестайлинг, что позволяет визуально интегрировать элемент управления практически в любое приложение или среду.  
  
 <xref:System.Windows.Controls.DocumentViewer>предназначен для отображения содержимого только для чтения; редактирование или изменение содержимого недоступно и не поддерживается.  
  
<a name="flow_document"></a>
### <a name="flow-document-controls"></a>Элементы управления документа нефиксированного формата  

> [!NOTE]
> Более подробную информацию о функциях документооборота потока и способах их создания можно найти, [см.](flow-document-overview.md)  
  
 Отображение содержимого документа <xref:System.Windows.Controls.FlowDocumentReader>потока <xref:System.Windows.Controls.FlowDocumentPageViewer>поддерживается тремя элементами управления: , и <xref:System.Windows.Controls.FlowDocumentScrollViewer>.  
  
#### <a name="flowdocumentreader"></a>FlowDocumentReader  
 <xref:System.Windows.Controls.FlowDocumentReader>включает в себя функции, которые позволяют пользователю динамически выбирать между различными режимами просмотра, включая одностраничный (страница в то время) режим просмотра, двухстраничный режим (формат чтения книг) и режим непрерывного прокрутки (бездонного) просмотра.  Для получения дополнительной информации об <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>этих режимах просмотра см.  Если вам не нужна возможность динамического переключения <xref:System.Windows.Controls.FlowDocumentPageViewer> между <xref:System.Windows.Controls.FlowDocumentScrollViewer> различными режимами просмотра, и обеспечить более легкий поток содержимого зрителей, которые фиксируются в определенном режиме просмотра.  
  
#### <a name="flowdocumentpageviewer-and-flowdocumentscrollviewer"></a>FlowDocumentPageViewer и FlowDocumentScrollViewer  
 <xref:System.Windows.Controls.FlowDocumentPageViewer>показывает содержимое в режиме просмотра страницы <xref:System.Windows.Controls.FlowDocumentScrollViewer> в режиме просмотра, в то время как показывает содержимое в непрерывном режиме прокрутки.  Оба <xref:System.Windows.Controls.FlowDocumentPageViewer> <xref:System.Windows.Controls.FlowDocumentScrollViewer> и фиксируются в определенном режиме просмотра. Сравните <xref:System.Windows.Controls.FlowDocumentReader>с , который включает в себя функции, которые позволяют пользователю динамически выбирать между различными режимами просмотра (как это предусмотрено <xref:System.Windows.Controls.FlowDocumentReaderViewingMode> перечислением), за счет того, что более ресурсоемким, чем <xref:System.Windows.Controls.FlowDocumentPageViewer> или <xref:System.Windows.Controls.FlowDocumentScrollViewer>.  
  
 По умолчанию вертикальная полоса прокрутки отображается всегда, а горизонтальная полоса прокрутки становится видимой при необходимости. По [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] умолчанию не <xref:System.Windows.Controls.FlowDocumentScrollViewer> включает панель инструментов; однако <xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A> свойство может быть использовано для включения встроенной панели инструментов.  
  
<a name="text_in_the_user_interface"></a>
### <a name="text-in-the-user-interface"></a>Текст в пользовательском интерфейсе  
 Текст можно добавлять не только в документы, но и использовать в интерфейсе приложений, например в формах. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] предоставляет множество элементов управления для отображения текста на экране. Каждый элемент управления предназначен для своего сценария и имеет собственный список функций и ограничений. Как правило, <xref:System.Windows.Controls.TextBlock> элемент должен использоваться при ограниченной поддержке текста, [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]например, краткое предложение в . <xref:System.Windows.Controls.Label>может быть использован, когда требуется минимальная поддержка текста. Дополнительные сведения см. в разделе [Общие сведения о классе TextBlock](../controls/textblock-overview.md).  
  
<a name="packaging"></a>
## <a name="document-packaging"></a>Упаковка документов  
 <xref:System.IO.Packaging> AA предоставляют эффективные средства для организации данных приложений, содержимого документов и связанных с ними ресурсов в одном контейнере, который прост в доступе, переносите и легко распространяет. Файл «ЗИП» является <xref:System.IO.Packaging.Package> примером типа, способного удерживать несколько объектов в единой единице. Упаковочные AIS обеспечивают реализацию по умолчанию, <xref:System.IO.Packaging.ZipPackage> разработанную с использованием стандарта Open Packaging Conventions с архитектурой файлов XML и ЗИП. Упаковочные [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] AIS упростили создание пакетов, а также хранение и доступ к объектам в них. Объект, хранящийся в <xref:System.IO.Packaging.Package> <xref:System.IO.Packaging.PackagePart> a, называется ("часть"). Пакеты также могут включать подписанные цифровые сертификаты, с помощью которых можно идентифицировать создателя части и убедиться, что содержимое пакета не было изменено.  Пакеты также <xref:System.IO.Packaging.PackageRelationship> включают функцию, которая позволяет добавлять дополнительную информацию в пакет или ассоциироваться с определенными частями без фактического изменения содержимого существующих частей.  Пакетные сервисы также поддерживают управление правами Microsoft Windows (RM).  
  
 Архитектура пакета [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] лежит в основе ряда ключевых технологий:  
  
- Документы XPS, соответствующие спецификации бумаги XML (XPS).  
  
- Документы открытого XML-формата Microsoft Office "12" (.docx).  
  
- Пользовательские форматы хранения для собственного приложения.  
  
 На основе упаковочных AIS, <xref:System.Windows.Xps.Packaging.XpsDocument> специально [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] разработан для хранения документов с фиксированным содержанием. An <xref:System.Windows.Xps.Packaging.XpsDocument> — это автономный документ, который может быть открыт <xref:System.Windows.Controls.DocumentViewer> в зрителе, отображается в элементе управления, направлен в катушки печати или выводится непосредственно на принтер, совместимый с XPS.  
  
 Следующие разделы предоставляют <xref:System.IO.Packaging.Package> дополнительную информацию о и <xref:System.Windows.Xps.Packaging.XpsDocument> AIS, предоставляемых [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
<a name="packages"></a>
### <a name="package-components"></a>Компоненты пакета  
 Интерфейсы API упаковки [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] позволяют упорядочить данные и документы приложения в единый портативный блок. ZIP-файл является одним из наиболее распространенных типов пакетов и типом пакета по умолчанию, предоставляемым [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  <xref:System.IO.Packaging.Package>сам по себе является <xref:System.IO.Packaging.ZipPackage> абстрактным классом, из которого реализуется с использованием открытой стандартной архитектуры файлов XML и ЗИП.  Метод <xref:System.IO.Packaging.Package.Open%2A> используется <xref:System.IO.Packaging.ZipPackage> для создания и использования файлов по умолчанию. Пакет может содержать три основных типа элементов:  
  
|||  
|-|-|  
|<xref:System.IO.Packaging.PackagePart>|Содержимое приложения, данные, документы и файлы ресурсов.|  
|<xref:System.IO.Packaging.PackageDigitalSignature>|[Сертификат X.509] для идентификации, аутентификации и проверки.|  
|<xref:System.IO.Packaging.PackageRelationship>|Добавленные сведения о пакете или определенной части.|  
  
<a name="PackageParts"></a>
#### <a name="packageparts"></a>PackageParts  
 A <xref:System.IO.Packaging.PackagePart> ("часть") — это абстрактный класс, относящийся к объекту, <xref:System.IO.Packaging.Package>хранящимся в . В ZIP-файле части пакета соответствуют отдельным файлам, хранящимся в ZIP-файле.  <xref:System.IO.Packaging.ZipPackagePart>обеспечивает реализацию по умолчанию для сериализируемых объектов, хранящихся в <xref:System.IO.Packaging.ZipPackage>.  Как и в файловой системе, части, которые содержатся в пакете, хранятся в иерархическом каталоге или организованы по папкам.  Используя [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] упаковочные AIS, приложения могут <xref:System.IO.Packaging.PackagePart> писать, хранить и читать несколько объектов с помощью одного контейнера с файлами.  
  
<a name="PackageDigitalSignatures"></a>
#### <a name="packagedigitalsignatures"></a>PackageDigitalSignatures  
 Для безопасности <xref:System.IO.Packaging.PackageDigitalSignature> ("цифровая подпись") может быть связана с частями в пакете. Включает <xref:System.IO.Packaging.PackageDigitalSignature> в себя «509», который предоставляет две функции:  
  
1. Идентификация и проверка подлинности создателя части.  
  
2. Проверка, не была ли часть изменена.  
  
 Цифровая подпись не защищает часть от изменения, но проверка цифровой подписи завершится ошибкой, если часть изменяется каким-либо образом. В таком случае приложение может предпринять соответствующие действия, например не допустить открытия части или уведомить пользователя об изменении (и, следовательно, ненадежности) части.  
  
<a name="PackageRelationships"></a>
#### <a name="packagerelationships"></a>PackageRelationships  
 A <xref:System.IO.Packaging.PackageRelationship> ("отношение") обеспечивает механизм для связи дополнительной информации с пакетом или частью в пакете. Отношение — это возможность на уровне пакета, позволяющая связывать дополнительную информацию с частью, не меняя фактического содержимого части. Вставлять новые данные непосредственно в содержимое части, как правило, нецелесообразно:  
  
- Фактический тип части и схема содержимого неизвестны.  
  
- Даже если эти параметры известны, схема содержимого может не обеспечивать средства для добавления новых данных.  
  
- Часть может быть защищена от изменений цифровой подписью или шифрованием.  
  
 Отношения пакета предоставляют видимые средства добавления дополнительной информации в отдельные части или весь пакет и создания соответствующих связей между этой информацией и объектами. Отношения пакетов используются для решения двух основных задач:  
  
1. Определение отношений зависимости между частями.  
  
2. Определение информационных отношений, добавляющих примечания или другие данные, связанные с частью.  
  
 A <xref:System.IO.Packaging.PackageRelationship> предоставляет быстрые, обнаруживаемые средства для определения зависимостей и добавления другой информации, связанной с частью пакета или пакета в целом.  
  
<a name="Dependency_Relationships"></a>
##### <a name="dependency-relationships"></a>Отношения зависимости  
 Отношения зависимости используются для описания зависимостей между частями. Например, пакет может содержать HTML-часть, которая включает один или несколько тегов изображений \<img>. Теги изображений относятся к изображениям, которые хранятся как части внутри пакета или вне его (например, части, доступные через Интернет). Создание <xref:System.IO.Packaging.PackageRelationship> связанного с HTML-файлом делает обнаружение и доступ к зависимым ресурсам быстрым и легким. Браузер или приложение средства просмотра может осуществлять прямой доступ к отношениям частей и сразу приступать к сборке зависимых ресурсов, даже не зная схемы и не выполняя синтаксического анализа документа.  
  
<a name="Information_Relationships"></a>
##### <a name="information-relationships"></a>Информационные отношения  
 Как и в примечании <xref:System.IO.Packaging.PackageRelationship> или аннотации, a также может быть использован для хранения других типов информации, которые будут связаны с частью без необходимости на самом деле изменять содержание детали себя.  
  
<a name="XPS_Documents"></a>
## <a name="xps-documents"></a>XPS-документы  
 Документ XML Paper Specification (XPS) представляет собой пакет, содержащий один или несколько фиксированных документов вместе со всеми ресурсами и информацией, необходимой для визуализации.  XPS также является родным Windows Vista печати катушки файл формата.  An <xref:System.Windows.Xps.Packaging.XpsDocument> хранится в стандартном наборе данных и может включать в себя комбинацию XML и бинарных компонентов, таких как файлы изображений и шрифтов. [PackageRelationships](#PackageRelationships) используются для определения зависимостей между содержимым и ресурсами, необходимыми для полного отображения документа.  Конструкция <xref:System.Windows.Xps.Packaging.XpsDocument> предоставляет единое решение документа с высокой точностью, которое поддерживает несколько применений:  
  
- Чтение, запись и хранение содержимого и ресурсов документов фиксированного формата в одном портативном документе с возможностью удобного распространения.  
  
- Отображение документов с помощью приложения XPS Viewer.  
  
- Вывод документов в формате вывода наиболее печатных изданий Windows Vista.  
  
- Документы, связанные с реуктором непосредственно на принтер, совместимый с XPS.  
  
## <a name="see-also"></a>См. также раздел

- <xref:System.Windows.Documents.FixedDocument>
- <xref:System.Windows.Documents.FlowDocument>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.IO.Packaging.ZipPackage>
- <xref:System.IO.Packaging.ZipPackagePart>
- <xref:System.IO.Packaging.PackageRelationship>
- <xref:System.Windows.Controls.DocumentViewer>
- [Текст](optimizing-performance-text.md)
- [Общие сведения о документах нефиксированного формата](flow-document-overview.md)
- [Общие сведения о печати](printing-overview.md)
- [Сериализация и хранение документов](document-serialization-and-storage.md)
