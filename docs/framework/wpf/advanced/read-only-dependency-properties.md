---
title: Свойства зависимости "только для чтения"
ms.date: 03/30/2017
helpviewer_keywords:
- dependency properties [WPF], read-only
- read-only dependency properties [WPF]
ms.assetid: f23d6ec9-3780-4c09-a2ff-b2f0a2deddf1
ms.openlocfilehash: 45385e3e3eb8e756008a0d9ef560e061f9a31964
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59162427"
---
# <a name="read-only-dependency-properties"></a><span data-ttu-id="a9bdc-102">Свойства зависимости "только для чтения"</span><span class="sxs-lookup"><span data-stu-id="a9bdc-102">Read-Only Dependency Properties</span></span>
<span data-ttu-id="a9bdc-103">В этом разделе описываются свойства зависимостей "только для чтения", включая существующие свойства зависимостей "только для чтения", а также сценарии и методы создания настраиваемого свойства зависимостей "только для чтения".</span><span class="sxs-lookup"><span data-stu-id="a9bdc-103">This topic describes read-only dependency properties, including existing read-only dependency properties and the scenarios and techniques for creating a custom read-only dependency property.</span></span>  

<a name="prerequisites"></a>   
## <a name="prerequisites"></a><span data-ttu-id="a9bdc-104">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="a9bdc-104">Prerequisites</span></span>  
 <span data-ttu-id="a9bdc-105">В этом разделе предполагается, что вы понимаете основные сценарии реализации свойства зависимостей и способы применения метаданных к настраиваемому свойству зависимостей.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-105">This topic assumes that you understand the basic scenarios of implementing a dependency property, and how metadata is applied to a custom dependency property.</span></span> <span data-ttu-id="a9bdc-106">Дополнительные сведения см. в разделах [Пользовательские свойства зависимостей](custom-dependency-properties.md) и [Метаданные свойства зависимостей](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="a9bdc-106">See [Custom Dependency Properties](custom-dependency-properties.md) and [Dependency Property Metadata](dependency-property-metadata.md) for context.</span></span>  
  
<a name="existing"></a>   
## <a name="existing-read-only-dependency-properties"></a><span data-ttu-id="a9bdc-107">Существующие свойства зависимостей "только для чтения"</span><span class="sxs-lookup"><span data-stu-id="a9bdc-107">Existing Read-Only Dependency Properties</span></span>  
 <span data-ttu-id="a9bdc-108">Некоторые свойства зависимостей, определенные в среде [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-108">Some of the dependency properties defined in the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] framework are read-only.</span></span> <span data-ttu-id="a9bdc-109">Типичной причиной для указания свойства зависимости "только для чтения" является то, что это свойства, которые должны использоваться для определения состояния там, где это состояние зависит от множества факторов, но простая настройка этого состояния для данного свойства нежелательна с точки зрения дизайна пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-109">The typical reason for specifying a read-only dependency property is that these are properties that should be used for state determination, but where that state is influenced by a multitude of factors, but just setting the property to that state isn't desirable from a user interface design perspective.</span></span> <span data-ttu-id="a9bdc-110">Например, свойство <xref:System.Windows.UIElement.IsMouseOver%2A> действительно только отображает состояние, определяемое вводом с помощью мыши.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-110">For example, the property <xref:System.Windows.UIElement.IsMouseOver%2A> is really just surfacing state as determined from the mouse input.</span></span> <span data-ttu-id="a9bdc-111">Любая попытка установить это значение программно путем обхода истинного ввода с помощью мыши будет непредсказуемой и вызовет несогласованность.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-111">Any attempt to set this value programmatically by circumventing the true mouse input would be unpredictable and would cause inconsistency.</span></span>  
  
 <span data-ttu-id="a9bdc-112">Поскольку свойства зависимостей "только для чтения" нельзя устанавливать, они не подходят для многих сценариев, для которых свойства зависимостей обычно предлагают решение (а именно: привязка данных с возможностью прямого использования стилей для значения, проверки, анимации, наследования).</span><span class="sxs-lookup"><span data-stu-id="a9bdc-112">By virtue of not being settable, read-only dependency properties aren't appropriate for many of the scenarios for which dependency properties normally offer a solution (namely: data binding, directly stylable to a value, validation, animation, inheritance).</span></span> <span data-ttu-id="a9bdc-113">Несмотря на то что их нельзя устанавливать, свойства зависимостей "только для чтения" обладают некоторыми дополнительными возможностями, которые поддерживаются свойствами зависимостей в системе свойств.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-113">Despite not being settable, read-only dependency properties still have some of the additional capabilities supported by dependency properties in the property system.</span></span> <span data-ttu-id="a9bdc-114">Наиболее важной оставшейся возможностью является то, что свойство зависимости "только для чтения" по-прежнему можно использовать как триггер свойств в стиле.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-114">The most important remaining capability is that the read-only dependency property can still be used as a property trigger in a style.</span></span> <span data-ttu-id="a9bdc-115">Невозможно включить триггеры с помощью обычного свойства [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)]. Оно должно быть свойством зависимостей.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-115">You can't enable triggers with a normal [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] property; it needs to be a dependency property.</span></span> <span data-ttu-id="a9bdc-116">Вышеупомянутое <xref:System.Windows.UIElement.IsMouseOver%2A> свойство является отличным примером сценария, в которых может оказаться весьма полезным определение стиля для элемента управления, в котором некоторые свойства visible, такие как фоновый рисунок, основной цвет или похожие свойства сложных элементов в элемент управления изменится, когда пользователь наведет указатель мыши на определенную область элемента управления.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-116">The aforementioned <xref:System.Windows.UIElement.IsMouseOver%2A> property is a perfect example of a scenario where it might be quite useful to define a style for a control, where some visible property such as a background, foreground, or similar properties of composited elements within the control will change when the user places a mouse over some defined region of your control.</span></span> <span data-ttu-id="a9bdc-117">Изменения в свойстве зависимостей "только для чтения" также могут обнаруживаться и сообщаться внутренними процессами определения недействительности в системе свойств. Фактически, это внутренняя поддержка функциональности триггера свойств.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-117">Changes in a read-only dependency property can also be detected and reported by the property system's inherent invalidation processes, and this in fact supports the property trigger functionality internally.</span></span>  
  
<a name="new"></a>   
## <a name="creating-custom-read-only-dependency-properties"></a><span data-ttu-id="a9bdc-118">Создание пользовательских свойств зависимостей "только для чтения"</span><span class="sxs-lookup"><span data-stu-id="a9bdc-118">Creating Custom Read-Only Dependency Properties</span></span>  
 <span data-ttu-id="a9bdc-119">Обязательно ознакомьтесь с вышеприведенным разделом, описывающим, почему свойства зависимостей "только для чтения" не будут работать для многих типичных сценариев свойств зависимостей.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-119">Make sure to read the section above regarding why read-only dependency properties won't work for many typical dependency-property scenarios.</span></span> <span data-ttu-id="a9bdc-120">Однако при наличии соответствующего сценария можно создать собственное свойство зависимостей "только для чтения".</span><span class="sxs-lookup"><span data-stu-id="a9bdc-120">But if you have an appropriate scenario, you may wish to create your own read-only dependency property.</span></span>  
  
 <span data-ttu-id="a9bdc-121">Большая часть процесса создания свойства зависимостей "только для чтения" аналогична описанному в разделах [Пользовательские свойства зависимостей](custom-dependency-properties.md) и [Реализация свойства зависимостей](how-to-implement-a-dependency-property.md).</span><span class="sxs-lookup"><span data-stu-id="a9bdc-121">Much of the process of creating a read-only dependency property is the same as is described in the [Custom Dependency Properties](custom-dependency-properties.md) and [Implement a Dependency Property](how-to-implement-a-dependency-property.md) topics.</span></span> <span data-ttu-id="a9bdc-122">Однако есть три важных отличия.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-122">There are three important differences:</span></span>  
  
-   <span data-ttu-id="a9bdc-123">При регистрации свойства следует вызвать <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A> вместо обычного метода <xref:System.Windows.DependencyProperty.Register%2A> метод для регистрации свойства.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-123">When registering your property, call the <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A> method instead of the normal <xref:System.Windows.DependencyProperty.Register%2A> method for property registration.</span></span>  
  
-   <span data-ttu-id="a9bdc-124">При реализации свойства wrapper [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] убедитесь, что в программе-оболочке нет реализации set, и таким образом, отсутствует несогласованность в состоянии "только для чтения" для открытой программы-оболочки.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-124">When implementing the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] "wrapper" property, make sure that the wrapper too doesn't have a set implementation, so that there is no inconsistency in read-only state for the public wrapper you expose.</span></span>  
  
-   <span data-ttu-id="a9bdc-125">Объект, возвращаемый регистрацией только для чтения — <xref:System.Windows.DependencyPropertyKey> вместо <xref:System.Windows.DependencyProperty>.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-125">The object returned by the read-only registration is <xref:System.Windows.DependencyPropertyKey> rather than <xref:System.Windows.DependencyProperty>.</span></span> <span data-ttu-id="a9bdc-126">Необходимо сохранить это поле в качестве члена, но обычно не нужно его делать общим членом для типа.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-126">You should still store this field as a member but typically you would not make it a public member of the type.</span></span>  
  
 <span data-ttu-id="a9bdc-127">Любое частное поле или значение, заложенное в свойство зависимостей "только для чтения", может быть полностью записываемым с помощью любой выбранной логики.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-127">Whatever private field or value you have backing your read-only dependency property can of course be fully writable using whatever logic you decide.</span></span> <span data-ttu-id="a9bdc-128">Однако самый простой способ задать свойство либо изначально, либо в составе логики выполнения — это использовать [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] системы свойств, а не обходить систему свойств и настраивать частное резервное поле напрямую.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-128">However, the most straightforward way to set the property either initially or as part of runtime logic is to use the property system's [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], rather than circumventing the property system and setting the private backing field directly.</span></span> <span data-ttu-id="a9bdc-129">В частности, имеется подпись <xref:System.Windows.DependencyObject.SetValue%2A> , принимающий параметр типа <xref:System.Windows.DependencyPropertyKey>.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-129">In particular, there is a signature of <xref:System.Windows.DependencyObject.SetValue%2A> that accepts a parameter of type <xref:System.Windows.DependencyPropertyKey>.</span></span> <span data-ttu-id="a9bdc-130">Как и где это значение программно в логике приложения повлияет на том, как вы можете установить доступ к <xref:System.Windows.DependencyPropertyKey> создается при первой регистрации свойства зависимостей.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-130">How and where you set this value programmatically within your application logic will affect how you may wish to set access on the <xref:System.Windows.DependencyPropertyKey> created when you first registered the dependency property.</span></span> <span data-ttu-id="a9bdc-131">Если обрабатывать эту логику внутри класса, то можно сделать ее частной. Если необходимо устанавливать ее из других частей сборки, можно сделать ее внутренней.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-131">If you handle this logic all within the class you could make it private, or if you require it to be set from other portions of the assembly you might set it internal.</span></span> <span data-ttu-id="a9bdc-132">Одним из подходов является вызов <xref:System.Windows.DependencyObject.SetValue%2A> обработчика событий класса для соответствующего события, сообщающего экземпляру класса, хранимого значения свойства необходимо изменить.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-132">One approach is to call <xref:System.Windows.DependencyObject.SetValue%2A> within a class event handler of a relevant event that informs a class instance that the stored property value needs to be changed.</span></span> <span data-ttu-id="a9bdc-133">Другой подход заключается в связывании свойств зависимости с помощью парных <xref:System.Windows.PropertyChangedCallback> и <xref:System.Windows.CoerceValueCallback> обратные вызовы как часть метаданных этих свойств во время регистрации.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-133">Another approach is to tie dependency properties together by using paired <xref:System.Windows.PropertyChangedCallback> and <xref:System.Windows.CoerceValueCallback> callbacks as part of those properties' metadata during registration.</span></span>  
  
 <span data-ttu-id="a9bdc-134">Поскольку <xref:System.Windows.DependencyPropertyKey> является закрытым и не распространяется системой свойств вне кода, свойство зависимостей только для чтения иметь лучшую безопасность настройки, чем свойство зависимости для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-134">Because the <xref:System.Windows.DependencyPropertyKey> is private, and is not propagated by the property system outside of your code, a read-only dependency property does have better setting security than a read-write dependency property.</span></span> <span data-ttu-id="a9bdc-135">Для свойства зависимостей с возможностью чтения и записи идентифицирующее поле является явно или неявно общим, и таким образом, свойство является широко устанавливаемым.</span><span class="sxs-lookup"><span data-stu-id="a9bdc-135">For a read-write dependency property, the identifying field is explicitly or implicitly public and thus the property is widely settable.</span></span> <span data-ttu-id="a9bdc-136">Дополнительные сведения см. в разделе [Безопасность свойства зависимостей](dependency-property-security.md).</span><span class="sxs-lookup"><span data-stu-id="a9bdc-136">For more specifics, see [Dependency Property Security](dependency-property-security.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a9bdc-137">См. также</span><span class="sxs-lookup"><span data-stu-id="a9bdc-137">See also</span></span>

- [<span data-ttu-id="a9bdc-138">Общие сведения о свойствах зависимости</span><span class="sxs-lookup"><span data-stu-id="a9bdc-138">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="a9bdc-139">Пользовательские свойства зависимостей</span><span class="sxs-lookup"><span data-stu-id="a9bdc-139">Custom Dependency Properties</span></span>](custom-dependency-properties.md)
- [<span data-ttu-id="a9bdc-140">Стилизация и использование шаблонов</span><span class="sxs-lookup"><span data-stu-id="a9bdc-140">Styling and Templating</span></span>](../controls/styling-and-templating.md)
