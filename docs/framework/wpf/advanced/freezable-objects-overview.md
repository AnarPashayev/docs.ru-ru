---
title: Общие сведения об объектах класса Freezable
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Freezable objects [WPF], description
- unfreezing Freezable objects [WPF]
- classes [WPF], Freezable
ms.assetid: 89c71692-4f43-4057-b611-67c6a8a863a2
ms.openlocfilehash: 79c539bd0117c712670601b7498c490fca76090e
ms.sourcegitcommit: eaa6d5cd0f4e7189dbe0bd756e9f53508b01989e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/07/2019
ms.locfileid: "67610519"
---
# <a name="freezable-objects-overview"></a><span data-ttu-id="ec457-102">Общие сведения об объектах класса Freezable</span><span class="sxs-lookup"><span data-stu-id="ec457-102">Freezable Objects Overview</span></span>
<span data-ttu-id="ec457-103">В этом разделе описывается, как эффективно использовать и создавать <xref:System.Windows.Freezable> объекты, которые предоставляют специальные функции, которые могут помочь повысить производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="ec457-103">This topic describes how to effectively use and create <xref:System.Windows.Freezable> objects, which provide special features that can help improve application performance.</span></span> <span data-ttu-id="ec457-104">Объекты freezable примеры кисти, перья, преобразования, геометрии и анимации.</span><span class="sxs-lookup"><span data-stu-id="ec457-104">Examples of freezable objects include brushes, pens, transformations, geometries, and animations.</span></span>  
  
<a name="whatisafreezable"></a>   
## <a name="what-is-a-freezable"></a><span data-ttu-id="ec457-105">Что такое Freezable?</span><span class="sxs-lookup"><span data-stu-id="ec457-105">What Is a Freezable?</span></span>  
 <span data-ttu-id="ec457-106">Объект <xref:System.Windows.Freezable> — это специальный тип объекта, имеющий два состояния: фиксированное и нефиксированное.</span><span class="sxs-lookup"><span data-stu-id="ec457-106">A <xref:System.Windows.Freezable> is a special type of object that has two states: unfrozen and frozen.</span></span> <span data-ttu-id="ec457-107">Незафиксированный <xref:System.Windows.Freezable> ведет себя как любой другой объект.</span><span class="sxs-lookup"><span data-stu-id="ec457-107">When unfrozen, a <xref:System.Windows.Freezable> appears to behave like any other object.</span></span> <span data-ttu-id="ec457-108">Зафиксированный <xref:System.Windows.Freezable> не может быть изменен.</span><span class="sxs-lookup"><span data-stu-id="ec457-108">When frozen, a <xref:System.Windows.Freezable> can no longer be modified.</span></span>  
  
 <span data-ttu-id="ec457-109">Объект <xref:System.Windows.Freezable> предоставляет <xref:System.Windows.Freezable.Changed> событие, чтобы уведомлять наблюдателей об каких-либо изменений объекта.</span><span class="sxs-lookup"><span data-stu-id="ec457-109">A <xref:System.Windows.Freezable> provides a <xref:System.Windows.Freezable.Changed> event to notify observers of any modifications to the object.</span></span> <span data-ttu-id="ec457-110">Замораживание <xref:System.Windows.Freezable> позволяет повысить его производительность, поскольку он больше не требуется тратить ресурсы на уведомления об изменениях.</span><span class="sxs-lookup"><span data-stu-id="ec457-110">Freezing a <xref:System.Windows.Freezable> can improve its performance, because it no longer needs to spend resources on change notifications.</span></span> <span data-ttu-id="ec457-111">Зафиксированный <xref:System.Windows.Freezable> также может использоваться несколькими потоками, в отличие от незафиксированных <xref:System.Windows.Freezable> невозможно.</span><span class="sxs-lookup"><span data-stu-id="ec457-111">A frozen <xref:System.Windows.Freezable> can also be shared across threads, while an unfrozen <xref:System.Windows.Freezable> cannot.</span></span>  
  
 <span data-ttu-id="ec457-112">Несмотря на то что <xref:System.Windows.Freezable> класс имеет много приложений, наиболее <xref:System.Windows.Freezable> объекты в [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] связаны с графическая подсистема.</span><span class="sxs-lookup"><span data-stu-id="ec457-112">Although the <xref:System.Windows.Freezable> class has many applications, most <xref:System.Windows.Freezable> objects in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] are related to the graphics sub-system.</span></span>  
  
 <span data-ttu-id="ec457-113"><xref:System.Windows.Freezable> Класс упрощает использование определенных объектов графических систем и может повысить производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="ec457-113">The <xref:System.Windows.Freezable> class makes it easier to use certain graphics system objects and can help improve application performance.</span></span> <span data-ttu-id="ec457-114">Примеры типов, которые наследуют от <xref:System.Windows.Freezable> включают <xref:System.Windows.Media.Brush>, <xref:System.Windows.Media.Transform>, и <xref:System.Windows.Media.Geometry> классы.</span><span class="sxs-lookup"><span data-stu-id="ec457-114">Examples of types that inherit from <xref:System.Windows.Freezable> include the <xref:System.Windows.Media.Brush>, <xref:System.Windows.Media.Transform>, and <xref:System.Windows.Media.Geometry> classes.</span></span> <span data-ttu-id="ec457-115">Так как они содержат неуправляемые ресурсы, система должна отслеживать изменения этих объектов и затем обновить соответствующие им неуправляемые ресурсы, при наличии изменений в исходный объект.</span><span class="sxs-lookup"><span data-stu-id="ec457-115">Because they contain unmanaged resources, the system must monitor these objects for modifications, and then update their corresponding unmanaged resources when there is a change to the original object.</span></span> <span data-ttu-id="ec457-116">Даже если вы не меняете фактически объект графической системы, системы необходимо по-прежнему тратить часть его ресурсов, наблюдение за объектом, в случае, если изменить его.</span><span class="sxs-lookup"><span data-stu-id="ec457-116">Even if you don't actually modify a graphics system object, the system must still spend some of its resources monitoring the object, in case you do change it.</span></span>  
  
 <span data-ttu-id="ec457-117">Предположим, например, можно создать <xref:System.Windows.Media.SolidColorBrush> кисти и использовать его для рисования фона кнопки.</span><span class="sxs-lookup"><span data-stu-id="ec457-117">For example, suppose you create a <xref:System.Windows.Media.SolidColorBrush> brush and use it to paint the background of a button.</span></span>  
  
 [!code-csharp[freezablesample_procedural#FrozenExamplePart1](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#frozenexamplepart1)]
 [!code-vb[freezablesample_procedural#FrozenExamplePart1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#frozenexamplepart1)]  
  
 <span data-ttu-id="ec457-118">При отображении кнопки [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] графическая подсистема использует сведения, предоставленные для закраски группы пикселей, которое необходимо создать внешний вид кнопки.</span><span class="sxs-lookup"><span data-stu-id="ec457-118">When the button is rendered, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] graphics sub-system uses the information you provided to paint a group of pixels to create the appearance of a button.</span></span> <span data-ttu-id="ec457-119">Несмотря на то, что вы использовали Одноцветная кисть для описания того, как должен быть окрашен кнопки, сплошной цвет кисти фактически не выполняет заливку.</span><span class="sxs-lookup"><span data-stu-id="ec457-119">Although you used a solid color brush to describe how the button should be painted, your solid color brush doesn't actually do the painting.</span></span> <span data-ttu-id="ec457-120">Графическая система создает быстрые низкоуровневые объекты для кнопки и кисти, а это те объекты, которые отображаются на экране.</span><span class="sxs-lookup"><span data-stu-id="ec457-120">The graphics system generates fast, low-level objects for the button and the brush, and it is those objects that actually appear on the screen.</span></span>  
  
 <span data-ttu-id="ec457-121">При изменении кисти, эти низкоуровневые объекты бы быть создан повторно.</span><span class="sxs-lookup"><span data-stu-id="ec457-121">If you were to modify the brush, those low-level objects would have to be regenerated.</span></span> <span data-ttu-id="ec457-122">Класс freezable представляет, что дает возможность найти соответствующие объекты низкоуровневые и обновлять их при его изменении кисти.</span><span class="sxs-lookup"><span data-stu-id="ec457-122">The freezable class is what gives a brush the ability to find its corresponding generated, low-level objects and to update them when it changes.</span></span> <span data-ttu-id="ec457-123">Если эта возможность включена, кисть, которая называется «незафиксированной».</span><span class="sxs-lookup"><span data-stu-id="ec457-123">When this ability is enabled, the brush is said to be "unfrozen."</span></span>  
  
 <span data-ttu-id="ec457-124">Freezable <xref:System.Windows.Freezable.Freeze%2A> метод позволяет отключить данную возможность самостоятельного обновления.</span><span class="sxs-lookup"><span data-stu-id="ec457-124">A freezable's <xref:System.Windows.Freezable.Freeze%2A> method enables you to disable this self-updating ability.</span></span> <span data-ttu-id="ec457-125">Этот метод можно использовать, чтобы сделать кисть «зафиксированной» или неизменяемым.</span><span class="sxs-lookup"><span data-stu-id="ec457-125">You can use this method to make the brush become "frozen," or unmodifiable.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec457-126">Не каждый объект Freezable может быть зафиксирован.</span><span class="sxs-lookup"><span data-stu-id="ec457-126">Not every Freezable object can be frozen.</span></span> <span data-ttu-id="ec457-127">Чтобы избежать возникновения <xref:System.InvalidOperationException>, проверьте значение свойства объекта Freezable <xref:System.Windows.Freezable.CanFreeze%2A> свойства, чтобы определить, является ли он быть зафиксирован перед фиксированием.</span><span class="sxs-lookup"><span data-stu-id="ec457-127">To avoid throwing an <xref:System.InvalidOperationException>, check the value of the Freezable object's <xref:System.Windows.Freezable.CanFreeze%2A> property to determine whether it can be frozen before attempting to freeze it.</span></span>  
  
 [!code-csharp[freezablesample_procedural#FrozenExamplePart2](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#frozenexamplepart2)]
 [!code-vb[freezablesample_procedural#FrozenExamplePart2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#frozenexamplepart2)]  
  
 <span data-ttu-id="ec457-128">Если вам больше не нужно изменять freezable, зафиксировать этот дает выигрыш в производительности.</span><span class="sxs-lookup"><span data-stu-id="ec457-128">When you no longer need to modify a freezable, freezing it provides performance benefits.</span></span> <span data-ttu-id="ec457-129">Если закрепить кисть, которая в этом примере, графическая система больше не потребуется отслеживать его изменения.</span><span class="sxs-lookup"><span data-stu-id="ec457-129">If you were to freeze the brush in this example, the graphics system would no longer need to monitor it for changes.</span></span> <span data-ttu-id="ec457-130">Графическая система также может отправлять другие виды оптимизации, поскольку известно, что кисть, которая не изменится.</span><span class="sxs-lookup"><span data-stu-id="ec457-130">The graphics system can also make other optimizations, because it knows the brush won't change.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec457-131">Для удобства объекты freezable остаются незафиксированными, пока вы явным образом замораживайте.</span><span class="sxs-lookup"><span data-stu-id="ec457-131">For convenience, freezable objects remain unfrozen unless you explicitly freeze them.</span></span>  
  
<a name="frozenfreezables"></a>   
## <a name="using-freezables"></a><span data-ttu-id="ec457-132">С помощью объектов Freezable</span><span class="sxs-lookup"><span data-stu-id="ec457-132">Using Freezables</span></span>  
 <span data-ttu-id="ec457-133">Использование незафиксированного freezable аналогично использованию любого другого типа объекта.</span><span class="sxs-lookup"><span data-stu-id="ec457-133">Using an unfrozen freezable is like using any other type of object.</span></span> <span data-ttu-id="ec457-134">В следующем примере цвет <xref:System.Windows.Media.SolidColorBrush> изменяется с желтого на красный после он используется для рисования фона кнопки.</span><span class="sxs-lookup"><span data-stu-id="ec457-134">In the following example, the color of a <xref:System.Windows.Media.SolidColorBrush> is changed from yellow to red after it's used to paint the background of a button.</span></span> <span data-ttu-id="ec457-135">Графическая система работает незаметно для автоматического изменения кнопки с желтого на красный при очередном обновлении экрана.</span><span class="sxs-lookup"><span data-stu-id="ec457-135">The graphics system works behind the scenes to automatically change the button from yellow to red the next time the screen is refreshed.</span></span>  
  
 [!code-csharp[freezablesample_procedural#UnFrozenExampleShort](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#unfrozenexampleshort)]
 [!code-vb[freezablesample_procedural#UnFrozenExampleShort](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#unfrozenexampleshort)]  
  
### <a name="freezing-a-freezable"></a><span data-ttu-id="ec457-136">Замораживание Freezable</span><span class="sxs-lookup"><span data-stu-id="ec457-136">Freezing a Freezable</span></span>  
 <span data-ttu-id="ec457-137">Чтобы сделать <xref:System.Windows.Freezable> неизменяемым, необходимо вызвать его <xref:System.Windows.Freezable.Freeze%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-137">To make a <xref:System.Windows.Freezable> unmodifiable, you call its <xref:System.Windows.Freezable.Freeze%2A> method.</span></span> <span data-ttu-id="ec457-138">Когда вы закрепить объект, содержащий объекты freezable, эти объекты также закрепляются.</span><span class="sxs-lookup"><span data-stu-id="ec457-138">When you freeze an object that contains freezable objects, those objects are frozen as well.</span></span> <span data-ttu-id="ec457-139">Например, если зафиксировать <xref:System.Windows.Media.PathGeometry>, рисунки и сегменты будут зафиксированы.</span><span class="sxs-lookup"><span data-stu-id="ec457-139">For example, if you freeze a <xref:System.Windows.Media.PathGeometry>, the figures and segments it contains would be frozen too.</span></span>  
  
 <span data-ttu-id="ec457-140">Freezable **нельзя** зафиксировать, если одно из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="ec457-140">A Freezable **can't** be frozen if any of the following are true:</span></span>  
  
- <span data-ttu-id="ec457-141">Объект имеет анимированные или свойства с привязкой к данным.</span><span class="sxs-lookup"><span data-stu-id="ec457-141">It has animated or data bound properties.</span></span>  
  
- <span data-ttu-id="ec457-142">Он имеет свойства, заданные на динамический ресурс.</span><span class="sxs-lookup"><span data-stu-id="ec457-142">It has properties set by a dynamic resource.</span></span> <span data-ttu-id="ec457-143">(См. в разделе [ресурсы XAML](xaml-resources.md) Дополнительные сведения о динамических ресурсов.)</span><span class="sxs-lookup"><span data-stu-id="ec457-143">(See the [XAML Resources](xaml-resources.md) for more information about dynamic resources.)</span></span>  
  
- <span data-ttu-id="ec457-144">Он содержит <xref:System.Windows.Freezable> вложенные объекты, которые нельзя зафиксировать.</span><span class="sxs-lookup"><span data-stu-id="ec457-144">It contains <xref:System.Windows.Freezable> sub-objects that can't be frozen.</span></span>  
  
 <span data-ttu-id="ec457-145">Если эти условия имеют значение false, и вы не собираетесь изменять <xref:System.Windows.Freezable>, то стоит зафиксировать, чтобы получить выигрыш в производительности, описанные ранее.</span><span class="sxs-lookup"><span data-stu-id="ec457-145">If these conditions are false, and you don't intend to modify the <xref:System.Windows.Freezable>, then you should freeze it to gain the performance benefits described earlier.</span></span>  
  
 <span data-ttu-id="ec457-146">При вызове метода freezable <xref:System.Windows.Freezable.Freeze%2A> метод, он не может быть изменен.</span><span class="sxs-lookup"><span data-stu-id="ec457-146">Once you call a freezable's <xref:System.Windows.Freezable.Freeze%2A> method, it can no longer be modified.</span></span> <span data-ttu-id="ec457-147">Попытка изменить зафиксированного объекта возникает <xref:System.InvalidOperationException> исключение.</span><span class="sxs-lookup"><span data-stu-id="ec457-147">Attempting to modify a frozen object causes an <xref:System.InvalidOperationException> to be thrown.</span></span> <span data-ttu-id="ec457-148">Следующий код создает исключение, так как выполняется попытка изменить кисть после она была зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="ec457-148">The following code throws an exception, because we attempt to modify the brush after it's been frozen.</span></span>  
  
 [!code-csharp[freezablesample_procedural#ExceptionExample](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#exceptionexample)]
 [!code-vb[freezablesample_procedural#ExceptionExample](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#exceptionexample)]  
  
 <span data-ttu-id="ec457-149">Чтобы избежать возникновения этого исключения, можно использовать <xref:System.Windows.Freezable.IsFrozen%2A> метод, чтобы определить, является ли <xref:System.Windows.Freezable> заморожен.</span><span class="sxs-lookup"><span data-stu-id="ec457-149">To avoid throwing this exception, you can use the <xref:System.Windows.Freezable.IsFrozen%2A> method to determine whether a <xref:System.Windows.Freezable> is frozen.</span></span>  
  
 [!code-csharp[freezablesample_procedural#CheckIsFrozenExample](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#checkisfrozenexample)]
 [!code-vb[freezablesample_procedural#CheckIsFrozenExample](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#checkisfrozenexample)]  
  
 <span data-ttu-id="ec457-150">В предыдущем примере кода, изменяемая копия была сделана зафиксированного объекта с помощью <xref:System.Windows.Freezable.Clone%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-150">In the preceding code example, a modifiable copy was made of a frozen object using the <xref:System.Windows.Freezable.Clone%2A> method.</span></span> <span data-ttu-id="ec457-151">В следующем разделе рассматривается более подробно клонирования.</span><span class="sxs-lookup"><span data-stu-id="ec457-151">The next section discusses cloning in more detail.</span></span>  
  
 <span data-ttu-id="ec457-152">**Примечание** поскольку зафиксированного freezable невозожно анимировать, системы анимации автоматически создаст изменяемые клоны замороженный <xref:System.Windows.Freezable> объектов при попытке их с помощью анимации <xref:System.Windows.Media.Animation.Storyboard>.</span><span class="sxs-lookup"><span data-stu-id="ec457-152">**Note** Because a frozen freezable cannot be animated, the animation system will automatically create modifiable clones of frozen <xref:System.Windows.Freezable> objects when you try to animate them with a <xref:System.Windows.Media.Animation.Storyboard>.</span></span> <span data-ttu-id="ec457-153">Чтобы снизить издержки из-за клонирования, оставьте объект незафиксированным, если вы собираетесь анимировать его.</span><span class="sxs-lookup"><span data-stu-id="ec457-153">To eliminate the performance overhead caused by cloning, leave an object unfrozen if you intend to animate it.</span></span> <span data-ttu-id="ec457-154">Дополнительные сведения об анимации с помощью раскадровки см. в разделе [Общие сведения о раскадровках](../graphics-multimedia/storyboards-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ec457-154">For more information about animating with storyboards, see the [Storyboards Overview](../graphics-multimedia/storyboards-overview.md).</span></span>  
  
### <a name="freezing-from-markup"></a><span data-ttu-id="ec457-155">Замораживание из разметки</span><span class="sxs-lookup"><span data-stu-id="ec457-155">Freezing from Markup</span></span>  
 <span data-ttu-id="ec457-156">Чтобы закрепить <xref:System.Windows.Freezable> объявленный в разметке, можно использовать `PresentationOptions:Freeze` атрибута.</span><span class="sxs-lookup"><span data-stu-id="ec457-156">To freeze a <xref:System.Windows.Freezable> object declared in markup, you use the `PresentationOptions:Freeze` attribute.</span></span> <span data-ttu-id="ec457-157">В следующем примере <xref:System.Windows.Media.SolidColorBrush> объявляется как ресурс страницы и зафиксирован.</span><span class="sxs-lookup"><span data-stu-id="ec457-157">In the following example, a <xref:System.Windows.Media.SolidColorBrush> is declared as a page resource and frozen.</span></span> <span data-ttu-id="ec457-158">Затем используется для установки фона кнопки.</span><span class="sxs-lookup"><span data-stu-id="ec457-158">It is then used to set the background of a button.</span></span>  
  
 [!code-xaml[FreezableSample#FreezeFromMarkupWholePage](~/samples/snippets/csharp/VS_Snippets_Wpf/FreezableSample/CS/FreezeFromMarkupExample.xaml#freezefrommarkupwholepage)]  
  
 <span data-ttu-id="ec457-159">Чтобы использовать `Freeze` атрибут, необходимо сопоставить с параметрами представления пространство имен: `http://schemas.microsoft.com/winfx/2006/xaml/presentation/options`.</span><span class="sxs-lookup"><span data-stu-id="ec457-159">To use the `Freeze` attribute, you must map to the presentation options namespace: `http://schemas.microsoft.com/winfx/2006/xaml/presentation/options`.</span></span> <span data-ttu-id="ec457-160">`PresentationOptions` — Это рекомендуемый префикс для сопоставления данного пространства имен:</span><span class="sxs-lookup"><span data-stu-id="ec457-160">`PresentationOptions` is the recommended prefix for mapping this namespace:</span></span>  
  
```  
xmlns:PresentationOptions="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"   
```  
  
 <span data-ttu-id="ec457-161">Так как не все средства чтения XAML распознают этот атрибут, рекомендуется использовать [mc: Ignorable-атрибут](mc-ignorable-attribute.md) для пометки `Presentation:Freeze` атрибут ignorable как:</span><span class="sxs-lookup"><span data-stu-id="ec457-161">Because not all XAML readers recognize this attribute, it's recommended that you use the [mc:Ignorable Attribute](mc-ignorable-attribute.md) to mark the `Presentation:Freeze` attribute as ignorable:</span></span>  
  
```  
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"  
mc:Ignorable="PresentationOptions"  
```  
  
 <span data-ttu-id="ec457-162">Дополнительные сведения см. в разделе [mc: Ignorable-атрибут](mc-ignorable-attribute.md) страницы.</span><span class="sxs-lookup"><span data-stu-id="ec457-162">For more information, see the [mc:Ignorable Attribute](mc-ignorable-attribute.md) page.</span></span>  
  
### <a name="unfreezing-a-freezable"></a><span data-ttu-id="ec457-163">«Размораживание» Freezable</span><span class="sxs-lookup"><span data-stu-id="ec457-163">"Unfreezing" a Freezable</span></span>  
 <span data-ttu-id="ec457-164">После фиксации <xref:System.Windows.Freezable> никогда не может быть изменен или разморозить; тем не менее, можно создать с помощью незафиксированную копию <xref:System.Windows.Freezable.Clone%2A> или <xref:System.Windows.Freezable.CloneCurrentValue%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-164">Once frozen, a <xref:System.Windows.Freezable> can never be modified or unfrozen; however, you can create an unfrozen clone using the <xref:System.Windows.Freezable.Clone%2A> or <xref:System.Windows.Freezable.CloneCurrentValue%2A> method.</span></span>  
  
 <span data-ttu-id="ec457-165">В следующем примере фона кнопки задается с помощью кисти и кисти, затем заморожен.</span><span class="sxs-lookup"><span data-stu-id="ec457-165">In the following example, the button's background is set with a brush and that brush is then frozen.</span></span> <span data-ttu-id="ec457-166">Незафиксированная копия состоит из кисти с использованием <xref:System.Windows.Freezable.Clone%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-166">An unfrozen copy is made of the brush using the <xref:System.Windows.Freezable.Clone%2A> method.</span></span> <span data-ttu-id="ec457-167">Клон изменяется и используется для изменения фона кнопки с желтого на красный.</span><span class="sxs-lookup"><span data-stu-id="ec457-167">The clone is modified and used to change the button's background from yellow to red.</span></span>  
  
 [!code-csharp[freezablesample_procedural#CloneExample](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#cloneexample)]
 [!code-vb[freezablesample_procedural#CloneExample](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#cloneexample)]  
  
> [!NOTE]
>  <span data-ttu-id="ec457-168">Независимо от используемого метода клонирования, анимация никогда не копируется в новый <xref:System.Windows.Freezable>.</span><span class="sxs-lookup"><span data-stu-id="ec457-168">Regardless of which clone method you use, animations are never copied to the new <xref:System.Windows.Freezable>.</span></span>  
  
 <span data-ttu-id="ec457-169"><xref:System.Windows.Freezable.Clone%2A> И <xref:System.Windows.Freezable.CloneCurrentValue%2A> методы создают детальные копии объекта freezable.</span><span class="sxs-lookup"><span data-stu-id="ec457-169">The <xref:System.Windows.Freezable.Clone%2A> and <xref:System.Windows.Freezable.CloneCurrentValue%2A> methods produce deep copies of the freezable.</span></span> <span data-ttu-id="ec457-170">Если объект freezable содержит другие зафиксированные объекты freezable, они также клонируются и становятся изменяемыми.</span><span class="sxs-lookup"><span data-stu-id="ec457-170">If the freezable contains other frozen freezable objects, they are also cloned and made modifiable.</span></span> <span data-ttu-id="ec457-171">Например, если копировать зафиксированный <xref:System.Windows.Media.PathGeometry> чтобы сделать его изменяемым, рисунки и сегменты также копируются и становятся изменяемыми.</span><span class="sxs-lookup"><span data-stu-id="ec457-171">For example, if you clone a frozen <xref:System.Windows.Media.PathGeometry> to make it modifiable, the figures and segments it contains are also copied and made modifiable.</span></span>  
  
<a name="createyourownfreezableclass"></a>   
## <a name="creating-your-own-freezable-class"></a><span data-ttu-id="ec457-172">Создание собственного класса Freezable</span><span class="sxs-lookup"><span data-stu-id="ec457-172">Creating Your Own Freezable Class</span></span>  
 <span data-ttu-id="ec457-173">Класс, производный от <xref:System.Windows.Freezable> поддерживает следующие функции.</span><span class="sxs-lookup"><span data-stu-id="ec457-173">A class that derives from <xref:System.Windows.Freezable> gains the following features.</span></span>  
  
- <span data-ttu-id="ec457-174">Особые состояния: только для чтения (замороженным) и состояние для записи.</span><span class="sxs-lookup"><span data-stu-id="ec457-174">Special states: a read-only (frozen) and a writable state.</span></span>  
  
- <span data-ttu-id="ec457-175">Потокобезопасность: зафиксированный <xref:System.Windows.Freezable> может использоваться несколькими потоками.</span><span class="sxs-lookup"><span data-stu-id="ec457-175">Thread safety: a frozen <xref:System.Windows.Freezable> can be shared across threads.</span></span>  
  
- <span data-ttu-id="ec457-176">Подробные уведомления об изменениях: В отличие от других <xref:System.Windows.DependencyObject>s, объектах класса Freezable предоставить уведомление об изменениях, при изменении значений вложенных свойств.</span><span class="sxs-lookup"><span data-stu-id="ec457-176">Detailed change notification: Unlike other <xref:System.Windows.DependencyObject>s, Freezable objects provide change notifications when sub-property values change.</span></span>  
  
- <span data-ttu-id="ec457-177">Удобное клонирование: Freezable класс уже реализовал несколько методов, которые обеспечивают большую глубину клонирования.</span><span class="sxs-lookup"><span data-stu-id="ec457-177">Easy cloning: the Freezable class has already implemented several methods that produce deep clones.</span></span>  
  
 <span data-ttu-id="ec457-178">Объект <xref:System.Windows.Freezable> — это разновидность <xref:System.Windows.DependencyObject>и поэтому использует в системе свойств зависимостей.</span><span class="sxs-lookup"><span data-stu-id="ec457-178">A <xref:System.Windows.Freezable> is a type of <xref:System.Windows.DependencyObject>, and therefore uses the dependency property system.</span></span> <span data-ttu-id="ec457-179">Свойства класса не обязательно должны быть свойствами зависимости, но использование свойств зависимостей уменьшит объем кода, необходимо написать, так как <xref:System.Windows.Freezable> класс был разработан с учетом свойств зависимости.</span><span class="sxs-lookup"><span data-stu-id="ec457-179">Your class properties don't have to be dependency properties, but using dependency properties will reduce the amount of code you have to write, because the <xref:System.Windows.Freezable> class was designed with dependency properties in mind.</span></span> <span data-ttu-id="ec457-180">Дополнительные сведения о системе свойств зависимостей, см. в разделе [Общие сведения о свойствах зависимостей](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ec457-180">For more information about the dependency property system, see the [Dependency Properties Overview](dependency-properties-overview.md).</span></span>  
  
 <span data-ttu-id="ec457-181">Каждый <xref:System.Windows.Freezable> подкласс должен переопределять <xref:System.Windows.Freezable.CreateInstanceCore%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-181">Every <xref:System.Windows.Freezable> subclass must override the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method.</span></span> <span data-ttu-id="ec457-182">Если ваш класс использует свойства зависимости для всех своих данных, вы закончили.</span><span class="sxs-lookup"><span data-stu-id="ec457-182">If your class uses dependency properties for all its data, you're finished.</span></span>  
  
 <span data-ttu-id="ec457-183">Если класс содержит члены данных не свойство зависимости, необходимо также переопределить следующие методы:</span><span class="sxs-lookup"><span data-stu-id="ec457-183">If your class contains non-dependency property data members, you must also override the following methods:</span></span>  
  
- <xref:System.Windows.Freezable.CloneCore%2A>  
  
- <xref:System.Windows.Freezable.CloneCurrentValueCore%2A>  
  
- <xref:System.Windows.Freezable.GetAsFrozenCore%2A>  
  
- <xref:System.Windows.Freezable.GetCurrentValueAsFrozenCore%2A>  
  
- <xref:System.Windows.Freezable.FreezeCore%2A>  
  
 <span data-ttu-id="ec457-184">Также необходимо соблюдать следующие правила для доступа и записи на данные-члены, которые не являются свойствами зависимостей:</span><span class="sxs-lookup"><span data-stu-id="ec457-184">You must also observe the following rules for accessing and writing to data members that are not dependency properties:</span></span>  
  
- <span data-ttu-id="ec457-185">В начале любого [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] , считывает элементы данных не свойство зависимости, вызовите <xref:System.Windows.Freezable.ReadPreamble%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-185">At the beginning of any [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] that reads non-dependency property data members, call the <xref:System.Windows.Freezable.ReadPreamble%2A> method.</span></span>  
  
- <span data-ttu-id="ec457-186">В начале любого API, который записывает элементы данных не свойство зависимости, вызовите <xref:System.Windows.Freezable.WritePreamble%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="ec457-186">At the beginning of any API that writes non-dependency property data members, call the <xref:System.Windows.Freezable.WritePreamble%2A> method.</span></span> <span data-ttu-id="ec457-187">(После вызова <xref:System.Windows.Freezable.WritePreamble%2A> в интерфейсе API, не требуется дополнительный вызов к <xref:System.Windows.Freezable.ReadPreamble%2A> также считывать элементы данных не свойство зависимости.)</span><span class="sxs-lookup"><span data-stu-id="ec457-187">(Once you've called <xref:System.Windows.Freezable.WritePreamble%2A> in an API, you don't need to make an additional call to <xref:System.Windows.Freezable.ReadPreamble%2A> if you also read non-dependency property data members.)</span></span>  
  
- <span data-ttu-id="ec457-188">Вызовите <xref:System.Windows.Freezable.WritePostscript%2A> метод перед выходом из методов, которые записывают на данные-члены не свойство зависимости.</span><span class="sxs-lookup"><span data-stu-id="ec457-188">Call the <xref:System.Windows.Freezable.WritePostscript%2A> method before exiting methods that write to non-dependency property data members.</span></span>  
  
 <span data-ttu-id="ec457-189">Если класс содержит члены данных зависимостей свойства, которые являются <xref:System.Windows.DependencyObject> объектов, необходимо также вызвать <xref:System.Windows.Freezable.OnFreezablePropertyChanged%2A> метод каждый раз при изменении одного из их значения, даже если вы изменяете член `null`.</span><span class="sxs-lookup"><span data-stu-id="ec457-189">If your class contains non-dependency-property data members that are <xref:System.Windows.DependencyObject> objects, you must also call the <xref:System.Windows.Freezable.OnFreezablePropertyChanged%2A> method each time you change one of their values, even if you're setting the member to `null`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec457-190">Очень важно, что началом реализации каждого <xref:System.Windows.Freezable> метод можно переопределить с помощью вызова к базовой реализации.</span><span class="sxs-lookup"><span data-stu-id="ec457-190">It's very important that you begin each <xref:System.Windows.Freezable> method you override with a call to the base implementation.</span></span>  
  
 <span data-ttu-id="ec457-191">Пример настраиваемого <xref:System.Windows.Freezable> , представлена в разделе [пример пользовательского](https://go.microsoft.com/fwlink/?LinkID=159981).</span><span class="sxs-lookup"><span data-stu-id="ec457-191">For an example of a custom <xref:System.Windows.Freezable> class, see the [Custom Animation Sample](https://go.microsoft.com/fwlink/?LinkID=159981).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ec457-192">См. также</span><span class="sxs-lookup"><span data-stu-id="ec457-192">See also</span></span>

- <xref:System.Windows.Freezable>
- [<span data-ttu-id="ec457-193">Пример пользовательской анимации</span><span class="sxs-lookup"><span data-stu-id="ec457-193">Custom Animation Sample</span></span>](https://go.microsoft.com/fwlink/?LinkID=159981)
- [<span data-ttu-id="ec457-194">Общие сведения о свойствах зависимости</span><span class="sxs-lookup"><span data-stu-id="ec457-194">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="ec457-195">Пользовательские свойства зависимостей</span><span class="sxs-lookup"><span data-stu-id="ec457-195">Custom Dependency Properties</span></span>](custom-dependency-properties.md)
