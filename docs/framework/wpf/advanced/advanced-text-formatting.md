---
title: Дополнительное форматирование текста
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- formatting [WPF]
- text [WPF]
- typography [WPF], text formatting
ms.assetid: f0a7986e-f5b2-485c-a27d-f8e922022212
ms.openlocfilehash: 26ee3c2b8a431200c3dc04130deb2247b6c1446d
ms.sourcegitcommit: 011314e0c8eb4cf4a11d92078f58176c8c3efd2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/09/2020
ms.locfileid: "77095246"
---
# <a name="advanced-text-formatting"></a><span data-ttu-id="00cd1-102">Дополнительное форматирование текста</span><span class="sxs-lookup"><span data-stu-id="00cd1-102">Advanced Text Formatting</span></span>
<span data-ttu-id="00cd1-103">Windows Presentation Foundation (WPF) предоставляет надежный набор интерфейсов API для включения текста в приложение.</span><span class="sxs-lookup"><span data-stu-id="00cd1-103">Windows Presentation Foundation (WPF) provides a robust set of APIs for including text in your application.</span></span> <span data-ttu-id="00cd1-104">Интерфейсы API макета и [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], такие как <xref:System.Windows.Controls.TextBlock>, предоставляют наиболее распространенные и общие элементы для представления текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-104">Layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] APIs, such as <xref:System.Windows.Controls.TextBlock>, provide the most common and general-use elements for text presentation.</span></span> <span data-ttu-id="00cd1-105">API-интерфейсы рисования, такие как <xref:System.Windows.Media.GlyphRunDrawing> и <xref:System.Windows.Media.FormattedText>, предоставляют средства для включения форматированного текста в рисунки.</span><span class="sxs-lookup"><span data-stu-id="00cd1-105">Drawing APIs, such as <xref:System.Windows.Media.GlyphRunDrawing> and <xref:System.Windows.Media.FormattedText>, provide a means for including formatted text in drawings.</span></span> <span data-ttu-id="00cd1-106">На самом продвинутом уровне WPF предоставляет расширяемый механизм форматирования текста для управления всеми аспектами представления текста, такими как управление хранилищем текста, управление форматированием текста и управление внедренными объектами.</span><span class="sxs-lookup"><span data-stu-id="00cd1-106">At the most advanced level, WPF provides an extensible text formatting engine to control every aspect of text presentation, such as text store management, text run formatting management, and embedded object management.</span></span>  
  
 <span data-ttu-id="00cd1-107">В этом разделе приводятся общие сведения о форматировании текста WPF.</span><span class="sxs-lookup"><span data-stu-id="00cd1-107">This topic provides an introduction to WPF text formatting.</span></span> <span data-ttu-id="00cd1-108">Основное внимание уделяется реализации клиента и использованию механизма форматирования текста WPF.</span><span class="sxs-lookup"><span data-stu-id="00cd1-108">It focuses on client implementation and use of the WPF text formatting engine.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="00cd1-109">Все примеры кода в этом документе можно найти в [примере расширенного форматирования текста](https://github.com/Microsoft/WPF-Samples/tree/master/PerMonitorDPI/TextFormatting).</span><span class="sxs-lookup"><span data-stu-id="00cd1-109">All code examples within this document can be found in the [Advanced Text Formatting Sample](https://github.com/Microsoft/WPF-Samples/tree/master/PerMonitorDPI/TextFormatting).</span></span>  

<a name="prereq"></a>   
## <a name="prerequisites"></a><span data-ttu-id="00cd1-110">предварительные требования</span><span class="sxs-lookup"><span data-stu-id="00cd1-110">Prerequisites</span></span>  
 <span data-ttu-id="00cd1-111">В этом разделе предполагается, что вы знакомы с интерфейсами API более высокого уровня, используемыми для представления текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-111">This topic assumes that you are familiar with the higher level APIs used for text presentation.</span></span> <span data-ttu-id="00cd1-112">Большинство пользовательских сценариев не потребует дополнительных интерфейсов API форматирования текста, обсуждаемых в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="00cd1-112">Most user scenarios will not require the advanced text formatting APIs discussed in this topic.</span></span> <span data-ttu-id="00cd1-113">Общие сведения о различных текстовых интерфейсах API см. [в разделе документы в WPF](documents-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="00cd1-113">For an introduction to the different text APIs, see [Documents in WPF](documents-in-wpf.md).</span></span>  
  
<a name="section1"></a>   
## <a name="advanced-text-formatting"></a><span data-ttu-id="00cd1-114">Дополнительное форматирование текста</span><span class="sxs-lookup"><span data-stu-id="00cd1-114">Advanced Text Formatting</span></span>  
 <span data-ttu-id="00cd1-115">Элементы управления "макет текста" и "[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" в WPF предоставляют свойства форматирования, позволяющие легко включать в приложение форматированный текст.</span><span class="sxs-lookup"><span data-stu-id="00cd1-115">The text layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] controls in WPF provide formatting properties that allow you to easily include formatted text in your application.</span></span> <span data-ttu-id="00cd1-116">Эти элементы управления предоставляют ряд свойств для обработки представления текста, включая гарнитуру, размер и цвет.</span><span class="sxs-lookup"><span data-stu-id="00cd1-116">These controls expose a number of properties to handle the presentation of text, which includes its typeface, size, and color.</span></span> <span data-ttu-id="00cd1-117">В обычных условиях эти элементы управления могут обрабатывать большинство вариантов представления текста в приложении.</span><span class="sxs-lookup"><span data-stu-id="00cd1-117">Under ordinary circumstances, these controls can handle the majority of text presentation in your application.</span></span> <span data-ttu-id="00cd1-118">Тем не менее некоторые расширенные сценарии требуют управления хранением текста, а также его представлением.</span><span class="sxs-lookup"><span data-stu-id="00cd1-118">However, some advanced scenarios require the control of text storage as well as text presentation.</span></span> <span data-ttu-id="00cd1-119">WPF предоставляет расширяемый механизм форматирования текста для этой цели.</span><span class="sxs-lookup"><span data-stu-id="00cd1-119">WPF provides an extensible text formatting engine for this purpose.</span></span>  
  
 <span data-ttu-id="00cd1-120">Расширенные возможности форматирования текста в WPF состоят из подсистемы форматирования текста, хранилища текста, текстовых запусков и свойств форматирования.</span><span class="sxs-lookup"><span data-stu-id="00cd1-120">The advanced text formatting features found in WPF consist of a text formatting engine, a text store, text runs, and formatting properties.</span></span> <span data-ttu-id="00cd1-121">Обработчик форматирования текста <xref:System.Windows.Media.TextFormatting.TextFormatter>создает строки текста, используемые для представления.</span><span class="sxs-lookup"><span data-stu-id="00cd1-121">The text formatting engine, <xref:System.Windows.Media.TextFormatting.TextFormatter>, creates lines of text to be used for presentation.</span></span> <span data-ttu-id="00cd1-122">Это достигается путем инициации процесса форматирования строк и вызова <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>модуля форматирования текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-122">This is achieved by initiating the line formatting process and calling the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span></span> <span data-ttu-id="00cd1-123">Модуль форматирования текста получает текстовые фрагменты из хранилища текста, вызывая метод <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> хранилища.</span><span class="sxs-lookup"><span data-stu-id="00cd1-123">The text formatter retrieves text runs from your text store by calling the store's <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="00cd1-124">Затем <xref:System.Windows.Media.TextFormatting.TextRun> объекты формируются в <xref:System.Windows.Media.TextFormatting.TextLine> объекты модулем форматирования текста и передаются в приложение для проверки или вывода.</span><span class="sxs-lookup"><span data-stu-id="00cd1-124">The <xref:System.Windows.Media.TextFormatting.TextRun> objects are then formed into <xref:System.Windows.Media.TextFormatting.TextLine> objects by the text formatter and given to your application for inspection or display.</span></span>  
  
<a name="section2"></a>   
## <a name="using-the-text-formatter"></a><span data-ttu-id="00cd1-125">Использование модуля форматирования текста</span><span class="sxs-lookup"><span data-stu-id="00cd1-125">Using the Text Formatter</span></span>  
 <span data-ttu-id="00cd1-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> является подсистемой форматирования текста WPF и предоставляет службы для форматирования и разбиения текстовых строк.</span><span class="sxs-lookup"><span data-stu-id="00cd1-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> is the WPF text formatting engine and provides services for formatting and breaking text lines.</span></span> <span data-ttu-id="00cd1-127">Модуль форматирования текста может обрабатывать различные форматы текстовых символов и стили абзацев и включает поддержку международного макета текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-127">The text formatter can handle different text character formats and paragraph styles, and includes support for international text layout.</span></span>  
  
 <span data-ttu-id="00cd1-128">В отличие от традиционного текстового API, <xref:System.Windows.Media.TextFormatting.TextFormatter> взаимодействует с клиентом макета текста через набор методов обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="00cd1-128">Unlike a traditional text API, the <xref:System.Windows.Media.TextFormatting.TextFormatter> interacts with a text layout client through a set of callback methods.</span></span> <span data-ttu-id="00cd1-129">Он требует, чтобы клиент предоставил эти методы в реализации класса <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-129">It requires the client to provide these methods in an implementation of the <xref:System.Windows.Media.TextFormatting.TextSource> class.</span></span> <span data-ttu-id="00cd1-130">На следующей схеме показано взаимодействие макета текста между клиентским приложением и <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-130">The following diagram illustrates the text layout interaction between the client application and <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span></span>  
  
 ![Схема клиента структуры текста и TextFormatter](./media/advanced-text-formatting/text-layout-textformatter-interaction.png)  
  
 <span data-ttu-id="00cd1-132">Модуль форматирования текста используется для извлечения форматированных текстовых строк из хранилища текста, что является реализацией <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-132">The text formatter is used to retrieve formatted text lines from the text store, which is an implementation of <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="00cd1-133">Для этого сначала создается экземпляр модуля форматирования текста с помощью метода <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-133">This is done by first creating an instance of the text formatter by using the <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A> method.</span></span> <span data-ttu-id="00cd1-134">Этот метод создает экземпляр модуля форматирования текста и задает максимальные значения высоты и ширины строки.</span><span class="sxs-lookup"><span data-stu-id="00cd1-134">This method creates an instance of the text formatter and sets the maximum line height and width values.</span></span> <span data-ttu-id="00cd1-135">Как только экземпляр модуля форматирования текста будет создан, процесс создания строки начнется с вызова метода <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-135">As soon as an instance of the text formatter is created, the line creation process is started by calling the <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span> <span data-ttu-id="00cd1-136"><xref:System.Windows.Media.TextFormatting.TextFormatter> выполняет обратный вызов к источнику текста, чтобы получить текст и параметры форматирования для фрагментов текста, образующих строку.</span><span class="sxs-lookup"><span data-stu-id="00cd1-136"><xref:System.Windows.Media.TextFormatting.TextFormatter> calls back to the text source to retrieve the text and formatting parameters for the runs of text that form a line.</span></span>  
  
 <span data-ttu-id="00cd1-137">В следующем примере показан процесс форматирования хранилища текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-137">In the following example, the process of formatting a text store is shown.</span></span> <span data-ttu-id="00cd1-138">Объект <xref:System.Windows.Media.TextFormatting.TextFormatter> используется для получения текстовых строк из хранилища текста и последующего форматирования текстовой строки для рисования в <xref:System.Windows.Media.DrawingContext>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-138">The <xref:System.Windows.Media.TextFormatting.TextFormatter> object is used to retrieve text lines from the text store and then format the text line for drawing into the <xref:System.Windows.Media.DrawingContext>.</span></span>  
  
 [!code-csharp[TextFormatterExample#100](~/samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/Window1.xaml.cs#100)]
 [!code-vb[TextFormatterExample#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/Window1.xaml.vb#100)]  
  
<a name="section3"></a>   
## <a name="implementing-the-client-text-store"></a><span data-ttu-id="00cd1-139">Реализация клиентского хранилища текста</span><span class="sxs-lookup"><span data-stu-id="00cd1-139">Implementing the Client Text Store</span></span>  
 <span data-ttu-id="00cd1-140">При расширении механизма форматирования текста необходимо реализовать все аспекты хранилища текста и управлять ими.</span><span class="sxs-lookup"><span data-stu-id="00cd1-140">When you extend the text formatting engine, you are required to implement and manage all aspects of the text store.</span></span> <span data-ttu-id="00cd1-141">Это довольно сложная задача.</span><span class="sxs-lookup"><span data-stu-id="00cd1-141">This is not a trivial task.</span></span> <span data-ttu-id="00cd1-142">Хранилище текста отвечает за отслеживание свойств фрагментов текста, свойств абзаца, встроенных объектов и других подобных элементов.</span><span class="sxs-lookup"><span data-stu-id="00cd1-142">The text store is responsible for tracking text run properties, paragraph properties, embedded objects, and other similar content.</span></span> <span data-ttu-id="00cd1-143">Он также предоставляет модуль форматирования текста с отдельными <xref:System.Windows.Media.TextFormatting.TextRun> объектами, которые модуль форматирования текста использует для создания объектов <xref:System.Windows.Media.TextFormatting.TextLine>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-143">It also provides the text formatter with individual <xref:System.Windows.Media.TextFormatting.TextRun> objects which the text formatter uses to create <xref:System.Windows.Media.TextFormatting.TextLine> objects.</span></span>  
  
 <span data-ttu-id="00cd1-144">Чтобы обрабатывать виртуализацию хранилища текста, хранилище текста должно быть производным от <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-144">To handle the virtualization of the text store, the text store must be derived from <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="00cd1-145"><xref:System.Windows.Media.TextFormatting.TextSource> определяет метод, используемый модулем форматирования текста для извлечения текстовых запусков из хранилища текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-145"><xref:System.Windows.Media.TextFormatting.TextSource> defines the method the text formatter uses to retrieve text runs from the text store.</span></span> <span data-ttu-id="00cd1-146"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> — это метод, используемый модулем форматирования текста для извлечения текстовых запусков, используемых в форматировании строк.</span><span class="sxs-lookup"><span data-stu-id="00cd1-146"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is the method used by the text formatter to retrieve text runs used in line formatting.</span></span> <span data-ttu-id="00cd1-147">Вызов <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> многократно выполняется модулем форматирования текста, пока не произойдет одно из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="00cd1-147">The call to <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is repeatedly made by the text formatter until one of the following conditions occurs:</span></span>  
  
- <span data-ttu-id="00cd1-148">Возвращается <xref:System.Windows.Media.TextFormatting.TextEndOfLine> или подкласс.</span><span class="sxs-lookup"><span data-stu-id="00cd1-148">A <xref:System.Windows.Media.TextFormatting.TextEndOfLine> or a subclass is returned.</span></span>  
  
- <span data-ttu-id="00cd1-149">Суммарная ширина выполнения текста превышает максимальную ширину линии, указанную в вызове для создания модуля форматирования текста или вызова метода <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> модуля форматирования текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-149">The accumulated width of text runs exceeds the maximum line width specified in either the call to create the text formatter or the call to the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span>  
  
- <span data-ttu-id="00cd1-150">Возвращается последовательность символов новой строки в Юникоде, например "CF", "LF" или "CRLF".</span><span class="sxs-lookup"><span data-stu-id="00cd1-150">A Unicode newline sequence, such as "CF", "LF", or "CRLF", is returned.</span></span>  
  
<a name="section4"></a>   
## <a name="providing-text-runs"></a><span data-ttu-id="00cd1-151">Предоставление фрагментов текста</span><span class="sxs-lookup"><span data-stu-id="00cd1-151">Providing Text Runs</span></span>  
 <span data-ttu-id="00cd1-152">Ядром процесса форматирования текста является взаимодействие между модулем форматирования текста и хранилищем текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-152">The core of the text formatting process is the interaction between the text formatter and the text store.</span></span> <span data-ttu-id="00cd1-153">Ваша реализация <xref:System.Windows.Media.TextFormatting.TextSource> предоставляет модуль форматирования текста с объектами <xref:System.Windows.Media.TextFormatting.TextRun> и свойствами, используемыми для форматирования текстовых запусков.</span><span class="sxs-lookup"><span data-stu-id="00cd1-153">Your implementation of <xref:System.Windows.Media.TextFormatting.TextSource> provides the text formatter with the <xref:System.Windows.Media.TextFormatting.TextRun> objects and the properties with which to format the text runs.</span></span> <span data-ttu-id="00cd1-154">Это взаимодействие обрабатывается методом <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>, который вызывается модулем форматирования текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-154">This interaction is handled by the <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method, which is called by the text formatter.</span></span>  
  
 <span data-ttu-id="00cd1-155">В следующей таблице показаны некоторые предопределенные объекты <xref:System.Windows.Media.TextFormatting.TextRun>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-155">The following table shows some of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects.</span></span>  
  
|<span data-ttu-id="00cd1-156">Тип TextRun</span><span class="sxs-lookup"><span data-stu-id="00cd1-156">TextRun Type</span></span>|<span data-ttu-id="00cd1-157">Использование</span><span class="sxs-lookup"><span data-stu-id="00cd1-157">Usage</span></span>|  
|------------------|-----------|  
|<xref:System.Windows.Media.TextFormatting.TextCharacters>|<span data-ttu-id="00cd1-158">Специализированный фрагмент текста, который используется для передачи представления глифов символов обратно в модуль форматирования текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-158">The specialized text run used to pass a representation of character glyphs back to the text formatter.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEmbeddedObject>|<span data-ttu-id="00cd1-159">Специализированный фрагмент текста, который используется для предоставления содержимого, в котором измерение, проверка нажатия и рисование выполняются в целом (например, кнопка или изображение в тексте).</span><span class="sxs-lookup"><span data-stu-id="00cd1-159">The specialized text run used to provide content in which measuring, hit testing, and drawing is done in whole, such as a button or image within the text.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfLine>|<span data-ttu-id="00cd1-160">Специализированный фрагмент текста, который используется для обозначения конца строки.</span><span class="sxs-lookup"><span data-stu-id="00cd1-160">The specialized text run used to mark the end of a line.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>|<span data-ttu-id="00cd1-161">Специализированный фрагмент текста, который используется для обозначения конца абзаца.</span><span class="sxs-lookup"><span data-stu-id="00cd1-161">The specialized text run used to mark the end of a paragraph.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>|<span data-ttu-id="00cd1-162">Специализированный тестовый запуск, используемый для обозначения конца сегмента, например для завершения области, затронутой предыдущим <xref:System.Windows.Media.TextFormatting.TextModifier>ным запуском.</span><span class="sxs-lookup"><span data-stu-id="00cd1-162">The specialized text run used to mark the end of a segment, such as to end the scope affected by a previous <xref:System.Windows.Media.TextFormatting.TextModifier> run.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextHidden>|<span data-ttu-id="00cd1-163">Специализированный фрагмент текста, который используется для отметки диапазона скрытых символов.</span><span class="sxs-lookup"><span data-stu-id="00cd1-163">The specialized text run used to mark a range of hidden characters.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextModifier>|<span data-ttu-id="00cd1-164">Специализированный фрагмент текста, который используется для изменения свойств фрагментов текста в своей области.</span><span class="sxs-lookup"><span data-stu-id="00cd1-164">The specialized text run used to modify properties of text runs in its scope.</span></span> <span data-ttu-id="00cd1-165">Область расширяется до следующего сопоставления <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> текстового выполнения или следующего <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-165">The scope extends to the next matching <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> text run, or the next <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span></span>|  
  
 <span data-ttu-id="00cd1-166">Любой из предопределенных <xref:System.Windows.Media.TextFormatting.TextRun> объектов может быть подклассом.</span><span class="sxs-lookup"><span data-stu-id="00cd1-166">Any of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects can be subclassed.</span></span> <span data-ttu-id="00cd1-167">Это позволяет источнику текста предоставлять модуль форматирования текста с фрагментами текста, включающими пользовательские данные.</span><span class="sxs-lookup"><span data-stu-id="00cd1-167">This allows your text source to provide the text formatter with text runs that include custom data.</span></span>  
  
 <span data-ttu-id="00cd1-168">В следующем примере демонстрируется метод <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-168">The following example demonstrates a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="00cd1-169">Это хранилище текста возвращает <xref:System.Windows.Media.TextFormatting.TextRun> объектов модулю форматирования текста для обработки.</span><span class="sxs-lookup"><span data-stu-id="00cd1-169">This text store returns <xref:System.Windows.Media.TextFormatting.TextRun> objects to the text formatter for processing.</span></span>  
  
 [!code-csharp[TextFormatterExample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/CustomTextSource.cs#101)]
 [!code-vb[TextFormatterExample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/CustomTextSource.vb#101)]  
  
> [!NOTE]
> <span data-ttu-id="00cd1-170">В этом примере хранилище текста предоставляет одни и те же свойства текста всему тексту.</span><span class="sxs-lookup"><span data-stu-id="00cd1-170">In this example, the text store provides the same text properties to all of the text.</span></span> <span data-ttu-id="00cd1-171">Расширенные хранилища текста могут потребоваться для реализации собственного управления диапазонами, чтобы позволить отдельным символам иметь разные свойства.</span><span class="sxs-lookup"><span data-stu-id="00cd1-171">Advanced text stores would need to implement their own span management to allow individual characters to have different properties.</span></span>  
  
<a name="section5"></a>   
## <a name="specifying-formatting-properties"></a><span data-ttu-id="00cd1-172">Задание свойств форматирования</span><span class="sxs-lookup"><span data-stu-id="00cd1-172">Specifying Formatting Properties</span></span>  
 <span data-ttu-id="00cd1-173"><xref:System.Windows.Media.TextFormatting.TextRun> объекты форматируются с помощью свойств, предоставляемых хранилищем текста.</span><span class="sxs-lookup"><span data-stu-id="00cd1-173"><xref:System.Windows.Media.TextFormatting.TextRun> objects are formatted by using properties provided by the text store.</span></span> <span data-ttu-id="00cd1-174">Эти свойства бывают двух типов: <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> и <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-174">These properties come in two types, <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span></span> <span data-ttu-id="00cd1-175"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> обрабатывайте Инклюзивные свойства абзаца, такие как <xref:System.Windows.TextAlignment> и <xref:System.Windows.FlowDirection>.</span><span class="sxs-lookup"><span data-stu-id="00cd1-175"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> handle paragraph inclusive properties such as <xref:System.Windows.TextAlignment> and <xref:System.Windows.FlowDirection>.</span></span> <span data-ttu-id="00cd1-176"><xref:System.Windows.Media.TextFormatting.TextRunProperties> — это свойства, которые могут различаться для каждого текста, выполняемого в абзаце, например кисть переднего плана, <xref:System.Windows.Media.Typeface>и размера шрифта.</span><span class="sxs-lookup"><span data-stu-id="00cd1-176"><xref:System.Windows.Media.TextFormatting.TextRunProperties> are properties that can be different for each text run within a paragraph, such as foreground brush, <xref:System.Windows.Media.Typeface>, and font size.</span></span> <span data-ttu-id="00cd1-177">Для реализации типов свойств пользовательского абзаца и пользовательского текста приложение должно создавать классы, производные от <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> и <xref:System.Windows.Media.TextFormatting.TextRunProperties> соответственно.</span><span class="sxs-lookup"><span data-stu-id="00cd1-177">To implement custom paragraph and custom text run property types, your application must create classes that derive from <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties> respectively.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="00cd1-178">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="00cd1-178">See also</span></span>

- [<span data-ttu-id="00cd1-179">Оформление в WPF</span><span class="sxs-lookup"><span data-stu-id="00cd1-179">Typography in WPF</span></span>](typography-in-wpf.md)
- [<span data-ttu-id="00cd1-180">Документы в WPF</span><span class="sxs-lookup"><span data-stu-id="00cd1-180">Documents in WPF</span></span>](documents-in-wpf.md)
