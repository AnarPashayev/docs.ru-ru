---
title: Ресурсы и код
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: d36d30dd336bbe50b192b10a6a60d2c7e382adb8
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59137713"
---
# <a name="resources-and-code"></a><span data-ttu-id="ad49a-102">Ресурсы и код</span><span class="sxs-lookup"><span data-stu-id="ad49a-102">Resources and Code</span></span>
<span data-ttu-id="ad49a-103">Этот обзор посвящен преимущественно доступу к ресурсам [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] и их созданию с использованием кода, а не синтаксиса [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ad49a-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="ad49a-104">Дополнительные сведения об общем использовании ресурсов и ресурсах с точки зрения синтаксиса [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] см. в разделе [Ресурсы XAML](xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="ad49a-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="ad49a-105">Доступ к ресурсам из кода</span><span class="sxs-lookup"><span data-stu-id="ad49a-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="ad49a-106">Ключи, идентифицирующие ресурсы, если они определены через [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], также используются для извлечения определенных ресурсов при запросе ресурса из кода.</span><span class="sxs-lookup"><span data-stu-id="ad49a-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="ad49a-107">Самый простой способ извлечения ресурса из кода является вызов либо <xref:System.Windows.FrameworkElement.FindResource%2A> или <xref:System.Windows.FrameworkElement.TryFindResource%2A> метода из объектов уровня среды приложения.</span><span class="sxs-lookup"><span data-stu-id="ad49a-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="ad49a-108">Различие между этими методами проявляется, если запрошенный ключ не найден.</span><span class="sxs-lookup"><span data-stu-id="ad49a-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="ad49a-109"><xref:System.Windows.FrameworkElement.FindResource%2A> приводит к появлению исключения; <xref:System.Windows.FrameworkElement.TryFindResource%2A> не вызовут исключения, но возвращает `null`.</span><span class="sxs-lookup"><span data-stu-id="ad49a-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="ad49a-110">Каждый из этих методов принимает ключ ресурса в качестве входного параметра и возвращает объект со слабой типизацией.</span><span class="sxs-lookup"><span data-stu-id="ad49a-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="ad49a-111">Как правило, ключ ресурса является строкой, но иногда используются и нестроковые ключи. Подробнее см. в разделе [Использование объектов в качестве ключей](#objectaskey).</span><span class="sxs-lookup"><span data-stu-id="ad49a-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="ad49a-112">Как правило, возвращаемый объект приводится к типу, необходимому для свойства, которое устанавливается при запросе ресурса.</span><span class="sxs-lookup"><span data-stu-id="ad49a-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="ad49a-113">Логика поиска разрешения ресурса кода такая же, как и в случае динамической ссылки на ресурс [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ad49a-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="ad49a-114">Поиск ресурсов начинается с вызывающего элемента, затем продолжается в последовательных родительских элементах в логическом дереве.</span><span class="sxs-lookup"><span data-stu-id="ad49a-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="ad49a-115">При необходимости поиск продолжается в ресурсах приложений, темах и системных ресурсах.</span><span class="sxs-lookup"><span data-stu-id="ad49a-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="ad49a-116">Запрос кода для ресурса будет правильно учитывать изменения во время выполнения в словарях ресурсов, которые могли быть сделаны после загрузки данного словаря из [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], а также изменения системных ресурсов в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="ad49a-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="ad49a-117">Ниже приведен пример кода, который находит ресурс по ключу и использует возвращаемое значение, чтобы задать свойство, реализованы в виде <xref:System.Windows.Controls.Primitives.ButtonBase.Click> обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="ad49a-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="ad49a-118">Альтернативный метод для назначения является ссылкой на ресурс является <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="ad49a-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="ad49a-119">Этот метод принимает два параметра — ключ ресурса и идентификатор конкретного свойства зависимостей из экземпляра элемента, которому должно быть присвоено значение ресурса.</span><span class="sxs-lookup"><span data-stu-id="ad49a-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="ad49a-120">Функционально этот метод аналогичен, но имеет преимущество в том плане, что не требует приведения возвращаемых значений.</span><span class="sxs-lookup"><span data-stu-id="ad49a-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="ad49a-121">Еще одним способом программного доступа к ресурсам является доступ к содержимому <xref:System.Windows.FrameworkElement.Resources%2A> свойство как словарь.</span><span class="sxs-lookup"><span data-stu-id="ad49a-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="ad49a-122">Доступ к словарю, содержащемуся в этом свойстве, включает добавление новых ресурсов в существующие коллекции, проверку оригинальности имени ключа в коллекции, а также другие операции со словарем/коллекцией.</span><span class="sxs-lookup"><span data-stu-id="ad49a-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="ad49a-123">Если вы создаете [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] приложения полностью в коде, можно также создать всю коллекцию в коде, присвоить ей ключи и затем присвоить законченную коллекцию для <xref:System.Windows.FrameworkElement.Resources%2A> свойство установленного элемента.</span><span class="sxs-lookup"><span data-stu-id="ad49a-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="ad49a-124">Это будет описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="ad49a-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="ad49a-125">Можно индексировать любую заданную <xref:System.Windows.FrameworkElement.Resources%2A> коллекцию, используя указанный ключ индекса, но следует иметь в виду, что доступ к ресурсу таким образом не соответствует обычным правилам времени выполнения для разрешения ресурса.</span><span class="sxs-lookup"><span data-stu-id="ad49a-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="ad49a-126">У вас будет только доступ к этой конкретной коллекции.</span><span class="sxs-lookup"><span data-stu-id="ad49a-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="ad49a-127">Поиск ресурсов не будет пересекать область действия корня или приложения, если в запрашиваемом ключе не найден действительный объект.</span><span class="sxs-lookup"><span data-stu-id="ad49a-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="ad49a-128">Тем не менее в некоторых случаях этот подход может иметь преимущество в производительности, поскольку область поиска ключа более ограничена.</span><span class="sxs-lookup"><span data-stu-id="ad49a-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="ad49a-129">См. в разделе <xref:System.Windows.ResourceDictionary> Дополнительные сведения о том, как работать со словарями ресурсов напрямую.</span><span class="sxs-lookup"><span data-stu-id="ad49a-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="ad49a-130">Создание ресурсов с помощью кода</span><span class="sxs-lookup"><span data-stu-id="ad49a-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="ad49a-131">Пи создании приложения [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] полностью в коде может также понадобиться создать в коде все ресурсы в этом приложении.</span><span class="sxs-lookup"><span data-stu-id="ad49a-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="ad49a-132">Чтобы добиться этого, создайте новый <xref:System.Windows.ResourceDictionary> экземпляра, а затем добавьте все ресурсы в словарь, с помощью последовательных вызовов <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ad49a-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ad49a-133">Затем с помощью <xref:System.Windows.ResourceDictionary> созданный таким образом, чтобы задать <xref:System.Windows.FrameworkElement.Resources%2A> свойство на элементе, который присутствует в области страницы, или <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ad49a-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ad49a-134">Можно также хранить <xref:System.Windows.ResourceDictionary> как с автономным объектом, не добавляя ее к элементу.</span><span class="sxs-lookup"><span data-stu-id="ad49a-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="ad49a-135">Однако в этом случае для доступа к ресурсам внутри него потребуется ключ элемента, как для общего словаря.</span><span class="sxs-lookup"><span data-stu-id="ad49a-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="ad49a-136">Объект <xref:System.Windows.ResourceDictionary> , не присоединенные к элементу `Resources` свойство не будет существовать как часть дерева элементов и не имел бы области в последовательности поиска, которая может использоваться <xref:System.Windows.FrameworkElement.FindResource%2A> и связанными методами.</span><span class="sxs-lookup"><span data-stu-id="ad49a-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="ad49a-137">Использование объектов в качестве ключей</span><span class="sxs-lookup"><span data-stu-id="ad49a-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="ad49a-138">В большинстве случаев использования ресурса ключ ресурса устанавливается в виде строки.</span><span class="sxs-lookup"><span data-stu-id="ad49a-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="ad49a-139">Однако различные функции [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] намеренно не используют строковый тип для указания ключей, вместо этого параметр является объектом.</span><span class="sxs-lookup"><span data-stu-id="ad49a-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="ad49a-140">Возможность доступа объекта к ресурсу по ключу используется в поддержке стилей и тем [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ad49a-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="ad49a-141">Стили в темах, которые становятся стилем по умолчанию для элемента управления без стиля по ключу с <xref:System.Type> элемента управления, они должны применяться.</span><span class="sxs-lookup"><span data-stu-id="ad49a-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="ad49a-142">Ввод с помощью ключа по типу обеспечивает надежный механизм поиска, который работает со стандартными экземплярами каждого типа элемента управления, а тип может быть обнаружен отражением и использоваться для создания стилей производных классов, даже если у производного типа нет стиля по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ad49a-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="ad49a-143">Можно указать <xref:System.Type> ключей для ресурса, определенного в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] с помощью [расширение разметки x: Type](../../xaml-services/x-type-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="ad49a-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="ad49a-144">Аналогичные расширения существуют для других случаев использования нестрокового ключа, поддерживающих функции [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], такие как [Расширение разметки ComponentResourceKey](componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="ad49a-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ad49a-145">См. также</span><span class="sxs-lookup"><span data-stu-id="ad49a-145">See also</span></span>

- [<span data-ttu-id="ad49a-146">Ресурсы XAML</span><span class="sxs-lookup"><span data-stu-id="ad49a-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="ad49a-147">Стилизация и использование шаблонов</span><span class="sxs-lookup"><span data-stu-id="ad49a-147">Styling and Templating</span></span>](../controls/styling-and-templating.md)
