---
title: События изменения свойств
ms.date: 03/30/2017
helpviewer_keywords:
- dependency properties [WPF], change events
- property value changes [WPF]
- change events [WPF], property
- events [WPF], change in property values
- creating property triggers [WPF]
- property change events [WPF], types of
- property change events [WPF]
- property triggers [WPF]
- identifying changed property events [WPF]
- property triggers [WPF], definition of
ms.assetid: 0a7989df-9674-4cc1-bc50-5d8ef5d9c055
ms.openlocfilehash: 68be4c6bf7cce8a3aeb928e1f0b0e8131263320c
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73459346"
---
# <a name="property-change-events"></a><span data-ttu-id="0e455-102">События изменения свойств</span><span class="sxs-lookup"><span data-stu-id="0e455-102">Property Change Events</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="0e455-103">определяет несколько событий, которые возникают в ответ на изменение значения свойства.</span><span class="sxs-lookup"><span data-stu-id="0e455-103">defines several events that are raised in response to a change in the value of a property.</span></span> <span data-ttu-id="0e455-104">Часто этим свойством является свойство зависимостей.</span><span class="sxs-lookup"><span data-stu-id="0e455-104">Often the property is a dependency property.</span></span> <span data-ttu-id="0e455-105">Само событие иногда является перенаправленным событием и иногда является стандартным событием среды CLR.</span><span class="sxs-lookup"><span data-stu-id="0e455-105">The event itself is sometimes a routed event and is sometimes a standard common language runtime (CLR) event.</span></span> <span data-ttu-id="0e455-106">Определение события зависит от сценария, так как некоторые изменения свойств лучше перенаправлять через дерево элементов, тогда как другие в основном влияют только на объект, в котором это свойство изменено.</span><span class="sxs-lookup"><span data-stu-id="0e455-106">The definition of the event varies depending on the scenario, because some property changes are more appropriately routed through an element tree, whereas other property changes are generally only of concern to the object where the property changed.</span></span>  
  
## <a name="identifying-a-property-change-event"></a><span data-ttu-id="0e455-107">Определение события изменения свойства</span><span class="sxs-lookup"><span data-stu-id="0e455-107">Identifying a Property Change Event</span></span>  
 <span data-ttu-id="0e455-108">Не все события, сообщающие об изменении свойства, явным образом определяются как событие изменения свойства на основании шаблона сигнатуры или именования.</span><span class="sxs-lookup"><span data-stu-id="0e455-108">Not all events that report a property change are explicitly identified as a property changed event, either by virtue of a signature pattern or a naming pattern.</span></span> <span data-ttu-id="0e455-109">Как правило, описание события в документации по пакету SDK указывает, привязано ли событие непосредственно к изменению значения свойства и предоставляет перекрестные ссылки между свойством и событием.</span><span class="sxs-lookup"><span data-stu-id="0e455-109">Generally, the description of the event in the SDK documentation indicates whether the event is directly tied to a property value change and provides cross-references between the property and event.</span></span>  
  
### <a name="routedpropertychanged-events"></a><span data-ttu-id="0e455-110">События RoutedPropertyChanged</span><span class="sxs-lookup"><span data-stu-id="0e455-110">RoutedPropertyChanged Events</span></span>  
 <span data-ttu-id="0e455-111">Некоторые события используют тип данных события и делегат, которые явно используются для событий изменения свойств.</span><span class="sxs-lookup"><span data-stu-id="0e455-111">Certain events use an event data type and delegate that are explicitly used for property change events.</span></span> <span data-ttu-id="0e455-112">Тип данных события — <xref:System.Windows.RoutedPropertyChangedEventArgs%601>, а делегат — <xref:System.Windows.RoutedPropertyChangedEventHandler%601>.</span><span class="sxs-lookup"><span data-stu-id="0e455-112">The event data type is <xref:System.Windows.RoutedPropertyChangedEventArgs%601>, and the delegate is <xref:System.Windows.RoutedPropertyChangedEventHandler%601>.</span></span> <span data-ttu-id="0e455-113">Данные события и делегат имеют параметр универсального типа, который используется для указания фактического типа изменяющегося свойства при определении обработчика.</span><span class="sxs-lookup"><span data-stu-id="0e455-113">The event data and delegate both have a generic type parameter that is used to specify the actual type of the changing property when you define the handler.</span></span> <span data-ttu-id="0e455-114">Данные события содержат два свойства: <xref:System.Windows.RoutedPropertyChangedEventArgs%601.OldValue%2A> и <xref:System.Windows.RoutedPropertyChangedEventArgs%601.NewValue%2A>, которые затем передаются как аргумент типа в данных события.</span><span class="sxs-lookup"><span data-stu-id="0e455-114">The event data contains two properties, <xref:System.Windows.RoutedPropertyChangedEventArgs%601.OldValue%2A> and <xref:System.Windows.RoutedPropertyChangedEventArgs%601.NewValue%2A>, which are both then passed as the type argument in the event data.</span></span>  
  
 <span data-ttu-id="0e455-115">"Перенаправляемая" часть имени указывает, что событие изменения свойства зарегистрировано как перенаправляемое событие.</span><span class="sxs-lookup"><span data-stu-id="0e455-115">The "Routed" part of the name indicates that the property changed event is registered as a routed event.</span></span> <span data-ttu-id="0e455-116">Преимуществом перенаправления события изменения свойства является то, что верхний уровень элемента управления может получать события изменения свойств, если свойства дочерних элементов (составные части элемента управления) изменяют значения.</span><span class="sxs-lookup"><span data-stu-id="0e455-116">The advantage of routing a property changed event is that the top level of a control can receive property changed events if properties on the child elements (the control's composite parts) change values.</span></span> <span data-ttu-id="0e455-117">Например, можно создать элемент управления, включающий в себя <xref:System.Windows.Controls.Primitives.RangeBase>ный элемент управления, например <xref:System.Windows.Controls.Slider>.</span><span class="sxs-lookup"><span data-stu-id="0e455-117">For instance, you might create a control that incorporates a <xref:System.Windows.Controls.Primitives.RangeBase> control such as a <xref:System.Windows.Controls.Slider>.</span></span> <span data-ttu-id="0e455-118">Если значение свойства <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> меняется в части ползунка, может потребоваться обработать это изменение в родительском элементе управления, а не в части.</span><span class="sxs-lookup"><span data-stu-id="0e455-118">If the value of the <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> property changes on the slider part, you might want to handle that change on the parent control rather than on the part.</span></span>  
  
 <span data-ttu-id="0e455-119">Поскольку имеется старое и новое значение, то может казаться заманчивым использовать этот обработчик событий в качестве проверяющего элемента управления для значения свойства.</span><span class="sxs-lookup"><span data-stu-id="0e455-119">Because you have an old value and a new value, it might be tempting to use this event handler as a validator for the property value.</span></span> <span data-ttu-id="0e455-120">Однако большинство событий изменения свойств создается не для этого.</span><span class="sxs-lookup"><span data-stu-id="0e455-120">However, that is not the design intention of most property changed events.</span></span> <span data-ttu-id="0e455-121">Как правило, предоставляются значения, на основе которых можно действовать в других логических областях кода, но на самом деле изменение значений из обработчика событий не рекомендуется и может привести к непреднамеренной рекурсии в зависимости от реализации обработчика.</span><span class="sxs-lookup"><span data-stu-id="0e455-121">Generally, the values are provided so that you can act on those values in other logic areas of your code, but actually changing the values from within the event handler is not advisable, and may cause unintentional recursion depending on how your handler is implemented.</span></span>  
  
 <span data-ttu-id="0e455-122">Если свойство является пользовательским свойством зависимости или если вы работаете с производным классом, в котором определен код создания экземпляра, существует гораздо более эффективный механизм отслеживания изменений свойств, встроенных в систему свойств [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: свойство Системные обратные вызовы <xref:System.Windows.CoerceValueCallback> и <xref:System.Windows.PropertyChangedCallback>.</span><span class="sxs-lookup"><span data-stu-id="0e455-122">If your property is a custom dependency property, or if you are working with a derived class where you have defined the instantiation code, there is a much better mechanism for tracking property changes that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system: the property system callbacks <xref:System.Windows.CoerceValueCallback> and <xref:System.Windows.PropertyChangedCallback>.</span></span> <span data-ttu-id="0e455-123">Дополнительные сведения об использовании системы свойств [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] для проверки и приведения см. в разделах [Проверка и обратные вызовы свойства зависимостей](dependency-property-callbacks-and-validation.md) и [Пользовательские свойства зависимостей](custom-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="0e455-123">For more details about how you can use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system for validation and coercion, see [Dependency Property Callbacks and Validation](dependency-property-callbacks-and-validation.md) and [Custom Dependency Properties](custom-dependency-properties.md).</span></span>  
  
### <a name="dependencypropertychanged-events"></a><span data-ttu-id="0e455-124">События DependencyPropertyChanged</span><span class="sxs-lookup"><span data-stu-id="0e455-124">DependencyPropertyChanged Events</span></span>  
 <span data-ttu-id="0e455-125">Другой парой типов, которые являются частью сценария события изменения свойства, является <xref:System.Windows.DependencyPropertyChangedEventArgs> и <xref:System.Windows.DependencyPropertyChangedEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="0e455-125">Another pair of types that are part of a property changed event scenario is <xref:System.Windows.DependencyPropertyChangedEventArgs> and <xref:System.Windows.DependencyPropertyChangedEventHandler>.</span></span> <span data-ttu-id="0e455-126">События для этих изменений свойств не маршрутизируются. Это стандартные события CLR.</span><span class="sxs-lookup"><span data-stu-id="0e455-126">Events for these property changes are not routed; they are standard CLR events.</span></span> <span data-ttu-id="0e455-127"><xref:System.Windows.DependencyPropertyChangedEventArgs> — это необычный тип отчетов с данными о событиях, так как он не является производным от <xref:System.EventArgs>; <xref:System.Windows.DependencyPropertyChangedEventArgs> является структурой, а не классом.</span><span class="sxs-lookup"><span data-stu-id="0e455-127"><xref:System.Windows.DependencyPropertyChangedEventArgs> is an unusual event data reporting type because it does not derive from <xref:System.EventArgs>; <xref:System.Windows.DependencyPropertyChangedEventArgs> is a structure, not a class.</span></span>  
  
 <span data-ttu-id="0e455-128">События, использующие <xref:System.Windows.DependencyPropertyChangedEventArgs> и <xref:System.Windows.DependencyPropertyChangedEventHandler>, являются несколько более распространенными, чем события `RoutedPropertyChanged`.</span><span class="sxs-lookup"><span data-stu-id="0e455-128">Events that use <xref:System.Windows.DependencyPropertyChangedEventArgs> and <xref:System.Windows.DependencyPropertyChangedEventHandler> are slightly more common than `RoutedPropertyChanged` events.</span></span> <span data-ttu-id="0e455-129">Примером события, использующего эти типы, является <xref:System.Windows.UIElement.IsMouseCapturedChanged>.</span><span class="sxs-lookup"><span data-stu-id="0e455-129">An example of an event that uses these types is <xref:System.Windows.UIElement.IsMouseCapturedChanged>.</span></span>  
  
 <span data-ttu-id="0e455-130">Как и <xref:System.Windows.RoutedPropertyChangedEventArgs%601>, <xref:System.Windows.DependencyPropertyChangedEventArgs> также сообщает старое и новое значение для свойства.</span><span class="sxs-lookup"><span data-stu-id="0e455-130">Like <xref:System.Windows.RoutedPropertyChangedEventArgs%601>, <xref:System.Windows.DependencyPropertyChangedEventArgs> also reports an old and new value for the property.</span></span> <span data-ttu-id="0e455-131">Аналогично это относится и к тому, что вы можете делать со значениями. Обычно не рекомендуется пытаться снова изменить значения в отправителе в ответ на это событие.</span><span class="sxs-lookup"><span data-stu-id="0e455-131">Also, the same considerations about what you can do with the values apply; it is generally not recommended that you attempt to change the values again on the sender in response to the event.</span></span>  
  
## <a name="property-triggers"></a><span data-ttu-id="0e455-132">Триггеры свойств</span><span class="sxs-lookup"><span data-stu-id="0e455-132">Property Triggers</span></span>  
 <span data-ttu-id="0e455-133">С событием изменения свойств тесно связана другая концепция — триггер свойств.</span><span class="sxs-lookup"><span data-stu-id="0e455-133">A closely related concept to a property changed event is a property trigger.</span></span> <span data-ttu-id="0e455-134">Триггер свойств создается внутри стиля или шаблона и позволяет создавать условное поведение на основе значения свойства, которому назначается триггер.</span><span class="sxs-lookup"><span data-stu-id="0e455-134">A property trigger is created within a style or template and enables you to create a conditional behavior based on the value of the property where the property trigger is assigned.</span></span>  
  
 <span data-ttu-id="0e455-135">У триггера свойств должно быть свойство зависимостей.</span><span class="sxs-lookup"><span data-stu-id="0e455-135">The property for a property trigger must be a dependency property.</span></span> <span data-ttu-id="0e455-136">Оно может быть (и часто является) свойством зависимостей только для чтения.</span><span class="sxs-lookup"><span data-stu-id="0e455-136">It can be (and frequently is) a read-only dependency property.</span></span> <span data-ttu-id="0e455-137">Хорошим указанием на то, что свойство зависимостей, предоставляемое элементом управления, хотя бы частично разработано как триггер свойства, является Is в начале имени свойства.</span><span class="sxs-lookup"><span data-stu-id="0e455-137">A good indicator for when a dependency property exposed by a control is at least partially designed to be a property trigger is if the property name begins with "Is".</span></span> <span data-ttu-id="0e455-138">Свойства с таким именованием часто являются логическим свойством зависимостей только для чтения, а основной сценарий для свойства — предоставление состояния элемента управления, которое может иметь последствия для пользовательского интерфейса реального времени и, следовательно, является кандидатом на роль триггера свойств.</span><span class="sxs-lookup"><span data-stu-id="0e455-138">Properties that have this naming are often a read-only Boolean dependency property where the primary scenario for the property is reporting control state that might have consequences to the real-time UI and is thus a property trigger candidate.</span></span>  
  
 <span data-ttu-id="0e455-139">Некоторые из этих свойств также имеют специальное событие изменения свойства.</span><span class="sxs-lookup"><span data-stu-id="0e455-139">Some of these properties also have a dedicated property changed event.</span></span> <span data-ttu-id="0e455-140">Например, свойство <xref:System.Windows.UIElement.IsMouseCaptured%2A> содержит событие изменения свойства <xref:System.Windows.UIElement.IsMouseCapturedChanged>.</span><span class="sxs-lookup"><span data-stu-id="0e455-140">For instance, the property <xref:System.Windows.UIElement.IsMouseCaptured%2A> has a property changed event <xref:System.Windows.UIElement.IsMouseCapturedChanged>.</span></span> <span data-ttu-id="0e455-141">Само свойство доступно только для чтения, его значение корректируется входной системой, а система ввода <xref:System.Windows.UIElement.IsMouseCapturedChanged> для каждого изменения в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="0e455-141">The property itself is read-only, with its value adjusted by the input system, and the input system raises <xref:System.Windows.UIElement.IsMouseCapturedChanged> on each real-time change.</span></span>  
  
 <span data-ttu-id="0e455-142">По сравнению с истинным событием изменения свойства, использование триггера свойств для реагирования на изменение свойства имеет некоторые ограничения.</span><span class="sxs-lookup"><span data-stu-id="0e455-142">Compared to a true property changed event, using a property trigger to act on a property change has some limitations.</span></span>  
  
 <span data-ttu-id="0e455-143">Триггеры свойств работают через логику точного соответствия.</span><span class="sxs-lookup"><span data-stu-id="0e455-143">Property triggers work through an exact match logic.</span></span> <span data-ttu-id="0e455-144">Укажите свойство и значение, указывающее конкретное значение, для которого будет действовать триггер. Например: `<Setter Property="IsMouseCaptured" Value="true"> ... </Setter>`.</span><span class="sxs-lookup"><span data-stu-id="0e455-144">You specify a property and a value that indicates the specific value for which the trigger will act. For instance: `<Setter Property="IsMouseCaptured" Value="true"> ... </Setter>`.</span></span> <span data-ttu-id="0e455-145">Из-за этого ограничения большая часть триггеров свойств будет использоваться для логических свойств или свойств, которые принимают определенное значение перечисления, когда возможный диапазон значений достаточно управляем, чтобы определить триггер для каждого случая.</span><span class="sxs-lookup"><span data-stu-id="0e455-145">Because of this limitation, the majority of property trigger usages will be for Boolean properties, or properties that take a dedicated enumeration value, where the possible value range is manageable enough to define a trigger for each case.</span></span> <span data-ttu-id="0e455-146">Триггеры свойств могут существовать только для специальных значений, например когда количество элементов достигает нуля, а также нет триггера, который учитывает случаи, когда значение свойства изменяется от нуля (вместо триггеров для всех случаев вам может понадобиться обработчик события кода или поведение по умолчанию, которое снова возвращается из состояния триггера, когда значение отлично от нуля).</span><span class="sxs-lookup"><span data-stu-id="0e455-146">Or property triggers might exist only for special values, such as when an items count reaches zero, and there would be no trigger that accounts for the cases when the property value changes away from zero again (instead of triggers for all cases, you might need a code event handler here, or a default behavior that toggles back from the trigger state again when the value is nonzero).</span></span>  
  
 <span data-ttu-id="0e455-147">Синтаксис триггера свойств аналогичен оператору if в программировании.</span><span class="sxs-lookup"><span data-stu-id="0e455-147">The property trigger syntax is analogous to an "if" statement in programming.</span></span> <span data-ttu-id="0e455-148">Если условие триггера истинно, тогда "тело" триггера свойств "выполняется".</span><span class="sxs-lookup"><span data-stu-id="0e455-148">If the trigger condition is true, then the "body" of the property trigger is "executed".</span></span> <span data-ttu-id="0e455-149">"Тело" триггера свойств является не кодом, а разметкой.</span><span class="sxs-lookup"><span data-stu-id="0e455-149">The "body" of a property trigger is not code, it is markup.</span></span> <span data-ttu-id="0e455-150">Эта разметка ограничена использованием одного или нескольких элементов <xref:System.Windows.Setter> для задания других свойств объекта, к которому применяется стиль или шаблон.</span><span class="sxs-lookup"><span data-stu-id="0e455-150">That markup is limited to using one or more <xref:System.Windows.Setter> elements to set other properties of the object where the style or template is being applied.</span></span>  
  
 <span data-ttu-id="0e455-151">Для смещения условия "If" триггера свойства, имеющего множество возможных значений, обычно рекомендуется установить это же значение свойства в качестве значения по умолчанию с помощью <xref:System.Windows.Setter>.</span><span class="sxs-lookup"><span data-stu-id="0e455-151">To offset the "if" condition of a property trigger that has a wide variety of possible values, it is generally advisable to set that same property value to a default by using a <xref:System.Windows.Setter>.</span></span> <span data-ttu-id="0e455-152">Таким образом, <xref:System.Windows.Trigger> содержащий метод задания будет иметь приоритет, если условие триггера истинно, а <xref:System.Windows.Setter>, находящиеся вне <xref:System.Windows.Trigger>, будут иметь приоритет при условии, что условие триггера имеет значение false.</span><span class="sxs-lookup"><span data-stu-id="0e455-152">This way, the <xref:System.Windows.Trigger> contained setter will have precedence when the trigger condition is true, and the <xref:System.Windows.Setter> that is not within a <xref:System.Windows.Trigger> will have precedence whenever the trigger condition is false.</span></span>  
  
 <span data-ttu-id="0e455-153">Триггеры свойств, как правило, подходят для сценариев, в которых одно или несколько свойств Appearance должны изменяться в зависимости от состояния другого свойства в том же элементе.</span><span class="sxs-lookup"><span data-stu-id="0e455-153">Property triggers are generally appropriate for scenarios where one or more appearance properties should change, based on the state of another property on the same element.</span></span>  
  
 <span data-ttu-id="0e455-154">Дополнительные сведения о триггерах свойств см. в разделе [Использование стилей и шаблонов](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0e455-154">To learn more about property triggers, see [Styling and Templating](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0e455-155">См. также</span><span class="sxs-lookup"><span data-stu-id="0e455-155">See also</span></span>

- [<span data-ttu-id="0e455-156">Общие сведения о перенаправленных событиях</span><span class="sxs-lookup"><span data-stu-id="0e455-156">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="0e455-157">Общие сведения о свойствах зависимости</span><span class="sxs-lookup"><span data-stu-id="0e455-157">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
