---
title: Наследование значения свойства
ms.date: 03/30/2017
helpviewer_keywords:
- inheritance [WPF], property values
- value inheritance [WPF]
- properties [WPF], value inheritance
ms.assetid: d7c338f9-f2bf-48ed-832c-7be58ac390e4
ms.openlocfilehash: 48543d2cfc11fc33dff6239cdfd7bfcd946e986a
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2019
ms.locfileid: "59186834"
---
# <a name="property-value-inheritance"></a><span data-ttu-id="1cd8e-102">Наследование значения свойства</span><span class="sxs-lookup"><span data-stu-id="1cd8e-102">Property Value Inheritance</span></span>
<span data-ttu-id="1cd8e-103">Наследование значения свойства — это функция системы свойств [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1cd8e-103">Property value inheritance is a feature of the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] property system.</span></span> <span data-ttu-id="1cd8e-104">Наследование значения свойства позволяет дочерним элементам в дереве элементов получать значение конкретного свойства из родительских элементов, наследуя это значение, настроенное в ближайшем родительском элементе.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-104">Property value inheritance enables child elements in a tree of elements to obtain the value of a particular property from parent elements, inheriting that value as it was set anywhere in the nearest parent element.</span></span> <span data-ttu-id="1cd8e-105">Родительский элемент также мог получить свое значение через наследование значения свойства, поэтому система потенциально рекурсивно проходит по элементам к корню страницы.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-105">The parent element might also have obtained its value through property value inheritance, so the system potentially recurses all the way to the page root.</span></span> <span data-ttu-id="1cd8e-106">Наследование значения свойства не является стандартным поведением системы свойств. Чтобы свойство инициировало наследование значения свойства для дочерних элементов, оно должно быть установлено с определенным параметром метаданных.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-106">Property value inheritance is not the default property system behavior; a property must be established with a particular metadata setting in order to cause that property to initiate property value inheritance on child elements.</span></span>  

<a name="Property_Value_Inheritance_is_Containment_Inheritance"></a>   
## <a name="property-value-inheritance-is-containment-inheritance"></a><span data-ttu-id="1cd8e-107">Наследование значения свойства является наследованием вложений</span><span class="sxs-lookup"><span data-stu-id="1cd8e-107">Property Value Inheritance Is Containment Inheritance</span></span>  
 <span data-ttu-id="1cd8e-108">Используемый здесь термин "наследование" отличается от концепции наследования в контексте типов и общего объектно-ориентированного программирования, где производные классы наследуют определения членов от своих базовых классов.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-108">"Inheritance" as a term here is not quite the same concept as inheritance in the context of types and general object-oriented programming, where derived classes inherit member definitions from their base classes.</span></span> <span data-ttu-id="1cd8e-109">Это значение наследования также активно в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: свойства, определенные в различных базовых классах, отображаются как атрибуты для производных классов [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] при использовании в качестве элементов и представляются для кода как члены.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-109">That meaning of inheritance is also active in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: properties defined in various base classes are exposed as attributes for derived [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] classes when used as elements, and exposed as members for code.</span></span> <span data-ttu-id="1cd8e-110">В частности, наследование значения свойства заключается в том, как значения свойств могут наследоваться от одного элемента к другому на основе иерархических отношений в дереве элементов.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-110">Property value inheritance is particularly about how property values can inherit from one element to another on the basis of the parent-child relationships within a tree of elements.</span></span> <span data-ttu-id="1cd8e-111">Это дерево элементов наиболее явно видно при встраивании элементов в другие элементы во время определения приложения в разметке [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1cd8e-111">That tree of elements is most directly visible when nesting elements inside other elements as you define applications in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] markup.</span></span> <span data-ttu-id="1cd8e-112">Деревья объектов также могут создаваться программно путем добавления объектов к выделенным коллекциям других объектов, а наследование значения свойства работает аналогично в конечном дереве во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-112">Trees of objects can also be created programmatically by adding objects to designated collections of other objects, and property value inheritance works the same way in the finished tree at run time.</span></span>  
  
<a name="Practical_Applications_of_Property_Value_Inheritance"></a>   
## <a name="practical-applications-of-property-value-inheritance"></a><span data-ttu-id="1cd8e-113">Практическое применение наследования значения свойства</span><span class="sxs-lookup"><span data-stu-id="1cd8e-113">Practical Applications of Property Value Inheritance</span></span>  
 <span data-ttu-id="1cd8e-114">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] включают несколько свойств, в которых включено наследование свойства.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-114">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] include several properties that have property inheritance enabled.</span></span> <span data-ttu-id="1cd8e-115">Как правило, сценарий для них состоит во включении свойства там, где уместно устанавливать свойство только один раз на странице, но это свойство также является членом одного из базовых классов элементов и, таким образом, может существовать в большинстве дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-115">Typically, the scenario for these is that they involve a property where it is appropriate that the property be set only once per page, but where that property is also a member of one of the base element classes and thus would also exist on most of the child elements.</span></span> <span data-ttu-id="1cd8e-116">Например <xref:System.Windows.FrameworkElement.FlowDirection%2A> свойства элементов управления, переданное содержимое которых следует представлен и организован на странице.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-116">For example, the <xref:System.Windows.FrameworkElement.FlowDirection%2A> property controls which direction flowed content should be presented and arranged on the page.</span></span> <span data-ttu-id="1cd8e-117">Как правило, требуется, чтобы концепция направления текста согласованно обрабатывалась во всех дочерних элементах.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-117">Typically, you want the text flow concept to be handled consistently throughout all child elements.</span></span> <span data-ttu-id="1cd8e-118">Если направление передачи по какой-то причине было прервано на некотором уровне дерева элементов в результате действия пользователя или среды, то оно должно быть перезапущено повсюду.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-118">If flow direction were for some reason reset in some level of the element tree by user or environment action, it should typically be reset throughout.</span></span> <span data-ttu-id="1cd8e-119">Когда <xref:System.Windows.FrameworkElement.FlowDirection%2A> свойство для наследования, то значение нужно только задать или сбросить один раз на уровне в дереве элементов, который охватывает требования каждой страницы в приложении.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-119">When the <xref:System.Windows.FrameworkElement.FlowDirection%2A> property is made to inherit, the value need only be set or reset once at the level in the element tree that encompasses the presentation needs of each page in the application.</span></span> <span data-ttu-id="1cd8e-120">Таким образом будет наследоваться даже начальное значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-120">Even the initial default value will inherit in this way.</span></span> <span data-ttu-id="1cd8e-121">Модель наследования значений свойств также позволяет отдельным элементам сбрасывать значение в тех редких случаях, когда сочетание направлений текста является преднамеренным.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-121">The property value inheritance model still enables individual elements to reset the value for the rare cases where having a mix of flow directions is intentional.</span></span>  
  
<a name="Making_a_Custom_Property_Inheritable"></a>   
## <a name="making-a-custom-property-inheritable"></a><span data-ttu-id="1cd8e-122">Создание настраиваемого наследуемого свойства</span><span class="sxs-lookup"><span data-stu-id="1cd8e-122">Making a Custom Property Inheritable</span></span>  
 <span data-ttu-id="1cd8e-123">Изменяя метаданные настраиваемого свойства, можно создать собственные наследуемые свойства.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-123">By changing a custom property's metadata, you can also make your own custom properties inheritable.</span></span> <span data-ttu-id="1cd8e-124">Обратите внимание, что назначение свойства как наследуемого оказывает определенное влияние на производительность.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-124">Note, however, that designating a property as inheritable does have some performance considerations.</span></span> <span data-ttu-id="1cd8e-125">В случаях, когда это свойство не имеет установленного локального значения или значения, полученного через стили, шаблоны или привязки данных, наследуемое свойство предоставляет присвоенные ему значения всем дочерним элементам в логическом дереве.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-125">In cases where that property does not have an established local value, or a value obtained through styles, templates, or data binding, an inheritable property provides its assigned property values to all child elements in the logical tree.</span></span>  
  
 <span data-ttu-id="1cd8e-126">Чтобы свойство участвовало в наследовании значения, создайте настраиваемое присоединенное свойство, как описано в разделе [Регистрация присоединенного свойства](how-to-register-an-attached-property.md).</span><span class="sxs-lookup"><span data-stu-id="1cd8e-126">To make a property participate in value inheritance, create a custom attached property, as described in [Register an Attached Property](how-to-register-an-attached-property.md).</span></span> <span data-ttu-id="1cd8e-127">Зарегистрируйте свойство с метаданными (<xref:System.Windows.FrameworkPropertyMetadata>) и укажите параметр «Наследует» в настройках параметров в этих метаданных.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-127">Register the property with metadata (<xref:System.Windows.FrameworkPropertyMetadata>) and specify the "Inherits" option in the options settings within that metadata.</span></span> <span data-ttu-id="1cd8e-128">Также убедитесь, что для свойства задано значение по умолчанию, так как теперь это значение будет наследоваться.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-128">Also make sure that the property has an established default value, because that value will now inherit.</span></span> <span data-ttu-id="1cd8e-129">Несмотря на регистрацию свойства как присоединенного, можно создать "оболочку" свойства для получения/настройки доступа к типу владельца точно так же, как и для "неприсоединенного" свойства зависимостей.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-129">Although you registered the property as attached, you might also want to create a property "wrapper" for get/set access on the owner type, just as you would for an "nonattached" dependency property.</span></span> <span data-ttu-id="1cd8e-130">После этого наследуемое свойство может быть установлено либо с помощью оболочки прямой свойства для типа владельца или производного типа, или его можно установить с помощью синтаксиса присоединенного свойства для какого-либо <xref:System.Windows.DependencyObject>.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-130">After doing so, the inheritable property can either be set by using the direct property wrapper on the owner type or derived types, or it can be set by using the attached property syntax on any <xref:System.Windows.DependencyObject>.</span></span>  
  
 <span data-ttu-id="1cd8e-131">Присоединенные свойства похожи на глобальные свойства; можно проверить значение любого <xref:System.Windows.DependencyObject> и получить правильный результат.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-131">Attached properties are conceptually similar to global properties; you can check for the value on any <xref:System.Windows.DependencyObject> and get a valid result.</span></span> <span data-ttu-id="1cd8e-132">Типичный сценарий для присоединенных свойств является установка значений свойств для дочерних элементов, и этот скрипт будет более эффективен, если рассматриваемое свойство является присоединенным свойством, всегда неявно присутствует в качестве присоединенного свойства для каждого элемента (<xref:System.Windows.DependencyObject>) в дереве.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-132">The typical scenario for attached properties is to set property values on child elements, and that scenario is more effective if the property in question is an attached property that is always implicitly present as an attached property on each element (<xref:System.Windows.DependencyObject>) in the tree.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1cd8e-133">Несмотря на то что наследование значения свойства может выполняться для неприсоединенных свойств зависимостей, поведение наследования для таких свойств через определенные границы элементов в дереве среды выполнения не определено.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-133">Although property value inheritance might appear to work for nonattached dependency properties, the inheritance behavior for a nonattached property through certain element boundaries in the run-time tree is undefined.</span></span> <span data-ttu-id="1cd8e-134">Всегда используйте <xref:System.Windows.DependencyProperty.RegisterAttached%2A> для регистрации вы зададите свойства <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> в метаданных.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-134">Always use <xref:System.Windows.DependencyProperty.RegisterAttached%2A> to register properties where you specify <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> in the metadata.</span></span>  
  
<a name="InheritanceContext"></a>   
## <a name="inheriting-property-values-across-tree-boundaries"></a><span data-ttu-id="1cd8e-135">Наследование значений свойств за границами дерева</span><span class="sxs-lookup"><span data-stu-id="1cd8e-135">Inheriting Property Values Across Tree Boundaries</span></span>  
 <span data-ttu-id="1cd8e-136">Наследование свойств работает путем обхода дерева элементов.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-136">Property inheritance works by traversing a tree of elements.</span></span> <span data-ttu-id="1cd8e-137">Это дерево часто параллельно логическому дереву.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-137">This tree is often parallel to the logical tree.</span></span> <span data-ttu-id="1cd8e-138">Тем не менее, при включении объекта уровня ядра WPF в разметку, определяющую дерево элементов, таких как <xref:System.Windows.Media.Brush>, вы создали несплошное логическое дерево.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-138">However, whenever you include a WPF core-level object in the markup that defines an element tree, such as a <xref:System.Windows.Media.Brush>, you have created a discontinuous logical tree.</span></span> <span data-ttu-id="1cd8e-139">Истинное логическое дерево концептуально не расширяется через <xref:System.Windows.Media.Brush>, так как логическое дерево является концепцией уровня среды WPF.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-139">A true logical tree does not conceptually extend through the <xref:System.Windows.Media.Brush>, because the logical tree is a WPF framework-level concept.</span></span> <span data-ttu-id="1cd8e-140">Вы можете увидеть это отражается в результатах, при использовании методов класса <xref:System.Windows.LogicalTreeHelper>.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-140">You can see this reflected in the results when using the methods of <xref:System.Windows.LogicalTreeHelper>.</span></span> <span data-ttu-id="1cd8e-141">Тем не менее наследование значения свойства может устранить этот разрыв в логическом дереве и можно по-прежнему передавать унаследованные значения, до тех пор, пока наследуемое свойство зарегистрировано как присоединенное свойство, а не намеренным граница, блокирующая наследование (например <xref:System.Windows.Controls.Frame>) обнаруживается.</span><span class="sxs-lookup"><span data-stu-id="1cd8e-141">However, property value inheritance can bridge this gap in the logical tree and can still pass inherited values through, so long as the inheritable property was registered as an attached property and no deliberate inheritance-blocking boundary (such as a <xref:System.Windows.Controls.Frame>) is encountered.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cd8e-142">См. также</span><span class="sxs-lookup"><span data-stu-id="1cd8e-142">See also</span></span>

- [<span data-ttu-id="1cd8e-143">Метаданные свойства зависимости</span><span class="sxs-lookup"><span data-stu-id="1cd8e-143">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
- [<span data-ttu-id="1cd8e-144">Общие сведения о вложенных свойствах зависимостей</span><span class="sxs-lookup"><span data-stu-id="1cd8e-144">Attached Properties Overview</span></span>](attached-properties-overview.md)
- [<span data-ttu-id="1cd8e-145">Приоритет значения свойств зависимостей</span><span class="sxs-lookup"><span data-stu-id="1cd8e-145">Dependency Property Value Precedence</span></span>](dependency-property-value-precedence.md)
