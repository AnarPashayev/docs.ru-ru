---
title: Общие сведения о системе команд
description: Сведения о командах, механизм ввода в Windows Presentation Foundation, который обеспечивает обработку ввода на более семантическом уровне, чем ввод устройства.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
ms.openlocfilehash: 4f7d12fbf0de9b1546f15061ab7eb1318378bbbb
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168126"
---
# <a name="commanding-overview"></a><span data-ttu-id="36f83-103">Общие сведения о системе команд</span><span class="sxs-lookup"><span data-stu-id="36f83-103">Commanding Overview</span></span>
<span data-ttu-id="36f83-104">Система команд <a name="introduction"></a> представляет собой механизм ввода в [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], обеспечивающий обработку входных данных на более семантическом уровне по сравнению с вводом устройств.</span><span class="sxs-lookup"><span data-stu-id="36f83-104"><a name="introduction"></a> Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="36f83-105">Примеры команд включают операции **Копировать**, **Вырезать** и **Вставить**, доступные во многих приложениях.</span><span class="sxs-lookup"><span data-stu-id="36f83-105">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="36f83-106">В этом обзоре определяется понятие команд в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], классы, входящие в модель команд, и способы использования и создания команд в приложениях.</span><span class="sxs-lookup"><span data-stu-id="36f83-106">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="36f83-107">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="36f83-107">This topic contains the following sections:</span></span>  
  
- [<span data-ttu-id="36f83-108">Что представляют собой команды?</span><span class="sxs-lookup"><span data-stu-id="36f83-108">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
- [<span data-ttu-id="36f83-109">Пример простой команды в WPF</span><span class="sxs-lookup"><span data-stu-id="36f83-109">Simple Command Example in WPF</span></span>](#simple_command)  
  
- [<span data-ttu-id="36f83-110">Четыре основных понятия в системе команд WPF</span><span class="sxs-lookup"><span data-stu-id="36f83-110">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
- [<span data-ttu-id="36f83-111">Библиотека команд</span><span class="sxs-lookup"><span data-stu-id="36f83-111">Command Library</span></span>](#Command_Library)  
  
- [<span data-ttu-id="36f83-112">Создание настраиваемых команд</span><span class="sxs-lookup"><span data-stu-id="36f83-112">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>
## <a name="what-are-commands"></a><span data-ttu-id="36f83-113">Что представляют собой команды?</span><span class="sxs-lookup"><span data-stu-id="36f83-113">What Are Commands?</span></span>  
 <span data-ttu-id="36f83-114">Команды применяются в различных целях.</span><span class="sxs-lookup"><span data-stu-id="36f83-114">Commands have several purposes.</span></span> <span data-ttu-id="36f83-115">Первой задачей является отделение семантики и объекта, вызывающего команду, от логики, которая выполняет команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-115">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="36f83-116">Это позволяет нескольким и разнородным источникам вызывать одну логику команды, а также настраивать логику команды для различных целевых объектов.</span><span class="sxs-lookup"><span data-stu-id="36f83-116">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="36f83-117">Например, операции редактирования **Копировать**, **Вырезать** и **Вставить**, которые встречаются во многих приложениях, могут вызываться с помощью разных действий пользователя, если они реализованы с помощью команд.</span><span class="sxs-lookup"><span data-stu-id="36f83-117">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="36f83-118">Приложение может поддерживать вырезание выделенных объектов или текста путем нажатия определенной кнопки, выбора пункта меню или сочетания клавиш, например CTRL+X.</span><span class="sxs-lookup"><span data-stu-id="36f83-118">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="36f83-119">С помощью команд можно привязать разные типы действий пользователя к одной логике.</span><span class="sxs-lookup"><span data-stu-id="36f83-119">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="36f83-120">Другой целью применения команд является указание того, доступно ли действие.</span><span class="sxs-lookup"><span data-stu-id="36f83-120">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="36f83-121">Продолжая пример вырезания объекта или текста, действие имеет смысл, только если что-либо выбрано.</span><span class="sxs-lookup"><span data-stu-id="36f83-121">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="36f83-122">Если пользователь попытается вырезать объект или текст, не выбрав его, ничего не произойдет.</span><span class="sxs-lookup"><span data-stu-id="36f83-122">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="36f83-123">Чтобы уведомить пользователя об этом, во многих приложениях кнопки и пункты меню отключаются, чтобы пользователь понял, что это действие выполнить невозможно.</span><span class="sxs-lookup"><span data-stu-id="36f83-123">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="36f83-124">Команда может указывать, возможно ли действие, путем реализации метода <xref:System.Windows.Input.ICommand.CanExecute%2A>.</span><span class="sxs-lookup"><span data-stu-id="36f83-124">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="36f83-125">Кнопка может подписаться на событие <xref:System.Windows.Input.ICommand.CanExecuteChanged> и отключаться, если <xref:System.Windows.Input.ICommand.CanExecute%2A> возвращает `false`, или включаться, если <xref:System.Windows.Input.ICommand.CanExecute%2A> возвращает `true`.</span><span class="sxs-lookup"><span data-stu-id="36f83-125">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="36f83-126">Семантика команды может быть согласованной в разных приложениях и классах, однако логика действия зависит от конкретного объекта, к которому она применяется.</span><span class="sxs-lookup"><span data-stu-id="36f83-126">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="36f83-127">Сочетание клавиш CTRL+X вызывает команду **Вырезать** в классах текста, классах изображений и веб-браузерах, однако фактическая логика для выполнения операции **Вырезать** определяется приложением, которое ее выполняет.</span><span class="sxs-lookup"><span data-stu-id="36f83-127">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="36f83-128"><xref:System.Windows.Input.RoutedCommand> позволяет клиентам реализовать логику.</span><span class="sxs-lookup"><span data-stu-id="36f83-128">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="36f83-129">Текстовый объект может вырезать выделенный текст в буфер обмена, а объект изображения может вырезать выбранное изображение.</span><span class="sxs-lookup"><span data-stu-id="36f83-129">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="36f83-130">Когда приложение обрабатывает событие <xref:System.Windows.Input.CommandManager.Executed>, оно имеет доступ к целевому объекту команды и может выполнить соответствующее действие в зависимости от типа целевого объекта.</span><span class="sxs-lookup"><span data-stu-id="36f83-130">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="36f83-131">Пример простой команды в WPF</span><span class="sxs-lookup"><span data-stu-id="36f83-131">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="36f83-132">Самый простой способ использования команды в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] — использовать предопределенную команду <xref:System.Windows.Input.RoutedCommand> из одного из классов библиотеки команд, элемент управления с собственной поддержкой обработки команд или элемент управления с собственной поддержкой вызова команд.</span><span class="sxs-lookup"><span data-stu-id="36f83-132">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="36f83-133">Команда <xref:System.Windows.Input.ApplicationCommands.Paste%2A> является одной из предопределенных команд в классе <xref:System.Windows.Input.ApplicationCommands>.</span><span class="sxs-lookup"><span data-stu-id="36f83-133">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="36f83-134">Элемент управления <xref:System.Windows.Controls.TextBox> содержит встроенную логику для обработки команды <xref:System.Windows.Input.ApplicationCommands.Paste%2A>.</span><span class="sxs-lookup"><span data-stu-id="36f83-134">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="36f83-135">Класс <xref:System.Windows.Controls.MenuItem> включает собственную поддержку для вызова команд.</span><span class="sxs-lookup"><span data-stu-id="36f83-135">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="36f83-136">В следующем примере показано, как настроить <xref:System.Windows.Controls.MenuItem> так, что при его выборе вызывается команда <xref:System.Windows.Input.ApplicationCommands.Paste%2A> для <xref:System.Windows.Controls.TextBox>, исходя из фокуса клавиатуры на <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="36f83-136">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="36f83-137">Четыре основных понятия в системе команд WPF</span><span class="sxs-lookup"><span data-stu-id="36f83-137">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="36f83-138">Модель перенаправляемых команд [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] можно разбить на четыре основных понятия: команда, источник команды, цель команды и привязка команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-138">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
- <span data-ttu-id="36f83-139">*Команда* — это выполняемое действие.</span><span class="sxs-lookup"><span data-stu-id="36f83-139">The *command* is the action to be executed.</span></span>  
  
- <span data-ttu-id="36f83-140">*Источник команды* — это объект, который вызывает команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-140">The *command source* is the object which invokes the command.</span></span>  
  
- <span data-ttu-id="36f83-141">*Цель команды* — это объект, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="36f83-141">The *command target* is the object that the command is being executed on.</span></span>  
  
- <span data-ttu-id="36f83-142">*Привязка команды* — это объект, сопоставляющий логику команды с командой.</span><span class="sxs-lookup"><span data-stu-id="36f83-142">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="36f83-143">В предыдущем примере команда <xref:System.Windows.Input.ApplicationCommands.Paste%2A> является командой, <xref:System.Windows.Controls.MenuItem> — источником команды, <xref:System.Windows.Controls.TextBox> — целевым объектом команды, а привязка команды предоставляется элементом управления <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="36f83-143">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="36f83-144">Следует отметить, что привязка <xref:System.Windows.Input.CommandBinding> не всегда предоставляется элементом управления, который является целевым классом команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-144">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="36f83-145">Довольно часто <xref:System.Windows.Input.CommandBinding> должен создаваться разработчиком приложения, кроме того, <xref:System.Windows.Input.CommandBinding> может быть присоединен к предку целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-145">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>
### <a name="commands"></a><span data-ttu-id="36f83-146">Команды</span><span class="sxs-lookup"><span data-stu-id="36f83-146">Commands</span></span>  
 <span data-ttu-id="36f83-147">Команды в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] создаются путем реализации интерфейса <xref:System.Windows.Input.ICommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-147">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="36f83-148"><xref:System.Windows.Input.ICommand> предоставляет два метода, <xref:System.Windows.Input.ICommand.Execute%2A> и <xref:System.Windows.Input.ICommand.CanExecute%2A>, и событие <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="36f83-148"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="36f83-149"><xref:System.Windows.Input.ICommand.Execute%2A> выполняет действия, связанные с командой.</span><span class="sxs-lookup"><span data-stu-id="36f83-149"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="36f83-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> определяет, может ли команда выполняться для текущего целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="36f83-151">Событие <xref:System.Windows.Input.ICommand.CanExecuteChanged> вызывается, если диспетчер команд, управляющий операциями системы команд, обнаруживает изменения в источнике команды, которые могут сделать недействительной команду, которая вызвана, но еще не выполнена привязкой команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-151"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="36f83-152">Реализация [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] класса <xref:System.Windows.Input.ICommand> — класс <xref:System.Windows.Input.RoutedCommand>, который рассматривается в этом обзоре.</span><span class="sxs-lookup"><span data-stu-id="36f83-152">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="36f83-153">Основными источниками входных данных в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] являются мышь, клавиатура, рукописный ввод и перенаправленные команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-153">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="36f83-154">Более аппаратно-ориентированные входные данные используют событие <xref:System.Windows.RoutedEvent> для уведомления объектов на странице приложения о том, что произошло событие ввода.</span><span class="sxs-lookup"><span data-stu-id="36f83-154">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="36f83-155">Объект <xref:System.Windows.Input.RoutedCommand> ничем не отличается.</span><span class="sxs-lookup"><span data-stu-id="36f83-155">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="36f83-156">Методы <xref:System.Windows.Input.RoutedCommand.Execute%2A> и <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> класса <xref:System.Windows.Input.RoutedCommand> не содержат логику приложения для команды, но вызывают перенаправленные события, которые проходят и поднимаются по дереву элементов, пока не обнаружат объект с <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="36f83-156">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="36f83-157"><xref:System.Windows.Input.CommandBinding> содержит обработчики для этих событий, а также обработчики для выполнения команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-157">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="36f83-158">Дополнительные сведения о маршрутизации событий в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="36f83-158">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="36f83-159">Метод <xref:System.Windows.Input.RoutedCommand.Execute%2A> для <xref:System.Windows.Input.RoutedCommand> вызывает события <xref:System.Windows.Input.CommandManager.PreviewExecuted> и <xref:System.Windows.Input.CommandManager.Executed> для целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-159">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="36f83-160">Метод <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> для <xref:System.Windows.Input.RoutedCommand> вызывает события <xref:System.Windows.Input.CommandManager.CanExecute> и <xref:System.Windows.Input.CommandManager.PreviewCanExecute> для целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-160">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="36f83-161">Эти события проходят и поднимаются по дереву элементов, пока не будет обнаружен объект, имеющий привязку <xref:System.Windows.Input.CommandBinding> для этой конкретной команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-161">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="36f83-162">предоставляет набор общих перенаправленных команд, которые охватывают несколько классов: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands> и <xref:System.Windows.Documents.EditingCommands>.</span><span class="sxs-lookup"><span data-stu-id="36f83-162">supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="36f83-163">Эти классы состоят только из объектов <xref:System.Windows.Input.RoutedCommand> и не реализуют логику команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-163">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="36f83-164">За реализацию логики команды отвечает объект, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="36f83-164">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>
### <a name="command-sources"></a><span data-ttu-id="36f83-165">Источники команд</span><span class="sxs-lookup"><span data-stu-id="36f83-165">Command Sources</span></span>  
 <span data-ttu-id="36f83-166">Источник команды — это объект, который вызывает команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-166">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="36f83-167">Примерами источников команды являются <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button> и <xref:System.Windows.Input.KeyGesture>.</span><span class="sxs-lookup"><span data-stu-id="36f83-167">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="36f83-168">Источники команд в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] обычно реализуют интерфейс <xref:System.Windows.Input.ICommandSource>.</span><span class="sxs-lookup"><span data-stu-id="36f83-168">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="36f83-169"><xref:System.Windows.Input.ICommandSource> предоставляет три свойства — <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> и <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span><span class="sxs-lookup"><span data-stu-id="36f83-169"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
- <span data-ttu-id="36f83-170"><xref:System.Windows.Input.ICommandSource.Command%2A> — это команда, которая будет выполняться при вызове источника команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-170"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
- <span data-ttu-id="36f83-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> — это объект, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="36f83-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="36f83-172">Следует отметить, что в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] свойство <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> для <xref:System.Windows.Input.ICommandSource> применимо, только когда <xref:System.Windows.Input.ICommand> — <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-172">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="36f83-173">Если для <xref:System.Windows.Input.ICommandSource> задано значение <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, и соответствующая команда — не <xref:System.Windows.Input.RoutedCommand>, целевой объект команды не учитывается.</span><span class="sxs-lookup"><span data-stu-id="36f83-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="36f83-174">Если <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> не задан, в качестве целевого объекта будет использоваться элемент с фокусом клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="36f83-174">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
- <span data-ttu-id="36f83-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> — это определяемый пользователем тип данных, который используется для передачи данных обработчикам, реализующим команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="36f83-176">Классы [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], реализующие <xref:System.Windows.Input.ICommandSource>: <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink> и <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="36f83-176">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="36f83-177"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem> и <xref:System.Windows.Documents.Hyperlink> вызывают команду при щелчке, а <xref:System.Windows.Input.InputBinding> вызывает команду при выполнении связанного с ней <xref:System.Windows.Input.InputGesture>.</span><span class="sxs-lookup"><span data-stu-id="36f83-177"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="36f83-178">В следующем примере показано, как использовать <xref:System.Windows.Controls.MenuItem> в <xref:System.Windows.Controls.ContextMenu> в качестве источника команды для команды <xref:System.Windows.Input.ApplicationCommands.Properties%2A>.</span><span class="sxs-lookup"><span data-stu-id="36f83-178">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="36f83-179">Как правило, источник команды будет осуществлять прослушивание события <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="36f83-179">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="36f83-180">Это событие сообщает источнику команды о том, что возможность выполнения команды для текущего целевого объекта команды может быть изменена.</span><span class="sxs-lookup"><span data-stu-id="36f83-180">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="36f83-181">Источник команды может запрашивать текущее состояние <xref:System.Windows.Input.RoutedCommand> с помощью метода <xref:System.Windows.Input.RoutedCommand.CanExecute%2A>.</span><span class="sxs-lookup"><span data-stu-id="36f83-181">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="36f83-182">Источник команды может затем отключаться, если не удается выполнить команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-182">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="36f83-183">Примером этого является переход <xref:System.Windows.Controls.MenuItem> в неактивное состояние (серый цвет) в случае невозможности выполнить команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-183">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="36f83-184"><xref:System.Windows.Input.InputGesture> можно использовать в качестве источника команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-184">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="36f83-185">Два типа входных жестов в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: <xref:System.Windows.Input.KeyGesture> и <xref:System.Windows.Input.MouseGesture>.</span><span class="sxs-lookup"><span data-stu-id="36f83-185">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="36f83-186"><xref:System.Windows.Input.KeyGesture> можно представить как сочетание клавиш, например CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="36f83-186">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="36f83-187"><xref:System.Windows.Input.KeyGesture> состоит из <xref:System.Windows.Input.Key> и набора <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="36f83-187">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="36f83-188"><xref:System.Windows.Input.MouseGesture> состоит из <xref:System.Windows.Input.MouseAction> и необязательного набора <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="36f83-188">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="36f83-189">Чтобы объект <xref:System.Windows.Input.InputGesture> мог служить источником команды, он должен быть связан с командой.</span><span class="sxs-lookup"><span data-stu-id="36f83-189">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="36f83-190">Это можно настроить несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="36f83-190">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="36f83-191">Один из способов — использование <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="36f83-191">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="36f83-192">В следующем примере показано, как создать привязку <xref:System.Windows.Input.KeyBinding> между <xref:System.Windows.Input.KeyGesture> и <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-192">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="36f83-193">Другой способ связать <xref:System.Windows.Input.InputGesture> с <xref:System.Windows.Input.RoutedCommand> заключается в добавлении <xref:System.Windows.Input.InputGesture> в <xref:System.Windows.Input.InputGestureCollection> для <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-193">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="36f83-194">В следующем примере демонстрируется, как добавить <xref:System.Windows.Input.KeyGesture> в <xref:System.Windows.Input.InputGestureCollection> для <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-194">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>
### <a name="commandbinding"></a><span data-ttu-id="36f83-195">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="36f83-195">CommandBinding</span></span>  
 <span data-ttu-id="36f83-196"><xref:System.Windows.Input.CommandBinding> привязывает команду к обработчикам событий, которые реализуют команду.</span><span class="sxs-lookup"><span data-stu-id="36f83-196">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="36f83-197">Класс <xref:System.Windows.Input.CommandBinding> содержит свойство <xref:System.Windows.Input.CommandBinding.Command%2A> и события <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> и <xref:System.Windows.Input.CommandBinding.CanExecute>.</span><span class="sxs-lookup"><span data-stu-id="36f83-197">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="36f83-198"><xref:System.Windows.Input.CommandBinding.Command%2A> — это команда, с которой связан объект <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="36f83-198"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="36f83-199">Обработчики событий, присоединенные к событиям <xref:System.Windows.Input.CommandBinding.PreviewExecuted> и <xref:System.Windows.Input.CommandBinding.Executed>, реализуют логику команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-199">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="36f83-200">Обработчики событий, присоединенные к событиям <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> и <xref:System.Windows.Input.CommandBinding.CanExecute>, определяют, может ли эта команда выполняться для текущего целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-200">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="36f83-201">В следующем примере демонстрируется создание объекта <xref:System.Windows.Input.CommandBinding> в корневом объекте <xref:System.Windows.Window> приложения.</span><span class="sxs-lookup"><span data-stu-id="36f83-201">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="36f83-202"><xref:System.Windows.Input.CommandBinding> связывает команду <xref:System.Windows.Input.ApplicationCommands.Open%2A> с обработчиками <xref:System.Windows.Input.CommandManager.Executed> и <xref:System.Windows.Input.CommandBinding.CanExecute>.</span><span class="sxs-lookup"><span data-stu-id="36f83-202">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="36f83-203">Затем создаются объекты <xref:System.Windows.Input.ExecutedRoutedEventHandler> и <xref:System.Windows.Input.CanExecuteRoutedEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="36f83-203">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="36f83-204"><xref:System.Windows.Input.ExecutedRoutedEventHandler> открывает <xref:System.Windows.MessageBox>, где отображается строка, сообщающая о выполнении команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-204">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="36f83-205"><xref:System.Windows.Input.CanExecuteRoutedEventHandler> задает для свойства <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> значение `true`.</span><span class="sxs-lookup"><span data-stu-id="36f83-205">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="36f83-206"><xref:System.Windows.Input.CommandBinding> присоединяется к конкретному объекту, например к корневому объекту <xref:System.Windows.Window> приложения или элемента управления.</span><span class="sxs-lookup"><span data-stu-id="36f83-206">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="36f83-207">Объект, к которому присоединяется <xref:System.Windows.Input.CommandBinding>, определяет область привязки.</span><span class="sxs-lookup"><span data-stu-id="36f83-207">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="36f83-208">Например, <xref:System.Windows.Input.CommandBinding>, присоединенный к предку целевого объекта команды, достижим для события <xref:System.Windows.Input.CommandBinding.Executed>, а <xref:System.Windows.Input.CommandBinding>, присоединенный к потомку целевого объекта команды, недостижим.</span><span class="sxs-lookup"><span data-stu-id="36f83-208">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="36f83-209">Это напрямую связано со способом перехода события <xref:System.Windows.RoutedEvent> из объекта, который вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="36f83-209">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="36f83-210">В некоторых случаях <xref:System.Windows.Input.CommandBinding> присоединяется к целевому объекту команды напрямую, например с помощью класса <xref:System.Windows.Controls.TextBox> и команд <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A> и <xref:System.Windows.Input.ApplicationCommands.Paste%2A>.</span><span class="sxs-lookup"><span data-stu-id="36f83-210">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="36f83-211">Довольно часто, однако, более удобным будет подключение <xref:System.Windows.Input.CommandBinding> к предку целевого объекта команды, такому как главное окно <xref:System.Windows.Window> или объект приложения, особенно в том случае, если одну привязку <xref:System.Windows.Input.CommandBinding> можно использовать для нескольких целей команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-211">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="36f83-212">Это необходимо учитывать при создании инфраструктуры системы команд.</span><span class="sxs-lookup"><span data-stu-id="36f83-212">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>
### <a name="command-target"></a><span data-ttu-id="36f83-213">Цель команды</span><span class="sxs-lookup"><span data-stu-id="36f83-213">Command Target</span></span>  
 <span data-ttu-id="36f83-214">Целью команды является элемент, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="36f83-214">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="36f83-215">По отношению к <xref:System.Windows.Input.RoutedCommand> целевой объект команды — это элемент, с которого начинается перенаправление <xref:System.Windows.Input.CommandManager.Executed> и <xref:System.Windows.Input.CommandManager.CanExecute>.</span><span class="sxs-lookup"><span data-stu-id="36f83-215">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="36f83-216">Как было отмечено ранее, в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] свойство <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> для <xref:System.Windows.Input.ICommandSource> применимо, только когда <xref:System.Windows.Input.ICommand> — <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-216">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="36f83-217">Если для <xref:System.Windows.Input.ICommandSource> задано значение <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, и соответствующая команда — не <xref:System.Windows.Input.RoutedCommand>, целевой объект команды не учитывается.</span><span class="sxs-lookup"><span data-stu-id="36f83-217">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="36f83-218">Источник команды может явно задавать целевой объект команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-218">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="36f83-219">Если цель команды не определена, в качестве целевого объекта будет использоваться элемент с фокусом клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="36f83-219">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="36f83-220">Одно из преимуществ использования элемента с фокусом клавиатуры в качестве цели команды является то, что это позволяет разработчику приложения использовать один источник команды для вызова команд для нескольких целей без необходимости отслеживания целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-220">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="36f83-221">Например, если <xref:System.Windows.Controls.MenuItem> вызывает команду **Вставить** в приложении, которое имеет элемент управления <xref:System.Windows.Controls.TextBox> и элемент управления <xref:System.Windows.Controls.PasswordBox>, целевым объектом может быть <xref:System.Windows.Controls.TextBox> или <xref:System.Windows.Controls.PasswordBox> в зависимости от того, какой элемент управления имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="36f83-221">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="36f83-222">В следующем примере показано явное задание цели команды в разметке и в коде программной части.</span><span class="sxs-lookup"><span data-stu-id="36f83-222">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>
### <a name="the-commandmanager"></a><span data-ttu-id="36f83-223">Диспетчер команд CommandManager</span><span class="sxs-lookup"><span data-stu-id="36f83-223">The CommandManager</span></span>  
 <span data-ttu-id="36f83-224"><xref:System.Windows.Input.CommandManager> выполняет ряд функций, связанных с командами.</span><span class="sxs-lookup"><span data-stu-id="36f83-224">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="36f83-225">Он предоставляет набор статических методов для добавления обработчиков событий <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute> и <xref:System.Windows.Input.CommandManager.CanExecute> в конкретный элемент и их удаления из него.</span><span class="sxs-lookup"><span data-stu-id="36f83-225">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="36f83-226">Он предоставляет средства для регистрации объектов <xref:System.Windows.Input.CommandBinding> и <xref:System.Windows.Input.InputBinding> для определенного класса.</span><span class="sxs-lookup"><span data-stu-id="36f83-226">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="36f83-227"><xref:System.Windows.Input.CommandManager> также предоставляет средства (с помощью события <xref:System.Windows.Input.CommandManager.RequerySuggested>) для уведомления команды о необходимости вызова события <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="36f83-227">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="36f83-228">Метод <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> вынуждает <xref:System.Windows.Input.CommandManager> вызвать событие <xref:System.Windows.Input.CommandManager.RequerySuggested>.</span><span class="sxs-lookup"><span data-stu-id="36f83-228">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="36f83-229">Это удобно для ситуаций, когда требуется отключить или включить команду, но отсутствуют условия, о которых известно <xref:System.Windows.Input.CommandManager>.</span><span class="sxs-lookup"><span data-stu-id="36f83-229">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>
## <a name="command-library"></a><span data-ttu-id="36f83-230">Библиотека команд</span><span class="sxs-lookup"><span data-stu-id="36f83-230">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="36f83-231">предоставляет набор стандартных команд.</span><span class="sxs-lookup"><span data-stu-id="36f83-231">provides a set of predefined commands.</span></span>  <span data-ttu-id="36f83-232">Библиотека команд включает следующие классы: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands> и <xref:System.Windows.Input.ComponentCommands>.</span><span class="sxs-lookup"><span data-stu-id="36f83-232">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="36f83-233">Эти классы предоставляют команды, такие как <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> и <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A> и <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span><span class="sxs-lookup"><span data-stu-id="36f83-233">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="36f83-234">Многие из этих команд содержат набор привязок ввода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="36f83-234">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="36f83-235">Например, если вы укажете, что приложение обрабатывает команду копирования, вы автоматически получаете привязку клавиатуры "CTRL + C", а также получаете привязки для других устройств ввода, таких как жесты пера планшетного ПК и речевые сведения.</span><span class="sxs-lookup"><span data-stu-id="36f83-235">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as Tablet PC pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="36f83-236">При ссылке на команды в различных библиотеках команд с помощью [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], обычно можно опустить имя класса библиотеки, который предоставляет статическое свойство команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-236">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="36f83-237">Как правило, имена команд задаются однозначно в виде строк и существуют типы владельца, которые обеспечивает логическую группировку команд, однако они не являются необходимыми для устранения неоднозначности.</span><span class="sxs-lookup"><span data-stu-id="36f83-237">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="36f83-238">Например, можно указать `Command="Cut"` вместо более подробной команды `Command="ApplicationCommands.Cut"`.</span><span class="sxs-lookup"><span data-stu-id="36f83-238">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="36f83-239">Это удобный механизм, встроенный в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] процессор для команд (точнее, это поведение преобразователя типов <xref:System.Windows.Input.ICommand> , которое [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] указывает процессор во время загрузки).</span><span class="sxs-lookup"><span data-stu-id="36f83-239">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>
## <a name="creating-custom-commands"></a><span data-ttu-id="36f83-240">Создание настраиваемых команд</span><span class="sxs-lookup"><span data-stu-id="36f83-240">Creating Custom Commands</span></span>  
 <span data-ttu-id="36f83-241">Если команды в классах библиотеки команд не соответствуют вашим потребностям, вы можете создать собственные команды.</span><span class="sxs-lookup"><span data-stu-id="36f83-241">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="36f83-242">Настраиваемые команды можно создать двумя способами.</span><span class="sxs-lookup"><span data-stu-id="36f83-242">There are two ways to create a custom command.</span></span>  <span data-ttu-id="36f83-243">Первый способ подразумевает создание с нуля и реализацию интерфейса <xref:System.Windows.Input.ICommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-243">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="36f83-244">Другой способ, а также наиболее распространенный подход, — создание <xref:System.Windows.Input.RoutedCommand> или <xref:System.Windows.Input.RoutedUICommand>.</span><span class="sxs-lookup"><span data-stu-id="36f83-244">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="36f83-245">Пример создания настраиваемой команды <xref:System.Windows.Input.RoutedCommand> см. в разделе [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand) (Создание примера настраиваемой команды RoutedCommand).</span><span class="sxs-lookup"><span data-stu-id="36f83-245">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="36f83-246">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="36f83-246">See also</span></span>

- <xref:System.Windows.Input.RoutedCommand>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Input.InputBinding>
- <xref:System.Windows.Input.CommandManager>
- [<span data-ttu-id="36f83-247">Общие сведения о входных данных</span><span class="sxs-lookup"><span data-stu-id="36f83-247">Input Overview</span></span>](input-overview.md)
- [<span data-ttu-id="36f83-248">Общие сведения о перенаправленных событиях</span><span class="sxs-lookup"><span data-stu-id="36f83-248">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="36f83-249">Реализация ICommandSource</span><span class="sxs-lookup"><span data-stu-id="36f83-249">Implement ICommandSource</span></span>](how-to-implement-icommandsource.md)
- <span data-ttu-id="36f83-250">[Практическое руководство. Добавление команды в объект MenuItem](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="36f83-250">[How to: Add a Command to a MenuItem](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span></span>
- [<span data-ttu-id="36f83-251">Создание примера настраиваемой команды RoutedCommand</span><span class="sxs-lookup"><span data-stu-id="36f83-251">Create a Custom RoutedCommand Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)
