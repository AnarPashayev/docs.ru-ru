---
title: Общие сведения о печати
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 902d51341850b5245b9fa6410b1954b2ab373bbc
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187202"
---
# <a name="printing-overview"></a><span data-ttu-id="711a9-102">Общие сведения о печати</span><span class="sxs-lookup"><span data-stu-id="711a9-102">Printing Overview</span></span>
<span data-ttu-id="711a9-103">С помощью Microsoft .NET Framework разработчики приложений, использующие Windows Presentation Foundation (WPF), имеют новый богатый набор ABI управления системами печати и печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="711a9-104">С Windows Vista некоторые из этих усовершенствований системы печати также доступны разработчикам, создающих приложения Windows Forms, и разработчикам, использующим неуправляемый код.</span><span class="sxs-lookup"><span data-stu-id="711a9-104">With Windows Vista, some of these print system enhancements are also available to developers creating Windows Forms applications and developers using unmanaged code.</span></span> <span data-ttu-id="711a9-105">В основе этой новой функциональности лежит новый формат файлов XML Paper Specification (XPS) и путь печати XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="711a9-106">Эта тема описана в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="711a9-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>
## <a name="about-xps"></a><span data-ttu-id="711a9-107">О формате XPS</span><span class="sxs-lookup"><span data-stu-id="711a9-107">About XPS</span></span>  
 <span data-ttu-id="711a9-108">XPS — это электронный формат документа, формат файла катушки и язык описания страницы.</span><span class="sxs-lookup"><span data-stu-id="711a9-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="711a9-109">Это открытый формат документов, который использует XML, Открытые конвенции упаковки (OPC) и другие отраслевые стандарты для создания кросс-платформенных документов.</span><span class="sxs-lookup"><span data-stu-id="711a9-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="711a9-110">XPS упрощает процесс создания, совместного использования, печати, просмотра и архивирования цифровых документов.</span><span class="sxs-lookup"><span data-stu-id="711a9-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="711a9-111">Для получения дополнительной информации о XPS, [см.](/windows/desktop/printdocs/documents)</span><span class="sxs-lookup"><span data-stu-id="711a9-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="711a9-112">Несколько методов печати контента на основе XPS с использованием WPF демонстрируются в [программно-печатных xPS Files.](how-to-programmatically-print-xps-files.md)</span><span class="sxs-lookup"><span data-stu-id="711a9-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="711a9-113">Ссылки на эти примеры могут оказаться полезными при просмотре содержимого этого раздела.</span><span class="sxs-lookup"><span data-stu-id="711a9-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="711a9-114">(Неуправляемые разработчики кода должны видеть документацию для [функции MXDC_ESCAPE.](/windows/desktop/printdocs/mxdc-escape)</span><span class="sxs-lookup"><span data-stu-id="711a9-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="711a9-115">Разработчики Windows Forms должны использовать <xref:System.Drawing.Printing> API в пространстве имен, который не поддерживает полный путь печати XPS, но поддерживает гибридный путь печати GDI-to-XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="711a9-116">См. раздел **Архитектура способа печати** ниже.)</span><span class="sxs-lookup"><span data-stu-id="711a9-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>
## <a name="xps-print-path"></a><span data-ttu-id="711a9-117">Способ печати XPS</span><span class="sxs-lookup"><span data-stu-id="711a9-117">XPS Print Path</span></span>  
 <span data-ttu-id="711a9-118">Путь печати Бумаги XML Paper (XPS) — это новая функция Windows, которая переопределяет способы обработки печати в приложениях Windows.</span><span class="sxs-lookup"><span data-stu-id="711a9-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="711a9-119">Потому что XPS может заменить язык представления документов (например, RTF), формат печатной спулера (например, WMF) и язык описания страницы (например, PCL или Postscript); новый путь печати поддерживает формат XPS от публикации приложений до окончательной обработки в драйвере печати или устройстве.</span><span class="sxs-lookup"><span data-stu-id="711a9-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="711a9-120">Путь печати XPS построен на модели драйвера принтера XPS (XPSDrv), которая предоставляет несколько преимуществ для разработчиков, таких как "то, что вы видите, это то, что вы получаете" (WYSIWYG) печать, улучшенная поддержка цвета, и значительно улучшенная производительность печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="711a9-121">(Для получения дополнительной информации о [Windows Driver Kit documentation](/windows-hardware/drivers/)XPSDrv, см.</span><span class="sxs-lookup"><span data-stu-id="711a9-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="711a9-122">Работа печатного спулера для документов XPS по существу такая же, как и в предыдущих версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="711a9-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="711a9-123">Тем не менее, он был расширен для поддержки пути печати XPS в дополнение к существующему пути печати GDI.</span><span class="sxs-lookup"><span data-stu-id="711a9-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="711a9-124">Новый путь печати, по-родному, потребляет файл катушки XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="711a9-125">В то время как драйверы принтера в пользовательском режиме, написанные для предыдущих версий Windows, будут продолжать работать, для использования пути печати XPS требуется драйвер принтера XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="711a9-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="711a9-126">Преимущества пути печати XPS значительны и включают в себя:</span><span class="sxs-lookup"><span data-stu-id="711a9-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="711a9-127">Поддержка печати WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="711a9-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="711a9-128">Встроенная поддержка дополнительных цветовых профилей, включая 32 бита на канал (bpc), CMYK, именованные цвета, n-краски и встроенную поддержку прозрачности и градиентов.</span><span class="sxs-lookup"><span data-stu-id="711a9-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="711a9-129">Улучшенная производительность печати как для приложений на основе .NET, так и для приложений, основанных на Win32.</span><span class="sxs-lookup"><span data-stu-id="711a9-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="711a9-130">Отраслевой стандартный формат XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="711a9-131">Для базовых сценариев печати доступен простой и интуитивно понятный API с одной точкой входа для пользовательского интерфейса, конфигурации и представления задания.</span><span class="sxs-lookup"><span data-stu-id="711a9-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="711a9-132">Для расширенных сценариев добавлена дополнительная поддержка настройки [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] (или не [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] вообще), синхронной или асинхронной печати и возможностей пакетной печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="711a9-133">Оба параметра обеспечивают поддержку печати в режиме полного или частичного доверия.</span><span class="sxs-lookup"><span data-stu-id="711a9-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="711a9-134">XPS был разработан с размножесь в виду.</span><span class="sxs-lookup"><span data-stu-id="711a9-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="711a9-135">С помощью платформы расширяемости функции и возможности могут быть добавлены в XPS модульным образом.</span><span class="sxs-lookup"><span data-stu-id="711a9-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="711a9-136">Функции расширяемости включают следующее.</span><span class="sxs-lookup"><span data-stu-id="711a9-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="711a9-137">Схема печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-137">Print Schema.</span></span> <span data-ttu-id="711a9-138">Общая схема обновляется регулярно и позволяет быстро расширять возможности устройства.</span><span class="sxs-lookup"><span data-stu-id="711a9-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="711a9-139">(См. **PrintTicket и PrintCapabilities** ниже.)</span><span class="sxs-lookup"><span data-stu-id="711a9-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="711a9-140">Расширяемый конвейер фильтра.</span><span class="sxs-lookup"><span data-stu-id="711a9-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="711a9-141">Конвейер фильтров XPS printer (XPSDrv) был разработан для обеспечения как прямой, так и масштабируемой печати документов XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="711a9-142">Для получения дополнительной [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers)информации см.</span><span class="sxs-lookup"><span data-stu-id="711a9-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>
  
### <a name="print-path-architecture"></a><span data-ttu-id="711a9-143">Архитектура способа печати</span><span class="sxs-lookup"><span data-stu-id="711a9-143">Print Path Architecture</span></span>  
 <span data-ttu-id="711a9-144">В то время как приложения Win32 и .NET Framework поддерживают XPS, приложения Win32 и Windows Forms используют преобразование GDI для преобразования XPS для создания отформатированных XPS содержимого для драйвера принтера XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="711a9-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="711a9-145">Эти приложения не требуются для использования пути печати XPS и могут продолжать использовать расширенную печать Metafile (EMF).</span><span class="sxs-lookup"><span data-stu-id="711a9-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="711a9-146">Тем не менее, большинство функций и усовершенствований XPS доступны только для приложений, ориентированных на путь печати XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="711a9-147">Для обеспечения использования принтеров на основе XPSDrv приложениями Win32 и Windows Forms драйвер принтера XPS (XPSDrv) поддерживает преобразование GDI в формат XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="711a9-148">Модель XPSDrv также предоставляет преобразователь для формата XPS в формат GDI, чтобы приложения Win32 могли печатать документы XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="711a9-149">Для приложений WPF преобразование XPS в формат <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> GDI осуществляется автоматически методами <xref:System.Windows.Xps.XpsDocumentWriter> и методами класса всякий раз, когда в целевой очереди печати операции записи нет драйвера XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="711a9-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="711a9-150">(Приложения Windows Forms не могут печатать документы XPS.)</span><span class="sxs-lookup"><span data-stu-id="711a9-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="711a9-151">Следующая иллюстрация изображает подсистему печати и определяет части, предоставляемые корпорацией Майкрософт, а также части, определенные поставщиками программного и аппаратного обеспечения:</span><span class="sxs-lookup"><span data-stu-id="711a9-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![На скриншоте показана система печати XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="711a9-153">Базовая печать XPS</span><span class="sxs-lookup"><span data-stu-id="711a9-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="711a9-154">WPF определяет как базовый, так и продвинутый API.</span><span class="sxs-lookup"><span data-stu-id="711a9-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="711a9-155">Для тех приложений, которые не требуют обширной настройки печати или доступа к полному набору функций XPS, доступна базовая поддержка печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="711a9-156">Базовая поддержка печати предоставляется с помощью элемента управления диалогового окна печати, который требует минимальной конфигурации и представляет знакомый [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="711a9-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="711a9-157">Многие функции XPS доступны с помощью этой упрощенной модели печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="711a9-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="711a9-158">PrintDialog</span></span>  
 <span data-ttu-id="711a9-159">Элемент <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> управления обеспечивает единую [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]точку входа для, конфигурации и представления задания XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="711a9-160">Сведения о том, как создать и использовать элемент управления, см. в разделе [Вызов диалогового окна печати](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="711a9-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="711a9-161">Расширенная печать XPS</span><span class="sxs-lookup"><span data-stu-id="711a9-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="711a9-162">Для доступа к полному набору функций XPS необходимо использовать расширенный API печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="711a9-163">Ниже более подробно описаны некоторые соответствующие API.</span><span class="sxs-lookup"><span data-stu-id="711a9-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="711a9-164">Для получения полного списка AAP-путей <xref:System.Windows.Xps> печати <xref:System.Printing> XPS см.</span><span class="sxs-lookup"><span data-stu-id="711a9-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="711a9-165">PrintTicket и PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="711a9-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="711a9-166"><xref:System.Printing.PrintTicket> Классы <xref:System.Printing.PrintCapabilities> являются основой передовых функций XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="711a9-167">Оба типа объектов представляют xML отформатированные структуры типоориентированных функций, таких как сопоставление, двусторонняя печать, скрепление и т.д. Эти структуры определяются схемой печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="711a9-168">Объект <xref:System.Printing.PrintTicket> указывает принтеру, как обрабатывать задание печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="711a9-169">Класс <xref:System.Printing.PrintCapabilities> определяет возможности принтера.</span><span class="sxs-lookup"><span data-stu-id="711a9-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="711a9-170">Запрашивая возможности принтера, можно создать <xref:System.Printing.PrintTicket>, который использует все преимущества поддерживаемых возможностей принтера.</span><span class="sxs-lookup"><span data-stu-id="711a9-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="711a9-171">Аналогичным образом можно избежать неподдерживаемых функций.</span><span class="sxs-lookup"><span data-stu-id="711a9-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="711a9-172">В следующем примере демонстрируется, как запрашивать <xref:System.Printing.PrintCapabilities> принтера и создавать <xref:System.Printing.PrintTicket> с помощью кода.</span><span class="sxs-lookup"><span data-stu-id="711a9-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="711a9-173">PrintServer и PrintQueue</span><span class="sxs-lookup"><span data-stu-id="711a9-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="711a9-174">Класс <xref:System.Printing.PrintServer> представляет сетевой сервер печати, а класс <xref:System.Printing.PrintQueue> представляет принтер и связанную с ним очередь выходных заданий.</span><span class="sxs-lookup"><span data-stu-id="711a9-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="711a9-175">Вместе эти AA позволяют эффективно едать работу по печати сервера.</span><span class="sxs-lookup"><span data-stu-id="711a9-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="711a9-176">Объект <xref:System.Printing.PrintServer> или один из его производных классов используется для управления <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="711a9-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="711a9-177">Метод <xref:System.Printing.PrintQueue.AddJob%2A> используется для вставки нового задания печати в очередь.</span><span class="sxs-lookup"><span data-stu-id="711a9-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="711a9-178">В следующем примере демонстрируется создание <xref:System.Printing.LocalPrintServer> и доступ к его <xref:System.Printing.PrintQueue> по умолчанию с помощью кода.</span><span class="sxs-lookup"><span data-stu-id="711a9-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="711a9-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="711a9-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="711a9-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, с <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> его <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> много и методы, используется для <xref:System.Printing.PrintQueue>записи документов XPS в .</span><span class="sxs-lookup"><span data-stu-id="711a9-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="711a9-181">Например, <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> метод используется для вывода документа <xref:System.Printing.PrintTicket> XPS и синхронно.</span><span class="sxs-lookup"><span data-stu-id="711a9-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="711a9-182">Метод <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> используется для вывода документа XPS и <xref:System.Printing.PrintTicket> асинхронно.</span><span class="sxs-lookup"><span data-stu-id="711a9-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="711a9-183">В следующем примере показывается, как создать <xref:System.Windows.Xps.XpsDocumentWriter> с помощью кода.</span><span class="sxs-lookup"><span data-stu-id="711a9-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="711a9-184">Методы <xref:System.Printing.PrintQueue.AddJob%2A> также предоставляют способы печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="711a9-185">Дополнительные сведения см. в разделе [Печать XPS-файлов программным способом](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="711a9-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="711a9-186">.</span><span class="sxs-lookup"><span data-stu-id="711a9-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>
## <a name="gdi-print-path"></a><span data-ttu-id="711a9-187">Способ печати GDI</span><span class="sxs-lookup"><span data-stu-id="711a9-187">GDI Print Path</span></span>  
 <span data-ttu-id="711a9-188">В то время как приложения WPF нативно поддерживают путь печати XPS, приложения Win32 и Windows Forms также могут воспользоваться некоторыми функциями XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="711a9-189">Драйвер принтера XPS (XPSDrv) может конвертировать выход на основе GDI в формат XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="711a9-190">Для расширенных сценариев пользовательская конверсия содержимого поддерживается с помощью [преобразователя документов Microsoft XPS (MXDC).](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)</span><span class="sxs-lookup"><span data-stu-id="711a9-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="711a9-191">Аналогичным образом, приложения WPF могут также выходить на <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> путь <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> печати GDI, вызывая один из методов <xref:System.Windows.Xps.XpsDocumentWriter> класса и обозначая принтер non-XpsDrv в качестве целевой очереди печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="711a9-192">Для приложений, не требующих функциональности или поддержки XPS, текущий путь печати GDI остается неизменным.</span><span class="sxs-lookup"><span data-stu-id="711a9-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="711a9-193">Дополнительные справочные материалы о пути печати GDI и различных вариантах преобразования XPS можно получить в [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) и [Драйверах принтеров XPSDrv.](/windows-hardware/drivers/print/xpsdrv-printer-drivers)</span><span class="sxs-lookup"><span data-stu-id="711a9-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="711a9-194">Модель драйвера XPSDrv</span><span class="sxs-lookup"><span data-stu-id="711a9-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="711a9-195">Путь печати XPS повышает эффективность spooler, используя XPS в качестве родного формата катушки печати при печати на принтер ес с поддержкой XPS или драйвера.</span><span class="sxs-lookup"><span data-stu-id="711a9-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="711a9-196">Упрощенный процесс спулинга устраняет необходимость создания промежуточного файла катушки, например файла данных EMF, до того, как документ будет спущен на пул.</span><span class="sxs-lookup"><span data-stu-id="711a9-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="711a9-197">Благодаря меньшим размерам файла катушки, путь печати XPS может уменьшить сетевой трафик и улучшить производительность печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="711a9-198">EMF — это закрытый формат, который представляет выход приложений как серию вызовов в GDI для оказания услуг.</span><span class="sxs-lookup"><span data-stu-id="711a9-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="711a9-199">В отличие от EMF, формат spool XPS представляет собой фактический документ, не требуя дальнейшей интерпретации при выходе на основе XPS драйвер принтера (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="711a9-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="711a9-200">Драйверы могут работать непосредственно с данными в этом формате.</span><span class="sxs-lookup"><span data-stu-id="711a9-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="711a9-201">Эта возможность исключает преобразования данных и цветового пространства, необходимые при использовании файлов EMF и GDI-драйверов печати.</span><span class="sxs-lookup"><span data-stu-id="711a9-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="711a9-202">Размеры файлов Spool обычно уменьшаются при использовании документов XPS, ориентированных на драйвер принтера XPS (XPSDrv) по сравнению с их эквивалентами EMF; однако есть исключения:</span><span class="sxs-lookup"><span data-stu-id="711a9-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="711a9-203">Очень сложная, многоуровневая или неэффективно созданная векторная графика может быть больше, чем растровая версия того же графического объекта.</span><span class="sxs-lookup"><span data-stu-id="711a9-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="711a9-204">Для отображения экрана XPS-файлы внедряют шрифты устройства, а также шрифты на компьютере; тогда как файлы очереди GDI не внедряют шрифты устройства.</span><span class="sxs-lookup"><span data-stu-id="711a9-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="711a9-205">Но оба типа шрифтов имеют поднаборы (см. ниже), и драйверы принтера могут удалить шрифты устройства до передачи файла на принтер.</span><span class="sxs-lookup"><span data-stu-id="711a9-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="711a9-206">Уменьшение размера очереди выполняется посредством нескольких механизмов.</span><span class="sxs-lookup"><span data-stu-id="711a9-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="711a9-207">**Поднабор шрифта**.</span><span class="sxs-lookup"><span data-stu-id="711a9-207">**Font subsetting**.</span></span> <span data-ttu-id="711a9-208">В файле XPS хранятся только символы, используемые в настоящем документе.</span><span class="sxs-lookup"><span data-stu-id="711a9-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="711a9-209">**Поддержка расширенной графики**.</span><span class="sxs-lookup"><span data-stu-id="711a9-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="711a9-210">Поддержка родной прозрачностью и градиентными примитивами позволяет избежать rasterization содержания в документе XPS.</span><span class="sxs-lookup"><span data-stu-id="711a9-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="711a9-211">**Идентификация общих ресурсов**.</span><span class="sxs-lookup"><span data-stu-id="711a9-211">**Identification of common resources**.</span></span> <span data-ttu-id="711a9-212">Ресурсы, которые используются несколько раз (например, изображение, представляющее эмблему организации), рассматриваются как общие ресурсы и загружаются только один раз.</span><span class="sxs-lookup"><span data-stu-id="711a9-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="711a9-213">**Сжатие ЗИП**.</span><span class="sxs-lookup"><span data-stu-id="711a9-213">**ZIP compression**.</span></span> <span data-ttu-id="711a9-214">Во всех документах XPS используется сжатие зип.</span><span class="sxs-lookup"><span data-stu-id="711a9-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="711a9-215">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="711a9-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="711a9-216">Как-к темам</span><span class="sxs-lookup"><span data-stu-id="711a9-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="711a9-217">Документы в WPF</span><span class="sxs-lookup"><span data-stu-id="711a9-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="711a9-218">XPS-документы</span><span class="sxs-lookup"><span data-stu-id="711a9-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="711a9-219">Сериализация и хранение документов</span><span class="sxs-lookup"><span data-stu-id="711a9-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="711a9-220">Преобразователь документов Microsoft XPS (MXDC)</span><span class="sxs-lookup"><span data-stu-id="711a9-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
