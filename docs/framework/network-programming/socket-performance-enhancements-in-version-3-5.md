---
title: Улучшения производительности сокетов в версии 3.5
ms.date: 03/30/2017
ms.assetid: 225aa5f9-c54b-4620-ab64-5cd100cfd54c
ms.openlocfilehash: 577c033fc5639f9d9f50e413fd2cb55a75d48f2c
ms.sourcegitcommit: 289e06e904b72f34ac717dbcc5074239b977e707
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/17/2019
ms.locfileid: "71047242"
---
# <a name="socket-performance-enhancements-in-version-35"></a>Улучшения производительности сокетов в версии 3.5
Класс <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> был оптимизирован в версии 3.5 для обеспечения максимальной производительности приложений, которые используют асинхронные операции ввода-вывода по сети. В рамках набора усовершенствований класса <xref:System.Net.Sockets.Socket>, предоставляющих альтернативный шаблон асинхронной модели, который может использоваться специализированными высокопроизводительными приложениями сокетов, был добавлен ряд новых классов. Эти усовершенствования были специально разработаны для сетевых серверных приложений, требующих высокой производительности. Приложение может быть основано исключительно на улучшенном шаблоне асинхронной модели или может использовать его только в определенных областях (например, при получении больших объемов данных).  
  
## <a name="class-enhancements"></a>Улучшения класса  
 Главное преимущество этих улучшений — устранение необходимости в повторном выделении и синхронизации объектов во время асинхронных операций ввода-вывода больших объемов данных на сокете. Конструктивный шаблон на основе методов Begin и End, в настоящее время реализуемый классом <xref:System.Net.Sockets.Socket> для асинхронных операций ввода-вывода на сокете, требует выделения объекта <xref:System.IAsyncResult?displayProperty=nameWithType> для каждой асинхронной операции.  
  
 В новом классе <xref:System.Net.Sockets.Socket> асинхронные операции на сокете описываются повторно используемыми объектами класса <xref:System.Net.Sockets.SocketAsyncEventArgs?displayProperty=nameWithType>, которые выделяются и обслуживаются приложением. Высокопроизводительному приложению сокета лучше всего известно, сколько перекрывающихся операций сокета необходимо поддерживать. Приложение может создать столько объектов <xref:System.Net.Sockets.SocketAsyncEventArgs>, сколько ему требуется. Например, если для обеспечения постоянной готовности к приему входящих подключений клиентов серверному приложению требуется 15 операций на сокете, оно может выделить для этой цели 15 повторно используемых объектов <xref:System.Net.Sockets.SocketAsyncEventArgs>.  
  
 Шаблон выполнения асинхронной операции на сокете с помощью этого класса состоит из перечисленных ниже действий.  
  
1. Выделите новый объект контекста <xref:System.Net.Sockets.SocketAsyncEventArgs> или получите свободный объект из пула приложений.  
  
2. Задайте свойства объекта контекста в соответствии с операцией, которая должна быть выполнена (это могут быть, например, метод делегата обратного вызова и буфер данных).  
  
3. Вызовите соответствующий метод сокета (xxxAsync), чтобы инициировать асинхронную операцию.  
  
4. Если асинхронный метод сокета (xxxAsync) возвращает значение true в результате обратного вызова, запросите состояние завершения из свойств контекста.  
  
5. Если асинхронный метод сокета (xxxAsync) возвращает значение false в результате обратного вызова, операция была выполнена синхронно. Результат операции можно запросить из свойств контекста.  
  
6. Используйте контекст повторно для другой операции, верните его в пул или удалите.  
  
 Время существования нового объекта контекста для асинхронной операции на сокете определяется ссылками в коде приложения и ссылками асинхронного ввода-вывода. Приложению не требуется сохранять ссылку на объект контекста асинхронной операции на сокете после ее передачи в качестве параметра в один из методов асинхронной операции на сокете. Ссылка сохраняется до тех пор, пока не будет возвращен обратный вызов завершения. Однако ссылку на объект контекста полезно сохранять, чтобы приложение могло использовать этот объект повторно для последующей асинхронной операции на сокете.  
  
## <a name="see-also"></a>См. также

- <xref:System.Net.Sockets.Socket?displayProperty=nameWithType>
- <xref:System.Net.Sockets.SendPacketsElement?displayProperty=nameWithType>
- <xref:System.Net.Sockets.SocketAsyncEventArgs?displayProperty=nameWithType>
- <xref:System.Net.Sockets.SocketAsyncOperation?displayProperty=nameWithType>
- [Примеры сетевого программирования](network-programming-samples.md)
- [Примеры кода сокетов](socket-code-examples.md)
