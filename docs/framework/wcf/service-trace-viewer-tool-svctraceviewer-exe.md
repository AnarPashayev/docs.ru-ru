---
title: Программа Service Trace Viewer (SvcTraceViewer.exe)
ms.date: 03/30/2017
ms.assetid: 9027efd3-df8d-47ed-8bcd-f53d55ed803c
ms.openlocfilehash: 02d2dd74031f280808027df1c0b7b78a90e6cd52
ms.sourcegitcommit: d6e27023aeaffc4b5a3cb4b88685018d6284ada4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2019
ms.locfileid: "67664114"
---
# <a name="service-trace-viewer-tool-svctraceviewerexe"></a>Программа Service Trace Viewer (SvcTraceViewer.exe)

Средство просмотра трассировки службы Windows Communication Foundation (WCF) помогает анализировать диагностические трассировки, которые создаются платформой WCF. Программа Service Trace Viewer предоставляет возможность легко слияния, просмотра и фильтрации сообщений трассировки в журнале, поэтому диагностика, исправление и проверять неисправности служб WCF.

## <a name="configuring-tracing"></a>Настройка трассировки

Диагностические трассировки предоставляют информацию о том, что происходит на всем протяжении работы приложения. Как следует из названия, можно проследить операции от их источника до назначения, а также выяснить, что происходило в промежуточных точках.

Можно настроить трассировку с помощью файла конфигурации приложения: Web.config для веб-приложений, или *Appname*.config для резидентных приложений. Ниже представлен пример такого кода.

```xml
<system.diagnostics>
    <trace autoflush="true" />
    <sources>
            <source name="System.ServiceModel"
                    switchValue="Information, ActivityTracing"
                    propagateActivity="true">
            <listeners>
               <add name="sdt"
                   type="System.Diagnostics.XmlWriterTraceListener"
                   initializeData= "SdrConfigExample.e2e" />
            </listeners>
         </source>
    </sources>
</system.diagnostics>
```

В этом примере указываются имя и тип прослушивателя трассировки. Прослушиватель имеет имя `sdt`, а в качестве типа добавляется стандартный прослушиватель трассировки .NET Framework (System.Diagnostics.XmlWriterTraceListener). `initializeData` Атрибут используется для задания имени файла журнала для этого прослушивателя `SdrConfigExample.e2e`. Для файла журнала можно заменить полный путь на простое имя файла.

В этом примере в корневом каталоге создается файл с именем SdrConfigExample.e2e. При использовании средства просмотра трассировки для открытия файла, как описано в разделе «Открытие и просмотр файлов трассировки WCF», вы увидите, что все сообщения, которые были отправлены.

Уровень трассировки контролируется параметром `switchValue`. Доступные уровни трассировки приведены в следующей таблице.

|Уровень трассировки|Описание|
|-----------------|-----------------|
|Critical|-С быстром прекращением и записи журнала событий и сведений о корреляции трассировки журналов. Ниже приводится несколько примеров ситуаций, в которых может потребоваться использовать уровень Critical.<br />-AppDomain, вышли из строя из-за необработанного исключения.<br />— Приложение не запускается.<br />-Сообщение, причиной сбоя, произошло из процесса MyApp.exe.|
|Error|-Записывает в журнал все исключения. Уровень Error можно использовать в следующих ситуациях.<br />-Произошел сбой кода из-за исключения недопустимого приведения.<br />-Исключение «не удалось создать конечную точку» вызывает сбой при запуске приложения.|
|Предупреждение|-Существует условие, которое впоследствии может привести к ошибке или критическому сбою. Этот уровень можно использовать в следующих ситуациях.<br />-Приложение получает больше запросов, чем его параметрами регулирования.<br />-Принимающая очередь заполнена на 98% емкость.|
|Сведения|-Создаются сообщения, полезные для мониторинга и диагностики состояния системы, измерения производительности или профилирования. Эту информацию можно использовать для планирования загрузки и управления производительностью. Этот уровень можно использовать в следующих ситуациях.<br />-Ошибка после того как сообщение достигло домен приложения и был десериализован.<br />-Ошибка при создании привязки HTTP.|
|Verbose|Debug уровень трассировки как для пользовательского кода и обслуживания. Этот уровень используется в следующих ситуациях.<br />— Вы не уверены, какой метод в коде был вызван, когда произошел сбой.<br />-Имеется настроена неверная конечная точка и службе не удалось запустить из-за блокировки записи в хранилище резервирования.|
|ActivityTracing|События переходов между действиями по обработке и компонентами.<br /><br /> Этот уровень позволяет администраторам и разработчикам коррелировать приложения из одного домена приложений.<br /><br /> -Трассировки границ действий: запуск и остановка.<br />-Трассировки для перенаправлений.|

 С помощью `add` можно задать имя и тип прослушивателя трассировки, который требуется использовать. В примере конфигурации прослушиватель имеет имя `sdt`, а в качестве типа добавляется стандартный прослушиватель трассировки .NET Framework (`System.Diagnostics.XmlWriterTraceListener`). Чтобы задать имя файла журнала для этого прослушивателя, используйте `initializeData`. Кроме того, можно заменить простое имя файла полным путем.

Начиная с .NET Framework 4.8, поле со списком отображаются элементы управления в некоторых темах высокой контрастности в правильный цвет. Это изменение можно отключить, удалив следующий параметр из *svcTraceViewer.exe.config* файла:

```xml
<AppContextSwitchOverrides value="Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false" />
```

## <a name="using-the-service-trace-viewer-tool"></a>Использование программы Service Trace Viewer

### <a name="opening-and-viewing-wcf-trace-files"></a>Открытие и просмотр файлов трассировки WCF

Программа Service Trace Viewer поддерживает три типа файлов:

- Файл (с расширением svclog) трассировки WCF

- Файлы трассировки событий (ETL)

- Файлы трассировки Crimson

 Программа Service Trace Viewer позволяет открыть любой поддерживаемый файл трассировки, добавить или интегрировать дополнительные файлы трассировки, а также открыть и выполнить одновременное слияние группы файлов трассировки.

##### <a name="to-open-a-trace-file"></a>Открытие файла трассировки

1. Запустите Service Trace Viewer, используя окно командной строки перейдите в папку установки WCF (C:\Program Files\Microsoft SDKs\Windows\v6.0\Bin), а затем введите `SvcTraceViewer.exe`.

> [!NOTE]
> Программу Service Trace Viewer можно ассоциировать с двумя типами файлов: SVCLOG и STVPROJ. С помощью двух параметров в командной строке можно регистрировать и отменять регистрацию расширений файлов.
>
> /register: зарегистрировать связь расширений файлов "SVCLOG" и "STVPROJ" с программой SvcTraceViewer.exe.
>
> /unregister: отменить регистрацию связи расширений файлов "SVCLOG" и "STVPROJ" с программой SvcTraceViewer.exe.

1. При запуске Service Trace Viewer, щелкните **файл** и наведите указатель на **откройте**. Перейдите в папку, где находятся файлы трассировки.

2. Дважды щелкните имя файла трассировки, который требуется открыть.

    > [!NOTE]
    > Щелкните несколько файлов трассировки, удерживая нажатой клавишу SHIFT, и откройте их одновременно. Service Trace Viewer производит слияние содержимого всех файлов и отображает данные в одном представлении. Например, можно открыть файлы трассировки как для клиента, так и для службы. Это удобно, если в конфигурации включено ведение журнала сообщений и распространение действий. Таким образом, можно проверить обмен сообщениями между клиентом и службой. Также можно перетащить несколько файлов в средство просмотра или использовать **проекта** вкладки. Дополнительные сведения см. в разделе «Управление проектом».

3. Чтобы добавить дополнительные файлы трассировки в коллекции, открыт, щелкните **файл** и наведите указатель на **добавить**. В открывшемся окне перейдите в расположение файлов трассировки и дважды щелкните левой кнопкой мыши файл, который нужно добавить.

> [!CAUTION]
> Не рекомендуется загружать файлы журнала трассировки размером более 200 МБ. Загрузка файла, размер которого превышает указанное значение, может занять длительное время в зависимости от ресурсов компьютера. Программа Service Trace Viewer может не отвечать в течение длительного времени или исчерпать память компьютера. Во избежание этого рекомендуется настроить частичную загрузку. Дополнительные сведения см. в разделе "Загрузка больших файлов трассировки".

#### <a name="event-tracing-and-crimson-tracing"></a>Трассировка событий и трассировка Crimson

Собственный формат средства просмотра может формата трассировки действий, которое выдает WCF. Трассировки, создаваемые в различных форматах, должны конвертироваться перед их отображением в средстве просмотра. На данный момент кроме формата трассировки действий средство просмотра поддерживает трассировку событий и трассировку Crimson.

При открытии файла, не содержащего трассировок действий, средство просмотра пытается преобразовать файл. Необходимо указать имя и расположение файла, который будет содержать преобразованные данные трассировки. После преобразования данных средство просмотра отображает содержимое в новом файле.

> [!NOTE]
> Для сохранения преобразованных данных трассировки требуется свободное пространство на диске. Перед запуском преобразования убедитесь, что на диске достаточно свободного пространства для сохранения данных. В противном случае преобразование не будет выполнено.

### <a name="managing-projects"></a>Управление проектами

Средство просмотра поддерживает проекты, что позволяет просматривать несколько файлов трассировки одновременно. Например, если имеется файл трассировки клиента и файл трассировки службы, их можно добавить в проект. После этого при каждом открытии проекта все файлы трассировки проекта будут загружаться одновременно.

Существует два способа управления проектами.

- В **файл** меню, можно открыть, сохранить и закрыть проект.

- В **проекта** вкладке можно добавить файлы в проект.

### <a name="viewing-wcf-traces"></a>Просмотр трассировок WCF

WCF создает трассировки с использованием формата трассировки действий. В модели трассировки действий отдельные трассировки группируются в действиях в соответствии со своим назначением. Логический поток управления переходит между действиями. Например, во время работы приложения появляется и исчезает множество действий "отправка сообщения". Дополнительные сведения о просмотре трассировок и действий и пользовательском интерфейсе Service Trace Viewer слишком см. в разделе [с помощью программы Service Trace Viewer для просмотра корреляцию трассировок и устранения неполадок](../../../docs/framework/wcf/diagnostics/tracing/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting.md).

#### <a name="switching-to-different-views"></a>Переключение между различными представлениями

В программе Service Trace Viewer предусмотрены следующие различные представления. Они отображаются как вкладки в левой части средства просмотра, а также может осуществляться из **представление** меню.

- Представление действия

- Представление проекта

- Представление сообщения

- Представление диаграммы

##### <a name="activity-view"></a>Представление действия

После открытия файлов трассировки, вы сможете просмотреть данные трассировки группируется в действия и отображается в **действия** представление на панели слева.

**Действия** представления отображаются имена действий, количество трассировок в действии, продолжительность, время начала и окончания.

При щелчке на любом из перечисленных действий на панели трассировок справа отображаются трассировки этого действия. После этого можно выбрать трассировку, чтобы просмотреть сведения о ней.

Можно выбрать несколько действий, нажав клавишу **Ctrl** или **Shift** ключа и выбора нужных действий. Панель трассировок отображает все трассировки выбранных действий.

Можно дважды щелкнуть действие для отображения на **Graph** представления. Альтернативным способом является выберите действие и переключитесь на **Graph** представления.

> [!NOTE]
> Действие «000000000000» — это специальное действие, которое нельзя отобразить в представлении графика. Поскольку все остальные действия привязаны к нему, отображение данного действия может сильно повлиять на производительность.

Чтобы выполнить сортировку списка действий, щелкните заголовок столбца. Действия, содержащие трассировки предупреждений, имеют желтый фон, а действия, содержащие трассировки ошибок, - красный фон.

Существуют различные типы действий, и каждому типу соответствует значок, расположенный слева от каждого действия. Обратитесь к разделу "Значки трассировок", чтобы получить информацию об их значении.

##### <a name="project-view"></a>Представление проекта

Это представление позволяет управлять файлами трассировки текущего проекта. Дополнительные сведения см. в разделе «Управление проектом».

##### <a name="message-view"></a>Представление сообщения

Это представление позволяет можно просмотреть все сообщения журнала трассировки, включая действие, даты и времени, процесс, Acivity и из нее и перейдите к сведения о трассировке журнала связанных сообщений. Вы можете сгруппировать трассировках журналов сообщений по границе действия, процессов и потоков, или Send и Receive для упрощения навигации потока обработки сообщений.

##### <a name="graph-view"></a>Представление диаграммы

В этом представлении отображаются данные трассировки для заданного действия в виде диаграммы. Диаграмма позволяет просматривать последовательные этапы выполнения событий и взаимосвязи между множеством действий при перемещении данных между ними.

Переключиться на **Graph** просмотра, выберите действие в **действия** просмотра и нажмите кнопку **действия** tab или трассировку журнала сообщений в **сообщение**Представления. Если загружено несколько файлов трассировки и действие включает трассировки из нескольких файлов, в представлении графика отображаются все соответствующие трассировки. Двойной щелчок действия или трассировках журналов сообщений также приведет к **Graph** представления.

В **Graph** представление, каждый вертикальный столбец представляет действие, и каждый блок в столбце представляет трассировку. Действия группируются в процессы (или потоки). Небольшие стрелки между действиями обозначают перенаправления. Большие стрелки между процессами обозначают обмен сообщениями. Выбранное действие всегда обозначается желтым цветом.

###### <a name="selecting-traces-in-the-graph"></a>Выбор трассировок на графике

1. Щелкните блок на графике.

2. Используйте клавиши СТРЕЛКА ВВЕРХ и СТРЕЛКА ВНИЗ для выбора соседних трассировок.

3. Просматривайте данные трассировки на панели трассировки и в области сведений.

###### <a name="expanding-or-collapsing-activity-transfers"></a>Развертывание и свертывание перенаправлений действий

Можно развернуть перенаправление действия, если выбранное действие перенаправляется на другое действие. Это позволяет следить за перенаправлениями.

Развертывание и свертывание перенаправлений действий

1. Найдите трассировку перенаправления со знаком «+» слева от значка перенаправления.

2. Щелкните знак «+», или нажмите клавишу **Ctrl** и «+» с помощью клавиатуры.

3. На графике отображается следующее действие.

4. Объект «-» отображается слева от значка перенаправления. Нажмите кнопку «-» вход, или нажмите клавиши Ctrl и «-», свернуть перенаправление действия.

> [!NOTE]
> Если развернуть одно из нескольких перенаправлений на одно действие, будут отображены действия, ведущие к новому действию из корневого действия. Эти новые действия отобразятся в свернутом виде. Если необходимо просмотреть подробные сведения об этих действиях, разверните их по вертикали, щелкнув значок развертывания в заголовке графика.

###### <a name="expanding-or-collapsing-activities-vertically"></a>Вертикальное развертывание и свертывание действий

Средство просмотра позволяет скрыть ненужные сведения на графике действий путем свертывания действий. В свернутом действии отдельные трассировки не отображаются. Отображаются только перенаправления трассировок. Чтобы просмотреть все трассировки в действии, разверните действие вертикально, щелкнув значок развертывания действия в заголовке графика.

Вертикальное развертывание и свертывание действий

1. Щелкните значок «+» в заголовке действия, чтобы развернуть действие по вертикали.

2. Обратите внимание, что на графике отображаются все трассировки.

3. Нажмите кнопку «-» значок в заголовке действия, чтобы свернуть действие по вертикали.

4. Обратите внимание, что в действии отображаются только важные трассировки перенаправлений, журналов сообщений, предупреждений и исключений.

###### <a name="options"></a>Параметры

Можно выбрать два параметра **параметр** меню в представлении графика.

- Показать трассировки границ действий. Если этот параметр отключен, трассировки границ действий на графике игнорируются.

- Показать подробные трассировки, не относящиеся к сообщениям. Если этот параметр отключен, игнорируются все подробные трассировки, за исключением трассировок сообщений. В большинстве случаев подробные трассировки не очень важны для анализа. Этот параметр полезен, если не требуется анализировать подробные трассировки, и необходимо сосредоточиться на более важных трассировках.

###### <a name="layout-mode"></a>Режим макета

В средстве просмотра предусмотрено два режима макета: **Процесс** и **потоков**. Этот параметр определяет самый большой элемент организации. По умолчанию используется режим макета **процесс**, что означает, что действия группируются в процессах на диаграмме.

###### <a name="execution-list"></a>Список выполнения

В этом раскрывающемся списке можно выбрать процесс или поток для отображения на графике. Например, если имеется два файла трассировки двух клиентов (А и Б) и открыта одна служба и необходимо отобразить на графике только службу и клиент А, можно отменить выбор клиента Б в списке.

#### <a name="viewing-trace-details"></a>Просмотр сведений трассировки

Для просмотра сведений трассировки выберите трассировку на панели трассировки. Подробные сведения отобразятся в области сведений.

##### <a name="trace-pane"></a>Панель трассировки

Панель, расположенная в правой верхней части окна Service Trace Viewer, - это панель трассировки. В ней отображаются все трассировки, существующие в выбранном действии, вместе с дополнительной информацией, такой как уровень трассировки, идентификатор потока и имя процесса.

Необработанный код XML трассировки можно скопировать в буфер обмена, щелкнув правой кнопкой мыши трассировку и выбрав **Копировать трассировку в буфер обмена**.

##### <a name="detail-pane"></a>Область сведений

Левая нижняя область окна Service Trace Viewer - это область сведений. Она содержит три вкладки для просмотра сведений трассировок.

**Форматированный** представление отображает сведения в более структурированном виде. Все известные XML-элементы отображаются в таблицах и деревьях, что облегчает чтение и восприятие информации.

**XML** представление отображает XML, соответствующий выбранной трассировке. Это представление поддерживает выделение цветом и раскраску синтаксических конструкций. При использовании **найти** для поиска строк, он выделяет результаты поиска.

**Сообщение** представление отображает часть данных XML в трассировках журналов сообщений. Эти данные скрыты при выборе трассировок, не связанных с сообщениями.

### <a name="filtering-wcf-traces"></a>Фильтрация трассировок WCF

Чтобы упростить анализ файлов трассировки, их можно фильтровать следующими способами.

- Панель инструментов фильтрации предоставляет доступ к встроенным и настраиваемым фильтрам. Его можно включить с помощью **представление** меню.

- Предварительно определенные фильтра средства просмотра можно выборочно фильтровать части трассировок WCF. По умолчанию он настроен на пропускание всех трассировок инфраструктуры. Параметры этого фильтра определяются в **параметры фильтра** подменю **представление** меню.

- Пользовательские фильтры XPath позволяют пользователям полностью контролировать процесс фильтрации. Они могут быть определены в **настраиваемый фильтр** под **представление** меню.

Отображаются только трассировки, которые проходят через все фильтры.

#### <a name="using-the-filter-toolbar"></a>Использование панели инструментов фильтра

Панель фильтра отображается в верхней части инструмента. Если он отсутствует, вы можете активировать ее в **представление** меню. Панель содержит три компонента.

- Ищите: **Найдите** определяет, что искать при фильтрации. Например, если вы хотите найти все трассировки, которые были созданы в контексте процесса Х, значение этого поля X и **поиска в** поле «Имя процесса». Это поле заменяется элементом управления выбора даты и времени, если выбран фильтр времени.

- Поиск в: Это поле определяет тип применяемого фильтра.

- Уровень: Определяет минимальный уровень трассировки допускаемый фильтром. Например, при значении "Ошибка и выше" отображаются только трассировки уровня Error или Critical. Этот фильтр комбинируется с критериями, заданными в полях «Искать» и «Диапазон поиска».

**Применить фильтр сейчас** кнопка запускает операцию фильтрации. Некоторые фильтры, особенно если они применяются к большим объемам данных, работают достаточно долго. Операции фильтрации можно отменить, нажав клавишу **остановить** кнопку, которая отображается в строке состояния в разделе **операций** меню.

**Очистить** сбрасывает встроенные и настраиваемые фильтры, чтобы разрешить все трассировки для прохождения.

#### <a name="filter-options"></a>Параметры фильтрации

Средство просмотра может автоматически удалять трассировки WCF из представления. Он также может выборочно удалять трассировки, относящиеся к отдельным областям WCF, например, удалять из представления трассировки, относящиеся к транзакциям.

Параметры этого фильтра определяются в **параметры фильтра** подменю **представление** меню.

#### <a name="custom-filters"></a>Настраиваемые фильтры

С помощью языка XML Path (XPath) можно создавать настраиваемые фильтры, позволяющие выполнять поиск данных трассировки для любого XML-элемента. Фильтры доступны на панели инструментов фильтрации.

В пользовательских фильтрах могут быть предусмотрены параметры. Также можно импортировать уже имеющиеся настраиваемые фильтры.

##### <a name="creating-a-custom-filter"></a>Создание пользовательского фильтра

Фильтры можно создавать двумя способами:

###### <a name="creating-a-custom-filter-using-the-template-wizard"></a>Создание настраиваемого фильтра с помощью мастера шаблонов

Можно щелкнуть существующую трассировку и создать фильтр на основе структуры этой трассировки. В этом примере создается настраиваемый фильтр на основе идентификатора потока.

1. На панели трассировки в правой части средства просмотра выберите трассировку, содержащую элемент, для которого требуется выполнить фильтрацию.

2. Нажмите кнопку **создать настраиваемый фильтр** расположенную в верхней части панели трассировки.

3. В появившемся диалоговом окне введите имя фильтра. В этом примере введите `Thread ID`. Также можно ввести описание фильтра.

4. В древовидном представлении слева представлена структура записи трассировки, выбранной на шаге 1. Перейдите к элементу, для которого нужно создать условие. В этом примере перейдите к атрибуту ThreadID должны размещаться в XPath: /E2ETraceEvent/System/Execution/@ThreadID узла. Дважды щелкните атрибут ThreadID в древовидном представлении. Будет создано выражение для атрибута в правой части диалогового окна.

5. Изменить поле параметра условия ThreadID с None на "{0}". В результате выполнения этого действия при применении фильтра станет возможной настройка значения ThreadID. (См. раздел "Применение фильтра".) Можно определить до четырех параметров. Условия комбинируются с помощью оператора "ИЛИ".

6. Нажмите кнопку **ОК** для создания фильтра.

> [!NOTE]
> Если фильтр создан с помощью мастера шаблонов, его можно изменять только вручную. Невозможно запустить мастер для фильтра, который уже был создан. Кроме того, условия фильтра XPath, созданного с помощью мастера шаблонов, комбинируются с помощью оператора "ИЛИ". Если необходимо использовать оператор «И», выражение фильтра можно отредактировать после его создания.

###### <a name="creating-a-custom-filter-manually"></a>Создание пользовательского фильтра вручную

В меню "Настраиваемые фильтры" можно создавать фильтры XPath вручную.

1. В меню «Вид» выберите **настраиваемые фильтры** пункта меню.

2. В появившемся диалоговом окне щелкните **New.**

3. Как минимум, следует указать имя фильтра и выражение XPath.

4. Нажмите кнопку **ОК**.

###### <a name="applying-a-custom-filter"></a>Применение пользовательского фильтра

После создания настраиваемый фильтр доступен на панели инструментов фильтрации. Выберите фильтр, необходимо применить в **поиска в** поле на панели инструментов фильтрации. В случае предыдущего примера выберите "Thread ID".

1. Укажите значение, вы ищете в **найти** поля. В данном примере введите идентификатор потока, который требуется найти.

2. Нажмите кнопку **применить фильтр сейчас**и просмотрите результаты операции.

Если в фильтре используется несколько параметров, введите их с помощью «;» в качестве разделителя в **найти** поля. Например следующая строка определяет три параметра: "1; findValue; text». Средство просмотра применяет "1" для {0} параметр фильтра. «findValue» и «текст» применяются к {1} и {2} соответственно.

###### <a name="sharing-custom-filters"></a>Совместное использование настраиваемых фильтров

Настраиваемые фильтры могут совместно использоваться различными сеансами и пользователями. Фильтры можно экспортировать в файл определения, который затем можно импортировать в другое расположение.

 Импорт настраиваемого фильтра

1. В **представление** меню, щелкните **настраиваемые фильтры**.

2. В открывшемся диалоговом выберите **импорта** кнопки.

3. Перейдите к файлу пользовательского фильтра (.stvcf), щелкните файл и нажмите кнопку **откройте** кнопки.

Экспорт настраиваемого фильтра

1. В меню «Вид» выберите **настраиваемые фильтры**.

2. В появившемся диалоговом окне выберите фильтр, который следует экспортировать.

3. Нажмите кнопку **Экспорт** кнопки.

4. Укажите имя и расположение файла определения пользовательского фильтра (.stvcf), нажмите кнопку **Сохранить** кнопки.

> [!NOTE]
> Эти пользовательские фильтры можно импортировать и экспортировать только в Service Trace Viewer. Выполнить их чтение другими средствами невозможно.

### <a name="finding-data"></a>Поиск данных

В средстве просмотра предусмотрены следующие способы поиска данных.

- Панель поиска предоставляет быстрый доступ к наиболее распространенным поисковым параметрам.

- Диалоговое окно поиска предоставляет дополнительные параметры поиска. Он доступен через **изменить** меню или сочетания клавиш Ctrl + f.

Панель инструментов поиска отображается в верхней части средства просмотра. Если он отсутствует, вы можете активировать ее в **представление** меню. Панель содержит два компонента.

- Искать: Позволяет ввести искомое ключевое слово.

- Искать в: Позволяет указать область поиска. Можно выбрать поиск во всех действиях или только в текущем действии.

Диалоговое окно поиска содержит два дополнительных параметра.

- Найти объект.

  - Параметр «необработанные данные журнала» позволяет искать ключевое слово среди всех необработанных данных.

  - Параметры «XML-текст» и «XML-атрибут» только поиск в XML-элементов.

  - Параметр «Зарегистрированное сообщение» позволяет искать ключевое слово только в сообщениях.

- Пропустить корневое действие: Процедура поиска пропускает трассировки в действии «000000000000». Этот параметр увеличивает производительность при работе с большими файлами трассировки, если корневое действие содержит тысячи трассировок, большая часть которых является перенаправлениями.

### <a name="navigating-traces"></a>Навигация по трассировкам

Поскольку трассировки записываются поэтапно во время работы приложения, навигация по трассировкам может помочь при отладке приложения. Программа Service Trace Viewer предоставляет различные способы навигации по трассировкам.

#### <a name="step-forward-or-backward"></a>Шаг вперед или назад

Если представить каждую трассировку как строку кода в программе, шаг вперед очень похоже на «Шаг с обходом» в Visual Studio интегрированной среде разработки (IDE). Единственное отличие заключается в том, что при работе с трассировками можно также совершать шаги назад. Шаг вперед означает переход к следующей трассировке в действии.

- Шаг вперед. Используйте **действия** меню или нажмите клавишу «F10». Можно также использовать клавишу со стрелкой «вниз» на панели трассировки.

- Шаг назад. Используйте **действия** меню или нажмите клавишу «F9». Можно также использовать клавишу со стрелкой «вверх» на панели трассировки.

> [!NOTE]
> Это можно перейти к действию, выполняющемуся в другом процессе или даже на другом компьютере, так как WCF-сообщений могут содержаться идентификаторы действий, охватывающие несколько компьютеров.

#### <a name="follow-transfer"></a>Отслеживание перенаправлений

Трассировки перенаправлений — это специальные трассировки в файле трассировки. Посредством трассировки перенаправления одно действие может перенаправляться другому действию. Например «Действие А» может передавать к «Действию Б». В этом случае имеется трассировка перенаправления в «Действии А» с именем «для: Действие» и значка перенаправления. Эта трассировка перенаправления является связью между двумя трассировками. В «Действии Б» также возможны трассировка перенаправления в конце действие перенаправляется обратно к «Действию А». Это похоже на вызовы функций в программах: Вызывает B, B возвращает.

«Отслеживание перенаправлений» похоже на «Step into» в отладчике. Отслеживается перенаправление от "Действия А" к "Действию Б". Это не оказывает какого-либо воздействия на другие трассировки.

Предусмотрено два способа отслеживания перенаправлений: с помощью мыши или с помощью клавиатуры.

- При помощи мыши: Дважды щелкните трассировку перенаправления на панели трассировки.

- С помощью клавиатуры: Выберите трассировки перенаправления и с помощью «Отслеживание перенаправления» в **действия** меню или нажмите клавишу «F11»

> [!NOTE]
> Во многих случаях, когда «Действие А» перенаправляется к «Действию Б», «Действие А» ожидает обратного перенаправления «Действия Б» к «Действию А». Это означает, что «Действие А» не имеет запланированных трассировок во время выполнения трассировки «Действием Б». Однако "Действие А" может не находиться в состоянии ожидания, а продолжать записывать трассировки. Также возможна ситуация, когда "Действие Б" не перенаправляется обратно к "Действию А". Таким образом, перенаправления действий все же отличаются от вызовов функций. Представление графика позволяет лучше понять суть перенаправления действий.

#### <a name="jump-to-next-or-previous-transfer"></a>Переход к следующему или предыдущему перенаправлению

При анализе текущего действия (или нескольких выбранных действий) может потребоваться быстро найти действия, к которым оно перенаправляется. Команда «Перейти к следующему перенаправлению» позволяет найти следующую трассировку перенаправления в действии. После нахождения трассировки перенаправления, можно использовать «Отслеживание перенаправления» перейти к следующему действию.

- Перейти к следующей передачи: Используйте **действия** меню или нажмите клавиши «Ctrl + F10».

- Перейти к предыдущему перенаправлению: Используйте **действия** меню или нажмите клавиши «Ctrl + F9».

#### <a name="navigate-in-graph-view"></a>Навигация в представлении графика

Несмотря на то, что Навигация в области действий и области трассировки похожа на отладку, используя **Graph** представление предоставляет гораздо более широкие возможности навигации. Ознакомьтесь с разделом «Представления диаграммы» Дополнительные сведения.

### <a name="loading-large-trace-files"></a>Загрузка больших файлов трассировки

Файлы трассировки могут быть очень большими. Например если вы включите трассировку на уровне «Подробно», то результирующий файл трассировки для несколько минут работы легко быть сотен мегабайт или более, в зависимости от сети скорости и схемы обмена данными.

При открытии очень большого файла трассировки в программе Service Trace Viewer производительность системы может значительно снизиться. Скорость загрузки может быть медленной, и может увеличиться время отклика. Фактическая скорость периодически меняется в зависимости от конфигурации оборудования. На большинстве компьютеров загрузка файла трассировки размером более 200 МБ значительно снижает производительность системы. При работе с файлами трассировки, имеющими размер более 1 Гб, программа может использовать всю доступную оперативную память или очень долго не отвечать на запросы.

Во избежание низкой скорости загрузки и продолжительного времени отклика при анализе крупных файлов трассировки, программа Service Trace Viewer предоставляет возможность «Частичная загрузка», которая загружает за раз только небольшую часть трассировки. Например, имеется файл трассировки размером более 1 Гб, работающий на сервере на протяжении нескольких дней. При возникновении некоторых ошибок и попытке анализа трассировки не требуется открывать файл трассировки целиком. Вместо этого можно загрузить трассировки за определенный период времени, когда, скорее всего, произошла ошибка. Поскольку область данных сокращается, программа Service Trace Viewer загружает файл быстрее, и можно найти ошибку, используя небольшой объем данных.

#### <a name="enabling-partial-loading"></a>Включение частичной загрузки

Включать частичную загрузку вручную не требуется. Если общий размер открываемых файлов трассировки превышает 40 МБ, программа Service Trace Viewer автоматически отображает диалоговое окно частичной загрузки, чтобы можно было выбрать часть, которую требуется загрузить.

> [!NOTE]
> Поскольку трассировки могут быть распределены по времени неравномерно, длительность периода времени, который указывается на панели инструментов частичной загрузки, может не быть пропорциональна отображаемому размеру загружаемых данных. Фактический размер загружаемых данных может быть меньше, чем предполагаемый размер, который отображается в диалоговом окне частичной загрузки.

#### <a name="adjusting-partial-loading"></a>Настройка частичной загрузки

После частичной загрузки файла трассировки может потребоваться изменить набор загружаемых данных. Это можно сделать с помощью панели инструментов частичной загрузки, расположенной в верхней части средства просмотра.

1. Переместите панель инструментов с помощью мыши или введите время начала и окончания.

2. Нажмите кнопку **Adjust** кнопки.

## <a name="understanding-trace-icons"></a>Значки трассировок

Ниже приведен список значков, используемых в программе Service Trace Viewer **действия** представлении **Graph** представление и **трассировки** панели для представления различных элементов.

> [!NOTE]
> Некоторые трассировки, которые не работают (например, «сообщение закрыто») не имеют значков.

### <a name="activity-tracing-traces"></a>Трассировки действий

|Значок|Описание|
|----------|-----------------|
|![Трассировка предупреждений](../../../docs/framework/wcf/media/7457c4ed-8383-4ac7-bada-bcb27409da58.gif "7457c4ed-8383-4ac7-bada-bcb27409da58")|Трассировка предупреждения: Трассировка, создаваемая на уровне предупреждения|
|![Трассировка ошибок](../../../docs/framework/wcf/media/7d908807-4967-4f6d-9226-d52125db69ca.gif "7d908807-4967-4f6d-9226-d52125db69ca")|Трассировка ошибок: Трассировка, создаваемая на уровне ошибки.|
|![Трассировка Start:](../../../docs/framework/wcf/media/8a728f91-5f80-4a95-afe8-0b6acd6e0317.gif "8a728f91-5f80-4a95-afe8-0b6acd6e0317")|Трассировка Start действия Трассировка, обозначающая начало действия. В ней содержится имя действия. Разработчику приложений необходимо определить одну трассировку Start для каждого идентификатора действия для каждого процесса или потока.<br /><br /> После распространения идентификатора действия по источникам трассировки для корреляции трассировок можно увидеть несколько трассировок Start для одного идентификатора действия (один для каждого источника трассировки). Трассировка Start создается, если функция ActivityTracing включена для источника трассировки.|
|![Трассировка Stop](../../../docs/framework/wcf/media/a0493e95-653e-4af8-84a4-4d09a400bc31.gif "a0493e95-653e-4af8-84a4-4d09a400bc31")|Трассировка Stop: Трассировка, обозначающая конец действия. . В ней содержится имя действия. Разработчику приложений необходимо определить одну трассировку Stop для каждого идентификатора действия для каждого источника трассировки. Ни одна трассировка из заданного источника трассировки не появляется после создания трассировки Stop источником трассировки, кроме случая, когда временное разбиение трассировки не слишком мало. В этом случае две трассировки с одним значением временного разбиения, включая Stop, могут чередоваться при отображении. После распространения идентификатора действия по источникам трассировки для корреляции трассировок можно увидеть несколько трассировок Stop для одного идентификатора действия (один для каждого источника трассировки). Трассировка Stop создается, если функция ActivityTracing включена для источника трассировки.|
|![Трассировка Suspend](../../../docs/framework/wcf/media/6f7f4191-df2b-4592-8998-8379769e2d32.gif "6f7f4191-df2b-4592-8998-8379769e2d32")|Трассировка Suspend: Трассировка, обозначающая время, когда действие приостановлено. До возобновления приостановленного действия никакие трассировки не создаются. Приостановленное действие означает, что никакой обработки в этом действии в области источника трассировки не выполняется. Трассировки Suspend и Resume полезны для профилирования. Трассировка Suspend создается, если функция ActivityTracing включена для источника трассировки.|
|![Трассировка resume](../../../docs/framework/wcf/media/1060d9d2-c9c8-4e0a-9988-cdc2f7030f17.gif "1060d9d2-c9c8-4e0a-9988-cdc2f7030f17")|Трассировка возобновления действий: Трассировка, обозначающая время возобновления действия после приостановки. В этом действии трассировки могут создаваться повторно. Трассировки Suspend и Resume полезны для профилирования. Трассировка Resume создается, если функция ActivityTracing включена для источника трассировки.|
|![Transfer](../../../docs/framework/wcf/media/b2d9850e-f362-4ae5-bb8d-9f6f3ca036a5.gif "b2d9850e-f362-4ae5-bb8d-9f6f3ca036a5")|Для передачи: Трассировка, создаваемая при передаче процесса логического контроля от одного действия к другому. Действие, от которого происходит перенаправление, может продолжать выполнение работы параллельно действию, к которому осуществляется перенаправление. Трассировка Transfer создается, если функция ActivityTracing включена для источника трассировки.|
|![Перенос из](../../../docs/framework/wcf/media/1df215cb-b344-4f36-a20d-195999bda741.gif "1df215cb-b344-4f36-a20d-195999bda741")|Перенос из: Трассировка, определяющая перенаправление из другого действия к текущему действию.|
|![Перенос](../../../docs/framework/wcf/media/74255b6e-7c47-46ef-8e53-870c76b04c3f.gif "74255b6e-7c47-46ef-8e53-870c76b04c3f")|Перенос: Трассировка, определяющая перенаправление процесса логического контроля от текущего действия к другому действию.|

### <a name="wcf-traces"></a>Трассировки WCF

|Значок|Описание:|
|----------|-----------------|
|![Трассировка журнала сообщений](../../../docs/framework/wcf/media/7c66e994-2476-4260-a0db-98948b9af197.gif "7c66e994-2476-4260-a0db-98948b9af197")|Трассировка журнала сообщений: Трассировка, которая создается, когда записывается сообщение WCF с помощью функции ведения журнала сообщений при `System.ServiceModel.MessageLogging` включении источника трассировки. При щелчке трассировки отображается сообщение. Существует четыре настраиваемые точки ведения журнала для сообщения. ServiceLevelSendRequest, TransportSend, TransportReceive и ServiceLevelReceiveRequest, которые также можно указать, `messageSource` атрибут в трассировке журнала сообщений.|
|![Трассировка Message Received](../../../docs/framework/wcf/media/de4f586c-c5dd-41ec-b1c3-ac56b4dfa35c.gif "de4f586c-c5dd-41ec-b1c3-ac56b4dfa35c")|Трассировка Message Received: Трассировка, которая создается при получении сообщения WCF, если `System.ServiceModel` источник трассировки включен на уровне Information или Verbose. Эта трассировка просматривать путь корреляции сообщений в действии **Graph** представления.|
|![Трассировка Message Sent](../../../docs/framework/wcf/media/558943c4-17cf-4c12-9405-677e995ac387.gif "558943c4-17cf-4c12-9405-677e995ac387")|Трассировка отправки сообщений: Трассировка, которая создается при отправке сообщения WCF, если `System.ServiceModel` источник трассировки включен на уровне Information или Verbose. Эта трассировка просматривать путь корреляции сообщений в действии **Graph** представления.|

### <a name="activities"></a>Действия

|Значок|Описание|
|----------|-----------------|
|![Activity](../../../docs/framework/wcf/media/wcfc-defaultactivityc.gif "wcfc_defaultActivityc")|Действие: Указывает, что текущее действие является общим действием.|
|![Действие root](../../../docs/framework/wcf/media/5dc8e0eb-1c32-4076-8c66-594935beaee9.gif "5dc8e0eb-1c32-4076-8c66-594935beaee9")|Корневое действие: Обозначает корневое действие процесса.|

### <a name="wcf-activities"></a>Действия WCF

|Значок|Описание:|
|----------|-----------------|
|![Действие среды](../../../docs/framework/wcf/media/29fa00ac-cf78-46e5-822d-56222fff61d1.gif "29fa00ac-cf78-46e5-822d-56222fff61d1")|Действие среды: Действие, создающее, открывающее или закрывающее узел WCF или клиента. Ошибки, произошедшие в ходе этих этапов, отображаются в данном действии.|
|![Действие Listen](../../../docs/framework/wcf/media/d7b135f6-ec7d-45d7-9913-037ab30e4c26.gif "d7b135f6-ec7d-45d7-9913-037ab30e4c26")|Действие ожидания передачи данных: Действие, записывающее трассировки, которые относятся к прослушивателю. В этом действии можно просматривать информацию о прослушивателе и запросы соединения.|
|![Действие receive Bytes](../../../docs/framework/wcf/media/2f628580-b80f-45a7-925b-616c96426c0e.gif "2f628580-b80f-45a7-925b-616c96426c0e")|Действие receive Bytes: Действие, группирующее все трассировки, относящиеся к получению входящих байтов на соединение между двумя конечными точками. Это действие необходимо для корреляции с действиями транспорта, распространяющими свой идентификатор действия, например http.sys. В этом действии отображаются ошибки соединения, такие как прерывание связи.|
|![Действие Process Message](../../../docs/framework/wcf/media/wcfc-executionactivityiconc.GIF "wcfc_ExecutionActivityIconc")|Действие Process Message: Действие, группирующее трассировки, относящиеся к созданию сообщения WCF. В этом действии отображаются ошибки, связанные с неправильным конвертом или неправильно сформированным сообщением. В этом действии можно просматривать заголовки сообщений, чтобы проверить выполнение распространения идентификатора действия от вызывающего. Если распространение выполнено, при перенаправлении действия Process Action (следующий значок) можно также назначить этому действию распространенный идентификатор действия для корреляции трассировок вызывающего и вызываемого.|
|![Трассировка журнала сообщений](../../../docs/framework/wcf/media/7c66e994-2476-4260-a0db-98948b9af197.gif "7c66e994-2476-4260-a0db-98948b9af197")|Действие Process Action: Действие, группирующее все трассировки, связанные с запросом, WCF, между двумя конечными точками. Если в конфигурации обеих конечных точек для параметра `propagateActivity` задано значение `true`, все трассировки от этих конечных точек объединяются в одно действие для непосредственной корреляции. Такое действие будет содержать ошибки, обусловленные обработкой транспорта или безопасности, а также расширением до границы пользовательского кода и обратным сужением (если существует отклик).|
|![Действие Process Message](../../../docs/framework/wcf/media/wcfc-executionactivityiconc.GIF "wcfc_ExecutionActivityIconc")|Действие EXECUTE User Code: Действие, группирующее трассировки пользовательского кода для обработки запроса.|

## <a name="troubleshooting"></a>Устранение неполадок

Если у вас нет разрешения на запись в реестр, вы получаете следующее сообщение об ошибке «Microsoft Service Trace Viewer не была зарегистрирована в системе» при использовании "`svctraceviewer /register`" команду, чтобы зарегистрировать средство. В этом случае необходимо войти в систему с использованием учетной записи, у которой имеется право записи в реестр.

Кроме того, программа Service Trace Viewer записывает некоторые параметры (например, параметры настраиваемых фильтров и фильтрации) в файл SvcTraceViewer.exe.settings в папке сборки. При отсутствии разрешения на чтение файла можно по-прежнему запустить программу, но нельзя загрузить параметры.

Отображение сообщения об ошибке "Неизвестная ошибка во время обработки одной или более трассировок" при открытии ETL-файла означает, что этот файл имеет недопустимый формат.

Если открыть журнал трассировки в операционной системе на арабском языке, можно заметить, что фильтр времени не работает. Например, 2005 год соответствует 1427 году в арабском календаре. Однако диапазон времени, поддерживаемый фильтром в программе «Просмотр трассировки службы», не включает даты ранее 1752 г. В результате может оказаться невозможным выбрать правильную дату в фильтре. Чтобы устранить эту проблему, можно создать настраиваемый фильтр (**вид/настраиваемые фильтры**) с использованием выражения XPath для включения конкретный временной диапазон.

## <a name="see-also"></a>См. также

- [Использование программы Service Trace Viewer для просмотра скоррелированных трассировок и устранения неполадок](../../../docs/framework/wcf/diagnostics/tracing/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting.md)
- [Настройка трассировки](../../../docs/framework/wcf/diagnostics/tracing/configuring-tracing.md)
- [Сквозная трассировка](./diagnostics/tracing/end-to-end-tracing.md)
