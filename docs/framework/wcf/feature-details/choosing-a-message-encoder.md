---
title: Выбор кодировщика сообщений
ms.date: 03/30/2017
ms.assetid: 2204d82d-d962-4922-a79e-c9a231604f19
ms.openlocfilehash: a306896af7a73d43956638981908c12d86126a9f
ms.sourcegitcommit: 59e36e65ac81cdd094a5a84617625b2a0ff3506e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "80345258"
---
# <a name="choosing-a-message-encoder"></a><span data-ttu-id="2bb37-102">Выбор кодировщика сообщений</span><span class="sxs-lookup"><span data-stu-id="2bb37-102">Choosing a Message Encoder</span></span>
<span data-ttu-id="2bb37-103">На этой теме обсуждаются критерии выбора среди кодеров сообщений, включенных в Фонд коммуникаций Windows (WCF): двоичный, текстовый и механизм оптимизации передачи сообщений (MTOM).</span><span class="sxs-lookup"><span data-stu-id="2bb37-103">This topic discusses criteria for choosing among the message encoders that are included in Windows Communication Foundation (WCF): binary, text, and Message Transmission Optimization Mechanism (MTOM).</span></span>  
  
 <span data-ttu-id="2bb37-104">В WCF указано, как передавать данные по сети между конечными точками с помощью *связывания,* которая состоит из последовательности *связывающих элементов.*</span><span class="sxs-lookup"><span data-stu-id="2bb37-104">In WCF, you specify how to transfer data across a network between endpoints by means of a *binding*, which is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="2bb37-105">Кодировщик сообщений - это элемент привязки кодирования сообщений в стеке привязки.</span><span class="sxs-lookup"><span data-stu-id="2bb37-105">A message encoder is represented by a message encoding binding element in the binding stack.</span></span> <span data-ttu-id="2bb37-106">В привязку входят необязательные элементы привязки протокола, такие как элемент привязки безопасности или элемент привязки надежного обмена сообщениями, обязательный элемент привязки кодирования сообщений, и обязательный элемент привязки транспорта.</span><span class="sxs-lookup"><span data-stu-id="2bb37-106">A binding includes optional protocol binding elements, such as a security binding element or reliable messaging binding element, a required message encoding binding element, and a required transport binding element.</span></span>  
  
 <span data-ttu-id="2bb37-107">Элемент привязки кодирования сообщений находится под необязательными элементами привязки протокола и над обязательным элементом привязки транспорта.</span><span class="sxs-lookup"><span data-stu-id="2bb37-107">The message encoding binding element sits below the optional protocol binding elements and above the required transport binding element.</span></span> <span data-ttu-id="2bb37-108">На стороне отправки кодировщик сообщений сериализует исходящий объект <xref:System.ServiceModel.Channels.Message> и передает его транспорту.</span><span class="sxs-lookup"><span data-stu-id="2bb37-108">On the outgoing side, a message encoder serializes the outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport.</span></span> <span data-ttu-id="2bb37-109">На стороне приема кодировщик сообщений получает сериализованную форму объекта <xref:System.ServiceModel.Channels.Message> от транспорта и передает его на более высокий уровень протоколов, если он имеется, или приложению в противном случае.</span><span class="sxs-lookup"><span data-stu-id="2bb37-109">On the incoming side, a message encoder receives the serialized form of a <xref:System.ServiceModel.Channels.Message> from the transport and passes it to the higher protocol layer, if present, or to the application, if not.</span></span>  
  
 <span data-ttu-id="2bb37-110">При соединении с существующим клиентом или сервером возможно, что выбирать кодировщик не придется: кодировать сообщения необходимо способом, которого ожидает другая сторона.</span><span class="sxs-lookup"><span data-stu-id="2bb37-110">When connecting to a pre-existing client or server, you may not have a choice about using a particular message encoding since you need to encode your messages in a way that the other side is expecting.</span></span> <span data-ttu-id="2bb37-111">Однако, если вы пишете службу WCF, вы можете разоблачить вашу службу через несколько конечных точек, каждая из которых использует различные кодирования сообщений.</span><span class="sxs-lookup"><span data-stu-id="2bb37-111">However, if you are writing an WCF service, you can expose your service through multiple endpoints, each using a different message encoding.</span></span> <span data-ttu-id="2bb37-112">Это позволяет клиентам выбирать оптимальный способ кодирования для взаимодействия со службой через оптимальную для них конечную точку, т. е. клиентам предоставляется возможность выбирать способ кодирования, лучше всего им подходящий.</span><span class="sxs-lookup"><span data-stu-id="2bb37-112">This allows clients to choose the best encoding for talking to your service over the endpoint that is best for them, as well as giving your clients the flexibility to choose the encoding that is best for them.</span></span> <span data-ttu-id="2bb37-113">Использование нескольких конечных точек также позволяет сочетать преимущества разных способов кодирования сообщений с другими элементами привязки.</span><span class="sxs-lookup"><span data-stu-id="2bb37-113">Using multiple endpoints also allows you to combine the advantages of different message encodings with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="2bb37-114">Кодировщики, предоставляемые системой</span><span class="sxs-lookup"><span data-stu-id="2bb37-114">System-Provided Encoders</span></span>  
 <span data-ttu-id="2bb37-115">WCF включает в себя три кодера сообщений, которые представлены следующими тремя классами:</span><span class="sxs-lookup"><span data-stu-id="2bb37-115">WCF includes three message encoders, which are represented by the following three classes:</span></span>  
  
- <span data-ttu-id="2bb37-116"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> - текстовый кодировщик сообщений - поддерживает и кодирование в простой XML, и кодирование SOAP.</span><span class="sxs-lookup"><span data-stu-id="2bb37-116"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>, the text message encoder, supports both plain XML encoding and SOAP encoding.</span></span> <span data-ttu-id="2bb37-117">Режим кодирования в простой XML текстового кодировщика называется "plain old XML" (POX), что позволяет отличить его от текстового кодирования SOAP.</span><span class="sxs-lookup"><span data-stu-id="2bb37-117">The plain XML encoding mode of the text message encoder is called "plain old XML" (POX) to distinguish it from text-based SOAP encoding.</span></span> <span data-ttu-id="2bb37-118">Чтобы включить POX, присвойте свойству <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement.MessageVersion%2A> значение <xref:System.ServiceModel.Channels.MessageVersion.None%2A>.</span><span class="sxs-lookup"><span data-stu-id="2bb37-118">To enable POX, set the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement.MessageVersion%2A> property to <xref:System.ServiceModel.Channels.MessageVersion.None%2A>.</span></span> <span data-ttu-id="2bb37-119">Используйте кодер текстового сообщения для работы с конечными точками, не входящих в WCF.</span><span class="sxs-lookup"><span data-stu-id="2bb37-119">Use the text message encoder to interoperate with non-WCF endpoints.</span></span>  
  
- <span data-ttu-id="2bb37-120"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, бинарный кодеер сообщения, использует компактный двоичный формат и оптимизирован для WCF к WCF связи, и, следовательно, не совместим.</span><span class="sxs-lookup"><span data-stu-id="2bb37-120"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, the binary message encoder, uses a compact binary format and is optimized for WCF to WCF communication, and hence is not interoperable.</span></span> <span data-ttu-id="2bb37-121">Это также самый эффективный кодер из всех кодеров WCF предоставляет.</span><span class="sxs-lookup"><span data-stu-id="2bb37-121">This is also the most performant encoder of all the encoders WCF provides.</span></span>  
  
- <span data-ttu-id="2bb37-122"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> - элемент привязки - задает способ кодирования и управления версиями для сообщений, использующих кодирование MTOM.</span><span class="sxs-lookup"><span data-stu-id="2bb37-122"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, the binding element, specifies the character encoding and message versioning for messages using MTOM encoding.</span></span> <span data-ttu-id="2bb37-123">MTOM - это эффективный способ передачи двоичных данных в сообщениях WCF.</span><span class="sxs-lookup"><span data-stu-id="2bb37-123">MTOM is an efficient technology for transmitting binary data in WCF messages.</span></span> <span data-ttu-id="2bb37-124">Кодировщик MTOM пытается сохранить баланс между эффективностью и совместимостью.</span><span class="sxs-lookup"><span data-stu-id="2bb37-124">The MTOM encoder attempts to create a balance between efficiency and interoperability.</span></span> <span data-ttu-id="2bb37-125">Кодирование MTOM передает большую часть XML-данных в текстовой форме, но оптимизирует большие блоки двоичных данных путем передачи их в исходном виде, без преобразования в текст.</span><span class="sxs-lookup"><span data-stu-id="2bb37-125">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span> <span data-ttu-id="2bb37-126">С точки зрения эффективности, среди кодеров WCF обеспечивает, MTOM находится между текстом (самый медленный) и двоичный (самый быстрый).</span><span class="sxs-lookup"><span data-stu-id="2bb37-126">In terms of efficiency, among the encoders WCF provides, MTOM is in-between text (the slowest) and binary (the fastest).</span></span>  
  
## <a name="how-to-choose-a-message-encoder"></a><span data-ttu-id="2bb37-127">Выбор кодировщика сообщений</span><span class="sxs-lookup"><span data-stu-id="2bb37-127">How to Choose a Message Encoder</span></span>  
 <span data-ttu-id="2bb37-128">В следующей таблице приведены факторы, чаще всего влияющие на выбор кодировщика сообщений.</span><span class="sxs-lookup"><span data-stu-id="2bb37-128">The following table describes common factors used to choose a message encoder.</span></span> <span data-ttu-id="2bb37-129">Расположите эти факторы в соответствии с их приоритетом для данного приложения и выберите оптимальные кодировщики сообщений.</span><span class="sxs-lookup"><span data-stu-id="2bb37-129">Prioritize the factors that are important for your application, and then choose the message encoders that work best with these factors.</span></span> <span data-ttu-id="2bb37-130">Не забудьте принять во внимание все дополнительные факторы, не приведенные в этой таблице, а также пользовательские кодировщики сообщений, которые могут понадобиться в приложении.</span><span class="sxs-lookup"><span data-stu-id="2bb37-130">Be sure to consider any additional factors not listed in this table and any custom message encoders that may be required in your application.</span></span>  
  
|<span data-ttu-id="2bb37-131">Фактор</span><span class="sxs-lookup"><span data-stu-id="2bb37-131">Factor</span></span>|<span data-ttu-id="2bb37-132">Описание</span><span class="sxs-lookup"><span data-stu-id="2bb37-132">Description</span></span>|<span data-ttu-id="2bb37-133">Кодировщики, поддерживающие этот фактор</span><span class="sxs-lookup"><span data-stu-id="2bb37-133">Encoders that support this factor</span></span>|  
|------------|-----------------|---------------------------------------|  
|<span data-ttu-id="2bb37-134">Поддерживаемые кодировки</span><span class="sxs-lookup"><span data-stu-id="2bb37-134">Supported Character Sets</span></span>|<span data-ttu-id="2bb37-135"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>и <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> поддерживают только кодирования UTF8 и UTF16 Unicode *(большие* и *малоконечные*коды).</span><span class="sxs-lookup"><span data-stu-id="2bb37-135"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> and <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> support only the UTF8 and UTF16 Unicode (*big-endian* and *little-endian*) encodings.</span></span> <span data-ttu-id="2bb37-136">Если требуются другие кодировки, такие как UTF7 или ASCII, необходимо использовать пользовательский кодировщик.</span><span class="sxs-lookup"><span data-stu-id="2bb37-136">If other encodings are required, such as UTF7 or ASCII, a custom encoder must be used.</span></span> <span data-ttu-id="2bb37-137">Для примера пользовательского кодера [см.](https://docs.microsoft.com/dotnet/framework/wcf/samples/custom-message-encoder-custom-text-encoder)</span><span class="sxs-lookup"><span data-stu-id="2bb37-137">For a sample custom encoder, see [Custom Message Encoder](https://docs.microsoft.com/dotnet/framework/wcf/samples/custom-message-encoder-custom-text-encoder).</span></span>|<span data-ttu-id="2bb37-138">Text</span><span class="sxs-lookup"><span data-stu-id="2bb37-138">Text</span></span>|  
|<span data-ttu-id="2bb37-139">Проверка</span><span class="sxs-lookup"><span data-stu-id="2bb37-139">Inspection</span></span>|<span data-ttu-id="2bb37-140">Под проверкой понимается возможность анализа сообщений во время передачи.</span><span class="sxs-lookup"><span data-stu-id="2bb37-140">Inspection is the ability to examine messages during transmission.</span></span> <span data-ttu-id="2bb37-141">Текстовое кодирование (как с использованием SOAP, так и без) позволяет ряду приложений проверять и анализировать сообщения без использования специализированных инструментов.</span><span class="sxs-lookup"><span data-stu-id="2bb37-141">Text encodings, either with or without the use of SOAP, allow messages to be inspected and analyzed by many applications without the use of specialized tools.</span></span> <span data-ttu-id="2bb37-142">Обратите внимание, что возможность проверки сообщений зависит от использования механизма безопасности транспорта (на уровне сообщения или на уровне транспорта).</span><span class="sxs-lookup"><span data-stu-id="2bb37-142">Note that the use of transfer security, at either the message or transport level, affects your ability to inspect messages.</span></span> <span data-ttu-id="2bb37-143">Конфиденциальность подразумевает защиту сообщения от анализа, а целостность - от изменения.</span><span class="sxs-lookup"><span data-stu-id="2bb37-143">Confidentiality protects a message from being examined and integrity protects a message from being modified.</span></span>|<span data-ttu-id="2bb37-144">Text</span><span class="sxs-lookup"><span data-stu-id="2bb37-144">Text</span></span>|  
|<span data-ttu-id="2bb37-145">Надежность</span><span class="sxs-lookup"><span data-stu-id="2bb37-145">Reliability</span></span>|<span data-ttu-id="2bb37-146">Надежность - это устойчивость кодировщика к ошибкам передачи.</span><span class="sxs-lookup"><span data-stu-id="2bb37-146">Reliability is the resiliency of an encoder to transmission errors.</span></span> <span data-ttu-id="2bb37-147">Надежность также может обеспечиваться на уровне сообщения, транспорта или приложения.</span><span class="sxs-lookup"><span data-stu-id="2bb37-147">Reliability can also be provided at the message, transport, or application layer.</span></span> <span data-ttu-id="2bb37-148">Все стандартные кодеры WCF предполагают, что еще один слой обеспечивает надежность.</span><span class="sxs-lookup"><span data-stu-id="2bb37-148">All of the standard WCF encoders assume that another layer is providing reliability.</span></span> <span data-ttu-id="2bb37-149">Способность кодировщика восстановиться после ошибки передачи весьма ограничена.</span><span class="sxs-lookup"><span data-stu-id="2bb37-149">The encoder has little ability to recover from a transmission error.</span></span>|<span data-ttu-id="2bb37-150">None</span><span class="sxs-lookup"><span data-stu-id="2bb37-150">None</span></span>|  
|<span data-ttu-id="2bb37-151">Простота</span><span class="sxs-lookup"><span data-stu-id="2bb37-151">Simplicity</span></span>|<span data-ttu-id="2bb37-152">Под простотой понимается простота создания кодировщиков и декодеров по спецификации кодирования.</span><span class="sxs-lookup"><span data-stu-id="2bb37-152">Simplicity represents the ease with which you can create encoders and decoders for an encoding specification.</span></span> <span data-ttu-id="2bb37-153">В этом отношении особо предпочтительны текстовые способы кодирования, причем текстовое кодирование POX имеет дополнительное преимущество - не требует поддержки обработки SOAP.</span><span class="sxs-lookup"><span data-stu-id="2bb37-153">Text encodings are particularly advantageous for simplicity, and the POX text encoding has the additional advantage of not requiring support for processing SOAP.</span></span>|<span data-ttu-id="2bb37-154">Текстовый (POX)</span><span class="sxs-lookup"><span data-stu-id="2bb37-154">Text (POX)</span></span>|  
|<span data-ttu-id="2bb37-155">Размер</span><span class="sxs-lookup"><span data-stu-id="2bb37-155">Size</span></span>|<span data-ttu-id="2bb37-156">Способ кодирования определяет объем служебных данных, налагаемых на содержимое.</span><span class="sxs-lookup"><span data-stu-id="2bb37-156">The encoding determines the amount of overhead imposed on content.</span></span> <span data-ttu-id="2bb37-157">Размер кодированных сообщений напрямую связан с максимальной пропускной способностью операций службы.</span><span class="sxs-lookup"><span data-stu-id="2bb37-157">The size of encoded messages is directly related to the maximum throughput of service operations.</span></span> <span data-ttu-id="2bb37-158">Двоичные способы обычно обеспечивают более компактное кодирование, чем текстовые.</span><span class="sxs-lookup"><span data-stu-id="2bb37-158">Binary encodings are generally more compact than text encodings.</span></span> <span data-ttu-id="2bb37-159">Когда размер сообщений имеет большое значение, следует рассмотреть также сжатие содержимого сообщений при кодировании.</span><span class="sxs-lookup"><span data-stu-id="2bb37-159">When message size is at a premium, consider also compressing the message contents during encoding.</span></span> <span data-ttu-id="2bb37-160">При этом следует помнить, что сжатие увеличивает вычислительные затраты как на стороне отправки, так и на стороне приема сообщений.</span><span class="sxs-lookup"><span data-stu-id="2bb37-160">However, compression adds processing costs for both the message sender and receiver.</span></span>|<span data-ttu-id="2bb37-161">Двоичные данные</span><span class="sxs-lookup"><span data-stu-id="2bb37-161">Binary</span></span>|  
|<span data-ttu-id="2bb37-162">Потоковая передача</span><span class="sxs-lookup"><span data-stu-id="2bb37-162">Streaming</span></span>|<span data-ttu-id="2bb37-163">Потоковая передача позволяет приложениям начинать обработку сообщения до получения всего сообщения.</span><span class="sxs-lookup"><span data-stu-id="2bb37-163">Streaming allows applications to begin processing a message before the entire message has arrived.</span></span> <span data-ttu-id="2bb37-164">Эффективное использование потоковой передачи требует, чтобы важные данные содержались в начале сообщения, т. е. получающему приложению не нужно было дожидаться их поступления.</span><span class="sxs-lookup"><span data-stu-id="2bb37-164">Effectively using streaming requires that the important data for a message be available at the beginning of the message so that the receiving application is not required to wait for it to arrive.</span></span> <span data-ttu-id="2bb37-165">Кроме того, приложения, использующие потоковую передачу, должны организовывать данные в сообщениях инкрементно, чтобы в содержимом не было зависимостей от последующих данных.</span><span class="sxs-lookup"><span data-stu-id="2bb37-165">Moreover, applications that use streamed transfer must organize data in the message incrementally so that the content does not have forward dependencies.</span></span> <span data-ttu-id="2bb37-166">Во многих случаях приходится идти на компромисс между потоковой передачей сообщения и минимальным размером передачи для содержимого.</span><span class="sxs-lookup"><span data-stu-id="2bb37-166">In many cases, you must compromise between streaming content and having the smallest possible transfer size for that content.</span></span>|<span data-ttu-id="2bb37-167">None</span><span class="sxs-lookup"><span data-stu-id="2bb37-167">None</span></span>|  
|<span data-ttu-id="2bb37-168">Поддержка сторонних инструментов</span><span class="sxs-lookup"><span data-stu-id="2bb37-168">3rd Party Tool Support</span></span>|<span data-ttu-id="2bb37-169">Возможная поддержка включает разработку и диагностику.</span><span class="sxs-lookup"><span data-stu-id="2bb37-169">Support areas for an encoding include development and diagnosis.</span></span> <span data-ttu-id="2bb37-170">Сторонние разработчики делают большие вложения в библиотеки и наборы инструментов для обработки сообщений, кодированных в формат POX.</span><span class="sxs-lookup"><span data-stu-id="2bb37-170">Third-party developers have made a large investment in libraries and toolkits for handling messages encoded in the POX format.</span></span>|<span data-ttu-id="2bb37-171">Текстовый (POX)</span><span class="sxs-lookup"><span data-stu-id="2bb37-171">Text (POX)</span></span>|  
|<span data-ttu-id="2bb37-172">Взаимодействие</span><span class="sxs-lookup"><span data-stu-id="2bb37-172">Interoperability</span></span>|<span data-ttu-id="2bb37-173">Этот фактор относится к способности кодера WCF работать с не-WCF услуг.</span><span class="sxs-lookup"><span data-stu-id="2bb37-173">This factor refers to the ability of a WCF encoder to interoperate with non-WCF services.</span></span>|<span data-ttu-id="2bb37-174">Text</span><span class="sxs-lookup"><span data-stu-id="2bb37-174">Text</span></span><br /><br /> <span data-ttu-id="2bb37-175">MTOM (частично)</span><span class="sxs-lookup"><span data-stu-id="2bb37-175">MTOM (partial)</span></span>|  
  
<span data-ttu-id="2bb37-176">Примечание. При использовании двоичного кодировщика использование параметра IgnoreWhitespace при создании XmlReader не оказывает никакого влияния.</span><span class="sxs-lookup"><span data-stu-id="2bb37-176">Note: When using the Binary Encoder, using the IgnoreWhitespace setting when creating a XMLReader will have no effect.</span></span>  <span data-ttu-id="2bb37-177">Например, если в операции службы выполняются следующие действия.</span><span class="sxs-lookup"><span data-stu-id="2bb37-177">For example, if you do the following inside a service operation:</span></span>  

```csharp
public void OperationContract(XElement input)
{
    Console.WriteLine("{0}", input.Value);
    int counter = 0;
    var xreader = input.CreateReader();
    var reader = XmlReader.Create(xreader, new XmlReaderSettings() { IgnoreWhitespace = true });
    while (reader.Read())
    {
        counter++;
    }

    Console.WriteLine("Read {0} lines with reader", counter);
}
```  
  
<span data-ttu-id="2bb37-178">Параметр IgnoreWhitespace не учитывается.</span><span class="sxs-lookup"><span data-stu-id="2bb37-178">The IgnoreWhitespace setting is ignored.</span></span>  
  
## <a name="compression-and-the-binary-encoder"></a><span data-ttu-id="2bb37-179">Сжатие и двоичный кодировщик</span><span class="sxs-lookup"><span data-stu-id="2bb37-179">Compression and the Binary Encoder</span></span>

<span data-ttu-id="2bb37-180">Начиная с версии WCF 4.5, в двоичном кодировщике появилась поддержка сжатия.</span><span class="sxs-lookup"><span data-stu-id="2bb37-180">Beginning with WCF 4.5 the WCF binary encoder adds support for compression.</span></span> <span data-ttu-id="2bb37-181">Это позволяет использовать алгоритм gzip/deflate для передачи сжатых сообщений из WCF-клиента и отправлять сжатые сообщения из резидентной службы WCF.</span><span class="sxs-lookup"><span data-stu-id="2bb37-181">This enables you to use the gzip/deflate algorithm for sending compressed messages from a WCF client and also respond with compressed messages from a self-hosted WCF service.</span></span> <span data-ttu-id="2bb37-182">Эта возможность обеспечивает сжатие сообщения для HTTP и TCP-каналов.</span><span class="sxs-lookup"><span data-stu-id="2bb37-182">This feature enables compression on both the HTTP and TCP transports.</span></span> <span data-ttu-id="2bb37-183">WCF-службу, размещенную в IIS, можно настроить на повсеместную отправку сжатых ответов, выполнив соответствующую настройку узла IIS.</span><span class="sxs-lookup"><span data-stu-id="2bb37-183">An IIS hosted WCF service can always be enabled for sending compressed responses by configuring the IIS host server.</span></span> <span data-ttu-id="2bb37-184">Тип сжатия задается с помощью свойства <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement.CompressionFormat%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2bb37-184">The type of compression is configured with the <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement.CompressionFormat%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="2bb37-185">Свойству присваивается одно из значений перечисления <xref:System.ServiceModel.Channels.CompressionFormat?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2bb37-185">This property is set to one of the <xref:System.ServiceModel.Channels.CompressionFormat?displayProperty=nameWithType> enum values:</span></span>

- <xref:System.ServiceModel.Channels.CompressionFormat.Deflate>
- <xref:System.ServiceModel.Channels.CompressionFormat.GZip>
- <xref:System.ServiceModel.Channels.CompressionFormat.None>
  
<span data-ttu-id="2bb37-186">Так как это свойство разоблачается только на binaryMessageEncodingBindingElement, вам нужно будет создать пользовательский связывание, как следующее, чтобы использовать эту функцию:</span><span class="sxs-lookup"><span data-stu-id="2bb37-186">Since this property is only exposed on the binaryMessageEncodingBindingElement, you will need to create a custom binding like the following to use this feature:</span></span>

 ```xml
 <customBinding>
   <binding name="BinaryCompressionBinding">
     <binaryMessageEncoding compressionFormat ="GZip" />
     <httpTransport />
  </binding>
</customBinding>
 ```

<span data-ttu-id="2bb37-187">Как клиент, так и служба должны договориться об отправке и получении сжатых сообщений, и поэтому свойство compressionFormat должно быть настроено на элемент binaryMessageEncoding как на клиенте, так и на сервисе.</span><span class="sxs-lookup"><span data-stu-id="2bb37-187">Both the client and the service need to agree to send and receive compressed messages and therefore the compressionFormat property must be configured on the binaryMessageEncoding element on both client and service.</span></span> <span data-ttu-id="2bb37-188">Исключение ProtocolException выдается, если служба или клиент не использует сжатие, но оно используется на другой стороне. Следует внимательно обдумать возможность использования сжатия.</span><span class="sxs-lookup"><span data-stu-id="2bb37-188">A ProtocolException is thrown if either the service or client is not configured for compression but the other side is.Enabling compression should be carefully considered.</span></span> <span data-ttu-id="2bb37-189">Сжатие наиболее полезно в том случае, когда пропускная способность канала является узким местом в системе.</span><span class="sxs-lookup"><span data-stu-id="2bb37-189">Compression is mostly useful if network bandwidth is a bottleneck.</span></span> <span data-ttu-id="2bb37-190">В тех случаях, когда узким местом для производительности является ЦП, сжатие снизит пропускную способность системы.</span><span class="sxs-lookup"><span data-stu-id="2bb37-190">In the case where the CPU is the bottleneck, compression will decrease throughput.</span></span> <span data-ttu-id="2bb37-191">Для определения полезности применения сжатия для работы системе следует выполнить соответствующие тесты в симулированной среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="2bb37-191">Appropriate testing must be done in a simulated environment to find out if this benefits the application</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2bb37-192">См. также</span><span class="sxs-lookup"><span data-stu-id="2bb37-192">See also</span></span>

- [<span data-ttu-id="2bb37-193">Привязки</span><span class="sxs-lookup"><span data-stu-id="2bb37-193">Bindings</span></span>](../../../../docs/framework/wcf/feature-details/bindings.md)
