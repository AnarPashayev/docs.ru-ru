---
title: Раскрытие информации
ms.date: 03/30/2017
ms.assetid: 4064c89f-afa6-444a-aa7e-807ef072131c
ms.openlocfilehash: 0bcf1aa04d7ba7477a6c3f1559a77bbda1f974af
ms.sourcegitcommit: 09b4090b78f52fd09b0e430cd4b26576f1fdf96e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2020
ms.locfileid: "76211958"
---
# <a name="information-disclosure"></a><span data-ttu-id="a7826-102">Раскрытие информации</span><span class="sxs-lookup"><span data-stu-id="a7826-102">Information Disclosure</span></span>

<span data-ttu-id="a7826-103">Раскрытие информации позволяет злоумышленнику получить ценную информацию о системе.</span><span class="sxs-lookup"><span data-stu-id="a7826-103">Information disclosure enables an attacker to gain valuable information about a system.</span></span> <span data-ttu-id="a7826-104">Следовательно, всегда обращайте внимание на то, какая информация раскрывается, и может ли ее использовать злоумышленник.</span><span class="sxs-lookup"><span data-stu-id="a7826-104">Therefore, always consider what information you are revealing and whether it can be used by a malicious user.</span></span> <span data-ttu-id="a7826-105">Далее перечислены возможные атаки, связанные с раскрытием информации, и способы устранения рисков.</span><span class="sxs-lookup"><span data-stu-id="a7826-105">The following lists possible information disclosure attacks and provides mitigations for each.</span></span>

## <a name="message-security-and-http"></a><span data-ttu-id="a7826-106">Безопасность сообщений и HTTP</span><span class="sxs-lookup"><span data-stu-id="a7826-106">Message Security and HTTP</span></span>

<span data-ttu-id="a7826-107">При использовании безопасности уровня сообщений на транспортном уровне HTTP помните, что безопасность уровня сообщений не обеспечивает защиту заголовков HTTP.</span><span class="sxs-lookup"><span data-stu-id="a7826-107">If you are using message-level security over an HTTP transport layer, be aware that message-level security does not protect HTTP headers.</span></span> <span data-ttu-id="a7826-108">Единственный способ защиты заголовков HTTP - использование транспорта HTTPS вместо HTTP.</span><span class="sxs-lookup"><span data-stu-id="a7826-108">The only way to protect HTTP headers is to use HTTPS transport instead of HTTP.</span></span> <span data-ttu-id="a7826-109">При использовании транспорта HTTPS все сообщение, включая заголовки HTTP, шифруется по протоколу SSL.</span><span class="sxs-lookup"><span data-stu-id="a7826-109">HTTPS transport causes the entire message, including the HTTP headers, to be encrypted using the Secure Sockets Layer (SSL) protocol.</span></span>

## <a name="policy-information"></a><span data-ttu-id="a7826-110">Информация о политике</span><span class="sxs-lookup"><span data-stu-id="a7826-110">Policy Information</span></span>

<span data-ttu-id="a7826-111">Обеспечение безопасности политики очень важно, особенно в федеративных сценариях, в которых конфиденциальная информация о требованиях выданного маркера или издателе маркера представлена в политике.</span><span class="sxs-lookup"><span data-stu-id="a7826-111">Keeping policy secure is important, especially in federation scenarios where sensitive issued-token requirements or token-issuer information is exposed in policy.</span></span> <span data-ttu-id="a7826-112">В этих случаях рекомендуется обеспечить безопасность конечной точки политики федеративной службы, чтобы помешать злоумышленникам получить информацию о службе, такую как тип утверждений, помещаемых в выданный маркер, или перенаправить клиенты к вредоносным издателям маркеров.</span><span class="sxs-lookup"><span data-stu-id="a7826-112">In these cases, the recommendation is to secure the federated service's policy endpoint to prevent attackers from obtaining information about the service, such as the type of claims to put in the issued token, or redirecting clients to malicious token issuers.</span></span> <span data-ttu-id="a7826-113">Например, злоумышленник может обнаружить пары "имя пользователя/пароль", перенастроив федеративную цепь доверия так, чтобы она завершалась на издателе, выполнившем атаку "злоумышленник в середине".</span><span class="sxs-lookup"><span data-stu-id="a7826-113">For example, an attacker could discover user name/password pairs by reconfiguring the federated trust chain to terminate in an issuer that executed a man-in-the-middle attack.</span></span> <span data-ttu-id="a7826-114">Федеративным клиентам, получающим привязки путем получения политики, рекомендуется убедиться, что они доверяют издателям в полученной федеративной цепи доверия.</span><span class="sxs-lookup"><span data-stu-id="a7826-114">It is also recommended that federated clients who obtain their bindings through policy retrieval verify that they trust the issuers in the obtained federated trust chain.</span></span> <span data-ttu-id="a7826-115">Дополнительные сведения о сценариях Федерации см. в разделе [Федерация](../../../../docs/framework/wcf/feature-details/federation.md).</span><span class="sxs-lookup"><span data-stu-id="a7826-115">For more information about federation scenarios, see [Federation](../../../../docs/framework/wcf/feature-details/federation.md).</span></span>

## <a name="memory-dumps-can-reveal-claim-information"></a><span data-ttu-id="a7826-116">Дампы памяти, раскрывающие информацию об утверждениях</span><span class="sxs-lookup"><span data-stu-id="a7826-116">Memory Dumps Can Reveal Claim Information</span></span>

<span data-ttu-id="a7826-117">При сбое приложения в файлах журналов, например, созданных программой Dr. Watson, может содержаться информация об утверждениях.</span><span class="sxs-lookup"><span data-stu-id="a7826-117">When an application fails, log files, such as those produced by Dr. Watson, can contain the claim information.</span></span> <span data-ttu-id="a7826-118">Эту информацию не следует экспортировать в другие сущности, такие как группы поддержки. В противном случае также выполняется экспорт информации об утверждениях, содержащей закрытые данные.</span><span class="sxs-lookup"><span data-stu-id="a7826-118">This information should not be exported to other entities, such as support teams; otherwise, the claim information that contains private data is also exported.</span></span> <span data-ttu-id="a7826-119">Этого можно избежать, если не отправлять файлы журналов неизвестным сущностям.</span><span class="sxs-lookup"><span data-stu-id="a7826-119">You can mitigate this by not sending the log files to unknown entities.</span></span>

## <a name="endpoint-addresses"></a><span data-ttu-id="a7826-120">Адреса конечных точек</span><span class="sxs-lookup"><span data-stu-id="a7826-120">Endpoint Addresses</span></span>

<span data-ttu-id="a7826-121">В адресе конечной точки содержится информация, необходимая для связи с конечной точкой.</span><span class="sxs-lookup"><span data-stu-id="a7826-121">An endpoint address contains the information needed to communicate with an endpoint.</span></span> <span data-ttu-id="a7826-122">Безопасность SOAP должна содержать полный адрес в сообщениях согласования безопасности, обмен которыми выполняется для согласования симметричного ключа между клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="a7826-122">SOAP security must include the address in full in the security negotiation messages that are exchanged in order to negotiate a symmetric key between a client and a server.</span></span> <span data-ttu-id="a7826-123">Поскольку согласование безопасности является процессом начальной загрузки, заголовки адресов невозможно зашифровать во время этого процесса.</span><span class="sxs-lookup"><span data-stu-id="a7826-123">Because security negotiation is a bootstrap process, the address headers cannot be encrypted during this process.</span></span> <span data-ttu-id="a7826-124">Таким образом, в адресах не следует указывать конфиденциальные данные, иначе это приведет к атакам, связанным с раскрытием информации.</span><span class="sxs-lookup"><span data-stu-id="a7826-124">Therefore, the address should not contain any confidential data; otherwise, it leads to information disclosure attacks.</span></span>

## <a name="certificates-transferred-unencrypted"></a><span data-ttu-id="a7826-125">Передача незашифрованных сертификатов</span><span class="sxs-lookup"><span data-stu-id="a7826-125">Certificates Transferred Unencrypted</span></span>

<span data-ttu-id="a7826-126">При использовании сертификата X.509 для проверки подлинности клиента сертификат передается в открытом виде, в заголовке SOAP.</span><span class="sxs-lookup"><span data-stu-id="a7826-126">When you use an X.509 certificate to authenticate a client, the certificate is transferred in the clear, inside the SOAP header.</span></span> <span data-ttu-id="a7826-127">Помните, что это потенциальное раскрытие личной информации (PII).</span><span class="sxs-lookup"><span data-stu-id="a7826-127">Be aware of this as a potential personally identifiable information (PII) disclosure.</span></span> <span data-ttu-id="a7826-128">Это не касается режима `TransportWithMessageCredential`, в котором шифруется все сообщение для обеспечения безопасности на транспортном уровне.</span><span class="sxs-lookup"><span data-stu-id="a7826-128">This is not an issue for `TransportWithMessageCredential` mode, where the entire message is encrypted with transport-level security.</span></span>

## <a name="service-references"></a><span data-ttu-id="a7826-129">Ссылки на службы</span><span class="sxs-lookup"><span data-stu-id="a7826-129">Service References</span></span>

<span data-ttu-id="a7826-130">Ссылка на службу - это ссылка на другую службу.</span><span class="sxs-lookup"><span data-stu-id="a7826-130">A service reference is a reference to another service.</span></span> <span data-ttu-id="a7826-131">Например, служба может передавать клиенту ссылку на службу в ходе выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="a7826-131">For example, a service may pass a service reference to a client in the course of an operation.</span></span> <span data-ttu-id="a7826-132">Ссылка на службу также используется с *проверяющим удостоверением доверия*, внутренним компонентом, который гарантирует удостоверение целевого субъекта перед раскрытием информации, такой как данные приложения или учетные данные, в целевом объекте.</span><span class="sxs-lookup"><span data-stu-id="a7826-132">The service reference is also used with a *trust identity verifier*, an internal component that ensures the identity of the target principal before disclosing information such as application data or credentials to the target.</span></span> <span data-ttu-id="a7826-133">Если удаленную идентификацию доверия невозможно проверить или она является неверной, отправитель должен убедиться, что никакие данные, способные скомпрометировать его, приложение или пользователя, не были раскрыты.</span><span class="sxs-lookup"><span data-stu-id="a7826-133">If the remote trust identity cannot be verified or is incorrect, the sender should ensure that no data was disclosed that could compromise itself, the application, or the user.</span></span>

<span data-ttu-id="a7826-134">Ниже представлены способы борьбы с этим.</span><span class="sxs-lookup"><span data-stu-id="a7826-134">Mitigations include the following:</span></span>

- <span data-ttu-id="a7826-135">Предполагается, что ссылки на службы заслуживают доверия.</span><span class="sxs-lookup"><span data-stu-id="a7826-135">Service references are assumed to be trustworthy.</span></span> <span data-ttu-id="a7826-136">Будьте внимательны при каждой передаче экземпляров ссылок на службы, убедитесь, что они не подделаны.</span><span class="sxs-lookup"><span data-stu-id="a7826-136">Take care whenever transferring service reference instances to ensure that they have not been tampered with.</span></span>

- <span data-ttu-id="a7826-137">Некоторые приложения могут обеспечивать такое поведение, которое позволяет проводить интерактивное получение доверия, основанное на данных, содержащихся в ссылке на службу, и доверенных данных, проверенных удаленным узлом.</span><span class="sxs-lookup"><span data-stu-id="a7826-137">Some applications can present a user experience that allows interactive establishment of trust based on data in the service reference and trust data proven by the remote host.</span></span> <span data-ttu-id="a7826-138">WCF предоставляет точки расширения для такого средства, но пользователь должен их реализовать.</span><span class="sxs-lookup"><span data-stu-id="a7826-138">WCF provides extensibility points for such a facility, but the user must implemented them.</span></span>

## <a name="ntlm"></a><span data-ttu-id="a7826-139">NTLM</span><span class="sxs-lookup"><span data-stu-id="a7826-139">NTLM</span></span>

<span data-ttu-id="a7826-140">По умолчанию в среде домена Windows во время проверки подлинности Windows используется протокол Kerberos для проверки подлинности и авторизации пользователей.</span><span class="sxs-lookup"><span data-stu-id="a7826-140">By default, in the Windows domain environment, Windows authentication uses the Kerberos protocol to authenticate and authorize users.</span></span> <span data-ttu-id="a7826-141">Если по какой-либо причине использовать протокол Kerberos невозможно, в качестве резерва используется NT LAN Manager (NTLM).</span><span class="sxs-lookup"><span data-stu-id="a7826-141">If the Kerberos protocol cannot be used for some reason, NT LAN Manager (NTLM) is used as a fallback.</span></span> <span data-ttu-id="a7826-142">Чтобы отключить такое поведение, необходимо задать для свойства <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> значение `false`.</span><span class="sxs-lookup"><span data-stu-id="a7826-142">You can disable this behavior by setting the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false`.</span></span> <span data-ttu-id="a7826-143">При использовании NTLM необходимо учитывать следующие проблемы.</span><span class="sxs-lookup"><span data-stu-id="a7826-143">Issues to be aware of when allowing NTLM include:</span></span>

- <span data-ttu-id="a7826-144">NTLM предоставляет имя пользователя клиента.</span><span class="sxs-lookup"><span data-stu-id="a7826-144">NTLM exposes the client user name.</span></span> <span data-ttu-id="a7826-145">Если необходимо сохранить конфиденциальность имени пользователя, задайте для свойства `AllowNTLM` в привязке значение `false`.</span><span class="sxs-lookup"><span data-stu-id="a7826-145">If the user name needs to be kept confidential, then set the `AllowNTLM` property on the binding to `false`.</span></span>

- <span data-ttu-id="a7826-146">NTLM не обеспечивает проверки подлинности сервера.</span><span class="sxs-lookup"><span data-stu-id="a7826-146">NTLM does not provide server authentication.</span></span> <span data-ttu-id="a7826-147">Следовательно, клиент не может гарантировать взаимодействие с правильной службой при использовании NTLM в качестве протокола проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="a7826-147">Therefore, the client cannot ensure that it is communicating with the right service when you use NTLM as an authentication protocol.</span></span>

### <a name="specifying-client-credentials-or-invalid-identity-forces-ntlm-usage"></a><span data-ttu-id="a7826-148">Использование NTLM при задании учетных данных клиента или недействительной идентификации</span><span class="sxs-lookup"><span data-stu-id="a7826-148">Specifying Client Credentials or Invalid Identity Forces NTLM Usage</span></span>

<span data-ttu-id="a7826-149">Если при создании клиента указать учетные данные клиента без имени домена или указать недействительную идентификацию сервера, вместо протокола Kerberos будет использоваться NTLM (если для свойства `AllowNtlm` задано значение `true`).</span><span class="sxs-lookup"><span data-stu-id="a7826-149">When creating a client, specifying client credentials without a domain name, or specifying an invalid server identity, causes NTLM to be used instead of the Kerberos protocol (if the `AllowNtlm` property is set to `true`).</span></span> <span data-ttu-id="a7826-150">Поскольку NTLM не выполняет проверку подлинности сервера, возникает потенциальный риск раскрытия информации.</span><span class="sxs-lookup"><span data-stu-id="a7826-150">Because  NTLM does not do server authentication, information can potentially be disclosed.</span></span>

<span data-ttu-id="a7826-151">Например, можно указать учетные данные клиента Windows без доменного имени, как показано в следующем визуальном C# коде.</span><span class="sxs-lookup"><span data-stu-id="a7826-151">For example, it is possible to specify Windows client credentials without a domain name, as shown in the following Visual C# code.</span></span>

```csharp
MyChannelFactory.Credentials.Windows.ClientCredential = new System.Net.NetworkCredential("username", "password");
```

<span data-ttu-id="a7826-152">В коде не указано имя домена, и, следовательно, будет использоваться NTLM.</span><span class="sxs-lookup"><span data-stu-id="a7826-152">The code does not specify a domain name, and therefore NTLM will be used.</span></span>

<span data-ttu-id="a7826-153">Если домен указан, но с помощью функции идентификации конечной точки задано недействительное имя субъекта-службы, то будет использоваться NTLM.</span><span class="sxs-lookup"><span data-stu-id="a7826-153">If the domain is specified, but an invalid service principal name is specified using the endpoint identity feature, then NTLM is used.</span></span> <span data-ttu-id="a7826-154">Дополнительные сведения о том, как указывается удостоверение конечной точки, см. в разделе [удостоверение службы и проверка подлинности](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="a7826-154">For more information about how endpoint identity is specified, see [Service Identity and Authentication](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="a7826-155">См. также:</span><span class="sxs-lookup"><span data-stu-id="a7826-155">See also</span></span>

- [<span data-ttu-id="a7826-156">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="a7826-156">Security Considerations</span></span>](../../../../docs/framework/wcf/feature-details/security-considerations-in-wcf.md)
- [<span data-ttu-id="a7826-157">Повышение привилегий</span><span class="sxs-lookup"><span data-stu-id="a7826-157">Elevation of Privilege</span></span>](../../../../docs/framework/wcf/feature-details/elevation-of-privilege.md)
- [<span data-ttu-id="a7826-158">Отказ в обслуживании</span><span class="sxs-lookup"><span data-stu-id="a7826-158">Denial of Service</span></span>](../../../../docs/framework/wcf/feature-details/denial-of-service.md)
- [<span data-ttu-id="a7826-159">Подделка</span><span class="sxs-lookup"><span data-stu-id="a7826-159">Tampering</span></span>](../../../../docs/framework/wcf/feature-details/tampering.md)
- [<span data-ttu-id="a7826-160">Неподдерживаемые сценарии</span><span class="sxs-lookup"><span data-stu-id="a7826-160">Unsupported Scenarios</span></span>](../../../../docs/framework/wcf/feature-details/unsupported-scenarios.md)
- [<span data-ttu-id="a7826-161">Атаки с повторением</span><span class="sxs-lookup"><span data-stu-id="a7826-161">Replay Attacks</span></span>](../../../../docs/framework/wcf/feature-details/replay-attacks.md)
