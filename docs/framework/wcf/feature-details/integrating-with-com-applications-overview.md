---
title: Общие сведения об интеграции с приложениями COM
ms.date: 03/30/2017
helpviewer_keywords:
- COM [WCF], integration overview
ms.assetid: 02c5697f-6e2e-47d6-b715-f3a28aebfbd5
ms.openlocfilehash: 2be428f0ae83596a4398fc9830af40d05f6ab191
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64638657"
---
# <a name="integrating-with-com-applications-overview"></a>Общие сведения об интеграции с приложениями COM
Windows Communication Foundation (WCF) предоставляет разработчику управляемого кода среду с широкими возможностями для создания подключаемых приложений. Тем не менее если вы существенно потратились в неуправляемом коде на основе COM и переносить не требуется, можно интегрировать веб-служб WCF непосредственно в существующий код с помощью моникера службы WCF. Моникер служб можно использовать в широком наборе сред разработки на базе модели COM, например в Office VBA, Visual Basic 6.0 и Visual C++ 6.0.  
  
> [!NOTE]
>  Моникер служб использует коммуникационный канал WCF для всех видов связи. Механизмы безопасности и идентификации для этого канала отличаются от механизмов, используемых в стандартных прокси-средствах COM и DCOM. Кроме того поскольку моникер служб использует коммуникационный канал WCF истечения времени ожидания по умолчанию — одна минута для всех вызовов.  
  
 Моникер служб используется с `GetObject` функции, чтобы разработчик неуправляемого кода с помощью подхода со строгой типизацией, зависящие от COM для вызова веб-служб WCF. Для этого локального, видимой для COM определение контракта службы WCF Web и привязка, которая будет использоваться. Как и другие клиенты WCF моникер служб должен создать типизированный канал к службе, хотя создание этого канала происходит прозрачно для COM-программиста при первом вызове метода.  
  
 Общие с другими клиентами WCF, при использовании моникера приложения указать адрес, привязку и контракт для взаимодействия со службой. Контракт можно задать одним из следующих способов.  
  
- Типизированный контракт: контракт регистрируется как видимый для модели COM тип на клиентском компьютере.  
  
- Контракт WSDL: контракт предоставляется в виде документа WSDL.  
  
- Контракт MEX: контракт получается в среде выполнения из конечной точки обмена метаданными (MEX).  
  
## <a name="parameters-supported-by-the-service-moniker"></a>Параметры, поддерживаемые моникером служб  
 В следующей таблице представлены параметры, поддерживаемые моникером служб.  
  
|Параметр|Описание|  
|---------------|-----------------|  
|`address`|URL-адрес службы.|  
|`binding`|Имя раздела привязки из конфигурации приложения.|  
|`bindingConfiguration`|Именованный экземпляр привязки из именованного раздела привязки.|  
|`contract`|Идентификатор интерфейса (IID), представляющий контракт службы или имя контракта (из MEX).|  
|`wsdl`|Документ WSDL, обеспечивающий альтернативную форму определения контракта.|  
|`spnIdentity`|Идентификатор имени участника на уровне сервера (SPN), который должен использоваться для взаимодействия со службой.|  
|`upnIdentity`|Идентификатор имени участника-пользователя (UPN), который должен использоваться для взаимодействия со службой.|  
|`dnsIdentity`|Идентификатор DNS, который должен использоваться для взаимодействия со службой.|  
|`mexAddress`|URL-адрес конечной точки службы для обмена метаданными (MEX).|  
|`mexBinding`|Имя раздела привязки из конфигурации приложения для соединения с конечной точкой MEX.|  
|`mexBindingConfiguration`|Именованный экземпляр привязки из именованного раздела привязки для соединения с конечной точкой MEX.|  
|`bindingNamespace`|Пространство имен для имени раздела привязки, полученное в результате MEX.|  
|`contractNamespace`|Пространство имен контракта, полученное в результате MEX.|  
|`mexSpnIdentity`|Идентификатор имени участника на уровне сервера (SPN), который должен использоваться для взаимодействия с конечной точкой MEX.|  
|`mexUpnIdentity`|Идентификатор имени участника-пользователя (UPN), который должен использоваться для взаимодействия с конечной точкой MEX.|  
|`mexDnsIdentity`|Идентификатор DNS, который должен использоваться для взаимодействия с конечной точкой MEX.|  
|`serializer`|Позволяет задать использование сериализатора "xml" или "datacontract".|  
  
> [!NOTE]
>  Даже в том случае, если для клиентов, полностью основанная на модели COM, для моникера служб требуется WCF и платформа .NET Framework 2.0, должен быть установлен на клиентском компьютере. Также важно, чтобы в клиентские приложения, использующие моникер служб, была загружена соответствующая версия среды выполнения платформы .NET Framework. При использовании моникера в приложениях Office может потребоваться файл конфигурации, чтобы обеспечить загрузку надлежащей версии .NET Framework. Например, при использовании Excel файл Excel.exe.config, расположенный в том же каталоге, что и файл Excel.exe, должен содержать следующий текст:  
>   
>  `<?xml version="1.0" encoding="utf-8"?>`  
>   
>  `<configuration xmlns=` `http://schemas.microsoft.com/.NetConfiguration/v2.0` `>`  
>   
>  `<startup>`  
>   
>  `<requiredRuntime version="v2.0.50727" />`  
>   
>  `</startup>`  
>   
>  `</configuration>`  
  
## <a name="see-also"></a>См. также

- [Практическое руководство. Регистрация и настройка моникера службы](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)
