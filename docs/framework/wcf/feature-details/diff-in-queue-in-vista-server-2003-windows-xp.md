---
title: Различия в возможностях очередей в Windows Vista, Windows Server 2003 и Windows XP
ms.date: 03/30/2017
helpviewer_keywords:
- queues [WCF], differences in operating systems
ms.assetid: aa809d93-d0a3-4ae6-a726-d015cca37c04
ms.openlocfilehash: d13cb3e732d0276902def5de6ca7c007f61b0ec9
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62039732"
---
# <a name="differences-in-queuing-features-in-windows-vista-windows-server-2003-and-windows-xp"></a><span data-ttu-id="6a940-102">Различия в возможностях очередей в Windows Vista, Windows Server 2003 и Windows XP</span><span class="sxs-lookup"><span data-stu-id="6a940-102">Differences in Queuing Features in Windows Vista, Windows Server 2003, and Windows XP</span></span>
<span data-ttu-id="6a940-103">В этом разделе кратко описаны различия в Windows Communication Foundation (WCF) возможность очередей между [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], и [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a940-103">This topic summarizes the differences in the Windows Communication Foundation (WCF) queues feature between [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], and [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
## <a name="application-specific-dead-letter-queue"></a><span data-ttu-id="6a940-104">Очередь недоставленных сообщений, связанная с приложением</span><span class="sxs-lookup"><span data-stu-id="6a940-104">Application-Specific Dead-Letter Queue</span></span>  
 <span data-ttu-id="6a940-105">Сообщения могут бесконечно долго оставаться в очереди, если принимающее приложение не считывает их из очереди за отведенное время.</span><span class="sxs-lookup"><span data-stu-id="6a940-105">Queued messages can remain in the queue indefinitely if the receiving application does not read them in a timely fashion.</span></span> <span data-ttu-id="6a940-106">Такое поведение не рекомендуется для чувствительных ко времени сообщений.</span><span class="sxs-lookup"><span data-stu-id="6a940-106">This behavior is not advisable if the messages are time-sensitive.</span></span> <span data-ttu-id="6a940-107">Сообщения, чувствительные ко времени, имеют свойство `TimeToLive`, заданное в привязке с очередью.</span><span class="sxs-lookup"><span data-stu-id="6a940-107">Time-sensitive messages have a `TimeToLive` property set in the queued binding.</span></span> <span data-ttu-id="6a940-108">Это свойство указывает максимальный срок нахождения сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="6a940-108">This property indicates how long the messages can be in the queue before they expire.</span></span> <span data-ttu-id="6a940-109">Просроченные сообщения отправляются в специальную очередь, называемую очередью недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="6a940-109">Expired messages are sent to a special queue called the dead-letter queue.</span></span> <span data-ttu-id="6a940-110">Сообщение также может быть помещено в очередь недоставленных сообщений и по другим причинам, таким как превышение квоты очереди или сбой проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="6a940-110">A message can also end up in a dead-letter queue for other reasons, such as exceeding a queue quota or experiencing an authentication failure.</span></span>  
  
 <span data-ttu-id="6a940-111">Как правило, единая общесистемная очередь недоставленных сообщений распространяется на все приложения с очередями, имеющие совместный доступ к диспетчеру очередей.</span><span class="sxs-lookup"><span data-stu-id="6a940-111">Typically, a single system-wide dead-letter queue exists for all queued applications that share a queue manager.</span></span> <span data-ttu-id="6a940-112">Очередь недоставленных сообщений для каждого приложения обеспечивает более эффективную изоляцию между приложениями с очередями с совместным доступом к диспетчеру очередей, позволяя этим приложениям определять собственную очередь недоставленных сообщений, связанную с приложением.</span><span class="sxs-lookup"><span data-stu-id="6a940-112">A dead-letter queue for each application enables better isolation between queued applications that share a queue manager by allowing these applications to specify their own application-specific dead-letter queue.</span></span> <span data-ttu-id="6a940-113">Приложение с совместным с другими приложениями доступом к очереди недоставленных сообщений должно просмотреть очередь, чтобы найти сообщения, относящиеся именно к нему.</span><span class="sxs-lookup"><span data-stu-id="6a940-113">An application that shares a dead-letter queue with other applications has to browse the queue to find messages that are applicable to it.</span></span> <span data-ttu-id="6a940-114">Благодаря очереди недоставленных приложений, относящейся к приложению, оно располагает точной информацией, что все сообщения в очереди недоставленных сообщений применимы именно к нему.</span><span class="sxs-lookup"><span data-stu-id="6a940-114">With an application-specific dead-letter queue, the application can be assured that all messages in its dead-letter queue are applicable to it.</span></span>  
  
 <span data-ttu-id="6a940-115">В [!INCLUDE[wv](../../../../includes/wv-md.md)] предусмотрены очереди недоставленных сообщений, относящиеся к приложению.</span><span class="sxs-lookup"><span data-stu-id="6a940-115">[!INCLUDE[wv](../../../../includes/wv-md.md)] provides for application-specific dead-letter queues.</span></span> <span data-ttu-id="6a940-116">Очереди недоставленных сообщений, относящиеся к приложению, недоступны в [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] и [!INCLUDE[wxp](../../../../includes/wxp-md.md)], и приложения должны использовать общесистемную очередь недоставленных приложений.</span><span class="sxs-lookup"><span data-stu-id="6a940-116">Application-specific dead-letter queues are not available in [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)], and applications must use the system-wide dead-letter queue.</span></span>  
  
## <a name="poison-message-handling"></a><span data-ttu-id="6a940-117">Обработка подозрительных сообщений</span><span class="sxs-lookup"><span data-stu-id="6a940-117">Poison-Message Handling</span></span>  
 <span data-ttu-id="6a940-118">Подозрительное сообщение представляет собой сообщение, для которого превышено максимальное количество попыток доставки в принимающее приложение.</span><span class="sxs-lookup"><span data-stu-id="6a940-118">A poison message is a message that has exceeded the maximum number of delivery attempts to the receiving application.</span></span> <span data-ttu-id="6a940-119">Такая ситуация может возникнуть, когда приложение, считывающее сообщение из транзакционной очереди, не может сразу обработать сообщение из-за ошибок.</span><span class="sxs-lookup"><span data-stu-id="6a940-119">This situation can arise when an application that reads a message from a transactional queue cannot process the message immediately because of errors.</span></span> <span data-ttu-id="6a940-120">Если приложение отменяет транзакцию, при которой было получено сообщение из очереди, оно возвращает сообщение обратно в очередь.</span><span class="sxs-lookup"><span data-stu-id="6a940-120">If the application aborts the transaction in which the queued message was received, it returns the message to the queue.</span></span> <span data-ttu-id="6a940-121">После этого приложение пытается повторно извлечь сообщение в новой транзакции.</span><span class="sxs-lookup"><span data-stu-id="6a940-121">The application then tries to retrieve the message again in a new transaction.</span></span> <span data-ttu-id="6a940-122">Если причина ошибки не устранена, принимающее приложение может зациклиться, получая и прерывая прием одного и того же сообщения, до достижения максимального числа попыток доставки и пометки сообщения как подозрительного.</span><span class="sxs-lookup"><span data-stu-id="6a940-122">If the problem that causes the error is not corrected, the receiving application can get stuck in a loop receiving and aborting the same message until it exceeds the maximum number of delivery attempts, and a poison message results.</span></span>  
  
 <span data-ttu-id="6a940-123">Следующие ключевые различия для очереди сообщений (MSMQ) в [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] и [!INCLUDE[wxp](../../../../includes/wxp-md.md)] важны для обработки подозрительных сообщений.</span><span class="sxs-lookup"><span data-stu-id="6a940-123">The key differences between Message Queuing (MSMQ) on [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], and [!INCLUDE[wxp](../../../../includes/wxp-md.md)] that are relevant to poison handling include the following:</span></span>  
  
- <span data-ttu-id="6a940-124">MSMQ в [!INCLUDE[wv](../../../../includes/wv-md.md)] поддерживает вложенные очереди, тогда как [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] и [!INCLUDE[wxp](../../../../includes/wxp-md.md)] не поддерживают вложенные очереди.</span><span class="sxs-lookup"><span data-stu-id="6a940-124">MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] supports subqueues, while [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)] do not support subqueues.</span></span> <span data-ttu-id="6a940-125">Вложенные очереди используются при обработке подозрительных сообщений.</span><span class="sxs-lookup"><span data-stu-id="6a940-125">Subqueues are used in poison-message handling.</span></span> <span data-ttu-id="6a940-126">Очереди повторных попыток и очередь подозрительных сообщений являются вложенными очередями очереди приложения, созданной на основе параметров обработки подозрительных сообщений.</span><span class="sxs-lookup"><span data-stu-id="6a940-126">The retry queues and the poison queue are subqueues to the application queue that is created based on the poison-message handling settings.</span></span> <span data-ttu-id="6a940-127">Значение `MaxRetryCycles` указывает, сколько необходимо создать вложенных очередей повторных попыток.</span><span class="sxs-lookup"><span data-stu-id="6a940-127">The `MaxRetryCycles` dictates how many retry subqueues to create.</span></span> <span data-ttu-id="6a940-128">Поэтому при работе с [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] или [!INCLUDE[wxp](../../../../includes/wxp-md.md)] параметр `MaxRetryCycles` игнорируется, а значение `ReceiveErrorHandling.Move` не допускается.</span><span class="sxs-lookup"><span data-stu-id="6a940-128">Therefore, when running on [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], `MaxRetryCycles` are ignored and `ReceiveErrorHandling.Move` is not allowed.</span></span>  
  
- <span data-ttu-id="6a940-129">MSMQ в [!INCLUDE[wv](../../../../includes/wv-md.md)] поддерживает уведомление о недоставке, тогда как [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] и [!INCLUDE[wxp](../../../../includes/wxp-md.md)] его не поддерживают.</span><span class="sxs-lookup"><span data-stu-id="6a940-129">MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] supports negative acknowledgment, while [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)] do not.</span></span> <span data-ttu-id="6a940-130">Уведомление о недоставке от диспетчера принимающей очереди приводит к тому, что диспетчер передающей очереди помещает сообщение в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="6a940-130">A negative acknowledgment from the receiving queue manager causes the sending queue manager to place the rejected message in the dead-letter queue.</span></span> <span data-ttu-id="6a940-131">Поэтому значение `ReceiveErrorHandling.Reject` не допускается в [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] и [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a940-131">As such, `ReceiveErrorHandling.Reject` is not allowed with [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
- <span data-ttu-id="6a940-132">MSMQ в [!INCLUDE[wv](../../../../includes/wv-md.md)] поддерживает свойство сообщения, подсчитывающее число попыток доставки сообщения.</span><span class="sxs-lookup"><span data-stu-id="6a940-132">MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] supports a message property that keeps count of the number of times message delivery is attempted.</span></span> <span data-ttu-id="6a940-133">Это свойство подсчета прекращений недоступно в [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] и [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a940-133">This abort count property is not available on [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span> <span data-ttu-id="6a940-134">WCF хранит число прекращений в памяти, так что вполне возможно, что это свойство не может содержать неточное значение, если то же сообщение прочитывается более одной службы WCF на веб-ферме.</span><span class="sxs-lookup"><span data-stu-id="6a940-134">WCF maintains the abort count in memory, so it is possible that this property may not contain an accurate value when the same message is read by more than one WCF service in a Web farm.</span></span>  
  
## <a name="remote-transactional-read"></a><span data-ttu-id="6a940-135">Удаленное чтение в транзакциях</span><span class="sxs-lookup"><span data-stu-id="6a940-135">Remote Transactional Read</span></span>  
 <span data-ttu-id="6a940-136">MSMQ в [!INCLUDE[wv](../../../../includes/wv-md.md)] поддерживает удаленное чтение в транзакциях.</span><span class="sxs-lookup"><span data-stu-id="6a940-136">MSMQ on [!INCLUDE[wv](../../../../includes/wv-md.md)] supports remote transactional reads.</span></span> <span data-ttu-id="6a940-137">Это позволяет приложению, считывающему из очереди, находиться на компьютере, отличном от компьютера, на котором размещена очередь.</span><span class="sxs-lookup"><span data-stu-id="6a940-137">This allows an application that is reading from a queue to be hosted on a computer that is different from the computer on which the queue is hosted.</span></span> <span data-ttu-id="6a940-138">Этим обеспечивается возможность использования фермы служб, осуществляющих чтение из центральной очереди, что увеличивает общую производительность системы.</span><span class="sxs-lookup"><span data-stu-id="6a940-138">This ensures the ability to have a farm of services reading from a central queue, which increases the overall throughput of the system.</span></span> <span data-ttu-id="6a940-139">Кроме того, если во время чтения и обработки сообщения возникает ошибка, такой подход позволяет откатить транзакцию, и сообщение останется в очереди для последующей обработки.</span><span class="sxs-lookup"><span data-stu-id="6a940-139">It also ensures that if a failure occurs when reading and processing the message, the transaction rolls back and the message remains in the queue for later processing.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6a940-140">См. также</span><span class="sxs-lookup"><span data-stu-id="6a940-140">See also</span></span>

- [<span data-ttu-id="6a940-141">Использование очередей недоставленных сообщений для обработки сбоев при передаче сообщений</span><span class="sxs-lookup"><span data-stu-id="6a940-141">Using Dead-Letter Queues to Handle Message Transfer Failures</span></span>](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)
- [<span data-ttu-id="6a940-142">Обработка подозрительных сообщений</span><span class="sxs-lookup"><span data-stu-id="6a940-142">Poison Message Handling</span></span>](../../../../docs/framework/wcf/feature-details/poison-message-handling.md)
