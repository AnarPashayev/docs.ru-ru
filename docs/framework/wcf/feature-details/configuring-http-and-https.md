---
title: Настройка HTTP и HTTPS - WCF
ms.date: 04/08/2019
helpviewer_keywords:
- configuring HTTP [WCF]
ms.assetid: b0c29a86-bc0c-41b3-bc1e-4eb5bb5714d4
ms.openlocfilehash: 4bfdbbc19bb9ed72bc50ebeeac114241ccd47c25
ms.sourcegitcommit: 7e129d879ddb42a8b4334eee35727afe3d437952
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2019
ms.locfileid: "66053415"
---
# <a name="configuring-http-and-https"></a>Настройка HTTP и HTTPS

Службы и клиенты WCF могут взаимодействовать по протоколам HTTP и HTTPS. Параметры HTTP/HTTPS задаются с помощью служб IIS или посредством использования средства командной строки. Когда служба WCF размещается в службах IIS, параметры HTTP или HTTPS можно задать в службах IIS (с помощью средства inetmgr.exe). Если служба WCF является резидентной, параметры HTTP или HTTPS задаются с помощью средства командной строки.

Как минимум необходимо настроить регистрацию URL-адрес и добавить исключение брандмауэра для службы будет использоваться URL-адрес. Эти параметры можно настроить с помощью средства Netsh.exe.

## <a name="configuring-namespace-reservations"></a>Настройка резервирований пространства имен

Резервирование пространства имен назначает права на часть пространства имен URL-адреса HTTP определенной группе пользователей. Резервирование предоставляет этим пользователям право создавать службы, которые ожидают передачи данных в указанной части пространства имен. Резервирования представляют собой префиксы URL-адресов, это означает, что одно резервирование охватывает все подпути пути резервирования. Резервирования пространства имен позволяют использовать подстановочные знаки двумя способами. Описание документации по API сервера HTTP [порядок разрешения утверждений пространства имен, включающих подстановочные знаки](/windows/desktop/Http/routing-incoming-requests).

Запущенное приложение может создать аналогичный запрос для добавления регистраций пространства имен. Регистрации и резервирования конкурируют за части пространства имен. Резервирование может иметь приоритет над регистрацией в соответствии с порядком разрешения, описанным [порядок разрешения утверждений пространства имен, включающих подстановочные знаки](/windows/desktop/Http/routing-incoming-requests). В этом случае резервирование не позволяет запущенному приложению получать запросы.

В следующем примере используется средство Netsh.exe:

```console
netsh http add urlacl url=http://+:80/MyUri user=DOMAIN\user
```

Эта команда добавляет резервирование URL-адрес для указанного пространства имен URL-адрес для учетной записи "домен\имя пользователя". Дополнительные сведения об использовании команды netsh введите `netsh http add urlacl /?` в командной строке следующую команду и нажмите клавишу ВВОД.

## <a name="configuring-a-firewall-exception"></a>Настройка исключения брандмауэра

При резидентном размещении службы WCF, которая осуществляет взаимодействие по протоколу HTTP, необходимо добавить исключение в конфигурацию брандмауэра, чтобы входящие соединения могли использовать определенный URL-адрес.

## <a name="configuring-ssl-certificates"></a>Настройка SSL-сертификатов

Протокол SSL использует сертификаты в клиенте и службе для хранения ключей шифрования. Сервер предоставляет свой SSL-сертификат при подключении, чтобы клиент мог проверить удостоверение сервера. Для обеспечения взаимной проверки на обеих сторонах подключения сервер также запрашивает сертификат у клиента.

Сертификаты хранятся в централизованном хранилище в соответствии с IP-адресом и номером порта подключения. Специальный IP-адрес 0.0.0.0 соответствует любому IP-адресу локального компьютера. Обратите внимание на то, что в хранилище сертификатов не различает URL-адреса, на основе пути. Службы с одним и тем же сочетанием IP-адреса и порта должны иметь общие сертификаты, даже если их пути в URL-адресе различаются.

Пошаговые инструкции см. в разделе [как: Настройка порта SSL-сертификат](how-to-configure-a-port-with-an-ssl-certificate.md).

## <a name="configuring-the-ip-listen-list"></a>Настройка списка ожидания передачи данных по протоколу IP

API HTTP-сервера привязывается к IP-адресу и порту только после регистрации URL-адреса пользователем. По умолчанию API HTTP-сервера привязывается к порту в URL-адресе для всех IP-адресов компьютера. Конфликт возникает, если приложение, не использующих API сервера HTTP, ранее привязалось к этому сочетанию IP-адрес и порт. Список прослушивания IP позволяет службам WCF сосуществовать с приложениями, использующими порт для некоторых IP-адресов компьютера. Если в списке ожидания передачи данных по протоколу IP содержатся какие-либо записи, API HTTP-сервера привязывается только к IP-адресам, указанным в списке. Для изменения списка ожидания передачи данных по протоколу IP требуются привилегии администратора.

Средство netsh для изменения списка ожидания передачи данных IP, как показано в следующем примере:

```console
netsh http add iplisten ipaddress=0.0.0.0:8000
```

## <a name="other-configuration-settings"></a>Другие параметры конфигурации

При работе с привязкой <xref:System.ServiceModel.WSDualHttpBinding> клиентское соединение использует значения по умолчанию, совместимые с резервированием пространства имен и брандмауэром Windows. При необходимости настроить базовый адрес клиента для двустороннего соединения, необходимо, кроме того, настроить эти параметры HTTP в клиенте так, чтобы они соответствовали новому адресу.

API сервера HTTP имеет некоторые дополнительные параметры конфигурации, которые не доступны через HttpCfg. Эти параметры сохраняются в реестре и применяются ко всем приложениям, выполняемым в системах, которые используют API HTTP-сервера. Сведения об этих параметрах см. в разделе [параметры реестра Http.sys для IIS](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows). Большинство пользователей не нужно изменять эти параметры.

## <a name="see-also"></a>См. также

- <xref:System.ServiceModel.WSDualHttpBinding>
- [Практическое руководство. Настройка порта с помощью SSL-сертификата](how-to-configure-a-port-with-an-ssl-certificate.md)
