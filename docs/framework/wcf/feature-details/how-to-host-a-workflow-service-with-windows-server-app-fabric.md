---
title: Практическое руководство. Как разместить службу рабочего процесса с помощью Windows Server App Fabric
ms.date: 03/30/2017
ms.assetid: 83b62cce-5fc2-4c6d-b27c-5742ba3bac73
ms.openlocfilehash: 519c76e3e46e01b5e8c696234e39fefbb9f8ad06
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84593312"
---
# <a name="how-to-host-a-workflow-service-with-windows-server-app-fabric"></a><span data-ttu-id="bff6e-102">Практическое руководство. Как разместить службу рабочего процесса с помощью Windows Server App Fabric</span><span class="sxs-lookup"><span data-stu-id="bff6e-102">How to: Host a Workflow Service with Windows Server App Fabric</span></span>

<span data-ttu-id="bff6e-103">Размещение служб рабочих процессов в фабрике приложений аналогично их размещению в виртуальном каталоге служб IIS/WAS.</span><span class="sxs-lookup"><span data-stu-id="bff6e-103">Hosting workflow services in App Fabric is similar to hosting under IIS/WAS.</span></span> <span data-ttu-id="bff6e-104">Разница состоит лишь в предоставлении фабрикой приложений средств для развертывания, наблюдения и управления службами рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="bff6e-104">The only difference is the tools App Fabric provides for deploying, monitoring, and managing workflow services.</span></span> <span data-ttu-id="bff6e-105">В этом разделе используется служба рабочего процесса, созданная при [создании длительно выполняющейся службы рабочего процесса](creating-a-long-running-workflow-service.md).</span><span class="sxs-lookup"><span data-stu-id="bff6e-105">This topic uses the workflow service created in the [Creating a Long-running Workflow Service](creating-a-long-running-workflow-service.md).</span></span> <span data-ttu-id="bff6e-106">Указанный раздел содержит пошаговые инструкции по созданию службы рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="bff6e-106">That topic will walk you through creating a workflow service.</span></span> <span data-ttu-id="bff6e-107">В этом разделе объясняется, как разместить службу рабочих процессов с помощью фабрики приложений.</span><span class="sxs-lookup"><span data-stu-id="bff6e-107">This topic will explain how to host the workflow service using App Fabric.</span></span> <span data-ttu-id="bff6e-108">Дополнительные сведения о Windows Server App Fabric см. в [документации по Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-108">For more information about Windows Server App Fabric, see [Windows Server App Fabric Documentation](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10)).</span></span> <span data-ttu-id="bff6e-109">Перед выполнением описанных далее шагов убедитесь, что фабрика приложений Windows Server уже установлена.</span><span class="sxs-lookup"><span data-stu-id="bff6e-109">Before completing the steps below make sure you have Windows Server App Fabric installed.</span></span>  <span data-ttu-id="bff6e-110">Для этого откройте службы IIS (inetmgr. exe), щелкните имя сервера в представлении **подключения** , щелкните сайты и выберите **веб-сайт по умолчанию**.</span><span class="sxs-lookup"><span data-stu-id="bff6e-110">To do this open up Internet Information Services (inetmgr.exe), click your server name in the **Connections** view, click Sites, and click **Default Web Site**.</span></span> <span data-ttu-id="bff6e-111">В правой части экрана вы увидите раздел **App Fabric**.</span><span class="sxs-lookup"><span data-stu-id="bff6e-111">In the right-hand side of the screen you should see a section called **App Fabric**.</span></span> <span data-ttu-id="bff6e-112">Если вы не видите этот раздел (он находится на верхней правой панели), значит фабрика приложений не установлена.</span><span class="sxs-lookup"><span data-stu-id="bff6e-112">If you don’t see this section (it will be on the top of the right-hand pane) you do not have App Fabric installed.</span></span> <span data-ttu-id="bff6e-113">Дополнительные сведения об установке Windows Server App Fabric см. в статье [Установка Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-113">For more information about installing Windows Server App Fabric see [Installing Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10)).</span></span>  
  
### <a name="creating-a-simple-workflow-service"></a><span data-ttu-id="bff6e-114">Создание простой службы рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="bff6e-114">Creating a Simple Workflow Service</span></span>  
  
1. <span data-ttu-id="bff6e-115">Откройте Visual Studio 2012 и загрузите решение OrderProcessing, созданное в разделе [Создание длительно выполняемой службы рабочих процессов](creating-a-long-running-workflow-service.md) .</span><span class="sxs-lookup"><span data-stu-id="bff6e-115">Open Visual Studio 2012 and load the OrderProcessing solution you created in the [Creating a Long-running Workflow Service](creating-a-long-running-workflow-service.md) topic.</span></span>  
  
2. <span data-ttu-id="bff6e-116">Щелкните правой кнопкой мыши проект **ордерсервице** и выберите **свойства** и перейдите на вкладку **веб** .</span><span class="sxs-lookup"><span data-stu-id="bff6e-116">Right click the **OrderService** project and select **Properties** and select the **Web** tab.</span></span>  
  
3. <span data-ttu-id="bff6e-117">В разделе **действие при запуске** страницы свойств выберите **определенная страница** и введите Service1. xamlx в поле ввода.</span><span class="sxs-lookup"><span data-stu-id="bff6e-117">In the **Start Action** section of the property page select **Specific Page** and type Service1.xamlx in the edit box.</span></span>  
  
4. <span data-ttu-id="bff6e-118">В разделе **серверы** страницы свойств выберите **использовать локальный веб-сервер IIS** и введите следующий URL-адрес: `http://localhost/OrderService` .</span><span class="sxs-lookup"><span data-stu-id="bff6e-118">In the **Servers** section of the property page select **Use Local IIS Web Server** and type in the following URL: `http://localhost/OrderService`.</span></span>  
  
5. <span data-ttu-id="bff6e-119">Нажмите кнопку **создать виртуальный каталог** .</span><span class="sxs-lookup"><span data-stu-id="bff6e-119">Click the **Create Virtual Directory** button.</span></span> <span data-ttu-id="bff6e-120">При этом будет создан новый виртуальный каталог, а проект будет настроен для копирования необходимых файлов в этот каталог при сборке проекта.</span><span class="sxs-lookup"><span data-stu-id="bff6e-120">This will create a new virtual directory and set up the project to copy the needed files to the virtual directory when the project is built.</span></span>  <span data-ttu-id="bff6e-121">Можно также вручную скопировать в этот виртуальный каталог XAMLX-файл, файл web.config и все необходимые библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="bff6e-121">Alternatively you could manually copy the .xamlx, the web.config, and any needed DLLs to the virtual directory.</span></span>  
  
### <a name="configuring-a-workflow-service-hosted-in-windows-server-app-fabric"></a><span data-ttu-id="bff6e-122">Настройка службы рабочих процессов, размещенной в фабрике приложений Windows Server</span><span class="sxs-lookup"><span data-stu-id="bff6e-122">Configuring a Workflow Service Hosted in Windows Server App Fabric</span></span>  
  
1. <span data-ttu-id="bff6e-123">Откройте диспетчер служб IIS (inetmgr.exe).</span><span class="sxs-lookup"><span data-stu-id="bff6e-123">Open Internet Information Services Manager (inetmgr.exe).</span></span>  
  
2. <span data-ttu-id="bff6e-124">Перейдите в виртуальный каталог Ордерсервице на панели **подключения** .</span><span class="sxs-lookup"><span data-stu-id="bff6e-124">Navigate to the OrderService virtual directory in the **Connections** pane.</span></span>  
  
3. <span data-ttu-id="bff6e-125">Щелкните правой кнопкой мыши Ордерсервице и выберите **Управление WCF и СЛУЖБАМИ WF**, **Настройка...**.</span><span class="sxs-lookup"><span data-stu-id="bff6e-125">Right click OrderService and select **Manage WCF and WF Services**, **Configure…**.</span></span> <span data-ttu-id="bff6e-126">Откроется диалоговое окно **Настройка WCF и WF для приложения** .</span><span class="sxs-lookup"><span data-stu-id="bff6e-126">The **Configure WCF and WF for Application** dialog box is displayed.</span></span>  
  
4. <span data-ttu-id="bff6e-127">Перейдите на вкладку **Общие** , чтобы отобразить общие сведения о приложении, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-127">Select the **General** tab to display general information about the application as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="bff6e-128">![Вкладка «Общие» диалогового окна «Конфигурация фабрики приложения»](media/appfabricconfiguration-general.gif "Аппфабрикконфигуратион — общие")</span><span class="sxs-lookup"><span data-stu-id="bff6e-128">![General tab of the App Fabric Configuration dialog](media/appfabricconfiguration-general.gif "AppFabricConfiguration-General")</span></span>  
  
5. <span data-ttu-id="bff6e-129">Перейдите на вкладку **мониторинг** . Отобразятся различные параметры мониторинга, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-129">Select the **Monitoring** tab. This shows various monitoring settings as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="bff6e-130">![Вкладка «Наблюдение за конфигурацией фабрики приложения»](media/appfabricconfiguration-monitoring.gif "Аппфабрикконфигуратион — мониторинг")</span><span class="sxs-lookup"><span data-stu-id="bff6e-130">![App Fabric Configuration Monitoring tab](media/appfabricconfiguration-monitoring.gif "AppFabricConfiguration-Monitoring")</span></span>  
  
     <span data-ttu-id="bff6e-131">Дополнительные сведения о настройке мониторинга службы рабочих процессов в структуре приложений см. в статье [Настройка мониторинга с помощью App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677384(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-131">For more information about configuring workflow service monitoring in App Fabric see [Configuring monitoring with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677384(v=azure.10)).</span></span>  
  
6. <span data-ttu-id="bff6e-132">Перейдите на вкладку **Сохраняемость рабочего процесса** . Это позволяет настроить приложение для использования поставщика сохраняемости по умолчанию в структуре приложений, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-132">Select the **Workflow Persistence** tab. This allows you to configure your application to use App Fabric’s default persistence provider as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="bff6e-133">![Конфигурация структуры приложений &#45; сохраняемость](media/appfabricconfiguration-persistence.gif "Аппфабрикконфигуратион — сохраняемость")</span><span class="sxs-lookup"><span data-stu-id="bff6e-133">![App Fabric Configuration &#45; Persistence](media/appfabricconfiguration-persistence.gif "AppFabricConfiguration-Persistence")</span></span>  
  
     <span data-ttu-id="bff6e-134">Дополнительные сведения о настройке сохраняемости рабочих процессов в структуре приложений Windows Server см. [в статье Настройка сохраняемости рабочих процессов в структуре приложений](https://docs.microsoft.com/previous-versions/appfabric/ee677353(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-134">For more information about configuring workflow persistence in Windows Server App Fabric see [Configuring Workflow Persistence in App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677353(v=azure.10)).</span></span>  
  
7. <span data-ttu-id="bff6e-135">Перейдите на вкладку **Управление узлом рабочего процесса** . Это позволяет указать, когда следует выгружать неактивные экземпляры службы рабочего процесса и сохранять их, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-135">Select the **Workflow Host Management** tab. This allows you to specify when idle workflow service instances should be unloaded and persisted as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="bff6e-136">![Управление узлом рабочего процесса конфигурации структуры приложений](media/appfabricconfiguration-management.gif "Аппфабрикконфигуратион — управление")</span><span class="sxs-lookup"><span data-stu-id="bff6e-136">![App Fabric Configuration  Workflow Host Management](media/appfabricconfiguration-management.gif "AppFabricConfiguration-Management")</span></span>  
  
     <span data-ttu-id="bff6e-137">Дополнительные сведения о конфигурации управления узлом рабочих процессов см. [в статье Настройка управления узлами рабочих процессов в App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ff383424(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-137">For more information about workflow host management configuration see [Configuring Workflow Host Management in App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ff383424(v=azure.10)).</span></span>  
  
8. <span data-ttu-id="bff6e-138">Перейдите на вкладку **Автозапуск** . Это позволяет указать параметры автоматического запуска для служб рабочего процесса в приложении, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-138">Select the **Auto-Start** tab. This allows you to specify auto-start settings for the workflow services in the application as shown in the following screenshot.</span></span>  
  
     ![Снимок экрана, показывающий конфигурацию запуска автоматического&#45;в структуре приложений.](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/app-fabric-auto-start-configuration.gif)  
  
     <span data-ttu-id="bff6e-140">Дополнительные сведения о настройке автоматического запуска см. [в разделе Настройка автоматического запуска с помощью App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-140">For more information about configuring Auto-Start see [Configuring Auto-Start with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10)).</span></span>  
  
9. <span data-ttu-id="bff6e-141">Перейдите на вкладку **регулирование** . Это позволяет настроить параметры регулирования для службы рабочего процесса, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-141">Select the **Throttling** tab. This allows you to configure throttling settings for the workflow service as shown in the following screenshot.</span></span>  
  
     ![Снимок экрана, на котором показана конфигурация регулирования структуры приложений.](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/app-fabric-throttling-configuration.gif)  
  
     <span data-ttu-id="bff6e-143">Дополнительные сведения о настройке регулирования см. [в разделе Настройка регулирования с помощью App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-143">For more information about configuring throttling see [Configuring Throttling with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10)).</span></span>  
  
10. <span data-ttu-id="bff6e-144">Перейдите на вкладку **Безопасность** . Это позволяет настроить параметры безопасности для приложения, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-144">Select the **Security** tab. This allows you to configure security settings for the application as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="bff6e-145">![Конфигурация безопасности фабрики приложения](media/appfabricconfiguration-security.gif "Аппфабрикконфигуратион — безопасность")</span><span class="sxs-lookup"><span data-stu-id="bff6e-145">![App Fabric Security Configuration](media/appfabricconfiguration-security.gif "AppFabricConfiguration-Security")</span></span>  
  
     <span data-ttu-id="bff6e-146">Дополнительные сведения о настройке безопасности с помощью Windows Server App Fabric см. [в статье Настройка безопасности с помощью App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677278(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="bff6e-146">For more information about configuring security with Windows Server App Fabric see [Configuring Security with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677278(v=azure.10)).</span></span>  
  
### <a name="using-windows-server-app-fabric"></a><span data-ttu-id="bff6e-147">Использование фабрики приложений Windows Server</span><span class="sxs-lookup"><span data-stu-id="bff6e-147">Using Windows Server App Fabric</span></span>  
  
1. <span data-ttu-id="bff6e-148">Выполните построение решения, чтобы скопировать необходимые файлы в виртуальный каталог.</span><span class="sxs-lookup"><span data-stu-id="bff6e-148">Build the solution to copy the necessary files to the virtual directory.</span></span>  
  
2. <span data-ttu-id="bff6e-149">Щелкните правой кнопкой мыши проект Ордерклиент и выберите **Отладка**, **запустить новый экземпляр** , чтобы запустить клиентское приложение.</span><span class="sxs-lookup"><span data-stu-id="bff6e-149">Right click the OrderClient project and select **Debug**, **Start New Instance** to launch the client application.</span></span>  
  
3. <span data-ttu-id="bff6e-150">Клиент будет запущен, и Visual Studio отобразит диалоговое окно **присоединить предупреждение безопасности** , нажав кнопку **не присоединить** .</span><span class="sxs-lookup"><span data-stu-id="bff6e-150">The client will run and Visual Studio will display an **Attach Security Warning** dialog box, click the **Don’t Attach** button.</span></span> <span data-ttu-id="bff6e-151">При этом среда Visual Studio не будет присоединяться к процессу служб IIS для отладки.</span><span class="sxs-lookup"><span data-stu-id="bff6e-151">This tells Visual Studio to not attach to the IIS process for debugging.</span></span>  
  
4. <span data-ttu-id="bff6e-152">Клиентское приложение немедленно вызовет службу рабочих процессов и перейдет в состояние ожидания.</span><span class="sxs-lookup"><span data-stu-id="bff6e-152">The client application will immediately call the Workflow service and then wait.</span></span> <span data-ttu-id="bff6e-153">Служба рабочих процессов перейдет в состояние бездействия и будет сохранена.</span><span class="sxs-lookup"><span data-stu-id="bff6e-153">The workflow service will go idle and be persisted.</span></span> <span data-ttu-id="bff6e-154">Чтобы это проверить, запустите диспетчер служб IIS (inetmgr.exe), перейдите к элементу OrderService в области «Соединения» и выберите его.</span><span class="sxs-lookup"><span data-stu-id="bff6e-154">You can verify this by starting Internet Information Services (inetmgr.exe), navigating to the OrderService in the Connections pane and selecting it.</span></span> <span data-ttu-id="bff6e-155">Затем щелкните значок панели мониторинга фабрики приложений на панели справа.</span><span class="sxs-lookup"><span data-stu-id="bff6e-155">Next, click the App Fabric Dashboard icon in the right-hand pane.</span></span> <span data-ttu-id="bff6e-156">В разделе Материализованные экземпляры WF появится один сохраненный экземпляр службы рабочего процесса, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-156">Under Persisted WF Instances you will see there is one persisted workflow service instance as shown in the following screenshot.</span></span>  
  
     ![Снимок экрана, на котором показана панель мониторинга структуры приложений.](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/app-fabric-dashboard.gif)  
  
     <span data-ttu-id="bff6e-158">В **журнале экземпляров WF** содержится информация о службе рабочего процесса, например число активаций службы рабочих процессов, число завершений экземпляров службы рабочего процесса и количество экземпляров рабочих процессов с ошибками.</span><span class="sxs-lookup"><span data-stu-id="bff6e-158">The **WF Instance History** lists information about the workflow service such as the number of workflow service activations, the number of workflow service instance completions, and the number of workflow instances with failures.</span></span> <span data-ttu-id="bff6e-159">В разделе активные или неактивные экземпляры появится ссылка, щелкнув ссылку, чтобы просмотреть дополнительные сведения об активных экземплярах рабочего процесса, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="bff6e-159">Under Active or Idle instances a link will be displayed, clicking on the link will display more information about the idle workflow instances as shown in the following screenshot.</span></span>  
  
     ![Снимок экрана, на котором показаны сохраненные сведения об экземпляре рабочего процесса.](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/persisted-workflow-instance-detail.gif)  
  
     <span data-ttu-id="bff6e-161">Дополнительные сведения о функциях Windows Server App Fabric и способах их использования см. в статье [функции размещения Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10)) .</span><span class="sxs-lookup"><span data-stu-id="bff6e-161">For more information about Windows Server App Fabric features and how to use them see [Windows Server App Fabric Hosting Features](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bff6e-162">Дополнительно</span><span class="sxs-lookup"><span data-stu-id="bff6e-162">See also</span></span>

- [<span data-ttu-id="bff6e-163">Создание службы долго выполняющегося рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="bff6e-163">Creating a Long-running Workflow Service</span></span>](creating-a-long-running-workflow-service.md)
- <span data-ttu-id="bff6e-164">[Функции размещения Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="bff6e-164">[Windows Server App Fabric Hosting Features](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))</span></span>
- <span data-ttu-id="bff6e-165">[Установка Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="bff6e-165">[Installing Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10))</span></span>
- <span data-ttu-id="bff6e-166">[Документация по Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="bff6e-166">[Windows Server App Fabric Documentation](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10))</span></span>
