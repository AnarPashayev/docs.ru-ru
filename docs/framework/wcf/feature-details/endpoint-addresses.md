---
title: Адреса конечных точек
ms.date: 03/30/2017
helpviewer_keywords:
- addresses [WCF]
- Windows Communication Foundation [WCF], addresses
- WCF [WCF], addresses
ms.assetid: 13f269e3-ebb1-433c-86cf-54fbd866a627
ms.openlocfilehash: f59b8403ecb683dafa6963565da46e517b5a2cbc
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61856639"
---
# <a name="endpoint-addresses"></a>Адреса конечных точек
С каждой конечной точкой связан адрес, который используется для поиска и идентификации этой конечной точки. Этот адрес в первую очередь включает универсальный код ресурса (URI), задающий расположение конечной точки. Адрес конечной точки представляется в модели программирования Windows Communication Foundation (WCF), <xref:System.ServiceModel.EndpointAddress> класс, который содержит необязательное <xref:System.ServiceModel.EndpointAddress.Identity%2A> свойство, которое позволяет выполнять проверку подлинности конечной точки другими конечными точками, обмена с ней сообщениями, а также набор необязательных <xref:System.ServiceModel.EndpointAddress.Headers%2A> свойства, определяющие другие заголовки SOAP, необходимые для доступа к службе. Необязательные заголовки содержат дополнительную и более подробную информацию для идентификации конечной точки службы и взаимодействия с ней. При передаче данных по каналам связи адрес конечной точки представляется ссылкой на конечную точку WS-Addressing.  
  
## <a name="uri-structure-of-an-address"></a>Структура универсального кода ресурса (URI) адреса  
 Универсальный код ресурса (URI) адреса для большинства видов транспорта состоит из четырех частей. Например, четыре части URI `http://www.fabrikam.com:322/mathservice.svc/secureEndpoint` может быть детализированы следующим образом:  
  
- Схема: `http:`
  
- Компьютер: `www.fabrikam.com`  
  
- (необязательно) Порт: 322  
  
- Путь: /mathservice.svc/secureEndpoint  
  
## <a name="defining-an-address-for-a-service"></a>Определение адреса службы  
 Адрес конечной точки службы можно задать императивно с помощью кода или декларативно с помощью конфигурации. Как правило, определять конечные точки в коде непрактично, поскольку привязки и адреса для развернутой службы чаще всего отличаются от привязок и адресов, используемых в процессе разработки службы. Обычно более целесообразно задать конечные точки службы в конфигурации, а не в коде. Если не указывать привязку и адрес в коде, их можно изменять, не выполняя повторную компиляцию или повторное развертывание приложения.  
  
### <a name="defining-an-address-in-configuration"></a>Определение адреса в файле конфигурации  
 Чтобы определить конечную точку в файле конфигурации, используйте [ \<конечной точки >](../../../../docs/framework/configure-apps/file-schema/wcf/endpoint-element.md) элемент. Дополнительные сведения и пример, см. в разделе [Задание адреса конечной точки](../../../../docs/framework/wcf/specifying-an-endpoint-address.md).  
  
### <a name="defining-an-address-in-code"></a>Определение адреса в коде  
 Адрес конечной точки можно создать в коде с помощью класса <xref:System.ServiceModel.EndpointAddress>. Дополнительные сведения и пример, см. в разделе [Задание адреса конечной точки](../../../../docs/framework/wcf/specifying-an-endpoint-address.md).  
  
### <a name="endpoints-in-wsdl"></a>Конечные точки на языке WSDL  
 Адрес конечной точки также может быть представлен на языке WSDL в виде элемента EPR WS-Addressing в элементе `wsdl:port` соответствующей конечной точки. Ссылка на конечную точку (EPR) содержит адрес конечной точки и любые свойства адреса. Дополнительные сведения и пример, см. в разделе [Задание адреса конечной точки](../../../../docs/framework/wcf/specifying-an-endpoint-address.md).  
  
## <a name="multiple-iis-binding-support-in-net-framework-35"></a>Поддержка привязки в .NET Framework 3.5 несколько служб IIS  
 Поставщики услуг Интернета часто размещают большое число приложений на одном сайте и сервере, чтобы повысить эффективность использования сайта и сократить совокупную стоимость владения. Эти приложения обычно привязываются к различным базовым адресам. Веб-сайт служб IIS может содержать несколько приложений. Доступ к приложениям на сайте может осуществляться через одну или несколько привязок служб IIS.  
  
 Привязки IIS предоставляют два блока данных: протокол привязки и данные привязки. Протокол привязки определяет схему, посредством которой осуществляется связь, а данные привязки содержат сведения, используемые для доступа к сайту.  
  
 Ниже приведен пример элементов, которые могут присутствовать в привязке IIS.  
  
- Протокол привязки: HTTP  
  
- Сведения о привязке: IP-адрес, порт, заголовок узла  
  
 Службы IIS поддерживают задание нескольких привязок для каждого сайта, что позволяет использовать несколько базовых адресов для каждой схемы. До версии [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)], WCF не поддерживает несколько адресов для схемы и, если они были заданы, вызвал <xref:System.ArgumentException> во время активации.  
  
 [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] позволяет поставщикам услуг Интернета размещать на одном сайте несколько приложений с различными базовыми адресами в рамках одной схемы.  
  
 Например, сайт может содержать следующие базовые адреса:  
  
- `http://payroll.myorg.com/Service.svc`
  
- `http://shipping.myorg.com/Service.svc`
  
 Платформа [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] позволяет задать в файле конфигурации фильтр префикса на уровне домена приложения. Это сделать с помощью [ \<baseAddressPrefixFilters >](../../../../docs/framework/configure-apps/file-schema/wcf/baseaddressprefixfilters.md) элемент, который содержит список префиксов. Входящие базовые адреса, предоставляемые службами IIS, фильтруются с использованием необязательно списка префиксов. Если префикс не задан, по умолчанию пропускаются все адреса. При задании префикса разрешается прохождение данных только с соответствующего базового адреса для данной схемы.  
  
 Ниже приведен пример кода конфигурации, в котором используются фильтры префиксов.  
  
```xml  
<system.serviceModel>  
  <serviceHostingEnvironment>  
     <baseAddressPrefixFilters>  
        <add prefix="net.tcp://payroll.myorg.com:8000"/>  
        <add prefix="http://shipping.myorg.com:8000"/>  
    </baseAddressPrefixFilters>  
  </serviceHostingEnvironment>  
</system.serviceModel>  
```  
  
 В приведенном выше примере `net.tcp://payroll.myorg.com:8000` и `http://shipping.myorg.com:8000` являются единственными базовыми адресами для соответствующих схем, которые передаются через.  
  
 Элемент `baseAddressPrefixFilter` не поддерживает подстановочные знаки.  
  
 Среди базовых адресов, предоставляемых службами IIS, могут присутствовать адреса, привязанные к другим схемам, не представленным в списке `baseAddressPrefixFilters`. Эти адреса не фильтруются.  
  
## <a name="multiple-iis-binding-support-in-net-framework-4-and-later"></a>Поддержка нескольких привязок служб IIS в платформе .NET Framework 4 и более поздних версиях  
 Начиная с .NET 4, в службах IIS можно включить поддержку нескольких привязок, при этом не требуется выбирать один базовый адрес. Для этого атрибуту <xref:System.ServiceModel.ServiceHostingEnvironment> элемента <xref:System.ServiceModel.ServiceHostingEnvironment.MultipleSiteBindingsEnabled%2A> необходимо задать значение true. Эта поддержка обеспечивается только для схем протокола HTTP.  
  
 Ниже приведен пример кода конфигурации, используется атрибут multiplesitebindingsenabled элемента на [ \<serviceHostingEnvironment >](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md).  
  
```xml  
<system.serviceModel>  
  <serviceHostingEnvironment multipleSiteBindingsEnabled="true" >  
  </serviceHostingEnvironment>  
</system.serviceModel>  
```  
  
 Если с помощью этого параметра включены несколько привязок к узлам, все параметры baseAddressPrefixFilters не учитываются как для протокола HTTP, так и для других протоколов.  
  
 Дополнительные сведения и примеры, см. в разделе [поддержка нескольких привязок узла IIS](../../../../docs/framework/wcf/feature-details/supporting-multiple-iis-site-bindings.md) и <xref:System.ServiceModel.ServiceHostingEnvironment.MultipleSiteBindingsEnabled%2A>.  
  
## <a name="extending-addressing-in-wcf-services"></a>Расширение модели адресов в службах WCF  
 По умолчанию, указывающий модели служб WCF использует URI адреса конечной точки для следующих целей:  
  
- задание адреса ожидания передачи данных службы, т. е. расположения, по которому конечная точка ожидает сообщений;  
  
- задание фильтра адресов SOAP, т. е. адреса, ожидаемого конечной точкой в качестве заголовка SOAP.  
  
 Значения в каждом из этих случаев могут задаваться отдельно, что позволяет реализовать несколько расширений модели адресов, которые можно использовать в следующих сценариях:  
  
- посредники протокола SOAP: сообщение, отправляемое клиентом, проходит через одну или несколько дополнительных служб, обрабатывающих это сообщение, прежде чем оно достигнет конечной точки назначения. Посредники протокола SOAP могут выполнять с сообщениями различные задачи, например кэширование, маршрутизацию или проверку схемы. Этот сценарий также можно реализовать путем отправки сообщения по отдельному физическому адресу (`via`), нацеленному на посредник, а не просто по логическому адресу (`wsa:To`), который нацелен на конечную точку назначения;  
  
- адрес ожидания передачи данных конечной точки является закрытым универсальным кодом ресурса (URI) и имеет значение, отличное от значения свойства `listenURI`.  
  
 Адрес транспорта, задаваемый параметром `via`, определяет расположение, через которое сообщение должно предварительно пройти по пути на какой-либо другой удаленный адрес, задаваемый параметром `to` и определяющий расположение службы. В большинстве случаев работы через Интернет значение универсального кода ресурса (URI) `via` совпадает со значением свойства <xref:System.ServiceModel.EndpointAddress.Uri%2A> конечного адреса `to` службы. При осуществлении маршрутизации вручную приходится выбирать только между этими двумя адресами.  
  
### <a name="addressing-headers"></a>Заголовки адресов  
 Помимо базового универсального кода ресурса (URI) к конечной точке можно обратиться по одному или нескольким заголовкам SOAP. К сценариям, в которых это бывает удобно, относятся сценарии с посредниками протокола SOAP, в которых конечная точка требует, чтобы клиенты включали заголовки SOAP, нацеленные на посредники.  
  
 Пользовательские заголовки адресов можно определять двумя способами - с помощью кода или файла конфигурации:  
  
- в коде создайте пользовательские заголовки адреса с помощью класса <xref:System.ServiceModel.Channels.AddressHeader>, а затем используйте их в конструкторе класса <xref:System.ServiceModel.EndpointAddress>;  
  
- В конфигурации пользовательские [ \<заголовки >](../../configure-apps/file-schema/wcf/headers.md) указываются как дочерние элементы [ \<конечной точки >](../../configure-apps/file-schema/wcf/endpoint-of-client.md) элемент.  
  
 Обычно рекомендуется использовать не код, а файл конфигурации, поскольку в этом случае заголовки можно будет менять после развертывания.  
  
### <a name="custom-listening-addresses"></a>Пользовательские адреса ожидания передачи данных  
 Можно задать адрес ожидания передачи данных, который отличается от универсального кода ресурса (URI) конечной точки. Это бывает удобно в сценариях с посредниками, когда предоставляемый адрес SOAP является адресом открытого посредника протокола SOAP, а адрес, по которому конечная точка ожидает передачи данных, является закрытым сетевым адресом.  
  
 Пользовательский адрес ожидания передачи данных можно задать с помощью кода или файла конфигурации:  
  
- для задания пользовательского адреса ожидания передачи данных в коде необходимо добавить класс <xref:System.ServiceModel.Description.ClientViaBehavior> в коллекцию расширений функциональности конечной точки;  
  
- В конфигурации укажите пользовательский адрес ожидания передачи данных с помощью `ListenUri` атрибут службы [ \<конечной точки >](../../configure-apps/file-schema/wcf/endpoint-element.md) элемент.  
  
### <a name="custom-soap-address-filter"></a>Пользовательский фильтр адресов SOAP  
 Свойство <xref:System.ServiceModel.EndpointAddress.Uri%2A> в сочетании со свойством <xref:System.ServiceModel.EndpointAddress.Headers%2A> позволяет определить фильтр адресов SOAP конечной точки (<xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A>). По умолчанию этот фильтр проверяет, что заголовок `To` входящего сообщения совпадает с универсальным кодом ресурса (URI) конечной точки и что в сообщении имеются все обязательные заголовки конечной точки.  
  
 В некоторых сценариях конечная точка получает все сообщения, которые приходят через соответствующий транспорт, а не только те, у которых есть соответствующий заголовок `To`. Чтобы включить такой режим, можно воспользоваться классом <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter>.  
  
## <a name="see-also"></a>См. также

- [Указание адреса конечной точки](../../../../docs/framework/wcf/specifying-an-endpoint-address.md)
- [Идентификация и проверка подлинности службы](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)
