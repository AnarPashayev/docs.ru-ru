---
title: Общие сведения о расширенной защите для проверки подлинности
ms.date: 03/30/2017
ms.assetid: 3d2ceffe-a7bf-4bd9-a5a2-9406423bd7f8
ms.openlocfilehash: 400bf7987b5fcd4ec75628d19a30739dd5f23b08
ms.sourcegitcommit: c01c18755bb7b0f82c7232314ccf7955ea7834db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "75964602"
---
# <a name="extended-protection-for-authentication-overview"></a><span data-ttu-id="5cfd9-102">Общие сведения о расширенной защите для проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="5cfd9-102">Extended Protection for Authentication Overview</span></span>
<span data-ttu-id="5cfd9-103">Расширенная защита для проверки подлинности обеспечивает защиту от атак типа «злоумышленник в середине», когда злоумышленник перехватывает клиентские учетные данные и отправляет их на сервер.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-103">Extended Protection for Authentication helps protect against man-in-the-middle (MITM) attacks, in which an attacker intercepts a client’s credentials and forwards them to a server.</span></span>  
  
 <span data-ttu-id="5cfd9-104">Рассмотрим сценарий с тремя участниками: клиент, сервер и злоумышленник.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-104">Consider a scenario with three participants: a client, server, and attacker.</span></span> <span data-ttu-id="5cfd9-105">Сервер имеет URL-адрес `https://server`, а злоумышленник имеет URL-адрес `https://attacker`.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-105">The server has the URL `https://server`, whereas the attacker has the URL `https://attacker`.</span></span> <span data-ttu-id="5cfd9-106">Злоумышленник обманом заставляет клиента обратиться к компьютеру злоумышленника вместо сервера.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-106">The attacker tricks the client into accessing the attacker as if it were the server.</span></span> <span data-ttu-id="5cfd9-107">Затем злоумышленник отправляет запрос на сервер.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-107">The attacker then sends a request to the server.</span></span> <span data-ttu-id="5cfd9-108">Если злоумышленник пытается получить доступ к защищенному ресурсу, сервер возвращает злоумышленнику заголовок WWW-Authenticate header.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-108">If the attacker is trying to access a secure resource, the server replies to the attacker with a WWW-Authenticate header.</span></span> <span data-ttu-id="5cfd9-109">Злоумышленник не обладает данными для проверки подлинности и отправляет заголовок WWW-Authenticate клиенту.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-109">The attacker does not have the authentication information, so it sends the WWW-Authenticate header on to the client.</span></span> <span data-ttu-id="5cfd9-110">Клиент отправляет злоумышленнику заголовок Authorization, а злоумышленник отправляет его на сервер и получает доступ к защищенным ресурсам по учетным данным клиента.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-110">The client sends the Authorization header to the attacker, and the attacker sends the header on to the server and gets access to the secure resources using the client’s credentials.</span></span>  
  
 <span data-ttu-id="5cfd9-111">В текущей версии, если клиентское приложение проходит проверку подлинности на сервере с использованием протокола Kerberos, дайджест-проверку подлинности или проверку NTLM с использованием HTTPS, то сначала устанавливается канал безопасности транспортного уровня (TLS), а проверка подлинности выполняется по этому каналу.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-111">Currently, when a client application authenticates itself to the server using Kerberos, Digest, or NTLM using HTTPS, a Transport Level Security (TLS) channel is first established and authentication takes place using this channel.</span></span> <span data-ttu-id="5cfd9-112">При этом отсутствует привязка между сеансовым ключом, создаваемым протоколом SSL, и сеансовым ключом, создаваемым в ходе проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-112">However, there is no binding between the session key generated by Secure Sockets Layer (SSL) and the session key that is generated during authentication.</span></span> <span data-ttu-id="5cfd9-113">Поэтому если в предыдущем сценарии обмен данными выполняется через TLS (например, канал HTTPS), то создаются два канала SSL: один между клиентом и злоумышленником и другой между злоумышленником и сервером.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-113">So, in the previous scenario, if the communication takes places over a TLS (such as an HTTPS channel), there are two SSL channels created: one between the client and the attacker, and another between the attacker and the server.</span></span> <span data-ttu-id="5cfd9-114">Учетные данные клиента отправляются от клиента на сервер сначала через канал SSL между клиентом и злоумышленником, а затем через канал между злоумышленником и сервером.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-114">The client’s credentials are sent from the client to the server first over the SSL channel between the client and the attacker and then over the channel between the attacker and the server.</span></span> <span data-ttu-id="5cfd9-115">После того как учетные данные клиента попадают на сервер, сервер проверяет учетные данные и не обнаруживает, что канал, по которому отправлены эти учетные данные, связывает сервер не с клиентом, а со злоумышленником.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-115">Once the client’s credentials reach the server, the server verifies the credentials without detecting that the channel over which those credentials were sent originated with the attacker and not the client.</span></span>  
  
 <span data-ttu-id="5cfd9-116">Решением является использование внешнего канала с защитой TLS и внутреннего канала с проверкой подлинности клиента, а также передача маркера привязки канала (CBT) на сервер.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-116">The solution is to use a TLS-secured outer channel and a client-authenticated inner channel, and to pass a Channel Binding Token (CBT) to the server.</span></span> <span data-ttu-id="5cfd9-117">CBT является свойством внешнего канала с защитой TLS и используется для привязки внешнего канала к диалогу через внутренний канал с проверкой подлинности клиента.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-117">The CBT is a property of the TLS-secured outer channel, and is used to bind the outer channel to a conversation over the client-authenticated inner channel.</span></span>  
  
 <span data-ttu-id="5cfd9-118">В предыдущем сценарии CBT канала TLS между клиентом и злоумышленником объединяется с данными авторизации, которые отправляются на сервер.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-118">In the previous scenario, the CBT of the client-attacker TLS channel is merged with the authorization information that is sent to the server.</span></span> <span data-ttu-id="5cfd9-119">Сервер с поддержкой CBT сравнивает CBT, входящий в данные проверки подлинности клиента, которые соответствуют каналу между клиентом и злоумышленником, с CBT, относящимся к каналу между злоумышленником и сервером.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-119">A CBT-aware server compares the CBT contained in the client authentication information, which corresponds to the client-attacker channel, to the CBT attached to the attacker-server channel.</span></span> <span data-ttu-id="5cfd9-120">CBT зависит от назначения канала, и поэтому CBT канала между клиентом и злоумышленником не совпадает с CBT канала между злоумышленником и сервером.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-120">A CBT is specific to a channel’s destination, so the client-attacker CBT does not match the attacker-server CBT.</span></span> <span data-ttu-id="5cfd9-121">Это различие позволяет серверу обнаружить атаку MITM и отклонить запрос проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-121">This lets the server detect the MITM attack and refuse the authentication request.</span></span>  
  
 <span data-ttu-id="5cfd9-122">На клиентской стороне не требуется изменение конфигурации.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-122">The client side does not require any configuration setting.</span></span> <span data-ttu-id="5cfd9-123">После обновления клиента для передачи CBT на сервер такая передача выполняется всегда.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-123">Once the client has been updated to pass the CBT to the server, it always does so.</span></span> <span data-ttu-id="5cfd9-124">Если сервер также прошел обновление, его можно настроить для использования CBT или пропуска CBT.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-124">If the server has also been updated, it can be configured to use the CBT or ignore it.</span></span> <span data-ttu-id="5cfd9-125">Необновленный сервер всегда пропускает CBT.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-125">If it has not been updated, it ignores it.</span></span>  
  
 <span data-ttu-id="5cfd9-126">Сервер может обладать следующими уровнями защиты.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-126">The server can have the following levels of protection:</span></span>  
  
- <span data-ttu-id="5cfd9-127">Нет.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-127">None.</span></span> <span data-ttu-id="5cfd9-128">Проверка привязки канала не выполняется.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-128">No channel binding validation is performed.</span></span> <span data-ttu-id="5cfd9-129">Этот уровень действует для всех серверов, которые не прошли обновление.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-129">This is the behavior of all servers that have not been updated.</span></span>  
  
- <span data-ttu-id="5cfd9-130">Частичная.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-130">Partial.</span></span> <span data-ttu-id="5cfd9-131">Все клиенты, которые прошли обновление, должны предоставлять серверу данные о привязке канала.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-131">All clients that have been updated must provide channel binding information to the server.</span></span> <span data-ttu-id="5cfd9-132">Клиенты, которые не прошли обновление, не должны предоставлять такие данные.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-132">Clients that have not been updated do not have to do so.</span></span> <span data-ttu-id="5cfd9-133">Это промежуточный вариант, который реализован для обеспечения совместимости с приложениями.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-133">This is an intermediate option that allows for application compatibility.</span></span>  
  
- <span data-ttu-id="5cfd9-134">Полная.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-134">Full.</span></span> <span data-ttu-id="5cfd9-135">Все клиенты должны предоставлять данные о привязке канала.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-135">All clients must provide channel binding information.</span></span> <span data-ttu-id="5cfd9-136">Сервер отклоняет запросы проверки подлинности от клиентов, не предоставляющих такие данные.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-136">The server rejects authentication requests from clients that do not do so.</span></span>  
  
 <span data-ttu-id="5cfd9-137">Дополнительные сведения см. в образце Win7 CBT/Extended Protection.</span><span class="sxs-lookup"><span data-stu-id="5cfd9-137">For more information, see the Win7 CBT/Extended Protection sample.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5cfd9-138">См. также:</span><span class="sxs-lookup"><span data-stu-id="5cfd9-138">See also</span></span>

- <span data-ttu-id="5cfd9-139">[Модель безопасности для Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677202(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="5cfd9-139">[Security Model for Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677202(v=azure.10))</span></span>
