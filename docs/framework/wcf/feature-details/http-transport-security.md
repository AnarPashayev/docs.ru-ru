---
title: Безопасность транспорта HTTP
ms.date: 03/30/2017
ms.assetid: d3439262-c58e-4d30-9f2b-a160170582bb
ms.openlocfilehash: 456df42848c009dcf42022ac674a1d27e5b33972
ms.sourcegitcommit: 2d42b7ae4252cfe1232777f501ea9ac97df31b63
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2019
ms.locfileid: "67487022"
---
# <a name="http-transport-security"></a>Безопасность транспорта HTTP
Если в качестве транспорта используется протокол HTTP, безопасность обеспечивается реализацией протокола SSL (Secure Sockets Layer). Протокол SSL широко используется в Интернете для проверки подлинности службы при подключении клиента, а затем и для обеспечения конфиденциальности (шифрования) канала. В этом разделе объясняется, как SSL работает и как это реализуется в Windows Communication Foundation (WCF).  
  
## <a name="basic-ssl"></a>Базовый SSL  
 Лучше всего функционирование SSL можно продемонстрировать с помощью стандартного сценария, в данном случае - веб-сайта банка. Сайт позволяет клиенту входить в систему с помощью имени пользователя и пароля. После прохождения проверки подлинности пользователь может совершать различные транзакции, например просматривать балансы счетов, оплачивать счета и переводить деньги с одного счета на другой.  
  
 Когда пользователь посещает сайт впервые, механизм SSL начинает серию согласований, которая называется *подтверждения*, с клиентом пользователя (в данном случае Internet Explorer). Во-первых, SSL проводит проверку подлинности сайта банка для клиента. Это очень важный шаг, так как в первую очередь клиенты должны знать, что они взаимодействуют с настоящим сайтом, а не подделкой, с помощью которой злоумышленники пытаются обманным путем получить их имя пользователя и пароль. SSL проводит такую проверку подлинности с помощью сертификата SSL, предоставляемого надежным центром сертификации, таким как VeriSign. Логика выглядит следующим образом: VeriSign подтверждает удостоверение сайта банка. Поскольку Internet Explorer доверяет VeriSign, этот сайт считается надежным. Если вы хотите осуществлять проверку с VeriSign, щелкните по логотипу VeriSign. Сертификат VeriSign представляет утверждение подлинности с датой истечения срока действия и указанием, кому был выписан сертификат (сайту банка).  
  
 Чтобы инициировать безопасный сеанс, клиент отправляет серверу эквивалент приветствия, а также список алгоритмов шифрования, которые могут быть использованы клиентом для подписания, шифрования и расшифровки данных и создания хэшей. В ответ сайт отправляет подтверждение и указывает, какой набор алгоритмов был выбран. В ходе такого первоначального подтверждения оба участника посылают и отправляют специальные слова. Объект *nonce* является случайным образом созданный блок данных, используемый, в сочетании с помощью открытого ключа сайта, для создания хэша. Объект *хэш* новый номер, который является производным от двух чисел с помощью стандартного алгоритма, такого как SHA1. (Клиент и сайт также обмениваются сообщениями, чтобы согласовать, какой хэш-алгоритм следует использовать.) Хэш уникален и используется только для шифрования и расшифровки сообщений в ходе сеанса между клиентом и сайтом. Как клиент, так и служба имеют исходное специальное слово и открытый ключ сертификата, поэтому обе стороны могут создать один и тот же хэш. Следовательно, клиент проверяет хэш, отправленный службой, (а) используя согласованный алгоритм для вычисления хэша из данных и (б) сравнивая его с хэшем, отправленным службой; если хэши соответствуют друг другу, клиент может быть уверен, что хэш не был подделан. После этого клиент может использовать этот хэш в качестве ключа для шифрования сообщения, которое содержит другой, новый хэш. Служба может расшифровать сообщение с помощью хэша и восстановить предпоследний хэш. Теперь накопленная информация (специальные слова, открытый ключ и другие данные) известна обеим сторонам, и они могут создать окончательный хэш (или главный ключ). Окончательный ключ отправляется зашифрованным с использованием предпоследнего хэша. Затем главный ключ используется для шифрования и расшифровки сообщений для остальной части сеанса. Так как клиент и служба используют тот же ключ, также называется *сеансовый ключ*.  
  
 Сеансовый ключ также характеризуется как симметричный ключ или "общий секрет". Наличие симметричного ключа очень важно, так как благодаря этому обоим участникам транзакции требуется выполнять меньше вычислений. Если бы для каждого сообщения приходилось заново обмениваться специальными словами и хэшами, это значительно бы снизило производительность. Следовательно, конечной целью сертификатов SSL является использование симметричного ключа, благодаря чему оба участника взаимодействия могут свободно, более безопасно и эффективно обмениваться сообщениями.  
  
 Предыдущее описание представляет собой упрощенную версию происходящего, так как протокол по-разному функционирует на разных сайтах. Возможно также, что и клиент, и сайт создают специальные слова, которые алгоритмически сочетаются во время подтверждения, усложняя тем самым процесс обмена данными, одновременно обеспечивая его дополнительную защиту.  
  
### <a name="certificates-and-public-key-infrastructure"></a>Сертификаты и инфраструктура открытого ключа  
 Во время подтверждения служба также отправляет свой SSL-сертификат клиенту. В сертификате содержится различная информация, такая как дата истечения срока действия, центр выдачи и универсальный код ресурса (URI) сайта. Клиент сравнивает этот URI с универсальным кодом ресурса, с которым он взаимодействовал изначально, чтобы убедиться, что они соответствуют друг другу, затем клиент проверяет дату и центр выдачи сертификата.  
  
 Каждый сертификат имеет два ключа, закрытый ключ и открытый ключ, а также известные как *пара ключей обмена*. Вкратце, закрытый ключ известен только владельцу сертификата, а открытый ключ можно прочитать из сертификата. Любой из них можно использовать для шифрования и расшифровки хэш-кода, хэша или другого ключа, но только как противоположные операции. Например, если клиент осуществляет шифрование с использованием открытого ключа, только сайт может расшифровать сообщение с помощью закрытого ключа. Аналогично, если сайт осуществляет шифрование с помощью закрытого ключа, клиент может расшифровать данные с помощью открытого ключа. Благодаря этому клиент уверен, что обменивается сообщениями только с обладателем закрытого ключа, так как только сообщения, зашифрованные с помощью закрытого ключа, можно расшифровать с использованием открытого ключа. При этом сайт уверен, что обменивается сообщениями с клиентом, осуществившим шифрование с использованием открытого ключа. Такой обмен надежен только на этапе первоначального подтверждения, поэтому создание фактического симметричного ключа представляет собой гораздо более сложную процедуру. Тем не менее, все виды взаимодействия зависят от наличия у службы действительного SSL-сертификата.  
  
## <a name="implementing-ssl-with-wcf"></a>Реализация SSL с WCF  
 Безопасность транспорта HTTP (или SSL) предоставляется извне WCF. SSL можно реализовать одним из двух способов; при этом выбор способа определяется размещением приложения.  
  
- Если вы используете Internet Information Services (IIS) в качестве узла WCF, используйте инфраструктуру IIS для настройки службы SSL.  
  
- При создании резидентного приложения WCF, можно привязать SSL-сертификат к адресу, с помощью средства HttpCfg.exe.  
  
### <a name="using-iis-for-transport-security"></a>Использование служб IIS для безопасности транспорта  
  
#### <a name="iis-70"></a>IIS 7.0  
 Чтобы настроить IIS 7.0 в качестве надежного узла (с использованием SSL), см. в разделе [Настройка SSL в IIS 7.0](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc771438(v=ws.10)).  
  
Чтобы настроить сертификаты для использования с IIS 7.0, см. в разделе [Настройка сертификатов сервера в IIS 7.0](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732230(v=ws.10)).  
  
#### <a name="iis-60"></a>IIS 6,0  
 Чтобы настроить IIS 6.0 в качестве надежного узла (с использованием SSL), см. в разделе [Настройка SSL](https://go.microsoft.com/fwlink/?LinkId=88601).  
  
 Чтобы настроить сертификаты для использования с IIS 6.0, см. в разделе [Certificates_IIS_SP1_Ops](https://go.microsoft.com/fwlink/?LinkId=88602).  
  
### <a name="using-httpcfg-for-ssl"></a>Использование средства HttpCfg для SSL  
 Если вы создаете резидентного приложения WCF, загрузите средство HttpCfg.exe, доступное на [средства для поддержки Windows XP Service Pack 2 узла](https://go.microsoft.com/fwlink/?LinkId=29002).  
  
 Дополнительные сведения об использовании средства HttpCfg.exe для настройки порта с сертификатом X.509, см. в разделе [как: Настройка порта SSL-сертификат](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md).  
  
## <a name="see-also"></a>См. также

- [Безопасность транспорта](../../../../docs/framework/wcf/feature-details/transport-security.md)
- [Безопасность сообщений](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md)
