---
title: Общие сведения о надежных сеансах
ms.date: 03/30/2017
ms.assetid: a7fc4146-ee2c-444c-82d4-ef6faffccc2d
ms.openlocfilehash: 6dd90ef800daf236d77c419d48c0857ac2d78aa2
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61962661"
---
# <a name="reliable-sessions-overview"></a>Общие сведения о надежных сеансах

Windows Communication Foundation (WCF) надежный обмен сообщениями SOAP обеспечивает обмен сообщениями end-to-end между конечными точками SOAP. Такой обмен реализуется в сетях, которые ненадежны из-за исправления ошибок транспорта и ошибок на уровне сообщений SOAP. В частности, эта технология обеспечивает основанную на сеансах, одиночную, упорядоченную (необязательно) доставку сообщений, отправленных по протоколу SOAP или через транспортных посредников. Для группирования сообщений в сеансе с необязательным упорядочиванием сообщений предоставляет доставки на основе сеанса.

В этом разделе описывается надежных сеансов, как и когда их следует использовать и как для их защиты.

## <a name="wcf-reliable-sessions"></a>Надежные сеансы WCF

Надежные сеансы WCF представляет собой реализацию надежного обмена сообщениями в соответствии с определением WS-ReliableMessaging протокола SOAP.

Надежный обмен сообщениями WCF SOAP предоставляет end-to-end надежного сеанса между двумя конечными точками, независимо от количества и типа посредников, разделяющих конечные точки обмена сообщениями. Сюда входят любые транспортные посредники, которые не используют SOAP (например, HTTP-прокси) и посредники, которые используют протокол SOAP (например, мосты или маршрутизаторы на базе SOAP), которые требуются для сообщений, обмен данными между конечными точками. Канал надежного сеанса поддерживает *интерактивные* связи, чтобы службы, соединенные таким каналом выполняться одновременно, а также обмениваться и обрабатывать сообщения в условиях низкой задержкой и т. е. в относительно небольшие интервалы времени. Такое соединение означает, что эти компоненты вместе работают или отрабатывают, поэтому не изолированы между ними.

Надежный сеанс скрывает два вида сбоев.

- Сбои на уровне сообщений SOAP, которые включают в себя потерянные или дублированные сообщения и сообщения, приходящие в порядке, отличном от порядка, в котором они были отправлены.

- Сбои транспорта.

Надежный сеанс реализует протокол WS-ReliableMessaging и окно передачи в памяти, чтобы маскировать сбои на уровне сообщений SOAP, и восстанавливает подключения в случае сбоев транспорта.

Надежный сеанс обеспечивает для сообщений SOAP то, что обеспечивает TCP для IP-пакетов. Подключение через сокет TCP - это единая, упорядоченная передача IP-пакетов между узлами. Надежный канал обеспечивает тот же тип надежной передачи, но отличается от надежности сокета TCP в следующем.

- Надежность поддерживается на уровне сообщений SOAP, она не связана с пакетом байтов произвольного размера.

- Надежность поддерживается независимого от транспорта, не только для передачи по протоколу TCP.

- Надежность не привязана к определенному сеансу транспорта (например, сеанса обеспечиваемому подключением TCP) и могут использовать несколько сеансов транспорта параллельно или последовательно в течение времени существования надежного сеанса.

- Надежный сеанс осуществляется между конечными точками отправителя и получателя SOAP независимо от числа транспортных подключений, необходимых для их соединения. Иными словами надежность TCP заканчивается, где заканчивается транспортного соединения, хотя надежный сеанс обеспечивает надежность end-to-end.

## <a name="reliable-sessions-and-bindings"></a>Надежные сеансы и привязки

Как упоминалось ранее, надежный сеанс является нейтральным транспорта. Кроме того можно установить надежный сеанс через многих шаблонов обмена сообщениями, таких как запрос ответ или дуплексного. Надежные сеансы WCF предоставляется как свойство ряда привязок.

Использования надежного сеанса для конечных точек, используйте:

- стандартные привязки транспорта на основе HTTP

  - `WsHttpBinding` и предоставление контрактов типа запрос-ответ или односторонних контрактов.

  - При использовании надежного сеанса через запрос ответ или простого одностороннего контракта службы.

  - `WsDualHttpBinding` и предоставление дуплексных, односторонних контрактов или контрактов типа запрос-ответ.

  - `WsFederationHttpBinding` и предоставление контрактов типа запрос-ответ или односторонних контрактов.

- стандартные привязки транспорта на основе TCP

  - `NetTcpBinding` и предоставление дуплексных, односторонних контрактов или контрактов типа запрос-ответ.

Использования надежного сеанса для любых других привязок, создав пользовательскую привязку, например HTTPS (Дополнительные сведения о проблемах см. в разделе <a href="#reliable-sessions-and-security">надежные сеансы и безопасность</a>) или привязку именованного канала.

Надежный сеанс на базовых каналов разных типов можно складывать и получающийся канал надежного сеанса меняется. На клиенте и сервере тип поддерживаемого канала надежного сеанса зависит от типа используемого базового канала. В следующей таблице представлен список типов каналов сеансов, поддерживаемых клиентом, в качестве функции типа базового канала.

| Поддерживаемые типы каналов надежного сеанса&#8224; | `IRequestChannel` | `IRequestSessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :---------------: | :----------------------: | :--------------: | :---------------------: |
| `IOutputSessionChannel`                         | Да               | Да                      | Да              | Да                     |
| `IRequestSessionChannel`                        | Да               | Да                      | Нет               | Нет                      |
| `IDuplexSessionChannel`                         | Нет                | Нет                       | Да              | Да                     |

&#8224;Поддерживаемые типы каналов — это значения, доступные для значения универсального `TChannel` значение параметра, которое было передано в <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelFactory%60%601%28System.ServiceModel.Channels.BindingContext%29> метод.

В следующей таблице представлен список типов каналов сеансов, поддерживаемых сервером, в качестве функции типа базового канала.

| Поддерживаемые типы каналов надежного сеанса&#8225; | `IReplyChannel` | `IReplySessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :-------------: | :--------------------: | :--------------: | :---------------------: |
| `IInputSessionChannel`                          | Да             | Да                    | Да              | Да                     |
| `IReplySessionChannel`                          | Да             | Да                    | Нет               | Нет                      |
| `IDuplexSessionChannel`                         | Нет              | Нет                     | Да              | Да                     |

&#8225;Поддерживаемые типы каналов — это значения, доступные для значения универсального `TChannel` значение параметра, которое было передано в <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelListener%60%601%28System.ServiceModel.Channels.BindingContext%29> метод.

## <a name="reliable-sessions-and-security"></a>Надежные сеансы и безопасность

Защита надежного сеанса важно убедиться, что проходят проверку подлинности взаимодействующих сторон (службы и клиента) и не подделаны сообщений, передаваемых в сеансе. Кроме того важно обеспечить целостность каждого отдельного надежного сеанса. Надежный сеанс защищен, привязав его к контексту безопасности, который представленному и управляемому каналом сеанса безопасности. Канал безопасности обеспечивает сеанс безопасности. Маркеры безопасности, обмен которыми осуществляется во время установления сеанса, затем используются для защиты сообщений в надежном сеансе.

При надежный сеанс на TCP-S, сеанс TCP привязывается к надежному сеансу. Таким образом этот механизм гарантирует, что безопасности также привязан к надежному сеансу. В этом случае восстановление подключения выключено.

Единственное исключение относится к использованию HTTPS. Сеанс Secure Sockets Layer (SSL) не привязан к надежному сеансу. Это предполагает угрозу, так как сеансы, совместно использующих контекст безопасности (сеанс SSL) не будут защищены друг от друга; Это может или не может являться реальной угрозой в зависимости от приложения.

## <a name="using-reliable-sessions"></a>С использованием надежных сеансов

Чтобы использовать надежные сеансы WCF, создайте конечную точку с привязкой, которая поддерживает надежный сеанс. Используйте одну из предоставляемых системой привязок, предоставляемых WCF с помощью надежного сеанса включен, или создать собственную пользовательскую привязку, выполняющий это.

Определенные системой привязки, которые поддерживают и разрешают надежный сеанс, включают в себя:

- <xref:System.ServiceModel.WSDualHttpBinding>

Предоставляемые системой привязки, которые поддерживают надежные сеансы как параметр, но не включено по умолчанию, включают:

- <xref:System.ServiceModel.WSHttpBinding>

- <xref:System.ServiceModel.WSFederationHttpBinding>

- <xref:System.ServiceModel.NetTcpBinding>

Пример создания пользовательской привязки, см. в разделе [как: Создание пользовательской привязки надежного сеанса с использованием HTTPS](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md).

Описание привязок WCF, которые поддерживают надежные сеансы, см. в разделе [System-Provided Bindings](../../../../docs/framework/wcf/system-provided-bindings.md).

## <a name="when-to-use-reliable-sessions"></a>Когда следует использовать надежные сеансы

Это важно понимать, когда следует использовать надежные сеансы в вашем приложении. WCF поддерживает надежные сеансы между конечными точками, которые активны и работают одновременно. Если приложению требуется одна конечная точка недоступна для определенного периода времени, а затем использовать очереди для обеспечения надежности.

Если сценарий требует две конечные точки, подключенных по протоколу TCP, TCP может быть достаточно для предоставления надежного обмена сообщениями. Хотя нет необходимости использовать надежный сеанс, так как TCP гарантирует, что пакеты в правильном порядке без только один раз.

Если сценарию свойственны любой из следующих характеристик, вы должны серьезно рекомендуется использовать надежный сеанс.

- Посредники SOAP, например маршрутизаторы SOAP

- Посредники прокси или транспортные мосты

- Прерыванием связи

- Сеансы по HTTP

## <a name="see-also"></a>См. также

- [Использование привязок для настройки служб и клиентов](../../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md)
- [Надежный сеанс WS](../../../../docs/framework/wcf/samples/ws-reliable-session.md)
