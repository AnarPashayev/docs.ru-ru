---
title: Диагностика транзакционных приложений
ms.date: 03/30/2017
ms.assetid: 4a993492-1088-4d10-871b-0c09916af05f
ms.openlocfilehash: aca5f95e2085dfadf06da35dfd86af72c0b6092d
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2019
ms.locfileid: "59101716"
---
# <a name="diagnosing-transactional-applications"></a>Диагностика транзакционных приложений
В этом разделе описывается использование Windows Communication Foundation (WCF) и управлению с помощью функции диагностики для устранения неполадок транзакционного приложения.  
  
## <a name="performance-counters"></a>Счетчики производительности  
 WCF предоставляет стандартный набор счетчиков производительности для измерения производительности транзакционного приложения. Дополнительные сведения см. в разделе [Счетчики производительности](../../../../docs/framework/wcf/diagnostics/performance-counters/index.md).  
  
 Счетчики производительности группируются по трем различным уровням области действия: служба, конечная точка и операция, как описано в приведенных далее таблицах.  
  
### <a name="service-performance-counters"></a>Счетчики производительности службы  
  
|Счетчик производительности|Описание|  
|-------------------------|-----------------|  
|Количество поступивших транзакций|Количество транзакций в операциях для данной службы. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном в службу, имеется транзакция.|  
|Количество поступивших транзакций в секунду|Количество транзакций в операциях для данной службы за каждую секунду. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном в службу, имеется транзакция.|  
|Количество зафиксированных операций с поддержкой транзакций|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с результатом, зафиксированным в этой службе. Работа, выполненная в таких операциях, полностью зафиксирована. Ресурсы обновлены в соответствии с работой, выполненной в операции.|  
|Количество зафиксированных операций с поддержкой транзакций в секунду|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с результатом, зафиксированным в этой службе в течение каждой секунды. Работа, выполненная в таких операциях, полностью зафиксирована. Ресурсы обновлены в соответствии с работой, выполненной в операции.|  
|Количество прерванных операций с поддержкой транзакций|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с прерыванием в этой службе. Для работы, выполненной в таких операциях, производится откат. Для ресурсов восстанавливается предыдущее состояние.|  
|Количество прерванных операций с поддержкой транзакций в секунду|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены прерыванием в этой службе в течение каждой секунды. Для работы, выполненной в таких операциях, производится откат. Для ресурсов восстанавливается предыдущее состояние.|  
|Количество операций с поддержкой транзакций с сомнительным результатом|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с сомнительным результатом в этой службе. Работа, выполненная с результатом "сомнительно", находится в неопределенном состоянии. Ресурсы находятся в состоянии ожидания результата.|  
|Количество операций с поддержкой транзакций с сомнительным результатом в секунду|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с результатом "сомнительно" в этой службе в течение каждой секунды. Работа, выполненная с результатом "сомнительно", находится в неопределенном состоянии. Ресурсы находятся в состоянии ожидания результата.|  
  
### <a name="endpoint-performance-counters"></a>Счетчики производительности конечных точек  
  
|Счетчик производительности|Описание|  
|-------------------------|-----------------|  
|Количество поступивших транзакций|Количество транзакций, поступивших в операции на этой конечной точке. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
|Количество поступивших транзакций в секунду|Количество транзакций в операциях для данной конечной точки за каждую секунду. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
  
### <a name="operation-performance-counters"></a>Счетчики производительности операций  
  
|Счетчик производительности|Описание|  
|-------------------------|-----------------|  
|Количество поступивших транзакций|Количество транзакций, поступивших в операции на этой конечной точке. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
|Количество поступивших транзакций в секунду|Количество транзакций в операциях для данной конечной точки за каждую секунду. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
  
## <a name="windows-management-instrumentation"></a>Инструментарий управления Windows (WMI)  
 WCF предоставляет данные проверки службы во время выполнения с помощью поставщика WCF инструментария управления Windows (WMI). Дополнительные сведения о доступе к данным WMI см. в разделе [с помощью Windows Management Instrumentation для диагностики](../../../../docs/framework/wcf/diagnostics/wmi/index.md).  
  
 Ряд свойств WMI только для чтения показывает применяемые в службе параметры транзакции. В приведенных ниже таблицах перечислены эти параметры.  
  
 В службе атрибут `ServiceBehaviorAttribute` имеет следующие свойства.  
  
|name|Тип|Описание|  
|----------|----------|-----------------|  
|ReleaseServiceInstanceOnTransactionComplete|Boolean|Указывает, производится ли повторное использование объекта службы после завершения текущей транзакции.|  
|TransactionAutoCompleteOnSessionClose|Boolean|Указывает, завершаются ли ожидающие транзакции при закрытии текущего сеанса.|  
|TransactionIsolationLevel|Строка, содержащая допустимое значение перечисления <xref:System.Transactions.IsolationLevel>.|Задает уровень изоляции транзакции, поддерживаемый этой службой.|  
|TransactionTimeout|<xref:System.DateTime>|Задает период времени, в течение которого транзакция должна быть завершена.|  
  
 Атрибут `ServiceTimeoutsBehavior` имеет следующее свойство.  
  
|name|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionTimeout|<xref:System.DateTime>|Задает период времени, в течение которого транзакция должна быть завершена.|  
  
 В привязке атрибут `TransactionFlowBindingElement` имеет следующие свойства.  
  
|name|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionProtocol|Строка, содержащая допустимое значение типа <xref:System.ServiceModel.TransactionProtocol>.|Указывает протокол транзакций, используемый при передаче транзакций.|  
|TransactionFlow|Boolean|Задает, включен ли входящий поток транзакций.|  
  
 В операции атрибут `OperationBehaviorAttribute` имеет следующие свойства.  
  
|name|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionAutoComplete|Boolean|Указывает, следует ли автоматически фиксировать текущую транзакцию при отсутствии необработанных исключений.|  
|TransactionScopeRequired|Boolean|Указывает, требует ли операция транзакции.|  
  
 В операции атрибут `TransactionFlowAttribute` имеет следующие свойства.  
  
|name|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionFlowOption|Строка, содержащая допустимое значение перечисления <xref:System.ServiceModel.TransactionFlowOption>.|Задает область, к которой требуется поток транзакций.|  
  
## <a name="tracing"></a>Трассировка  
 Трассировка позволяет контролировать и анализировать ошибки в транзакционных приложениях. Трассировку можно включить следующими способами.  
  
-   Стандартная трассировка WCF  
  
     Трассировка этого типа является таким же, как трассировка любого приложения WCF. Для получения дополнительной информации см. [Configuring Tracing](../../../../docs/framework/wcf/diagnostics/tracing/configuring-tracing.md).  
  
-   Трассировка WS-AtomicTransaction  
  
     WS-AtomicTransaction трассировку можно включить с помощью [служебную программу настройки WS-AtomicTransaction (wsatConfig.exe)](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md). Такая трассировка позволяет контролировать состояние транзакций и участников внутри системы. Чтобы включить также и трассировку модели службы, можно задать для ключа реестра `HKLM\SOFTWARE\Microsoft\WSAT\3.0\ServiceModelDiagnosticTracing` допустимое значение перечисления <xref:System.Diagnostics.SourceLevels>. Вы можете включить ведение журнала так же, как другие приложения WCF сообщений.  
  
-   `System.Transactions` трассировка  
  
     При использовании протокола OleTransactions возможна трассировка сообщений протокола. Поддержка трассировки, предоставляемая инфраструктурой <xref:System.Transactions> (которая использует протокол OleTransactions), позволяет пользователям просматривать события, происходящие с транзакциями. Чтобы включить трассировку для приложения <xref:System.Transactions>, поместите приведенный ниже код в файл конфигурации `App.config`.  
  
    ```xml  
    <configuration>  
      <system.diagnostics>  
         <sources>  
            <source name="System.Transactions" switchValue="Verbose, ActivityTracing">  
               <listeners>  
                  <add name="Text"  
                     type="System.Diagnostics.XmlWriterTraceListener"  
                     initializeData="SysTx.log"  
                     traceOutputOptions="Callstack" />  
               </listeners>  
            </source>  
         </sources>  
         <trace autoflush="true" indentsize="4">  
         </trace>  
      </system.diagnostics>  
    </configuration>  
    ```  
  
     Это также позволяет трассировки WCF, а также использует WCF <xref:System.Transactions> инфраструктуры.  
  
## <a name="see-also"></a>См. также

- [Администрирование и диагностика](../../../../docs/framework/wcf/diagnostics/index.md)
- [Настройка трассировки](../../../../docs/framework/wcf/diagnostics/tracing/configuring-tracing.md)
- [Программа конфигурации WS-AtomicTransaction (wsatConfig.exe)](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)
