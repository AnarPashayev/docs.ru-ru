---
title: Вопросы безопасности при использовании метаданных
ms.date: 03/30/2017
ms.assetid: e78ef8ab-4f63-4656-ab93-b1deab2666d5
ms.openlocfilehash: 0dc060475f868923e8c7e4c87ef43ef5912c7ac5
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59172969"
---
# <a name="security-considerations-with-metadata"></a><span data-ttu-id="5bc09-102">Вопросы безопасности при использовании метаданных</span><span class="sxs-lookup"><span data-stu-id="5bc09-102">Security Considerations with Metadata</span></span>
<span data-ttu-id="5bc09-103">При использовании функций метаданных в Windows Communication Foundation (WCF), следует рассмотрите влияние на безопасность из публикации, извлечения и использования метаданных службы.</span><span class="sxs-lookup"><span data-stu-id="5bc09-103">When using the metadata features in Windows Communication Foundation (WCF), consider the security implications of publishing, retrieving, and using service metadata.</span></span>  
  
## <a name="when-to-publish-metadata"></a><span data-ttu-id="5bc09-104">В каких случаях следует публиковать метаданные</span><span class="sxs-lookup"><span data-stu-id="5bc09-104">When to Publish Metadata</span></span>  
 <span data-ttu-id="5bc09-105">Службы WCF не публикуют метаданные по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="5bc09-105">WCF services do not publish metadata by default.</span></span> <span data-ttu-id="5bc09-106">Публикация метаданных для службы WCF, необходимо явным образом включить публикацию метаданных, добавив конечные точки метаданных службы (см. в разделе [публикация метаданных](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)).</span><span class="sxs-lookup"><span data-stu-id="5bc09-106">To publish metadata for a WCF service you must explicitly enable metadata publishing by adding metadata endpoints to your service (see [Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)).</span></span> <span data-ttu-id="5bc09-107">Если публикацию метаданных оставить отключенной, это уменьшит возможности для атаки на службу и снизит риск непреднамеренного раскрытия информации.</span><span class="sxs-lookup"><span data-stu-id="5bc09-107">Leaving metadata publishing disabled reduces the attack surface for your service and lowers the risk of unintentional information disclosure.</span></span> <span data-ttu-id="5bc09-108">Не все службы должны публиковать метаданные.</span><span class="sxs-lookup"><span data-stu-id="5bc09-108">Not all services must publish metadata.</span></span> <span data-ttu-id="5bc09-109">Если публиковать метаданные не требуется, подумайте о том, чтобы отключить их.</span><span class="sxs-lookup"><span data-stu-id="5bc09-109">If you do not have to publish metadata, consider leaving it turned off.</span></span> <span data-ttu-id="5bc09-110">Обратите внимание, что вы все равно можно создавать метаданные и код клиента непосредственно из сборок службы, используя [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="5bc09-110">Note that you can still generate metadata and client code directly from your service assemblies using the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="5bc09-111">Дополнительные сведения об использовании Svcutil.exe для экспорта метаданных см. в разделе [как: Использование Svcutil.exe для экспорта метаданных из скомпилированного кода службы](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md).</span><span class="sxs-lookup"><span data-stu-id="5bc09-111">For more information about using Svcutil.exe to export metadata, see [How to: Use Svcutil.exe to Export Metadata from Compiled Service Code](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md).</span></span>  
  
## <a name="publishing-metadata-using-a-secure-binding"></a><span data-ttu-id="5bc09-112">Публикация метаданных с помощью безопасной привязки</span><span class="sxs-lookup"><span data-stu-id="5bc09-112">Publishing Metadata Using a Secure Binding</span></span>  
 <span data-ttu-id="5bc09-113">Привязки метаданных по умолчанию, предоставляемые WCF не являются безопасными и они разрешить анонимный доступ к метаданным.</span><span class="sxs-lookup"><span data-stu-id="5bc09-113">The default metadata bindings that WCF provides are not secure and they allow anonymous access to the metadata.</span></span> <span data-ttu-id="5bc09-114">Метаданные службы, службы WCF публикует содержит подробное описание службы и могут случайно или намеренно содержать конфиденциальные сведения.</span><span class="sxs-lookup"><span data-stu-id="5bc09-114">The service metadata that a WCF service publishes contains a detailed description about the service and may intentionally or unintentionally contain sensitive information.</span></span> <span data-ttu-id="5bc09-115">Например, метаданные службы могут содержать сведения об операциях инфраструктуры, которые не должны распространяться публично.</span><span class="sxs-lookup"><span data-stu-id="5bc09-115">For example, service metadata may contain information about infrastructure operations that was not intended to be broadcast publicly.</span></span> <span data-ttu-id="5bc09-116">Чтобы защитить метаданные службы от несанкционированного доступа, можно воспользоваться безопасной привязкой конечной точки метаданных.</span><span class="sxs-lookup"><span data-stu-id="5bc09-116">To protect service metadata from unauthorized access, you can use a secure binding for your metadata endpoint.</span></span> <span data-ttu-id="5bc09-117">Конечные точки метаданных отвечают на HTTP-запросы GET, которые могут использовать для защиты метаданных протокол SSL.</span><span class="sxs-lookup"><span data-stu-id="5bc09-117">Metadata endpoints respond to HTTP/GET requests that can use Secure Sockets Layer (SSL) to secure the metadata.</span></span> <span data-ttu-id="5bc09-118">Дополнительные сведения см. в разделе [Как Защита конечных точек метаданных](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md).</span><span class="sxs-lookup"><span data-stu-id="5bc09-118">For more information, see [How to: Secure Metadata Endpoints](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md).</span></span>  
  
 <span data-ttu-id="5bc09-119">Кроме того, защита конечных точек метаданных позволяет запрашивающей стороне безопасным образом получать метаданные службы, не опасаясь, что они будут искажены или подделаны.</span><span class="sxs-lookup"><span data-stu-id="5bc09-119">Securing your metadata endpoints also provides a way for requesters to securely retrieve service metadata without the risk of tampering or spoofing.</span></span>  
  
## <a name="using-only-trusted-metadata"></a><span data-ttu-id="5bc09-120">Использование только надежных метаданных</span><span class="sxs-lookup"><span data-stu-id="5bc09-120">Using Only Trusted Metadata</span></span>  
 <span data-ttu-id="5bc09-121">С помощью метаданных службы можно автоматически создавать компоненты среды выполнения, необходимые для вызова службы.</span><span class="sxs-lookup"><span data-stu-id="5bc09-121">You can use service metadata to automatically construct the run-time components required to call the service.</span></span> <span data-ttu-id="5bc09-122">Кроме того, метаданные можно использовать на этапе проектирования, чтобы разрабатывать клиентские приложения, или во время выполнения, чтобы динамически обновлять привязку, с помощью которой клиент вызывает службу.</span><span class="sxs-lookup"><span data-stu-id="5bc09-122">You can also use metadata at design time to develop a client application or at runtime to dynamically update the binding a client uses to call a service.</span></span>  
  
 <span data-ttu-id="5bc09-123">При получении метаданных без соответствующей защиты они могут быть искажены или подделаны.</span><span class="sxs-lookup"><span data-stu-id="5bc09-123">Service metadata can be tampered with or spoofed when retrieved in an insecure manner.</span></span> <span data-ttu-id="5bc09-124">Искаженные метаданные могут перенаправить клиент на вредоносную службу, они могут содержать неверные параметры безопасности или опасные структуры XML.</span><span class="sxs-lookup"><span data-stu-id="5bc09-124">Tampered metadata can redirect your client to a malicious service, contain compromised security settings, or contain malicious XML structures.</span></span> <span data-ttu-id="5bc09-125">Документы с метаданным могут быть большими, и их часто сохраняют в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="5bc09-125">Metadata documents can be large and are frequently saved to the file system.</span></span> <span data-ttu-id="5bc09-126">Чтобы защититься от искажения или подделки метаданных, следует использовать для запроса метаданных службы безопасную привязку, если она доступна.</span><span class="sxs-lookup"><span data-stu-id="5bc09-126">To protect against tampering and spoofing, use a secure binding to request service metadata when one is available.</span></span>  
  
## <a name="using-safe-techniques-for-processing-metadata"></a><span data-ttu-id="5bc09-127">Использование безопасных методов обработки метаданных</span><span class="sxs-lookup"><span data-stu-id="5bc09-127">Using Safe Techniques for Processing Metadata</span></span>  
 <span data-ttu-id="5bc09-128">Метаданные службы часто запрашиваются у службы по сети с использованием стандартных протоколов, например WS-MetadataExchange (MEX).</span><span class="sxs-lookup"><span data-stu-id="5bc09-128">Service metadata is frequently retrieved from a service over a network using standardized protocols such as WS-MetadataExchange (MEX).</span></span> <span data-ttu-id="5bc09-129">Многие форматы метаданных включают механизмы, позволяющие ссылаться на дополнительные метаданные.</span><span class="sxs-lookup"><span data-stu-id="5bc09-129">Many metadata formats include referencing mechanisms for pointing to additional metadata.</span></span> <span data-ttu-id="5bc09-130">Тип <xref:System.ServiceModel.Description.MetadataExchangeClient> автоматически обрабатывает ссылки в документах WSDL, схемах XML и документах MEX.</span><span class="sxs-lookup"><span data-stu-id="5bc09-130">The <xref:System.ServiceModel.Description.MetadataExchangeClient> type automatically processes references for you in Web Services Description Language (WSDL) documents, XML Schema, and MEX documents.</span></span> <span data-ttu-id="5bc09-131">Размер объекта <xref:System.ServiceModel.Description.MetadataSet>, созданного на базе полученных метаданных, прямо пропорционален значению <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> используемого экземпляра <xref:System.ServiceModel.Description.MetadataExchangeClient> и значению `MaxReceivedMessageSize` привязки, используемой данным экземпляром <xref:System.ServiceModel.Description.MetadataExchangeClient>.</span><span class="sxs-lookup"><span data-stu-id="5bc09-131">The size of the <xref:System.ServiceModel.Description.MetadataSet> object created from the retrieved metadata is directly proportional to the <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> value for the <xref:System.ServiceModel.Description.MetadataExchangeClient> instance that is used and the `MaxReceivedMessageSize` value for the binding being used by that <xref:System.ServiceModel.Description.MetadataExchangeClient> instance.</span></span> <span data-ttu-id="5bc09-132">Устанавливайте эти квоты в соответствии с потребностями конкретной задачи.</span><span class="sxs-lookup"><span data-stu-id="5bc09-132">Set these quotas to appropriate values as dictated by your scenario.</span></span>  
  
 <span data-ttu-id="5bc09-133">В WCF метаданные службы обрабатываются в формате XML.</span><span class="sxs-lookup"><span data-stu-id="5bc09-133">In WCF, service metadata is processed as XML.</span></span> <span data-ttu-id="5bc09-134">При обработке документов XML приложения должны защищать себя от опасных структур XML.</span><span class="sxs-lookup"><span data-stu-id="5bc09-134">When processing XML documents, applications should protect themselves against malicious XML structures.</span></span> <span data-ttu-id="5bc09-135">Используйте <xref:System.Xml.XmlDictionaryReader> с соответствующими значениями квот, при обработке XML, а также задать <xref:System.Xml.XmlTextReader.DtdProcessing%2A> свойства <xref:System.Xml.DtdProcessing.Prohibit>.</span><span class="sxs-lookup"><span data-stu-id="5bc09-135">Use the <xref:System.Xml.XmlDictionaryReader> with appropriate quotas when processing XML and also set the <xref:System.Xml.XmlTextReader.DtdProcessing%2A> property to <xref:System.Xml.DtdProcessing.Prohibit>.</span></span>  
  
 <span data-ttu-id="5bc09-136">Система метаданных в WCF является расширяемой и расширения метаданных могут регистрироваться в файле конфигурации приложения (см. в разделе [расширении системы метаданных](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)).</span><span class="sxs-lookup"><span data-stu-id="5bc09-136">The metadata system in WCF is extensible and metadata extensions can be registered in your application configuration file (see [Extending the Metadata System](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)).</span></span> <span data-ttu-id="5bc09-137">Расширения метаданных могут выполнять произвольный код, поэтому файлы конфигурации приложений необходимо защищать с помощью соответствующих списков управления доступом и регистрировать только надежные реализации расширений метаданных.</span><span class="sxs-lookup"><span data-stu-id="5bc09-137">Metadata extensions can run arbitrary code, so you should protect your application configuration file with appropriate access control lists (ACLs) and register only trusted metadata extension implementations.</span></span>  
  
## <a name="validating-generated-clients"></a><span data-ttu-id="5bc09-138">Проверка созданных клиентов</span><span class="sxs-lookup"><span data-stu-id="5bc09-138">Validating Generated Clients</span></span>  
 <span data-ttu-id="5bc09-139">При создании клиентского кода из метаданных, полученных из ненадежного источника, проверьте созданный код клиента на соответствие принятым политикам безопасности клиентских приложений.</span><span class="sxs-lookup"><span data-stu-id="5bc09-139">When generating client code from metadata retrieved from a source that is not trusted, validate the generated client code to ensure that the generated client conforms to your client applications security policies.</span></span> <span data-ttu-id="5bc09-140">Можно воспользоваться поведением проверки, чтобы проконтролировать параметры клиентской привязки, или визуально проверить код, созданный автоматически.</span><span class="sxs-lookup"><span data-stu-id="5bc09-140">You can use a validating behavior to check settings on your client binding or visually inspect code generated by tools.</span></span> <span data-ttu-id="5bc09-141">Пример реализации клиента, проверяющего поведения, см. в разделе [клиентской проверки](../../../../docs/framework/wcf/samples/client-validation.md).</span><span class="sxs-lookup"><span data-stu-id="5bc09-141">For an example of how to implement a client that validates behaviors, see [Client Validation](../../../../docs/framework/wcf/samples/client-validation.md).</span></span>  
  
## <a name="protecting-application-configuration-files"></a><span data-ttu-id="5bc09-142">Защита файлов конфигурации приложений</span><span class="sxs-lookup"><span data-stu-id="5bc09-142">Protecting Application Configuration Files</span></span>  
 <span data-ttu-id="5bc09-143">Файл конфигурации приложения службы может определять, каким образом будут публиковаться метаданные и будут ли они публиковаться в принципе.</span><span class="sxs-lookup"><span data-stu-id="5bc09-143">A service's application configuration file may control how and if metadata is published.</span></span> <span data-ttu-id="5bc09-144">Рекомендуется защищать файлы конфигурации приложений с помощью списков управления доступом, чтобы злоумышленники не могли изменить параметры в этих файлах.</span><span class="sxs-lookup"><span data-stu-id="5bc09-144">It is a good idea to protect the application configuration file with appropriate access control lists (ACLs) to ensure an attacker cannot modify such settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5bc09-145">См. также</span><span class="sxs-lookup"><span data-stu-id="5bc09-145">See also</span></span>

- [<span data-ttu-id="5bc09-146">Практическое руководство. Защита конечных точек метаданных</span><span class="sxs-lookup"><span data-stu-id="5bc09-146">How to: Secure Metadata Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)
- [<span data-ttu-id="5bc09-147">Безопасность</span><span class="sxs-lookup"><span data-stu-id="5bc09-147">Security</span></span>](../../../../docs/framework/wcf/feature-details/security.md)
