---
title: Контракты данных, совместимые с любыми будущими изменениями
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data contracts [WCF], forward compatibility
ms.assetid: 413c9044-26f8-4ecb-968c-18495ea52cd9
ms.openlocfilehash: 90d9409d7e41ddda99caf24ebe0e249ee04723d6
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61855911"
---
# <a name="forward-compatible-data-contracts"></a><span data-ttu-id="ec996-102">Контракты данных, совместимые с любыми будущими изменениями</span><span class="sxs-lookup"><span data-stu-id="ec996-102">Forward-Compatible Data Contracts</span></span>
<span data-ttu-id="ec996-103">Это функция из Windows Communication Foundation (WCF) — системы контрактов данных, контракты со временем могут развиваться в без внесения критических изменений.</span><span class="sxs-lookup"><span data-stu-id="ec996-103">A feature of the Windows Communication Foundation (WCF) data contract system is that contracts can evolve over time in nonbreaking ways.</span></span> <span data-ttu-id="ec996-104">Это значит, что клиент, использующий старую версию контракта данных, может взаимодействовать со службой, использующей новую версию того же контракта данных, или клиент, использующий новую версию контракта данных, может взаимодействовать со службой, использующей старую версию того же контракта данных.</span><span class="sxs-lookup"><span data-stu-id="ec996-104">That is, a client with an older version of a data contract can communicate with a service with a newer version of the same data contract, or a client with a newer version of a data contract can communicate with an older version of the same data contract.</span></span> <span data-ttu-id="ec996-105">Дополнительные сведения см. в разделе [рекомендации: Управление версиями контракта данных](../../../../docs/framework/wcf/best-practices-data-contract-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="ec996-105">For more information, see [Best Practices: Data Contract Versioning](../../../../docs/framework/wcf/best-practices-data-contract-versioning.md).</span></span>  
  
 <span data-ttu-id="ec996-106">Большинство возможностей управления версиями можно применять по мере необходимости при создании новых версий существующего контакта данных.</span><span class="sxs-lookup"><span data-stu-id="ec996-106">You can apply most of the versioning features on an as-needed basis when new versions of an existing data contract are created.</span></span> <span data-ttu-id="ec996-107">Тем не менее одну возможность управления версиями, *полной совместимости версий*, должны быть построены в тип из первой версии для правильной работы.</span><span class="sxs-lookup"><span data-stu-id="ec996-107">However, one versioning feature, *round-tripping*, must be built into the type from the first version in order to work properly.</span></span>  
  
## <a name="round-tripping"></a><span data-ttu-id="ec996-108">Полная совместимость версий</span><span class="sxs-lookup"><span data-stu-id="ec996-108">Round-Tripping</span></span>  
 <span data-ttu-id="ec996-109">Полная совместимость версий обеспечивается, когда данные передаются от новой версии к старой и снова в новую версию контракта данных.</span><span class="sxs-lookup"><span data-stu-id="ec996-109">Round-tripping occurs when data passes from a new version to an old version and back to the new version of a data contract.</span></span> <span data-ttu-id="ec996-110">Полная совместимость версий гарантирует сохранение всех данных.</span><span class="sxs-lookup"><span data-stu-id="ec996-110">Round-tripping guarantees that no data is lost.</span></span> <span data-ttu-id="ec996-111">Включение полной совместимости версий обеспечивает прямую совместимость типа с любыми будущими изменениями, поддерживаемыми моделью управления версиями контрактов данных.</span><span class="sxs-lookup"><span data-stu-id="ec996-111">Enabling round-tripping makes the type forward-compatible with any future changes supported by the data contract versioning model.</span></span>  
  
 <span data-ttu-id="ec996-112">Полная совместимость версий для определенного типа возможна только в том случае, если этот тип реализует интерфейс <xref:System.Runtime.Serialization.IExtensibleDataObject>.</span><span class="sxs-lookup"><span data-stu-id="ec996-112">To enable round-tripping for a particular type, the type must implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span> <span data-ttu-id="ec996-113">Интерфейс имеет одно свойство: <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> (возвращение типа <xref:System.Runtime.Serialization.ExtensionDataObject>).</span><span class="sxs-lookup"><span data-stu-id="ec996-113">The interface contains one property, <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> (returning the <xref:System.Runtime.Serialization.ExtensionDataObject> type).</span></span> <span data-ttu-id="ec996-114">Это свойство сохраняет любые данные из будущих версий контракта данных, неизвестные в текущей версии.</span><span class="sxs-lookup"><span data-stu-id="ec996-114">The property stores any data from future versions of the data contract that is unknown to the current version.</span></span>  
  
### <a name="example"></a><span data-ttu-id="ec996-115">Пример</span><span class="sxs-lookup"><span data-stu-id="ec996-115">Example</span></span>  
 <span data-ttu-id="ec996-116">Ниже представлен контракт данных, который не обладает прямой совместимостью с будущими изменениями.</span><span class="sxs-lookup"><span data-stu-id="ec996-116">The following data contract is not forward-compatible with future changes.</span></span>  
  
 [!code-csharp[C_DataContract#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontract/cs/source.cs#7)]
 [!code-vb[C_DataContract#7](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontract/vb/source.vb#7)]  
  
 <span data-ttu-id="ec996-117">Чтобы тип был совместим с будущими изменениями (такими как добавление нового члена данных с именем "phoneNumber"), необходимо реализовать интерфейс <xref:System.Runtime.Serialization.IExtensibleDataObject>.</span><span class="sxs-lookup"><span data-stu-id="ec996-117">To make the type compatible with future changes (such as adding a new data member named "phoneNumber"), implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span>  
  
 [!code-csharp[C_DataContract#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontract/cs/source.cs#8)]
 [!code-vb[C_DataContract#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontract/vb/source.vb#8)]  
  
 <span data-ttu-id="ec996-118">Когда инфраструктура WCF встречает данные, не является частью исходного контракта данных, данные хранятся в свойстве и сохранен.</span><span class="sxs-lookup"><span data-stu-id="ec996-118">When the WCF infrastructure encounters data that is not part of the original data contract, the data is stored in the property and preserved.</span></span> <span data-ttu-id="ec996-119">Обработка данных выполняется только во временном хранилище.</span><span class="sxs-lookup"><span data-stu-id="ec996-119">It is not processed in any other way except for temporary storage.</span></span> <span data-ttu-id="ec996-120">Если объект возвращается в место создания, также возвращаются исходные (неизвестные) данные.</span><span class="sxs-lookup"><span data-stu-id="ec996-120">If the object is returned back to where it originated, the original (unknown) data is also returned.</span></span> <span data-ttu-id="ec996-121">Следовательно, данные совершают круговой путь к исходной конечной точке и из нее без потерь.</span><span class="sxs-lookup"><span data-stu-id="ec996-121">Therefore, the data has made a round trip to and from the originating endpoint without loss.</span></span> <span data-ttu-id="ec996-122">Однако следует помнить, что если в исходной конечной точке необходимо выполнить обработку данных, этого не произойдет, и конечная точка должна будет каким-либо образом обнаружить и применить изменение.</span><span class="sxs-lookup"><span data-stu-id="ec996-122">Note, however, that if the originating endpoint required the data to be processed, that expectation is unmet, and the endpoint must somehow detect and accommodate the change.</span></span>  
  
 <span data-ttu-id="ec996-123">Тип <xref:System.Runtime.Serialization.ExtensionDataObject> не содержит открытых методов или свойств.</span><span class="sxs-lookup"><span data-stu-id="ec996-123">The <xref:System.Runtime.Serialization.ExtensionDataObject> type contains no public methods or properties.</span></span> <span data-ttu-id="ec996-124">Таким образом, невозможно получить прямой доступ к данным, хранящимся внутри свойства <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A>.</span><span class="sxs-lookup"><span data-stu-id="ec996-124">Thus, it is impossible to get direct access to the data stored inside the <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> property.</span></span>  
  
 <span data-ttu-id="ec996-125">Функцию полной совместимости версий можно отключить, присвоив свойству `ignoreExtensionDataObject` значение `true` в конструкторе <xref:System.Runtime.Serialization.DataContractSerializer> или присвоив свойству <xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A> значение `true` для атрибута <xref:System.ServiceModel.ServiceBehaviorAttribute>.</span><span class="sxs-lookup"><span data-stu-id="ec996-125">The round-tripping feature may be turned off, either by setting `ignoreExtensionDataObject` to `true` in the <xref:System.Runtime.Serialization.DataContractSerializer> constructor or by setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A> property to `true` on the <xref:System.ServiceModel.ServiceBehaviorAttribute>.</span></span> <span data-ttu-id="ec996-126">Если эта возможность выключена, десериализатор не будет заполнять свойство <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A>, а сериализатор не будет выпускать содержимое свойства.</span><span class="sxs-lookup"><span data-stu-id="ec996-126">When this feature is off, the deserializer will not populate the <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> property, and the serializer will not emit the contents of the property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ec996-127">См. также</span><span class="sxs-lookup"><span data-stu-id="ec996-127">See also</span></span>

- <xref:System.Runtime.Serialization.IExtensibleDataObject>
- <xref:System.Runtime.Serialization.ExtensionDataObject>
- [<span data-ttu-id="ec996-128">Управление версиями контракта данных</span><span class="sxs-lookup"><span data-stu-id="ec996-128">Data Contract Versioning</span></span>](../../../../docs/framework/wcf/feature-details/data-contract-versioning.md)
- [<span data-ttu-id="ec996-129">Советы и рекомендации: Управление версиями контракта данных</span><span class="sxs-lookup"><span data-stu-id="ec996-129">Best Practices: Data Contract Versioning</span></span>](../../../../docs/framework/wcf/best-practices-data-contract-versioning.md)
