---
title: Импорт и экспорт схемы
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF, schema import and export
- XsdDataContractExporter class
- XsdDataContractImporter class
ms.assetid: 0da32b50-ccd9-463a-844c-7fe803d3bf44
ms.openlocfilehash: 52a9e1bf4c9442bd42beb55b133a185c4a42148d
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "96288571"
---
# <a name="schema-import-and-export"></a><span data-ttu-id="6bfc5-102">Импорт и экспорт схемы</span><span class="sxs-lookup"><span data-stu-id="6bfc5-102">Schema Import and Export</span></span>

<span data-ttu-id="6bfc5-103">Windows Communication Foundation (WCF) включает новый механизм сериализации <xref:System.Runtime.Serialization.DataContractSerializer> .</span><span class="sxs-lookup"><span data-stu-id="6bfc5-103">Windows Communication Foundation (WCF) includes a new serialization engine, the <xref:System.Runtime.Serialization.DataContractSerializer>.</span></span> <span data-ttu-id="6bfc5-104">`DataContractSerializer`Преобразование между объектами .NET Framework и XML (в обоих направлениях).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-104">The `DataContractSerializer` translates between .NET Framework objects and XML (in both directions).</span></span> <span data-ttu-id="6bfc5-105">В дополнение к самому сериализатору, WCF включает связанные механизмы импорта схемы и экспорта схемы.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-105">In addition to the serializer itself, WCF includes associated schema import and schema export mechanisms.</span></span> <span data-ttu-id="6bfc5-106">*Схема* — это формальное, точное и понятное для компьютера описание формы XML, которую создает сериализатор или который десериализатор может получить.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-106">*Schema* is a formal, precise, and machine-readable description of the shape of XML that the serializer produces or that the deserializer can access.</span></span> <span data-ttu-id="6bfc5-107">WCF использует язык определения схемы XML (XSD) консорциум W3C (W3C) в качестве представления схемы, который широко взаимодействует с несколькими сторонними платформами.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-107">WCF uses the World Wide Web Consortium (W3C) XML Schema definition language (XSD) as its schema representation, which is widely interoperable with numerous third-party platforms.</span></span>  
  
 <span data-ttu-id="6bfc5-108">Компонент импорта схемы, <xref:System.Runtime.Serialization.XsdDataContractImporter> , принимает документ XSD-схемы и создает .NET Framework классы (обычно классы контрактов данных) таким образом, чтобы сериализованные формы соответствовали заданной схеме.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-108">The schema import component, <xref:System.Runtime.Serialization.XsdDataContractImporter>, takes an XSD schema document and generates .NET Framework classes (normally data contract classes) such that the serialized forms correspond to the given schema.</span></span>  
  
 <span data-ttu-id="6bfc5-109">Например, следующий фрагмент схемы:</span><span class="sxs-lookup"><span data-stu-id="6bfc5-109">For example, the following schema fragment:</span></span>  
  
 [!code-csharp[c_SchemaImportExport#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#8)]
 [!code-vb[c_SchemaImportExport#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#8)]  
  
 <span data-ttu-id="6bfc5-110">создает следующий тип (он немного упрощен для удобства восприятия).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-110">generates the following type (simplified slightly for better readability).</span></span>  
  
 [!code-csharp[c_SchemaImportExport#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#1)]
 [!code-vb[c_SchemaImportExport#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#1)]  
  
 <span data-ttu-id="6bfc5-111">Обратите внимание, что созданный тип соответствует нескольким рекомендациям по контракту данных (см. рекомендации по [управлению версиями контракта данных](../best-practices-data-contract-versioning.md)):</span><span class="sxs-lookup"><span data-stu-id="6bfc5-111">Note that the generated type follows several data contract best practices (found in [Best Practices: Data Contract Versioning](../best-practices-data-contract-versioning.md)):</span></span>  
  
- <span data-ttu-id="6bfc5-112">Тип реализует интерфейс <xref:System.Runtime.Serialization.IExtensibleDataObject>.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-112">The type implements the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span> <span data-ttu-id="6bfc5-113">Дополнительные сведения о создании контрактов данных, обладающих прямой совместимостью, см. в разделе [Контракты данных, совместимые с любыми будущими изменениями](forward-compatible-data-contracts.md).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-113">For more information, see [Forward-Compatible Data Contracts](forward-compatible-data-contracts.md).</span></span>  
  
- <span data-ttu-id="6bfc5-114">Данные-члены реализованы в виде открытых свойств, скрывающих закрытые поля.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-114">Data members are implemented as public properties that wrap private fields.</span></span>  
  
- <span data-ttu-id="6bfc5-115">Класс является разделяемым, и его можно дополнять без изменения уже созданного кода.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-115">The class is a partial class, and additions can be made without modifying generated code.</span></span>  
  
 <span data-ttu-id="6bfc5-116">Класс <xref:System.Runtime.Serialization.XsdDataContractExporter> позволяет выполнять обратную операцию - принимать типы, сериализуемые с помощью `DataContractSerializer`, и создавать документ схемы XSD.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-116">The <xref:System.Runtime.Serialization.XsdDataContractExporter> enables you to do the reverse—take types that are serializable with the `DataContractSerializer` and generate an XSD Schema document.</span></span>  
  
## <a name="fidelity-is-not-guaranteed"></a><span data-ttu-id="6bfc5-117">Совпадение не гарантируется</span><span class="sxs-lookup"><span data-stu-id="6bfc5-117">Fidelity Is Not Guaranteed</span></span>  

 <span data-ttu-id="6bfc5-118">Нет гарантии, что при выполнении полного цикла преобразования схемы или типа будет обеспечено полное совпадение.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-118">It is not guaranteed that schema or types make a round trip with total fidelity.</span></span> <span data-ttu-id="6bfc5-119">( *Цикл обработки* означает импорт схемы для создания набора классов и экспорт результата для повторного создания схемы.) Одна и та же схема не может быть возвращена.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-119">(A *round trip* means to import a schema to create a set of classes, and export the result to create a schema again.) The same schema may not be returned.</span></span> <span data-ttu-id="6bfc5-120">Обратный процесс также не гарантирует полного совпадения результатов.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-120">Reversing the process is also not guaranteed to preserve fidelity.</span></span> <span data-ttu-id="6bfc5-121">(Выполните экспорт типа для создания схемы и последующий импорт результата.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-121">(Export a type to generate its schema, and then import the type back.</span></span> <span data-ttu-id="6bfc5-122">Маловероятно, что будет получен такой же тип.)</span><span class="sxs-lookup"><span data-stu-id="6bfc5-122">It is unlikely the same type is returned.)</span></span>  
  
## <a name="supported-types"></a><span data-ttu-id="6bfc5-123">Поддерживаемые типы</span><span class="sxs-lookup"><span data-stu-id="6bfc5-123">Supported Types</span></span>  

 <span data-ttu-id="6bfc5-124">Модель контракта данных поддерживает только ограниченный набор элементов схемы, определенных консорциумом WC3.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-124">The data contract model supports only a limited subset of the WC3 schema.</span></span> <span data-ttu-id="6bfc5-125">Если схема не соответствует этому ограниченному набору, во время импорта будет создано исключение.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-125">Any schema that does not conform to this subset will cause an exception during the import process.</span></span> <span data-ttu-id="6bfc5-126">Например, не существует способа преобразовать член с данными контракта данных в атрибут XML.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-126">For example, there is no way to specify that a data member of a data contract should be serialized as an XML attribute.</span></span> <span data-ttu-id="6bfc5-127">Таким образом, схемы, требующие использования атрибутов XML, не поддерживаются и вызывают появление исключений во время импорта, поскольку в этом случае невозможно создать контракт данных с правильным XML-представлением.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-127">Thus, schemas that require the use of XML attributes are not supported and will cause exceptions during import, because it is impossible to generate a data contract with the correct XML projection.</span></span>  
  
 <span data-ttu-id="6bfc5-128">Например, следующий фрагмент схемы невозможно импортировать с использованием параметров импорта по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-128">For example, the following schema fragment cannot be imported using the default import settings.</span></span>  
  
 [!code-xml[c_SchemaImportExport#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/common/source.config#9)]  
  
 <span data-ttu-id="6bfc5-129">Дополнительные сведения см. в разделе [Справочник по схеме контракта данных](data-contract-schema-reference.md).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-129">For more information, see [Data Contract Schema Reference](data-contract-schema-reference.md).</span></span> <span data-ttu-id="6bfc5-130">Если схема не соответствует правилам контракта данных, следует использовать другой механизм сериализации.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-130">If a schema does not conform to the data contract rules, use a different serialization engine.</span></span> <span data-ttu-id="6bfc5-131">Например, класс <xref:System.Xml.Serialization.XmlSerializer> использует собственный механизм импорта схемы.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-131">For example, the <xref:System.Xml.Serialization.XmlSerializer> uses its own separate schema import mechanism.</span></span> <span data-ttu-id="6bfc5-132">Кроме того, имеется специальный режим импорта, где список поддерживаемых элементов схемы расширяется.</span><span class="sxs-lookup"><span data-stu-id="6bfc5-132">Also, there is a special import mode in which the range of supported schema is expanded.</span></span> <span data-ttu-id="6bfc5-133">Дополнительные сведения см. в разделе Создание <xref:System.Xml.Serialization.IXmlSerializable> типов в [импорте схемы для создания классов](importing-schema-to-generate-classes.md).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-133">For more information, see the section about generating <xref:System.Xml.Serialization.IXmlSerializable> types in [Importing Schema to Generate Classes](importing-schema-to-generate-classes.md).</span></span>  
  
 <span data-ttu-id="6bfc5-134">`XsdDataContractExporter`Поддерживает любые типы .NET Framework, которые могут быть сериализованы с помощью `DataContractSerializer` .</span><span class="sxs-lookup"><span data-stu-id="6bfc5-134">The `XsdDataContractExporter` supports any .NET Framework types that can be serialized with the `DataContractSerializer`.</span></span> <span data-ttu-id="6bfc5-135">Дополнительные сведения см. [в разделе Типы, поддерживаемые сериализатором контрактов данных](types-supported-by-the-data-contract-serializer.md).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-135">For more information, see [Types Supported by the Data Contract Serializer](types-supported-by-the-data-contract-serializer.md).</span></span> <span data-ttu-id="6bfc5-136">Обратите внимание, что схема, созданная с помощью класса `XsdDataContractExporter`, обычно содержит допустимые данные, которые могут использоваться классом `XsdDataContractImporter` (если только для изменения схемы не используется класс <xref:System.Xml.Serialization.XmlSchemaProviderAttribute>).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-136">Note that schema generated using the `XsdDataContractExporter` is normally valid data that the `XsdDataContractImporter` can use (unless the <xref:System.Xml.Serialization.XmlSchemaProviderAttribute> is used to customize the schema).</span></span>  
  
 <span data-ttu-id="6bfc5-137">Дополнительные сведения об использовании <xref:System.Runtime.Serialization.XsdDataContractImporter> см. в разделе [Импорт схемы для создания классов](importing-schema-to-generate-classes.md).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-137">For more information about using the <xref:System.Runtime.Serialization.XsdDataContractImporter>, see [Importing Schema to Generate Classes](importing-schema-to-generate-classes.md).</span></span>  
  
 <span data-ttu-id="6bfc5-138">Дополнительные сведения об использовании см <xref:System.Runtime.Serialization.XsdDataContractExporter> . в разделе [Экспорт схем из классов](exporting-schemas-from-classes.md).</span><span class="sxs-lookup"><span data-stu-id="6bfc5-138">For more information about using the <xref:System.Runtime.Serialization.XsdDataContractExporter>, see [Exporting Schemas from Classes](exporting-schemas-from-classes.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6bfc5-139">См. также</span><span class="sxs-lookup"><span data-stu-id="6bfc5-139">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.Runtime.Serialization.XsdDataContractImporter>
- <xref:System.Runtime.Serialization.XsdDataContractExporter>
- [<span data-ttu-id="6bfc5-140">Импорт схемы для создания классов</span><span class="sxs-lookup"><span data-stu-id="6bfc5-140">Importing Schema to Generate Classes</span></span>](importing-schema-to-generate-classes.md)
- [<span data-ttu-id="6bfc5-141">Экспорт схем из классов</span><span class="sxs-lookup"><span data-stu-id="6bfc5-141">Exporting Schemas from Classes</span></span>](exporting-schemas-from-classes.md)
