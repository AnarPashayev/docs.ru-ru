---
title: Выбор типа учетных данных
ms.date: 03/30/2017
ms.assetid: bf707063-3f30-4304-ab53-0e63413728a8
ms.openlocfilehash: 20c070e9351219a649735ac404231cf6f265d814
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64586133"
---
# <a name="selecting-a-credential-type"></a><span data-ttu-id="9aa5a-102">Выбор типа учетных данных</span><span class="sxs-lookup"><span data-stu-id="9aa5a-102">Selecting a Credential Type</span></span>
<span data-ttu-id="9aa5a-103">*Учетные данные* — это данные, Windows Communication Foundation (WCF) использует для подтверждения заявленной идентификации или возможностей.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-103">*Credentials* are the data Windows Communication Foundation (WCF) uses to establish either a claimed identity or capabilities.</span></span> <span data-ttu-id="9aa5a-104">Например, паспорт - это документ, выданный властями, в котором содержатся учетные данные, подтверждающие гражданство страны или региона.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-104">For example, a passport is a credential a government issues to prove citizenship in a country or region.</span></span> <span data-ttu-id="9aa5a-105">В WCF учетные данные могут принимать различные формы, например маркеры имен пользователей и сертификаты X.509.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-105">In WCF, credentials can take many forms, such as user name tokens and X.509 certificates.</span></span> <span data-ttu-id="9aa5a-106">В этом разделе рассматриваются учетные данные, как они используются в WCF и способ выбора правильных учетных данных для вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-106">This topic discusses credentials, how they are used in WCF, and how to select the right credential for your application.</span></span>  
  
 <span data-ttu-id="9aa5a-107">Во многих странах и регионах примером учетных данных могут служить водительские права.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-107">In many countries and regions, a driver’s license is an example of a credential.</span></span> <span data-ttu-id="9aa5a-108">Водительские права содержат данные о личности и возможностях их обладателя.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-108">A license contains data that represents a person's identity and capabilities.</span></span> <span data-ttu-id="9aa5a-109">Они содержат доказательство владения в виде фотографии владельца.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-109">It contains proof of possession in the form of the possessor's picture.</span></span> <span data-ttu-id="9aa5a-110">Водительские права выданы доверенной организацией (центром авторизации), обычно государственным органом.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-110">The license is issued by a trusted authority, usually a governmental department of licensing.</span></span> <span data-ttu-id="9aa5a-111">Водительские права ламинированы и могут содержать голограмму, подтверждающую, что права не изменены или подделаны.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-111">The license is sealed, and can contain a hologram, showing that it has not been tampered with or counterfeited.</span></span>  
  
 <span data-ttu-id="9aa5a-112">При предоставлении учетных данных требуется предоставить как сами данные, так и доказательство обладания ими.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-112">Presenting a credential involves presenting both the data and proof of possession of the data.</span></span> <span data-ttu-id="9aa5a-113">WCF поддерживает различные типы учетных данных на уровнях безопасности транспорта и сообщений.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-113">WCF supports a variety of credential types at both the transport and message security levels.</span></span> <span data-ttu-id="9aa5a-114">Например, рассмотрим два типа учетных данных, поддерживаемые в WCF: имя пользователя и сертификат (X.509) учетные данные.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-114">For example, consider two types of credentials supported in WCF: user name and (X.509) certificate credentials.</span></span>  
  
 <span data-ttu-id="9aa5a-115">При использовании в качестве учетных данных имени пользователя само имя пользователя представляет заявленную идентификацию, а пароль является доказательством прав обладания.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-115">For the user name credential, the user name represents the claimed identity and the password provides proof of possession.</span></span> <span data-ttu-id="9aa5a-116">Центром авторизации в данном случае является система, проверяющая имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-116">The trusted authority in this case is the system that validates the user name and password.</span></span>  
  
 <span data-ttu-id="9aa5a-117">С помощью учетных данных сертификата X.509 имя субъекта, альтернативное имя субъекта или определенные поля сертификата можно использовать как утверждения, удостоверения, а другие поля, такие как `Valid From` и `Valid To` поля, указывают, действителен ли сертификат.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-117">With an X.509 certificate credential, the subject name, subject alternative name or specific fields within the certificate can be used as claims of identity, while other fields, such as the `Valid From` and `Valid To` fields, specify the validity of the certificate.</span></span>  
  
## <a name="transport-credential-types"></a><span data-ttu-id="9aa5a-118">Типы учетных данных транспорта</span><span class="sxs-lookup"><span data-stu-id="9aa5a-118">Transport Credential Types</span></span>  
 <span data-ttu-id="9aa5a-119">В приведенной ниже таблице перечислены типы учетных данных клиента, которые можно использовать в режиме безопасности транспорта.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-119">The following table shows the possible types of client credentials that can be used by a binding in transport security mode.</span></span> <span data-ttu-id="9aa5a-120">При создании службы свойству `ClientCredentialType` задается одно из этих значений, указывающих тип учетных данных, которые должен предоставить клиент для связи с этой службой.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-120">When creating a service, set the `ClientCredentialType` property to one of these values to specify the type of credential that the client must supply to communicate with your service.</span></span> <span data-ttu-id="9aa5a-121">Типы можно задавать как в коде, так и в файлах конфигурации.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-121">You can set the types in either code or configuration files.</span></span>  
  
|<span data-ttu-id="9aa5a-122">Параметр</span><span class="sxs-lookup"><span data-stu-id="9aa5a-122">Setting</span></span>|<span data-ttu-id="9aa5a-123">Описание</span><span class="sxs-lookup"><span data-stu-id="9aa5a-123">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="9aa5a-124">Нет</span><span class="sxs-lookup"><span data-stu-id="9aa5a-124">None</span></span>|<span data-ttu-id="9aa5a-125">Указывает, что клиенту не требуется предоставлять учетные данные.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-125">Specifies that the client does not need to present any credential.</span></span> <span data-ttu-id="9aa5a-126">Это означает, что клиент является анонимным.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-126">This translates to an anonymous client.</span></span>|  
|<span data-ttu-id="9aa5a-127">Basic</span><span class="sxs-lookup"><span data-stu-id="9aa5a-127">Basic</span></span>|<span data-ttu-id="9aa5a-128">Задает для клиента обычную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-128">Specifies basic authentication for the client.</span></span> <span data-ttu-id="9aa5a-129">Дополнительные сведения см. в документе RFC2617 —[проверки подлинности HTTP: обычная и дайджест-проверка подлинности](https://go.microsoft.com/fwlink/?LinkID=88313).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-129">For additional information, see RFC2617—[HTTP Authentication: Basic and Digest Authentication](https://go.microsoft.com/fwlink/?LinkID=88313).</span></span>|  
|<span data-ttu-id="9aa5a-130">Digest</span><span class="sxs-lookup"><span data-stu-id="9aa5a-130">Digest</span></span>|<span data-ttu-id="9aa5a-131">Задает для клиента дайджест-проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-131">Specifies digest authentication for the client.</span></span> <span data-ttu-id="9aa5a-132">Дополнительные сведения см. в документе RFC2617 —[проверки подлинности HTTP: обычная и дайджест-проверка подлинности](https://go.microsoft.com/fwlink/?LinkID=88313).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-132">For additional information, see RFC2617—[HTTP Authentication: Basic and Digest Authentication](https://go.microsoft.com/fwlink/?LinkID=88313).</span></span>|  
|<span data-ttu-id="9aa5a-133">Ntlm</span><span class="sxs-lookup"><span data-stu-id="9aa5a-133">Ntlm</span></span>|<span data-ttu-id="9aa5a-134">Задает проверку подлинности NTLM (NT LAN Manager).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-134">Specifies NT LAN Manager (NTLM) authentication.</span></span> <span data-ttu-id="9aa5a-135">Этот параметр используется, если по какой-то причине нельзя использовать проверку подлинности Kerberos.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-135">This is used when you cannot use Kerberos authentication for some reason.</span></span> <span data-ttu-id="9aa5a-136">Можно также отключить его использование в качестве запасного варианта, задав <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> свойства `false`, чего WCF сделать усилия для создания исключения, если используется NTLM.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-136">You can also disable its use as a fallback by setting the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false`, which causes WCF to make a best-effort to throw an exception if NTLM is used.</span></span> <span data-ttu-id="9aa5a-137">Обратите внимание, что установка для данного свойства значения `false` не предотвращает отправки учетных данных NTLM по сети.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-137">Note that setting this property to `false` may not prevent NTLM credentials from being sent over the wire.</span></span>|  
|<span data-ttu-id="9aa5a-138">Windows</span><span class="sxs-lookup"><span data-stu-id="9aa5a-138">Windows</span></span>|<span data-ttu-id="9aa5a-139">Задает проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-139">Specifies Windows authentication.</span></span> <span data-ttu-id="9aa5a-140">Чтобы установить в домене Windows режим использования только протокола Kerberos, задайте свойству <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> значение `false` (по умолчанию `true`).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-140">To specify only the Kerberos protocol on a Windows domain, set the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false` (the default is `true`).</span></span>|  
|<span data-ttu-id="9aa5a-141">Сертификат</span><span class="sxs-lookup"><span data-stu-id="9aa5a-141">Certificate</span></span>|<span data-ttu-id="9aa5a-142">Выполняет проверку подлинности клиента с использованием сертификата X.509.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-142">Performs client authentication using an X.509 certificate.</span></span>|  
|<span data-ttu-id="9aa5a-143">Пароль</span><span class="sxs-lookup"><span data-stu-id="9aa5a-143">Password</span></span>|<span data-ttu-id="9aa5a-144">Пользователь должен ввести имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-144">User must supply a user name and password.</span></span> <span data-ttu-id="9aa5a-145">Контроль пары «имя пользователя и пароль» с помощью проверки подлинности Windows или другого пользовательского решения.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-145">Validate the user name/password pair using Windows authentication or another custom solution.</span></span>|  
  
### <a name="message-client-credential-types"></a><span data-ttu-id="9aa5a-146">Типы учетных данных клиента при использовании безопасности сообщений</span><span class="sxs-lookup"><span data-stu-id="9aa5a-146">Message Client Credential Types</span></span>  
 <span data-ttu-id="9aa5a-147">В следующей таблице приведены типы учетных данных, которые могут использоваться при создании приложения, использующего безопасность сообщений.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-147">The following table shows the possible credential types that you can use when creating an application that uses message security.</span></span> <span data-ttu-id="9aa5a-148">Эти значения можно использовать как в коде, так и в файлах конфигурации.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-148">You can use these values in either code or configuration files.</span></span>  
  
|<span data-ttu-id="9aa5a-149">Параметр</span><span class="sxs-lookup"><span data-stu-id="9aa5a-149">Setting</span></span>|<span data-ttu-id="9aa5a-150">Описание</span><span class="sxs-lookup"><span data-stu-id="9aa5a-150">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="9aa5a-151">Нет</span><span class="sxs-lookup"><span data-stu-id="9aa5a-151">None</span></span>|<span data-ttu-id="9aa5a-152">Указывает, что клиенту не требуется предоставлять учетные данные.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-152">Specifies that the client does not need to present a credential.</span></span> <span data-ttu-id="9aa5a-153">Это означает, что клиент является анонимным.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-153">This translates to an anonymous client.</span></span>|  
|<span data-ttu-id="9aa5a-154">Windows</span><span class="sxs-lookup"><span data-stu-id="9aa5a-154">Windows</span></span>|<span data-ttu-id="9aa5a-155">Позволяет проводить обмен сообщениями SOAP в рамках контекста безопасности, созданного с использованием учетных данных Windows.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-155">Allows SOAP message exchanges to occur under the security context established with a Windows credential.</span></span>|  
|<span data-ttu-id="9aa5a-156">Имя пользователя</span><span class="sxs-lookup"><span data-stu-id="9aa5a-156">Username</span></span>|<span data-ttu-id="9aa5a-157">Позволяет службе запрашивать проверку подлинности клиента на основе учетных данных типа «имя пользователя».</span><span class="sxs-lookup"><span data-stu-id="9aa5a-157">Allows the service to require that the client be authenticated with a user name credential.</span></span> <span data-ttu-id="9aa5a-158">Обратите внимание на то, что WCF не позволяет выполнять криптографические операции с именами пользователей, таких как создание сигнатуры или шифрование данных.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-158">Note that WCF does not allow any cryptographic operations with user names, such as generating a signature or encrypting data.</span></span> <span data-ttu-id="9aa5a-159">WCF обеспечивает безопасность транспорта при использовании учетных данных имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-159">WCF ensures that the transport is secured when using user name credentials.</span></span>|  
|<span data-ttu-id="9aa5a-160">Сертификат</span><span class="sxs-lookup"><span data-stu-id="9aa5a-160">Certificate</span></span>|<span data-ttu-id="9aa5a-161">Позволяет службе запрашивать проверку подлинности клиента с помощью сертификата X.509.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-161">Allows the service to require that the client be authenticated using an X.509 certificate.</span></span>|  
|<span data-ttu-id="9aa5a-162">Issued Token</span><span class="sxs-lookup"><span data-stu-id="9aa5a-162">Issued Token</span></span>|<span data-ttu-id="9aa5a-163">Пользовательский тип маркера, настроенный в соответствии с политикой безопасности.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-163">A custom token type configured according to a security policy.</span></span> <span data-ttu-id="9aa5a-164">Тип маркера по умолчанию - маркер языка SAML (Security Assertions Markup Language).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-164">The default token type is Security Assertions Markup Language (SAML).</span></span> <span data-ttu-id="9aa5a-165">Маркер выдается службой маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-165">The token is issued by a secure token service.</span></span> <span data-ttu-id="9aa5a-166">Дополнительные сведения см. в разделе [Федерация и выданные маркеры](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-166">For more information, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span></span>|  
  
### <a name="negotiation-model-of-service-credentials"></a><span data-ttu-id="9aa5a-167">Модель согласования учетных данных служб</span><span class="sxs-lookup"><span data-stu-id="9aa5a-167">Negotiation Model of Service Credentials</span></span>  
 <span data-ttu-id="9aa5a-168">*Согласование* — это процесс установки отношений доверия между клиентом и службой путем обмена учетные данные.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-168">*Negotiation* is the process of establishing trust between a client and a service by exchanging credentials.</span></span> <span data-ttu-id="9aa5a-169">Этот процесс выполняется между клиентом и службой последовательно, чтобы раскрывать только те сведения, которые нужны для следующего этапа процесса согласования.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-169">The process is performed iteratively between the client and the service, so as to disclose only the information necessary for the next step in the negotiation process.</span></span> <span data-ttu-id="9aa5a-170">Обычно в результате согласования клиент получает учетные данные службы, которые используются при последующих операциях.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-170">In practice, the end result is the delivery of a service's credential to the client to be used in subsequent operations.</span></span>  
  
 <span data-ttu-id="9aa5a-171">За одним исключением по умолчанию предоставляемых системой привязок в WCF согласования учетных данных службы автоматически при использовании безопасности уровня сообщений.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-171">With one exception, by default the system-provided bindings in WCF negotiate the service credential automatically when using message-level security.</span></span> <span data-ttu-id="9aa5a-172">(Исключением является класс <xref:System.ServiceModel.BasicHttpBinding>, не включающий безопасность по умолчанию.) Для отключения такого поведения см. свойства <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> и <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-172">(The exception is the <xref:System.ServiceModel.BasicHttpBinding>, which does not enable security by default.) To disable this behavior, see the <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> and <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9aa5a-173">При использовании безопасности SSL с .NET Framework 3.5 и более поздних версиях клиента WCF использует как промежуточные сертификаты в своем хранилище сертификатов, так и промежуточные сертификаты, полученные в процессе согласования SSL для проверки цепочки сертификатов для службы сертификат.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-173">When SSL security is used with .NET Framework 3.5 and later, a WCF client uses both the intermediate certificates in its certificate store and the intermediate certificates received during SSL negotiation to perform certificate chain validation on the service's certificate.</span></span> <span data-ttu-id="9aa5a-174">Платформа .NET Framework 3.0 использует только промежуточные сертификаты, установленные в локальном хранилище сертификатов.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-174">.NET Framework 3.0 only uses the intermediate certificates installed in the local certificate store.</span></span>  
  
#### <a name="out-of-band-negotiation"></a><span data-ttu-id="9aa5a-175">Внешнее согласование</span><span class="sxs-lookup"><span data-stu-id="9aa5a-175">Out-of-Band Negotiation</span></span>  
 <span data-ttu-id="9aa5a-176">Если автоматическое согласование отключено, перед отправкой любых сообщений службе клиент должен предоставить учетные данные службы.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-176">If automatic negotiation is disabled, the service credential must be provisioned at the client prior to sending any messages to the service.</span></span> <span data-ttu-id="9aa5a-177">Это также называется *-резервному* подготовки.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-177">This is also known as an *out-of-band* provisioning.</span></span> <span data-ttu-id="9aa5a-178">Например, если в качестве типа учетных данных указан сертификат, а автоматическое согласование отключено, клиент должен связаться с владельцем службы, чтобы получить и установить сертификат на том компьютере, на котором выполняется клиентское приложение.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-178">For example, if the specified credential type is a certificate, and automatic negotiation is disabled, the client must contact the service owner to receive and install the certificate on the computer running the client application.</span></span> <span data-ttu-id="9aa5a-179">Это можно сделать, например, если нужно строго контролировать доступ клиентов к службе, обеспечивающей взаимодействие предприятий.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-179">This can be done, for example, when you want to strictly control which clients can access a service in a business-to-business scenario.</span></span> <span data-ttu-id="9aa5a-180">Этот выход из — внешнее согласование можно сделать в сообщении электронной почты, а сертификат X.509 хранится в хранилище сертификатов Windows, с помощью такого средства, как оснастка консоли управления (MMC) сертификаты.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-180">This out-of-band-negotiation can be done in email, and the X.509 certificate is stored in Windows certificate store, using a tool such as the Microsoft Management Console (MMC) Certificates snap-in.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9aa5a-181">Сертификат, полученный с использованием процедуры внешнего согласования, передается службе с помощью свойства <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-181">The <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property is used to provide the service with a certificate that was attained through out-of-band negotiation.</span></span> <span data-ttu-id="9aa5a-182">Это необходимо при использовании класса <xref:System.ServiceModel.BasicHttpBinding>, поскольку привязка не допускает автоматического согласования.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-182">This is necessary when using the <xref:System.ServiceModel.BasicHttpBinding> class because the binding does not allow automated negotiation.</span></span> <span data-ttu-id="9aa5a-183">Это свойство также используется в случае некоррелированного дуплексного канала.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-183">The property is also used in an uncorrelated duplex scenario.</span></span> <span data-ttu-id="9aa5a-184">В этом случае сервер отправляет клиенту сообщение, не ожидая поступления запроса от клиента.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-184">This is a scenario where a server sends a message to the client without requiring the client to send a request to the server first.</span></span> <span data-ttu-id="9aa5a-185">Так как сервер не получает запрос от клиента, он должен использовать для шифрования сообщения сертификат клиента.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-185">Because the server does not have a request from the client, it must use the client's certificate to encrypt the message to the client.</span></span>  
  
## <a name="setting-credential-values"></a><span data-ttu-id="9aa5a-186">Задание значений учетных данных</span><span class="sxs-lookup"><span data-stu-id="9aa5a-186">Setting Credential Values</span></span>  
 <span data-ttu-id="9aa5a-187">После выбора режима безопасности необходимо задать фактические значения учетных данных.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-187">Once you select a security mode, you must specify the actual credentials.</span></span> <span data-ttu-id="9aa5a-188">Например, если типом учетных данных клиента является сертификат, необходимо связать со службой или клиентом определенный сертификат (например, определенный сертификат X.509).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-188">For example, if the credential type is set to "certificate," then you must associate a specific credential (such as a specific X.509 certificate) with the service or client.</span></span>  
  
 <span data-ttu-id="9aa5a-189">Методы задания значений учетных данных при программировании службы и клиента несколько различаются.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-189">Depending on whether you are programming a service or a client, the method for setting the credential value differs slightly.</span></span>  
  
### <a name="setting-service-credentials"></a><span data-ttu-id="9aa5a-190">Задание учетных данных службы</span><span class="sxs-lookup"><span data-stu-id="9aa5a-190">Setting Service Credentials</span></span>  
 <span data-ttu-id="9aa5a-191">При использовании режима транспорта и HTTP в качестве транспорта нужно использовать службы IIS или настраивать порт с сертификатом.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-191">If you are using transport mode, and you are using HTTP as the transport, you must use either Internet Information Services (IIS) or configure the port with a certificate.</span></span> <span data-ttu-id="9aa5a-192">Дополнительные сведения см. в разделе [Общие сведения о безопасности транспорта](../../../../docs/framework/wcf/feature-details/transport-security-overview.md) и [безопасности транспорта HTTP](../../../../docs/framework/wcf/feature-details/http-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-192">For more information, see [Transport Security Overview](../../../../docs/framework/wcf/feature-details/transport-security-overview.md) and [HTTP Transport Security](../../../../docs/framework/wcf/feature-details/http-transport-security.md).</span></span>  
  
 <span data-ttu-id="9aa5a-193">Для указания учетных данных для службы в коде создайте экземпляр класса <xref:System.ServiceModel.ServiceHost> и задайте соответствующие учетные данные с помощью класса <xref:System.ServiceModel.Description.ServiceCredentials>, доступ к которому осуществляется через свойство <xref:System.ServiceModel.ServiceHostBase.Credentials%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-193">To provision a service with credentials in code, create an instance of the <xref:System.ServiceModel.ServiceHost> class and specify the appropriate credential using the <xref:System.ServiceModel.Description.ServiceCredentials> class, accessed through the <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> property.</span></span>  
  
#### <a name="setting-a-certificate"></a><span data-ttu-id="9aa5a-194">Задание сертификата</span><span class="sxs-lookup"><span data-stu-id="9aa5a-194">Setting a Certificate</span></span>  
 <span data-ttu-id="9aa5a-195">Чтобы предоставить службе сертификат X.509 для проверки подлинности службы клиентами, используйте метод <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A> класса <xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-195">To provision a service with an X.509 certificate to be used to authenticate the service to clients, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential> class.</span></span>  
  
 <span data-ttu-id="9aa5a-196">Чтобы предоставить службе сертификат клиента, используйте метод <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> класса <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-196">To provision a service with a client certificate, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential> class.</span></span>  
  
#### <a name="setting-windows-credentials"></a><span data-ttu-id="9aa5a-197">Задание учетных данных Windows</span><span class="sxs-lookup"><span data-stu-id="9aa5a-197">Setting Windows Credentials</span></span>  
 <span data-ttu-id="9aa5a-198">Если клиент указывает действительные имя пользователя и пароль, они используются для проверки подлинности клиента.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-198">If the client specifies a valid user name and password, that credential is used to authenticate the client.</span></span> <span data-ttu-id="9aa5a-199">В противном случае используются учетные данные текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-199">Otherwise, the current logged-on user's credentials are used.</span></span>  
  
### <a name="setting-client-credentials"></a><span data-ttu-id="9aa5a-200">Задание учетных данных клиента</span><span class="sxs-lookup"><span data-stu-id="9aa5a-200">Setting Client Credentials</span></span>  
 <span data-ttu-id="9aa5a-201">В WCF клиентские приложения используют клиента WCF для подключения к службам.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-201">In WCF, client applications use a WCF client to connect to services.</span></span> <span data-ttu-id="9aa5a-202">Все клиенты наследуются от класса <xref:System.ServiceModel.ClientBase%601>, а свойство <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> клиента позволяет устанавливать различные значения учетных данных клиента.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-202">Every client derives from the <xref:System.ServiceModel.ClientBase%601> class, and the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property on the client allows the specification of various values of client credentials.</span></span>  
  
#### <a name="setting-a-certificate"></a><span data-ttu-id="9aa5a-203">Задание сертификата</span><span class="sxs-lookup"><span data-stu-id="9aa5a-203">Setting a Certificate</span></span>  
 <span data-ttu-id="9aa5a-204">Чтобы предоставить службе сертификат X.509 для проверки подлинности клиента службой, используйте метод <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> класса <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-204">To provision a service with an X.509 certificate that is used to authenticate the client to a service, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential> class.</span></span>  
  
## <a name="how-client-credentials-are-used-to-authenticate-a-client-to-the-service"></a><span data-ttu-id="9aa5a-205">Использование учетных данных клиента при проверке подлинности клиента службой</span><span class="sxs-lookup"><span data-stu-id="9aa5a-205">How Client Credentials Are Used to Authenticate a Client to the Service</span></span>  
 <span data-ttu-id="9aa5a-206">Учетные данные клиента, необходимые для связи со службой, предоставляются с помощью свойства <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> или <xref:System.ServiceModel.ChannelFactory.Credentials%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-206">Client credential information required to communicate with a service is provided using either the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property or the <xref:System.ServiceModel.ChannelFactory.Credentials%2A> property.</span></span> <span data-ttu-id="9aa5a-207">Безопасный канал может использовать эту информацию для выполнения службой проверки подлинности клиента.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-207">The security channel uses this information to authenticate the client to the service.</span></span> <span data-ttu-id="9aa5a-208">Проверка подлинности выполняется в одном из двух режимов.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-208">Authentication is accomplished through one of two modes:</span></span>  
  
- <span data-ttu-id="9aa5a-209">Учетные данные клиента используются один раз перед отправкой первого сообщения, используя экземпляр клиента WCF для установления контекста безопасности.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-209">The client credentials are used once before the first message is sent, using the WCF client instance to establish a security context.</span></span> <span data-ttu-id="9aa5a-210">Все сообщения приложения после этого защищены контекстом безопасности.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-210">All application messages are then secured through the security context.</span></span>  
  
- <span data-ttu-id="9aa5a-211">Учетные данные используются для проверки подлинности всех сообщений приложения, отправляемых службе.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-211">The client credentials are used to authenticate every application message sent to the service.</span></span> <span data-ttu-id="9aa5a-212">В этом случае контекст между клиентом и службой не устанавливается.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-212">In this case, no context is established between the client and the service.</span></span>  
  
### <a name="established-identities-cannot-be-changed"></a><span data-ttu-id="9aa5a-213">Невозможность изменения установленных идентификаций</span><span class="sxs-lookup"><span data-stu-id="9aa5a-213">Established Identities Cannot Be Changed</span></span>  
 <span data-ttu-id="9aa5a-214">При использовании первого метода установленный контекст связывается с идентификацией клиента навсегда.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-214">When the first method is used, the established context is permanently associated with the client identity.</span></span> <span data-ttu-id="9aa5a-215">Это значит, что после установки контекста безопасности нельзя изменить идентификацию, связанную с клиентом.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-215">That is, once the security context has been established, the identity associated with the client cannot be changed.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9aa5a-216">Есть ситуация, в которой следует учитывать невозможность изменить идентификацию (то есть при поведении по умолчанию, когда включена установка контекста безопасности).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-216">There is a situation to be aware of when the identity cannot be switched (that is, when establish security context is on, the default behavior).</span></span> <span data-ttu-id="9aa5a-217">Если создать службу, которая взаимодействует с вторую службу, нельзя изменить удостоверение, используемое для открытия клиента WCF для второй службы.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-217">If you create a service that communicates with a second service, the identity used to open the WCF client to the second service cannot be changed.</span></span> <span data-ttu-id="9aa5a-218">Это становится проблемой, если несколько клиентов могут использовать первую службу, а служба олицетворяет клиенты при доступе ко второй службе.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-218">This becomes a problem if multiple clients are allowed to use the first service and the service impersonates the clients when accessing the second service.</span></span> <span data-ttu-id="9aa5a-219">Если служба использует для всех вызывающих один и тот же клиент, все вызовы ко второй службе происходят под идентификацией первого вызывающего, с помощью которой был открыт клиент для второй службы.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-219">If the service reuses the same client for all callers, all calls to the second service are done under the identity of the first caller that was used to open the client to the second service.</span></span> <span data-ttu-id="9aa5a-220">Иными словами, служба использует идентификацию первого клиента для связи всех своих клиентов с другой службой.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-220">In other words, the service uses the identity of the first client for all its clients to communicate with the second service.</span></span> <span data-ttu-id="9aa5a-221">Это может привести к повышению привилегий.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-221">This can lead to the elevation of privilege.</span></span> <span data-ttu-id="9aa5a-222">Если такое поведение службы нежелательно, нужно отслеживать каждого отдельного вызывающего и создавать для каждого из них новый клиент для второй службы. Следует убедиться, что служба использует для связи каждого вызывающего со второй службой только соответствующий клиент.</span><span class="sxs-lookup"><span data-stu-id="9aa5a-222">If this is not the desired behavior of your service, you must track each caller and create a new client to the second service for every distinct caller, and ensure that the service uses only the right client for the right caller to communicate with the second service.</span></span>  
  
 <span data-ttu-id="9aa5a-223">Дополнительные сведения о учетные данные и безопасные сеансы, см. в разделе [соображения о защите безопасных сеансов](../../../../docs/framework/wcf/feature-details/security-considerations-for-secure-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="9aa5a-223">For more information about credentials and secure sessions, see [Security Considerations for Secure Sessions](../../../../docs/framework/wcf/feature-details/security-considerations-for-secure-sessions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9aa5a-224">См. также</span><span class="sxs-lookup"><span data-stu-id="9aa5a-224">See also</span></span>

- <xref:System.ServiceModel.ClientBase%601?displayProperty=nameWithType>
- <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Description.ClientCredentials.ClientCertificate%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.BasicHttpMessageSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.HttpTransportSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverHttp.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverMsmq.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverTcp.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.TcpTransportSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A?displayProperty=nameWithType>
- [<span data-ttu-id="9aa5a-225">Основные понятия безопасности</span><span class="sxs-lookup"><span data-stu-id="9aa5a-225">Security Concepts</span></span>](../../../../docs/framework/wcf/feature-details/security-concepts.md)
- [<span data-ttu-id="9aa5a-226">Защита служб и клиентов</span><span class="sxs-lookup"><span data-stu-id="9aa5a-226">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
- [<span data-ttu-id="9aa5a-227">Программирование безопасности WCF</span><span class="sxs-lookup"><span data-stu-id="9aa5a-227">Programming WCF Security</span></span>](../../../../docs/framework/wcf/feature-details/programming-wcf-security.md)
- [<span data-ttu-id="9aa5a-228">Безопасность транспорта HTTP</span><span class="sxs-lookup"><span data-stu-id="9aa5a-228">HTTP Transport Security</span></span>](../../../../docs/framework/wcf/feature-details/http-transport-security.md)
