---
title: Выбор транспортов
description: 'Узнайте о критериях выбора из основных транспортов, предоставляемых WCF: HTTP, TCP и именованные каналы.'
ms.date: 03/30/2017
helpviewer_keywords:
- choosing transports [WCF]
ms.assetid: b169462b-f7b6-4cf4-9fca-d306909ee8bf
ms.openlocfilehash: e1a92203de25aa399316eea91a758802768442a0
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2020
ms.locfileid: "85247498"
---
# <a name="choosing-a-transport"></a>Выбор транспортов
В этом разделе обсуждаются критерии выбора из трех основных транспортов, включенных в Windows Communication Foundation (WCF): HTTP, TCP и именованные каналы. В состав WCF также входит транспорт очереди сообщений (также называемый MSMQ), но этот документ не охватывает очередь сообщений.  
  
 Модель программирования WCF разделяет операции с конечными точками (как выраженные в контракте службы) с транспортного механизма, соединяющего две конечные точки. Это позволяет выбирать способ предоставления служб сети.  
  
 В WCF вы указываете, как передавать данные по сети между конечными точками с помощью *привязки*, которая состоит из последовательности *элементов привязки*. Транспорт представляется элементом привязки транспорта, являющимся частью привязки. В привязку входят необязательные элементы привязки протокола, такие как безопасность, обязательный элемент привязки кодировщика сообщений и обязательный элемент привязки транспорта. Транспорт отправляет другому приложению сериализованную форму сообщения и получает ее от этого приложения.  
  
 При необходимости подключиться к существующему клиенту или серверу не всегда имеется возможность выбрать определенный транспорт. Однако службы WCF можно сделать доступными через несколько конечных точек, каждый из которых имеет другой транспорт. Если один транспорт не охватывает всю аудиторию, для которой предназначена служба, целесообразно предоставлять службы через несколько конечных точек. Это позволит клиентским приложениям выбирать наиболее подходящие конечные точки.  
  
 После выбора транспорта необходимо выбрать использующую его привязку. Можно выбрать предоставляемую системой привязку (см. раздел [привязки, предоставляемые системой](../system-provided-bindings.md)) или создать собственную настраиваемую привязку (см. раздел [пользовательские привязки](../extending/custom-bindings.md)). Также можно создать собственную привязку. Дополнительные сведения см. в разделе [Создание пользовательских привязок](../extending/creating-user-defined-bindings.md).  
  
## <a name="advantages-of-each-transport"></a>Преимущества каждого транспорта  
 В этом разделе описываются основные причины выбора одного из трех основных транспортов и приводится подробная диаграмма принятия решений, которая поможет сделать правильный выбор.  
  
### <a name="when-to-use-http-transport"></a>Использование транспорта HTTP  
 HTTP - это протокол обмена запросами и ответами между клиентами и серверами. Чаще всего он используется при взаимодействии клиентов веб-обозревателя с веб-сервером. Клиент отправляет запрос на сервер, который ожидает передачи сообщений запроса клиента. После получения запроса сервер возвращает ответ, в котором содержится состояние запроса. В случае успешного выполнения возвращаются необязательные данные, такие как веб-страница, сообщение об ошибке и другая информация. Дополнительные сведения о протоколе HTTP см. в разделе [протокол HTTP-гипертекста](https://www.w3.org/Protocols/).  
  
 Протокол HTTP функционирует не на основе подключения, т. е. после отправки ответа состояние не поддерживается. Обработка многостраничных транзакций возможна только при сохранении необходимого состояния приложения.  
  
 В WCF привязка транспорта HTTP оптимизирована для взаимодействия с устаревшими системами, отличными от WCF. Если все взаимодействующие стороны используют WCF, привязки на основе TCP или именованные каналы выполняются быстрее. Дополнительные сведения см. в разделах <xref:System.ServiceModel.NetTcpBinding> и <xref:System.ServiceModel.NetNamedPipeBinding>.  
  
### <a name="when-to-use-the-tcp-transport"></a>Использование транспорта TCP  
 Протокол TCP - это поточно-ориентированная служба доставки на основе подключения с возможностью сквозного обнаружения и исправления ошибок. *На основе соединения* означает, что перед обменом данными устанавливается сеанс связи между узлами. Узел - это любое устройство в сети TCP/IP, идентифицируемое логическим IP-адресом.  
  
 Протокол TCP обеспечивает надежную доставку данных и отличается простотой в использовании. В частности, протокол TCP уведомляет отправителя о доставке пакета, гарантирует сохранение очередности пакетов в процессе доставки, повторно передает потерянные пакеты и препятствует дублированию пакетов данных. Обратите внимание, что эта надежная доставка применяется между двумя узлами TCP/IP и не совпадает с *WS-ReliableMessaging*, которая применяется между конечными точками, независимо от того, сколько промежуточных узлов они могут содержать.  
  
 Транспорт TCP WCF оптимизирован для сценария, в котором оба конца связи используют WCF. Эта привязка является самой быстрой привязкой WCF для сценариев, которые подразумевают взаимодействие между разными компьютерами. Обмены сообщениями используют элемент привязки <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement> для оптимизированной передачи сообщений. TCP обеспечивает дуплексную связь, следовательно, этот протокол можно использовать для реализации дуплексных контрактов, даже если клиент находится за пределами преобразования сетевых адресов (NAT).  
  
### <a name="when-to-use-the-named-pipe-transport"></a>Использование транспорта именованного канала  
 Именованный канал - это объект в ядре операционной системы Windows, такой как, например, общая область памяти, которая может использоваться процессами для взаимодействия. Именованный канал имеет имя, его можно использовать для односторонней или дуплексной связи между процессами на одном компьютере.  
  
 Если требуется обмен данными между различными приложениями WCF на одном компьютере и необходимо предотвратить обмен данными с другого компьютера, используйте транспорт именованных каналов. При этом действует еще одно ограничение: процессы, выполняемые с удаленного рабочего стола Windows, могут ограничиваться тем же сеансом удаленного рабочего стола Windows, если они не обладают привилегиями более высокого уровня.  
  
> [!WARNING]
> При использовании транспорта именованного канала с резервированием URL-адресов со слабым шаблоном на нескольких узлах, размещенных на IIS, может возникнуть следующая ошибка: Возникла ошибка в службе активации «NetPipeActivator» протокола «net.pipe» при попытке прослушивания узла «2», поэтому протокол для узла был временно отключен. Дополнительные сведения см. в описании сообщения об исключении. URL-адрес: Веаквилдкард: net. pipe:/ \<machine name> /состояние: Конфликтингрегистратион исключение: имя процесса: SMSVCHOST идентификатор процесса: 1076 \  
  
## <a name="decision-points-for-choosing-a-transport"></a>Факторы, определяющие выбор транспорта  
 В следующей таблице описаны стандартные факторы, которые необходимо учитывать при выборе транспорта. Необходимо также рассмотреть все дополнительные атрибуты и транспорты, применимые к приложению. Определите важные для приложения атрибуты и транспорты, которые успешно связываются с каждым из атрибутов, затем выберите транспорты, которые лучше всего подходят к составленному набору атрибутов.  
  
|attribute|Описание|Поддерживаемые транспорты|  
|---------------|-----------------|------------------------|  
|Диагностика|Диагностика позволяет автоматически выявлять проблемы с подключением транспорта. Все транспорты поддерживают возможность обратной отправки информации о сбоях подключения. Однако в WCF не включены средства диагностики для исследования сетевых проблем.|Отсутствуют|  
|Hosting|Все конечные точки WCF должны размещаться внутри приложения. Службы IIS 6,0 и более ранних версий поддерживают размещение приложений, использующих транспорт HTTP. В Windows Vista добавлена поддержка для размещения всех транспортов WCF, включая TCP и именованные каналы. Дополнительные сведения см. [в разделе Размещение в службы IIS](hosting-in-internet-information-services.md) и [размещение в службе активации Windows](hosting-in-windows-process-activation-service.md).|HTTP|  
|Проверка|Проверка - это возможность извлекать и обрабатывать информацию из сообщений во время передачи. Протокол HTTP отделяет сведения о маршрутизации и управлении от данных, благодаря чему легче создавать средства для проверки и анализа сообщений. Транспорты, которые легко проверять, также требуют меньше вычислительной производительности в сетевых устройствах. Возможность проверки сообщений зависит от заданного уровня безопасности.|HTTP|  
|Задержка|Задержка - это минимальный промежуток времени, необходимый для завершения обмена сообщениями. Все сетевые операции имеют то или иное значение задержки, которое зависит от выбранного транспорта. При односторонней или дуплексной связи с использованием транспорта, собственным шаблоном обмена сообщениями которого является "запрос-ответ" (например, HTTP), задержка увеличивается, так как организуется принудительная корреляция сообщений. В этом случае целесообразно использовать транспорт с собственным дуплексным шаблоном обмена сообщениями (например, TCP).|TCP, именованный<br /><br /> канал|  
|Охват|Область действия транспорта характеризует способность транспорта подключаться к другим системам. Транспорт именованных каналов имеет очень небольшую область действия, так как он может подключаться только к службам, выполняемым на том же компьютере. Транспорты TCP и HTTP обладают широкой областью действия и способны проникать в некоторые конфигурации NAT и конфигурации брандмауэра. Дополнительные сведения см. в разделе [Работа с NAT и брандмауэрами](working-with-nats-and-firewalls.md).|HTTP, TCP|  
|Безопасность|Безопасность - это возможность защищать сообщения во время передачи с помощью конфиденциальности, целостности или проверки подлинности. Конфиденциальность защищает сообщение от изучения, целостность - от изменения, а проверка подлинности предоставляет гарантии относительно отправителя или получателя сообщения.<br /><br /> WCF поддерживает защиту передачи как на уровне сообщений, так и на транспортном уровне. Безопасность сообщения составляется с транспортом, если транспорт поддерживает режим буферизованной передачи. Поддержка транспортной безопасности варьируется в зависимости от выбранного транспорта. Транспорты HTTP, TCP и транспорт именованных каналов обеспечивают практически одинаковую поддержку безопасности транспорта.|All|  
|Пропускная способность|Этот показатель измеряет объем данных, которые можно передать и обработать за указанный промежуток времени. Выбор транспорта влияет на пропускную способность операций службы, как и на задержку. Чтобы обеспечить максимальную пропускную способность транспорта, необходимо свести к минимуму нагрузку передаваемого содержимого и максимально сократить время ожидания завершения обмена сообщениями. При использовании транспорта TCP и транспорта именованных каналов к телу сообщения добавляется незначительная нагрузка, более того, эти транспорты поддерживают собственную дуплексную форму, благодаря чему сокращается время ожидания ответных сообщений.|TCP, именованный канал|  
|Инструментарий|Инструментарий представляет поддержку сторонних приложений для протокола, с помощью которого осуществляются разработка, диагностика, размещение и другие операции с приложением. Очень выгодным вложением станет создание средств и программного обеспечения для работы с протоколом HTTP.|HTTP|  
  
## <a name="see-also"></a>См. также

- <xref:System.ServiceModel.BasicHttpBinding>
- <xref:System.ServiceModel.WSHttpBinding>
- <xref:System.ServiceModel.WSDualHttpBinding>
- <xref:System.ServiceModel.WSFederationHttpBinding>
- <xref:System.ServiceModel.Channels.HttpTransportBindingElement>
- <xref:System.ServiceModel.NetTcpBinding>
- <xref:System.ServiceModel.Channels.TcpTransportBindingElement>
- <xref:System.ServiceModel.NetNamedPipeBinding>
- <xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement>
- [Привязки](bindings.md)
- [Привязки, предоставляемые системой](../system-provided-bindings.md)
- [Создание пользовательских привязок](../extending/creating-user-defined-bindings.md)
