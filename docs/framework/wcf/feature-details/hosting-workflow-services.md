---
title: Размещение службы рабочего процесса
ms.date: 03/30/2017
ms.assetid: 2d55217e-8697-4113-94ce-10b60863342e
ms.openlocfilehash: dbb5e9b687a735376d720b83607fc67350cd429f
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64613327"
---
# <a name="hosting-workflow-services"></a><span data-ttu-id="e9f47-102">Размещение службы рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="e9f47-102">Hosting Workflow Services</span></span>
<span data-ttu-id="e9f47-103">Для обработки входящих сообщений служба рабочих процессов должна быть размещена.</span><span class="sxs-lookup"><span data-stu-id="e9f47-103">A workflow service must be hosted for it to respond to incoming messages.</span></span> <span data-ttu-id="e9f47-104">Службы рабочих процессов используют инфраструктуру обмена сообщениями WCF и поэтому также требуют размещения.</span><span class="sxs-lookup"><span data-stu-id="e9f47-104">Workflow services use the WCF messaging infrastructure and are therefore hosted in similar ways.</span></span> <span data-ttu-id="e9f47-105">Подобно службам WCF службы рабочего процесса могут размещаться в любом управляемом приложении, в группе Internet Information Services (IIS), или в Windows процесса активации Services (WAS).</span><span class="sxs-lookup"><span data-stu-id="e9f47-105">Like WCF services, workflow services can be hosted in any managed application, under Internet Information Services (IIS), or under Windows Process Activation Services (WAS).</span></span> <span data-ttu-id="e9f47-106">Кроме того службы рабочего процесса могут размещаться в фабрике приложений Windows Server.</span><span class="sxs-lookup"><span data-stu-id="e9f47-106">In addition, workflow services can be hosted under Windows Server App Fabric.</span></span> <span data-ttu-id="e9f47-107">Дополнительные сведения о Windows Server App Fabric см. в разделе [документации по Windows Server App Fabric](https://go.microsoft.com/fwlink/?LinkId=193037), [AppFabric Hosting Features](https://go.microsoft.com/fwlink/?LinkId=196494), и [основы размещения AppFabric](https://go.microsoft.com/fwlink/?LinkId=196495).</span><span class="sxs-lookup"><span data-stu-id="e9f47-107">For more information about Windows Server App Fabric see [Windows Server App Fabric documentation](https://go.microsoft.com/fwlink/?LinkId=193037), [AppFabric Hosting Features](https://go.microsoft.com/fwlink/?LinkId=196494), and [AppFabric Hosting Concepts](https://go.microsoft.com/fwlink/?LinkId=196495).</span></span> <span data-ttu-id="e9f47-108">Дополнительные сведения о различных способах размещения WCF служб см. в разделе [размещение служб](../../../../docs/framework/wcf/hosting-services.md).</span><span class="sxs-lookup"><span data-stu-id="e9f47-108">For more information about the various ways to host WCF services see [Hosting Services](../../../../docs/framework/wcf/hosting-services.md).</span></span>

## <a name="hosting-in-a-managed-application"></a><span data-ttu-id="e9f47-109">Размещение в управляемом приложении</span><span class="sxs-lookup"><span data-stu-id="e9f47-109">Hosting in a managed application</span></span>
 <span data-ttu-id="e9f47-110">Размещение службы рабочего процесса в управляемом приложении производится с помощью класса <xref:System.ServiceModel.Activities.WorkflowServiceHost>.</span><span class="sxs-lookup"><span data-stu-id="e9f47-110">To host a workflow service in a managed application, use the <xref:System.ServiceModel.Activities.WorkflowServiceHost> class.</span></span> <span data-ttu-id="e9f47-111">Конструктор <xref:System.ServiceModel.Activities.WorkflowServiceHost> позволяет указать одноэлементный экземпляр службы рабочих процессов, определить службу рабочих процессов или действие, которое использует действия обмена сообщениями рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="e9f47-111">The <xref:System.ServiceModel.Activities.WorkflowServiceHost> constructor allows you to specify a singleton workflow service instance, a workflow service definition, or an activity that uses the workflow messaging activities.</span></span> <span data-ttu-id="e9f47-112">После вызова метода <xref:System.ServiceModel.Channels.CommunicationObject.Open%2A> служба переходит в режим ожидания передачи входящих сообщений.</span><span class="sxs-lookup"><span data-stu-id="e9f47-112">Calling <xref:System.ServiceModel.Channels.CommunicationObject.Open%2A> causes the service to start listening for incoming messages.</span></span>

## <a name="hosting-under-iis-or-was"></a><span data-ttu-id="e9f47-113">Размещение в службах IIS или WAS</span><span class="sxs-lookup"><span data-stu-id="e9f47-113">Hosting under IIS or WAS</span></span>
 <span data-ttu-id="e9f47-114">При размещении службы рабочих процессов в службах IIS или WAS создается виртуальный каталог, который служит для размещения файлов и определяет режим работы службы.</span><span class="sxs-lookup"><span data-stu-id="e9f47-114">Hosting a workflow service under IIS or WAS involves creating a virtual directory and placing files in the virtual directory that define the service and its behavior.</span></span> <span data-ttu-id="e9f47-115">При размещении службы рабочих процессов в службах IIS или WAS существует несколько возможностей.</span><span class="sxs-lookup"><span data-stu-id="e9f47-115">When hosting a workflow service under IIS or WAS there are several possibilities:</span></span>

- <span data-ttu-id="e9f47-116">Разместите XAMLX-файл, определяющий службу рабочих процессов, в виртуальном каталоге IIS/WAS вместе с файлом Web.config, который определяет режимы работы службы, конечные точки и другие элементы конфигурации.</span><span class="sxs-lookup"><span data-stu-id="e9f47-116">Place a .xamlx file that defines the workflow service in an IIS/WAS virtual directory along with a Web.config file that specifies the service behaviors, endpoints, and other configuration elements.</span></span>

- <span data-ttu-id="e9f47-117">Поместите XAMLX-файл, определяющий службу рабочего процесса, в виртуальный каталог IIS/WAS.</span><span class="sxs-lookup"><span data-stu-id="e9f47-117">Place a .xamlx file that defines the workflow service in an IIS/WAS virtual directory.</span></span> <span data-ttu-id="e9f47-118">XAMLX-файл определяет доступ к конечным точкам.</span><span class="sxs-lookup"><span data-stu-id="e9f47-118">The .xamlx file specifies the endpoints to expose.</span></span> <span data-ttu-id="e9f47-119">Конечные точки указываются в элементе `WorkflowService.Endpoints`, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="e9f47-119">Endpoints are specified in a `WorkflowService.Endpoints` element as shown in the following example.</span></span>

    ```xml
    <WorkflowService xmlns="http://schemas.microsoft.com/netfx/2009/xaml/servicemodel"  xmlns:p1="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:sad="clr-namespace:System.Activities.Debugger;assembly=System.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
      <WorkflowService.Endpoints>
        <Endpoint ServiceContractName="IWorkFlowEchoService" AddressUri="">
          <Endpoint.Binding>
            <BasicHttpBinding />
          </Endpoint.Binding>
        </Endpoint>
      </WorkflowService.Endpoints>
    <!-- ... -->
    </WorkflowService>
    ```

    > [!NOTE]
    > <span data-ttu-id="e9f47-120">В XAMLX-файле определить параметры поведения нельзя, поэтому для этого необходимо использовать файл Web.config.</span><span class="sxs-lookup"><span data-stu-id="e9f47-120">Behaviors cannot be specified in a .xamlx file, so you must use a Web.config if you need to specify behavior settings.</span></span>

- <span data-ttu-id="e9f47-121">Поместите XAMLX-файл, определяющий службу рабочего процесса, в виртуальный каталог IIS/WAS.</span><span class="sxs-lookup"><span data-stu-id="e9f47-121">Place a .xamlx file that defines the workflow service in an IIS/WAS virtual directory.</span></span> <span data-ttu-id="e9f47-122">Кроме того, в виртуальном каталоге может быть размещен SVC-файл.</span><span class="sxs-lookup"><span data-stu-id="e9f47-122">In addition, place a .svc file in the virtual directory.</span></span> <span data-ttu-id="e9f47-123">В этом файле можно указать пользовательскую фабрику узла веб-службы, применить пользовательское поведение или загрузить конфигурацию из альтернативного расположения.</span><span class="sxs-lookup"><span data-stu-id="e9f47-123">The .svc file allows you to specify a custom Web service host factory, apply custom behavior, or load configuration from a custom location.</span></span>

- <span data-ttu-id="e9f47-124">Разместите сборку в виртуальном каталоге IIS/WAS, который содержит действие, использующее действия обмена сообщениями WCF.</span><span class="sxs-lookup"><span data-stu-id="e9f47-124">Place an assembly in the IIS/WAS virtual directory that contains an activity that uses the WCF messaging activities.</span></span>

 <span data-ttu-id="e9f47-125">Xamlx-файл, определяющий службу рабочего процесса должен содержать <`Service`> корневой элемент или корневой элемент, содержащий любой тип, производный от <xref:System.Workflow.ComponentModel.Activity>.</span><span class="sxs-lookup"><span data-stu-id="e9f47-125">A .xamlx file that defines a workflow service must contain a <`Service`> root element or a root element that contains any type derived from <xref:System.Workflow.ComponentModel.Activity>.</span></span> <span data-ttu-id="e9f47-126">При использовании шаблона действия Visual Studio, создается xamlx-файл.</span><span class="sxs-lookup"><span data-stu-id="e9f47-126">When using the Visual Studio activity template, a .xamlx file is created.</span></span> <span data-ttu-id="e9f47-127">При использовании шаблона службы WCF Workflow Service создается xamlx-файл.</span><span class="sxs-lookup"><span data-stu-id="e9f47-127">When using the WCF Workflow Service template, a .xamlx file is created.</span></span>

## <a name="hosting-workflow-services-under-windows-server-app-fabric"></a><span data-ttu-id="e9f47-128">Размещение служб рабочего процесса в фабрике приложений Windows Server</span><span class="sxs-lookup"><span data-stu-id="e9f47-128">Hosting Workflow Services under Windows Server App Fabric</span></span>
 <span data-ttu-id="e9f47-129">Размещение службы рабочего процесса в фабрике приложений Windows Server осуществляется аналогично ее размещению на веб-сервере IIS/WAS.</span><span class="sxs-lookup"><span data-stu-id="e9f47-129">Hosting a workflow service under Windows Server App Fabric is done in the same way as hosting under IIS/WAS.</span></span> <span data-ttu-id="e9f47-130">Единственное отличие состоит в том, что установлена фабрика приложений Windows Server.</span><span class="sxs-lookup"><span data-stu-id="e9f47-130">The only difference is the fact that Windows Server App Fabric is installed.</span></span> <span data-ttu-id="e9f47-131">Фабрика приложений Windows Server добавляет в диспетчер IIS дополнительные средства, такие как командлеты powershell.</span><span class="sxs-lookup"><span data-stu-id="e9f47-131">Windows Server App Fabric provides tools that are added to Internet Information Services Manager, as well as powershell commandlets.</span></span> <span data-ttu-id="e9f47-132">Эти средства упрощают развертывание, управление и наблюдение за службами рабочего процесса и службами WCF.</span><span class="sxs-lookup"><span data-stu-id="e9f47-132">These tools simplify deploying, managing, and tracking of workflow services and WCF services.</span></span>

## <a name="referencing-custom-activities"></a><span data-ttu-id="e9f47-133">Ссылки на пользовательские действия</span><span class="sxs-lookup"><span data-stu-id="e9f47-133">Referencing Custom Activities</span></span>
 <span data-ttu-id="e9f47-134">Необходимо добавить ссылки на пользовательские действия <`Assemblies`> раздела <`System.Web.Compilation`>, чтобы они были загружены в домен приложения, а десериализатор XAML смог найти типы.</span><span class="sxs-lookup"><span data-stu-id="e9f47-134">References to custom activities must be added to the <`Assemblies`> section under <`System.Web.Compilation`> so that they are loaded into the Application Domain and the XAML deserializer is able to locate the types.</span></span> <span data-ttu-id="e9f47-135">Эти параметры могут быть указаны на уровне приложения или в корневом файле Web.config, если необходимо применять их ко всем приложениям компьютера.</span><span class="sxs-lookup"><span data-stu-id="e9f47-135">These settings can be made at the application level or in the root Web.config if the settings should be applied to all applications on the machine.</span></span>

## <a name="deployment"></a><span data-ttu-id="e9f47-136">Развертывание</span><span class="sxs-lookup"><span data-stu-id="e9f47-136">Deployment</span></span>
 <span data-ttu-id="e9f47-137">Для облегчения задачи развертывания создается инструмент веб-развертывания.</span><span class="sxs-lookup"><span data-stu-id="e9f47-137">The Web Deployment tool has been created to make the job of deployment easier.</span></span> <span data-ttu-id="e9f47-138">Инструмент позволяет переносить приложения между IIS 6.0 и IIS 7.0, выполнять синхронизацию ферм серверов, а также упаковывать, архивировать и развертывать веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="e9f47-138">The tool allows you to migrate applications between IIS 6.0 and IIS 7.0, synchronize server farms, and package, archive and deploy Web applications.</span></span> <span data-ttu-id="e9f47-139">Дополнительные сведения см. в разделе [средство развертывания MS](https://go.microsoft.com/fwlink/?LinkId=178690).</span><span class="sxs-lookup"><span data-stu-id="e9f47-139">For more information, see [MS Deployment Tool](https://go.microsoft.com/fwlink/?LinkId=178690).</span></span>

## <a name="see-also"></a><span data-ttu-id="e9f47-140">См. также</span><span class="sxs-lookup"><span data-stu-id="e9f47-140">See also</span></span>

- [<span data-ttu-id="e9f47-141">Внутренние особенности размещения службы рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="e9f47-141">Workflow Service Host Internals</span></span>](../../../../docs/framework/wcf/feature-details/workflow-service-host-internals.md)
- [<span data-ttu-id="e9f47-142">Настройка WorkflowServiceHost</span><span class="sxs-lookup"><span data-stu-id="e9f47-142">Configuring WorkflowServiceHost</span></span>](../../../../docs/framework/wcf/feature-details/configuring-workflowservicehost.md)