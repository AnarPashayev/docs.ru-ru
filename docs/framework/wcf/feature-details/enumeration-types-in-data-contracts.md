---
title: Типы перечислений в контрактах данных
description: Сведения о том, как модель контрактов данных выражает перечисления в рамках модели программирования WFC.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data contracts [WCF], enumeration types
ms.assetid: b5d694da-68cb-4b74-a5fb-75108a68ec3b
ms.openlocfilehash: ff3184a285e88d47d4545a38a6c74b2f209827fb
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2020
ms.locfileid: "85247303"
---
# <a name="enumeration-types-in-data-contracts"></a><span data-ttu-id="05ab9-103">Типы перечислений в контрактах данных</span><span class="sxs-lookup"><span data-stu-id="05ab9-103">Enumeration Types in Data Contracts</span></span>
<span data-ttu-id="05ab9-104">Перечисления могут быть выражены в модели контракта данных.</span><span class="sxs-lookup"><span data-stu-id="05ab9-104">Enumerations can be expressed in the data contract model.</span></span> <span data-ttu-id="05ab9-105">В этом разделе представлено несколько примеров, иллюстрирующих использование модели программирования.</span><span class="sxs-lookup"><span data-stu-id="05ab9-105">This topic walks through several examples that explain the programming model.</span></span>  
  
## <a name="enumeration-basics"></a><span data-ttu-id="05ab9-106">Основные сведения о перечислениях</span><span class="sxs-lookup"><span data-stu-id="05ab9-106">Enumeration Basics</span></span>  
 <span data-ttu-id="05ab9-107">Одним из способов использования типов перечисления в модели контрактов данных является применение к типу атрибута <xref:System.Runtime.Serialization.DataContractAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-107">One way to use enumeration types in the data contract model is to apply the <xref:System.Runtime.Serialization.DataContractAttribute> attribute to the type.</span></span> <span data-ttu-id="05ab9-108">Затем необходимо применить атрибут <xref:System.Runtime.Serialization.EnumMemberAttribute> к каждому члену, включаемому в контракт данных.</span><span class="sxs-lookup"><span data-stu-id="05ab9-108">You must then apply the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute to each member that must be included in the data contract.</span></span>  
  
 <span data-ttu-id="05ab9-109">В следующем примере показаны два класса.</span><span class="sxs-lookup"><span data-stu-id="05ab9-109">The following example shows two classes.</span></span> <span data-ttu-id="05ab9-110">Первый использует перечисление, а второй - определяет его.</span><span class="sxs-lookup"><span data-stu-id="05ab9-110">The first uses the enumeration and the second defines the enumeration.</span></span>  
  
 [!code-csharp[c_DataContractEnumerations#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontractenumerations/cs/source.cs#1)]
 [!code-vb[c_DataContractEnumerations#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontractenumerations/vb/source.vb#1)]  
  
 <span data-ttu-id="05ab9-111">Экземпляр класса `Car` можно отправить или получить, только если полю `condition` задано значение `New`, `Used` или `Rental`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-111">An instance of the `Car` class can be sent or received only if the `condition` field is set to one of the values `New`, `Used`, or `Rental`.</span></span> <span data-ttu-id="05ab9-112">Если `condition` имеет значение `Broken` или `Stolen`, создается исключение <xref:System.Runtime.Serialization.SerializationException>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-112">If the `condition` is `Broken` or `Stolen`, a <xref:System.Runtime.Serialization.SerializationException> is thrown.</span></span>  
  
 <span data-ttu-id="05ab9-113">Свойства <xref:System.Runtime.Serialization.DataContractAttribute> (<xref:System.Runtime.Serialization.DataContractAttribute.Name%2A> и <xref:System.Runtime.Serialization.DataContractAttribute.Namespace%2A>) можно использовать в контрактах данных перечисления как обычно.</span><span class="sxs-lookup"><span data-stu-id="05ab9-113">You can use the <xref:System.Runtime.Serialization.DataContractAttribute> properties (<xref:System.Runtime.Serialization.DataContractAttribute.Name%2A> and <xref:System.Runtime.Serialization.DataContractAttribute.Namespace%2A>) as usual for enumeration data contracts.</span></span>  
  
### <a name="enumeration-member-values"></a><span data-ttu-id="05ab9-114">Значения членов перечисления</span><span class="sxs-lookup"><span data-stu-id="05ab9-114">Enumeration Member Values</span></span>  
 <span data-ttu-id="05ab9-115">Как правило, контракт данных содержит имена членов перечисления, а не числовые значения.</span><span class="sxs-lookup"><span data-stu-id="05ab9-115">Generally the data contract includes enumeration member names, not numerical values.</span></span> <span data-ttu-id="05ab9-116">Однако при использовании модели контрактов данных, если принимающая сторона является клиентом WCF, экспортируемая схема сохраняет числовые значения.</span><span class="sxs-lookup"><span data-stu-id="05ab9-116">However, when using the data contract model, if the receiving side is a WCF client, the exported schema preserves the numerical values.</span></span> <span data-ttu-id="05ab9-117">Обратите внимание, что при использовании [класса XmlSerializer](using-the-xmlserializer-class.md)это не так.</span><span class="sxs-lookup"><span data-stu-id="05ab9-117">Note that this is not the case when using the [Using the XmlSerializer Class](using-the-xmlserializer-class.md).</span></span>  
  
 <span data-ttu-id="05ab9-118">В предыдущем примере, если `condition` задано значение `Used` и данные сериализуются в формат XML, получается XML-код `<condition>Used</condition>`, а не `<condition>1</condition>`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-118">In the preceding example, if `condition` is set to `Used` and the data is serialized to XML, the resulting XML is `<condition>Used</condition>` and not `<condition>1</condition>`.</span></span> <span data-ttu-id="05ab9-119">Поэтому следующий контракт данных эквивалентен контракту данных `CarConditionEnum`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-119">Therefore, the following data contract is equivalent to the data contract of `CarConditionEnum`.</span></span>  
  
 [!code-csharp[c_DataContractEnumerations#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontractenumerations/cs/source.cs#2)]
 [!code-vb[c_DataContractEnumerations#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontractenumerations/vb/source.vb#2)]  
  
 <span data-ttu-id="05ab9-120">Например, на отправляющей стороне можно использовать `CarConditionEnum`, а `CarConditionWithNumbers` - на получающей.</span><span class="sxs-lookup"><span data-stu-id="05ab9-120">For example, you can use `CarConditionEnum` on the sending side and `CarConditionWithNumbers` on the receiving side.</span></span> <span data-ttu-id="05ab9-121">Хотя отправляющая сторона использует для `Used` значение "1", а получающая сторона - "20", представлением XML для обеих сторон является `<condition>Used</condition>`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-121">Although the sending side uses the value "1" for `Used` and the receiving side uses the value "20," the XML representation is `<condition>Used</condition>` for both sides.</span></span>  
  
 <span data-ttu-id="05ab9-122">Для включения в контракт данных необходимо применить атрибут <xref:System.Runtime.Serialization.EnumMemberAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-122">To be included in the data contract, you must apply the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute.</span></span> <span data-ttu-id="05ab9-123">В .NET Framework можно всегда применять специальное значение 0 (ноль) к перечислению, которое также является значением по умолчанию для любого перечисления.</span><span class="sxs-lookup"><span data-stu-id="05ab9-123">In the .NET Framework, you can always apply the special value 0 (zero) to an enumeration, which is also the default value for any enumeration.</span></span> <span data-ttu-id="05ab9-124">Однако даже это специальное нулевое значение не удастся сериализовать, если оно не помечено атрибутом <xref:System.Runtime.Serialization.EnumMemberAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-124">However, even this special zero value cannot be serialized unless it is marked with the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute.</span></span>  
  
 <span data-ttu-id="05ab9-125">Существует два исключения из этого правила.</span><span class="sxs-lookup"><span data-stu-id="05ab9-125">There are two exceptions to this:</span></span>  
  
- <span data-ttu-id="05ab9-126">Во-первых, перечисления флагов (см. далее в этом разделе).</span><span class="sxs-lookup"><span data-stu-id="05ab9-126">Flag enumerations (discussed later in this topic).</span></span>  
  
- <span data-ttu-id="05ab9-127">Во-вторых, члены данных перечисления, свойству <xref:System.Runtime.Serialization.DataMemberAttribute.EmitDefaultValue%2A> которых задано значение `false` (в этом случае перечисление с нулевым значением исключается из сериализованных данных).</span><span class="sxs-lookup"><span data-stu-id="05ab9-127">Enumeration data members with the <xref:System.Runtime.Serialization.DataMemberAttribute.EmitDefaultValue%2A> property set to `false` (in which case, the enumeration with the value zero is omitted from the serialized data).</span></span>  
  
### <a name="customizing-enumeration-member-values"></a><span data-ttu-id="05ab9-128">Настройка значений членов перечисления</span><span class="sxs-lookup"><span data-stu-id="05ab9-128">Customizing Enumeration Member Values</span></span>  
 <span data-ttu-id="05ab9-129">Настройка значения членов перечисления, входящего в состав контракта данных, осуществляется с помощью свойства <xref:System.Runtime.Serialization.EnumMemberAttribute.Value%2A> атрибута <xref:System.Runtime.Serialization.EnumMemberAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-129">You can customize the enumeration member value that forms a part of the data contract by using the <xref:System.Runtime.Serialization.EnumMemberAttribute.Value%2A> property of the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute.</span></span>  
  
 <span data-ttu-id="05ab9-130">Так, следующий контракт данных также эквивалентен контракту данных перечисления `CarConditionEnum`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-130">For example, the following data contract is also equivalent to the data contract of the `CarConditionEnum`.</span></span>  
  
 [!code-csharp[c_DataContractEnumerations#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontractenumerations/cs/source.cs#3)]
 [!code-vb[c_DataContractEnumerations#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontractenumerations/vb/source.vb#3)]  
  
 <span data-ttu-id="05ab9-131">При сериализации значение `PreviouslyOwned` имеет представление XML `<condition>Used</condition>`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-131">When serialized, the value of `PreviouslyOwned` has the XML representation `<condition>Used</condition>`.</span></span>  
  
## <a name="simple-enumerations"></a><span data-ttu-id="05ab9-132">Простые перечисления</span><span class="sxs-lookup"><span data-stu-id="05ab9-132">Simple Enumerations</span></span>  
 <span data-ttu-id="05ab9-133">Кроме того, можно сериализовать типы перечислений, к которым не был применен атрибут <xref:System.Runtime.Serialization.DataContractAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-133">You can also serialize enumeration types to which the <xref:System.Runtime.Serialization.DataContractAttribute> attribute has not been applied.</span></span> <span data-ttu-id="05ab9-134">Эти типы перечислений обрабатываются точно так же, как описано выше, за исключением того, что каждый член (к которому не применяется атрибут <xref:System.NonSerializedAttribute>) обрабатывается, как если бы атрибут <xref:System.Runtime.Serialization.EnumMemberAttribute> применялся.</span><span class="sxs-lookup"><span data-stu-id="05ab9-134">Such enumeration types are treated exactly as previously described, except that every member (that does not have the <xref:System.NonSerializedAttribute> attribute applied) is treated as if the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute has been applied.</span></span> <span data-ttu-id="05ab9-135">Например, следующее перечисление неявно содержит контракт данных, эквивалентный контракту, описанному в примере `CarConditionEnum`.</span><span class="sxs-lookup"><span data-stu-id="05ab9-135">For example, the following enumeration implicitly has a data contract equivalent to the preceding `CarConditionEnum` example.</span></span>  
  
 [!code-csharp[c_DataContractEnumerations#6](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontractenumerations/cs/source.cs#6)]
 [!code-vb[c_DataContractEnumerations#6](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontractenumerations/vb/source.vb#6)]  
  
 <span data-ttu-id="05ab9-136">Если не нужно настраивать имя и пространство имен контракта данных перечисления, а также значения членов перечисления, можно использовать простые перечисления.</span><span class="sxs-lookup"><span data-stu-id="05ab9-136">You can use simple enumerations when you do not need to customize the enumeration's data contract name and namespace and the enumeration member values.</span></span>  
  
#### <a name="notes-on-simple-enumerations"></a><span data-ttu-id="05ab9-137">Замечания о простых перечислениях</span><span class="sxs-lookup"><span data-stu-id="05ab9-137">Notes on Simple Enumerations</span></span>  
 <span data-ttu-id="05ab9-138">Применение атрибута <xref:System.Runtime.Serialization.EnumMemberAttribute> к простым перечислениям не дает результата.</span><span class="sxs-lookup"><span data-stu-id="05ab9-138">Applying the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute to simple enumerations has no effect.</span></span>  
  
 <span data-ttu-id="05ab9-139">Не имеет значения, применяется ли атрибут <xref:System.SerializableAttribute> к перечислению.</span><span class="sxs-lookup"><span data-stu-id="05ab9-139">It makes no difference whether or not the <xref:System.SerializableAttribute> attribute is applied to the enumeration.</span></span>  
  
 <span data-ttu-id="05ab9-140">Тот факт, что класс <xref:System.Runtime.Serialization.DataContractSerializer> учитывает атрибут <xref:System.NonSerializedAttribute>, применимый к членам перечисления, отличает его от поведения классов <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> и <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-140">The fact that the <xref:System.Runtime.Serialization.DataContractSerializer> class honors the <xref:System.NonSerializedAttribute> attribute applied to enumeration members is different from the behavior of the <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> and the <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter>.</span></span> <span data-ttu-id="05ab9-141">Оба сериализатора игнорируют атрибут <xref:System.NonSerializedAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-141">Both of those serializers ignore the <xref:System.NonSerializedAttribute> attribute.</span></span>  
  
## <a name="flag-enumerations"></a><span data-ttu-id="05ab9-142">Перечисления флагов</span><span class="sxs-lookup"><span data-stu-id="05ab9-142">Flag Enumerations</span></span>  
 <span data-ttu-id="05ab9-143">К перечислениям можно применить атрибут <xref:System.FlagsAttribute>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-143">You can apply the <xref:System.FlagsAttribute> attribute to enumerations.</span></span> <span data-ttu-id="05ab9-144">В этом случае можно организовать одновременную отправку или получение списка нулевых и других значений перечисления.</span><span class="sxs-lookup"><span data-stu-id="05ab9-144">In that case, a list of zero or more enumeration values can be sent or received simultaneously.</span></span>  
  
 <span data-ttu-id="05ab9-145">Для этого нужно применить атрибут <xref:System.Runtime.Serialization.DataContractAttribute> к перечислению флагов, а затем пометить атрибутом <xref:System.Runtime.Serialization.EnumMemberAttribute> все члены, являющиеся степенями двух.</span><span class="sxs-lookup"><span data-stu-id="05ab9-145">To do so, apply the <xref:System.Runtime.Serialization.DataContractAttribute> attribute to the flag enumeration and then mark all the members that are powers of two with the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute.</span></span> <span data-ttu-id="05ab9-146">Обратите внимание, что использование перечисления флагов возможно только в том случае, если имеется непрерывная последовательность степеней двух (например, 1, 2, 4, 8, 16, 32, 64).</span><span class="sxs-lookup"><span data-stu-id="05ab9-146">Note that to use a flag enumeration, the progression must be an uninterrupted sequence of powers of 2 (for example, 1, 2, 4, 8, 16, 32, 64).</span></span>  
  
 <span data-ttu-id="05ab9-147">Чтобы отправить значение перечисления флага, нужно выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="05ab9-147">The following steps apply to sending a flag's enumeration value:</span></span>  
  
1. <span data-ttu-id="05ab9-148">Попытайтесь найти член перечисления (с примененным атрибутом <xref:System.Runtime.Serialization.EnumMemberAttribute>), который сопоставляется числовому значению.</span><span class="sxs-lookup"><span data-stu-id="05ab9-148">Attempt to find an enumeration member (with the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute applied) that maps to the numeric value.</span></span> <span data-ttu-id="05ab9-149">Если удается найти этот член, отправьте список, содержащий только этот член.</span><span class="sxs-lookup"><span data-stu-id="05ab9-149">If found, send a list that contains just that member.</span></span>  
  
2. <span data-ttu-id="05ab9-150">Попытайтесь представить числовое значение в виде суммы так, чтобы имелись члены перечисления (каждый с примененным атрибутом <xref:System.Runtime.Serialization.EnumMemberAttribute>), сопоставляемые каждой части этой суммы.</span><span class="sxs-lookup"><span data-stu-id="05ab9-150">Attempt to break the numeric value into a sum such that there are enumeration members (each with the <xref:System.Runtime.Serialization.EnumMemberAttribute> attribute applied) that map to each part of the sum.</span></span> <span data-ttu-id="05ab9-151">Отправьте список всех этих членов.</span><span class="sxs-lookup"><span data-stu-id="05ab9-151">Send the list of all these members.</span></span> <span data-ttu-id="05ab9-152">Обратите внимание, что для поиска такой суммы используется *жадный алгоритм* , поэтому нет никакой гарантии, что такая сумма будет найдена даже при наличии.</span><span class="sxs-lookup"><span data-stu-id="05ab9-152">Note that the *greedy algorithm* is used to find such a sum, and thus there is no guarantee that such a sum is found even if it is present.</span></span> <span data-ttu-id="05ab9-153">Чтобы избежать этой проблемы, нужно убедиться, что числовые значения членов перечисления представляют собой степени двух.</span><span class="sxs-lookup"><span data-stu-id="05ab9-153">To avoid this problem, make sure that the numeric values of the enumeration members are powers of two.</span></span>  
  
3. <span data-ttu-id="05ab9-154">Если не удается выполнить предыдущие два шага и числовое значение ненулевое, создайте исключение <xref:System.Runtime.Serialization.SerializationException>.</span><span class="sxs-lookup"><span data-stu-id="05ab9-154">If the preceding two steps fail, and the numeric value is nonzero, throw a <xref:System.Runtime.Serialization.SerializationException>.</span></span> <span data-ttu-id="05ab9-155">Если числовое значение равно нулю, отправьте пустой список.</span><span class="sxs-lookup"><span data-stu-id="05ab9-155">If the numeric value is zero, send the empty list.</span></span>  
  
### <a name="example"></a><span data-ttu-id="05ab9-156">Пример</span><span class="sxs-lookup"><span data-stu-id="05ab9-156">Example</span></span>  
 <span data-ttu-id="05ab9-157">Следующий пример перечисления можно использовать в операции флага.</span><span class="sxs-lookup"><span data-stu-id="05ab9-157">The following enumeration example can be used in a flag operation.</span></span>  
  
 [!code-csharp[c_DataContractEnumerations#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontractenumerations/cs/source.cs#4)]
 [!code-vb[c_DataContractEnumerations#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontractenumerations/vb/source.vb#4)]  
  
 <span data-ttu-id="05ab9-158">Следующие значения из примера сериализуются, как указано.</span><span class="sxs-lookup"><span data-stu-id="05ab9-158">The following example values are serialized as indicated.</span></span>  
  
 [!code-csharp[c_DataContractEnumerations#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontractenumerations/cs/source.cs#5)]
 [!code-vb[c_DataContractEnumerations#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontractenumerations/vb/source.vb#5)]  
  
## <a name="see-also"></a><span data-ttu-id="05ab9-159">См. также</span><span class="sxs-lookup"><span data-stu-id="05ab9-159">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- [<span data-ttu-id="05ab9-160">Использование контрактов данных</span><span class="sxs-lookup"><span data-stu-id="05ab9-160">Using Data Contracts</span></span>](using-data-contracts.md)
- [<span data-ttu-id="05ab9-161">Задание передачи данных в контрактах служб</span><span class="sxs-lookup"><span data-stu-id="05ab9-161">Specifying Data Transfer in Service Contracts</span></span>](specifying-data-transfer-in-service-contracts.md)
