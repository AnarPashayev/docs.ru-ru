---
title: Расширенная политика защиты
ms.date: 03/30/2017
ms.assetid: e2616a10-317e-4c34-8023-0c015a80a82f
ms.openlocfilehash: 645b48b3c7ce3daaaedac372ba5ba6fd5edfc8f8
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61990175"
---
# <a name="extended-protection-policy"></a>Расширенная политика защиты
Расширенная защита - это инициатива, направленная на отражение атак типа «злоумышленник в середине» (MITM). Атака MITM - это угроза безопасности, при которой злоумышленник перехватывает учетные данные клиента и переправляет их на сервер.  
  
## <a name="demonstrates"></a>Демонстрации  
 Расширенная защита  
  
## <a name="discussion"></a>Обсуждение  
 Если приложение проходит проверку подлинности с использованием протокола Kerberos, дайджест-проверку подлинности или проверку NTLM с использованием HTTPS, то сначала устанавливается канал безопасности транспортного уровня (TLS), а проверка подлинности выполняется по этому защищенному каналу. При этом отсутствует привязка между сеансовым ключом, создаваемым протоколом SSL, и сеансовым ключом, создаваемым в ходе проверки подлинности. Любой злоумышленник может внедриться между клиентом и сервером и начать пересылать запросы от клиента, даже если сам по себе транспортный канал защищен, поскольку сервер не имеет возможности проверить, был ли установлен защищенный канал клиентом или злоумышленником. Решением в данном сценарии является привязка внешнего канала с защитой TLS ко внутреннему каналу с проверкой подлинности клиента, чтобы сервер мог обнаружить вторжение злоумышленника.  
  
> [!NOTE]
>  Данный образец работает только при размещении на IIS и не поддерживает Cassini - сервер разработчиков Visual Studio, поскольку Cassini не поддерживает протокол HTTPS.  
  
> [!NOTE]
>  Эта функция доступна в настоящее время только для Windows 7. Следующие шаги применимы только для Windows 7.  
  
#### <a name="to-set-up-build-and-run-the-sample"></a>Настройка, сборка и выполнение образца  
  
1. Установите службы IIS из **панель управления**, **Установка и удаление программ**, **функции Windows**.  
  
2. Установка **проверки подлинности Windows** в **функции Windows**, **Internet Information Services**, **World Wide Web Services**,  **Безопасность**, и **проверки подлинности Windows**.  
  
3. Установка **Windows Communication Foundation HTTP активации** в **функции Windows**, **Microsoft .NET Framework 3.5.1**, и **связи Windows Активация Foundation HTTP**.  
  
4. Для работы этого образца клиенту необходимо установить защищенный канал с сервером, для чего требуется наличие сертификата сервера, который может устанавливаться из диспетчера служб IIS.  
  
    1. Откройте диспетчер IIS. Откройте **сертификаты сервера**, которое отображается в **Просмотр возможностей** вкладке при выборе корневого узла (имя компьютера).  
  
    2. Для тестирования этого образца создайте самозаверяющий сертификат. Чтобы не выводить в Internet Explorer запрос об отсутствии защиты сертификата, можно установить его в хранилище «Доверенные корневые центры сертификации».  
  
5. Откройте **действия** панели веб-сайта по умолчанию. Нажмите кнопку **изменение сайта**, **привязки**. Добавьте HTTPS в качестве типа, если пока этот протокол отсутствует, с номером порта 443. Назначьте SSL-сертификат, созданный на предыдущем шаге.  
  
6. Постройте службу. При этом в службах IIS будет создан виртуальный каталог, куда будут скопированы DLL-файлы, SVC-файлы и файлы конфигурации, необходимые для размещения службы в веб.  
  
7. Откройте диспетчер IIS. Щелкните правой кнопкой мыши виртуальный каталог (**ExtendedProtection**), который был создан на предыдущем шаге. Выберите **преобразовать в приложение**.  
  
8. Откройте **проверки подлинности** модуля в диспетчере служб IIS для этого виртуального каталога и включите **проверки подлинности Windows**.  
  
9. Откройте **Дополнительные параметры** под **проверки подлинности Windows** для этого виртуального каталога и присвойте ему значение **требуется**.  
  
10. Проверить службу можно, введя соответствующий HTTPS URL в окне браузера (полное доменное имя). Чтобы получить доступ к этому URL-адресу с удаленного компьютера, убедитесь, что в брандмауэре открыты все входящие подключения HTTP и HTTPS.  
  
11. Откройте клиентский файл конфигурации и введите полное имя домена в атрибуте адреса клиента или конечной точки вместо `<<full_machine_name>>`.  
  
12. Запустите клиент. Клиент обращается к службе, которая устанавливает безопасный канал и использует расширенную защиту.  
  
> [!IMPORTANT]
>  Образцы уже могут быть установлены на компьютере. Перед продолжением проверьте следующий каталог (по умолчанию).  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  Если этот каталог не существует, перейдите к [Windows Communication Foundation (WCF) и образцы Windows Workflow Foundation (WF) для .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) для загрузки всех Windows Communication Foundation (WCF) и [!INCLUDE[wf1](../../../../includes/wf1-md.md)] примеры. Этот образец расположен в следующем каталоге.  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\Security\ExtendedProtection`
