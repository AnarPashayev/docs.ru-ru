---
title: Расширенная политика защиты
ms.date: 03/30/2017
ms.assetid: e2616a10-317e-4c34-8023-0c015a80a82f
ms.openlocfilehash: 3a5b1c7f296c68d407f0217963dec56f53e9a08a
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79144726"
---
# <a name="extended-protection-policy"></a>Расширенная политика защиты
Расширенная защита - это инициатива, направленная на отражение атак типа «злоумышленник в середине» (MITM). Атака MITM - это угроза безопасности, при которой злоумышленник перехватывает учетные данные клиента и переправляет их на сервер.  
  
## <a name="demonstrates"></a>Что демонстрирует  
 Расширенная защита  
  
## <a name="discussion"></a>Обсуждение  
 Если приложение проходит проверку подлинности с использованием протокола Kerberos, дайджест-проверку подлинности или проверку NTLM с использованием HTTPS, то сначала устанавливается канал безопасности транспортного уровня (TLS), а проверка подлинности выполняется по этому защищенному каналу. При этом отсутствует привязка между сеансовым ключом, создаваемым протоколом SSL, и сеансовым ключом, создаваемым в ходе проверки подлинности. Любой злоумышленник может внедриться между клиентом и сервером и начать пересылать запросы от клиента, даже если сам по себе транспортный канал защищен, поскольку сервер не имеет возможности проверить, был ли установлен защищенный канал клиентом или злоумышленником. Решением в данном сценарии является привязка внешнего канала с защитой TLS ко внутреннему каналу с проверкой подлинности клиента, чтобы сервер мог обнаружить вторжение злоумышленника.  
  
> [!NOTE]
> Данный образец работает только при размещении на IIS и не поддерживает Cassini - сервер разработчиков Visual Studio, поскольку Cassini не поддерживает протокол HTTPS.  
  
> [!NOTE]
> Эта функция доступна в настоящее время только для Windows 7. Следующие шаги применимы только для Windows 7.  
  
#### <a name="to-set-up-build-and-run-the-sample"></a>Настройка, сборка и выполнение образца  
  
1. Установка информационных служб Интернета из **панели управления,** **Добавить / Удалить программы**, Windows **Особенности**.  
  
2. Установите **аутентирование Windows** в **функции Windows,** **Информационные службы Интернета,** **Службы Всемирной Паутины,** **Безопасность**и **Аутентификация Windows.**  
  
3. Установка **Windows Communication Foundation HTTP Активация** в Windows **Особенности**, **Microsoft .NET Framework 3.5.1**, и **Windows Communication Foundation HTTP активации**.  
  
4. Для работы этого образца клиенту необходимо установить защищенный канал с сервером, для чего требуется наличие сертификата сервера, который может устанавливаться из диспетчера служб IIS.  
  
    1. Откройте диспетчер служб IIS. Сертификаты Open **Server,** которые отображаются во вкладке **«Вид функции»** при выборе корневого узла (имя машины).  
  
    2. Для тестирования этого образца создайте самозаверяющий сертификат. Чтобы не выводить в Internet Explorer запрос об отсутствии защиты сертификата, можно установить его в хранилище «Доверенные корневые центры сертификации».  
  
5. Откройте панель **действий** для веб-узла по умолчанию. Нажмите **Edit сайт**, **Привязки**. Добавьте HTTPS в качестве типа, если пока этот протокол отсутствует, с номером порта 443. Назначьте SSL-сертификат, созданный на предыдущем шаге.  
  
6. Постройте службу. При этом в службах IIS будет создан виртуальный каталог, куда будут скопированы DLL-файлы, SVC-файлы и файлы конфигурации, необходимые для размещения службы в веб.  
  
7. Откройте диспетчер служб IIS. Справа щелкните виртуальный каталог **(ExtendedProtection),** который был создан на предыдущем этапе. Выберите **Преобразование в приложение**.  
  
8. Откройте модуль **аутентификации** в IIS Manager для этого виртуального каталога и включите **windows Authentication.**  
  
9. Откройте **расширенные настройки** под **аутентификацией Windows** для этого виртуального каталога и установите его на **требуемое.**  
  
10. Проверить службу можно, введя соответствующий HTTPS URL в окне браузера (полное доменное имя). Чтобы получить доступ к этому URL-адресу с удаленного компьютера, убедитесь, что в брандмауэре открыты все входящие подключения HTTP и HTTPS.  
  
11. Откройте клиентский файл конфигурации и введите полное имя домена в атрибуте адреса клиента или конечной точки вместо `<<full_machine_name>>`.  
  
12. Запустите клиент. Клиент обращается к службе, которая устанавливает безопасный канал и использует расширенную защиту.  
  
> [!IMPORTANT]
> Образцы уже могут быть установлены на компьютере. Перед продолжением проверьте следующий каталог (по умолчанию).  
>
> `<InstallDrive>:\WF_WCF_Samples`  
>
> Если этого каталога не существует, перейдите в [Windows Communication Foundation (WCF) и Windows Workflow Foundation (WF) Образцы для .NET Framework 4,](https://www.microsoft.com/download/details.aspx?id=21459) чтобы загрузить все Windows Communication Foundation (WCF) и [!INCLUDE[wf1](../../../../includes/wf1-md.md)] образцы. Этот образец расположен в следующем каталоге.  
>
> `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\Security\ExtendedProtection`
