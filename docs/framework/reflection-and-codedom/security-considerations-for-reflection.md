---
title: Соображения о безопасности для отражения
description: Изучите вопросы безопасности для отражения в .NET. Получение сведений о типах и членах разрешено, но на доступ к членам накладываются ограничения.
ms.date: 03/30/2017
helpviewer_keywords:
- permissions [.NET Framework], reflection
- MethodInfo parameters
- reflection, security
- partial trust,reflection
- nonpublic members
- reflection,partial trust
- link demands
ms.assetid: 42d9dc2a-8fcc-4ff3-b002-4ff260ef3dc5
ms.openlocfilehash: 0465cbd5ceb7d4f44bb6d10865fcbd17b8ed7af6
ms.sourcegitcommit: 3d84eac0818099c9949035feb96bbe0346358504
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/21/2020
ms.locfileid: "86865259"
---
# <a name="security-considerations-for-reflection"></a><span data-ttu-id="67a66-104">Соображения о безопасности для отражения</span><span class="sxs-lookup"><span data-stu-id="67a66-104">Security Considerations for Reflection</span></span>

<span data-ttu-id="67a66-105">Отражение дает возможность получать информацию о типах и членах, а также обращаться к членам (то есть вызывать методы и конструкторы для получения и задания значений свойств, добавления и удаления обработчиков событий и т. д.).</span><span class="sxs-lookup"><span data-stu-id="67a66-105">Reflection provides the ability to obtain information about types and members, and to access members (that is, to call methods and constructors, to get and set property values, to add and remove event handlers, and so on).</span></span> <span data-ttu-id="67a66-106">Использование отражения для получения информации о типах и членах не ограничено.</span><span class="sxs-lookup"><span data-stu-id="67a66-106">The use of reflection to obtain information about types and members is not restricted.</span></span> <span data-ttu-id="67a66-107">В любом коде отражение можно использовать для выполнения следующих задач:</span><span class="sxs-lookup"><span data-stu-id="67a66-107">All code can use reflection to perform the following tasks:</span></span>

- <span data-ttu-id="67a66-108">перечисления типов и членов и просмотра их метаданных;</span><span class="sxs-lookup"><span data-stu-id="67a66-108">Enumerate types and members, and examine their metadata.</span></span>

- <span data-ttu-id="67a66-109">перечисления и просмотра сборок и модулей.</span><span class="sxs-lookup"><span data-stu-id="67a66-109">Enumerate and examine assemblies and modules.</span></span>

<span data-ttu-id="67a66-110">На использование отражения для доступа к членам, напротив, накладываются ограничения.</span><span class="sxs-lookup"><span data-stu-id="67a66-110">Using reflection to access members, by contrast, is subject to restrictions.</span></span> <span data-ttu-id="67a66-111">Начиная с .NET Framework 4 только полностью доверенный код может использовать отражение для доступа к членам, критически важным с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-111">Beginning with the .NET Framework 4, only trusted code can use reflection to access security-critical members.</span></span> <span data-ttu-id="67a66-112">Кроме того, только полностью доверенный код может использовать отражение для доступа к закрытым членам, которые недоступны компилированному коду непосредственно.</span><span class="sxs-lookup"><span data-stu-id="67a66-112">Furthermore, only trusted code can use reflection to access nonpublic members that would not be directly accessible to compiled code.</span></span> <span data-ttu-id="67a66-113">Наконец, код, который использует отражение для доступа к критическим с точки зрения безопасности членам, должен иметь все разрешения, требуемые этим членом, то есть ситуация такая же, как с компилированным кодом.</span><span class="sxs-lookup"><span data-stu-id="67a66-113">Finally, code that uses reflection to access a safe-critical member must have whatever permissions the safe-critical member demands, just as with compiled code.</span></span>

<span data-ttu-id="67a66-114">В зависимости от необходимых разрешений код может использовать отражение для осуществления следующих видов доступа:</span><span class="sxs-lookup"><span data-stu-id="67a66-114">Subject to necessary permissions, code can use reflection to perform the following kinds of access:</span></span>

- <span data-ttu-id="67a66-115">доступ к открытым членам, которые не являются критическими с точки зрения безопасности;</span><span class="sxs-lookup"><span data-stu-id="67a66-115">Access public members that are not security-critical.</span></span>

- <span data-ttu-id="67a66-116">доступ к закрытым членам, которые доступны скомпилированному коду, только если не являются критическими с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-116">Access nonpublic members that would be accessible to compiled code, if those members are not security-critical.</span></span> <span data-ttu-id="67a66-117">Примерами подобных закрытых членов являются:</span><span class="sxs-lookup"><span data-stu-id="67a66-117">Examples of such nonpublic members include:</span></span>

  - <span data-ttu-id="67a66-118">защищенные члены базовых классов вызывающего кода</span><span class="sxs-lookup"><span data-stu-id="67a66-118">Protected members of the calling code's base classes.</span></span> <span data-ttu-id="67a66-119">(в отражении это называется доступом на уровне семейства);</span><span class="sxs-lookup"><span data-stu-id="67a66-119">(In reflection, this is referred to as family-level access.)</span></span>

  - <span data-ttu-id="67a66-120">члены `internal` (члены `Friend` в Visual Basic) в сборке вызывающего кода</span><span class="sxs-lookup"><span data-stu-id="67a66-120">`internal` members (`Friend` members in Visual Basic) in the calling code's assembly.</span></span> <span data-ttu-id="67a66-121">(в отражении это называется доступом на уровне сборки);</span><span class="sxs-lookup"><span data-stu-id="67a66-121">(In reflection, this is referred to as assembly-level access.)</span></span>

  - <span data-ttu-id="67a66-122">закрытые члены других экземпляров класса, содержащего вызывающий код.</span><span class="sxs-lookup"><span data-stu-id="67a66-122">Private members of other instances of the class that contains the calling code.</span></span>

<span data-ttu-id="67a66-123">Например, для кода, выполняемого в изолированном домене приложения, доступ ограничен видами, перечисленными в этом списке, пока домену приложения не будут предоставлены дополнительные разрешения.</span><span class="sxs-lookup"><span data-stu-id="67a66-123">For example, code that is run in a sandboxed application domain is limited to the access described in this list, unless the application domain grants additional permissions.</span></span>

<span data-ttu-id="67a66-124">Начиная с .NET Framework 2.0 с пакетом обновления 1 (SP1) при попытке доступа к членам, которые обычно недоступны, запрашивается набор прав для целевого объекта и разрешения <xref:System.Security.Permissions.ReflectionPermission> с флагом <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="67a66-124">Starting with the .NET Framework 2.0 Service Pack 1, attempting to access members that are normally inaccessible generates a demand for the grant set of the target object plus <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="67a66-125">Код, выполняемый с полным доверием (например, код в приложении, которое запускается из командной строки), может всегда удовлетворять этим разрешениям.</span><span class="sxs-lookup"><span data-stu-id="67a66-125">Code that is running with full trust (for example, code in an application that is launched from the command line) can always satisfy these permissions.</span></span> <span data-ttu-id="67a66-126">(К нему применяются ограничения доступа к членам, критическим с точки зрения безопасности, описанные ниже в данном разделе.)</span><span class="sxs-lookup"><span data-stu-id="67a66-126">(This is subject to limitations in accessing security-critical members, as described later in this article.)</span></span>

<span data-ttu-id="67a66-127">При необходимости изолированный домен приложения может предоставить разрешение <xref:System.Security.Permissions.ReflectionPermission> с флагом <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>, как описано в разделе [Доступ к обычно недоступным членам](#accessingNormallyInaccessible) далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="67a66-127">Optionally, a sandboxed application domain can grant <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag, as described in the section [Accessing Members That Are Normally Inaccessible](#accessingNormallyInaccessible), later in this article.</span></span>

<a name="accessingSecurityCritical"></a>

## <a name="accessing-security-critical-members"></a><span data-ttu-id="67a66-128">Доступ к членам, критическим с точки зрения безопасности</span><span class="sxs-lookup"><span data-stu-id="67a66-128">Accessing Security-Critical Members</span></span>

<span data-ttu-id="67a66-129">Член является критическим с точки зрения безопасности, если у него есть атрибут <xref:System.Security.SecurityCriticalAttribute>, если он относится к типу с атрибутом <xref:System.Security.SecurityCriticalAttribute> или если он находится в сборке, критической с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-129">A member is security-critical if it has the <xref:System.Security.SecurityCriticalAttribute>, if it belongs to a type that has the <xref:System.Security.SecurityCriticalAttribute>, or if it is in a security-critical assembly.</span></span> <span data-ttu-id="67a66-130">Начиная с версии NET Framework 4 в отношении доступа к членам, критически важным с точки зрения безопасности, применяются описанные ниже правила.</span><span class="sxs-lookup"><span data-stu-id="67a66-130">Beginning with the .NET Framework 4, the rules for accessing security-critical members are as follows:</span></span>

- <span data-ttu-id="67a66-131">Прозрачный код не может использовать отражение для доступа к членам, критическим с точки зрения безопасности, даже если он является полностью доверенным.</span><span class="sxs-lookup"><span data-stu-id="67a66-131">Transparent code cannot use reflection to access security-critical members, even if the code is fully trusted.</span></span> <span data-ttu-id="67a66-132">Создается исключение <xref:System.MethodAccessException>, <xref:System.FieldAccessException> или <xref:System.TypeAccessException>.</span><span class="sxs-lookup"><span data-stu-id="67a66-132">A <xref:System.MethodAccessException>, <xref:System.FieldAccessException>, or <xref:System.TypeAccessException> is thrown.</span></span>

- <span data-ttu-id="67a66-133">Код, выполняемый с частичным доверием, рассматривается как прозрачный.</span><span class="sxs-lookup"><span data-stu-id="67a66-133">Code that is running with partial trust is treated as transparent.</span></span>

<span data-ttu-id="67a66-134">Эти правила являются одинаковыми как для прямого доступа к члену, критическому с точки зрения безопасности, из скомпилированного кода, так и для доступа с помощью отражения.</span><span class="sxs-lookup"><span data-stu-id="67a66-134">These rules are the same whether a security-critical member is accessed directly by compiled code, or accessed by using reflection.</span></span>

<span data-ttu-id="67a66-135">Код приложения, который запускается из командной строки, выполняется с полным доверием.</span><span class="sxs-lookup"><span data-stu-id="67a66-135">Application code that is run from the command line runs with full trust.</span></span> <span data-ttu-id="67a66-136">Если код не помечен как прозрачный, он может использовать отражение для доступа к членам, критическим с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-136">As long as it is not marked as transparent, it can use reflection to access security-critical members.</span></span> <span data-ttu-id="67a66-137">При выполнении того же кода с частичным доверием (например, в изолированном домене приложения) уровень доверия сборки определяет, может ли она получить доступ к коду, критическому с точки зрения безопасности: если сборка имеет строгое имя и установлена в глобальном кэше сборок, она является доверенной и может вызывать члены, критические с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-137">When the same code is run with partial trust (for example, in a sandboxed application domain) the assembly's trust level determines whether it can access security-critical code: If the assembly has a strong name and is installed in the global assembly cache, it is a trusted assembly and can call security-critical members.</span></span> <span data-ttu-id="67a66-138">Если код не является доверенным, он становится прозрачным даже в том случае, если не был помечен как прозрачный, и не может получить доступ к членам, критическим с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-138">If it is not trusted, it becomes transparent even though it was not marked as transparent, and it cannot access security-critical members.</span></span>

<span data-ttu-id="67a66-139">Подробнее о модели безопасности в .NET Framework 4 см. в разделе [Изменения системы безопасности](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span><span class="sxs-lookup"><span data-stu-id="67a66-139">For more information about the security model in the .NET Framework 4, see [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span></span>

## <a name="reflection-and-transparency"></a><span data-ttu-id="67a66-140">Отражение и прозрачность</span><span class="sxs-lookup"><span data-stu-id="67a66-140">Reflection and Transparency</span></span>

<span data-ttu-id="67a66-141">Начиная с версии .NET Framework 4 среда CLR определяет уровень прозрачности типа или члена на основе нескольких факторов, включая уровень доверия сборки и уровень доверия домена приложения.</span><span class="sxs-lookup"><span data-stu-id="67a66-141">Beginning with the .NET Framework 4, the common language runtime determines the transparency level of a type or member from several factors, including the trust level of the assembly and the trust level of the application domain.</span></span> <span data-ttu-id="67a66-142">Отражение предоставляет свойства <xref:System.Type.IsSecurityCritical%2A>, <xref:System.Type.IsSecuritySafeCritical%2A> и <xref:System.Type.IsSecurityTransparent%2A>, которые позволяют определить уровень прозрачности типа.</span><span class="sxs-lookup"><span data-stu-id="67a66-142">Reflection provides the <xref:System.Type.IsSecurityCritical%2A>, <xref:System.Type.IsSecuritySafeCritical%2A>, and <xref:System.Type.IsSecurityTransparent%2A> properties to enable you to discover the transparency level of a type.</span></span> <span data-ttu-id="67a66-143">В таблице ниже приведены допустимые сочетания этих свойств.</span><span class="sxs-lookup"><span data-stu-id="67a66-143">The following table shows the valid combinations of these properties.</span></span>

|<span data-ttu-id="67a66-144">Уровень безопасности</span><span class="sxs-lookup"><span data-stu-id="67a66-144">Security level</span></span>|<span data-ttu-id="67a66-145">IsSecurityCritical</span><span class="sxs-lookup"><span data-stu-id="67a66-145">IsSecurityCritical</span></span>|<span data-ttu-id="67a66-146">IsSecuritySafeCritical</span><span class="sxs-lookup"><span data-stu-id="67a66-146">IsSecuritySafeCritical</span></span>|<span data-ttu-id="67a66-147">IsSecurityTransparent</span><span class="sxs-lookup"><span data-stu-id="67a66-147">IsSecurityTransparent</span></span>|
|--------------------|------------------------|----------------------------|---------------------------|
|<span data-ttu-id="67a66-148">Critical</span><span class="sxs-lookup"><span data-stu-id="67a66-148">Critical</span></span>|`true`|`false`|`false`|
|<span data-ttu-id="67a66-149">Критический в плане безопасности</span><span class="sxs-lookup"><span data-stu-id="67a66-149">Safe-critical</span></span>|`true`|`true`|`false`|
|<span data-ttu-id="67a66-150">Прозрачный</span><span class="sxs-lookup"><span data-stu-id="67a66-150">Transparent</span></span>|`false`|`false`|`true`|

<span data-ttu-id="67a66-151">Использовать эти свойства гораздо проще, чем просматривать заметки о безопасности для сборки и ее типов, проверять текущий уровень доверия и пытаться дублировать правила среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="67a66-151">Using these properties is much simpler than examining the security annotations of an assembly and its types, checking the current trust level, and attempting to duplicate the runtime's rules.</span></span> <span data-ttu-id="67a66-152">Например, один и тот же тип может быть критическим с точки зрения безопасности при запуске из командной строки или прозрачным для системы безопасности при запуске в изолированном домене приложения.</span><span class="sxs-lookup"><span data-stu-id="67a66-152">For example, the same type can be security-critical when it is run from the command line, or security-transparent when it is run in a sandboxed application domain.</span></span>

<span data-ttu-id="67a66-153">Аналогичные свойства имеются в классах <xref:System.Reflection.MethodBase>, <xref:System.Reflection.FieldInfo>, <xref:System.Reflection.Emit.TypeBuilder>, <xref:System.Reflection.Emit.MethodBuilder> и <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="67a66-153">There are similar properties on the <xref:System.Reflection.MethodBase>, <xref:System.Reflection.FieldInfo>, <xref:System.Reflection.Emit.TypeBuilder>, <xref:System.Reflection.Emit.MethodBuilder>, and <xref:System.Reflection.Emit.DynamicMethod> classes.</span></span> <span data-ttu-id="67a66-154">(Для других отражений и абстракций порождаемых отражений атрибуты безопасности применяются к связанным методам; например, в случае свойств они применяются к методам доступа к свойствам).</span><span class="sxs-lookup"><span data-stu-id="67a66-154">(For other reflection and reflection emit abstractions, security attributes are applied to the associated methods; for example, in the case of properties they are applied to the property accessors.)</span></span>

<a name="accessingNormallyInaccessible"></a>

## <a name="accessing-members-that-are-normally-inaccessible"></a><span data-ttu-id="67a66-155">Доступ к обычно недоступным членам</span><span class="sxs-lookup"><span data-stu-id="67a66-155">Accessing Members That Are Normally Inaccessible</span></span>

<span data-ttu-id="67a66-156">Чтобы использовать отражение для вызова членов, которые недоступны в соответствии с правилами доступности среды CLR, коду необходимо предоставить одно из двух разрешений.</span><span class="sxs-lookup"><span data-stu-id="67a66-156">To use reflection to invoke members that are inaccessible according to the accessibility rules of the common language runtime, your code must be granted one of two permissions:</span></span>

- <span data-ttu-id="67a66-157">Чтобы разрешить коду вызывать любой закрытый член, ему нужно предоставить разрешение <xref:System.Security.Permissions.ReflectionPermission> с флагом <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="67a66-157">To allow code to invoke any nonpublic member:Your code must be granted <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>

  > [!NOTE]
  > <span data-ttu-id="67a66-158">По умолчанию политика безопасности отказывает в предоставлении этого разрешения коду, полученному из Интернета.</span><span class="sxs-lookup"><span data-stu-id="67a66-158">By default, security policy denies this permission to code that originates from the Internet.</span></span> <span data-ttu-id="67a66-159">Это разрешение ни в коем случае нельзя предоставлять коду, источником которого является Интернет.</span><span class="sxs-lookup"><span data-stu-id="67a66-159">This permission should never be granted to code that originates from the Internet.</span></span>

- <span data-ttu-id="67a66-160">Чтобы разрешить коду вызывать любой закрытый член, только если набор прав сборки, содержащей вызываемый член, идентичен набору прав сборки, содержащей вызывающий код, или является его подмножеством: Коду необходимо предоставить разрешение <xref:System.Security.Permissions.ReflectionPermission> с флагом <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="67a66-160">To allow code to invoke any nonpublic member, as long as the grant set of the assembly that contains the invoked member is the same as, or a subset of, the grant set of the assembly that contains the invoking code: Your code must be granted <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>

<span data-ttu-id="67a66-161">Предположим, вы предоставляете домену приложения разрешения на доступ к Интернету плюс разрешение <xref:System.Security.Permissions.ReflectionPermission> с флагом <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, а затем запускаете веб-приложение с двумя сборками, A и B.</span><span class="sxs-lookup"><span data-stu-id="67a66-161">For example, suppose you grant an application domain Internet permissions plus <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and then run an Internet application with two assemblies, A and B.</span></span>

- <span data-ttu-id="67a66-162">Сборка A может использовать отражение для доступа к закрытым членам сборки B, так как набор прав сборки B не включает какие-либо разрешения, которые не предоставлены сборке A.</span><span class="sxs-lookup"><span data-stu-id="67a66-162">Assembly A can use reflection to access private members of assembly B, because the grant set of assembly B does not include any permissions that A has not been granted.</span></span>

- <span data-ttu-id="67a66-163">Сборка A не может использовать отражение для доступа к закрытым членам сборок платформы .NET Framework, таких как mscorlib.dll, так как mscorlib.dll является полностью доверенной и поэтому обладает разрешениями, которые не были предоставлены сборке A. Возникает исключение <xref:System.MemberAccessException>, когда управление доступом для кода выполняет обход стека в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="67a66-163">Assembly A cannot use reflection to access private members of .NET Framework assemblies such as mscorlib.dll, because mscorlib.dll is fully trusted and therefore has permissions that have not been granted to assembly A. A <xref:System.MemberAccessException> is thrown when code access security walks the stack at run time.</span></span>

## <a name="serialization"></a><span data-ttu-id="67a66-164">Сериализация</span><span class="sxs-lookup"><span data-stu-id="67a66-164">Serialization</span></span>

<span data-ttu-id="67a66-165">Что касается сериализации, разрешение <xref:System.Security.Permissions.SecurityPermission> с флагом <xref:System.Security.Permissions.SecurityPermissionAttribute.SerializationFormatter%2A?displayProperty=nameWithType> предоставляет возможность получать и задавать члены сериализуемых типов независимо от доступности.</span><span class="sxs-lookup"><span data-stu-id="67a66-165">For serialization, <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionAttribute.SerializationFormatter%2A?displayProperty=nameWithType> flag provides the ability to get and set members of serializable types, regardless of accessibility.</span></span> <span data-ttu-id="67a66-166">Это разрешение позволяет коду обнаруживать и изменять закрытое состояние экземпляра.</span><span class="sxs-lookup"><span data-stu-id="67a66-166">This permission enables code to discover and change the private state of an instance.</span></span> <span data-ttu-id="67a66-167">(Помимо наличия соответствующих разрешений тип должен быть [помечен](../../standard/attributes/applying-attributes.md) как сериализуемый в метаданных.)</span><span class="sxs-lookup"><span data-stu-id="67a66-167">(In addition to being granted the appropriate permissions, the type must be [marked](../../standard/attributes/applying-attributes.md) as serializable in metadata.)</span></span>

## <a name="parameters-of-type-methodinfo"></a><span data-ttu-id="67a66-168">Параметры типа MethodInfo</span><span class="sxs-lookup"><span data-stu-id="67a66-168">Parameters of Type MethodInfo</span></span>

<span data-ttu-id="67a66-169">Избегайте написания открытых членов, принимающих параметры <xref:System.Reflection.MethodInfo>, особенно для доверенного кода.</span><span class="sxs-lookup"><span data-stu-id="67a66-169">Avoid writing public members that take <xref:System.Reflection.MethodInfo> parameters, especially for trusted code.</span></span> <span data-ttu-id="67a66-170">Такие члены могут оказаться более уязвимыми для вредоносного кода.</span><span class="sxs-lookup"><span data-stu-id="67a66-170">Such members might be more vulnerable to malicious code.</span></span> <span data-ttu-id="67a66-171">Например, рассмотрим открытый член в коде с высоким уровнем доверия, принимающий параметр <xref:System.Reflection.MethodInfo>.</span><span class="sxs-lookup"><span data-stu-id="67a66-171">For example, consider a public member in highly trusted code that takes a <xref:System.Reflection.MethodInfo> parameter.</span></span> <span data-ttu-id="67a66-172">Предположим, что открытый член косвенно вызывает метод <xref:System.Reflection.MethodBase.Invoke%2A> для предоставленного параметра.</span><span class="sxs-lookup"><span data-stu-id="67a66-172">Assume that the public member indirectly calls the <xref:System.Reflection.MethodBase.Invoke%2A> method on the supplied parameter.</span></span> <span data-ttu-id="67a66-173">Если открытый член не выполняет необходимые проверки разрешений, вызов метода <xref:System.Reflection.MethodBase.Invoke%2A> всегда будет успешным, так как система безопасности определяет, что вызывающий объект является полностью доверенным.</span><span class="sxs-lookup"><span data-stu-id="67a66-173">If the public member does not perform the necessary permission checks, the call to the <xref:System.Reflection.MethodBase.Invoke%2A> method will always succeed, because the security system determines that the caller is highly trusted.</span></span> <span data-ttu-id="67a66-174">Даже если вредоносный код не имеет разрешения на прямой вызов метода, он по-прежнему может сделать это косвенным образом, вызвав открытый член.</span><span class="sxs-lookup"><span data-stu-id="67a66-174">Even if malicious code does not have the permission to directly invoke the method, it can still do so indirectly by calling the public member.</span></span>

## <a name="version-information"></a><span data-ttu-id="67a66-175">Сведения о версии</span><span class="sxs-lookup"><span data-stu-id="67a66-175">Version Information</span></span>

- <span data-ttu-id="67a66-176">Начиная с NET Framework 4 прозрачный код не может использовать отражение для доступа к членам, критически важным с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="67a66-176">Beginning with the .NET Framework 4, transparent code cannot use reflection to access security-critical members.</span></span>

- <span data-ttu-id="67a66-177">Флаг <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> впервые появился в .NET Framework 2.0 с пакетом обновления 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="67a66-177">The <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag is introduced in the .NET Framework 2.0 Service Pack 1.</span></span> <span data-ttu-id="67a66-178">Более ранние версии платформы .NET Framework требуют флаг <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> для кода, который использует отражение для доступа к закрытым членам.</span><span class="sxs-lookup"><span data-stu-id="67a66-178">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for code that uses reflection to access nonpublic members.</span></span> <span data-ttu-id="67a66-179">Это разрешение, которое ни в коем случае нельзя предоставлять коду с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="67a66-179">This is a permission that should never be granted to partially trusted code.</span></span>

- <span data-ttu-id="67a66-180">Начиная с .NET Framework 2.0 использование отражения для получения сведений о закрытых типах и членах не требует никаких разрешений.</span><span class="sxs-lookup"><span data-stu-id="67a66-180">Beginning with the .NET Framework 2.0, using reflection to obtain information about nonpublic types and members does not require any permissions.</span></span> <span data-ttu-id="67a66-181">В более ранних версиях для этого требовалось разрешение <xref:System.Security.Permissions.ReflectionPermission> с флагом <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="67a66-181">In earlier versions, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag is required.</span></span>

## <a name="see-also"></a><span data-ttu-id="67a66-182">См. также</span><span class="sxs-lookup"><span data-stu-id="67a66-182">See also</span></span>

- <xref:System.Security.Permissions.ReflectionPermissionFlag>
- <xref:System.Security.Permissions.ReflectionPermission>
- <xref:System.Security.Permissions.SecurityPermission>
- [<span data-ttu-id="67a66-183">Изменения системы безопасности</span><span class="sxs-lookup"><span data-stu-id="67a66-183">Security Changes</span></span>](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes)
- [<span data-ttu-id="67a66-184">Управление доступом для кода</span><span class="sxs-lookup"><span data-stu-id="67a66-184">Code Access Security</span></span>](../misc/code-access-security.md)
- [<span data-ttu-id="67a66-185">Вопросы безопасности в порождении отражения</span><span class="sxs-lookup"><span data-stu-id="67a66-185">Security Issues in Reflection Emit</span></span>](security-issues-in-reflection-emit.md)
- [<span data-ttu-id="67a66-186">Просмотр сведений о типах</span><span class="sxs-lookup"><span data-stu-id="67a66-186">Viewing Type Information</span></span>](viewing-type-information.md)
- [<span data-ttu-id="67a66-187">Применение атрибутов</span><span class="sxs-lookup"><span data-stu-id="67a66-187">Applying Attributes</span></span>](../../standard/attributes/applying-attributes.md)
- [<span data-ttu-id="67a66-188">Доступ к пользовательским атрибутам</span><span class="sxs-lookup"><span data-stu-id="67a66-188">Accessing Custom Attributes</span></span>](accessing-custom-attributes.md)
