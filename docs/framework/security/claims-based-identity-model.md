---
title: Модель удостоверений, основанных на утверждениях
ms.date: 03/30/2017
ms.assetid: 4a96a9af-d980-43be-bf91-341a23401431
author: BrucePerlerMS
ms.openlocfilehash: 3313b2ad36260415d0ac505e01523dd999f85424
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61792827"
---
# <a name="claims-based-identity-model"></a>Модель удостоверений, основанных на утверждениях
При создании приложения, поддерживающего утверждения, удостоверение пользователя представлено в данном приложении в виде набора утверждений. Одно утверждение может быть имя пользователя, другой может быть адрес электронной почты. Основная идея заключается в настройке внешней системы удостоверений таким образом, чтобы она предоставляла приложению всю необходимую информацию о пользователе при каждом его запросе с криптографическим подтверждением того, что полученные данные удостоверения поступили из надежного источника.  
  
 Эта модель значительно упрощает процесс единого входа, а ваши приложения больше не несут ответственности за выполнение следующих задач:  
  
- Аутентификация пользователей.  
  
- Сохранение учетных записей и паролей пользователей.  
  
- Поиск сведений об удостоверении пользователя в корпоративных каталогах.  
  
- Интеграция с системами удостоверений других платформ или компаний.  
  
 Согласно этой модели приложение принимает решения, связанные с удостоверениями, на основе утверждений, предоставленных системой, которая выполнила аутентификацию пользователя. Решение может быть любым: от простой персонализации приложения путем добавления имени пользователя до предоставления пользователю авторизации для доступа к более ценным функциям и ресурсам приложения.  
  
 В данном разделе содержатся следующие сведения:  
  
- [Вводные сведения об удостоверениях на основе утверждений](../../../docs/framework/security/claims-based-identity-model.md#BKMK_1)  
  
- [Базовый сценарий для модели удостоверений на основе утверждений](../../../docs/framework/security/claims-based-identity-model.md#BKMK_2)  
  
<a name="BKMK_1"></a>   
## <a name="introduction-to-claims-based-identity"></a>Вводные сведения об удостоверениях на основе утверждений  
 Следующие термины и понятия помогут вам разобраться в новой архитектуре удостоверений.  
  
### <a name="identity"></a>идентификации  
 Для описания модели программирования, используемой в Windows Identity Foundation (WIF), мы будем использовать термин "удостоверение", представляющий набор атрибутов, описывающий пользователя или другую сущность в системе, которую требуется защитить.  
  
### <a name="claim"></a>Утверждение  
 Например, утверждение, что фрагмент данных идентификации, такие как имя, адрес электронной почты, возраст, членство в роли Sales. Чем больше утверждений получит приложение, тем больше вы узнаете о пользователе. Возможно, вам неясно, почему такие данные названы "утверждениями", а не "атрибутами", как их обычно называют в описаниях корпоративных каталогов. Этот термин был выбран в связи с методом предоставления соответствующих данных. Согласно этой модели приложение не ищет атрибуты пользователя в каталоге. Вместо этого пользователь предоставляет приложению утверждения, а приложение их исследует. Каждое утверждение создает поставщик, поэтому утверждению следует доверять только в той степени, в которой вы доверяете поставщику. Например, утверждение, созданное контроллером домена вашей компании, больше заслуживает доверия, чем утверждение, созданное самим пользователем. WIF представляет утверждения типа <xref:System.Security.Claims.Claim>, которые обладают свойством <xref:System.Security.Claims.Claim.Issuer%2A>, позволяющим определить, кто создал утверждение.  
  
### <a name="security-token"></a>Токен безопасности  
 Пользователь предоставляет приложению набор утверждений наряду с запросом. В веб-службе эти утверждения заносятся в заголовок безопасности конверта SOAP. В веб-приложении на основе браузера утверждения поступают посредством HTTP POST из браузера пользователя, а затем могут быть кэшированы в файле Cookie, если требуется сеанс. Независимо от способа доставки утверждения могут быть сериализованы. На этом этапе в процесс добавляются токены безопасности. Токен безопасности — это сериализированный набор утверждений, который центр выдачи снабдил цифровой сигнатурой. Сигнатура имеет существенное значение: она гарантирует, что пользователь не просто создал ряд утверждений и направил их вам. При низком уровне безопасности, когда криптография не является обязательной или желательной, можно использовать неподписанные токены, однако в этом разделе данный сценарий не приводится.  
  
 Одной из ключевых функций WIF является возможность создавать и считывать токены безопасности. WIF и .NET Framework обрабатывают все криптографические данные и предоставляют вам приложение с набором утверждений, которые вы можете прочесть.  
  
### <a name="issuing-authority"></a>Центр выдачи  
 Существует множество различных типов центров выдачи, от контроллеров доменов, оформляющих квитанции Kerberos, до центров сертификации, оформляющих сертификаты X.509. Однако центр выдачи, представленный в данном разделе, оформляет токены безопасности, содержащие утверждения. Этим центром выдачи является веб-приложение или веб-служба, которой известен способ создания токенов безопасности. Она должна обладать достаточным объемом данных, чтобы создавать утверждения, соответствующие целевой проверяющей стороне и пользователю, отправившему запрос; а также нести ответственность за взаимодействие с хранилищами пользователей для поиска утверждений и аутентификации самих пользователей.  
  
 Любой выбранный центр выдачи играет основную роль в решении для удостоверений. Если вы полагаетесь на утверждения, исключая аутентификацию из задач, выполняемых приложением, вы передаете ответственность за выполнение данной задачи центру выдачи и запрашиваете у него аутентификацию пользователей от вашего имени.  
  
### <a name="security-token-service-sts"></a>Служба маркеров безопасности (STS)  
 Служба токенов безопасности (STS) — это компонент службы, который создает, подписывает и оформляет токены безопасности по протоколам WS-Trust и WS-Federation. Внедрение этих протоколов требует значительной работы, однако WIF проделает ее за вас. Благодаря этому вам будет несложно обеспечить работоспособность STS, даже если вы не являетесь специалистом по этим протоколам. Можно использовать предварительно созданную службу STS, например [службы федерации Active Directory® (AD FS) 2.0](https://go.microsoft.com/fwlink/?LinkID=247516), облачную службу STS, например [службу управления доступом (ACS) Microsoft Azure](https://go.microsoft.com/fwlink/?LinkID=247517); если же вы хотите создавать настраиваемые токены или выполнять настраиваемую проверку подлинности или авторизацию, у вас есть возможность создать собственную настраиваемую службу STS с помощью WIF. WIF упрощает процесс создания собственной службы STS.  
  
### <a name="relying-party-application"></a>Приложение проверяющей стороны  
 При создании приложения, доверяющего утверждениям, вы создаете приложение проверяющей стороны. Приложение проверяющей стороны также называют "приложением, поддерживающим утверждения" или "приложением на основе утверждений". Проверяющими сторонами могут быть и веб-приложения, и веб-службы. Приложение STS использует токены, созданные службой STS, и извлекает из них утверждения, необходимые ему для выполнения задач, связанных с удостоверениями. WIF предлагает функциональные возможности, помогающие создавать приложения проверяющей стороны.  
  
### <a name="standards"></a>Стандарты  
 Чтобы обеспечить совместимость всех этих компонентов, в предыдущем сценарии используются некоторые стандарты WS-*. Политика извлекается при помощи стандарта WS-MetadataExchange, а структурируется в соответствии со спецификацией WS-Policy. Служба STS представляет конечные точки, реализующие спецификацию WS-Trust, в которой описаны принципы запроса и получения токенов безопасности. Большинство современных служб STS используют токены, отформатированные с помощью языка Security Assertion Markup Langauge (SAML). SAML — это отраслевой словарь XML, который можно использовать для представления утверждений в пригодной для взаимодействия форме. Или, при наличии нескольких платформ, данный язык предоставит вам возможность обмениваться данными со службой STS на совершенно другой платформе, а также обеспечит единый вход во все ваши приложения вне зависимости от платформы.  
  
### <a name="browser-based-applications"></a>Приложения на основе браузера  
 Модель удостоверений на основе утверждений могут применять не только интеллектуальные клиенты. Ее также могут использовать приложения на основе браузера (также называемые пассивными клиентами). Представленный ниже сценарий иллюстрирует принципы работы данной модели.  
  
 Сначала пользователь указывает браузер в качестве веб-приложения, поддерживающего утверждения (приложения проверяющей стороны). Веб-приложение перенаправляет браузер в службу STS для аутентификации пользователя. STS размещается в простом веб-приложении, которое считывает входящие запросы, выполняет аутентификацию пользователя при помощи стандартных механизмов HTTP, а затем создает токен SAML и отвечает фрагментом кода JavaScript, благодаря которому браузер инициирует HTTP POST, передающий токен SAML обратно в приложение проверяющей стороны. Текст данного POST содержит утверждения, которые запросила проверяющая сторона. На этом этапе приложение проверяющей стороны, как правило, инкапсулирует утверждения в файл Cookie, чтобы пользователя не нужно было перенаправлять для каждого запроса.  
  
<a name="BKMK_2"></a>   
## <a name="basic-scenario-for-a-claims-based-identity-model"></a>Базовый сценарий для модели удостоверения на основе утверждений  
 Ниже показан пример системы на основе утверждений.  
  
 ![Поток аутентификации с проверяющей стороной](../../../docs/framework/security/media/conc-relying-partner-processc.png "conc_relying_partner_processc")  
  
 На этой схеме представлен веб-сайт (приложение проверяющей стороны), настроенный для применения WIF в целях аутентификации, а также клиент, веб-браузер, желающий использовать данный сайт.  
  
1. Когда не прошедший проверку пользователь запрашивает страницу, свой браузер перенаправляется на страницах identity provider (IdP).  
  
2. Поставщик удостоверений требуется пользователь должен предоставить свои учетные данные, такие как имя пользователя и пароль или проверки подлинности Kerberos.  
  
3. Проблемы поставщика удостоверений, маркер снова возвращается в браузер.  
  
4. После этого браузер перенаправляется обратно на исходную запрошенную страницу, на которой WIF определяет, соответствует ли токен условиям доступа к данной странице. Если для создания сеанса выводится файл Cookie, аутентификацию необходимо пройти только один раз, а затем контроль передается приложению.
