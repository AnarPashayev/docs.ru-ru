---
title: Трассировка и инструментирование приложений
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- tracing [.NET Framework]
- debugging [.NET Framework], instrumentation
- performance monitoring, instrumentation
- instrumentation, about instrumentation
- tracing [.NET Framework], about tracing
- performance monitoring, tracing code
- Trace class, instrumentation for .NET applications
ms.assetid: 773b6fc4-9013-4322-b728-5dec7a72e743
ms.openlocfilehash: 2dcdbaf50ed053d43fc2df2c80fe7688e7b3e51f
ms.sourcegitcommit: 771c554c84ba38cbd4ac0578324ec4cfc979cf2e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/21/2020
ms.locfileid: "77542615"
---
# <a name="tracing-and-instrumenting-applications"></a><span data-ttu-id="7aa24-102">Трассировка и инструментирование приложений</span><span class="sxs-lookup"><span data-stu-id="7aa24-102">Tracing and Instrumenting Applications</span></span>
<span data-ttu-id="7aa24-103">Трассировка — это мониторинг выполнения запущенного приложения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-103">Tracing is a way for you to monitor the execution of your application while it is running.</span></span> <span data-ttu-id="7aa24-104">Вы можете добавить инструментирование трассировки и отладки в свое приложения .NET Framework при его разработке; кроме того, вы можете использовать это инструментирование при разработке приложения и после его развертывания.</span><span class="sxs-lookup"><span data-stu-id="7aa24-104">You can add tracing and debugging instrumentation to your .NET Framework application when you develop it, and you can use that instrumentation both while you are developing the application and after you have deployed it.</span></span> <span data-ttu-id="7aa24-105">С помощью классов <xref:System.Diagnostics.Trace?displayProperty=nameWithType>, <xref:System.Diagnostics.Debug?displayProperty=nameWithType> и <xref:System.Diagnostics.TraceSource?displayProperty=nameWithType> можно записывать сведения об ошибках и выполнении приложения в журналы, текстовые файлы или на другие устройства для последующего анализа.</span><span class="sxs-lookup"><span data-stu-id="7aa24-105">You can use the <xref:System.Diagnostics.Trace?displayProperty=nameWithType>, <xref:System.Diagnostics.Debug?displayProperty=nameWithType>, and <xref:System.Diagnostics.TraceSource?displayProperty=nameWithType> classes to record information about errors and application execution in logs, text files, or other devices for later analysis.</span></span>  
  
 <span data-ttu-id="7aa24-106">Термин *инструментирование* относится к возможности мониторинга и измерения уровня производительности продукта и диагностики ошибок.</span><span class="sxs-lookup"><span data-stu-id="7aa24-106">The term *instrumentation* refers to an ability to monitor or measure the level of a product's performance and to diagnose errors.</span></span> <span data-ttu-id="7aa24-107">В программировании это означает способность приложения включать следующие возможности.</span><span class="sxs-lookup"><span data-stu-id="7aa24-107">In programming, this means the ability of an application to incorporate:</span></span>  
  
- <span data-ttu-id="7aa24-108">**Трассировка кода** — получение информационных сообщений о работе приложения во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-108">**Code tracing** - Receiving informative messages about the execution of an application at run time.</span></span>  
  
- <span data-ttu-id="7aa24-109">**Отладка** — отслеживание и устранение ошибок программирования в приложении при разработке.</span><span class="sxs-lookup"><span data-stu-id="7aa24-109">**Debugging** - Tracking down and fixing programming errors in an application under development.</span></span> <span data-ttu-id="7aa24-110">Дополнительные сведения см. в разделе [Отладка](/visualstudio/debugger/debugger-feature-tour).</span><span class="sxs-lookup"><span data-stu-id="7aa24-110">For more information, see [Debugging](/visualstudio/debugger/debugger-feature-tour).</span></span>  
  
- <span data-ttu-id="7aa24-111">**Счетчики производительности** — компоненты, позволяющие отслеживать производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-111">**Performance counters** - Components that allow you to track the performance of your application.</span></span> <span data-ttu-id="7aa24-112">Дополнительные сведения см. в статье [Performance Counters](performance-counters.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-112">For more information, see [Performance Counters](performance-counters.md).</span></span>  
  
- <span data-ttu-id="7aa24-113">**Журналы событий** — компоненты, позволяющие получать и отслеживать основные события при выполнении приложения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-113">**Event logs** - Components that allow you receive and track major events in the execution of your application.</span></span> <span data-ttu-id="7aa24-114">Дополнительную информацию смотрите в классе <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="7aa24-114">For more information, see the <xref:System.Diagnostics.EventLog> class.</span></span>  
  
 <span data-ttu-id="7aa24-115">Инструментирование приложения путем добавления операторов трассировки в стратегически важных местах кода особенно полезно для распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="7aa24-115">Instrumenting your application by placing trace statements at strategic locations in your code is especially useful for distributed applications.</span></span> <span data-ttu-id="7aa24-116">С помощью операторов трассировки можно инструментировать приложение не только для отображения сведений о неправильных моментах, но также отслеживать, насколько хорошо работает приложение.</span><span class="sxs-lookup"><span data-stu-id="7aa24-116">By using trace statements you can instrument an application not only to display information when things go wrong, but also to monitor how well the application is performing.</span></span>  
  
 <span data-ttu-id="7aa24-117">Класс <xref:System.Diagnostics.TraceSource> предоставляет улучшенные функции трассировки и может использоваться вместо статических методов более старых классов трассировки <xref:System.Diagnostics.Trace> и <xref:System.Diagnostics.Debug>.</span><span class="sxs-lookup"><span data-stu-id="7aa24-117">The <xref:System.Diagnostics.TraceSource> class provides enhanced tracing features and can be used in place of the static methods of the older <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> tracing classes.</span></span> <span data-ttu-id="7aa24-118">Знакомые классы <xref:System.Diagnostics.Trace> и <xref:System.Diagnostics.Debug> по-прежнему широко используются, однако рекомендуется использовать класс <xref:System.Diagnostics.TraceSource> для новых команд трассировки, таких как <xref:System.Diagnostics.TraceSource.TraceEvent%2A> и <xref:System.Diagnostics.TraceSource.TraceData%2A>.</span><span class="sxs-lookup"><span data-stu-id="7aa24-118">The familiar <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes are still widely used, but the <xref:System.Diagnostics.TraceSource> class is recommended for new tracing commands, such as <xref:System.Diagnostics.TraceSource.TraceEvent%2A> and <xref:System.Diagnostics.TraceSource.TraceData%2A>.</span></span>  
  
 <span data-ttu-id="7aa24-119">Классы <xref:System.Diagnostics.Trace> и <xref:System.Diagnostics.Debug> идентичны, за исключением того, что процедуры и функции класса <xref:System.Diagnostics.Trace> по умолчанию компилируются в сборки выпуска, а процедуры и функции класса <xref:System.Diagnostics.Debug> — нет.</span><span class="sxs-lookup"><span data-stu-id="7aa24-119">The <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes are identical, except that procedures and functions of the <xref:System.Diagnostics.Trace> class are compiled by default into release builds, but those of the <xref:System.Diagnostics.Debug> class are not.</span></span>  
  
 <span data-ttu-id="7aa24-120">Классы <xref:System.Diagnostics.Trace> и <xref:System.Diagnostics.Debug> предоставляют средства для мониторинга и исследования производительности приложения как во время разработки, так и после развертывания.</span><span class="sxs-lookup"><span data-stu-id="7aa24-120">The <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes provide the means to monitor and examine application performance either during development or after deployment.</span></span> <span data-ttu-id="7aa24-121">Например, возможно использование класса <xref:System.Diagnostics.Trace> для отслеживания в развернутом приложении отдельных типов действий по мере их выполнения (например, создание новых подключений к базе данных) и последующего мониторинга производительности приложения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-121">For example, you can use the <xref:System.Diagnostics.Trace> class to track particular types of actions in a deployed application as they occur (for example, creation of new database connections), and can therefore monitor the application's efficiency.</span></span>  
  
## <a name="code-tracing-and-debugging"></a><span data-ttu-id="7aa24-122">Отладка и трассировка кода</span><span class="sxs-lookup"><span data-stu-id="7aa24-122">Code Tracing and Debugging</span></span>  
 <span data-ttu-id="7aa24-123">Использование методов вывода класса <xref:System.Diagnostics.Debug> при разработке приложения позволяет отображать сообщения в окне вывода, доступном в интегрированной среде разработки Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7aa24-123">During development, you can use the output methods of the <xref:System.Diagnostics.Debug> class to display messages in the Output window of the Visual Studio integrated development environment (IDE).</span></span> <span data-ttu-id="7aa24-124">Пример:</span><span class="sxs-lookup"><span data-stu-id="7aa24-124">For example:</span></span>  
  
```vb  
Trace.WriteLine("Hello World!")  
Debug.WriteLine("Hello World!")  
```  
  
```csharp  
System.Diagnostics.Trace.WriteLine("Hello World!");  
System.Diagnostics.Debug.WriteLine("Hello World!");  
```  
  
 <span data-ttu-id="7aa24-125">В каждом из этих примеров в окне вывода будет отображаться сообщение "Hello World!"</span><span class="sxs-lookup"><span data-stu-id="7aa24-125">Each of these examples will display "Hello World!"</span></span> <span data-ttu-id="7aa24-126">при запуске приложения в отладчике.</span><span class="sxs-lookup"><span data-stu-id="7aa24-126">in the Output window when the application is run in the debugger.</span></span>  
  
 <span data-ttu-id="7aa24-127">Это позволяет отлаживать приложения и оптимизировать их производительность на основе их поведения в среде тестирования.</span><span class="sxs-lookup"><span data-stu-id="7aa24-127">This enables you to debug your applications and optimize their performance based on their behavior in your test environment.</span></span> <span data-ttu-id="7aa24-128">Возможна отладка приложения при отладочном построении с включенным условным атрибутом <xref:System.Diagnostics.Debug>, что позволяет получать все выходные данные отладки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-128">You can debug your application in your debug build with the <xref:System.Diagnostics.Debug> conditional attribute turned on so that you receive all debugging output.</span></span> <span data-ttu-id="7aa24-129">Когда приложение будет готово к выпуску, можно скомпилировать построение выпуска, не включая условный атрибут <xref:System.Diagnostics.Debug>, чтобы код отладки не включался компилятором в конечный исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="7aa24-129">When your application is ready for release, you can compile your release build without turning on the <xref:System.Diagnostics.Debug> conditional attribute, so that the compiler will not include your debugging code in the final executable.</span></span> <span data-ttu-id="7aa24-130">Дополнительные сведения см. в разделе [Практическое руководство. Условная компиляция с использованием атрибутов Trace и Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-130">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span> <span data-ttu-id="7aa24-131">Дополнительные сведения о различных конфигурациях сборок для приложения см. в разделе [Компиляция и сборка](/visualstudio/ide/compiling-and-building-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="7aa24-131">For more information on different build configurations for your application, see [Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio).</span></span>  
  
 <span data-ttu-id="7aa24-132">С помощью методов класса <xref:System.Diagnostics.Trace> можно отслеживать выполнение кода в установленном приложении.</span><span class="sxs-lookup"><span data-stu-id="7aa24-132">You can also trace code execution in an installed application, using methods of the <xref:System.Diagnostics.Trace> class.</span></span> <span data-ttu-id="7aa24-133">Процессом и масштабом трассировки можно управлять. Для этого добавьте в код [переключатели трассировки](trace-switches.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-133">By placing [Trace Switches](trace-switches.md) in your code, you can control whether tracing occurs and how extensive it is.</span></span> <span data-ttu-id="7aa24-134">Так вы сможете отслеживать состояние приложения в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="7aa24-134">This lets you monitor the status of your application in a production environment.</span></span> <span data-ttu-id="7aa24-135">Это особенно важно в бизнес-приложениях, которые используют различные компоненты, выполняющиеся на нескольких компьютерах.</span><span class="sxs-lookup"><span data-stu-id="7aa24-135">This is especially important in a business application that uses multiple components running on multiple computers.</span></span> <span data-ttu-id="7aa24-136">Вы можете управлять порядком использования переключателей после развертывания с помощью файла конфигурации.</span><span class="sxs-lookup"><span data-stu-id="7aa24-136">You can control how the switches are used after deployment through the configuration file.</span></span> <span data-ttu-id="7aa24-137">Дополнительные сведения см. в разделе [Практическое руководство. Создание, инициализация и настройка переключателей трассировки](how-to-create-initialize-and-configure-trace-switches.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-137">For more information, see [How to: Create, Initialize and Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
 <span data-ttu-id="7aa24-138">При разработке приложения, для которого предполагается использовать трассировку, в код приложения обычно включают сообщения трассировки и отладки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-138">When you are developing an application for which you intend to use tracing, you usually include both tracing and debugging messages in the application code.</span></span> <span data-ttu-id="7aa24-139">Когда все будет готово для развертывания приложения, можно скомпилировать сборку выпуска без включения условного атрибута **Debug**.</span><span class="sxs-lookup"><span data-stu-id="7aa24-139">When you are ready to deploy the application, you can compile your release build without turning on the **Debug** conditional attribute.</span></span> <span data-ttu-id="7aa24-140">Тем не менее можно включить условный атрибут **Trace**, чтобы компилятор включил код трассировки в исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="7aa24-140">However, you can turn on the **Trace** conditional attribute so that the compiler includes your trace code in the executable.</span></span> <span data-ttu-id="7aa24-141">Дополнительные сведения см. в разделе [Практическое руководство. Условная компиляция с использованием атрибутов Trace и Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-141">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span>  
  
### <a name="phases-of-code-tracing"></a><span data-ttu-id="7aa24-142">Этапы трассировки кода</span><span class="sxs-lookup"><span data-stu-id="7aa24-142">Phases of Code Tracing</span></span>  
 <span data-ttu-id="7aa24-143">Существует три этапа трассировки кода.</span><span class="sxs-lookup"><span data-stu-id="7aa24-143">There are three phases of code tracing:</span></span>  
  
1. <span data-ttu-id="7aa24-144">**Инструментирование** — добавление кода трассировки в приложение.</span><span class="sxs-lookup"><span data-stu-id="7aa24-144">**Instrumentation** — you add trace code to your application.</span></span>  
  
2. <span data-ttu-id="7aa24-145">**Трассировка** — код трассировки записывает сведения в указанный целевой объект.</span><span class="sxs-lookup"><span data-stu-id="7aa24-145">**Tracing** — the tracing code writes information to the specified target.</span></span>  
  
3. <span data-ttu-id="7aa24-146">**Анализ** — оценка сведений трассировки для определения и понимания проблем в приложении.</span><span class="sxs-lookup"><span data-stu-id="7aa24-146">**Analysis** — you evaluate the tracing information to identify and understand problems in the application.</span></span>  
  
 <span data-ttu-id="7aa24-147">Во время разработки все методы вывода трассировки и отладки записывают сведения в окне вывода Visual Studio по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="7aa24-147">During development, all debug and trace output methods write information to the Output window in Visual Studio by default.</span></span> <span data-ttu-id="7aa24-148">В развернутом приложении эти методы записывают сведения трассировки в указанные целевые объекты.</span><span class="sxs-lookup"><span data-stu-id="7aa24-148">In a deployed application, the methods write tracing information to the targets you specify.</span></span> <span data-ttu-id="7aa24-149">Дополнительные сведения об указании целевого объекта выходных данных трассировки и отладки см. в разделе [Прослушиватели трассировки](trace-listeners.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-149">For more information on specifying an output target for tracing or debugging, see [Trace Listeners](trace-listeners.md).</span></span>  
  
 <span data-ttu-id="7aa24-150">Ниже приведен полный обзор основных шагов, обычно выполняемых при использовании трассировки для анализа и исправления возможных проблем в развертываемом приложении.</span><span class="sxs-lookup"><span data-stu-id="7aa24-150">The following is an overall view of the major steps typically involved in using tracing to analyze and correct potential problems in deployed applications.</span></span> <span data-ttu-id="7aa24-151">Дополнительные сведения о выполнении этих шагов см. по соответствующей ссылке.</span><span class="sxs-lookup"><span data-stu-id="7aa24-151">For more information on how to perform these steps, see the appropriate link.</span></span>  
  
##### <a name="to-use-tracing-in-an-application"></a><span data-ttu-id="7aa24-152">Использование трассировки в приложении</span><span class="sxs-lookup"><span data-stu-id="7aa24-152">To use tracing in an application</span></span>  
  
1. <span data-ttu-id="7aa24-153">Обдумайте, какие выходные данные трассировки вы хотите получить на месте после развертывания приложения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-153">Consider which tracing output you will want to receive onsite after you have deployed the application.</span></span>  
  
2. <span data-ttu-id="7aa24-154">Создайте набора переключателей.</span><span class="sxs-lookup"><span data-stu-id="7aa24-154">Create a set of switches.</span></span> <span data-ttu-id="7aa24-155">Дополнительные сведения см. в статье [How to: Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md) (Настройка переключателей трассировки).</span><span class="sxs-lookup"><span data-stu-id="7aa24-155">For more information, see [How to: Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
3. <span data-ttu-id="7aa24-156">Добавьте операторы трассировки в код приложения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-156">Add the trace statements to the application code.</span></span>  
  
4. <span data-ttu-id="7aa24-157">Определите, где вы хотите получать выходные данные трассировки, и добавьте соответствующие прослушиватели.</span><span class="sxs-lookup"><span data-stu-id="7aa24-157">Determine where you want the tracing output to appear and add the appropriate listeners.</span></span> <span data-ttu-id="7aa24-158">Дополнительные сведения см. в разделе [Создание и инициализация прослушивателей трассировки](how-to-create-and-initialize-trace-listeners.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-158">For more information, see [Creating and Initializing Trace Listeners](how-to-create-and-initialize-trace-listeners.md).</span></span>  
  
5. <span data-ttu-id="7aa24-159">Выполните тестирование и отладку своего приложения и содержащегося в нем кода трассировки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-159">Test and debug your application and the tracing code it contains.</span></span>  
  
6. <span data-ttu-id="7aa24-160">Скомпилируйте приложение в исполняемый код с помощью одной из следующих процедур.</span><span class="sxs-lookup"><span data-stu-id="7aa24-160">Compile the application into executable code using one of the following procedures:</span></span>  
  
    - <span data-ttu-id="7aa24-161">Используйте меню **Сборка** со страницей **Отладка** диалогового окна **Страницы свойств** в **обозревателе решений**.</span><span class="sxs-lookup"><span data-stu-id="7aa24-161">Use the **Build** menu along with the **Debug** page of the **Property Pages** dialog box in **Solution Explorer**.</span></span> <span data-ttu-id="7aa24-162">Используйте эту процедуру при компиляции в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7aa24-162">Use this when compiling in Visual Studio.</span></span>  
  
         <span data-ttu-id="7aa24-163">\- или -</span><span class="sxs-lookup"><span data-stu-id="7aa24-163">\- or -</span></span>  
  
    - <span data-ttu-id="7aa24-164">Используйте директивы компилятора **Trace** и **Debug** для компиляции из командной строки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-164">Use the **Trace** and **Debug** compiler directives for the command-line method of compiling.</span></span> <span data-ttu-id="7aa24-165">Дополнительные сведения см. в разделе [Условная компиляция с использованием атрибутов Trace и Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-165">For more information, see [Compiling Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span> <span data-ttu-id="7aa24-166">Используйте эту процедуру при компиляции из командной строки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-166">Use this when compiling from the command line.</span></span>  
  
7. <span data-ttu-id="7aa24-167">Если во время выполнения возникает проблема, включите соответствующий переключатель трассировки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-167">If a problem occurs during run time, turn on the appropriate trace switch.</span></span> <span data-ttu-id="7aa24-168">Дополнительные сведения см. в разделе [Настройка переключателей трассировки](how-to-create-initialize-and-configure-trace-switches.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-168">For more information, see [Configuring Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
     <span data-ttu-id="7aa24-169">Код трассировки записывает сообщения трассировки в указанный целевой объект, например в экран, текстовый файл или журнал событий.</span><span class="sxs-lookup"><span data-stu-id="7aa24-169">The tracing code writes tracing messages to a specified target, for example, a screen, a text file, or an event log.</span></span> <span data-ttu-id="7aa24-170">Целевой объект определяется типом прослушивателя, который вы включили в коллекцию <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="7aa24-170">The type of listener you included in the <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> collection determines the target.</span></span>  
  
8. <span data-ttu-id="7aa24-171">Проанализируйте сообщения трассировки, чтобы обнаружить и понять проблемы в приложении.</span><span class="sxs-lookup"><span data-stu-id="7aa24-171">Analyze the tracing messages to identify and understand the problem in the application.</span></span>  
  
## <a name="trace-instrumentation-and-distributed-applications"></a><span data-ttu-id="7aa24-172">Инструментирование трассировки и распределенные приложения</span><span class="sxs-lookup"><span data-stu-id="7aa24-172">Trace Instrumentation and Distributed Applications</span></span>  
 <span data-ttu-id="7aa24-173">При создании распределенного приложения тестирование приложения способом, которым оно будет использоваться, может показаться сложной задачей.</span><span class="sxs-lookup"><span data-stu-id="7aa24-173">When you create a distributed application, you might find it difficult to test the application in the manner in which it will be used.</span></span> <span data-ttu-id="7aa24-174">Немногие группы разработчиков имеют возможность протестировать все возможные сочетания операционных систем или веб-браузеров (в том числе все параметры локализованных версий) или смоделировать большое число пользователей, которые будут обращаться к приложению одновременно.</span><span class="sxs-lookup"><span data-stu-id="7aa24-174">Few development teams have the capability to test all possible combinations of operating systems or Web browsers (including all the localized language options), or to simulate the high number of users that will access the application at the same time.</span></span> <span data-ttu-id="7aa24-175">В таких обстоятельствах невозможно протестировать реакцию распределенного приложения на большую нагрузку, различные настройки и разные действия конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="7aa24-175">Under these circumstances, you cannot test how a distributed application will respond to high volumes, different setups, and unique end-user behaviors.</span></span> <span data-ttu-id="7aa24-176">Кроме того, многие компоненты распределенного приложения не имеют пользовательского интерфейса, с которым можно взаимодействовать напрямую или просматривать активность этих компонентов.</span><span class="sxs-lookup"><span data-stu-id="7aa24-176">Also, many parts of a distributed application have no user interface with which you can interact directly or view the activity of those parts.</span></span>  
  
 <span data-ttu-id="7aa24-177">Однако вы можете компенсировать это, позволив распределенным приложениям описывать определенные события, интересующие системных администраторов, особенно то, что работает неправильно, путем *инструментирования* приложения, то есть путем размещения операторов трассировки в стратегически важных местах кода.</span><span class="sxs-lookup"><span data-stu-id="7aa24-177">However, you can compensate for this by enabling distributed applications to describe certain events of interest to system administrators, especially things that go wrong, by *instrumenting* the application — that is, by placing trace statements at strategic locations in your code.</span></span> <span data-ttu-id="7aa24-178">Затем, если во время выполнения произойдет что-либо неожиданное (например, слишком большое время отклика), можно будет определить вероятную причину.</span><span class="sxs-lookup"><span data-stu-id="7aa24-178">Then if something unexpected occurs at run time (for example, excessively slow response time), you can determine the likely cause.</span></span>  
  
 <span data-ttu-id="7aa24-179">Операторы трассировки помогают избежать сложностей проверки исходного кода, его изменения, перекомпиляции, а также попыток воспроизвести ошибку времени выполнения в среде отладки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-179">With trace statements you can avoid the difficult task of examining the original source code, modifying it, recompiling, and attempting to produce the run-time error within the debugging environment.</span></span> <span data-ttu-id="7aa24-180">Помните, что можно инструментировать приложение не только для отображения ошибок, но также для наблюдения за производительностью.</span><span class="sxs-lookup"><span data-stu-id="7aa24-180">Remember that you can instrument an application not only to display errors, but also to monitor performance.</span></span>  
  
## <a name="strategic-placement-of-trace-statements"></a><span data-ttu-id="7aa24-181">Стратегическое размещение операторов трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-181">Strategic Placement of Trace Statements</span></span>  
 <span data-ttu-id="7aa24-182">Необходимо уделить особое внимание при добавлении инструкций trace, которые будут использованы во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-182">You must exercise special care when placing your trace statements for use during run time.</span></span> <span data-ttu-id="7aa24-183">Необходимо учитывать, какие данные трассировки потребуются в развернутом приложении, чтобы охватить все вероятные сценарии трассировки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-183">You must consider what tracing information is likely to be needed in a deployed application, so that all likely tracing scenarios are adequately covered.</span></span> <span data-ttu-id="7aa24-184">Поскольку очень широкий круг приложений может использовать трассировку, общих рекомендаций для стратегического размещения трассировки не существует.</span><span class="sxs-lookup"><span data-stu-id="7aa24-184">Because applications that use tracing vary widely, however, there are no general guidelines for strategic placement of tracing.</span></span> <span data-ttu-id="7aa24-185">Дополнительные сведения о размещении операторов трассировки см. в разделе [Практическое руководство. Добавление операторов трассировки в код приложения](how-to-add-trace-statements-to-application-code.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-185">For more information on placing trace statements, see [How to: Add Trace Statements to Application Code](how-to-add-trace-statements-to-application-code.md).</span></span>  
  
## <a name="output-from-tracing"></a><span data-ttu-id="7aa24-186">Выходные данные трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-186">Output from Tracing</span></span>  
 <span data-ttu-id="7aa24-187">Выходные данные трассировки собираются объектами, которые называются *прослушивателями*.</span><span class="sxs-lookup"><span data-stu-id="7aa24-187">Trace output is collected by objects called *listeners*.</span></span> <span data-ttu-id="7aa24-188">Прослушиватель — это объект, который принимает выходные данные трассировки и записывает их в устройство вывода (обычно это окно, журнал или текстовый файл).</span><span class="sxs-lookup"><span data-stu-id="7aa24-188">A listener is an object that receives trace output and writes it to an output device (usually a window, log, or text file).</span></span> <span data-ttu-id="7aa24-189">При создании прослушиватель трассировки, как правило, добавляется к коллекции <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType>, что позволяет ему получать все выходные данные трассировки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-189">When a trace listener is created, it is typically added to the <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> collection, allowing the listener to receive all trace output.</span></span>  
  
 <span data-ttu-id="7aa24-190">Сведения трассировки всегда записываются как минимум в целевой объект вывода <xref:System.Diagnostics.Trace> по умолчанию, <xref:System.Diagnostics.DefaultTraceListener>.</span><span class="sxs-lookup"><span data-stu-id="7aa24-190">Tracing information is always written at least to the default <xref:System.Diagnostics.Trace> output target, the <xref:System.Diagnostics.DefaultTraceListener>.</span></span> <span data-ttu-id="7aa24-191">Если по каким-то причинам объект <xref:System.Diagnostics.DefaultTraceListener> был удален, а другие прослушиватели не были добавлены в коллекцию <xref:System.Diagnostics.Trace.Listeners%2A>, сообщения трассировки получены не будут.</span><span class="sxs-lookup"><span data-stu-id="7aa24-191">If for some reason you have deleted the <xref:System.Diagnostics.DefaultTraceListener> without adding any other listeners to the <xref:System.Diagnostics.Trace.Listeners%2A> collection, you will not receive any tracing messages.</span></span> <span data-ttu-id="7aa24-192">Дополнительные сведения см. в разделе [Прослушиватели трассировки](trace-listeners.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-192">For more information, see [Trace Listeners](trace-listeners.md).</span></span>  
  
 <span data-ttu-id="7aa24-193">В следующей таблице перечислены шесть членов класса <xref:System.Diagnostics.Debug> и методов класса <xref:System.Diagnostics.Trace>, которые записывают сведения трассировки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-193">The six <xref:System.Diagnostics.Debug> members and <xref:System.Diagnostics.Trace> methods that write tracing information are listed in the following table.</span></span>  
  
|<span data-ttu-id="7aa24-194">Метод</span><span class="sxs-lookup"><span data-stu-id="7aa24-194">Method</span></span>|<span data-ttu-id="7aa24-195">Выходные данные</span><span class="sxs-lookup"><span data-stu-id="7aa24-195">Output</span></span>|  
|------------|------------|  
|`Assert`|<span data-ttu-id="7aa24-196">Указанный текст; если ничего не указано, то стек вызовов.</span><span class="sxs-lookup"><span data-stu-id="7aa24-196">The specified text; or, if none is specified, the Call Stack.</span></span> <span data-ttu-id="7aa24-197">Выходные данные записываются только в том случае, если условие, указанное в качестве аргумента в инструкции `Assert`, имеет **значение false**.</span><span class="sxs-lookup"><span data-stu-id="7aa24-197">The output is written only if the condition specified as an argument in the `Assert` statement is **false**.</span></span>|  
|`Fail`|<span data-ttu-id="7aa24-198">Указанный текст; если ничего не указано, то стек вызовов.</span><span class="sxs-lookup"><span data-stu-id="7aa24-198">The specified text; or, if none is specified, the Call Stack.</span></span>|  
|`Write`|<span data-ttu-id="7aa24-199">Указанный текст.</span><span class="sxs-lookup"><span data-stu-id="7aa24-199">The specified text.</span></span>|  
|`WriteIf`|<span data-ttu-id="7aa24-200">Указанный текст, если выполнено условие, указанное в качестве аргумента в инструкции `WriteIf`.</span><span class="sxs-lookup"><span data-stu-id="7aa24-200">The specified text, if the condition specified as an argument in the `WriteIf` statement is satisfied.</span></span>|  
|`WriteLine`|<span data-ttu-id="7aa24-201">Заданный текст и возврат каретки.</span><span class="sxs-lookup"><span data-stu-id="7aa24-201">The specified text and a carriage return.</span></span>|  
|`WriteLineIf`|<span data-ttu-id="7aa24-202">Указанный текст и символ возврата каретки, если удовлетворяется условие, заданное в качестве аргумента в инструкции `WriteLineIf`.</span><span class="sxs-lookup"><span data-stu-id="7aa24-202">The specified text and a carriage return, if the condition specified as an argument in the `WriteLineIf` statement is satisfied.</span></span>|  
  
 <span data-ttu-id="7aa24-203">Все прослушиватели в коллекции <xref:System.Diagnostics.Trace.Listeners%2A> получают сообщения, описанные в приведенной выше таблице, но предпринимаемые ими действия зависят от вида прослушивателя, получившего сообщения.</span><span class="sxs-lookup"><span data-stu-id="7aa24-203">All listeners in the <xref:System.Diagnostics.Trace.Listeners%2A> collection receive the messages described in the above table, but the actions taken may vary depending on what kind of listener receives the message.</span></span> <span data-ttu-id="7aa24-204">Например, <xref:System.Diagnostics.DefaultTraceListener> отображает диалоговое окно утверждения при получении `Fail` или неудачного `Assert` уведомления, но <xref:System.Diagnostics.TextWriterTraceListener> просто записывает выходные данные в свой поток.</span><span class="sxs-lookup"><span data-stu-id="7aa24-204">For example, the <xref:System.Diagnostics.DefaultTraceListener> displays an assertion dialog box when it receives a `Fail` or failed `Assert` notification, but a <xref:System.Diagnostics.TextWriterTraceListener> simply writes the output to its stream.</span></span>  
  
 <span data-ttu-id="7aa24-205">Можно создавать пользовательские результаты путем реализации собственного прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="7aa24-205">You can produce custom results by implementing your own listener.</span></span> <span data-ttu-id="7aa24-206">Пользовательский прослушиватель трассировки может, например, отображать сообщения в окне сообщения или подключаться к базе данных для добавления сообщений в таблицу.</span><span class="sxs-lookup"><span data-stu-id="7aa24-206">A custom trace listener might, for example, display the messages to a message box, or connect to a database to add messages to a table.</span></span> <span data-ttu-id="7aa24-207">Все пользовательские прослушиватели должны поддерживать шесть вышеупомянутых методов.</span><span class="sxs-lookup"><span data-stu-id="7aa24-207">All custom listeners should support the six methods mentioned above.</span></span> <span data-ttu-id="7aa24-208">Дополнительные сведения о создании прослушивателей, определяемых разработчиками, см. в описании <xref:System.Diagnostics.TraceListener> в справочнике по .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7aa24-208">For more information on creating developer-defined listeners, see <xref:System.Diagnostics.TraceListener> in the .NET Framework reference.</span></span>  
  
 <span data-ttu-id="7aa24-209">Методы `Write` и `WriteLine` всегда записывают указанный текст.</span><span class="sxs-lookup"><span data-stu-id="7aa24-209">The `Write` and `WriteLine` methods always write the text that you specify.</span></span> <span data-ttu-id="7aa24-210">для `Assert`, `WriteIf`и `WriteLineIf` требуется логический аргумент, который определяет, записывает ли заданный текст. они записывают указанный текст только в том случае, если выражение имеет **значение true** (для `WriteIf` и `WriteLineIf`) или **false** (для `Assert`).</span><span class="sxs-lookup"><span data-stu-id="7aa24-210">`Assert`, `WriteIf`, and `WriteLineIf` require a Boolean argument that controls whether or not they write the specified text; they write the specified text only if the expression is **true** (for `WriteIf` and `WriteLineIf`), or **false** (for `Assert`).</span></span> <span data-ttu-id="7aa24-211">Метод `Fail` всегда записывает указанный текст.</span><span class="sxs-lookup"><span data-stu-id="7aa24-211">The `Fail` method always writes the specified text.</span></span> <span data-ttu-id="7aa24-212">Дополнительные сведения см. в разделе [Практическое руководство. Добавление операторов трассировки в код приложения](how-to-add-trace-statements-to-application-code.md) и в справочнике по .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7aa24-212">For more information, see [How to: Add Trace Statements to Application Code](how-to-add-trace-statements-to-application-code.md) and the .NET Framework reference.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="7aa24-213">Проблемы безопасности</span><span class="sxs-lookup"><span data-stu-id="7aa24-213">Security Concerns</span></span>  
 <span data-ttu-id="7aa24-214">Если не отключить трассировку и отладку перед развертыванием приложения ASP.NET, то приложение может отображать сведения о себе, которые могут использоваться вредоносными программами.</span><span class="sxs-lookup"><span data-stu-id="7aa24-214">If you do not disable tracing and debugging before deploying an ASP.NET application, your application may reveal information about itself that could be exploited by a malicious program.</span></span> <span data-ttu-id="7aa24-215">Дополнительные сведения см. в разделах [Практическое руководство. Условная компиляция с использованием атрибутов Trace и Debug](how-to-compile-conditionally-with-trace-and-debug.md), [Компиляция и сборка](/visualstudio/ide/compiling-and-building-in-visual-studio) и [Практическое руководство. Создание, инициализация и настройка переключателей трассировки](how-to-create-initialize-and-configure-trace-switches.md).</span><span class="sxs-lookup"><span data-stu-id="7aa24-215">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md), [Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio), and [How to: Create, Initialize and Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span> <span data-ttu-id="7aa24-216">Отладка также настраивается через службы IIS.</span><span class="sxs-lookup"><span data-stu-id="7aa24-216">Debugging is also configurable through Internet Information Services (IIS).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7aa24-217">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="7aa24-217">See also</span></span>

- <xref:System.Diagnostics.Trace>
- <xref:System.Diagnostics.TraceSource>
- [<span data-ttu-id="7aa24-218">Контракты для кода</span><span class="sxs-lookup"><span data-stu-id="7aa24-218">Code Contracts</span></span>](code-contracts.md)
- [<span data-ttu-id="7aa24-219">Типы проектов C#, F# и Visual Basic</span><span class="sxs-lookup"><span data-stu-id="7aa24-219">C#, F#, and Visual Basic Project Types</span></span>](/visualstudio/debugger/debugging-preparation-csharp-f-hash-and-visual-basic-project-types)
- [<span data-ttu-id="7aa24-220">Практическое руководство. Добавление операторов трассировки в код приложения</span><span class="sxs-lookup"><span data-stu-id="7aa24-220">How to: Add Trace Statements to Application Code</span></span>](how-to-add-trace-statements-to-application-code.md)
- [<span data-ttu-id="7aa24-221">Практическое руководство. Условная компиляция с использованием атрибутов Trace и Debug</span><span class="sxs-lookup"><span data-stu-id="7aa24-221">How to: Compile Conditionally with Trace and Debug</span></span>](how-to-compile-conditionally-with-trace-and-debug.md)
- [<span data-ttu-id="7aa24-222">Практическое руководство. Создание, инициализация и настройка переключателей трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-222">How to: Create, Initialize and Configure Trace Switches</span></span>](how-to-create-initialize-and-configure-trace-switches.md)
- [<span data-ttu-id="7aa24-223">Практическое руководство. Создание и инициализация источников трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-223">How to: Create and Initialize Trace Sources</span></span>](how-to-create-and-initialize-trace-sources.md)
- [<span data-ttu-id="7aa24-224">Практическое руководство. Использование TraceSource и фильтров с прослушивателями трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-224">How to: Use TraceSource and Filters with Trace Listeners</span></span>](how-to-use-tracesource-and-filters-with-trace-listeners.md)
- [<span data-ttu-id="7aa24-225">Прослушиватели трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-225">Trace Listeners</span></span>](trace-listeners.md)
- [<span data-ttu-id="7aa24-226">Переключатели трассировки</span><span class="sxs-lookup"><span data-stu-id="7aa24-226">Trace Switches</span></span>](trace-switches.md)
