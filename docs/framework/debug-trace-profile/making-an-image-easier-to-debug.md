---
title: Упрощение отладки в .NET изображения
description: Узнайте, как настроить исполняемый образ, для упрощения отладки с помощью интегрированной среды разработки параметров и параметров командной строки.
ms.date: 08/30/2018
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 5bab707afb059d4fcbd46a9ee54edead991be523
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61754223"
---
# <a name="making-an-image-easier-to-debug-in-net"></a>Упрощение отладки в .NET изображения

При компиляции неуправляемого кода можно настроить исполняемый образ для отладки, задав параметры командной строки или интегрированной среды разработки. Например, параметр командной строки /**Zi** в Visual C++ служит для создания файлов с отладочными символами (с расширением PDB). Аналогичным образом параметр командной строки /**Od** отключает оптимизацию компилятора. Результирующий код работает медленно, но это упрощает отладку, необходимости.

При компиляции .NET Framework управляемый код, компиляторы, такие как Visual C++, Visual Basic и C# компилируют исходную программу в промежуточный язык Майкрософт (MSIL). Код MSIL будет JIT-компиляции, перед выполнением в машинный код. Как и в случае с неуправляемым кодом, можно настроить исполняемый образ для отладки, задав параметры командной строки или интегрированной среды разработки. Также можно настроить для отладки в так же JIT-компиляцию.

Данная JIT-конфигурация имеет два аспекта.

- Вы можете запросить JIT-компилятор для создания сведений об отслеживании. После этого отладчик сможет сопоставлять цепочки команд MSIL с соответствующими командами машинного кода, а также отслеживать место хранения локальных переменных и аргументов функций. Начиная с .NET Framework версии 2.0 JIT-компилятор всегда создает сведения об отслеживании, поэтому нет необходимости для запроса.

- Вы можете запросить JIT-компилятор, можно отключить оптимизацию получившегося машинного кода.

Как правило, компилятор, создающим код MSIL задает эти параметры компилятора JIT соответствующим образом, в зависимости от интегрированной среды разработки параметры командной строки или указать, например, /**Od**.

В некоторых случаях может возникнуть необходимость изменить поведение JIT-компилятора, чтобы создаваемый машинный код было проще отлаживать. Например, для окончательной сборки или оптимизации управления может потребоваться создать сведения о JIT-отслеживании. Это можно сделать с помощью файла инициализации (INI).

Например, если сборки, необходимо выполнить отладку называется *MyApp.exe*, то можно создать текстовый файл с именем *MyApp.ini*, в той же папке, что *MyApp.exe*, который содержит Эти три строки:

```ini
[.NET Framework Debugging Control]
GenerateTrackingInfo=1
AllowOptimize=0
```

Значением каждого параметра может быть 0 или 1; отсутствующие параметры получают значение 0. Для упрощения отладки значение `GenerateTrackingInfo` должно быть равным 1, а значение `AllowOptimize` — 0.

Начиная с .NET Framework версии 2.0 JIT-компилятор всегда генерирует сведения об отслеживании независимо от значения для `GenerateTrackingInfo`, однако `AllowOptimize` значение еще действует. При использовании [Ngen.exe (средства для создания образов в машинном коде)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) для предварительной компиляции образа в машинном коде без оптимизации INI-файл, содержащий параметр `AllowOptimize=0`, должен находиться в целевой папке во время выполнения Ngen.exe. Если имеет предкомпилированные сборки без оптимизации, необходимо удалить предварительно скомпилированный код, с помощью NGen.exe **/ uninstall** параметр прежде чем перезапускать Ngen.exe для предварительной компиляции оптимизированного кода. Если INI-файл отсутствует в папке, по умолчанию Ngen.exe предварительно компилирует код как оптимизированный.

<xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> управляет параметрами для сборки. **DebuggableAttribute** включает два поля, управляющие ли JIT-компилятор следует оптимизировать и/или создает данные для отслеживания. Начиная с .NET Framework версии 2.0 JIT-компилятор всегда генерирует сведения об отслеживании.

Для окончательных сборок компиляторы не устанавливать любые **DebuggableAttribute**. По умолчанию JIT-компилятор создает высокую производительность, затрудняет отладку машинного кода. Включение JIT-отслеживания несколько снижает производительность; отключение оптимизации снижает производительность значительно.

**DebuggableAttribute** одновременно применяется ко всей сборке, а не к ее отдельным модулям. Средства разработки должны, таким образом, подключать пользовательские атрибуты к классу **System.Runtime.CompilerServices.AssemblyAttributesGoHere** или, если сборка уже создана, к токену метаданных сборки. Средство ALink активизируется эти **DebuggableAttribute** атрибуты из каждого модуля в сборку, они становятся частью. Если возникает конфликт, сбой операции ALink.

> [!NOTE]
> В .NET Framework версии 1.0 **DebuggableAttribute** добавляется компилятором Microsoft Visual C++, если указаны параметры компилятора **/clr** и **/Zi**. В версии 1.1 платформы .NET Framework, необходимо добавить **DebuggableAttribute** вручную в коде или используйте **/ASSEMBLYDEBUG** параметр компоновщика.

## <a name="see-also"></a>См. также

- [Отладка, трассировка и профилирование](../../../docs/framework/debug-trace-profile/index.md)
- [Включение отладки с JIT-присоединением](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)
- [Включение профилирования](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))
