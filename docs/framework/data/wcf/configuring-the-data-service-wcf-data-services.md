---
title: Настройка службы данных (службы данных WCF)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, configuring
ms.assetid: 59efd4c8-cc7a-4800-a0a4-d3f8abe6c55c
ms.openlocfilehash: 6f73fa43bcb99e53adabe8b49ffee75c65802eca
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2020
ms.locfileid: "79400923"
---
# <a name="configuring-the-data-service-wcf-data-services"></a>Настройка службы данных (службы данных WCF)
С помощью WCF Data Services можно создавать службы данных, которые разоблачают каналы протокола открытых данных (OData). В этих каналах могут находиться данные из различных источников данных. WCF Data Services использует поставщиков данных для оборачления этих данных в качестве канала OData. В число таких поставщиков входят поставщик Entity Framework, поставщик отражения, а также набор пользовательских интерфейсов поставщиков служб данных. Реализация поставщика определяет модель данных для службы. Для получения дополнительной [информации см.](data-services-providers-wcf-data-services.md)  
  
 В WCF Data Services служба данных — это <xref:System.Data.Services.DataService%601> класс, который наследует от класса, где тип службы данных является контейнером сущности модели данных. Этот контейнер сущностей имеет одно или несколько свойств, возвращающих интерфейс <xref:System.Linq.IQueryable%601>, которые используются для доступа к наборам сущностей модели данных.  
  
 Поведение службы данных определяется членами класса <xref:System.Data.Services.DataServiceConfiguration> и класса <xref:System.Data.Services.DataServiceBehavior>, доступ к которому осуществляется через свойство <xref:System.Data.Services.DataServiceConfiguration.DataServiceBehavior%2A> класса <xref:System.Data.Services.DataServiceConfiguration>. Класс <xref:System.Data.Services.DataServiceConfiguration> предоставляется методу `InitializeService`, реализуемому службой данных, как показано в следующей реализации службы данных Northwind.  
  
[!code-csharp[Astoria Northwind Service#DataServiceConfigComplete](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_service/cs/northwind.svc.cs#dataserviceconfigcomplete)]  
[!code-vb[Astoria Northwind Service#DataServiceConfigComplete](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_service/vb/northwind.svc.vb#dataserviceconfigcomplete)]  
  
## <a name="data-service-configuration-settings"></a>Параметры конфигурации службы данных  
 Класс <xref:System.Data.Services.DataServiceConfiguration> позволяет задать следующее поведение службы данных.  
  
|Участник|Поведение|  
|------------|--------------|  
|<xref:System.Data.Services.DataServiceBehavior.AcceptCountRequests%2A>|Позволяет отключить запросы количества, передаваемые службе данных при использовании сегмента пути `$count` и параметра запроса `$inlinecount`. Для получения дополнительной [OData: URI Conventions](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/)информации см.|  
|<xref:System.Data.Services.DataServiceBehavior.AcceptProjectionRequests%2A>|Позволяет отключить поддержку проекции данных в запросах, передаваемых службе данных при использовании параметра запроса `$select`. Для получения дополнительной [OData: URI Conventions](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/)информации см.|  
|<xref:System.Data.Services.DataServiceConfiguration.EnableTypeAccess%2A>|Включает тип данных, предоставляемый в метаданных для динамического поставщика метаданных, определенного с помощью интерфейса <xref:System.Data.Services.Providers.IDataServiceMetadataProvider>.|  
|<xref:System.Data.Services.DataServiceConfiguration.EnableTypeConversion%2A>|Позволяет указать, должна ли среда выполнения службы данных преобразовывать тип, содержащийся в полезных данных, в фактический тип свойства, указанный в запросе.|  
|<xref:System.Data.Services.DataServiceBehavior.InvokeInterceptorsOnLinkDelete%2A>|Позволяет указать, следует ли вызывать перехватчиков зарегистрированных изменений для связанных сущностей при удалении ссылки связи между двумя сущностями.|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxBatchCount%2A>|Позволяет ограничить число наборов изменений и операций запросов, разрешенных в одном пакете. Для получения дополнительной информации [Batching Operations](batching-operations-wcf-data-services.md)см. [OData: Batch](https://www.odata.org/documentation/odata-version-2-0/batch-processing/)|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxChangesetCount%2A>|Позволяет ограничить количество изменений, которые могут быть включены в один набор изменений. Для получения дополнительной информации [см.](how-to-enable-paging-of-data-service-results-wcf-data-services.md)|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxExpandCount%2A>|Позволяет ограничить размер ответа путем ограничения количества связанных сущностей, которые могут быть включены в один запрос при использовании оператора запроса `$expand`. Для получения дополнительной информации см. [Loading Deferred Content](loading-deferred-content-wcf-data-services.md) [OData: URI Conventions](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/)|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxExpandDepth%2A>|Позволяет ограничить размер ответа путем ограничения глубины графа связанных сущностей, которые могут быть включены в один запрос при использовании оператора запроса `$expand`. Для получения дополнительной информации см. [Loading Deferred Content](loading-deferred-content-wcf-data-services.md) [OData: URI Conventions](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/)|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxObjectCountOnInsert%2A>|Позволяет ограничить количество вставляемых сущностей, которые могут содержаться в одном запросе POST.|  
|<xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A>|Определяет версию протокола Atom, используемую службой данных. Когда значение значения <xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A> устанавливается на значение меньше максимального <xref:System.Data.Services.Common.DataServiceProtocolVersion>значения, последняя функциональность WCF Data Services недоступна для клиентов, имеющих доступ к службе данных. Для получения дополнительной [информации](data-service-versioning-wcf-data-services.md)см.|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxResultsPerCollection%2A>|Позволяет ограничить размер ответа путем ограничения количества сущностей в каждом наборе сущностей, возвращаемом в виде канала данных.|  
|<xref:System.Data.Services.DataServiceConfiguration.RegisterKnownType%2A>|Добавляет тип данных в список типов, распознаваемых службой данных.|  
|<xref:System.Data.Services.DataServiceConfiguration.SetEntitySetAccessRule%2A>|Задает права доступа для ресурсов набора сущностей, доступных в службе данных. Значение «звездочка» (`*`) может использоваться в параметре имени для задания доступа того же уровня для всех остальных наборов сущностей. Для предоставления минимального уровня прав доступа к ресурсам службы данных, необходимым клиентским приложениям рекомендуется задавать доступ к наборам сущностей. Дополнительные сведения см. в разделе [Securing WCF Data Services](securing-wcf-data-services.md). Примеры минимальных прав доступа, необходимых для данного действия [Minimum Resource Access Requirements](configuring-the-data-service-wcf-data-services.md#accessRequirements) URI и HTTP, см.|  
|<xref:System.Data.Services.DataServiceConfiguration.SetEntitySetPageSize%2A>|Задает максимальный размер страницы для ресурса набора сущностей. Для получения дополнительной информации [см.](how-to-enable-paging-of-data-service-results-wcf-data-services.md)|  
|<xref:System.Data.Services.DataServiceConfiguration.SetServiceOperationAccessRule%2A>|Задает права доступа для операций службы, определенных в службе данных. Для получения дополнительной информации [см.](service-operations-wcf-data-services.md) Значение «звездочка» (`*`) может использоваться в параметре имени для задания доступа того же уровня для всех остальных операций службы. Рекомендуется задавать операциям службы минимальный уровень прав доступа к ресурсам службы данных, необходимых клиентским приложениям. Дополнительные сведения см. в разделе [Securing WCF Data Services](securing-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.UseVerboseErrors%2A>|Этот параметр настройки упрощает процесс устранения неполадок службы данных, возвращая дополнительные сведения в ответном сообщении об ошибке. Параметр не предназначен для использования в рабочей среде. Для получения дополнительной информации [см.](developing-and-deploying-wcf-data-services.md)|  
  
<a name="accessRequirements"></a>
## <a name="minimum-resource-access-requirements"></a>Минимальные требования для доступа к ресурсам  
 В следующих сведениях о таблице указаны минимальные права набора сущностей, которые необходимо предоставить для выполнения определенной операции. Примеры пути основаны на службе данных Northwind, которая создается при завершении [запуска.](quickstart-wcf-data-services.md) Поскольку перечисления <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.ServiceOperationRights> определяются с помощью <xref:System.FlagsAttribute>, для указания нескольких разрешений для одного набора сущностей или операции можно использовать логический оператор OR. Для получения дополнительной информации [см.](how-to-enable-access-to-the-data-service-wcf-data-services.md)  
  
|Путь/действие|`GET`|`DELETE`|`MERGE`|`POST`|`PUT`|  
|------------------|-----------|--------------|-------------|------------|-----------|  
|`/Customers`|<xref:System.Data.Services.EntitySetRights.ReadMultiple>|Не поддерживается|Не поддерживается|<xref:System.Data.Services.EntitySetRights.WriteAppend>|Не поддерживается|  
|`/Customers('ALFKI')`|<xref:System.Data.Services.EntitySetRights.ReadSingle>|<xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteDelete>|<xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge>|Недоступно|<xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers('ALFKI')/Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Не поддерживается|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge> или <xref:System.Data.Services.EntitySetRights.WriteReplace><br /><br /> - и -<br /><br /> `Orders``:` и<xref:System.Data.Services.EntitySetRights.WriteAppend>|Не поддерживается|  
|`/Customers('ALFKI')/Orders(10643)`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteDelete>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge>|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Orders(10643)/Customer`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteDelete><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge>;<br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.WriteAppend><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.WriteAppend> и <xref:System.Data.Services.EntitySetRights.ReadSingle>|Не поддерживается|  
|`/Customers('ALFKI')/$links/Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Не поддерживается|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge> или <xref:System.Data.Services.EntitySetRights.WriteReplace><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|Не поддерживается|  
|`/Customers('ALFKI')/$links/Orders(10643)`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge> или <xref:System.Data.Services.EntitySetRights.WriteReplace><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|Не поддерживается|Не поддерживается|Не поддерживается|  
|`/Orders(10643)/$links/Customer`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge> или <xref:System.Data.Services.EntitySetRights.WriteReplace>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteMerge>|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle>;<br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers/$count`|<xref:System.Data.Services.EntitySetRights.ReadMultiple>|Не поддерживается|Не поддерживается|Не поддерживается|Не поддерживается|  
|`/Customers('ALFKI')/ContactName`|<xref:System.Data.Services.EntitySetRights.ReadSingle>|Не поддерживается|<xref:System.Data.Services.EntitySetRights.WriteMerge>|Не поддерживается|<xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers('ALFKI')/Address/StreetAddress/$value`<sup>1</sup>|<xref:System.Data.Services.EntitySetRights.ReadSingle>|<xref:System.Data.Services.EntitySetRights.WriteDelete>|Не поддерживается|Не поддерживается|Не поддерживается|  
|`/Customers('ALFKI')/ContactName/$value`|<xref:System.Data.Services.EntitySetRights.ReadSingle>|<xref:System.Data.Services.EntitySetRights.ReadSingle> и <xref:System.Data.Services.EntitySetRights.WriteDelete>|<xref:System.Data.Services.EntitySetRights.WriteMerge>|Не поддерживается|<xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers('ALFKI')/$value`<sup>2</sup>|<xref:System.Data.Services.EntitySetRights.ReadSingle>|Не поддерживается|Не поддерживается|Не поддерживается|<xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers?$select=Orders/*&$expand=Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Не поддерживается|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights.WriteAppend>|Не поддерживается|  
|`/Customers('ALFKI')?$select=Orders/*&$expand=Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> - и -<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Не поддерживается|Не поддерживается|Не поддерживается|Не поддерживается|  
  
 <sup>1</sup> В этом `Address` примере представляется `Customers` сложное свойство `StreetAddress`типа сущности, у которого названо свойство. Модель, которая используется службой данных Northwind, не определяет этот сложный тип явно. Если модель данных определяется с помощью поставщика Entity Framework, такой сложный тип можно определить с помощью средств модели EDM. Для получения дополнительной [How to: Create and Modify Complex Types](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd456820(v=vs.100))информации см.  
  
 <sup>2</sup> Это URI поддерживается, когда свойство, которое возвращает двоичный большой объект (BLOB), определяется как медиаресурс, `Customers`принадлежащий сущности, которая является записью ссылки мультимедиа, которая в данном случае находится в. Для получения дополнительной [Streaming Provider](streaming-provider-wcf-data-services.md)информации см.  
  
<a name="versioning"></a>
## <a name="versioning-requirements"></a>Требования к управлению версиями  
 Следующие поведения конфигурации службы данных требуют версии 2 протокола OData или более поздних версий:  
  
- Поддержка числа запросов.  
  
- Поддержка параметра запроса $select для проекции.  
  
 Для получения дополнительной [информации](data-service-versioning-wcf-data-services.md)см.  
  
## <a name="see-also"></a>См. также раздел

- [Определение служб данных WCF](defining-wcf-data-services.md)
- [Размещение службы данных](hosting-the-data-service-wcf-data-services.md)
