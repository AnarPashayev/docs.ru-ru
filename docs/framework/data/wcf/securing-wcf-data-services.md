---
title: Защита служб WCF Data Services
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- securing application [WCF Data Services]
- WCF Data Services, security
ms.assetid: 99fc2baa-a040-4549-bc4d-f683d60298af
ms.openlocfilehash: e09007e786772e838a9aaa76eb8ef7a3fe2b7cca
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79174658"
---
# <a name="securing-wcf-data-services"></a><span data-ttu-id="d4a83-102">Защита служб WCF Data Services</span><span class="sxs-lookup"><span data-stu-id="d4a83-102">Securing WCF Data Services</span></span>
<span data-ttu-id="d4a83-103">В этой теме описаны соображения безопасности, характерные для разработки, развертывания и запуска служб данных WCF и приложений, которые получают доступ к службам, поддерживающим Протокол открытых данных (OData).</span><span class="sxs-lookup"><span data-stu-id="d4a83-103">This topic describes security considerations that are specific to developing, deploying, and running WCF Data Services and applications that access services that support the Open Data Protocol (OData).</span></span> <span data-ttu-id="d4a83-104">Вы также должны следовать рекомендациям по созданию безопасных приложений .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d4a83-104">You should also follow recommendations for creating secure .NET Framework applications.</span></span>  
  
<span data-ttu-id="d4a83-105">При планировании того, как обеспечить безопасность службы OData на основе данных WCF Data Services, необходимо рассмотреть как аутентификацию, процесс обнаружения и проверки личности основного, так и процесс определения того, является ли аутентифицированный принцип доступ к запрашиваемым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="d4a83-105">When planning how to secure a WCF Data Services-based OData service, you must address both authentication, the process of discovering and verifying the identity of a principal, and authorization, the process of determining whether an authenticated principal is allowed to access the requested resources.</span></span> <span data-ttu-id="d4a83-106">Следует также рассмотреть необходимость шифрования сообщения с помощью протокола SSL.</span><span class="sxs-lookup"><span data-stu-id="d4a83-106">You should also consider whether to encrypt the message by using SSL.</span></span>  
  
## <a name="authenticating-client-requests"></a><span data-ttu-id="d4a83-107">Проверка подлинности клиентских запросов</span><span class="sxs-lookup"><span data-stu-id="d4a83-107">Authenticating Client Requests</span></span>  
<span data-ttu-id="d4a83-108">WCF Data Services не осуществляет никакой собственной аутентификации, а опирается на положения аутентификации хостатора службы передачи данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-108">WCF Data Services does not implement any kind of authentication of its own, but rather relies on the authentication provisions of the data service host.</span></span> <span data-ttu-id="d4a83-109">Это означает, что служба предполагает, что любой запрос, который она получает, уже был проверен ухом сети и что хост правильно определил принцип запроса надлежащим образом через интерфейсы, предоставляемые WCF Data Services.</span><span class="sxs-lookup"><span data-stu-id="d4a83-109">This means that the service assumes that any request that it receives has already been authenticated by the network host and that the host has correctly identified the principle for the request appropriately via the interfaces provided by WCF Data Services.</span></span> <span data-ttu-id="d4a83-110">Эти параметры аутентификации и подходы подробно описаны в многокомпонентной [серии OData и Authentication.](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22)</span><span class="sxs-lookup"><span data-stu-id="d4a83-110">These authentication options and approaches are detailed in the multipart [OData and Authentication series](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22).</span></span>  
  
### <a name="authentication-options-for-a-wcf-data-service"></a><span data-ttu-id="d4a83-111">Параметры проверки подлинности для службы данных WCF</span><span class="sxs-lookup"><span data-stu-id="d4a83-111">Authentication Options for a WCF Data Service</span></span>  
 <span data-ttu-id="d4a83-112">В приведенной ниже таблице перечислены некоторые из механизмов проверки подлинности, с помощью которых можно выполнять проверку подлинности запросов к службе данных WCF.</span><span class="sxs-lookup"><span data-stu-id="d4a83-112">The following table lists some of the authentication mechanisms that are available to help you authenticate requests to a WCF Data Service.</span></span>  
  
|<span data-ttu-id="d4a83-113">Параметры аутентификации</span><span class="sxs-lookup"><span data-stu-id="d4a83-113">Authentication Options</span></span>|<span data-ttu-id="d4a83-114">Описание</span><span class="sxs-lookup"><span data-stu-id="d4a83-114">Description</span></span>|  
|----------------------------|-----------------|  
|<span data-ttu-id="d4a83-115">анонимная аутентификация;</span><span class="sxs-lookup"><span data-stu-id="d4a83-115">Anonymous authentication</span></span>|<span data-ttu-id="d4a83-116">При использовании анонимной проверки подлинности по HTTP любой участник может подключиться к службе данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-116">When HTTP anonymous authentication is enabled, any principle is able to connect to the data service.</span></span> <span data-ttu-id="d4a83-117">Учетные данные для анонимного доступа не требуются.</span><span class="sxs-lookup"><span data-stu-id="d4a83-117">Credentials are not required for anonymous access.</span></span> <span data-ttu-id="d4a83-118">Используйте этот параметр, только если требуется предоставить общий доступ к службе данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-118">Use this option only when you want to allow anyone to access the data service.</span></span>|  
|<span data-ttu-id="d4a83-119">Обычная и дайджест-проверка подлинности</span><span class="sxs-lookup"><span data-stu-id="d4a83-119">Basic and digest authentication</span></span>|<span data-ttu-id="d4a83-120">Для проверки подлинности необходимы учетные данные, состоящие из имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="d4a83-120">Credentials consisting of a user name and password are required for authentication.</span></span> <span data-ttu-id="d4a83-121">Поддерживает проверку подлинности клиентов, отличных от Windows.</span><span class="sxs-lookup"><span data-stu-id="d4a83-121">Supports authentication of non-Windows clients.</span></span> <span data-ttu-id="d4a83-122">**Примечание безопасности:**  Основные учетные данные аутентификации (имя пользователя и пароль) отправляются в ясной и могут быть перехвачены.</span><span class="sxs-lookup"><span data-stu-id="d4a83-122">**Security Note:**  Basic authentication credentials (user name and password) are sent in the clear and can be intercepted.</span></span> <span data-ttu-id="d4a83-123">При дайджест-проверке подлинности отправляется хэш, основанный на переданных учетных данных, что обеспечивает большую безопасность по сравнению с обычной проверкой подлинности.</span><span class="sxs-lookup"><span data-stu-id="d4a83-123">Digest authentication sends a hash based-on the supplied credentials, which makes it more secure than basic authentication.</span></span> <span data-ttu-id="d4a83-124">Оба эти метода проверки подлинности уязвимы для атак типа «злоумышленник в середине».</span><span class="sxs-lookup"><span data-stu-id="d4a83-124">Both are susceptible to man-in-the-middle attacks.</span></span> <span data-ttu-id="d4a83-125">При использовании этих методов проверки подлинности следует организовать зашифрованное соединение между клиентом и службой данных с помощью протокола SSL.</span><span class="sxs-lookup"><span data-stu-id="d4a83-125">When using these authentication methods, you should consider encrypting communication between client and the data service by using the Secure Sockets Layer (SSL).</span></span> <br /><br /> <span data-ttu-id="d4a83-126">Microsoft Internet Information Services (IIS) обеспечивает реализацию как базовой, так и дайджест проверки подлинности для запросов HTTP в ASP.NET приложении.</span><span class="sxs-lookup"><span data-stu-id="d4a83-126">Microsoft Internet Information Services (IIS) provides an implementation of both basic and digest authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="d4a83-127">Эта реализация поставщика проверки подлинности Windows позволяет клиентскому приложению .NET Framework передавать учетные данные службе данных в HTTP-заголовке запроса, что дает возможность беспрепятственно согласовывать проверку подлинности пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="d4a83-127">This Windows Authentication Provider implementation enables a .NET Framework client application to supply credentials in the HTTP header of the request to the data service to seamlessly negotiate authentication of a Windows user.</span></span> <span data-ttu-id="d4a83-128">Для получения дополнительной информации, см [Digest Аутентификация Техническая справка](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc782794(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="d4a83-128">For more information, see [Digest Authentication Technical Reference](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc782794(v=ws.10)).</span></span><br /><br /> <span data-ttu-id="d4a83-129">Если вы хотите, чтобы служба данных использовала базовую аутентификацию на основе какой-либо пользовательской службы аутентификации, а не учетных данных Windows, необходимо реализовать пользовательский ADP.NET http Module для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d4a83-129">When you want to have your data service use basic authentication based on some custom authentication service and not Windows credentials, you must implement a custom ADP.NET HTTP Module for authentication.</span></span><br /><br /> <span data-ttu-id="d4a83-130">Например, как использовать пользовательскую базовую схему аутентификации [OData and Authentication – Part 6 – Custom Basic Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/)с WCF Data Services, см.</span><span class="sxs-lookup"><span data-stu-id="d4a83-130">For an example of how to use a custom basic authentication scheme with WCF Data Services, see the blog post [OData and Authentication – Part 6 – Custom Basic Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/).</span></span>|  
|<span data-ttu-id="d4a83-131">Проверка подлинности Windows</span><span class="sxs-lookup"><span data-stu-id="d4a83-131">Windows authentication</span></span>|<span data-ttu-id="d4a83-132">Обмен учетными данными на базе Windows происходит с помощью NTLM или Kerberos.</span><span class="sxs-lookup"><span data-stu-id="d4a83-132">Windows-based credentials are exchanged by using NTLM or Kerberos.</span></span> <span data-ttu-id="d4a83-133">Этот механизм более надежен, чем простая или дайджест-проверка подлинности, но он требует, чтобы клиент был приложением на базе Windows.</span><span class="sxs-lookup"><span data-stu-id="d4a83-133">This mechanism is more secure than basic or digest authentication, but it requires that the client be a Windows-based application.</span></span> <span data-ttu-id="d4a83-134">IIS также предоставляет реализацию проверки подлинности Windows для запросов HTTP в ASP.NET приложении.</span><span class="sxs-lookup"><span data-stu-id="d4a83-134">IIS also provides an implementation of Windows authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="d4a83-135">Для получения дополнительной информации [ASP.NET](https://docs.microsoft.com/previous-versions/aspnet/7t6b43z4(v=vs.100))см.</span><span class="sxs-lookup"><span data-stu-id="d4a83-135">For more information, see [ASP.NET Forms Authentication Overview](https://docs.microsoft.com/previous-versions/aspnet/7t6b43z4(v=vs.100)).</span></span><br /><br /> <span data-ttu-id="d4a83-136">Пример того, как использовать аутентификацию Windows с помощью служб данных WCF, смотрите сообщение в блоге [OData и аутентификация - Часть 2 - Проверка подлинности Windows](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/).</span><span class="sxs-lookup"><span data-stu-id="d4a83-136">For an example of how to use Windows authentication with WCF Data Services, see the blog post [OData and Authentication – Part 2 – Windows Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/).</span></span>|  
|<span data-ttu-id="d4a83-137">ASP.NET формы аутентификации</span><span class="sxs-lookup"><span data-stu-id="d4a83-137">ASP.NET forms authentication</span></span>|<span data-ttu-id="d4a83-138">Проверка подлинности с помощью форм позволяет проверять подлинность пользователей с помощью собственного кода и затем предоставлять маркер проверки подлинности в файле Cookie или в URL-адресе страницы.</span><span class="sxs-lookup"><span data-stu-id="d4a83-138">Forms authentication lets you authenticate users by using your own code and then maintain an authentication token in a cookie or in the page URL.</span></span> <span data-ttu-id="d4a83-139">Проверка подлинности имени пользователя и пароля пользователя выполняется с помощью созданной вами формы входа в систему.</span><span class="sxs-lookup"><span data-stu-id="d4a83-139">You authenticate the user name and password of your users using a login form that you create.</span></span> <span data-ttu-id="d4a83-140">Запросы без проверки подлинности перенаправляются на страницу входа, на которой пользователь указывает учетные данные и отправляет их.</span><span class="sxs-lookup"><span data-stu-id="d4a83-140">Unauthenticated requests are redirected to a login page, where the user provides credentials and submits the form.</span></span> <span data-ttu-id="d4a83-141">Если приложение удостоверяет подлинность запроса, система создает билет подлинности, который содержит ключ для повторного запроса данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-141">If the application authenticates the request, the system issues a ticket that contains a key for reestablishing the identity for subsequent requests.</span></span> <span data-ttu-id="d4a83-142">Для получения дополнительной [Forms Authentication Provider](https://docs.microsoft.com/previous-versions/aspnet/9wff0kyh(v=vs.100))информации см.</span><span class="sxs-lookup"><span data-stu-id="d4a83-142">For more information, see [Forms Authentication Provider](https://docs.microsoft.com/previous-versions/aspnet/9wff0kyh(v=vs.100)).</span></span> <span data-ttu-id="d4a83-143">**Примечание безопасности:**  По умолчанию файлы cookie, содержащие билет на аутентификацию форм, не защищены при использовании аутентификации форм в ASP.NET веб-приложении.</span><span class="sxs-lookup"><span data-stu-id="d4a83-143">**Security Note:**  By default, the cookie that contains the forms authentication ticket is not secured when you use forms authentication in a ASP.NET Web application.</span></span> <span data-ttu-id="d4a83-144">Рассмотрите вариант с защитой как билета проверки подлинности, так и первоначальных учетных данных для входа с помощью SSL.</span><span class="sxs-lookup"><span data-stu-id="d4a83-144">You should consider requiring SSL to protect both the authentication ticket and the initial login credentials.</span></span> <br /><br /> <span data-ttu-id="d4a83-145">Пример того, как использовать проверку подлинности форм с помощью служб данных WCF, смотрите в блоге [OData и аутентификации - Часть 7 - Формы аутентификации](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/).</span><span class="sxs-lookup"><span data-stu-id="d4a83-145">For an example of how to use forms authentication with WCF Data Services, see the blog post [OData and Authentication – Part 7 – Forms Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/).</span></span>|  
|<span data-ttu-id="d4a83-146">Проверка подлинности на основе утверждений</span><span class="sxs-lookup"><span data-stu-id="d4a83-146">Claims-based authentication</span></span>|<span data-ttu-id="d4a83-147">При проверке подлинности на основе утверждений служба данных опирается на доверенную услугу поставщика идентификационных данных «третьей стороны» для проверки подлинности пользователя.</span><span class="sxs-lookup"><span data-stu-id="d4a83-147">In claims-based authentication, the data service relies on a trusted "third-party" identity provider service to authenticate the user.</span></span> <span data-ttu-id="d4a83-148">Поставщик удостоверений выполняет с положительным результатом проверку подлинности пользователя, который запросил доступ к ресурсам службы данных, и выдает маркер, предоставляющий доступ к запрошенным ресурсам.</span><span class="sxs-lookup"><span data-stu-id="d4a83-148">The identity provider positively authenticates the user that is requesting access to data service resources and issues a token that grants access to the requested resources.</span></span> <span data-ttu-id="d4a83-149">Затем этот маркер представляется службе данных, которая предоставляет доступ пользователю на базе отношений доверия со службой удостоверений, выдавшей маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="d4a83-149">This token is then presented to the data service, which then grants access to the user based on the trust relationship with the identity service that issued the access token.</span></span><br /><br /> <span data-ttu-id="d4a83-150">Преимущество использования поставщика проверки подлинности на базе утверждений заключается в том, что этот метод можно использовать для проверки подлинности клиентов различных типов между несколькими доверенными доменами.</span><span class="sxs-lookup"><span data-stu-id="d4a83-150">The benefit of using a claims-based authentication provider is that they can be used to authenticate various types of clients across trust domains.</span></span> <span data-ttu-id="d4a83-151">Благодаря применению такого стороннего поставщика, служба данных может быть освобождена от дополнительной нагрузки по поддержке и проверке подлинности пользователей.</span><span class="sxs-lookup"><span data-stu-id="d4a83-151">By employing such a third-party provider, a data service can offload the requirements of maintaining and authenticating users.</span></span> <span data-ttu-id="d4a83-152">OAuth 2.0 — это протокол проверки подлинности на основе утверждений, поддерживаемый системой контроля доступа к фабрике приложений Microsoft Azure для федеративной проверки подлинности и реализованный в виде службы.</span><span class="sxs-lookup"><span data-stu-id="d4a83-152">OAuth 2.0 is a claims-based authentication protocol that is supported by Windows Azure AppFabric Access Control for federated authorization as a service.</span></span> <span data-ttu-id="d4a83-153">Этот протокол поддерживает службы на основе REST.</span><span class="sxs-lookup"><span data-stu-id="d4a83-153">This protocol supports REST-based services.</span></span> <span data-ttu-id="d4a83-154">Например, как использовать OAuth 2.0 с WCF Data [OData and Authentication – Part 8 – OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/)Services, см.</span><span class="sxs-lookup"><span data-stu-id="d4a83-154">For an example of how to use OAuth 2.0 with WCF Data Services, see the blog post [OData and Authentication – Part 8 – OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/).</span></span>|  
  
<a name="clientAuthentication"></a>
### <a name="authentication-in-the-client-library"></a><span data-ttu-id="d4a83-155">Проверка подлинности в клиентской библиотеке</span><span class="sxs-lookup"><span data-stu-id="d4a83-155">Authentication in the Client Library</span></span>  
 <span data-ttu-id="d4a83-156">По умолчанию клиентская библиотека WCF Data Services не подает учетные данные при запросе в службу OData.</span><span class="sxs-lookup"><span data-stu-id="d4a83-156">By default, the WCF Data Services client library does not supply credentials when making a request to an OData service.</span></span> <span data-ttu-id="d4a83-157">Если службе данных для проверки подлинности пользователя требуются учетные данные, то их можно предоставить в объекте <xref:System.Net.NetworkCredential>, доступном через свойство <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> контекста <xref:System.Data.Services.Client.DataServiceContext>, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="d4a83-157">When login credentials are required by the data service to authenticate a user, these credentials can be supplied in a <xref:System.Net.NetworkCredential> accessed from the <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> property of the <xref:System.Data.Services.Client.DataServiceContext>, as in the following example:</span></span>  
  
```csharp  
// Set the client authentication credentials.  
context.Credentials =  
    new NetworkCredential(userName, password, domain);  
```  
  
```vb  
' Set the client authentication credentials.  
context.Credentials = _  
    New NetworkCredential(userName, password, domain)  
```  
  
 <span data-ttu-id="d4a83-158">Для получения дополнительной информации [см.](specify-client-creds-for-a-data-service-request-wcf.md)</span><span class="sxs-lookup"><span data-stu-id="d4a83-158">For more information, see [How to: Specify Client Credentials for a Data Service Request](specify-client-creds-for-a-data-service-request-wcf.md).</span></span>  
  
 <span data-ttu-id="d4a83-159">Когда служба данных требует учетные данные входа в систему, которые нельзя указать с помощью объекта <xref:System.Net.NetworkCredential>, например маркер на базе утверждений или файл cookie, необходимо вручную задать заголовки в HTTP-запросе, обычно это заголовки `Authorization` и `Cookie`.</span><span class="sxs-lookup"><span data-stu-id="d4a83-159">When the data service requires login credentials that cannot be specified by using a <xref:System.Net.NetworkCredential> object, such as a claims-based token or cookie, you must manually set headers in the HTTP request, usually the `Authorization` and `Cookie` headers.</span></span> <span data-ttu-id="d4a83-160">Для получения дополнительной информации о такого сценарии аутентификации, см. [ OData and Authentication – Part 3 – ClientSide Hooks](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/)</span><span class="sxs-lookup"><span data-stu-id="d4a83-160">For more information about this kind of authentication scenario, see the blog post [ OData and Authentication – Part 3 – ClientSide Hooks](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/).</span></span> <span data-ttu-id="d4a83-161">Например, как установить заголовки HTTP в сообщении запроса, [см.](how-to-set-headers-in-the-client-request-wcf-data-services.md)</span><span class="sxs-lookup"><span data-stu-id="d4a83-161">For an example of how to set HTTP headers in a request message, see [How to: Set Headers in the Client Request](how-to-set-headers-in-the-client-request-wcf-data-services.md).</span></span>  
  
## <a name="impersonation"></a><span data-ttu-id="d4a83-162">Олицетворение</span><span class="sxs-lookup"><span data-stu-id="d4a83-162">Impersonation</span></span>  
 <span data-ttu-id="d4a83-163">Как правило, служба данных обращается к требуемым ресурсам, например к файлам на сервере или к базе данных, с использованием учетных данных рабочего процесса, в котором размещается служба данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-163">Generally, the data service accesses required resources, such as files on the server or a database, by using the credentials of the worker process that is hosting the data service.</span></span> <span data-ttu-id="d4a83-164">При использовании олицетворения ASP.NET приложения могут выполняться с помощью идентификации Windows (учетной записи пользователя) пользователя, делающего запрос.</span><span class="sxs-lookup"><span data-stu-id="d4a83-164">When using impersonation, ASP.NET applications can execute with the Windows identity (user account) of the user making the request.</span></span> <span data-ttu-id="d4a83-165">Олицетворение обычно используется в приложениях, которым проверку подлинности пользователя обеспечивают службы IIS, а учетные данные участника используются для доступа к требуемым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="d4a83-165">Impersonation is commonly used in applications that rely on IIS to authenticate the user, and the credentials of this principle are used to access the required resources.</span></span> <span data-ttu-id="d4a83-166">Для получения дополнительной информации см [ASP.NET.](https://docs.microsoft.com/previous-versions/aspnet/xh507fc5(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="d4a83-166">For more information, see [ASP.NET Impersonation](https://docs.microsoft.com/previous-versions/aspnet/xh507fc5(v=vs.100)).</span></span>  
  
## <a name="configuring-data-service-authorization"></a><span data-ttu-id="d4a83-167">Настройка авторизации службы данных</span><span class="sxs-lookup"><span data-stu-id="d4a83-167">Configuring Data Service Authorization</span></span>  
 <span data-ttu-id="d4a83-168">Авторизация — это предоставление доступа к ресурсам приложений участнику или процессу, определяемому на основе успешно выполненной до этого проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d4a83-168">Authorization is the granting of access to application resources to a principle or process that is identified based on a previously successful authentication.</span></span> <span data-ttu-id="d4a83-169">Как правило, для выполнения операций, которые требуются клиентским приложениям, нужно лишь предоставить достаточные права пользователям службы данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-169">As a general practice, you should only grant sufficient rights to users of the data service to perform the operations required by client applications.</span></span>  
  
### <a name="restrict-access-to-data-service-resources"></a><span data-ttu-id="d4a83-170">Ограничение доступа к ресурсам службы данных</span><span class="sxs-lookup"><span data-stu-id="d4a83-170">Restrict Access to Data Service Resources</span></span>  
 <span data-ttu-id="d4a83-171">По умолчанию WCF Data Services позволяет предоставлять общий доступ к чтению и записи на ресурсах службы данных (набор сущностей и операции службы) любому пользователю, который может получить доступ к службе данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-171">By default, WCF Data Services enables you to grant common read and write access against data service resources (entity set and service operations) to any user that is able to access the data service.</span></span> <span data-ttu-id="d4a83-172">Правила, определяющие доступ для чтения и записи, можно задавать отдельно для каждого набора сущностей, предоставляемого службой данных, а также для любой операции службы.</span><span class="sxs-lookup"><span data-stu-id="d4a83-172">Rules that define read and write access can be defined separately for each entity set exposed by the data service, as well as to any service operations.</span></span> <span data-ttu-id="d4a83-173">Рекомендуется ограничить доступ для чтения и записи только теми ресурсами, которые необходимы клиентскому приложению.</span><span class="sxs-lookup"><span data-stu-id="d4a83-173">We recommend limiting both read and write access to only the resources required by the client application.</span></span> <span data-ttu-id="d4a83-174">Для получения дополнительной информации [см.](configuring-the-data-service-wcf-data-services.md#accessRequirements)</span><span class="sxs-lookup"><span data-stu-id="d4a83-174">For more information, see [Minimum Resource Access Requirements](configuring-the-data-service-wcf-data-services.md#accessRequirements).</span></span>  
  
### <a name="implement-role-based-interceptors"></a><span data-ttu-id="d4a83-175">Реализация перехватчиков на базе ролей</span><span class="sxs-lookup"><span data-stu-id="d4a83-175">Implement Role-Based Interceptors</span></span>  
 <span data-ttu-id="d4a83-176">Перехватчики позволяют перехватывать запросы к ресурсам службы данных до того, как они будут обработаны службой данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-176">Interceptors enable you to intercept requests against data service resources before they are acted on by the data service.</span></span> <span data-ttu-id="d4a83-177">Для получения дополнительной [информации см.](interceptors-wcf-data-services.md)</span><span class="sxs-lookup"><span data-stu-id="d4a83-177">For more information, see [Interceptors](interceptors-wcf-data-services.md).</span></span> <span data-ttu-id="d4a83-178">Перехватчики позволяют принимать решения об авторизации с учетом того, какой пользователь, прошедший проверку подлинности, выполняет запрос.</span><span class="sxs-lookup"><span data-stu-id="d4a83-178">Interceptors enable you to make authorization decisions based the authenticated user that is making the request.</span></span> <span data-ttu-id="d4a83-179">Например, как ограничить доступ к ресурсам службы данных на основе подлинной идентификации пользователя, [см.](how-to-intercept-data-service-messages-wcf-data-services.md)</span><span class="sxs-lookup"><span data-stu-id="d4a83-179">For an example of how to restrict access to data service resources based on an authenticated user identity, see [How to: Intercept Data Service Messages](how-to-intercept-data-service-messages-wcf-data-services.md).</span></span>  
  
### <a name="restrict-access-to-the-persisted-data-store-and-local-resources"></a><span data-ttu-id="d4a83-180">Ограничение доступа к хранилищу материализованных данных и локальным ресурсам</span><span class="sxs-lookup"><span data-stu-id="d4a83-180">Restrict Access to the Persisted Data Store and Local Resources</span></span>  
 <span data-ttu-id="d4a83-181">Учетным записям, используемым для доступа к хранилищу материализованных данных, должны быть предоставлены только те права в базе данных или файловой системе, которых достаточно для выполнения требований службы данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-181">The accounts that are used to access the persisted store should be granted only enough rights in a database or the file system to support the requirements of the data service.</span></span> <span data-ttu-id="d4a83-182">При использовании анонимной проверки подлинности это будет учетная запись, под которой запущено приложение размещения.</span><span class="sxs-lookup"><span data-stu-id="d4a83-182">When anonymous authentication is used, this is the account used to run the hosting application.</span></span> <span data-ttu-id="d4a83-183">Для получения дополнительной информации см. [How to: Develop a WCF Data Service Running on IIS](how-to-develop-a-wcf-data-service-running-on-iis.md).</span><span class="sxs-lookup"><span data-stu-id="d4a83-183">For more information, see [How to: Develop a WCF Data Service Running on IIS](how-to-develop-a-wcf-data-service-running-on-iis.md).</span></span> <span data-ttu-id="d4a83-184">При использовании олицетворения пользователям, прошедшим проверку подлинности, должен предоставляться доступ к этим ресурсам — как правило, в рамках группы Windows.</span><span class="sxs-lookup"><span data-stu-id="d4a83-184">When impersonation is used, authenticated users must be granted access to these resources, usually as part of a Windows group.</span></span>  
  
## <a name="other-security-considerations"></a><span data-ttu-id="d4a83-185">Другие вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="d4a83-185">Other Security Considerations</span></span>  
  
### <a name="secure-the-data-in-the-payload"></a><span data-ttu-id="d4a83-186">Защита полезных данных</span><span class="sxs-lookup"><span data-stu-id="d4a83-186">Secure the Data in the Payload</span></span>  
<span data-ttu-id="d4a83-187">OData основан на протоколе HTTP.</span><span class="sxs-lookup"><span data-stu-id="d4a83-187">OData is based on the HTTP protocol.</span></span> <span data-ttu-id="d4a83-188">Заголовок HTTP-сообщения может содержать полезные учетные данные пользователя в зависимости от типа проверки подлинности, реализуемого службой данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-188">In an HTTP message, the header may contain valuable user credentials, depending on the authentication implemented by the data service.</span></span> <span data-ttu-id="d4a83-189">Текст сообщения может также содержать полезные пользовательские данные, которые могут требовать защиты.</span><span class="sxs-lookup"><span data-stu-id="d4a83-189">The message body may also contain valuable customer data that must be protected.</span></span> <span data-ttu-id="d4a83-190">В обоих случаях рекомендуется защищать передачу этих сведений по сети с помощью SSL.</span><span class="sxs-lookup"><span data-stu-id="d4a83-190">In both of these cases, we recommend that you use SSL to protect this information over the wire.</span></span>  
  
### <a name="ignored-message-headers-and-cookies"></a><span data-ttu-id="d4a83-191">Пропускаемые заголовки сообщений и файлы cookie</span><span class="sxs-lookup"><span data-stu-id="d4a83-191">Ignored Message Headers and Cookies</span></span>  
 <span data-ttu-id="d4a83-192">Заголовки HTTP-запросов, отличные от объявляющих типы содержимого и расположения ресурсов, пропускаются и никогда не задаются службой данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-192">HTTP request headers, other than those that declare content types and resource locations, are ignored and are never set by the data service.</span></span>  
  
 <span data-ttu-id="d4a83-193">Файлы cookie могут использоваться как часть схемы аутентификации, например, с ASP.NET формы аутентификации.</span><span class="sxs-lookup"><span data-stu-id="d4a83-193">Cookies can be used as part of an authentication scheme, such as with ASP.NET Forms Authentication.</span></span> <span data-ttu-id="d4a83-194">Однако любые файлы cookie HTTP, установленные на входящий запрос, игнорируются WCF DataServices.</span><span class="sxs-lookup"><span data-stu-id="d4a83-194">However, any HTTP cookies set on an incoming request are ignored by WCF DataServices.</span></span> <span data-ttu-id="d4a83-195">Хозяин службы данных может обрабатывать файлы cookie, но время выполнения WCF Data Services никогда не анализирует и не возвращает файлы cookie.</span><span class="sxs-lookup"><span data-stu-id="d4a83-195">The host of a data service may process the cookie, but the WCF Data Services runtime never analyzes or returns cookies.</span></span> <span data-ttu-id="d4a83-196">Библиотека клиентов WCF Data Services также не обрабатывает файлы cookie, отправленные в ответ.</span><span class="sxs-lookup"><span data-stu-id="d4a83-196">The WCF Data Services client library also does not process cookies sent in the response.</span></span>  
  
### <a name="custom-hosting-requirements"></a><span data-ttu-id="d4a83-197">Требования к пользовательскому размещению</span><span class="sxs-lookup"><span data-stu-id="d4a83-197">Custom Hosting Requirements</span></span>  
 <span data-ttu-id="d4a83-198">По умолчанию WCF Data Services создается как ASP.NET приложение, размещенное в IIS.</span><span class="sxs-lookup"><span data-stu-id="d4a83-198">By default, WCF Data Services is created as an ASP.NET application hosted in IIS.</span></span> <span data-ttu-id="d4a83-199">Это позволяет службе данных использовать методы защиты этой платформы.</span><span class="sxs-lookup"><span data-stu-id="d4a83-199">This enables the data service to leverage the secure behaviors of this platform.</span></span> <span data-ttu-id="d4a83-200">Вы можете определить службы данных WCF, которые размещаются пользовательским хостом.</span><span class="sxs-lookup"><span data-stu-id="d4a83-200">You can define WCF Data Services that are hosted by a custom host.</span></span> <span data-ttu-id="d4a83-201">Для получения дополнительной [информации](hosting-the-data-service-wcf-data-services.md)см.</span><span class="sxs-lookup"><span data-stu-id="d4a83-201">For more information, see [Hosting the Data Service](hosting-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="d4a83-202">Компоненты и платформа, на которой размещается служба данных, должны поддерживать приведенные ниже методы защиты для предотвращения атак на службу данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-202">The components and platform hosting a data service must ensure the following security behaviors to prevent attacks on the data service:</span></span>  
  
- <span data-ttu-id="d4a83-203">Ограничение длины URI, принимаемого в запросе к службе данных для всех возможных операций.</span><span class="sxs-lookup"><span data-stu-id="d4a83-203">Limit the length of the URI accepted in a data service request for all possible operations.</span></span>  
  
- <span data-ttu-id="d4a83-204">Ограничение размера как входящих, так и исходящих HTTP-сообщений.</span><span class="sxs-lookup"><span data-stu-id="d4a83-204">Limit the size of both incoming and outgoing HTTP messages.</span></span>  
  
- <span data-ttu-id="d4a83-205">Ограничение общего числа необработанных запросов в любой момент времени.</span><span class="sxs-lookup"><span data-stu-id="d4a83-205">Limit the total number of outstanding requests at any given time.</span></span>  
  
- <span data-ttu-id="d4a83-206">Ограничьте размер заголовков HTTP и их значения и предоставьте WCF Data Services доступ к заголовку данных.</span><span class="sxs-lookup"><span data-stu-id="d4a83-206">Limit the size of HTTP headers and their values, and provide WCF Data Services access to header data.</span></span>  
  
- <span data-ttu-id="d4a83-207">Определение и отражение известных атак, например TCP SYN и атак повторной передачи ранее переданных сообщений.</span><span class="sxs-lookup"><span data-stu-id="d4a83-207">Detect and counter known attacks, such as TCP SYN and message replay attacks.</span></span>  
  
### <a name="values-are-not-further-encoded"></a><span data-ttu-id="d4a83-208">Отсутствие дальнейшего кодирования значений</span><span class="sxs-lookup"><span data-stu-id="d4a83-208">Values Are Not Further Encoded</span></span>  
 <span data-ttu-id="d4a83-209">Значения свойств, отправленные в службу данных, не кодируются службой обработки данных WCF.</span><span class="sxs-lookup"><span data-stu-id="d4a83-209">Property values sent to the data service are not further encoded by the WCF Data Services runtime.</span></span> <span data-ttu-id="d4a83-210">Например, если строковое свойство сущности содержит отформатированное HTML-содержимое, теги не кодируются службой данных в HTML.</span><span class="sxs-lookup"><span data-stu-id="d4a83-210">For example, when a string property of an entity contains formatted HTML content, the tags are not HTML encoded by the data service.</span></span> <span data-ttu-id="d4a83-211">Кроме того, служба данных не выполняет дальнейшего кодирования значений свойств в ответе.</span><span class="sxs-lookup"><span data-stu-id="d4a83-211">The data service also does not further encode property values in the response.</span></span> <span data-ttu-id="d4a83-212">Клиентская библиотека также не выполняет дополнительного кодирования.</span><span class="sxs-lookup"><span data-stu-id="d4a83-212">The client library also does not perform any additional encoding.</span></span>  
  
### <a name="considerations-for-client-applications"></a><span data-ttu-id="d4a83-213">Замечания по клиентским приложениям</span><span class="sxs-lookup"><span data-stu-id="d4a83-213">Considerations for Client Applications</span></span>  
 <span data-ttu-id="d4a83-214">Следующие соображения безопасности применяются к приложениям, которые используют клиента WCF Data Services для доступа к службам OData:</span><span class="sxs-lookup"><span data-stu-id="d4a83-214">The following security considerations apply to applications that use the WCF Data Services client to access OData services:</span></span>  
  
- <span data-ttu-id="d4a83-215">Клиентская библиотека предполагает, что протоколы, используемые для доступа к службам данных, обеспечивают требуемый уровень безопасности.</span><span class="sxs-lookup"><span data-stu-id="d4a83-215">The client library assumes that the protocols used to access the data service provide an appropriate level of security.</span></span>  
  
- <span data-ttu-id="d4a83-216">Клиентская библиотека использует значения по умолчанию для всех параметров времени ожидания и синтаксического анализа базовых транспортных стеков, предоставленных платформой.</span><span class="sxs-lookup"><span data-stu-id="d4a83-216">The client library uses all the default values for timeouts and parsing options of the underlying platform-provided transport stacks.</span></span>  
  
- <span data-ttu-id="d4a83-217">Клиентская библиотека не считывает никакие параметры из файлов конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="d4a83-217">The client library does not read any settings from application configuration files.</span></span>  
  
- <span data-ttu-id="d4a83-218">В клиентской библиотеке не реализовано никаких механизмов междоменного доступа.</span><span class="sxs-lookup"><span data-stu-id="d4a83-218">The client library does not implement any cross domain access mechanisms.</span></span> <span data-ttu-id="d4a83-219">Вместо этого механизмы предоставляются базовым стеком HTTP.</span><span class="sxs-lookup"><span data-stu-id="d4a83-219">Instead, it relies on the mechanisms provided by the underlying HTTP stack.</span></span>  
  
- <span data-ttu-id="d4a83-220">Клиентская библиотека не имеет элементов пользовательского интерфейса и никогда не пытается отобразить или вывести получаемые или отправляемые данные.</span><span class="sxs-lookup"><span data-stu-id="d4a83-220">The client library has no user interface elements, and it never tries to display or render the data that it receives or sends.</span></span>  
  
- <span data-ttu-id="d4a83-221">Рекомендуется, чтобы клиентские приложения всегда проверяли вводимые пользователем данные, а также все данные, принимаемые от недоверенных служб.</span><span class="sxs-lookup"><span data-stu-id="d4a83-221">We recommend that client applications always validate user input as well as data accepted from untrusted services.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d4a83-222">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="d4a83-222">See also</span></span>

- [<span data-ttu-id="d4a83-223">Определение служб данных WCF</span><span class="sxs-lookup"><span data-stu-id="d4a83-223">Defining WCF Data Services</span></span>](defining-wcf-data-services.md)
- [<span data-ttu-id="d4a83-224">Библиотека клиентов служб данных WCF</span><span class="sxs-lookup"><span data-stu-id="d4a83-224">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
