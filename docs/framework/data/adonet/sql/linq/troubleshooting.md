---
title: Устранение неполадок
ms.date: 03/30/2017
ms.assetid: 8cd4401c-b12c-4116-a421-f3dcffa65670
ms.openlocfilehash: 697432dce5f7698a8b4eabde3586bb4f77fd62de
ms.sourcegitcommit: 7f616512044ab7795e32806578e8dc0c6a0e038f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2019
ms.locfileid: "67742745"
---
# <a name="troubleshooting"></a><span data-ttu-id="614ca-102">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="614ca-102">Troubleshooting</span></span>
<span data-ttu-id="614ca-103">В данном материале представлен ряд проблем, которые могут возникнуть в приложениях [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], и даны рекомендации, как их избежать или, по крайней мере, снизить их негативное влияние.</span><span class="sxs-lookup"><span data-stu-id="614ca-103">The following information exposes some issues you might encounter in your [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] applications, and provides suggestions to avoid or otherwise reduce the effect of these issues.</span></span>  
  
 <span data-ttu-id="614ca-104">Дополнительные проблемы рассматриваются в [вопросы и ответы](../../../../../../docs/framework/data/adonet/sql/linq/frequently-asked-questions.md).</span><span class="sxs-lookup"><span data-stu-id="614ca-104">Additional issues are addressed in [Frequently Asked Questions](../../../../../../docs/framework/data/adonet/sql/linq/frequently-asked-questions.md).</span></span>  
  
## <a name="unsupported-standard-query-operators"></a><span data-ttu-id="614ca-105">Неподдерживаемые стандартные операторы запросов</span><span class="sxs-lookup"><span data-stu-id="614ca-105">Unsupported Standard Query Operators</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="614ca-106">не поддерживает никакие методы стандартных операторов запросов (например, <xref:System.Linq.Enumerable.ElementAt%2A>).</span><span class="sxs-lookup"><span data-stu-id="614ca-106">does not support all standard query operator methods (for example, <xref:System.Linq.Enumerable.ElementAt%2A>).</span></span> <span data-ttu-id="614ca-107">В результате компилируемых проектов могут по-прежнему возникать ошибки во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="614ca-107">As a result, projects that compile can still produce run-time errors.</span></span> <span data-ttu-id="614ca-108">Дополнительные сведения см. в разделе [преобразование стандартного оператора запросов](../../../../../../docs/framework/data/adonet/sql/linq/standard-query-operator-translation.md).</span><span class="sxs-lookup"><span data-stu-id="614ca-108">For more information, see [Standard Query Operator Translation](../../../../../../docs/framework/data/adonet/sql/linq/standard-query-operator-translation.md).</span></span>  
  
## <a name="memory-issues"></a><span data-ttu-id="614ca-109">Проблемы с использованием памяти</span><span class="sxs-lookup"><span data-stu-id="614ca-109">Memory Issues</span></span>  
 <span data-ttu-id="614ca-110">Если запрос включает в себя коллекцию в памяти и [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <xref:System.Data.Linq.Table%601>, запрос может быть выполнен в памяти, в зависимости от порядка, в котором указаны две коллекции.</span><span class="sxs-lookup"><span data-stu-id="614ca-110">If a query involves an in-memory collection and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <xref:System.Data.Linq.Table%601>, the query might be executed in memory, depending on the order in which the two collections are specified.</span></span> <span data-ttu-id="614ca-111">Если запрос следует выполнить в памяти, извлекать данные из таблицы базы данных нет необходимости.</span><span class="sxs-lookup"><span data-stu-id="614ca-111">If the query must be executed in memory, then the data from the database table will need to be retrieved.</span></span>  
  
 <span data-ttu-id="614ca-112">Этот способ неэффективен и может привести к потреблению значительных ресурсов памяти и процессора.</span><span class="sxs-lookup"><span data-stu-id="614ca-112">This approach is inefficient and could result in significant memory and processor usage.</span></span> <span data-ttu-id="614ca-113">Попытайтесь исключить подобные мультидоменные запросы.</span><span class="sxs-lookup"><span data-stu-id="614ca-113">Try to avoid such multi-domain queries.</span></span>  
  
## <a name="file-names-and-sqlmetal"></a><span data-ttu-id="614ca-114">Имена файлов и средство SQLMetal</span><span class="sxs-lookup"><span data-stu-id="614ca-114">File Names and SQLMetal</span></span>  
 <span data-ttu-id="614ca-115">Чтобы указать имя входного файла, добавьте имя в командную строку в качестве входного файла.</span><span class="sxs-lookup"><span data-stu-id="614ca-115">To specify an input file name, add the name to the command line as the input file.</span></span> <span data-ttu-id="614ca-116">Включение имени файла в строку подключения (параметром **/conn** ) не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="614ca-116">Including the file name in the connection string (using the **/conn** option) is not supported.</span></span> <span data-ttu-id="614ca-117">Дополнительные сведения см. в разделе [SQLMetal.exe (средство создания кода)](../../../../../../docs/framework/tools/sqlmetal-exe-code-generation-tool.md).</span><span class="sxs-lookup"><span data-stu-id="614ca-117">For more information, see [SqlMetal.exe (Code Generation Tool)](../../../../../../docs/framework/tools/sqlmetal-exe-code-generation-tool.md).</span></span>  
  
## <a name="class-library-projects"></a><span data-ttu-id="614ca-118">Проекты библиотеки классов</span><span class="sxs-lookup"><span data-stu-id="614ca-118">Class Library Projects</span></span>  
 <span data-ttu-id="614ca-119">Реляционный конструктор объектов создает строку подключения в `app.config` файле проекта.</span><span class="sxs-lookup"><span data-stu-id="614ca-119">The Object Relational Designer creates a connection string in the `app.config` file of the project.</span></span> <span data-ttu-id="614ca-120">Файл `app.config` не используется в проектах библиотек классов.</span><span class="sxs-lookup"><span data-stu-id="614ca-120">In class library projects, the `app.config` file is not used.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="614ca-121">использует строку соединения, заданную в файлах, созданных во время разработки.</span><span class="sxs-lookup"><span data-stu-id="614ca-121">uses the Connection String provided in the design-time files.</span></span> <span data-ttu-id="614ca-122">Изменение значения в `app.config` не приводит к изменениям базы данных, к которой подключается приложение.</span><span class="sxs-lookup"><span data-stu-id="614ca-122">Changing the value in `app.config` does not change the database to which your application connects.</span></span>  
  
## <a name="cascade-delete"></a><span data-ttu-id="614ca-123">Каскадное удаление</span><span class="sxs-lookup"><span data-stu-id="614ca-123">Cascade Delete</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="614ca-124">не поддерживает или не распознает операции каскадного удаления.</span><span class="sxs-lookup"><span data-stu-id="614ca-124">does not support or recognize cascade-delete operations.</span></span> <span data-ttu-id="614ca-125">Если требуется удалить строку в таблице, имеющей ограничения, необходимо выполнить любое из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="614ca-125">If you want to delete a row in a table that has constraints against it, you must do either of the following:</span></span>  
  
- <span data-ttu-id="614ca-126">Установите правило `ON DELETE CASCADE` в ограничении внешнего ключа в базе данных.</span><span class="sxs-lookup"><span data-stu-id="614ca-126">Set the `ON DELETE CASCADE` rule in the foreign-key constraint in the database.</span></span>  
  
- <span data-ttu-id="614ca-127">Используйте собственный код, чтобы сначала удалить дочерние объекты, не допускающие удаление родительского объекта.</span><span class="sxs-lookup"><span data-stu-id="614ca-127">Use your own code to first delete the child objects that prevent the parent object from being deleted.</span></span>  
  
 <span data-ttu-id="614ca-128">В противном случае возникнет исключение <xref:System.Data.SqlClient.SqlException>.</span><span class="sxs-lookup"><span data-stu-id="614ca-128">Otherwise, a <xref:System.Data.SqlClient.SqlException> exception is thrown.</span></span>  
  
 <span data-ttu-id="614ca-129">Дополнительные сведения см. в разделе [Практическое руководство. Удаление строк из базы данных](../../../../../../docs/framework/data/adonet/sql/linq/how-to-delete-rows-from-the-database.md).</span><span class="sxs-lookup"><span data-stu-id="614ca-129">For more information, see [How to: Delete Rows From the Database](../../../../../../docs/framework/data/adonet/sql/linq/how-to-delete-rows-from-the-database.md).</span></span>  
  
## <a name="expression-not-queryable"></a><span data-ttu-id="614ca-130">Выражение, не подходящее для запроса</span><span class="sxs-lookup"><span data-stu-id="614ca-130">Expression Not Queryable</span></span>  
 <span data-ttu-id="614ca-131">Если вы получаете «выражение [выражение] не поддерживает запросы; Возможно, отсутствует ссылка на сборку?»</span><span class="sxs-lookup"><span data-stu-id="614ca-131">If you get the "Expression [expression] is not queryable; are you missing an assembly reference?"</span></span> <span data-ttu-id="614ca-132">Ошибка, убедитесь, что из следующих:</span><span class="sxs-lookup"><span data-stu-id="614ca-132">error, make sure of the following:</span></span>  
  
- <span data-ttu-id="614ca-133">Приложение предназначено .NET Compact Framework 3.5.</span><span class="sxs-lookup"><span data-stu-id="614ca-133">Your application is targeting .NET Compact Framework 3.5.</span></span>  
  
- <span data-ttu-id="614ca-134">Наличие ссылки на `System.Core.dll` и `System.Data.Linq.dll`.</span><span class="sxs-lookup"><span data-stu-id="614ca-134">You have a reference to `System.Core.dll` and `System.Data.Linq.dll`.</span></span>  
  
- <span data-ttu-id="614ca-135">У вас есть `Imports` (Visual Basic) или `using` директива (C#) для <xref:System.Linq> и <xref:System.Data.Linq>.</span><span class="sxs-lookup"><span data-stu-id="614ca-135">You have an `Imports` (Visual Basic) or `using` (C#) directive for <xref:System.Linq> and <xref:System.Data.Linq>.</span></span>  
  
## <a name="duplicatekeyexception"></a><span data-ttu-id="614ca-136">DuplicateKeyException</span><span class="sxs-lookup"><span data-stu-id="614ca-136">DuplicateKeyException</span></span>  
 <span data-ttu-id="614ca-137">Во время отладки [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] проекта, можно переходить через отношения сущности.</span><span class="sxs-lookup"><span data-stu-id="614ca-137">In the course of debugging a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] project, you might traverse an entity's relations.</span></span> <span data-ttu-id="614ca-138">Таким образом должен связать эти элементы в кэш, и [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] узнает о своем присутствии.</span><span class="sxs-lookup"><span data-stu-id="614ca-138">Doing so brings these items into the cache, and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] becomes aware of their presence.</span></span> <span data-ttu-id="614ca-139">Если после этого предпринимается попытка выполнения метода <xref:System.Data.Linq.Table%601.Attach%2A>, или <xref:System.Data.Linq.Table%601.InsertOnSubmit%2A>, или аналогичного, результатом которого являются несколько строк с одинаковым ключом, создается исключение <xref:System.Data.Linq.DuplicateKeyException>.</span><span class="sxs-lookup"><span data-stu-id="614ca-139">If you then try to execute <xref:System.Data.Linq.Table%601.Attach%2A> or <xref:System.Data.Linq.Table%601.InsertOnSubmit%2A> or a similar method that produces multiple rows that have the same key, a <xref:System.Data.Linq.DuplicateKeyException> is thrown.</span></span>  
  
## <a name="string-concatenation-exceptions"></a><span data-ttu-id="614ca-140">Исключения при объединении строк</span><span class="sxs-lookup"><span data-stu-id="614ca-140">String Concatenation Exceptions</span></span>  
 <span data-ttu-id="614ca-141">Объединение в операндах, сопоставленных с `[n]text` и другими `[n][var]char`, не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="614ca-141">Concatenation on operands mapped to `[n]text` and other `[n][var]char` is not supported.</span></span> <span data-ttu-id="614ca-142">При объединении строк, сопоставленных двум разным наборам типов, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="614ca-142">An exception is thrown for concatenation of strings mapped to the two different sets of types.</span></span> <span data-ttu-id="614ca-143">Дополнительные сведения см. в разделе [методы System.String](../../../../../../docs/framework/data/adonet/sql/linq/system-string-methods.md).</span><span class="sxs-lookup"><span data-stu-id="614ca-143">For more information, see [System.String Methods](../../../../../../docs/framework/data/adonet/sql/linq/system-string-methods.md).</span></span>  
  
## <a name="skip-and-take-exceptions-in-sql-server-2000"></a><span data-ttu-id="614ca-144">Исключения методов "Skip" и "Take" в SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="614ca-144">Skip and Take Exceptions in SQL Server 2000</span></span>  
 <span data-ttu-id="614ca-145">При использовании <xref:System.Data.Linq.Mapping.ColumnAttribute.IsPrimaryKey%2A> или <xref:System.Linq.Queryable.Take%2A> в базе данных SQL Server 2000 необходимо применять члены идентификации (<xref:System.Linq.Queryable.Skip%2A>)</span><span class="sxs-lookup"><span data-stu-id="614ca-145">You must use identity members (<xref:System.Data.Linq.Mapping.ColumnAttribute.IsPrimaryKey%2A>) when you use <xref:System.Linq.Queryable.Take%2A> or <xref:System.Linq.Queryable.Skip%2A> against a SQL Server 2000 database.</span></span> <span data-ttu-id="614ca-146">Запрос должен быть выполнен в одной таблице (без объединения) либо он должен представлять операцию <xref:System.Linq.Queryable.Distinct%2A>, <xref:System.Linq.Queryable.Except%2A>, <xref:System.Linq.Queryable.Intersect%2A> или <xref:System.Linq.Queryable.Union%2A> и не включать операцию <xref:System.Linq.Queryable.Concat%2A> operation.</span><span class="sxs-lookup"><span data-stu-id="614ca-146">The query must be against a single table (that is, not a join), or be a <xref:System.Linq.Queryable.Distinct%2A>, <xref:System.Linq.Queryable.Except%2A>, <xref:System.Linq.Queryable.Intersect%2A>, or <xref:System.Linq.Queryable.Union%2A> operation, and must not include a <xref:System.Linq.Queryable.Concat%2A> operation.</span></span> <span data-ttu-id="614ca-147">Дополнительные сведения см. в разделе «Поддержка SQL Server 2000» [преобразование стандартного оператора запросов](../../../../../../docs/framework/data/adonet/sql/linq/standard-query-operator-translation.md).</span><span class="sxs-lookup"><span data-stu-id="614ca-147">For more information, see the "SQL Server 2000 Support" section in [Standard Query Operator Translation](../../../../../../docs/framework/data/adonet/sql/linq/standard-query-operator-translation.md).</span></span>  
  
 <span data-ttu-id="614ca-148">Это требование не относится к SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="614ca-148">This requirement does not apply to SQL Server 2005.</span></span>  
  
## <a name="groupby-invalidoperationexception"></a><span data-ttu-id="614ca-149">GroupBy InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="614ca-149">GroupBy InvalidOperationException</span></span>  
 <span data-ttu-id="614ca-150">Данное исключение возникает, если в запросе <xref:System.Linq.Enumerable.GroupBy%2A>, выполняющем группировку по выражению `boolean`, например `group x by (Phone==@phone)`, столбец имеет значение NULL.</span><span class="sxs-lookup"><span data-stu-id="614ca-150">This exception is thrown when a column value is null in a <xref:System.Linq.Enumerable.GroupBy%2A> query that groups by a `boolean` expression, such as `group x by (Phone==@phone)`.</span></span> <span data-ttu-id="614ca-151">Поскольку выражение является `boolean`, ключ определяется как `boolean`, а не `nullable` `boolean`.</span><span class="sxs-lookup"><span data-stu-id="614ca-151">Because the expression is a `boolean`, the key is inferred to be `boolean`, not `nullable` `boolean`.</span></span> <span data-ttu-id="614ca-152">При результате преобразованного сравнения выводится значение null, будет предпринята попытка назначить `nullable` `boolean` для `boolean`, и возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="614ca-152">When the translated comparison produces a null, an attempt is made to assign a `nullable` `boolean` to a `boolean`, and the exception is thrown.</span></span>  
  
 <span data-ttu-id="614ca-153">Чтобы избежать такой ситуации (предполагается, что значения NULL оцениваются как ложные), воспользуйтесь следующим способом.</span><span class="sxs-lookup"><span data-stu-id="614ca-153">To avoid this situation (assuming you want to treat nulls as false), use an approach such as the following:</span></span>  
  
 `GroupBy="(Phone != null) && (Phone=@Phone)"`  
  
## <a name="oncreated-partial-method"></a><span data-ttu-id="614ca-154">Разделяемый метод OnCreated()</span><span class="sxs-lookup"><span data-stu-id="614ca-154">OnCreated() Partial Method</span></span>  
 <span data-ttu-id="614ca-155">Созданный метод `OnCreated()` вызывается при каждом вызове конструктора объектов, включая моменты, когда [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] вызывает его для копирования исходных значений.</span><span class="sxs-lookup"><span data-stu-id="614ca-155">The generated method `OnCreated()` is called each time the object constructor is called, including the scenario in which [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] calls the constructor to make a copy for original values.</span></span> <span data-ttu-id="614ca-156">При реализации метода `OnCreated()` в собственном разделяемом классе данное поведение следует принять во внимание.</span><span class="sxs-lookup"><span data-stu-id="614ca-156">Take this behavior into account if you implement the `OnCreated()` method in your own partial class.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="614ca-157">См. также</span><span class="sxs-lookup"><span data-stu-id="614ca-157">See also</span></span>

- [<span data-ttu-id="614ca-158">Поддержка отладки</span><span class="sxs-lookup"><span data-stu-id="614ca-158">Debugging Support</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/debugging-support.md)
- [<span data-ttu-id="614ca-159">Часто задаваемые вопросы</span><span class="sxs-lookup"><span data-stu-id="614ca-159">Frequently Asked Questions</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/frequently-asked-questions.md)
