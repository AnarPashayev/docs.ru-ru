---
title: Запросы к одной таблице (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: 1f4462f617eb81d30f893b52bdc674e1eee8961c
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/03/2020
ms.locfileid: "75634772"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="6d574-102">Запросы к одной таблице (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="6d574-102">Single-Table Queries (LINQ to DataSet)</span></span>
<span data-ttu-id="6d574-103">Запросы LINQ работают с источниками данных, которые реализуют интерфейс <xref:System.Collections.Generic.IEnumerable%601> или интерфейс <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="6d574-103">Language-Integrated Query (LINQ) queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="6d574-104">Класс <xref:System.Data.DataTable> не реализует ни один из интерфейсов, поэтому необходимо вызвать метод <xref:System.Data.DataTableExtensions.AsEnumerable%2A>, если необходимо использовать <xref:System.Data.DataTable> в качестве источника в предложении `From` запроса LINQ.</span><span class="sxs-lookup"><span data-stu-id="6d574-104">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a LINQ query.</span></span>  
  
 <span data-ttu-id="6d574-105">В следующем примере получаются все активные заказы из таблицы SalesOrderHeader и выводится на консоль идентификатор, дата и номер заказа.</span><span class="sxs-lookup"><span data-stu-id="6d574-105">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)] 
  
 <span data-ttu-id="6d574-106">Запрос локальной переменной инициализируется выражением запроса, которое работает с одним или несколькими источниками данных, применяя один или несколько операторов запроса либо к стандартным операторам запроса, либо в случае с LINQ to DataSet операторами, характерными для класса <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="6d574-106">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="6d574-107">Выражение запроса в предыдущем примере использует два стандартных оператора запроса: `Where` и `Select`.</span><span class="sxs-lookup"><span data-stu-id="6d574-107">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="6d574-108">Предложение `Where` фильтрует последовательность на основе состояния. В данном случае переменная `OnlineOrderFlag` установлена в `true`.</span><span class="sxs-lookup"><span data-stu-id="6d574-108">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="6d574-109">Оператор `Select` назначает и возвращает перечислимый объект, который перехватывает параметры, передаваемые оператору.</span><span class="sxs-lookup"><span data-stu-id="6d574-109">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="6d574-110">В предыдущем примере анонимный тип создан с тремя свойствами: `SalesOrderID`, `OrderDate`, `SalesOrderNumber`.</span><span class="sxs-lookup"><span data-stu-id="6d574-110">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="6d574-111">Этим трем свойствам присвоены значения из столбцов `SalesOrderID`, `OrderDate` и `SalesOrderNumber` таблицы `SalesOrderHeader`.</span><span class="sxs-lookup"><span data-stu-id="6d574-111">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="6d574-112">Затем цикл `foreach` проходит по перечислимому объекту, возвращенному оператором `Select`, и выдает результаты запроса.</span><span class="sxs-lookup"><span data-stu-id="6d574-112">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="6d574-113">Так как этот запрос имеет тип <xref:System.Linq.Enumerable>, который реализует интерфейс <xref:System.Collections.Generic.IEnumerable%601>, результат запроса откладывается до тех пор, пока переменная запроса проходит по циклу `foreach`.</span><span class="sxs-lookup"><span data-stu-id="6d574-113">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="6d574-114">Отложенный результат запроса позволяет запросам храниться в виде значений, которые могут вычисляться несколько раз, каждый раз давая потенциально различные результаты.</span><span class="sxs-lookup"><span data-stu-id="6d574-114">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="6d574-115">Метод <xref:System.Data.DataRowExtensions.Field%2A> обеспечивает доступ к значениям столбцов <xref:System.Data.DataRow> и <xref:System.Data.DataRowExtensions.SetField%2A> (что не показано в предыдущем примере) и устанавливает значения столбцов в <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="6d574-115">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="6d574-116">Оба метода, <xref:System.Data.DataRowExtensions.Field%2A> и <xref:System.Data.DataRowExtensions.SetField%2A>, обрабатывают типы, допускающие значения NULL, поэтому нет необходимости явно проводить проверку на значения NULL.</span><span class="sxs-lookup"><span data-stu-id="6d574-116">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="6d574-117">Оба метода являются универсальными методами, что означает, что нет необходимости приводить тип возвращаемого значения.</span><span class="sxs-lookup"><span data-stu-id="6d574-117">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="6d574-118">В <xref:System.Data.DataRow> нужно использовать предопределенный метод доступа к столбцам (например, `o["OrderDate"]`), однако в этом случае приведение возвращаемого объекта к соответствующему типу обязательно.</span><span class="sxs-lookup"><span data-stu-id="6d574-118">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="6d574-119">Если столбец допускает значение NULL, необходимо проверить его на значение NULL, используя метод <xref:System.Data.DataRow.IsNull%2A>.</span><span class="sxs-lookup"><span data-stu-id="6d574-119">If the column is nullable you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="6d574-120">Дополнительные сведения см. в разделе [универсальные методы полей и SetField](generic-field-and-setfield-methods-linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="6d574-120">For more information, see [Generic Field and SetField Methods](generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="6d574-121">Обратите внимание, что тип данных, определяемый в универсальном параметре `T` методов <xref:System.Data.DataRowExtensions.Field%2A> и <xref:System.Data.DataRowExtensions.SetField%2A>, должен соответствовать типу базового значения, иначе сформируется исключение <xref:System.InvalidCastException>.</span><span class="sxs-lookup"><span data-stu-id="6d574-121">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="6d574-122">Указанное имя столбца должно совпадать с именем столбца в <xref:System.Data.DataSet>, иначе это вызовет исключение <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="6d574-122">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="6d574-123">В обоих случаях исключении возникает при перечислении данных во время выполнения в момент выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="6d574-123">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6d574-124">См. также:</span><span class="sxs-lookup"><span data-stu-id="6d574-124">See also</span></span>

- [<span data-ttu-id="6d574-125">Запросы между таблицами</span><span class="sxs-lookup"><span data-stu-id="6d574-125">Cross-Table Queries</span></span>](cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="6d574-126">Запрос к типизированным объектам DataSet</span><span class="sxs-lookup"><span data-stu-id="6d574-126">Querying Typed DataSets</span></span>](querying-typed-datasets.md)
- [<span data-ttu-id="6d574-127">Универсальные методы Field и SetField</span><span class="sxs-lookup"><span data-stu-id="6d574-127">Generic Field and SetField Methods</span></span>](generic-field-and-setfield-methods-linq-to-dataset.md)
