---
title: LINQ и ADO.NET
titleSuffix: ''
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: c5b56fa78ce0276953597d63b3d6e2f45d88c8ab
ms.sourcegitcommit: 011314e0c8eb4cf4a11d92078f58176c8c3efd2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/09/2020
ms.locfileid: "77094440"
---
# <a name="linq-and-adonet"></a>LINQ и ADO.NET

Сегодня многие бизнес-разработчики должны использовать два (или более) языка программирования: высокоуровневый язык для бизнес-логики и уровней представления (таких как Visual C# или Visual Basic) и язык запросов для взаимодействия с базой данных (например, TRANSACT-SQL). Для эффективной работы разработчик должен хорошо владеть несколькими языками, кроме того, возникают несоответствия между языками в среде разработки. Например, приложение, которое использует API для доступа к данным, чтобы выполнить запрос к базе данных, указывает запрос как строковый литерал в кавычках. Эта строка запроса не читается компилятором и не проверяется на наличие ошибок, таких как недопустимый синтаксис или наличие в действительности столбцов или строк, на которые он ссылается. Нет проверки соответствия типов параметров запроса и технологии `IntelliSense`.  
  
 LINQ позволяет разработчикам формировать запросы на основе наборов в своем коде приложения без использования отдельного языка запросов. Можно создавать запросы LINQ к различным перечислимым источникам данных (то есть к источнику данных, реализующему интерфейс <xref:System.Collections.IEnumerable>), например к структурам данных в памяти, XML-документам, базам данных SQL и <xref:System.Data.DataSet> объектам. Несмотря на то что эти перечислимые источники данных реализованы различными способами, во всех них используется одинаковый синтаксис и языковые конструкции. Из-за того что запросы могут быть сформированы на языке программирования, нет необходимости использовать другой язык запросов, внедренный в виде строковых литералов, которые не могут быть проверены компилятором. Интеграция запросов в язык программирования также позволяет программистам Visual Studio повысить производительность благодаря обеспечению проверки типа и синтаксиса во время компиляции, а также `IntelliSense`. Эти функции уменьшают затраты на отладку запросов и поиск ошибок.  
  
 Передача данных из таблиц SQL в объекты в памяти часто бывает сложной и способствует совершению ошибок. Поставщик LINQ, реализованный LINQ to DataSet и [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], преобразует исходные данные в коллекции объектов на основе <xref:System.Collections.IEnumerable>. Программист всегда видит данные как коллекции <xref:System.Collections.IEnumerable> как при запросе, так и при обновлении. Для написания запросов к этим коллекциям предоставлена полная поддержка технологии `IntelliSense`.  
  
 Существует три отдельные технологии LINQ: LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]и LINQ to Entities. LINQ to DataSet предоставляет более широкие, оптимизированные запросы к <xref:System.Data.DataSet> и [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] позволяет напрямую запрашивать SQL Server схемы баз данных, а LINQ to Entities позволяет запрашивать EDM.  
  
 На следующей схеме даны общие сведения о связи технологий ADO.NET LINQ с высокоуровневыми языками программирования и источниками данных с поддержкой LINQ.  
  
 ![Обзор LINQ to ADO.NET](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")  
  
 Дополнительные сведения о LINQ см. в разделе [LINQ](../../../csharp/programming-guide/concepts/linq/index.md).
  
 В следующих разделах содержатся дополнительные сведения о LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]и LINQ to Entities.  
  
## <a name="linq-to-dataset"></a>LINQ to DataSet  
 <xref:System.Data.DataSet> является ключевым элементом модели отсоединенного программирования, которая основана на ADO.NET и широко используется. LINQ to DataSet позволяет разработчикам создавать более широкие возможности запросов в <xref:System.Data.DataSet> с помощью того же механизма формулировку запросов, который доступен для многих других источников данных. Дополнительные сведения см. в разделе [LINQ to DataSet](linq-to-dataset.md).  
  
## <a name="linq-to-sql"></a>LINQ to SQL  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] - удобный инструмент для разработчиков, которым необязательно сопоставление с концептуальной моделью. С помощью [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]можно использовать модель программирования LINQ непосредственно над существующей схемой базы данных. [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] позволяет разработчикам создавать .NET Framework классы, представляющие данные. Вместо сопоставления с концептуальной моделью эти созданные классы указывают напрямую на таблицы базы данных, представления, хранимые процедуры и определяемые пользователем функции.  
  
 С помощью [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]разработчики могут писать код непосредственно в схеме хранилища, используя тот же шаблон программирования LINQ, что и в коллекциях в памяти, и <xref:System.Data.DataSet>, в дополнение к другим источникам данных, таким как XML. Для получения дополнительной информации см. [LINQ to SQL](./sql/linq/index.md).  
  
## <a name="linq-to-entities"></a>LINQ to Entities  
 Большинство приложений на данный момент создаются на основе реляционных баз данных. Этим приложениям необходимо взаимодействовать с данными, представленными в реляционном виде. Схемы баз данных не всегда идеально подходят для создания приложений, а концептуальные модели приложений не всегда совпадают с логическими моделями баз данных. EDM представляет собой концептуальную модель данных, которую можно использовать для моделирования данных определенного домена, чтобы приложения могли взаимодействовать с данными в виде объектов. Дополнительные сведения см. в разделе [ADO.NET Entity Framework](./ef/index.md).  
  
 В модели EDM реляционные данные представлены в виде объектов в среде .NET. Благодаря этому поддержка LINQ эффективно реализуется на уровне объектов, что позволяет составлять запросы баз данных на языке, используемом для сборки бизнес-логики. Эта функция называется LINQ to Entities. Дополнительные сведения см. в разделе [LINQ to Entities](./ef/language-reference/linq-to-entities.md).  
  
## <a name="see-also"></a>См. также раздел

- [LINQ to DataSet](linq-to-dataset.md)
- [LINQ to SQL](./sql/linq/index.md)
- [LINQ to Entities](./ef/language-reference/linq-to-entities.md)
- [LINQ](../../../csharp/programming-guide/concepts/linq/index.md)
- [Общие сведения об ADO.NET](ado-net-overview.md)
