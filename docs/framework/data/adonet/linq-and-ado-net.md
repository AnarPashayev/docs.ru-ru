---
title: LINQ и ADO.NET
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: 79d6c52656e545c07260f3a97b089c238a74db3c
ms.sourcegitcommit: c7a7e1468bf0fa7f7065de951d60dfc8d5ba89f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2019
ms.locfileid: "65583522"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="35006-102">LINQ и ADO.NET</span><span class="sxs-lookup"><span data-stu-id="35006-102">LINQ and ADO.NET</span></span>
<span data-ttu-id="35006-103">В настоящее время многие разработчики бизнес-приложений должны использовать два (или более) языка программирования: язык высокого уровня для бизнес-логики и презентации уровней (например, Visual C# или Visual Basic) и язык запросов для взаимодействия с базой данных (такие как [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="35006-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span></span> <span data-ttu-id="35006-104">Для эффективной работы разработчик должен хорошо владеть несколькими языками, кроме того, возникают несоответствия между языками в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="35006-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="35006-105">Например, приложение, которое использует API для доступа к данным, чтобы выполнить запрос к базе данных, указывает запрос как строковый литерал в кавычках.</span><span class="sxs-lookup"><span data-stu-id="35006-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="35006-106">Такая строка запроса не читается компилятором и не проверяется на наличие синтаксических ошибок или наличие используемых строк или столбцов.</span><span class="sxs-lookup"><span data-stu-id="35006-106">This query string is un-readable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="35006-107">Нет проверки соответствия типов параметров запроса и технологии `IntelliSense`.</span><span class="sxs-lookup"><span data-stu-id="35006-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] <span data-ttu-id="35006-108">позволяет разработчикам формировать в программном коде запросы, основанные на наборах, без использования дополнительного языка запросов.</span><span class="sxs-lookup"><span data-stu-id="35006-108">enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="35006-109">Можно писать запросы [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] к различным перечислимым источникам данных (источникам данных, которые реализуют интерфейс <xref:System.Collections.IEnumerable>), таким как хранимые в памяти структуры данных, XML-документы, базы данных SQL и объекты <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="35006-109">You can write [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="35006-110">Несмотря на то что эти перечислимые источники данных реализованы различными способами, во всех них используется одинаковый синтаксис и языковые конструкции.</span><span class="sxs-lookup"><span data-stu-id="35006-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="35006-111">Из-за того что запросы могут быть сформированы на языке программирования, нет необходимости использовать другой язык запросов, внедренный в виде строковых литералов, которые не могут быть проверены компилятором.</span><span class="sxs-lookup"><span data-stu-id="35006-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="35006-112">Встраивание запросов в язык программирования позволяет программистам работать более производительно, предоставляя типов во время компиляции и проверки синтаксиса, Visual Studio и `IntelliSense`.</span><span class="sxs-lookup"><span data-stu-id="35006-112">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="35006-113">Эти функции уменьшают затраты на отладку запросов и поиск ошибок.</span><span class="sxs-lookup"><span data-stu-id="35006-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="35006-114">Передача данных из таблиц SQL в объекты в памяти часто бывает сложной и способствует совершению ошибок.</span><span class="sxs-lookup"><span data-stu-id="35006-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="35006-115">Поставщик [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)], реализованный в [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] и [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], преобразует исходные данные в данные, основанные на коллекции объектов, реализующих интерфейс <xref:System.Collections.IEnumerable>.</span><span class="sxs-lookup"><span data-stu-id="35006-115">The [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provider implemented by [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="35006-116">Программист всегда видит данные как коллекции <xref:System.Collections.IEnumerable> как при запросе, так и при обновлении.</span><span class="sxs-lookup"><span data-stu-id="35006-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="35006-117">Для написания запросов к этим коллекциям предоставлена полная поддержка технологии `IntelliSense`.</span><span class="sxs-lookup"><span data-stu-id="35006-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="35006-118">Существуют три отдельные технологии ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]: [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] и [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span><span class="sxs-lookup"><span data-stu-id="35006-118">There are three separate ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] technologies: [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] <span data-ttu-id="35006-119">обеспечивает расширенные и оптимизированные запросы к <xref:System.Data.DataSet> и [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] позволяет непосредственно запрашивать схемы баз данных SQL Server, и [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] позволяет запрашивать [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span><span class="sxs-lookup"><span data-stu-id="35006-119">provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] allows you to query an [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span></span>  
  
 <span data-ttu-id="35006-120">На следующей схеме даны общие сведения о связи технологий ADO.NET LINQ с высокоуровневыми языками программирования и источниками данных с поддержкой LINQ.</span><span class="sxs-lookup"><span data-stu-id="35006-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="35006-121">![LINQ к обзору ADO.NET](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="35006-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="35006-122">Дополнительные сведения о LINQ см. в разделе [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span><span class="sxs-lookup"><span data-stu-id="35006-122">For more information about LINQ, see [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span></span>
  
 <span data-ttu-id="35006-123">В следующих подразделах приведены дополнительные сведения о технологиях [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] и [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span><span class="sxs-lookup"><span data-stu-id="35006-123">The following sections provide more information about [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="35006-124">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="35006-124">LINQ to DataSet</span></span>  
 <span data-ttu-id="35006-125"><xref:System.Data.DataSet> является важнейшим и широко используемым элементом модели программирования с кэшированием данных, на основе которой построен [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)].</span><span class="sxs-lookup"><span data-stu-id="35006-125">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is built on, and is widely used.</span></span> <span data-ttu-id="35006-126">Технология [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] позволяет разработчикам создавать более функциональные запросы к <xref:System.Data.DataSet> с помощью механизма формирования запросов, который поддерживается для множества других источников данных.</span><span class="sxs-lookup"><span data-stu-id="35006-126">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="35006-127">Дополнительные сведения см. в разделе [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="35006-127">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="35006-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="35006-128">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="35006-129">- удобный инструмент для разработчиков, которым необязательно сопоставление с концептуальной моделью.</span><span class="sxs-lookup"><span data-stu-id="35006-129">is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="35006-130">Использование [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] дает возможность напрямую использовать модель программирования [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] с существующей схемой базы данных.</span><span class="sxs-lookup"><span data-stu-id="35006-130">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming model directly over existing database schema.</span></span> [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="35006-131">Разработчики могут создавать классы .NET Framework, которые представляют данные.</span><span class="sxs-lookup"><span data-stu-id="35006-131">enables developers to generate .NET Framework classes that represent data.</span></span> <span data-ttu-id="35006-132">Вместо сопоставления с концептуальной моделью эти созданные классы указывают напрямую на таблицы базы данных, представления, хранимые процедуры и определяемые пользователем функции.</span><span class="sxs-lookup"><span data-stu-id="35006-132">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="35006-133">С помощью [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] можно писать код, направленный прямо к схеме хранилища, используя те же программные шаблоны [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)], что и для коллекций в памяти и <xref:System.Data.DataSet>, а также к другим источникам данных, таким как XML.</span><span class="sxs-lookup"><span data-stu-id="35006-133">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="35006-134">Дополнительные сведения см. в разделе [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span><span class="sxs-lookup"><span data-stu-id="35006-134">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="35006-135">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="35006-135">LINQ to Entities</span></span>  
 <span data-ttu-id="35006-136">Большинство приложений на данный момент создаются на основе реляционных баз данных.</span><span class="sxs-lookup"><span data-stu-id="35006-136">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="35006-137">Этим приложениям необходимо взаимодействовать с данными, представленными в реляционном виде.</span><span class="sxs-lookup"><span data-stu-id="35006-137">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="35006-138">Схемы баз данных не всегда идеально подходят для создания приложений, а концептуальные модели приложений не всегда совпадают с логическими моделями баз данных.</span><span class="sxs-lookup"><span data-stu-id="35006-138">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="35006-139">[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] представляет собой концептуальную модель данных, которую можно использовать для моделирования данных конкретного домена, что позволяет приложениям взаимодействовать с данными как с объектами.</span><span class="sxs-lookup"><span data-stu-id="35006-139">The [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="35006-140">См. в разделе [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) Дополнительные сведения.</span><span class="sxs-lookup"><span data-stu-id="35006-140">See [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) for more information.</span></span>  
  
 <span data-ttu-id="35006-141">В модели [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] реляционные данные представлены в виде объектов в среде .NET.</span><span class="sxs-lookup"><span data-stu-id="35006-141">Through the [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)], relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="35006-142">Благодаря этому поддержка [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] эффективно реализуется на уровне объектов, что позволяет составлять запросы баз данных на языке, используемом для сборки бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="35006-142">This makes the object layer an ideal target for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="35006-143">Эта функция называется [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span><span class="sxs-lookup"><span data-stu-id="35006-143">This capability is known as [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> <span data-ttu-id="35006-144">Дополнительные сведения см. в разделе [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md).</span><span class="sxs-lookup"><span data-stu-id="35006-144">See [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md) for more information.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="35006-145">См. также</span><span class="sxs-lookup"><span data-stu-id="35006-145">See also</span></span>

- [<span data-ttu-id="35006-146">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="35006-146">LINQ to DataSet</span></span>](../../../../docs/framework/data/adonet/linq-to-dataset.md)
- [<span data-ttu-id="35006-147">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="35006-147">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)
- [<span data-ttu-id="35006-148">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="35006-148">LINQ to Entities</span></span>](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)
- [<span data-ttu-id="35006-149">LINQ</span><span class="sxs-lookup"><span data-stu-id="35006-149">Language Integrated Query (LINQ)</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="35006-150">Общие сведения об ADO.NET</span><span class="sxs-lookup"><span data-stu-id="35006-150">ADO.NET Overview</span></span>](ado-net-overview.md)
