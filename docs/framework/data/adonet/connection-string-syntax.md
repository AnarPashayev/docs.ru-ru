---
title: Синтаксис строки подключения
ms.date: 05/22/2018
ms.assetid: 0977aeee-04d1-4cce-bbed-750c77fce06e
ms.openlocfilehash: 9e9e330b7195e5c04b6e9e2d086a04209e1c0e13
ms.sourcegitcommit: ad800f019ac976cb669e635fb0ea49db740e6890
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73040148"
---
# <a name="connection-string-syntax"></a><span data-ttu-id="b39a8-102">Синтаксис строки подключения</span><span class="sxs-lookup"><span data-stu-id="b39a8-102">Connection String Syntax</span></span>
<span data-ttu-id="b39a8-103">Каждый поставщик данных платформы .NET Framework имеет объект `Connection`, наследующий из <xref:System.Data.Common.DbConnection>, а также из свойства <xref:System.Data.Common.DbConnection.ConnectionString%2A>, зависящего от поставщика.</span><span class="sxs-lookup"><span data-stu-id="b39a8-103">Each .NET Framework data provider has a `Connection` object that inherits from <xref:System.Data.Common.DbConnection> as well as a provider-specific <xref:System.Data.Common.DbConnection.ConnectionString%2A> property.</span></span> <span data-ttu-id="b39a8-104">Конкретный синтаксис строки подключения для каждого поставщика приведен в его свойстве `ConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-104">The specific connection string syntax for each provider is documented in its `ConnectionString` property.</span></span> <span data-ttu-id="b39a8-105">В следующей таблице представлен список четырех поставщиков данных, поставляемых в составе платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b39a8-105">The following table lists the four data providers that are included in the .NET Framework.</span></span>  
  
|<span data-ttu-id="b39a8-106">Поставщик данных .NET Framework</span><span class="sxs-lookup"><span data-stu-id="b39a8-106">.NET Framework data provider</span></span>|<span data-ttu-id="b39a8-107">Описание</span><span class="sxs-lookup"><span data-stu-id="b39a8-107">Description</span></span>|  
|----------------------------------|-----------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="b39a8-108">Предоставляет доступ к данным для Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b39a8-108">Provides data access for Microsoft SQL Server.</span></span> <span data-ttu-id="b39a8-109">Дополнительные сведения о синтаксисе строки подключения см. в разделе <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-109">For more information on connection string syntax, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="b39a8-110">Предоставляет доступ к данным источников данных OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b39a8-110">Provides data access for data sources exposed using OLE DB.</span></span> <span data-ttu-id="b39a8-111">Дополнительные сведения о синтаксисе строки подключения см. в разделе <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-111">For more information on connection string syntax, see <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A>.</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="b39a8-112">Предоставляет доступ к данным источников данных ODBC.</span><span class="sxs-lookup"><span data-stu-id="b39a8-112">Provides data access for data sources exposed using ODBC.</span></span> <span data-ttu-id="b39a8-113">Дополнительные сведения о синтаксисе строки подключения см. в разделе <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-113">For more information on connection string syntax, see <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A>.</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="b39a8-114">Предоставляет доступ к данным Oracle версии 8.1.7 или старше.</span><span class="sxs-lookup"><span data-stu-id="b39a8-114">Provides data access for Oracle version 8.1.7 or later.</span></span> <span data-ttu-id="b39a8-115">Дополнительные сведения о синтаксисе строки подключения см. в разделе <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-115">For more information on connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span></span>|  
  
## <a name="connection-string-builders"></a><span data-ttu-id="b39a8-116">Построители строк подключения</span><span class="sxs-lookup"><span data-stu-id="b39a8-116">Connection String Builders</span></span>  
 <span data-ttu-id="b39a8-117">В ADO.NET 2.0 появились указанные ниже построители строк соединения для поставщиков данных .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b39a8-117">ADO.NET 2.0 introduced the following connection string builders for the .NET Framework data providers.</span></span>  
  
- <xref:System.Data.SqlClient.SqlConnectionStringBuilder>  
  
- <xref:System.Data.OleDb.OleDbConnectionStringBuilder>  
  
- <xref:System.Data.Odbc.OdbcConnectionStringBuilder>  
  
- <xref:System.Data.OracleClient.OracleConnectionStringBuilder>  
  
 <span data-ttu-id="b39a8-118">Построители строк соединения позволяют создавать во время выполнения синтаксически правильные строки соединения, и поэтому в коде не требуется вручную объединять значения строк соединения.</span><span class="sxs-lookup"><span data-stu-id="b39a8-118">The connection string builders allow you to construct syntactically valid connection strings at run time, so you do not have to manually concatenate connection string values in your code.</span></span> <span data-ttu-id="b39a8-119">Дополнительные сведения см. в статье [Connection String Builders](connection-string-builders.md) (Построители строк подключения).</span><span class="sxs-lookup"><span data-stu-id="b39a8-119">For more information, see [Connection String Builders](connection-string-builders.md).</span></span>  

## <a name="windows-authentication"></a><span data-ttu-id="b39a8-120">Проверка подлинности Windows</span><span class="sxs-lookup"><span data-stu-id="b39a8-120">Windows Authentication</span></span>  
 <span data-ttu-id="b39a8-121">Мы рекомендуем использовать проверку подлинности Windows (иногда называемую *встроенной безопасностью*) для подключения к источникам данных, которые его поддерживают.</span><span class="sxs-lookup"><span data-stu-id="b39a8-121">We recommend using Windows Authentication (sometimes referred to as *integrated security*) to connect to data sources that support it.</span></span> <span data-ttu-id="b39a8-122">Синтаксис строки подключения зависит от поставщика.</span><span class="sxs-lookup"><span data-stu-id="b39a8-122">The syntax employed in the connection string varies by provider.</span></span> <span data-ttu-id="b39a8-123">В следующей таблице показан синтаксис проверки подлинности Windows, который используется с поставщиками данных платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b39a8-123">The following table shows the Windows Authentication syntax used with the .NET Framework data providers.</span></span>  
  
|<span data-ttu-id="b39a8-124">Поставщик</span><span class="sxs-lookup"><span data-stu-id="b39a8-124">Provider</span></span>|<span data-ttu-id="b39a8-125">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="b39a8-125">Syntax</span></span>|  
|--------------|------------|  
|`SqlClient`|`Integrated Security=true;`<br /><br /> `-- or --`<br /><br /> `Integrated Security=SSPI;`|  
|`OleDb`|`Integrated Security=SSPI;`|  
|`Odbc`|`Trusted_Connection=yes;`|  
|`OracleClient`|`Integrated Security=yes;`|  
  
> [!NOTE]
> <span data-ttu-id="b39a8-126">Значение `Integrated Security=true` вызывает исключение при работе с поставщиком `OleDb`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-126">`Integrated Security=true` throws an exception when used with the `OleDb` provider.</span></span>  
  
## <a name="sqlclient-connection-strings"></a><span data-ttu-id="b39a8-127">Строки подключения SqlClient</span><span class="sxs-lookup"><span data-stu-id="b39a8-127">SqlClient Connection Strings</span></span>  
<span data-ttu-id="b39a8-128">Синтаксис для строки подключения <xref:System.Data.SqlClient.SqlConnection> документирован в свойстве <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-128">The syntax for a <xref:System.Data.SqlClient.SqlConnection> connection string is documented in the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b39a8-129">Свойство <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> используется для возврата или задания строки подключения для базы данных SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b39a8-129">You can use the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> property to get or set a connection string for a SQL Server database.</span></span> <span data-ttu-id="b39a8-130">Если необходимо подключиться к более ранней версии SQL Server, следует использовать поставщик данных .NET Framework для OleDb (<xref:System.Data.OleDb>).</span><span class="sxs-lookup"><span data-stu-id="b39a8-130">If you need to connect to an earlier version of SQL Server, you must use the .NET Framework Data Provider for OleDb (<xref:System.Data.OleDb>).</span></span> <span data-ttu-id="b39a8-131">Наиболее распространенные ключевые слова строк соединения также соответствуют свойствам <xref:System.Data.SqlClient.SqlConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-131">Most connection string keywords also map to properties in the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="b39a8-132">Значением по умолчанию для ключевого слова `Persist Security Info` является `false`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-132">The default setting for the `Persist Security Info` keyword is `false`.</span></span> <span data-ttu-id="b39a8-133">Значение `true` или `yes` позволяет получить из строки соединения конфиденциальные данные (в том числе идентификатор пользователя и пароль) после открытия соединения.</span><span class="sxs-lookup"><span data-stu-id="b39a8-133">Setting it to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened.</span></span> <span data-ttu-id="b39a8-134">Установите для параметра `Persist Security Info` значение `false`, чтобы убедиться, что ненадежный источник не имеет доступа к конфиденциальным данным строки подключения.</span><span class="sxs-lookup"><span data-stu-id="b39a8-134">Keep `Persist Security Info` set to `false` to ensure that an untrusted source does not have access to sensitive connection string information.</span></span>  

### <a name="windows-authentication-with-sqlclient"></a><span data-ttu-id="b39a8-135">Проверка подлинности Windows с помощью SqlClient</span><span class="sxs-lookup"><span data-stu-id="b39a8-135">Windows authentication with SqlClient</span></span> 
 <span data-ttu-id="b39a8-136">Каждая из следующих форм синтаксиса использует проверку подлинности Windows для подключения к базе данных **AdventureWorks** на локальном сервере.</span><span class="sxs-lookup"><span data-stu-id="b39a8-136">Each of the following forms of syntax uses Windows Authentication to connect to the **AdventureWorks** database on a local server.</span></span>  
  
```csharp  
"Persist Security Info=False;Integrated Security=true;  
    Initial Catalog=AdventureWorks;Server=MSSQL1"  
"Persist Security Info=False;Integrated Security=SSPI;  
    database=AdventureWorks;server=(local)"  
"Persist Security Info=False;Trusted_Connection=True;  
    database=AdventureWorks;server=(local)"  
```  
  
### <a name="sql-server-authentication-with-sqlclient"></a><span data-ttu-id="b39a8-137">Проверка подлинности SQL Server с помощью SqlClient</span><span class="sxs-lookup"><span data-stu-id="b39a8-137">SQL Server authentication with SqlClient</span></span>   
 <span data-ttu-id="b39a8-138">Для соединения с SQL Server предпочтительно использовать проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="b39a8-138">Windows Authentication is preferred for connecting to SQL Server.</span></span> <span data-ttu-id="b39a8-139">Однако если требуется проверка подлинности SQL Server, то имя пользователя и пароль указываются с помощью приведенного ниже синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="b39a8-139">However, if SQL Server Authentication is required, use the following syntax to specify a user name and password.</span></span> <span data-ttu-id="b39a8-140">В этом примере символы звездочки представляют допустимое имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="b39a8-140">In this example, asterisks are used to represent a valid user name and password.</span></span>  
  
```csharp  
"Persist Security Info=False;User ID=*****;Password=*****;Initial Catalog=AdventureWorks;Server=MySqlServer"  
```  

<span data-ttu-id="b39a8-141">При подключении к базе данных SQL Azure или к хранилищу данных SQL Azure и предоставлении имени входа в формате `user@servername`убедитесь, что значение `servername` в имени входа соответствует значению, указанному для `Server=`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-141">When you connect to Azure SQL Database or to Azure SQL Data Warehouse and provide a login in the format `user@servername`, make sure that the `servername` value in the login matches the value provided for `Server=`.</span></span>

> [!NOTE]
> <span data-ttu-id="b39a8-142">Проверка подлинности Windows имеет приоритет над именами входа SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b39a8-142">Windows authentication takes precedence over SQL Server logins.</span></span> <span data-ttu-id="b39a8-143">Если указать значение Integrated Security=true, а также ввести имя пользователя и пароль, то имя пользователя и пароль не будут учитываться и будет применяться проверка подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="b39a8-143">If you specify both Integrated Security=true as well as a user name and password, the user name and password will be ignored and Windows authentication will be used.</span></span>  

### <a name="connect-to-a-named-instance-of-sql-server"></a><span data-ttu-id="b39a8-144">Подключение к именованному экземпляру SQL Server</span><span class="sxs-lookup"><span data-stu-id="b39a8-144">Connect to a named instance of SQL Server</span></span>
<span data-ttu-id="b39a8-145">Чтобы подключиться к именованному экземпляру SQL Server, используйте синтаксис *имени сервера \ экземпляр* .</span><span class="sxs-lookup"><span data-stu-id="b39a8-145">To connect to a named instance of SQL Server, use the *server name\instance name* syntax.</span></span>  
  
```csharp  
"Data Source=MySqlServer\MSSQL1;"  
```  

<span data-ttu-id="b39a8-146">Кроме того, в свойстве <xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A> объекта `SqlConnectionStringBuilder` можно задать имя экземпляра при построении строки подключения.</span><span class="sxs-lookup"><span data-stu-id="b39a8-146">You can also set the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A> property of the `SqlConnectionStringBuilder` to the instance name when building a connection string.</span></span> <span data-ttu-id="b39a8-147">Свойство <xref:System.Data.SqlClient.SqlConnection.DataSource%2A> объекта <xref:System.Data.SqlClient.SqlConnection> доступно только для чтения.</span><span class="sxs-lookup"><span data-stu-id="b39a8-147">The <xref:System.Data.SqlClient.SqlConnection.DataSource%2A> property of a <xref:System.Data.SqlClient.SqlConnection> object is read-only.</span></span>  
  
### <a name="type-system-version-changes"></a><span data-ttu-id="b39a8-148">Изменения версий системы типов</span><span class="sxs-lookup"><span data-stu-id="b39a8-148">Type System Version Changes</span></span>  
 <span data-ttu-id="b39a8-149">Ключевое слово `Type System Version` в <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> указывает представление типов SQL Server на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="b39a8-149">The `Type System Version` keyword in a <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> specifies the client-side representation of SQL Server types.</span></span> <span data-ttu-id="b39a8-150">Дополнительные сведения о ключевом слове <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> см. в разделе `Type System Version`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-150">See <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> for more information about the `Type System Version` keyword.</span></span>  
  
## <a name="connecting-and-attaching-to-sql-server-express-user-instances"></a><span data-ttu-id="b39a8-151">Подключение и присоединение к пользовательским экземплярам SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="b39a8-151">Connecting and Attaching to SQL Server Express User Instances</span></span>  
 <span data-ttu-id="b39a8-152">Пользовательские экземпляры являются одной из возможностей SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="b39a8-152">User instances are a feature in SQL Server Express.</span></span> <span data-ttu-id="b39a8-153">Они дают пользователям под учетной записью с минимальными правами возможность присоединить и запустить базу данных SQL Server без прав администратора.</span><span class="sxs-lookup"><span data-stu-id="b39a8-153">They allow a user running on a least-privileged local Windows account to attach and run a SQL Server database without requiring administrative privileges.</span></span> <span data-ttu-id="b39a8-154">Пользовательский экземпляр выполняется с учетными данными пользователя Windows, а не службы.</span><span class="sxs-lookup"><span data-stu-id="b39a8-154">A user instance executes with the user's Windows credentials, not as a service.</span></span>  
  
 <span data-ttu-id="b39a8-155">Дополнительные сведения о работе с пользовательскими экземплярами см. в разделе [SQL Server Express User Instances](./sql/sql-server-express-user-instances.md).</span><span class="sxs-lookup"><span data-stu-id="b39a8-155">For more information on working with user instances, see [SQL Server Express User Instances](./sql/sql-server-express-user-instances.md).</span></span>  
  
## <a name="using-trustservercertificate"></a><span data-ttu-id="b39a8-156">Использование ключевого слова TrustServerCertificate</span><span class="sxs-lookup"><span data-stu-id="b39a8-156">Using TrustServerCertificate</span></span>  
 <span data-ttu-id="b39a8-157">Ключевое слово `TrustServerCertificate` допустимо только при подключении к экземпляру SQL Server с действительным сертификатом.</span><span class="sxs-lookup"><span data-stu-id="b39a8-157">The `TrustServerCertificate` keyword is valid only when connecting to a SQL Server instance with a valid certificate.</span></span> <span data-ttu-id="b39a8-158">Если ключевому слову `TrustServerCertificate` присвоено значение `true`, то транспортный уровень будет использовать протокол SSL для шифрования канала и не пойдет по цепочке сертификатов для проверки доверия.</span><span class="sxs-lookup"><span data-stu-id="b39a8-158">When `TrustServerCertificate` is set to `true`, the transport layer will use SSL to encrypt the channel and bypass walking the certificate chain to validate trust.</span></span>  
  
```csharp  
"TrustServerCertificate=true;"
```  
  
> [!NOTE]
> <span data-ttu-id="b39a8-159">Если ключевому слову `TrustServerCertificate` присвоено значение `true` и включено шифрование, то будет использоваться уровень шифрования, заданный на сервере, даже если в строке подключения `Encrypt` задано значение `false`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-159">If `TrustServerCertificate` is set to `true` and encryption is turned on, the encryption level specified on the server will be used even if `Encrypt` is set to `false` in the connection string.</span></span> <span data-ttu-id="b39a8-160">В противном случае соединение не будет установлено.</span><span class="sxs-lookup"><span data-stu-id="b39a8-160">The connection will fail otherwise.</span></span>  
  
### <a name="enabling-encryption"></a><span data-ttu-id="b39a8-161">Включение шифрования</span><span class="sxs-lookup"><span data-stu-id="b39a8-161">Enabling Encryption</span></span>  
 <span data-ttu-id="b39a8-162">Чтобы включить шифрование, если сертификат не был подготовлен на сервере, параметры **принудительное шифрование протокола** и **сертификат доверенного сервера** должны быть установлены в Диспетчер конфигурации SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b39a8-162">To enable encryption when a certificate has not been provisioned on the server, the **Force Protocol Encryption** and the **Trust Server Certificate** options must be set in SQL Server Configuration Manager.</span></span> <span data-ttu-id="b39a8-163">В этом случае шифрование будет использовать самозаверяющий сертификат сервера, не проверяя наличия подтверждаемого сертификата сервера.</span><span class="sxs-lookup"><span data-stu-id="b39a8-163">In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.</span></span>  
  
 <span data-ttu-id="b39a8-164">Настройки приложения не могут снизить установленный на SQL Server уровень безопасности, но при необходимости могут повысить его.</span><span class="sxs-lookup"><span data-stu-id="b39a8-164">Application settings cannot reduce the level of security configured in SQL Server, but can optionally strengthen it.</span></span> <span data-ttu-id="b39a8-165">Приложение может запрашивать шифрование, задавая ключевые слова `TrustServerCertificate` и `Encrypt` для `true`, гарантируя, что шифрование выполняется, даже если сертификат сервера не был подготовлен и не настроено **принудительное шифрование протокола** . для клиента.</span><span class="sxs-lookup"><span data-stu-id="b39a8-165">An application can request encryption by setting the `TrustServerCertificate` and `Encrypt` keywords to `true`, guaranteeing that encryption takes place even when a server certificate has not been provisioned and **Force Protocol Encryption** has not been configured for the client.</span></span> <span data-ttu-id="b39a8-166">Но если на клиенте не установлен параметр `TrustServerCertificate`, то сертификат сервера, тем не менее, потребуется.</span><span class="sxs-lookup"><span data-stu-id="b39a8-166">However, if `TrustServerCertificate` is not enabled in the client configuration, a provisioned server certificate is still required.</span></span>  
  
 <span data-ttu-id="b39a8-167">В следующей таблице перечислены все случаи.</span><span class="sxs-lookup"><span data-stu-id="b39a8-167">The following table describes all cases.</span></span>  
  
|<span data-ttu-id="b39a8-168">Параметр «Принудительное шифрование протокола» на клиенте</span><span class="sxs-lookup"><span data-stu-id="b39a8-168">Force Protocol Encryption client setting</span></span>|<span data-ttu-id="b39a8-169">Параметр «Доверять сертификату сервера» на клиенте</span><span class="sxs-lookup"><span data-stu-id="b39a8-169">Trust Server Certificate client setting</span></span>|<span data-ttu-id="b39a8-170">Строка или атрибут «Шифровать/Использовать шифрование для подключения к данным»</span><span class="sxs-lookup"><span data-stu-id="b39a8-170">Encrypt/Use Encryption for Data connection string/attribute</span></span>|<span data-ttu-id="b39a8-171">Строка подключения или атрибут «Доверять сертификату сервера»</span><span class="sxs-lookup"><span data-stu-id="b39a8-171">Trust Server Certificate connection string/attribute</span></span>|<span data-ttu-id="b39a8-172">Результат</span><span class="sxs-lookup"><span data-stu-id="b39a8-172">Result</span></span>|  
|----------------------------------------------|---------------------------------------------|-------------------------------------------------------------------|-----------------------------------------------------------|------------|  
|<span data-ttu-id="b39a8-173">Нет</span><span class="sxs-lookup"><span data-stu-id="b39a8-173">No</span></span>|<span data-ttu-id="b39a8-174">Н/Д</span><span class="sxs-lookup"><span data-stu-id="b39a8-174">N/A</span></span>|<span data-ttu-id="b39a8-175">Нет (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="b39a8-175">No (default)</span></span>|<span data-ttu-id="b39a8-176">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="b39a8-176">Ignored</span></span>|<span data-ttu-id="b39a8-177">Шифрование отсутствует.</span><span class="sxs-lookup"><span data-stu-id="b39a8-177">No encryption occurs.</span></span>|  
|<span data-ttu-id="b39a8-178">Нет</span><span class="sxs-lookup"><span data-stu-id="b39a8-178">No</span></span>|<span data-ttu-id="b39a8-179">Н/Д</span><span class="sxs-lookup"><span data-stu-id="b39a8-179">N/A</span></span>|<span data-ttu-id="b39a8-180">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-180">Yes</span></span>|<span data-ttu-id="b39a8-181">Нет (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="b39a8-181">No (default)</span></span>|<span data-ttu-id="b39a8-182">Шифрование применяется только при наличии подтверждаемого сертификата сервера, в противном случае попытка соединения завершается неудачно.</span><span class="sxs-lookup"><span data-stu-id="b39a8-182">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="b39a8-183">Нет</span><span class="sxs-lookup"><span data-stu-id="b39a8-183">No</span></span>|<span data-ttu-id="b39a8-184">Н/Д</span><span class="sxs-lookup"><span data-stu-id="b39a8-184">N/A</span></span>|<span data-ttu-id="b39a8-185">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-185">Yes</span></span>|<span data-ttu-id="b39a8-186">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-186">Yes</span></span>|<span data-ttu-id="b39a8-187">Шифрование всегда происходит, но может использовать самозаверяющий сертификат сервера.</span><span class="sxs-lookup"><span data-stu-id="b39a8-187">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="b39a8-188">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-188">Yes</span></span>|<span data-ttu-id="b39a8-189">Нет</span><span class="sxs-lookup"><span data-stu-id="b39a8-189">No</span></span>|<span data-ttu-id="b39a8-190">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="b39a8-190">Ignored</span></span>|<span data-ttu-id="b39a8-191">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="b39a8-191">Ignored</span></span>|<span data-ttu-id="b39a8-192">Шифрование выполняется только при наличии проверяемого сертификата сервера. в противном случае попытка подключения завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="b39a8-192">Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.</span></span>|  
|<span data-ttu-id="b39a8-193">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-193">Yes</span></span>|<span data-ttu-id="b39a8-194">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-194">Yes</span></span>|<span data-ttu-id="b39a8-195">Нет (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="b39a8-195">No (default)</span></span>|<span data-ttu-id="b39a8-196">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="b39a8-196">Ignored</span></span>|<span data-ttu-id="b39a8-197">Шифрование всегда происходит, но может использовать самозаверяющий сертификат сервера.</span><span class="sxs-lookup"><span data-stu-id="b39a8-197">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="b39a8-198">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-198">Yes</span></span>|<span data-ttu-id="b39a8-199">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-199">Yes</span></span>|<span data-ttu-id="b39a8-200">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-200">Yes</span></span>|<span data-ttu-id="b39a8-201">Нет (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="b39a8-201">No (default)</span></span>|<span data-ttu-id="b39a8-202">Шифрование выполняется только при наличии проверяемого сертификата сервера. в противном случае попытка подключения завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="b39a8-202">Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.</span></span>|  
|<span data-ttu-id="b39a8-203">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-203">Yes</span></span>|<span data-ttu-id="b39a8-204">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-204">Yes</span></span>|<span data-ttu-id="b39a8-205">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-205">Yes</span></span>|<span data-ttu-id="b39a8-206">Да</span><span class="sxs-lookup"><span data-stu-id="b39a8-206">Yes</span></span>|<span data-ttu-id="b39a8-207">Шифрование всегда происходит, но может использовать самозаверяющий сертификат сервера.</span><span class="sxs-lookup"><span data-stu-id="b39a8-207">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
  
 <span data-ttu-id="b39a8-208">Дополнительные сведения см. [в разделе Использование шифрования без проверки](/sql/relational-databases/native-client/features/using-encryption-without-validation).</span><span class="sxs-lookup"><span data-stu-id="b39a8-208">For more information, see [Using Encryption Without Validation](/sql/relational-databases/native-client/features/using-encryption-without-validation).</span></span>
  
## <a name="oledb-connection-strings"></a><span data-ttu-id="b39a8-209">Строки соединения OleDb</span><span class="sxs-lookup"><span data-stu-id="b39a8-209">OleDb Connection Strings</span></span>  
 <span data-ttu-id="b39a8-210">Свойство <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A> класса <xref:System.Data.OleDb.OleDbConnection> позволяет получить или задать строку подключения для источника данных OLE DB (например, Microsoft Access).</span><span class="sxs-lookup"><span data-stu-id="b39a8-210">The <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A> property of a <xref:System.Data.OleDb.OleDbConnection> allows you to get or set a connection string for an OLE DB data source, such as Microsoft Access.</span></span> <span data-ttu-id="b39a8-211">Строку подключения `OleDb` также можно создать во время выполнения с помощью класса <xref:System.Data.OleDb.OleDbConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-211">You can also create an `OleDb` connection string at run time by using the <xref:System.Data.OleDb.OleDbConnectionStringBuilder> class.</span></span>  
  
### <a name="oledb-connection-string-syntax"></a><span data-ttu-id="b39a8-212">Синтаксис строки соединения OleDb</span><span class="sxs-lookup"><span data-stu-id="b39a8-212">OleDb Connection String Syntax</span></span>  
 <span data-ttu-id="b39a8-213">В строке соединения <xref:System.Data.OleDb.OleDbConnection> необходимо указать имя поставщика.</span><span class="sxs-lookup"><span data-stu-id="b39a8-213">You must specify a provider name for an <xref:System.Data.OleDb.OleDbConnection> connection string.</span></span> <span data-ttu-id="b39a8-214">Следующие строки подключения подключают к базе данных Microsoft Access, использующей поставщик Jet.</span><span class="sxs-lookup"><span data-stu-id="b39a8-214">The following connection string connects to a Microsoft Access database using the Jet provider.</span></span> <span data-ttu-id="b39a8-215">Обратите внимание, что ключевые слова `User ID` и `Password` необязательны, если база данных не защищена (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="b39a8-215">Note that the `User ID` and `Password` keywords are optional if the database is unsecured (the default).</span></span>  
  
```csharp
Provider=Microsoft.Jet.OLEDB.4.0; Data Source=d:\Northwind.mdb;User ID=Admin;Password=;
```  
  
 <span data-ttu-id="b39a8-216">Если база данных Jet защищена на уровне пользователя, необходимо указать местоположение файла сведений рабочей группы (MDW-файла).</span><span class="sxs-lookup"><span data-stu-id="b39a8-216">If the Jet database is secured using user-level security, you must provide the location of the workgroup information file (.mdw).</span></span> <span data-ttu-id="b39a8-217">Файл сведений рабочей группы используется для проверки учетных данных, указанных в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="b39a8-217">The workgroup information file is used to validate the credentials presented in the connection string.</span></span>  
  
```csharp
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=d:\Northwind.mdb;Jet OLEDB:System Database=d:\NorthwindSystem.mdw;User ID=*****;Password=*****;  
```  
  
> [!IMPORTANT]
> <span data-ttu-id="b39a8-218">Сведения о соединении для объекта **OleDbConnection** можно указать в файле UDL. Однако это следует избегать.</span><span class="sxs-lookup"><span data-stu-id="b39a8-218">It is possible to supply connection information for an **OleDbConnection** in a Universal Data Link (UDL) file; however you should avoid doing so.</span></span> <span data-ttu-id="b39a8-219">UDL-файлы не подвергаются шифрованию, и строки соединения хранятся в них в виде простого текста.</span><span class="sxs-lookup"><span data-stu-id="b39a8-219">UDL files are not encrypted, and expose connection string information in clear text.</span></span> <span data-ttu-id="b39a8-220">Так как UDL-файл представляет собой внешний файловый ресурс для приложения, его нельзя защитить средствами .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b39a8-220">Because a UDL file is an external file-based resource to your application, it cannot be secured using the .NET Framework.</span></span> <span data-ttu-id="b39a8-221">UDL файлы не поддерживаются для **SqlClient**.</span><span class="sxs-lookup"><span data-stu-id="b39a8-221">UDL files are not supported for **SqlClient**.</span></span>  
  
### <a name="using-datadirectory-to-connect-to-accessjet"></a><span data-ttu-id="b39a8-222">Соединение с Access/Jet с помощью строки замены DataDirectory</span><span class="sxs-lookup"><span data-stu-id="b39a8-222">Using DataDirectory to Connect to Access/Jet</span></span>  
 <span data-ttu-id="b39a8-223">Строка замены `DataDirectory` поддерживается не только клиентом `SqlClient`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-223">`DataDirectory` is not exclusive to `SqlClient`.</span></span> <span data-ttu-id="b39a8-224">Ее можно также использовать с поставщиками данных .NET для <xref:System.Data.OleDb> и <xref:System.Data.Odbc>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-224">It can also be used with the <xref:System.Data.OleDb> and <xref:System.Data.Odbc> .NET data providers.</span></span> <span data-ttu-id="b39a8-225">В следующем образце строки <xref:System.Data.OleDb.OleDbConnection> приведен синтаксис для подключения к базе данных Northwind.mdb, расположенной в папке приложения app_data.</span><span class="sxs-lookup"><span data-stu-id="b39a8-225">The following sample <xref:System.Data.OleDb.OleDbConnection> string demonstrates the syntax required to connect to the Northwind.mdb located in the application's app_data folder.</span></span> <span data-ttu-id="b39a8-226">В этой папке также хранится системная база данных (System.mdw).</span><span class="sxs-lookup"><span data-stu-id="b39a8-226">The system database (System.mdw) is also stored in that location.</span></span>  
  
```csharp  
"Provider=Microsoft.Jet.OLEDB.4.0;  
Data Source=|DataDirectory|\Northwind.mdb;  
Jet OLEDB:System Database=|DataDirectory|\System.mdw;"  
```  
  
> [!IMPORTANT]
> <span data-ttu-id="b39a8-227">Указывать расположение системной базы данных в строке подключения не требуется, если база данных Access/Jet не защищена.</span><span class="sxs-lookup"><span data-stu-id="b39a8-227">Specifying the location of the system database in the connection string is not required if the Access/Jet database is unsecured.</span></span> <span data-ttu-id="b39a8-228">Защита снята по умолчанию, все пользователи соединяются как встроенный пользователь Admin с пустым паролем.</span><span class="sxs-lookup"><span data-stu-id="b39a8-228">Security is off by default, with all users connecting as the built-in Admin user with a blank password.</span></span> <span data-ttu-id="b39a8-229">База данных Jet остается уязвимой для атаки, даже если правильно реализована безопасность на уровне пользователя.</span><span class="sxs-lookup"><span data-stu-id="b39a8-229">Even when user-level security is correctly implemented, a Jet database remains vulnerable to attack.</span></span> <span data-ttu-id="b39a8-230">Поэтому в базе данных Access/Jet не рекомендуется хранить конфиденциальные данные, поскольку схема безопасности на основе файловой системы неизбежно обладает определенной уязвимостью.</span><span class="sxs-lookup"><span data-stu-id="b39a8-230">Therefore, storing sensitive information in an Access/Jet database is not recommended because of the inherent weakness of its file-based security scheme.</span></span>  
  
### <a name="connecting-to-excel"></a><span data-ttu-id="b39a8-231">Соединение с Excel</span><span class="sxs-lookup"><span data-stu-id="b39a8-231">Connecting to Excel</span></span>  
 <span data-ttu-id="b39a8-232">Поставщик Microsoft Jet используется для подключения с книгой Excel.</span><span class="sxs-lookup"><span data-stu-id="b39a8-232">The Microsoft Jet provider is used to connect to an Excel workbook.</span></span> <span data-ttu-id="b39a8-233">В следующей строке подключения ключевое слово `Extended Properties` задает специфические свойства Excel.</span><span class="sxs-lookup"><span data-stu-id="b39a8-233">In the following connection string, the `Extended Properties` keyword sets properties that are specific to Excel.</span></span> <span data-ttu-id="b39a8-234">«HDR=Yes;» показывает, что первая строка содержит имена столбцов, а не данные, а «IMEX=1;» дает указания драйверу всегда считывать «смешанные» столбцы данных как текст.</span><span class="sxs-lookup"><span data-stu-id="b39a8-234">"HDR=Yes;" indicates that the first row contains column names, not data, and "IMEX=1;" tells the driver to always read "intermixed" data columns as text.</span></span>  
  
```csharp 
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\MyExcel.xls;Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1""  
```  
  
 <span data-ttu-id="b39a8-235">Обратите внимание, что двойные кавычки, необходимые для ключевого слова `Extended Properties`, также должны заключаться в двойные кавычки.</span><span class="sxs-lookup"><span data-stu-id="b39a8-235">Note that the double quotation character required for the `Extended Properties` must also be enclosed in double quotation marks.</span></span>  
  
### <a name="data-shape-provider-connection-string-syntax"></a><span data-ttu-id="b39a8-236">Синтаксис строки подключения с поставщиком Data Shape</span><span class="sxs-lookup"><span data-stu-id="b39a8-236">Data Shape Provider Connection String Syntax</span></span>  
 <span data-ttu-id="b39a8-237">При соединении с поставщиком Microsoft Data Shape используются оба ключевых слова: `Provider` и `Data Provider`.</span><span class="sxs-lookup"><span data-stu-id="b39a8-237">Use both the `Provider` and the `Data Provider` keywords when using the Microsoft Data Shape provider.</span></span> <span data-ttu-id="b39a8-238">В следующем примере поставщик Data Shape используется для подключения к экземпляру SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b39a8-238">The following example uses the Shape provider to connect to a local instance of SQL Server.</span></span>  
  
```csharp  
"Provider=MSDataShape;Data Provider=SQLOLEDB;Data Source=(local);Initial Catalog=pubs;Integrated Security=SSPI;"   
```  
  
## <a name="odbc-connection-strings"></a><span data-ttu-id="b39a8-239">Строки подключения ODBC</span><span class="sxs-lookup"><span data-stu-id="b39a8-239">Odbc Connection Strings</span></span>  
 <span data-ttu-id="b39a8-240">Свойство <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A> класса <xref:System.Data.Odbc.OdbcConnection> позволяет получить или задать строку подключения для источника данных OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b39a8-240">The <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A> property of a <xref:System.Data.Odbc.OdbcConnection> allows you to get or set a connection string for an OLE DB data source.</span></span> <span data-ttu-id="b39a8-241">Строки подключения ODBC также поддерживаются построителем <xref:System.Data.Odbc.OdbcConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-241">Odbc connection strings are also supported by the <xref:System.Data.Odbc.OdbcConnectionStringBuilder>.</span></span>  
  
 <span data-ttu-id="b39a8-242">Следующая строка подключения использует текстовый драйвер Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b39a8-242">The following connection string uses the Microsoft Text Driver.</span></span>  
  
```csharp  
Driver={Microsoft Text Driver (*.txt; *.csv)};DBQ=d:\bin  
```  
  
### <a name="using-datadirectory-to-connect-to-visual-foxpro"></a><span data-ttu-id="b39a8-243">Использование строки замены DataDirectory для соединения с Visual FoxPro</span><span class="sxs-lookup"><span data-stu-id="b39a8-243">Using DataDirectory to Connect to Visual FoxPro</span></span>  
 <span data-ttu-id="b39a8-244">Следующий образец строки подключения <xref:System.Data.Odbc.OdbcConnection> демонстрирует использование `DataDirectory` для соединения с файлом Microsoft Visual FoxPro.</span><span class="sxs-lookup"><span data-stu-id="b39a8-244">The following <xref:System.Data.Odbc.OdbcConnection> connection string sample demonstrates using `DataDirectory` to connect to a Microsoft Visual FoxPro file.</span></span>  
  
```csharp  
"Driver={Microsoft Visual FoxPro Driver};  
SourceDB=|DataDirectory|\MyData.DBC;SourceType=DBC;"  
```  
  
## <a name="oracle-connection-strings"></a><span data-ttu-id="b39a8-245">Строки подключения Oracle</span><span class="sxs-lookup"><span data-stu-id="b39a8-245">Oracle Connection Strings</span></span>  
 <span data-ttu-id="b39a8-246">Свойство <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> класса <xref:System.Data.OracleClient.OracleConnection> позволяет получить или задать строку подключения для источника данных OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b39a8-246">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of a <xref:System.Data.OracleClient.OracleConnection> allows you to get or set a connection string for an OLE DB data source.</span></span> <span data-ttu-id="b39a8-247">Строки подключения Oracle также поддерживаются построителем <xref:System.Data.OracleClient.OracleConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-247">Oracle connection strings are also supported by the <xref:System.Data.OracleClient.OracleConnectionStringBuilder> .</span></span>  
  
```csharp 
Data Source=Oracle9i;User ID=*****;Password=*****;  
```  
  
 <span data-ttu-id="b39a8-248">Дополнительные сведения о синтаксисе строки подключения ODBC см. в разделе <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="b39a8-248">For more information on ODBC connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b39a8-249">См. также</span><span class="sxs-lookup"><span data-stu-id="b39a8-249">See also</span></span>

- [<span data-ttu-id="b39a8-250">Строки подключения</span><span class="sxs-lookup"><span data-stu-id="b39a8-250">Connection Strings</span></span>](connection-strings.md)
- [<span data-ttu-id="b39a8-251">Подключение к источнику данных</span><span class="sxs-lookup"><span data-stu-id="b39a8-251">Connecting to a Data Source</span></span>](connecting-to-a-data-source.md)
- [<span data-ttu-id="b39a8-252">Общие сведения об ADO.NET</span><span class="sxs-lookup"><span data-stu-id="b39a8-252">ADO.NET Overview</span></span>](ado-net-overview.md)
