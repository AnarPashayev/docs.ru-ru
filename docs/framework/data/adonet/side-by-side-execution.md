---
title: Одновременное выполнение в ADO.NET
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: d20d8e81d76284509d6fe733e4f283a9ab39cb00
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877095"
---
# <a name="side-by-side-execution-in-adonet"></a>Одновременное выполнение в ADO.NET
Side-by-side выполнения в .NET Framework является возможность выполнения приложения на компьютере, на котором установлено несколько версий платформы .NET Framework установлена, используя только ту версию, для которой приложение скомпилировано. Подробные сведения о настройке side-by-side выполнения, см. в разделе [выполнения Side-by-Side](../../../../docs/framework/deployment/side-by-side-execution.md).  
  
 Приложение, скомпилированное с помощью одной версии платформы .NET Framework можно запустить на другой версии платформы .NET Framework. Тем не менее мы рекомендуем компиляции версии приложения для каждой установленной версии платформы .NET Framework и выполнять их по отдельности. В любом случае вы должны помнить об изменениях в ADO.NET между выпусками, которые могут повлиять на прямую и обратную совместимость приложения.  
  
## <a name="forward-compatibility-and-backward-compatibility"></a>Прямая и обратная совместимость  
 Прямая совместимость означает, что приложение может быть скомпилировано в более ранней версии платформы .NET Framework, но все равно будет успешно работать в более поздней версии платформы .NET Framework. Код ADO.NET, написанный для платформы .NET Framework версии 1.1, обладает прямой совместимостью с более поздними версиями.  
  
 Обратная совместимость означает, что приложение компилируется для более новой версии платформы .NET Framework, но продолжает работать в более ранних версиях .NET Framework без потери функциональности. Само собой это не будет возможности, появившиеся в новой версии платформы .NET Framework.  
  
## <a name="the-net-framework-data-provider-for-odbc"></a>Поставщик данных .NET Framework для ODBC  
 Начиная с версии 1.1, поставщик данных .NET Framework для ODBC (<xref:System.Data.Odbc>) включается как часть платформы .NET Framework. Поставщик данных ODBC доступен для разработчиков .NET Framework версии 1.0 загрузки из Интернета из [Центр разработчиков хранилищ и доступа к данным](https://go.microsoft.com/fwlink/?linkid=4173). Пространство имен для загруженного поставщика данных .NET Framework для ODBC **Microsoft.Data.Odbc**.  
  
 Если у вас есть приложение, разработанное для .NET Framework версии 1.0, который использует поставщик данных ODBC для подключения к источнику данных, и вы хотите выполнить приложение .NET Framework версии 1.1 или более поздней версии, необходимо обновить пространство имен для доступа к данным ODBC Поставщик, который должен **System.Data.Odbc**. Затем приложение необходимо перекомпилировать его более новой версии платформы .NET Framework.  
  
 Если у вас есть приложение, разработанное для .NET Framework версии 2.0 или более поздней версии, использующий поставщик данных ODBC для подключения к источнику данных, и вы хотите запустить это приложение на платформе .NET Framework версии 1.0, то необходимо загрузить поставщик данных ODBC и установить его в системе .NET Framework версии 1.0. Затем необходимо внести изменения пространства имен поставщика данных ODBC на **Microsoft.Data.Odbc**и перекомпилировать приложение для платформы .NET Framework версии 1.0.  
  
## <a name="the-net-framework-data-provider-for-oracle"></a>Поставщик данных .NET Framework для Oracle  
 Начиная с версии 1.1, поставщик данных .NET Framework для Oracle (<xref:System.Data.OracleClient>) включается как часть платформы .NET Framework. Поставщик данных доступна для разработчиков .NET Framework версии 1.0 загрузки из Интернета из [Центр разработчиков хранилищ и доступа к данным](https://go.microsoft.com/fwlink/?linkid=4173).  
  
 Если у вас есть приложение, разработанное для .NET Framework версии 2.0 или более поздней версии, использующий поставщик данных для подключения к источнику данных, и вы хотите запустить это приложение на платформе .NET Framework версии 1.0, необходимо загрузить поставщик данных и установить его на .NE T скомпилировано.  
  
## <a name="code-access-security"></a>Управление доступом для кода  
 Поставщики данных .NET Framework в .NET Framework версии 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) необходимы для запуска с правами доступа FullTrust. Любая попытка использовать поставщики данных .NET Framework k из .NET Framework версии 1.0 в зоне с меньшими усилиями FullTrust вызовет исключение <xref:System.Security.SecurityException>.  
  
 Тем не менее начиная с .NET Framework версии 2.0, все поставщики данных .NET Framework можно использовать в частично доверенных зонах. Кроме того это новая функция безопасности был добавлен для поставщиков данных .NET Framework в .NET Framework версии 1.1. Эта возможность позволяет указывать, какие строки соединения могут использоваться в конкретной зоне безопасности. Также можно отключить использование пустых паролей для конкретной зоны безопасности. Для получения дополнительной информации см. [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).  
  
 Так как каждая установка платформы .NET Framework имеет отдельный файл Security.config, отсутствии проблем совместимости с параметрами безопасности. Тем не менее если ваше приложение зависит от возможностей безопасности ADO.NET, включенных в .NET Framework версии 1.1 и более поздние версии, вы не сможете распространить их на систему версии 1.0.  
  
## <a name="sqlcommand-execution"></a>Выполнение SqlCommand  
 Начиная с .NET Framework версии 1.1, так что <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполняет команды изменения в данных источника.  
  
 В .NET Framework версии 1.0 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполнял все команды в контексте **sp_executesql** хранимой процедуры. В результате этого команды, которые влияли на состояние соединения (например, SET NOCOUNT ON), применялись только к выполнению текущей команды. Состояние соединения не изменялось для любых последующих команд, выполнявшихся при открытом соединении.  
  
 В .NET Framework версии 1.1 и более поздних версий <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> только выполняет команды в контексте **sp_executesql** хранимую процедуру, если команда содержит параметры, что обеспечит выигрыш в производительности. В результате этого, если команда, влияющая на состояние соединения, включена в непараметризованную команду, она изменяет состояние соединения для всех последующих команд, выполняемых при открытом соединении.  
  
 Рассмотрим следующий пакет команд, выполняемых при обращении к <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 В .NET Framework версии 1.1 и более поздних версий NOCOUNT останется в для любых последующих команд, выполняемых при открытом соединения. В .NET Framework версии 1.0 NOCOUNT находится только ВО время выполнения текущей команды.  
  
 Это изменение может повлиять на прямую и обратную совместимость приложения, если полагаются на поведение <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> для любой версии платформы .NET Framework.  
  
 Для приложений, работающих в и более ранних версиях платформы .NET Framework можно написать код, чтобы убедиться, что происходит так же, независимо от версии, на котором выполняются с. Если требуется сделать так, чтобы команда изменяла состояние соединения для всех последующих команд, рекомендуется выполнять команду с помощью <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>. Если требуется сделать так, чтобы команда не изменяла соединение для всех последующих команд, рекомендуется включать в нее команды для сброса состояния соединения. Пример:  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a>См. также

- [Общие сведения об ADO.NET](../../../../docs/framework/data/adonet/ado-net-overview.md)
- [Извлечение и изменение данных в ADO.NET](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)
- [Центр разработчиков наборов данных и управляемых поставщиков ADO.NET](https://go.microsoft.com/fwlink/?LinkId=217917)
