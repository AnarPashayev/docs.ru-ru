---
title: Одновременное выполнение в ADO.NET
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: d20d8e81d76284509d6fe733e4f283a9ab39cb00
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877095"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="c85d4-102">Одновременное выполнение в ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c85d4-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="c85d4-103">Side-by-side выполнения в .NET Framework является возможность выполнения приложения на компьютере, на котором установлено несколько версий платформы .NET Framework установлена, используя только ту версию, для которой приложение скомпилировано.</span><span class="sxs-lookup"><span data-stu-id="c85d4-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="c85d4-104">Подробные сведения о настройке side-by-side выполнения, см. в разделе [выполнения Side-by-Side](../../../../docs/framework/deployment/side-by-side-execution.md).</span><span class="sxs-lookup"><span data-stu-id="c85d4-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="c85d4-105">Приложение, скомпилированное с помощью одной версии платформы .NET Framework можно запустить на другой версии платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="c85d4-106">Тем не менее мы рекомендуем компиляции версии приложения для каждой установленной версии платформы .NET Framework и выполнять их по отдельности.</span><span class="sxs-lookup"><span data-stu-id="c85d4-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="c85d4-107">В любом случае вы должны помнить об изменениях в ADO.NET между выпусками, которые могут повлиять на прямую и обратную совместимость приложения.</span><span class="sxs-lookup"><span data-stu-id="c85d4-107">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="c85d4-108">Прямая и обратная совместимость</span><span class="sxs-lookup"><span data-stu-id="c85d4-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="c85d4-109">Прямая совместимость означает, что приложение может быть скомпилировано в более ранней версии платформы .NET Framework, но все равно будет успешно работать в более поздней версии платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="c85d4-110">Код ADO.NET, написанный для платформы .NET Framework версии 1.1, обладает прямой совместимостью с более поздними версиями.</span><span class="sxs-lookup"><span data-stu-id="c85d4-110">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="c85d4-111">Обратная совместимость означает, что приложение компилируется для более новой версии платформы .NET Framework, но продолжает работать в более ранних версиях .NET Framework без потери функциональности.</span><span class="sxs-lookup"><span data-stu-id="c85d4-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="c85d4-112">Само собой это не будет возможности, появившиеся в новой версии платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="c85d4-113">Поставщик данных .NET Framework для ODBC</span><span class="sxs-lookup"><span data-stu-id="c85d4-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="c85d4-114">Начиная с версии 1.1, поставщик данных .NET Framework для ODBC (<xref:System.Data.Odbc>) включается как часть платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="c85d4-115">Поставщик данных ODBC доступен для разработчиков .NET Framework версии 1.0 загрузки из Интернета из [Центр разработчиков хранилищ и доступа к данным](https://go.microsoft.com/fwlink/?linkid=4173).</span><span class="sxs-lookup"><span data-stu-id="c85d4-115">The ODBC data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="c85d4-116">Пространство имен для загруженного поставщика данных .NET Framework для ODBC **Microsoft.Data.Odbc**.</span><span class="sxs-lookup"><span data-stu-id="c85d4-116">The namespace for the downloaded .NET Framework Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="c85d4-117">Если у вас есть приложение, разработанное для .NET Framework версии 1.0, который использует поставщик данных ODBC для подключения к источнику данных, и вы хотите выполнить приложение .NET Framework версии 1.1 или более поздней версии, необходимо обновить пространство имен для доступа к данным ODBC Поставщик, который должен **System.Data.Odbc**.</span><span class="sxs-lookup"><span data-stu-id="c85d4-117">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="c85d4-118">Затем приложение необходимо перекомпилировать его более новой версии платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-118">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="c85d4-119">Если у вас есть приложение, разработанное для .NET Framework версии 2.0 или более поздней версии, использующий поставщик данных ODBC для подключения к источнику данных, и вы хотите запустить это приложение на платформе .NET Framework версии 1.0, то необходимо загрузить поставщик данных ODBC и установить его в системе .NET Framework версии 1.0.</span><span class="sxs-lookup"><span data-stu-id="c85d4-119">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="c85d4-120">Затем необходимо внести изменения пространства имен поставщика данных ODBC на **Microsoft.Data.Odbc**и перекомпилировать приложение для платформы .NET Framework версии 1.0.</span><span class="sxs-lookup"><span data-stu-id="c85d4-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="c85d4-121">Поставщик данных .NET Framework для Oracle</span><span class="sxs-lookup"><span data-stu-id="c85d4-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="c85d4-122">Начиная с версии 1.1, поставщик данных .NET Framework для Oracle (<xref:System.Data.OracleClient>) включается как часть платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-122">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="c85d4-123">Поставщик данных доступна для разработчиков .NET Framework версии 1.0 загрузки из Интернета из [Центр разработчиков хранилищ и доступа к данным](https://go.microsoft.com/fwlink/?linkid=4173).</span><span class="sxs-lookup"><span data-stu-id="c85d4-123">The data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="c85d4-124">Если у вас есть приложение, разработанное для .NET Framework версии 2.0 или более поздней версии, использующий поставщик данных для подключения к источнику данных, и вы хотите запустить это приложение на платформе .NET Framework версии 1.0, необходимо загрузить поставщик данных и установить его на .NE T скомпилировано.</span><span class="sxs-lookup"><span data-stu-id="c85d4-124">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="c85d4-125">Управление доступом для кода</span><span class="sxs-lookup"><span data-stu-id="c85d4-125">Code Access Security</span></span>  
 <span data-ttu-id="c85d4-126">Поставщики данных .NET Framework в .NET Framework версии 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) необходимы для запуска с правами доступа FullTrust.</span><span class="sxs-lookup"><span data-stu-id="c85d4-126">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="c85d4-127">Любая попытка использовать поставщики данных .NET Framework k из .NET Framework версии 1.0 в зоне с меньшими усилиями FullTrust вызовет исключение <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="c85d4-127">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="c85d4-128">Тем не менее начиная с .NET Framework версии 2.0, все поставщики данных .NET Framework можно использовать в частично доверенных зонах.</span><span class="sxs-lookup"><span data-stu-id="c85d4-128">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="c85d4-129">Кроме того это новая функция безопасности был добавлен для поставщиков данных .NET Framework в .NET Framework версии 1.1.</span><span class="sxs-lookup"><span data-stu-id="c85d4-129">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="c85d4-130">Эта возможность позволяет указывать, какие строки соединения могут использоваться в конкретной зоне безопасности.</span><span class="sxs-lookup"><span data-stu-id="c85d4-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="c85d4-131">Также можно отключить использование пустых паролей для конкретной зоны безопасности.</span><span class="sxs-lookup"><span data-stu-id="c85d4-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="c85d4-132">Для получения дополнительной информации см. [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span><span class="sxs-lookup"><span data-stu-id="c85d4-132">For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 <span data-ttu-id="c85d4-133">Так как каждая установка платформы .NET Framework имеет отдельный файл Security.config, отсутствии проблем совместимости с параметрами безопасности.</span><span class="sxs-lookup"><span data-stu-id="c85d4-133">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="c85d4-134">Тем не менее если ваше приложение зависит от возможностей безопасности ADO.NET, включенных в .NET Framework версии 1.1 и более поздние версии, вы не сможете распространить их на систему версии 1.0.</span><span class="sxs-lookup"><span data-stu-id="c85d4-134">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="c85d4-135">Выполнение SqlCommand</span><span class="sxs-lookup"><span data-stu-id="c85d4-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="c85d4-136">Начиная с .NET Framework версии 1.1, так что <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполняет команды изменения в данных источника.</span><span class="sxs-lookup"><span data-stu-id="c85d4-136">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="c85d4-137">В .NET Framework версии 1.0 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> выполнял все команды в контексте **sp_executesql** хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="c85d4-137">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="c85d4-138">В результате этого команды, которые влияли на состояние соединения (например, SET NOCOUNT ON), применялись только к выполнению текущей команды.</span><span class="sxs-lookup"><span data-stu-id="c85d4-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="c85d4-139">Состояние соединения не изменялось для любых последующих команд, выполнявшихся при открытом соединении.</span><span class="sxs-lookup"><span data-stu-id="c85d4-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="c85d4-140">В .NET Framework версии 1.1 и более поздних версий <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> только выполняет команды в контексте **sp_executesql** хранимую процедуру, если команда содержит параметры, что обеспечит выигрыш в производительности.</span><span class="sxs-lookup"><span data-stu-id="c85d4-140">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="c85d4-141">В результате этого, если команда, влияющая на состояние соединения, включена в непараметризованную команду, она изменяет состояние соединения для всех последующих команд, выполняемых при открытом соединении.</span><span class="sxs-lookup"><span data-stu-id="c85d4-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="c85d4-142">Рассмотрим следующий пакет команд, выполняемых при обращении к <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="c85d4-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="c85d4-143">В .NET Framework версии 1.1 и более поздних версий NOCOUNT останется в для любых последующих команд, выполняемых при открытом соединения.</span><span class="sxs-lookup"><span data-stu-id="c85d4-143">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="c85d4-144">В .NET Framework версии 1.0 NOCOUNT находится только ВО время выполнения текущей команды.</span><span class="sxs-lookup"><span data-stu-id="c85d4-144">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="c85d4-145">Это изменение может повлиять на прямую и обратную совместимость приложения, если полагаются на поведение <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> для любой версии платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c85d4-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="c85d4-146">Для приложений, работающих в и более ранних версиях платформы .NET Framework можно написать код, чтобы убедиться, что происходит так же, независимо от версии, на котором выполняются с.</span><span class="sxs-lookup"><span data-stu-id="c85d4-146">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="c85d4-147">Если требуется сделать так, чтобы команда изменяла состояние соединения для всех последующих команд, рекомендуется выполнять команду с помощью <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span><span class="sxs-lookup"><span data-stu-id="c85d4-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="c85d4-148">Если требуется сделать так, чтобы команда не изменяла соединение для всех последующих команд, рекомендуется включать в нее команды для сброса состояния соединения.</span><span class="sxs-lookup"><span data-stu-id="c85d4-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="c85d4-149">Пример:</span><span class="sxs-lookup"><span data-stu-id="c85d4-149">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="c85d4-150">См. также</span><span class="sxs-lookup"><span data-stu-id="c85d4-150">See also</span></span>

- [<span data-ttu-id="c85d4-151">Общие сведения об ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c85d4-151">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)
- [<span data-ttu-id="c85d4-152">Извлечение и изменение данных в ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c85d4-152">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)
- [<span data-ttu-id="c85d4-153">Центр разработчиков наборов данных и управляемых поставщиков ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c85d4-153">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
