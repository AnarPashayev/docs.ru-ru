---
title: Обработка пробелов в XAML
ms.date: 03/30/2017
helpviewer_keywords:
- East Asian characters [XAML Services]
- XAML [XAML Services], white-space processing
- white-space processing in XAML [XAML Services]
- characters [XAML Services], East Asian
ms.assetid: cc9cc377-7544-4fd0-b65b-117b90bb0b23
ms.openlocfilehash: 930e8a0013dd601aaafcd81340b3b9b8b69f8fdd
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458497"
---
# <a name="white-space-processing-in-xaml"></a>Обработка пробелов в XAML
Правила языка для состояния XAML, которые должны обрабатывать значимые пробелы при реализации процессора [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]. В этом разделе описываются эти правила языка XAML. Также документируется дополнительная обработка пробелов, определяемая [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] реализацией обработчика XAML и модуля записи XAML для сериализации.  
  
<a name="whitespace_definition"></a>   
## <a name="white-space-definition"></a>Определение пробела  
 В соответствии с [!INCLUDE[TLA2#tla_xml](../../../includes/tla2sharptla-xml-md.md)], пробелы в [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]: пробел, перевод строки и знак табуляции. Они соответствуют значениям Юникода 0020, 000A; и 0009 соответственно.  
  
<a name="whitespace_normalization"></a>   
## <a name="white-space-normalization"></a>Нормализация пробелов  
 По умолчанию при обработке [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] файла [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]ным процессором возникает следующая нормализация пробелов:  
  
1. Символы перевода строки между восточно-азиатскими символами удаляются. Определение этого термина см. в разделе "Символы восточно-азиатских языков" далее.  
  
2. Все пробельные символы (пробел, перевод строки, табуляция) преобразуются в пробелы.  
  
3. Все последовательные пробелы удаляются и заменяется одним пробелом.  
  
4. Пробел после открывающего тега удаляется.  
  
5. Пробел перед закрывающим тегом удаляется.  
  
 "Default" соответствует состоянию, обозначаемому значением атрибута [XML: space](xml-space-handling-in-xaml.md) по умолчанию.  
  
<a name="whitespace_in_inner_text_and_string_primitives"></a>   
## <a name="white-space-in-inner-text-and-string-primitives"></a>Пробелы во внутреннем тексте и строковые примитивы  
 Приведенные выше правила нормализации применяются к тексту внутри элементов XAML. После нормализации обработчик XAML преобразует любой внутренний текст в соответствующий тип следующим образом.  
  
- Если тип свойства не является коллекцией и типом <xref:System.Object> , обработчик XAML попытается преобразовать его в этот тип, используя преобразователь типов. Неудачное преобразование приводит к ошибке во время компиляции.  
  
- Если тип свойства — это коллекция, а внутренний текст не прерывается (не содержит промежуточных тегов элементов), внутренний текст анализируется как один <xref:System.String>. Если тип коллекции не может принять <xref:System.String>, это также приводит к ошибке во время компиляции.  
  
- Если тип свойства — <xref:System.Object>, внутренний текст анализируется как один <xref:System.String>. Если существуют промежуточные теги элементов, это приводит к ошибке во время компиляции, поскольку <xref:System.Object> подразумевает один объект (<xref:System.String> или другой).  
  
- Если тип свойства — коллекция, а внутренний текст прерывается, первая подстрока преобразуется в <xref:System.String> и добавляется как элемент коллекции, затем промежуточный элемент добавляется как элемент коллекции, и, наконец, конечная подстрока (если таковая имеется) добавляется в коллекцию как третий элемент <xref:System.String> .  
  
<a name="preserving_whitespace"></a>   
## <a name="preserving-white-space"></a>Сохранение пробелов  
 Существует несколько методов сохранения пробелов в исходном [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] для окончательной презентации, на которые не влияет нормализация [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] процессора.  
  
 **XML: Space = "preserve"** : укажите этот атрибут на уровне элемента, где требуется сохранение пробелов. При этом сохраняются все пробелы, включая те, что могут быть добавлены приложениями редактирования кода для выравнивания элементов и улучшения визуального восприятия. Однако то, отображаются ли эти пробелы, определяется моделью контента элемента. Не следует указывать `xml:space="preserve"` на корневом уровне, так как большинство объектных моделей не рассматривает пробелы как значащие, независимо от того, как задан атрибут. Глобальная установка `xml:space` может отрицательно повлиять на производительность обработки XAML (в частности, на сериализацию) в некоторых реализациях. Рекомендуется задавать атрибут только на уровне элементов, которые отображают пробелы в строках, или являются коллекциями, значимыми для пробелов.  
  
 **Сущности и неразрывные пробелы**: [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] поддерживает помещение любой сущности Юникода в объектную модель текста. Можно использовать выделенные сущности, такие как неразрывный пробел (& \#160; в кодировке UTF-8). Можно также использовать элементы управления форматированным текстом, поддерживающие неразрывные пробелы. Следует соблюдать осторожность при использовании сущностей для имитации характеристики разметки, таких как отступы, поскольку выходные данные сущностей во время выполнения зависят от множества факторов, при этом возможности формирования получения отступов в типичной системе разметки, например правильное использование панелей и полей, ограничены. Например, сущности сопоставляются со шрифтами и могут изменять размер после выбора шрифта пользователем.  
  
<a name="east_asian_characters"></a>   
## <a name="east-asian-characters"></a>Восточно-азиатские символы  
 "Восточно-азиатские символы" определяются как набор диапазонов символов Юникода от U + 20000 до U + 2FFFD и U + 30000 до U + 3FFFD. Это подмножество также иногда называют "CJK-иероглифами". Для получения дополнительной информации см. <https://www.unicode.org>.  
  
<a name="whitespace_and_text_content_models"></a>   
## <a name="white-space-and-text-content-models"></a>Модели пробельного и текстового содержимого  
 На практике сохранение пробелов имеет значение только для подмножества всех возможных моделей содержимого. Это подмножество состоит из моделей содержимого, которые могут принимать одноэлементный тип <xref:System.String> в определенной форме, выделенную коллекцию <xref:System.String> или сочетание <xref:System.String> и других типов в коллекции <xref:System.Collections.IList> или <xref:System.Collections.Generic.ICollection%601> .  
  
### <a name="white-space-and-text-content-models-in-wpf"></a>Модели пробельных и текстовых содержимого в WPF  
 Для наглядности оставшаяся часть этого подраздела ссылается на конкретные типы, определенные в WPF. Функции обработки пробелов, описанные в этом разделе, обычно относятся и к .NET Framework службам XAML, и к WPF. Чтобы увидеть это в действии, можно поэкспериментировать с некоторой разметкой WPF XAML, просмотреть результаты в графе объектов и снова сериализовать их в разметку.  
  
 Даже для моделей содержимого, которые могут принимать строки, поведение по умолчанию в этих моделях содержимого заключается в том, что все остающиеся пробелы не считаются значимыми. Например, <xref:System.Windows.Controls.ListBox> принимает <xref:System.Collections.IList>, но пробел (например, символы перевода строки между ними <xref:System.Windows.Controls.ListBoxItem>) не сохраняется и не подготавливается к просмотру. Попытка использовать символ перевода строки в качестве разделителей между строками для элементов <xref:System.Windows.Controls.ListBoxItem> вообще не даст результатов. Строки, разделенные символами перевода строки, считаются одной строкой и одним элементом.  
  
 Коллекции, которые обрабатывают пробелы как значащие, обычно являются частью модели документа нефиксированного формата. Основной коллекцией, поддерживающей сохранение пробелов, является <xref:System.Windows.Documents.InlineCollection>. Этот класс коллекции объявлен с <xref:System.Windows.Markup.WhitespaceSignificantCollectionAttribute>; При обнаружении этого атрибута процессор [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] будет обрабатывать пробелы в коллекции как значащие. Сочетание `xml:space="preserve"` и пробелов в коллекции с <xref:System.Windows.Markup.WhitespaceSignificantCollectionAttribute> означает, что все пробелы сохраняются и подготавливаются к просмотру. Сочетание `xml:space="default"` и пробелов в <xref:System.Windows.Markup.WhitespaceSignificantCollectionAttribute> вызывает начальную нормализацию пробелов, описанную выше, которая оставляет один пробел в определенных позициях, и эти пробелы сохраняются и подготавливаются к просмотру. Предпочтительное для вас поведение выбираете вы. Следует выборочно использовать `xml:space` , чтобы включить желаемое поведение.  
  
 Кроме того, некоторые встроенные элементы, которые указывают, что LineBreak в модели документов нефиксированного формата, должны намеренно не ввести дополнительное пространство, даже в коллекцию значимых пробелов. Например, элемент <xref:System.Windows.Documents.LineBreak> имеет ту же цель, что и тег \<BR/> в HTML, и для удобочитаемости в разметке, как правило, <xref:System.Windows.Documents.LineBreak> отделяется от любого последующего текста автором перевода строки. Этот символ не следует нормализовать, чтобы он не стал начальным пробелом в следующей строке. Чтобы включить это поведение, определение класса для элемента <xref:System.Windows.Documents.LineBreak> применяет <xref:System.Windows.Markup.TrimSurroundingWhitespaceAttribute>, который затем интерпретируется процессором [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)], что означает, что пробелы, окружающие <xref:System.Windows.Documents.LineBreak>, всегда обрезаются.  
  
## <a name="see-also"></a>См. также

- [Обзор XAML (WPF)](../../desktop-wpf/fundamentals/xaml.md)
- [Сущности символов XML и XAML](xml-character-entities-and-xaml.md)
- [Обработка XML: Space в XAML](xml-space-handling-in-xaml.md)
