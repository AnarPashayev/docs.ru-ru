---
title: Создание вспомогательных сборок для приложений для настольных систем
description: Начните создавать вспомогательные сборки для классических приложений. Вспомогательную сборку можно легко обновить или заменить для предоставления локализованных ресурсов.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- deploying applications [.NET Framework], resources
- resource files, deploying
- hub-and-spoke resource deployment model
- resource files, packaging
- application resources, packaging
- public keys, obtaining
- satellite assemblies
- assemblies [.NET Framework], signing
- application resources, deploying
- Al.exe
- GAC (global assembly cache), satellite assemblies
- Assembly Linker
- directory locations for satellite assemblies
- global assembly cache, satellite assemblies
- packaging application resources
- compiling satellite assemblies
- re-signing assemblies
ms.assetid: 8d5c6044-2919-41d2-8321-274706b295ac
ms.openlocfilehash: be6603f3a593d9756d55204024214660b2220af3
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2020
ms.locfileid: "87166209"
---
# <a name="creating-satellite-assemblies-for-desktop-apps"></a>Создание вспомогательных сборок для приложений для настольных систем

Файлы ресурсов играют важную роль в локализованных приложениях. Они позволяют приложению использовать для отображения строк, изображений и других данных текущие региональные настройки пользователя, а также предоставлять альтернативные данных при отсутствии необходимых ресурсов для языка и региональных параметров этого пользователя. Для установления местонахождения локализованных ресурсов и их получения в платформе .NET Framework используется модель "звезда". Центром в этой модели является основная сборка, которая содержит не локализуемый исполняемый код и ресурсы для единственного языка и региональных параметров, называемых нейтральными языком и региональными параметрами, или региональными настройками по умолчанию. Язык и региональные параметры по умолчанию являются резервными параметрами; они используются, когда не доступны локализованные ресурсы. Атрибут <xref:System.Resources.NeutralResourcesLanguageAttribute> используется для указания языка и региональных параметров по умолчанию для приложения. Каждый луч звезды ведет к вспомогательной сборке, которая содержит ресурсы для одного локализованного языка и региональных параметров, но не содержит кода. Так как вспомогательные сборки не являются частью главной сборки, ресурсы, относящиеся к конкретному языку и региональным параметрам, можно легко заменять или обновлять, не заменяя главную сборку приложения.

> [!NOTE]
> Ресурсы языка и региональных параметров по умолчанию приложения также могут храниться и во вспомогательной сборке. Для этого нужно назначить атрибуту <xref:System.Resources.NeutralResourcesLanguageAttribute> значение <xref:System.Resources.UltimateResourceFallbackLocation.Satellite?displayProperty=nameWithType>.

## <a name="satellite-assembly-name-and-location"></a>Имя и расположение вспомогательной сборки

Для реализации модели "звезда" необходимо разместить ресурсы в определенных местах так, чтобы их можно было легко найти и использовать. Если ресурсы именованы неверно или компилируются с ошибками, или неверно расположены, то среда CLR не сможет их найти и будет вместо них использовать ресурсы языка и региональных параметров по умолчанию. Диспетчер ресурсов .NET Framework, представленный объектом <xref:System.Resources.ResourceManager>, используется для автоматического доступа к локализованным ресурсам. Для диспетчера ресурсов необходимо выполнить следующие условия.

- Одна вспомогательная сборка должна включать все ресурсы для определенных языка и региональных параметров. Иначе говоря, необходимо скомпилировать несколько файлов *.txt* или *.resx* в двоичный файл *.resources*.

- Для каждого локализованного языка и региональных параметров, где содержатся ресурсы для языка и региональных параметров, должен быть выделен отдельный вложенный каталог. Имя вложенного каталога должно совпадать с именем языка и региональных параметров. Кроме того, можно хранить вспомогательные сборки в глобальном кэше сборок. В этом случае компонент данных языка и региональных параметров строгого имени сборки должен указывать на свой язык и региональные параметры. (См.раздел [Установка вспомогательных сборок в глобальном кэше сборок](#SN) далее в этой статье.)

  > [!NOTE]
  > Если приложение содержит ресурсы для дочерних языков и региональных параметров, поместите каждый дочерний язык и региональные параметры в отдельный вложенный подкаталог в каталоге приложения. Не следует размещать дочерние языки и региональных параметры во вложенных каталогах каталога основного языка и региональных параметров.

- Вспомогательная сборка должна иметь то же имя, что и приложение, а также должна использовать расширение имени файла ".resources.dll". Например, если приложение называется *Example.exe*, то именем каждой вспомогательной сборки должно быть *Example.resources.dll*. Обратите внимание, что имя вспомогательной сборки не указывает на язык и региональные параметры ее файла ресурсов. Но вспомогательная сборка отображается в каталоге, который указывает на определенные язык и региональные параметры.

- Сведения о языке и региональных параметрах вспомогательной сборки должны быть включены в метаданных сборки. Чтобы сохранить имя языка и региональных параметров в метаданных вспомогательной сборки, необходимо задать параметр `/culture` при использовании [компоновщика сборок](../tools/al-exe-assembly-linker.md) для внедрения ресурсов во вспомогательную сборку.

На следующем рисунке показан пример структуры каталогов и приведены требования к размещению файлов для приложений, которые не устанавливаются в [глобальный кэш сборок](../app-domains/gac.md). Элементы с расширениями имен .txt и .resources не будут включаться в окончательный пакет приложения. Они представляют собой промежуточные файлы ресурсов, используемые для создания итоговых вспомогательных сборок ресурсов. В этом примере можно было бы заменить RESX- файлы на TXT-файлы. Дополнительные сведения см. в статье [Упаковка и развертывание ресурсов](packaging-and-deploying-resources-in-desktop-apps.md).

На следующем изображении показан каталог вспомогательных сборок:

![Каталог вспомогательных сборок с подкаталогами для языков и региональных параметров.](./media/creating-satellite-assemblies-for-desktop-apps/satellite-assembly-directory.gif)

## <a name="compiling-satellite-assemblies"></a>компиляция вспомогательных сборок

Используйте [генератор файлов ресурсов (Resgen.exe)](../tools/resgen-exe-resource-file-generator.md) для компиляции текстовых файлов или файлов XML (*RESX*), содержащих ресурсы, в двоичные *RESOURCES*-файлы. Используйте [компоновщик сборок (Al.exe)](../tools/al-exe-assembly-linker.md) для компиляции *RESOURCES*-файлов во вспомогательные сборки. Программа*Al.exe* создает сборку из указанных *RESOURCES*-файлов. Вспомогательные сборки могут содержать только ресурсы; они не могут содержать исполняемый код.

Следующая команда *Al.exe* служит для создания вспомогательной сборки со строгим именем для приложения `Example` из файла ресурсов региональных настроек Германии *strings.de.resources*.

```console
al -target:lib -embed:strings.de.resources -culture:de -out:Example.resources.dll
```

Следующая команда *Al.exe* служит для создания вспомогательной сборки для приложения `Example` из файла *strings.de.resources*. Параметр **/template** служит для наследования вспомогательной сборкой всех метаданных сборки, за исключением сведений о языке и региональных параметров ее родительской сборки (*Example.dll*).

```console
al -target:lib -embed:strings.de.resources -culture:de -out:Example.resources.dll -template:Example.dll
```  
  
В приведенной ниже таблице более подробно описываются параметры *Al.exe*, используемые в этих командах:
  
|Параметр|Описание|
|------------|-----------------|
|`-target:lib`|Указывает, что вспомогательная сборка компилируется в файл библиотеки (DLL). Так как вспомогательная сборка не содержит исполняемого кода и не является основной сборкой приложения, ее необходимо хранить в виде библиотеки DLL.|
|`-embed:strings.de.resources`|Указывает для программы *Al.exe* имя файла ресурсов, включенного при компиляции сборки. Во вспомогательной сборке можно включить несколько файлов ресурсов, но если следовать модели "звезда", то необходимо компилировать отдельную вспомогательную сборку для каждого языка и региональных параметров. Впрочем, можно создавать и отдельные RESOURCES-файлы для строк и объектов.|
|`-culture:de`|Задает язык и региональные параметры компилируемого ресурса. Среда CLR использует эти сведения в процессе поиска ресурсов, относящихся к указанному языку и региональным параметрам. Если этот параметр не задан, программа *Al.exe* скомпилирует ресурс, но среда выполнения не сможет его найти по запросу пользователя.|
|`-out:Example.resources.dll`|Задает имя выходного файла. Имя должно соответствовать шаблону *baseName*.resources.*extension*, где *baseName* — имя основной сборки, а *extension* — допустимое расширение имени файла (например, DLL). Обратите внимание, что среда выполнения не может определить язык и региональные параметры вспомогательной сборки, основываясь на имени выходного файла; необходимо использовать параметр **/culture**, чтобы указать их.|
|`-template:Example.dll`|Задает сборку, от которой наследуют все метаданные сборки, кроме поля языка и региональных параметров. Этот параметр влияет на вспомогательные сборки только в том случае, если указана сборка, у которой есть [строгое имя](../../standard/assembly/strong-named.md).|
  
 Полный список параметров, доступных в программе *Al.exe*, см. в разделе [Компоновщик сборок (Al.exe)](../tools/al-exe-assembly-linker.md).
  
## <a name="satellite-assemblies-an-example"></a>Вспомогательные сборки: Пример

Ниже приведен простой пример "Hello world", который отображает окно сообщения, содержащее локализованное приветствие. Пример включает ресурсы для английского (США), французского (Франция) и русского (Россия) языка; в качестве нейтрального языка выступает английский. Для создания этого примера выполните следующие действия.
  
1. Создайте файл ресурсов с именем *Greeting.resx* или *Greeting.txt*, который будет содержать ресурсы для языка и региональных параметров по умолчанию. Сохраните одну строку с именем `HelloString` и значением "Hello world!" в этом файле.

2. Чтобы указать, что язык и региональные параметры по умолчанию для приложения — английский (en), необходимо добавить в файл AssemblyInfo приложения или в главный файл исходного кода, которые будут скомпилированы в основную сборку приложения, следующий атрибут <xref:System.Resources.NeutralResourcesLanguageAttribute?displayProperty=nameWithType>.

    [!code-csharp[Conceptual.Resources.Locating#2](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.locating/cs/assemblyinfo.cs#2)]
    [!code-vb[Conceptual.Resources.Locating#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.locating/vb/assemblyinfo.vb#2)]  
  
3. Добавьте поддержку дополнительных языков и региональных параметров (en-US, fr-FR и ru-RU) в приложение следующим образом.  
  
    - Для поддержки региональных настроек "en-US" (английского языка, США) создайте файл ресурсов с именем *Greeting.en-US.resx* или *Greeting.en-US.txt* и сохраните в нем одну строку с именем `HelloString` и значением "Hi world!".
  
    - Для поддержки языка и региональных параметров "fr-FR" (французского языка, Франция) создайте файл ресурсов с именем *Greeting.fr-FR.resx* или *Greeting.fr-FR.txt* и сохраните в нем одну строку с именем `HelloString` и значением "Salut tout le monde!".
  
    - Для поддержки региональных настроек "ru-RU" (русского языка, Россия) создайте файл ресурсов с именем *Greeting.ru-RU.resx* или *Greeting.ru-RU.txt* и сохраните в нем одну строку с именем `HelloString` и значением "Всем привет!".
  
4. Используйте [Resgen.exe](../tools/resgen-exe-resource-file-generator.md) для компиляции каждого текстового файла или файла ресурсов XML в двоичный *RESOURCES*-файл. Выходными данными будет набор файлов, имеющий то же корневое имя файла, что и *RESX-* и *TXT*-файлы, но с расширением *RESOURCES*. При создании примера с помощью Visual Studio процесс компиляции отрегулируется автоматически. Если используется среда, отличная от Visual Studio, выполните следующие команды для компиляции *RESX*-файлов в *RESOURCES*-файлы:  
  
    ```console
    resgen Greeting.resx
    resgen Greeting.en-us.resx
    resgen Greeting.fr-FR.resx
    resgen Greeting.ru-RU.resx
    ```

    Если ресурсы располагаются в текстовых файлах вместо XML-файлов, замените расширение *RESX* на *TXT*.

5. Скомпилируйте следующий исходный код и ресурсы для языка и региональных параметров по умолчанию в основную сборку приложения:

    > [!IMPORTANT]
    > При использовании командной строки, а не Visual Studio, для создания примера, необходимо изменить вызов конструктора класса <xref:System.Resources.ResourceManager> на следующий: `ResourceManager rm = new ResourceManager("Greetings", typeof(Example).Assembly);`

    [!code-csharp[Conceptual.Resources.Locating#1](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.locating/cs/program.cs#1)]
    [!code-vb[Conceptual.Resources.Locating#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.locating/vb/module1.vb#1)]

    Если приложение называется Example и компилируется из командной строки, то команда для компилятора C# имеет вид:

    ```console
    csc Example.cs -res:Greeting.resources
    ```

    Соответствующая команда для компилятора Visual Basic имеет вид:

    ```console
    vbc Example.vb -res:Greeting.resources
    ```

6. Создайте вложенный каталог в каталоге основного приложения для каждого локализованного языка и региональных параметров, поддерживаемых приложением. Необходимо создать вложенные каталоги *en-US*, *fr-FR* и *ru-RU*. Visual Studio автоматически создает эти вложенные каталоги в процессе компиляции.

7. Внедрите отдельные *RESOURCES*-файлы для определенного языка и региональных параметров во вспомогательные сборки и сохраните их в соответствующем каталоге. Для этого можно воспользоваться командой для каждого *RESOURCES*-файла:

    ```console
    al -target:lib -embed:Greeting.culture.resources -culture:culture -out:culture\Example.resources.dll
    ```

     где *culture* — имя языка и региональных параметров, ресурсы которых содержит вспомогательная сборка. Visual Studio автоматически обрабатывает этот процесс.

Затем можно запустить пример. Он будет случайным образом выбирать один из поддерживаемых языков и региональных параметров и отображать локализованное приветствие.

<a name="SN"></a>

## <a name="installing-satellite-assemblies-in-the-global-assembly-cache"></a>Установка вспомогательных сборок в глобальный кэш сборок

Вместо установки сборок во вложенном каталоге локального приложения их можно установить в глобальный кэш сборок. Это особенно полезно, если библиотеки классов и сборки ресурсов библиотеки классов используются несколькими приложениями.
  
Все сборки, устанавливаемые в глобальный кэш сборок, должны иметь строгие имена. Сборки со строгими именами должны быть подписаны допустимой парой открытого и закрытого ключей. Они содержат сведения о версии, с помощью которых среда выполнения определяет, какую сборку следует использовать для удовлетворения запроса привязки. Дополнительные сведения о строгих именах и управлении версиями см. в разделе [Управление версиями сборки](../../standard/assembly/versioning.md). Дополнительные сведения о строгих именах см. в разделе [Сборки со строгими именами](../../standard/assembly/strong-named.md).

Разработчик приложения, как правило, не имеет доступа к итоговой паре открытого и закрытого ключей. Чтобы установить вспомогательную сборку в глобальный кэш сборок и обеспечить ее работоспособность, можно воспользоваться средством отложенной подписи. Если подписание сборки откладывается, во время построения в файле резервируется место для подписи строгим именем. Фактически подписание откладывается до того момента, когда становится доступной итоговая пара открытого и закрытого ключей. Дополнительные сведения об отложенной подписи см. в разделе [Отложенная подпись сборки](../../standard/assembly/delay-sign.md).

### <a name="obtaining-the-public-key"></a>Получение открытого ключа

Чтобы отложить подпись сборки, необходимо иметь доступ к открытому ключу. Открытый ключ можно либо получить в организации, которая будет заниматься окончательным подписанием, либо создать самостоятельно с помощью [программы строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md).

Следующая команда *Sn.exe* создает тестовые пары открытого и закрытого ключей. Параметр **–k** указывает, что *Sn.exe* необходимо создать новую пару ключей и сохранить ее в заданном файле с именем *TestKeyPair.snk*.
  
```console
sn –k TestKeyPair.snk
```

Открытый ключ можно извлечь из файла, содержащего тестовую пару ключей. Следующая команда извлекает открытый ключ из *TestKeyPair.snk* и сохраняет его в *PublicKey.snk*:

```console
sn –p TestKeyPair.snk PublicKey.snk
```

### <a name="delay-signing-an-assembly"></a>Отложенная подпись сборки

После получения или создания открытого ключа, можно скомпилировать сборку и указать отложенную подпись, используя [компоновщик сборок (Al.exe)](../tools/al-exe-assembly-linker.md).

Следующая команда *Al.exe* служит для создания вспомогательной сборки со строгим именем для приложения StringLibrary из файла *strings.ja.resources*:

```console
al -target:lib -embed:strings.ja.resources -culture:ja -out:StringLibrary.resources.dll -delay+ -keyfile:PublicKey.snk
```

Параметр **-delay+** указывает, что компоновщик сборок должен отложить подпись сборки. Параметр **-keyfile** задает имя файла ключа, в котором содержится открытый ключ, применяемый для откладывания подписи сборки.

### <a name="re-signing-an-assembly"></a>Повторная подпись сборки

Прежде чем развертывать приложение, можно заново подписать вспомогательную сборку, подписание которой было отложено, реальной парой ключей. Это можно сделать с помощью программы *Sn.exe*.

Следующая команда *Sn.exe* используется для подписи *StringLibrary.resources.dll* парой ключей, хранящихся в файле *RealKeyPair.snk*. Параметр **–R** указывает, что нужно заново подписать сборку с отложенной подписью или сборку, которая должна быть подписана заново.

```console
sn –R StringLibrary.resources.dll RealKeyPair.snk
```

### <a name="installing-a-satellite-assembly-in-the-global-assembly-cache"></a>Установка вспомогательной сборки в глобальный кэш сборок

Когда среда выполнения ищет ресурсы в процессе перехода на резервные средства, в первую очередь она ищет [глобальный кэш сборок](../app-domains/gac.md). (Дополнительные сведения см. в подразделе "Процесс использования резервных ресурсов" раздела [Упаковка и развертывание ресурсов](packaging-and-deploying-resources-in-desktop-apps.md).) Как только вспомогательная сборка подписана строгим именем, ее можно установить в глобальном кэше сборок с помощью [программы глобального кэша сборок (Gacutil.exe)](../tools/gacutil-exe-gac-tool.md).

Следующая команда *Gacutil.exe* устанавливает *StringLibrary.resources.dll** в глобальный кэш сборок:

```console
gacutil -i:StringLibrary.resources.dll
```

Параметр **/i** указывает программе *Gacutil.exe*, что данную сборку требуется установить в глобальный кэш сборок. После того, как вспомогательная сборка установлена в кэше, ресурсы, которые она содержит, становятся доступны для всех приложений, которые предназначены для использования вспомогательной сборки.

### <a name="resources-in-the-global-assembly-cache-an-example"></a>Ресурсы в глобальном кэше сборок: Пример

В следующем примере используется метод библиотеки классов .NET Framework для извлечения и возврата локализованных приветствий из файла ресурсов. Библиотека и ее ресурсы зарегистрированы в глобальном кэше сборок. Пример включает ресурсы для английского (США), французского (Франция), русского (Россия) и английского языков и региональных параметров. Английский является языком по умолчанию; ресурсы для него хранятся в основной сборке. Пример изначально задерживает подпись библиотеки и вспомогательных сборок открытым ключом, а затем заново подписывает их парой открытого и закрытого ключей. Для создания этого примера выполните следующие действия.

1. Если вы не применяете Visual Studio, используйте следующую команду [средства строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md), чтобы создать пару открытого и закрытого ключей с именем *ResKey.snk*:

    ```console
    sn –k ResKey.snk
    ```

    Если вы используете Visual Studio, воспользуйтесь вкладкой **Подпись** диалогового окна **Свойства** проекта, чтобы создать ключ.

2. Используйте следующую команду [средства строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md), чтобы создать файл открытого ключа с именем *PublicKey.snk*:

    ```console
    sn –p ResKey.snk PublicKey.snk
    ```

3. Создайте файл ресурсов с именем *Strings.resx*, который будет содержать ресурсы для языка и региональных параметров по умолчанию. Сохраните одну строку с именем `Greeting` и значением "How do you do?" в этом файле.

4. Чтобы указать, что язык и региональные параметры по умолчанию для приложения — "en", необходимо добавить в файл AssemblyInfo приложения или в главный файл исходного кода, которые будут скомпилированы в основную сборку приложения, следующий атрибут <xref:System.Resources.NeutralResourcesLanguageAttribute?displayProperty=nameWithType>:

    [!code-csharp[Conceptual.Resources.Satellites#2](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.satellites/cs/stringlibrary.cs#2)]
    [!code-vb[Conceptual.Resources.Satellites#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.satellites/vb/stringlibrary.vb#2)]

5. Добавьте поддержку дополнительных языков и региональных параметров (en-US, fr-FR и ru-RU) в приложение следующим образом.

    - Для поддержки региональных настроек "en-US" (английского языка, США) создайте файл ресурсов с именем *Strings.en-US.resx* или *Strings.en-US.txt* и сохраните в нем одну строку с именем `Greeting` и значением "Hello!".

    - Для поддержки языка и региональных параметров "fr-FR" (французского языка, Франция) создайте файл ресурсов с именем *Strings.fr-FR.resx* или *Strings.fr-FR.txt* и сохраните в нем одну строку с именем `Greeting` и значением "Bon jour!".

    - Для поддержки языка и региональных параметров "ru-RU" (русского языка, Россия) создайте файл ресурсов с именем *Strings.ru-RU.resx* или *Strings.ru-RU.txt* и сохраните в нем одну строку с именем `Greeting` и значением "Привет!".

6. Используйте [Resgen.exe](../tools/resgen-exe-resource-file-generator.md) для компиляции каждого текстового файла или файла ресурсов XML в двоичный RESOURCES-файл. Выходными данными будет набор файлов, имеющий то же корневое имя файла, что и *RESX-* и *TXT*-файлы, но с расширением *RESOURCES*. При создании примера с помощью Visual Studio процесс компиляции отрегулируется автоматически. Если используется среда, отличная от Visual Studio, выполните следующую команду для компиляции *RESX*-файлов в *RESOURCES*-файлы:

    ```console
    resgen filename
    ```

    Где *filename* — дополнительный путь, имя и расширение *RESX*-файла или текстового файла.

7. Скомпилируйте следующий исходный код для *StringLibrary.vb* или *StringLibrary.cs* с ресурсами для региональных настроек по умолчанию в библиотеки сборки с отложенной подписью с именем *StringLibrary.dll*:

    > [!IMPORTANT]
    > При использовании командной строки, а не Visual Studio, для создания примера следует изменить вызов конструктора класса <xref:System.Resources.ResourceManager> на следующий: `ResourceManager rm = new ResourceManager("Strings",` `typeof(Example).Assembly);`.

    [!code-csharp[Conceptual.Resources.Satellites#1](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.satellites/cs/stringlibrary.cs#1)]
    [!code-vb[Conceptual.Resources.Satellites#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.satellites/vb/stringlibrary.vb#1)]

    Команда для компилятора C# имеет вид:

    ```console
    csc -t:library -resource:Strings.resources -delaysign+ -keyfile:publickey.snk StringLibrary.cs
    ```

    Соответствующая команда для компилятора Visual Basic имеет вид:

    ```console
    vbc -t:library -resource:Strings.resources -delaysign+ -keyfile:publickey.snk StringLibrary.vb
    ```

8. Создайте вложенный каталог в каталоге основного приложения для каждого локализованного языка и региональных параметров, поддерживаемых приложением. Необходимо создать вложенные каталоги *en-US*, *fr-FR* и *ru-RU*. Visual Studio автоматически создает эти вложенные каталоги в процессе компиляции. Так как все вспомогательные сборки имеют одно и то же имя файла, вложенные каталоги используются для хранения отдельных вспомогательных сборок для языка и региональных параметров до тех пор, пока они не подписаны парой открытого и закрытого ключей.

9. Внедрите отдельные *RESOURCES*-файлы ресурсов для определенного языка и региональных параметров во вспомогательные сборки с отложенной подписью и сохраните в соответствующем каталоге. Для этого можно воспользоваться командой для каждого *RESOURCES*-файла:

    ```console
    al -target:lib -embed:Strings.culture.resources -culture:culture -out:culture\StringLibrary.resources.dll -delay+ -keyfile:publickey.snk
    ```

    где *culture* — название языка и региональных параметров. В этом примере имена региональных настроек: en-US, fr-FR, и ru-RU.

10. Подпишите заново *StringLibrary.dll* с помощью [средства строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md) следующим образом:

    ```console
    sn –R StringLibrary.dll RealKeyPair.snk
    ```

11. Подпишите заново отдельные вспомогательные сборки. Для этого используйте [средство строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md) для каждой вспомогательной сборки, как показано ниже.

    ```console
    sn –R StringLibrary.resources.dll RealKeyPair.snk
    ```

12. Зарегистрируйте *StringLibrary.dll* и все вспомогательные сборки в глобальном кэше сборок с помощью следующей команды:

    ```console
    gacutil -i filename
    ```

    где *filename* — имя регистрируемого файла.

13. Если вы используете Visual Studio, создайте проект **консольного приложения** с именем `Example`, добавьте в него следующий исходный код и ссылку на *StringLibrary.dll* и скомпилируйте.

    [!code-csharp[Conceptual.Resources.Satellites#3](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.satellites/cs/example.cs#3)]
    [!code-vb[Conceptual.Resources.Satellites#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.satellites/vb/example.vb#3)]

    Чтобы скомпилировать из командной строки используйте следующую команду для компилятора C#:

    ```console
    csc Example.cs -r:StringLibrary.dll
    ```

    Команда компилятора для Visual Basic:

    ```console
    vbc Example.vb -r:StringLibrary.dll
    ```

14. Запустите *Example.exe*.

## <a name="see-also"></a>См. также

- [Упаковка и развертывание ресурсов](packaging-and-deploying-resources-in-desktop-apps.md)
- [Отложенная подпись сборки](../../standard/assembly/delay-sign.md)
- [Al.exe (компоновщик сборок)](../tools/al-exe-assembly-linker.md)
- [Sn.exe (средство строгих имен)](../tools/sn-exe-strong-name-tool.md)
- [Gacutil.exe (программа глобального кэша сборок)](../tools/gacutil-exe-gac-tool.md)
- [Ресурсы в приложениях для настольных систем](index.md)
