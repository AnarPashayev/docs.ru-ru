---
title: Создание вспомогательных сборок для приложений для настольных систем
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- deploying applications [.NET Framework], resources
- resource files, deploying
- hub-and-spoke resource deployment model
- resource files, packaging
- application resources, packaging
- public keys, obtaining
- satellite assemblies
- assemblies [.NET Framework], signing
- application resources, deploying
- Al.exe
- GAC (global assembly cache), satellite assemblies
- Assembly Linker
- directory locations for satellite assemblies
- global assembly cache, satellite assemblies
- packaging application resources
- compiling satellite assemblies
- re-signing assemblies
ms.assetid: 8d5c6044-2919-41d2-8321-274706b295ac
ms.openlocfilehash: 5efc5001a1a9756e09053d684a2f6673d15fadcf
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458017"
---
# <a name="creating-satellite-assemblies-for-desktop-apps"></a><span data-ttu-id="d6ba8-102">Создание вспомогательных сборок для приложений для настольных систем</span><span class="sxs-lookup"><span data-stu-id="d6ba8-102">Creating Satellite Assemblies for Desktop Apps</span></span>

<span data-ttu-id="d6ba8-103">Файлы ресурсов играют важную роль в локализованных приложениях.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-103">Resource files play a central role in localized applications.</span></span> <span data-ttu-id="d6ba8-104">Они позволяют приложению использовать для отображения строк, изображений и других данных текущие региональные настройки пользователя, а также предоставлять альтернативные данных при отсутствии необходимых ресурсов для языка и региональных параметров этого пользователя.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-104">They enable an application to display strings, images, and other data in the user's own language and culture, and to provide alternate data if resources for the user's own language or culture are unavailable.</span></span> <span data-ttu-id="d6ba8-105">Для установления местонахождения локализованных ресурсов и их получения в платформе .NET Framework используется модель "звезда".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-105">The .NET Framework uses a hub-and-spoke model to locate and retrieve localized resources.</span></span> <span data-ttu-id="d6ba8-106">Центром в этой модели является основная сборка, которая содержит не локализуемый исполняемый код и ресурсы для единственного языка и региональных параметров, называемых нейтральными языком и региональными параметрами, или региональными настройками по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-106">The hub is the main assembly that contains the non-localizable executable code and the resources for a single culture, which is called the neutral or default culture.</span></span> <span data-ttu-id="d6ba8-107">Язык и региональные параметры по умолчанию являются резервными параметрами; они используются, когда не доступны локализованные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-107">The default culture is the fallback culture for the application; it is used when no localized resources are available.</span></span> <span data-ttu-id="d6ba8-108">Атрибут <xref:System.Resources.NeutralResourcesLanguageAttribute> используется для указания языка и региональных параметров по умолчанию для приложения.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-108">You use the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute to designate the culture of the application's default culture.</span></span> <span data-ttu-id="d6ba8-109">Каждый луч звезды ведет к вспомогательной сборке, которая содержит ресурсы для одного локализованного языка и региональных параметров, но не содержит кода.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-109">Each spoke connects to a satellite assembly that contains the resources for a single localized culture but does not contain any code.</span></span> <span data-ttu-id="d6ba8-110">Так как вспомогательные сборки не являются частью главной сборки, ресурсы, относящиеся к конкретному языку и региональным параметрам, можно легко заменять или обновлять, не заменяя главную сборку приложения.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-110">Because the satellite assemblies are not part of the main assembly, you can easily update or replace resources that correspond to a specific culture without replacing the main assembly for the application.</span></span>

> [!NOTE]
> <span data-ttu-id="d6ba8-111">Ресурсы языка и региональных параметров по умолчанию приложения также могут храниться и во вспомогательной сборке.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-111">The resources of an application's default culture can also be stored in a satellite assembly.</span></span> <span data-ttu-id="d6ba8-112">Для этого нужно назначить атрибуту <xref:System.Resources.NeutralResourcesLanguageAttribute> значение <xref:System.Resources.UltimateResourceFallbackLocation.Satellite?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-112">To do this, you assign the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute a value of <xref:System.Resources.UltimateResourceFallbackLocation.Satellite?displayProperty=nameWithType>.</span></span>

## <a name="satellite-assembly-name-and-location"></a><span data-ttu-id="d6ba8-113">Имя и расположение вспомогательной сборки</span><span class="sxs-lookup"><span data-stu-id="d6ba8-113">Satellite Assembly Name and Location</span></span>

<span data-ttu-id="d6ba8-114">Для реализации модели "звезда" необходимо разместить ресурсы в определенных местах так, чтобы их можно было легко найти и использовать.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-114">The hub-and-spoke model requires that you place resources in specific locations so that they can be easily located and used.</span></span> <span data-ttu-id="d6ba8-115">Если ресурсы именованы неверно или компилируются с ошибками, или неверно расположены, то среда CLR не сможет их найти и будет вместо них использовать ресурсы языка и региональных параметров по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-115">If you do not compile and name resources as expected, or if you do not place them in the correct locations, the common language runtime will not be able to locate them and will use the resources of the default culture instead.</span></span> <span data-ttu-id="d6ba8-116">Диспетчер ресурсов .NET Framework, представленный объектом <xref:System.Resources.ResourceManager>, используется для автоматического доступа к локализованным ресурсам.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-116">The .NET Framework Resource Manager, represented by a <xref:System.Resources.ResourceManager> object, is used to automatically access localized resources.</span></span> <span data-ttu-id="d6ba8-117">Для диспетчера ресурсов необходимо выполнить следующие условия.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-117">The Resource Manager requires the following:</span></span>

- <span data-ttu-id="d6ba8-118">Одна вспомогательная сборка должна включать все ресурсы для определенных языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-118">A single satellite assembly must include all the resources for a particular culture.</span></span> <span data-ttu-id="d6ba8-119">Иными словами, следует компилировать несколько файлов *. txt* или *. resx* в один двоичный файл *Resources* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-119">In other words, you should compile multiple *.txt* or *.resx* files into a single binary *.resources* file.</span></span>

- <span data-ttu-id="d6ba8-120">Для каждого локализованного языка и региональных параметров, где содержатся ресурсы для языка и региональных параметров, должен быть выделен отдельный вложенный каталог.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-120">There must be a separate subdirectory in the application directory for each localized culture that stores that culture's resources.</span></span> <span data-ttu-id="d6ba8-121">Имя вложенного каталога должно совпадать с именем языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-121">The subdirectory name must be the same as the culture name.</span></span> <span data-ttu-id="d6ba8-122">Кроме того, можно хранить вспомогательные сборки в глобальном кэше сборок.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-122">Alternately, you can store your satellite assemblies in the global assembly cache.</span></span> <span data-ttu-id="d6ba8-123">В этом случае компонент данных языка и региональных параметров строгого имени сборки должен указывать на свой язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-123">In this case, the culture information component of the assembly's strong name must indicate its culture.</span></span> <span data-ttu-id="d6ba8-124">(См.раздел [Установка вспомогательных сборок в глобальном кэше сборок](#SN) далее в этой статье.)</span><span class="sxs-lookup"><span data-stu-id="d6ba8-124">(See the [Installing Satellite Assemblies in the Global Assembly Cache](#SN) section later in this topic.)</span></span>

  > [!NOTE]
  > <span data-ttu-id="d6ba8-125">Если приложение содержит ресурсы для дочерних языков и региональных параметров, поместите каждый дочерний язык и региональные параметры в отдельный вложенный подкаталог в каталоге приложения.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-125">If your application includes resources for subcultures, place each subculture in a separate subdirectory under the application directory.</span></span> <span data-ttu-id="d6ba8-126">Не следует размещать дочерние языки и региональных параметры во вложенных каталогах каталога основного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-126">Do not place subcultures in subdirectories under their main culture's directory.</span></span>

- <span data-ttu-id="d6ba8-127">Вспомогательная сборка должна иметь то же имя, что и приложение, а также должна использовать расширение имени файла ".resources.dll".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-127">The satellite assembly must have the same name as the application, and must use the file name extension ".resources.dll".</span></span> <span data-ttu-id="d6ba8-128">Например, если приложение называется *example. exe*, имя каждой вспомогательной сборки должно быть *example. Resources. dll*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-128">For example, if an application is named *Example.exe*, the name of each satellite assembly should be *Example.resources.dll*.</span></span> <span data-ttu-id="d6ba8-129">Обратите внимание, что имя вспомогательной сборки не указывает на язык и региональные параметры ее файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-129">Note that the satellite assembly name does not indicate the culture of its resource files.</span></span> <span data-ttu-id="d6ba8-130">Но вспомогательная сборка отображается в каталоге, который указывает на определенные язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-130">However, the satellite assembly appears in a directory that does specify the culture.</span></span>

- <span data-ttu-id="d6ba8-131">Сведения о языке и региональных параметрах вспомогательной сборки должны быть включены в метаданных сборки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-131">Information about the culture of the satellite assembly must be included in the assembly's metadata.</span></span> <span data-ttu-id="d6ba8-132">Чтобы сохранить имя языка и региональных параметров в метаданных вспомогательной сборки, необходимо задать параметр `/culture` при использовании [компоновщика сборок](../tools/al-exe-assembly-linker.md) для внедрения ресурсов во вспомогательную сборку.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-132">To store the culture name in the satellite assembly's metadata, you specify the `/culture` option when you use [Assembly Linker](../tools/al-exe-assembly-linker.md) to embed resources in the satellite assembly.</span></span>

<span data-ttu-id="d6ba8-133">На следующем рисунке показан пример структуры каталогов и приведены требования к размещению файлов для приложений, которые не устанавливаются в [глобальный кэш сборок](../app-domains/gac.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-133">The following illustration shows a sample directory structure and location requirements for applications that you are not installing in the [global assembly cache](../app-domains/gac.md).</span></span> <span data-ttu-id="d6ba8-134">Элементы с расширениями имен .txt и .resources не будут включаться в окончательный пакет приложения.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-134">The items with .txt and .resources extensions will not ship with the final application.</span></span> <span data-ttu-id="d6ba8-135">Они представляют собой промежуточные файлы ресурсов, используемые для создания итоговых вспомогательных сборок ресурсов.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-135">These are the intermediate resource files used to create the final satellite resource assemblies.</span></span> <span data-ttu-id="d6ba8-136">В этом примере можно было бы заменить RESX- файлы на TXT-файлы.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-136">In this example, you could substitute .resx files for the .txt files.</span></span> <span data-ttu-id="d6ba8-137">Дополнительные сведения см. в статье [Упаковка и развертывание ресурсов](packaging-and-deploying-resources-in-desktop-apps.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-137">For more information, see [Packaging and Deploying Resources](packaging-and-deploying-resources-in-desktop-apps.md).</span></span>

<span data-ttu-id="d6ba8-138">На следующем изображении показан каталог вспомогательных сборок:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-138">The following image shows the satellite assembly directory:</span></span>

![Каталог вспомогательных сборок с подкаталогами для языков и региональных параметров.](./media/creating-satellite-assemblies-for-desktop-apps/satellite-assembly-directory.gif)

## <a name="compiling-satellite-assemblies"></a><span data-ttu-id="d6ba8-140">компиляция вспомогательных сборок</span><span class="sxs-lookup"><span data-stu-id="d6ba8-140">Compiling Satellite Assemblies</span></span>

<span data-ttu-id="d6ba8-141">[Генератор файлов ресурсов (Resgen. exe)](../tools/resgen-exe-resource-file-generator.md) используется для компиляции текстовых файлов или файлов XML (*RESX*), содержащих ресурсы, в двоичные *Resources* -файлы.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-141">You use [Resource File Generator (Resgen.exe)](../tools/resgen-exe-resource-file-generator.md) to compile text files or XML (*.resx*) files that contain resources to binary *.resources* files.</span></span> <span data-ttu-id="d6ba8-142">Затем используйте [Компоновщик сборок (Al. exe)](../tools/al-exe-assembly-linker.md) для компиляции *Resources* -файлов во вспомогательные сборки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-142">You then use [Assembly Linker (Al.exe)](../tools/al-exe-assembly-linker.md) to compile *.resources* files into satellite assemblies.</span></span> <span data-ttu-id="d6ba8-143">Программа *Al. exe* создает сборку из указанных вами файлов *Resources* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-143">*Al.exe* creates an assembly from the *.resources* files that you specify.</span></span> <span data-ttu-id="d6ba8-144">Вспомогательные сборки могут содержать только ресурсы; они не могут содержать исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-144">Satellite assemblies can contain only resources; they cannot contain any executable code.</span></span>

<span data-ttu-id="d6ba8-145">Следующая команда *Al. exe* создает вспомогательную сборку для приложения `Example` из файла ресурсов на немецком языке *Strings. de. Resources*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-145">The following *Al.exe* command creates a satellite assembly for the application `Example` from the German resources file *strings.de.resources*.</span></span>

```console
al -target:lib -embed:strings.de.resources -culture:de -out:Example.resources.dll
```

<span data-ttu-id="d6ba8-146">Следующая команда *Al. exe* также создает вспомогательную сборку для приложения `Example` из файла *Strings. de. Resources*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-146">The following *Al.exe* command also creates a satellite assembly for the application `Example` from the file *strings.de.resources*.</span></span> <span data-ttu-id="d6ba8-147">Параметр **/template** заставляет вспомогательную сборку наследовать все метаданные сборки, за исключением сведений о языке и региональных параметрах родительской сборки (*example. dll*).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-147">The **/template** option causes the satellite assembly to inherit all assembly metadata except for its culture information from the parent assembly (*Example.dll*).</span></span>

```console
al -target:lib -embed:strings.de.resources -culture:de -out:Example.resources.dll -template:Example.dll
```  
  
<span data-ttu-id="d6ba8-148">В следующей таблице приведены более подробные сведения о параметрах *Al. exe* , используемых в этих командах.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-148">The following table describes the *Al.exe* options used in these commands in more detail:</span></span>
  
|<span data-ttu-id="d6ba8-149">Параметр</span><span class="sxs-lookup"><span data-stu-id="d6ba8-149">Option</span></span>|<span data-ttu-id="d6ba8-150">Описание</span><span class="sxs-lookup"><span data-stu-id="d6ba8-150">Description</span></span>|
|------------|-----------------|
|`-target:lib`|<span data-ttu-id="d6ba8-151">Указывает, что вспомогательная сборка компилируется в файл библиотеки (DLL).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-151">Specifies that your satellite assembly is compiled to a library (.dll) file.</span></span> <span data-ttu-id="d6ba8-152">Так как вспомогательная сборка не содержит исполняемого кода и не является основной сборкой приложения, ее необходимо хранить в виде библиотеки DLL.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-152">Because a satellite assembly does not contain executable code and is not an application's main assembly, you must save satellite assemblies as DLLs.</span></span>|
|`-embed:strings.de.resources`|<span data-ttu-id="d6ba8-153">Указывает имя файла ресурсов, который будет внедрен при компиляции сборки *Al. exe* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-153">Specifies the name of the resource file to embed when *Al.exe* compiles the assembly.</span></span> <span data-ttu-id="d6ba8-154">Во вспомогательной сборке можно включить несколько файлов ресурсов, но если следовать модели "звезда", то необходимо компилировать отдельную вспомогательную сборку для каждого языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-154">You can embed multiple .resources files in a satellite assembly, but if you are following the hub-and-spoke model, you must compile one satellite assembly for each culture.</span></span> <span data-ttu-id="d6ba8-155">Впрочем, можно создавать и отдельные RESOURCES-файлы для строк и объектов.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-155">However, you can create separate .resources files for strings and objects.</span></span>|
|`-culture:de`|<span data-ttu-id="d6ba8-156">Задает язык и региональные параметры компилируемого ресурса.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-156">Specifies the culture of the resource to compile.</span></span> <span data-ttu-id="d6ba8-157">Среда CLR использует эти сведения в процессе поиска ресурсов, относящихся к указанному языку и региональным параметрам.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-157">The common language runtime uses this information when it searches for the resources for a specified culture.</span></span> <span data-ttu-id="d6ba8-158">Если этот параметр не задан, программа *Al. exe* по-прежнему будет компилировать ресурс, но среда выполнения не сможет найти его по запросу пользователя.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-158">If you omit this option, *Al.exe* will still compile the resource, but the runtime will not be able to find it when a user requests it.</span></span>|
|`-out:Example.resources.dll`|<span data-ttu-id="d6ba8-159">Задает имя выходного файла.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-159">Specifies the name of the output file.</span></span> <span data-ttu-id="d6ba8-160">Имя должно соответствовать шаблону *baseName*.resources.*extension*, где *baseName* — имя основной сборки, а *extension* — допустимое расширение имени файла (например, DLL).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-160">The name must follow the naming standard *baseName*.resources.*extension*, where *baseName* is the name of the main assembly and *extension* is a valid file name extension (such as .dll).</span></span> <span data-ttu-id="d6ba8-161">Обратите внимание, что среда выполнения не может определить язык и региональные параметры вспомогательной сборки, основываясь на имени выходного файла; необходимо использовать параметр **/culture**, чтобы указать их.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-161">Note that the runtime is not able to determine the culture of a satellite assembly based on its output file name; you must use the **/culture** option to specify it.</span></span>|
|`-template:Example.dll`|<span data-ttu-id="d6ba8-162">Задает сборку, от которой наследуют все метаданные сборки, кроме поля языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-162">Specifies an assembly from which the satellite assembly will inherit all assembly metadata except the culture field.</span></span> <span data-ttu-id="d6ba8-163">Этот параметр влияет на вспомогательные сборки только в том случае, если указана сборка, у которой есть [строгое имя](../../standard/assembly/strong-named.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-163">This option affects satellite assemblies only if you specify an assembly that has a [strong name](../../standard/assembly/strong-named.md).</span></span>|
  
 <span data-ttu-id="d6ba8-164">Полный список параметров, доступных в программе *Al. exe*, см. в разделе [Компоновщик сборок (Al. exe)](../tools/al-exe-assembly-linker.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-164">For a complete list of options available with *Al.exe*, see [Assembly Linker (Al.exe)](../tools/al-exe-assembly-linker.md).</span></span>
  
## <a name="satellite-assemblies-an-example"></a><span data-ttu-id="d6ba8-165">Пример вспомогательных сборок</span><span class="sxs-lookup"><span data-stu-id="d6ba8-165">Satellite Assemblies: An Example</span></span>

<span data-ttu-id="d6ba8-166">Ниже приведен простой пример "Hello world", который отображает окно сообщения, содержащее локализованное приветствие.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-166">The following is a simple "Hello world" example that displays a message box containing a localized greeting.</span></span> <span data-ttu-id="d6ba8-167">Пример включает ресурсы для английского (США), французского (Франция) и русского (Россия) языка; в качестве нейтрального языка выступает английский.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-167">The example includes resources for the English (United States), French (France), and Russian (Russia) cultures, and its fallback culture is English.</span></span> <span data-ttu-id="d6ba8-168">Для создания этого примера выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-168">To create the example, do the following:</span></span>
  
1. <span data-ttu-id="d6ba8-169">Создайте файл ресурсов с именем *приветствия. resx* или *Приветствие. txt* , который будет содержать ресурс для языка и региональных параметров по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-169">Create a resource file named *Greeting.resx* or *Greeting.txt* to contain the resource for the default culture.</span></span> <span data-ttu-id="d6ba8-170">Сохраните одну строку с именем `HelloString` и значением "Hello world!"</span><span class="sxs-lookup"><span data-stu-id="d6ba8-170">Store a single string named `HelloString` whose value is "Hello world!"</span></span> <span data-ttu-id="d6ba8-171">в этом файле.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-171">in this file.</span></span>

2. <span data-ttu-id="d6ba8-172">Чтобы указать, что язык и региональные параметры по умолчанию для приложения — английский (en), необходимо добавить в файл AssemblyInfo приложения или в главный файл исходного кода, которые будут скомпилированы в основную сборку приложения, следующий атрибут <xref:System.Resources.NeutralResourcesLanguageAttribute?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-172">To indicate that English (en) is the application's default culture, add the following <xref:System.Resources.NeutralResourcesLanguageAttribute?displayProperty=nameWithType> attribute to the application's AssemblyInfo file or to the main source code file that will be compiled into the application's main assembly.</span></span>

    [!code-csharp[Conceptual.Resources.Locating#2](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.locating/cs/assemblyinfo.cs#2)]
    [!code-vb[Conceptual.Resources.Locating#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.locating/vb/assemblyinfo.vb#2)]  
  
3. <span data-ttu-id="d6ba8-173">Добавьте поддержку дополнительных языков и региональных параметров (en-US, fr-FR и ru-RU) в приложение следующим образом.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-173">Add support for additional cultures (en-US, fr-FR, and ru-RU) to the application as follows:</span></span>  
  
    - <span data-ttu-id="d6ba8-174">Для поддержки языка и региональных параметров "en-US" или "Английский (США)" Создайте файл ресурсов с именем " *Приветствие. en-US. resx* " или " *поздравление. en-US. txt*" и сохраните в нем одну строку с именем `HelloString`, значением которой является "Hi World!".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-174">To support the en-US or English (United States) culture, create a resource file named *Greeting.en-US.resx* or *Greeting.en-US.txt*, and store in it a single string named `HelloString` whose value is "Hi world!".</span></span>
  
    - <span data-ttu-id="d6ba8-175">Чтобы обеспечить поддержку языка и региональных параметров fr-FR или французский (Франция), создайте файл ресурсов с именем *Greeting.fr-FR. resx* или *Greeting.fr-FR. txt*и сохраните в нем одну строку с именем `HelloString`, значение которой — "приветствие Tout Le Monde!".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-175">To support the fr-FR or French (France) culture, create a resource file named *Greeting.fr-FR.resx* or *Greeting.fr-FR.txt*, and store in it a single string named `HelloString` whose value is "Salut tout le monde!".</span></span>
  
    - <span data-ttu-id="d6ba8-176">Чтобы обеспечить поддержку языка и региональных параметров "ru-RU" или "Русский (Россия)", создайте файл ресурсов с именем *Greeting.ru-ru. resx* или *Greeting.ru-ru. txt*и сохраните в нем одну строку с именем `HelloString`, значение которой равно "всем языка!".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-176">To support the ru-RU or Russian (Russia) culture, create a resource file named *Greeting.ru-RU.resx* or *Greeting.ru-RU.txt*, and store in it a single string named `HelloString` whose value is "Всем привет!".</span></span>
  
4. <span data-ttu-id="d6ba8-177">Используйте [Resgen. exe](../tools/resgen-exe-resource-file-generator.md) для компиляции каждого текстового или XML-файла ресурсов в файл Binary *. Resources* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-177">Use [Resgen.exe](../tools/resgen-exe-resource-file-generator.md) to compile each text or XML resource file to a binary *.resources* file.</span></span> <span data-ttu-id="d6ba8-178">Выходные данные представляют собой набор файлов с тем же корневым именем файла, что и файлы *RESX* или *txt* , но с расширением *Resources* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-178">The output is a set of files that have the same root file name as the *.resx* or *.txt* files, but a *.resources* extension.</span></span> <span data-ttu-id="d6ba8-179">При создании примера с помощью Visual Studio процесс компиляции отрегулируется автоматически.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-179">If you create the example with Visual Studio, the compilation process is handled automatically.</span></span> <span data-ttu-id="d6ba8-180">Если вы не используете Visual Studio, выполните следующие команды, чтобы скомпилировать *RESX* – файлы в *Resources* :</span><span class="sxs-lookup"><span data-stu-id="d6ba8-180">If you aren't using Visual Studio, run the following commands to compile the *.resx* files into *.resources* files:</span></span>  
  
    ```console
    resgen Greeting.resx
    resgen Greeting.en-us.resx
    resgen Greeting.fr-FR.resx
    resgen Greeting.ru-RU.resx
    ```

    <span data-ttu-id="d6ba8-181">Если ресурсы находятся в текстовых файлах, а не в XML-файлах, замените расширение *RESX* на *txt*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-181">If your resources are in text files instead of XML files, replace the *.resx* extension with *.txt*.</span></span>

5. <span data-ttu-id="d6ba8-182">Скомпилируйте следующий исходный код и ресурсы для языка и региональных параметров по умолчанию в основную сборку приложения:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-182">Compile the following source code along with the resources for the default culture into the application's main assembly:</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="d6ba8-183">При использовании командной строки, а не Visual Studio, для создания примера, необходимо изменить вызов конструктора класса <xref:System.Resources.ResourceManager> на следующий: `ResourceManager rm = new ResourceManager("Greetings", typeof(Example).Assembly);`</span><span class="sxs-lookup"><span data-stu-id="d6ba8-183">If you are using the command line rather than Visual Studio to create the example, you should modify the call to the <xref:System.Resources.ResourceManager> class constructor to the following: `ResourceManager rm = new ResourceManager("Greetings", typeof(Example).Assembly);`</span></span>

    [!code-csharp[Conceptual.Resources.Locating#1](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.locating/cs/program.cs#1)]
    [!code-vb[Conceptual.Resources.Locating#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.locating/vb/module1.vb#1)]

    <span data-ttu-id="d6ba8-184">Если приложение имеет имя example и выполняется компиляция из командной строки, команда для C# компилятора будет:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-184">If the application is named Example and you are compiling from the command-line, the command for the C# compiler is:</span></span>

    ```console
    csc Example.cs -res:Greeting.resources
    ```

    <span data-ttu-id="d6ba8-185">Соответствующая команда для компилятора Visual Basic имеет вид:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-185">The corresponding Visual Basic compiler command is:</span></span>

    ```console
    vbc Example.vb -res:Greeting.resources
    ```

6. <span data-ttu-id="d6ba8-186">Создайте вложенный каталог в каталоге основного приложения для каждого локализованного языка и региональных параметров, поддерживаемых приложением.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-186">Create a subdirectory in the main application directory for each localized culture supported by the application.</span></span> <span data-ttu-id="d6ba8-187">Следует создать подкаталог *en-US*, *fr-FR*и *ru-ru* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-187">You should create an *en-US*, an *fr-FR*, and an *ru-RU* subdirectory.</span></span> <span data-ttu-id="d6ba8-188">Visual Studio автоматически создает эти вложенные каталоги в процессе компиляции.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-188">Visual Studio creates these subdirectories automatically as part of the compilation process.</span></span>

7. <span data-ttu-id="d6ba8-189">Внедрите отдельные файлы *ресурсов* , зависящие от языка и региональных параметров, в вспомогательные сборки и сохраните их в соответствующем каталоге.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-189">Embed the individual culture-specific *.resources* files into satellite assemblies and save them to the appropriate directory.</span></span> <span data-ttu-id="d6ba8-190">Для этого выполните следующую команду для каждого *Resources* -файла:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-190">The command to do this for each *.resources* file is:</span></span>

    ```console
    al -target:lib -embed:Greeting.culture.resources -culture:culture -out:culture\Example.resources.dll
    ```

     <span data-ttu-id="d6ba8-191">где *culture* — имя языка и региональных параметров, ресурсы которых содержит вспомогательная сборка.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-191">where *culture* is the name of the culture whose resources the satellite assembly contains.</span></span> <span data-ttu-id="d6ba8-192">Visual Studio автоматически обрабатывает этот процесс.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-192">Visual Studio handles this process automatically.</span></span>

<span data-ttu-id="d6ba8-193">Затем можно запустить пример.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-193">You can then run the example.</span></span> <span data-ttu-id="d6ba8-194">Он будет случайным образом выбирать один из поддерживаемых языков и региональных параметров и отображать локализованное приветствие.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-194">It will randomly make one of the supported cultures the current culture and display a localized greeting.</span></span>

<a name="SN"></a>

## <a name="installing-satellite-assemblies-in-the-global-assembly-cache"></a><span data-ttu-id="d6ba8-195">Установка вспомогательных сборок в глобальный кэш сборок</span><span class="sxs-lookup"><span data-stu-id="d6ba8-195">Installing Satellite Assemblies in the Global Assembly Cache</span></span>

<span data-ttu-id="d6ba8-196">Вместо установки сборок во вложенном каталоге локального приложения их можно установить в глобальный кэш сборок.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-196">Instead of installing assemblies in a local application subdirectory, you can install them in the global assembly cache.</span></span> <span data-ttu-id="d6ba8-197">Это особенно полезно, если библиотеки классов и сборки ресурсов библиотеки классов используются несколькими приложениями.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-197">This is particularly useful if you have class libraries and class library resource assemblies that are used by multiple applications.</span></span>
  
<span data-ttu-id="d6ba8-198">Все сборки, устанавливаемые в глобальный кэш сборок, должны иметь строгие имена.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-198">Installing assemblies in the global assembly cache requires that they have strong names.</span></span> <span data-ttu-id="d6ba8-199">Сборки со строгими именами должны быть подписаны допустимой парой открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-199">Strong-named assemblies are signed with a valid public/private key pair.</span></span> <span data-ttu-id="d6ba8-200">Они содержат сведения о версии, с помощью которых среда выполнения определяет, какую сборку следует использовать для удовлетворения запроса привязки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-200">They contain version information that the runtime uses to determine which assembly to use to satisfy a binding request.</span></span> <span data-ttu-id="d6ba8-201">Дополнительные сведения о строгих именах и управлении версиями см. в разделе [Управление версиями сборки](../../standard/assembly/versioning.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-201">For more information about strong names and versioning, see [Assembly Versioning](../../standard/assembly/versioning.md).</span></span> <span data-ttu-id="d6ba8-202">Дополнительные сведения о строгих именах см. в разделе [Сборки со строгими именами](../../standard/assembly/strong-named.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-202">For more information about strong names, see [Strong-Named Assemblies](../../standard/assembly/strong-named.md).</span></span>

<span data-ttu-id="d6ba8-203">Разработчик приложения, как правило, не имеет доступа к итоговой паре открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-203">When you are developing an application, it is unlikely that you will have access to the final public/private key pair.</span></span> <span data-ttu-id="d6ba8-204">Чтобы установить вспомогательную сборку в глобальный кэш сборок и обеспечить ее работоспособность, можно воспользоваться средством отложенной подписи.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-204">In order to install a satellite assembly in the global assembly cache and ensure that it works as expected, you can use a technique called delayed signing.</span></span> <span data-ttu-id="d6ba8-205">Если подписание сборки откладывается, во время построения в файле резервируется место для подписи строгим именем.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-205">When you delay sign an assembly, at build time you reserve space in the file for the strong name signature.</span></span> <span data-ttu-id="d6ba8-206">Фактически подписание откладывается до того момента, когда становится доступной итоговая пара открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-206">The actual signing is delayed until later, when the final public/private key pair is available.</span></span> <span data-ttu-id="d6ba8-207">Дополнительные сведения об отложенной подписи см. в разделе [Отложенная подпись сборки](../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-207">For more information about delayed signing, see [Delay Signing an Assembly](../../standard/assembly/delay-sign.md).</span></span>

### <a name="obtaining-the-public-key"></a><span data-ttu-id="d6ba8-208">Получение открытого ключа</span><span class="sxs-lookup"><span data-stu-id="d6ba8-208">Obtaining the Public Key</span></span>

<span data-ttu-id="d6ba8-209">Чтобы отложить подпись сборки, необходимо иметь доступ к открытому ключу.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-209">To delay sign an assembly, you must have access to the public key.</span></span> <span data-ttu-id="d6ba8-210">Открытый ключ можно либо получить в организации, которая будет заниматься окончательным подписанием, либо создать самостоятельно с помощью [программы строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-210">You can either obtain the real public key from the organization in your company that will do the eventual signing, or create a public key by using the [Strong Name Tool (Sn.exe)](../tools/sn-exe-strong-name-tool.md).</span></span>

<span data-ttu-id="d6ba8-211">Следующая команда *Sn. exe* создает тестовое сочетание открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-211">The following *Sn.exe* command creates a test public/private key pair.</span></span> <span data-ttu-id="d6ba8-212">Параметр **-k** указывает, что программа *Sn. exe* должна создать новую пару ключей и сохранить ее в файле с именем *TestKeyPair. snk*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-212">The **–k** option specifies that *Sn.exe* should create a new key pair and save it in a file named *TestKeyPair.snk*.</span></span>
  
```console
sn –k TestKeyPair.snk
```

<span data-ttu-id="d6ba8-213">Открытый ключ можно извлечь из файла, содержащего тестовую пару ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-213">You can extract the public key from the file that contains the test key pair.</span></span> <span data-ttu-id="d6ba8-214">Следующая команда извлекает открытый ключ из *TestKeyPair. snk* и сохраняет его в *publicKey. snk*:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-214">The following command extracts the public key from *TestKeyPair.snk* and saves it in *PublicKey.snk*:</span></span>

```console
sn –p TestKeyPair.snk PublicKey.snk
```

### <a name="delay-signing-an-assembly"></a><span data-ttu-id="d6ba8-215">Отложенная подпись сборки</span><span class="sxs-lookup"><span data-stu-id="d6ba8-215">Delay Signing an Assembly</span></span>

<span data-ttu-id="d6ba8-216">После получения или создания открытого ключа, можно скомпилировать сборку и указать отложенную подпись, используя [компоновщик сборок (Al.exe)](../tools/al-exe-assembly-linker.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-216">After you obtain or create the public key, you use the [Assembly Linker (Al.exe)](../tools/al-exe-assembly-linker.md) to compile the assembly and specify delayed signing.</span></span>

<span data-ttu-id="d6ba8-217">Следующая команда *Al. exe* создает вспомогательную сборку со строгим именем для приложения StringLibrary из файла *Strings. ja. Resources* :</span><span class="sxs-lookup"><span data-stu-id="d6ba8-217">The following *Al.exe* command creates a strong-named satellite assembly for the application StringLibrary from the *strings.ja.resources* file:</span></span>

```console
al -target:lib -embed:strings.ja.resources -culture:ja -out:StringLibrary.resources.dll -delay+ -keyfile:PublicKey.snk
```

<span data-ttu-id="d6ba8-218">Параметр **-delay+** указывает, что компоновщик сборок должен отложить подпись сборки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-218">The **-delay+** option specifies that the Assembly Linker should delay sign the assembly.</span></span> <span data-ttu-id="d6ba8-219">Параметр **-keyfile** задает имя файла ключа, в котором содержится открытый ключ, применяемый для откладывания подписи сборки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-219">The **-keyfile** option specifies the name of the key file that contains the public key to use to delay sign the assembly.</span></span>

### <a name="re-signing-an-assembly"></a><span data-ttu-id="d6ba8-220">Повторная подпись сборки</span><span class="sxs-lookup"><span data-stu-id="d6ba8-220">Re-signing an Assembly</span></span>

<span data-ttu-id="d6ba8-221">Прежде чем развертывать приложение, можно заново подписать вспомогательную сборку, подписание которой было отложено, реальной парой ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-221">Before you deploy your application, you must re-sign the delay signed satellite assembly with the real key pair.</span></span> <span data-ttu-id="d6ba8-222">Это можно сделать с помощью программы *Sn. exe*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-222">You can do this by using *Sn.exe*.</span></span>

<span data-ttu-id="d6ba8-223">Следующая команда *Sn. exe* подписывает *StringLibrary. Resources. dll* с парой ключей, хранящейся в файле *реалкэйпаир. snk*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-223">The following *Sn.exe* command signs *StringLibrary.resources.dll* with the key pair stored in the file *RealKeyPair.snk*.</span></span> <span data-ttu-id="d6ba8-224">Параметр **–R** указывает, что нужно заново подписать сборку с отложенной подписью или сборку, которая должна быть подписана заново.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-224">The **–R** option specifies that a previously signed or delay signed assembly is to be re-signed.</span></span>

```console
sn –R StringLibrary.resources.dll RealKeyPair.snk
```

### <a name="installing-a-satellite-assembly-in-the-global-assembly-cache"></a><span data-ttu-id="d6ba8-225">Установка вспомогательной сборки в глобальный кэш сборок</span><span class="sxs-lookup"><span data-stu-id="d6ba8-225">Installing a Satellite Assembly in the Global Assembly Cache</span></span>

<span data-ttu-id="d6ba8-226">Когда среда выполнения ищет ресурсы в процессе перехода на резервные средства, в первую очередь она ищет [глобальный кэш сборок](../app-domains/gac.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-226">When the runtime searches for resources in the resource fallback process, it looks in the [global assembly cache](../app-domains/gac.md) first.</span></span> <span data-ttu-id="d6ba8-227">(Дополнительные сведения см. в разделе "процесс резервирования ресурсов" статьи [Упаковка и развертывание ресурсов](packaging-and-deploying-resources-in-desktop-apps.md) .) Как только вспомогательная сборка подписывается строгим именем, ее можно установить в глобальный кэш сборок с помощью [средство глобального кэша сборок (Gacutil. exe)](../tools/gacutil-exe-gac-tool.md).</span><span class="sxs-lookup"><span data-stu-id="d6ba8-227">(For more information, see the "Resource Fallback Process" section of the [Packaging and Deploying Resources](packaging-and-deploying-resources-in-desktop-apps.md) topic.) As soon as a satellite assembly is signed with a strong name, it can be installed in the global assembly cache by using the [Global Assembly Cache Tool (Gacutil.exe)](../tools/gacutil-exe-gac-tool.md).</span></span>

<span data-ttu-id="d6ba8-228">Следующая команда *gacutil. exe* устанавливает *StringLibrary. Resources. dll*\* в глобальный кэш сборок:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-228">The following *Gacutil.exe* command installs *StringLibrary.resources.dll*\* in the global assembly cache:</span></span>

```console
gacutil -i:StringLibrary.resources.dll
```

<span data-ttu-id="d6ba8-229">Параметр **/i** указывает, что программа *gacutil. exe* должна установить указанную сборку в глобальный кэш сборок.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-229">The **/i** option specifies that *Gacutil.exe* should install the specified assembly into the global assembly cache.</span></span> <span data-ttu-id="d6ba8-230">После того, как вспомогательная сборка установлена в кэше, ресурсы, которые она содержит, становятся доступны для всех приложений, которые предназначены для использования вспомогательной сборки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-230">After the satellite assembly is installed in the cache, the resources it contains become available to all applications that are designed to use the satellite assembly.</span></span>

### <a name="resources-in-the-global-assembly-cache-an-example"></a><span data-ttu-id="d6ba8-231">Пример ресурсов в глобальном кэше сборок</span><span class="sxs-lookup"><span data-stu-id="d6ba8-231">Resources in the Global Assembly Cache: An Example</span></span>

<span data-ttu-id="d6ba8-232">В следующем примере используется метод библиотеки классов .NET Framework для извлечения и возврата локализованных приветствий из файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-232">The following example uses a method in a .NET Framework class library to extract and return a localized greeting from a resource file.</span></span> <span data-ttu-id="d6ba8-233">Библиотека и ее ресурсы зарегистрированы в глобальном кэше сборок.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-233">The library and its resources are registered in the global assembly cache.</span></span> <span data-ttu-id="d6ba8-234">Пример включает ресурсы для английского (США), французского (Франция), русского (Россия) и английского языков и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-234">The example includes resources for the English (United States), French (France), Russian (Russia), and English cultures.</span></span> <span data-ttu-id="d6ba8-235">Английский является языком по умолчанию; ресурсы для него хранятся в основной сборке.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-235">English is the default culture; its resources are stored in the main assembly.</span></span> <span data-ttu-id="d6ba8-236">Пример изначально задерживает подпись библиотеки и вспомогательных сборок открытым ключом, а затем заново подписывает их парой открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-236">The example initially delay signs the library and its satellite assemblies with a public key, then re-signs them with a public/private key pair.</span></span> <span data-ttu-id="d6ba8-237">Для создания этого примера выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-237">To create the example, do the following:</span></span>

1. <span data-ttu-id="d6ba8-238">Если вы не используете Visual Studio, используйте следующую команду [средства строгих имен (Sn. exe)](../tools/sn-exe-strong-name-tool.md) для создания пары открытого и закрытого ключей с именем *рескэй. snk*:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-238">If you are not using Visual Studio, use the following [Strong Name Tool (Sn.exe)](../tools/sn-exe-strong-name-tool.md) command to create a public/private key pair named *ResKey.snk*:</span></span>

    ```console
    sn –k ResKey.snk
    ```

    <span data-ttu-id="d6ba8-239">Если вы используете Visual Studio, воспользуйтесь вкладкой **Подпись** диалогового окна **Свойства** проекта, чтобы создать ключ.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-239">If you are using Visual Studio, use the **Signing** tab of the project **Properties** dialog box to generate the key file.</span></span>

2. <span data-ttu-id="d6ba8-240">Используйте следующую команду [средства строгих имен (Sn. exe)](../tools/sn-exe-strong-name-tool.md) , чтобы создать файл открытого ключа с именем *publicKey. snk*:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-240">Use the following [Strong Name Tool (Sn.exe)](../tools/sn-exe-strong-name-tool.md) command to create a public key file named *PublicKey.snk*:</span></span>

    ```console
    sn –p ResKey.snk PublicKey.snk
    ```

3. <span data-ttu-id="d6ba8-241">Создайте файл ресурсов с именем *Strings. resx* , который будет содержать ресурс для языка и региональных параметров по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-241">Create a resource file named *Strings.resx* to contain the resource for the default culture.</span></span> <span data-ttu-id="d6ba8-242">Сохраните одну строку с именем `Greeting` и значением "How do you do?"</span><span class="sxs-lookup"><span data-stu-id="d6ba8-242">Store a single string named `Greeting` whose value is "How do you do?"</span></span> <span data-ttu-id="d6ba8-243">в этом файле.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-243">in that file.</span></span>

4. <span data-ttu-id="d6ba8-244">Чтобы указать, что язык и региональные параметры по умолчанию для приложения — "en", необходимо добавить в файл AssemblyInfo приложения или в главный файл исходного кода, которые будут скомпилированы в основную сборку приложения, следующий атрибут <xref:System.Resources.NeutralResourcesLanguageAttribute?displayProperty=nameWithType>:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-244">To indicate that "en" is the application's default culture, add the following <xref:System.Resources.NeutralResourcesLanguageAttribute?displayProperty=nameWithType> attribute to the application's AssemblyInfo file or to the main source code file that will be compiled into the application's main assembly:</span></span>

    [!code-csharp[Conceptual.Resources.Satellites#2](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.satellites/cs/stringlibrary.cs#2)]
    [!code-vb[Conceptual.Resources.Satellites#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.satellites/vb/stringlibrary.vb#2)]

5. <span data-ttu-id="d6ba8-245">Добавьте поддержку дополнительных языков и региональных параметров (en-US, fr-FR и ru-RU) в приложение следующим образом.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-245">Add support for additional cultures (the en-US, fr-FR, and ru-RU cultures) to the application as follows:</span></span>

    - <span data-ttu-id="d6ba8-246">Чтобы обеспечить поддержку языка и региональных параметров "en-US" или "Английский (США)", создайте файл ресурсов с именем *Strings. en-US. resx* или *Strings. en-US. txt*и сохраните в нем одну строку с именем `Greeting` со значением "Привет!".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-246">To support the "en-US" or English (United States) culture, create a resource file named *Strings.en-US.resx* or *Strings.en-US.txt*, and store in it a single string named `Greeting` whose value is "Hello!".</span></span>

    - <span data-ttu-id="d6ba8-247">Для поддержки языка и региональных параметров "fr-FR" или "французский (Франция)" Создайте файл ресурсов с именем *Strings.fr-FR. resx* или *Strings.fr-FR. txt* и сохраните в нем одну строку с именем `Greeting`, значение которой — "добр сотрудник!".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-247">To support the "fr-FR" or French (France) culture, create a resource file named *Strings.fr-FR.resx* or *Strings.fr-FR.txt* and store in it a single string named `Greeting` whose value is "Bon jour!".</span></span>

    - <span data-ttu-id="d6ba8-248">Чтобы обеспечить поддержку языка и региональных параметров "ru-RU" или "Русский (Россия)", создайте файл ресурсов с именем *Strings.ru-ru. resx* или *Strings.ru-ru. txt* и сохраните в нем одну строку с именем `Greeting`, значением которой является "языка!".</span><span class="sxs-lookup"><span data-stu-id="d6ba8-248">To support the "ru-RU" or Russian (Russia) culture, create a resource file named *Strings.ru-RU.resx* or *Strings.ru-RU.txt* and store in it a single string named `Greeting` whose value is "Привет!".</span></span>

6. <span data-ttu-id="d6ba8-249">Используйте [Resgen.exe](../tools/resgen-exe-resource-file-generator.md) для компиляции каждого текстового файла или файла ресурсов XML в двоичный RESOURCES-файл.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-249">Use [Resgen.exe](../tools/resgen-exe-resource-file-generator.md) to compile each text or XML resource file to a binary .resources file.</span></span> <span data-ttu-id="d6ba8-250">Выходные данные представляют собой набор файлов с тем же корневым именем файла, что и файлы *RESX* или *txt* , но с расширением *Resources* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-250">The output is a set of files that have the same root file name as the *.resx* or *.txt* files, but a *.resources* extension.</span></span> <span data-ttu-id="d6ba8-251">При создании примера с помощью Visual Studio процесс компиляции отрегулируется автоматически.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-251">If you create the example with Visual Studio, the compilation process is handled automatically.</span></span> <span data-ttu-id="d6ba8-252">Если вы не используете Visual Studio, выполните следующую команду, чтобы скомпилировать *RESX* файлы в *Resources* Files:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-252">If you aren't using Visual Studio, run the following command to compile the *.resx* files into *.resources* files:</span></span>

    ```console
    resgen filename
    ```

    <span data-ttu-id="d6ba8-253">Где *filename* — это необязательный путь, имя файла и расширение *RESX* -или текстового файла.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-253">Where *filename* is the optional path, file name, and extension of the *.resx* or text file.</span></span>

7. <span data-ttu-id="d6ba8-254">Скомпилируйте следующий исходный код для *StringLibrary. vb* или *StringLibrary.CS* вместе с ресурсами для языка и региональных параметров по умолчанию в сборку отложенной подписанной библиотеки с именем *StringLibrary. dll*:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-254">Compile the following source code for *StringLibrary.vb* or *StringLibrary.cs* along with the resources for the default culture into a delay signed library assembly named *StringLibrary.dll*:</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="d6ba8-255">При использовании командной строки, а не Visual Studio, для создания примера следует изменить вызов конструктора класса <xref:System.Resources.ResourceManager> на следующий: `ResourceManager rm = new ResourceManager("Strings",` `typeof(Example).Assembly);`.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-255">If you are using the command line rather than Visual Studio to create the example, you should modify the call to the <xref:System.Resources.ResourceManager> class constructor to `ResourceManager rm = new ResourceManager("Strings",` `typeof(Example).Assembly);`.</span></span>

    [!code-csharp[Conceptual.Resources.Satellites#1](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.satellites/cs/stringlibrary.cs#1)]
    [!code-vb[Conceptual.Resources.Satellites#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.satellites/vb/stringlibrary.vb#1)]

    <span data-ttu-id="d6ba8-256">Команда для компилятора C# имеет вид:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-256">The command for the C# compiler is:</span></span>

    ```console
    csc -t:library -resource:Strings.resources -delaysign+ -keyfile:publickey.snk StringLibrary.cs
    ```

    <span data-ttu-id="d6ba8-257">Соответствующая команда для компилятора Visual Basic имеет вид:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-257">The corresponding Visual Basic compiler command is:</span></span>

    ```console
    vbc -t:library -resource:Strings.resources -delaysign+ -keyfile:publickey.snk StringLibrary.vb
    ```

8. <span data-ttu-id="d6ba8-258">Создайте вложенный каталог в каталоге основного приложения для каждого локализованного языка и региональных параметров, поддерживаемых приложением.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-258">Create a subdirectory in the main application directory for each localized culture supported by the application.</span></span> <span data-ttu-id="d6ba8-259">Следует создать подкаталог *en-US*, *fr-FR*и *ru-ru* .</span><span class="sxs-lookup"><span data-stu-id="d6ba8-259">You should create an *en-US*, an *fr-FR*, and an *ru-RU* subdirectory.</span></span> <span data-ttu-id="d6ba8-260">Visual Studio автоматически создает эти вложенные каталоги в процессе компиляции.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-260">Visual Studio creates these subdirectories automatically as part of the compilation process.</span></span> <span data-ttu-id="d6ba8-261">Так как все вспомогательные сборки имеют одно и то же имя файла, вложенные каталоги используются для хранения отдельных вспомогательных сборок для языка и региональных параметров до тех пор, пока они не подписаны парой открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-261">Because all satellite assemblies have the same file name, the subdirectories are used to store individual culture-specific satellite assemblies until they are signed with a public/private key pair.</span></span>

9. <span data-ttu-id="d6ba8-262">Внедрите отдельные файлы *ресурсов* , зависящие от языка и региональных параметров, в вспомогательные сборки с отложенной подписью и сохраните их в соответствующем каталоге.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-262">Embed the individual culture-specific *.resources* files into delay signed satellite assemblies and save them to the appropriate directory.</span></span> <span data-ttu-id="d6ba8-263">Для этого выполните следующую команду для каждого *Resources* -файла:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-263">The command to do this for each *.resources* file is:</span></span>

    ```console
    al -target:lib -embed:Strings.culture.resources -culture:culture -out:culture\StringLibrary.resources.dll -delay+ -keyfile:publickey.snk
    ```

    <span data-ttu-id="d6ba8-264">где *culture* — название языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-264">where *culture* is the name of a culture.</span></span> <span data-ttu-id="d6ba8-265">В этом примере имена региональных настроек: en-US, fr-FR, и ru-RU.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-265">In this example, the culture names are en-US, fr-FR, and ru-RU.</span></span>

10. <span data-ttu-id="d6ba8-266">Повторно подпишите *StringLibrary. dll* с помощью [средства строгих имен (Sn. exe)](../tools/sn-exe-strong-name-tool.md) следующим образом:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-266">Re-sign *StringLibrary.dll* by using the [Strong Name Tool (Sn.exe)](../tools/sn-exe-strong-name-tool.md) as follows:</span></span>

    ```console
    sn –R StringLibrary.dll RealKeyPair.snk
    ```

11. <span data-ttu-id="d6ba8-267">Подпишите заново отдельные вспомогательные сборки.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-267">Re-sign the individual satellite assemblies.</span></span> <span data-ttu-id="d6ba8-268">Для этого используйте [средство строгих имен (Sn.exe)](../tools/sn-exe-strong-name-tool.md) для каждой вспомогательной сборки, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-268">To do this, use the [Strong Name Tool (Sn.exe)](../tools/sn-exe-strong-name-tool.md) as follows for each satellite assembly:</span></span>

    ```console
    sn –R StringLibrary.resources.dll RealKeyPair.snk
    ```

12. <span data-ttu-id="d6ba8-269">Зарегистрируйте *StringLibrary. dll* и все вспомогательные сборки в глобальном кэше сборок с помощью следующей команды:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-269">Register *StringLibrary.dll* and each of its satellite assemblies in the global assembly cache by using the following command:</span></span>

    ```console
    gacutil -i filename
    ```

    <span data-ttu-id="d6ba8-270">где *filename* — имя регистрируемого файла.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-270">where *filename* is the name of the file to register.</span></span>

13. <span data-ttu-id="d6ba8-271">Если вы используете Visual Studio, создайте новый проект **консольного приложения** с именем `Example`, добавьте ссылку на *StringLibrary. dll* и следующий исходный код в него и скомпилируйте.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-271">If you are using Visual Studio, create a new **Console Application** project named `Example`, add a reference to *StringLibrary.dll* and the following source code to it, and compile.</span></span>

    [!code-csharp[Conceptual.Resources.Satellites#3](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.satellites/cs/example.cs#3)]
    [!code-vb[Conceptual.Resources.Satellites#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.satellites/vb/example.vb#3)]

    <span data-ttu-id="d6ba8-272">Чтобы скомпилировать из командной строки используйте следующую команду для компилятора C#:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-272">To compile from the command line, use the following command for the C# compiler:</span></span>

    ```console
    csc Example.cs -r:StringLibrary.dll
    ```

    <span data-ttu-id="d6ba8-273">Команда компилятора для Visual Basic:</span><span class="sxs-lookup"><span data-stu-id="d6ba8-273">The command line for the Visual Basic compiler is:</span></span>

    ```console
    vbc Example.vb -r:StringLibrary.dll
    ```

14. <span data-ttu-id="d6ba8-274">Запустите *example. exe*.</span><span class="sxs-lookup"><span data-stu-id="d6ba8-274">Run *Example.exe*.</span></span>

## <a name="see-also"></a><span data-ttu-id="d6ba8-275">См. также</span><span class="sxs-lookup"><span data-stu-id="d6ba8-275">See also</span></span>

- [<span data-ttu-id="d6ba8-276">Упаковка и развертывание ресурсов</span><span class="sxs-lookup"><span data-stu-id="d6ba8-276">Packaging and Deploying Resources</span></span>](packaging-and-deploying-resources-in-desktop-apps.md)
- [<span data-ttu-id="d6ba8-277">Отложенная подпись сборки</span><span class="sxs-lookup"><span data-stu-id="d6ba8-277">Delay Signing an Assembly</span></span>](../../standard/assembly/delay-sign.md)
- [<span data-ttu-id="d6ba8-278">Al.exe (компоновщик сборок)</span><span class="sxs-lookup"><span data-stu-id="d6ba8-278">Al.exe (Assembly Linker)</span></span>](../tools/al-exe-assembly-linker.md)
- [<span data-ttu-id="d6ba8-279">Sn.exe (средство строгих имен)</span><span class="sxs-lookup"><span data-stu-id="d6ba8-279">Sn.exe (Strong Name Tool)</span></span>](../tools/sn-exe-strong-name-tool.md)
- [<span data-ttu-id="d6ba8-280">Gacutil.exe (программа глобального кэша сборок)</span><span class="sxs-lookup"><span data-stu-id="d6ba8-280">Gacutil.exe (Global Assembly Cache Tool)</span></span>](../tools/gacutil-exe-gac-tool.md)
- [<span data-ttu-id="d6ba8-281">Ресурсы в приложениях для настольных систем</span><span class="sxs-lookup"><span data-stu-id="d6ba8-281">Resources in Desktop Apps</span></span>](index.md)
