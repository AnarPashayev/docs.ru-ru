---
title: Основные понятия рабочих процессов Windows
description: В этой статье описываются некоторые понятия разработки рабочих процессов в .NET Framework 4.6.1, которые могут быть незнакомы некоторым разработчикам.
ms.date: 03/30/2017
ms.assetid: 0e930e80-5060-45d2-8a7a-95c0690105d4
ms.openlocfilehash: a7683791c7aed54beed9256ab08010dfeebe9936
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "96265301"
---
# <a name="fundamental-windows-workflow-concepts"></a><span data-ttu-id="0a73d-103">Основные понятия рабочих процессов Windows</span><span class="sxs-lookup"><span data-stu-id="0a73d-103">Fundamental Windows Workflow Concepts</span></span>

<span data-ttu-id="0a73d-104">При разработке рабочих процессов в [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] используются концепции, которые могут быть незнакомы некоторым разработчикам.</span><span class="sxs-lookup"><span data-stu-id="0a73d-104">Workflow development in the [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] uses concepts that may be new to some developers.</span></span> <span data-ttu-id="0a73d-105">В этом разделе описаны некоторые концепции, а также их реализация.</span><span class="sxs-lookup"><span data-stu-id="0a73d-105">This topic describes some of the concepts and how they are implemented.</span></span>  
  
## <a name="workflows-and-activities"></a><span data-ttu-id="0a73d-106">Рабочие процессы и действия</span><span class="sxs-lookup"><span data-stu-id="0a73d-106">Workflows and Activities</span></span>  

 <span data-ttu-id="0a73d-107">Рабочий процесс ― это структурированная коллекция действий, которая моделирует процесс.</span><span class="sxs-lookup"><span data-stu-id="0a73d-107">A workflow is a structured collection of actions that models a process.</span></span> <span data-ttu-id="0a73d-108">Каждое действие в рабочем процессе моделируется как отдельное действие.</span><span class="sxs-lookup"><span data-stu-id="0a73d-108">Each action in the workflow is modeled as an activity.</span></span> <span data-ttu-id="0a73d-109">Узел взаимодействует с рабочим процессом, используя <xref:System.Activities.WorkflowInvoker> для вызова рабочего процесса, как если бы он был методом, <xref:System.Activities.WorkflowApplication> для явного управления выполнением отдельного экземпляра рабочего процесса и <xref:System.ServiceModel.WorkflowServiceHost> для взаимодействия на основе сообщений в сценариях с несколькими экземплярами.</span><span class="sxs-lookup"><span data-stu-id="0a73d-109">A host interacts with a workflow by using <xref:System.Activities.WorkflowInvoker> for invoking a workflow as if it were a method,  <xref:System.Activities.WorkflowApplication> for explicit control over the execution of a single workflow instance, and <xref:System.ServiceModel.WorkflowServiceHost> for message-based interactions in multi-instance scenarios.</span></span> <span data-ttu-id="0a73d-110">Поскольку шаги рабочего процесса определены в виде иерархии действий, можно сказать, что действие, занимающее верхнюю позицию в иерархии, определяет сам рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="0a73d-110">Because steps of the workflow are defined as a hierarchy of activities, the topmost activity in the hierarchy can be said to define the workflow itself.</span></span> <span data-ttu-id="0a73d-111">Эта модель иерархии занимает место явных классов `SequentialWorkflow` и `StateMachineWorkflow` из предыдущих версий.</span><span class="sxs-lookup"><span data-stu-id="0a73d-111">This hierarchy model takes the place of the explicit `SequentialWorkflow` and `StateMachineWorkflow` classes from previous versions.</span></span> <span data-ttu-id="0a73d-112">Сами действия разрабатываются в виде коллекций других действий (с использованием в качестве основы класса <xref:System.Activities.Activity>, который обычно определяется на языке XAML) или пользовательских действий, созданных с помощью класса <xref:System.Activities.CodeActivity>, которые могут использовать среду выполнения для доступа к данным, либо с использованием класса <xref:System.Activities.NativeActivity>, который открывает автору действий среду выполнения рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0a73d-112">Activities themselves are developed as collections of other activities (using the <xref:System.Activities.Activity> class as a base, usually defined by using XAML) or are custom created by using the <xref:System.Activities.CodeActivity> class, which can use the runtime for data access, or by using the <xref:System.Activities.NativeActivity> class, which exposes the breadth of the workflow runtime to the activity author.</span></span> <span data-ttu-id="0a73d-113">Действия, разработанные при помощи <xref:System.Activities.CodeActivity> и <xref:System.Activities.NativeActivity>, создаются с использованием классов, совместимых со средой CLR, например C#.</span><span class="sxs-lookup"><span data-stu-id="0a73d-113">Activities developed by using <xref:System.Activities.CodeActivity> and <xref:System.Activities.NativeActivity> are created by using CLR-compliant languages such as C#.</span></span>  
  
## <a name="activity-data-model"></a><span data-ttu-id="0a73d-114">Модель данных действия</span><span class="sxs-lookup"><span data-stu-id="0a73d-114">Activity Data Model</span></span>  

 <span data-ttu-id="0a73d-115">Действия сохраняют данные и обмениваются ими с использованием типов, приведенных в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="0a73d-115">Activities store and share data by using the types shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="0a73d-116">Переменная</span><span class="sxs-lookup"><span data-stu-id="0a73d-116">Variable</span></span>|<span data-ttu-id="0a73d-117">Сохраняет данные в действии.</span><span class="sxs-lookup"><span data-stu-id="0a73d-117">Stores data in an activity.</span></span>|  
|<span data-ttu-id="0a73d-118">Аргумент</span><span class="sxs-lookup"><span data-stu-id="0a73d-118">Argument</span></span>|<span data-ttu-id="0a73d-119">Помещает данные в действие и выводит их из него.</span><span class="sxs-lookup"><span data-stu-id="0a73d-119">Moves data into and out of an activity.</span></span>|  
|<span data-ttu-id="0a73d-120">Expression</span><span class="sxs-lookup"><span data-stu-id="0a73d-120">Expression</span></span>|<span data-ttu-id="0a73d-121">Действие с повышенным возвращаемым значением, которое используется в привязках аргументов.</span><span class="sxs-lookup"><span data-stu-id="0a73d-121">An activity with an elevated return value used in argument bindings.</span></span>|  
  
## <a name="workflow-runtime"></a><span data-ttu-id="0a73d-122">Среда выполнения рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="0a73d-122">Workflow Runtime</span></span>  

 <span data-ttu-id="0a73d-123">Среда выполнения рабочих процессов - это среда, в которой выполняются рабочие процессы.</span><span class="sxs-lookup"><span data-stu-id="0a73d-123">The workflow runtime is the environment in which workflows execute.</span></span> <span data-ttu-id="0a73d-124"><xref:System.Activities.WorkflowInvoker> - это самый простой способ выполнения рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0a73d-124"><xref:System.Activities.WorkflowInvoker> is the simplest way to execute a workflow.</span></span> <span data-ttu-id="0a73d-125">Узел использует средство вызова <xref:System.Activities.WorkflowInvoker> для выполнения следующего:</span><span class="sxs-lookup"><span data-stu-id="0a73d-125">The host uses <xref:System.Activities.WorkflowInvoker> for the following:</span></span>  
  
- <span data-ttu-id="0a73d-126">Синхронный вызов рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0a73d-126">To synchronously invoke a workflow.</span></span>  
  
- <span data-ttu-id="0a73d-127">Поставка входных данных для рабочего процесса или извлечение выходных данных из него.</span><span class="sxs-lookup"><span data-stu-id="0a73d-127">To provide input to, or retrieve output from a workflow.</span></span>  
  
- <span data-ttu-id="0a73d-128">Добавление модулей, используемых действиями.</span><span class="sxs-lookup"><span data-stu-id="0a73d-128">To add extensions to be used by activities.</span></span>  
  
 <span data-ttu-id="0a73d-129"><xref:System.Activities.ActivityInstance> представляет собой потокобезопасный прокси-сервер, с помощью которого узлы могут взаимодействовать со средой выполнения.</span><span class="sxs-lookup"><span data-stu-id="0a73d-129"><xref:System.Activities.ActivityInstance> is the thread-safe proxy that hosts can use to interact with the runtime.</span></span> <span data-ttu-id="0a73d-130">Узел использует средство вызова <xref:System.Activities.ActivityInstance> для выполнения следующего:</span><span class="sxs-lookup"><span data-stu-id="0a73d-130">The host uses <xref:System.Activities.ActivityInstance> for the following:</span></span>  
  
- <span data-ttu-id="0a73d-131">Получение экземпляра путем его создания или загрузки из хранилища экземпляров.</span><span class="sxs-lookup"><span data-stu-id="0a73d-131">To acquire an instance by creating it or loading it from an instance store.</span></span>  
  
- <span data-ttu-id="0a73d-132">Получение уведомлений о событиях жизненного цикла экземпляра.</span><span class="sxs-lookup"><span data-stu-id="0a73d-132">To be notified of instance life-cycle events.</span></span>  
  
- <span data-ttu-id="0a73d-133">Управление выполнением рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0a73d-133">To control workflow execution.</span></span>  
  
- <span data-ttu-id="0a73d-134">Поставка входных данных для рабочего процесса или извлечение выходных данных из него.</span><span class="sxs-lookup"><span data-stu-id="0a73d-134">To provide input to, or retrieve output from a workflow.</span></span>  
  
- <span data-ttu-id="0a73d-135">Сигнализация продолжения рабочего процесса и передача значений в рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="0a73d-135">To signal a workflow continuation and pass values into the workflow.</span></span>  
  
- <span data-ttu-id="0a73d-136">Сохранение данных рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0a73d-136">To persist workflow data.</span></span>  
  
- <span data-ttu-id="0a73d-137">Добавление модулей, используемых действиями.</span><span class="sxs-lookup"><span data-stu-id="0a73d-137">To add extensions to be used by activities.</span></span>  
  
 <span data-ttu-id="0a73d-138">Действия получают доступ к среде выполнения рабочих процессов с помощью соответствующего производного класса <xref:System.Activities.ActivityContext>, например <xref:System.Activities.NativeActivityContext> или <xref:System.Activities.CodeActivityContext>.</span><span class="sxs-lookup"><span data-stu-id="0a73d-138">Activities gain access to the workflow runtime environment by using the appropriate <xref:System.Activities.ActivityContext> derived class, such as <xref:System.Activities.NativeActivityContext> or <xref:System.Activities.CodeActivityContext>.</span></span> <span data-ttu-id="0a73d-139">Они используют этот класс для разрешения аргументов и переменных, планирования дочерних действий и многих других операций.</span><span class="sxs-lookup"><span data-stu-id="0a73d-139">They use this for resolving arguments and variables, for scheduling child activities, and for many other purposes.</span></span>  
  
## <a name="services"></a><span data-ttu-id="0a73d-140">Службы</span><span class="sxs-lookup"><span data-stu-id="0a73d-140">Services</span></span>  

 <span data-ttu-id="0a73d-141">Рабочие процессы обеспечивают естественный способ реализации слабосвязанных служб и доступа к ним с помощью действий обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="0a73d-141">Workflows provide a natural way to implement and access loosely-coupled services, using messaging activities.</span></span> <span data-ttu-id="0a73d-142">Действия обмена сообщениями основаны на WCF и являются основным механизмом, используемым для извлечения данных в рабочий процесс и из него.</span><span class="sxs-lookup"><span data-stu-id="0a73d-142">Messaging activities are built on WCF and are the primary mechanism used to get data into and out of a workflow.</span></span> <span data-ttu-id="0a73d-143">Вы можете компоновать действия обмена сообщениями для моделирования шаблона обмена сообщениями любого нужного вам типа.</span><span class="sxs-lookup"><span data-stu-id="0a73d-143">You can compose messaging activities together to model any kind of message exchange pattern you wish.</span></span> <span data-ttu-id="0a73d-144">Дополнительные сведения см. в разделе [действия обмена сообщениями](../wcf/feature-details/messaging-activities.md).</span><span class="sxs-lookup"><span data-stu-id="0a73d-144">For more information, see [Messaging Activities](../wcf/feature-details/messaging-activities.md).</span></span> <span data-ttu-id="0a73d-145">Службы Workflow Services размещаются с помощью класса <xref:System.ServiceModel.Activities.WorkflowServiceHost>.</span><span class="sxs-lookup"><span data-stu-id="0a73d-145">Workflow services are hosted using the <xref:System.ServiceModel.Activities.WorkflowServiceHost> class.</span></span> <span data-ttu-id="0a73d-146">Дополнительные сведения см. в разделе [Общие сведения о размещении служб рабочих процессов](../wcf/feature-details/hosting-workflow-services-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0a73d-146">For more information, see [Hosting Workflow Services Overview](../wcf/feature-details/hosting-workflow-services-overview.md).</span></span> <span data-ttu-id="0a73d-147">Дополнительные сведения о службах рабочих процессов см. в разделе [службы рабочих](../wcf/feature-details/workflow-services.md) процессов.</span><span class="sxs-lookup"><span data-stu-id="0a73d-147">For more information about workflow services see [Workflow Services](../wcf/feature-details/workflow-services.md)</span></span>  
  
## <a name="persistence-unloading-and-long-running-workflows"></a><span data-ttu-id="0a73d-148">Сохранение, выгрузка и длительные рабочие процессы</span><span class="sxs-lookup"><span data-stu-id="0a73d-148">Persistence, Unloading, and Long-Running Workflows</span></span>  

 <span data-ttu-id="0a73d-149">Windows Workflow упрощает создание длительных реактивных программ путем обеспечения следующего.</span><span class="sxs-lookup"><span data-stu-id="0a73d-149">Windows Workflow simplifies the authoring of long-running reactive programs by providing:</span></span>  
  
- <span data-ttu-id="0a73d-150">Действия, получающие доступ к внешним входным данным.</span><span class="sxs-lookup"><span data-stu-id="0a73d-150">Activities that access external input.</span></span>  
  
- <span data-ttu-id="0a73d-151">Возможность создания объектов <xref:System.Activities.Bookmark>, которые могут быть возобновлены прослушивателем узла.</span><span class="sxs-lookup"><span data-stu-id="0a73d-151">The ability to create <xref:System.Activities.Bookmark> objects that can be resumed by a host listener.</span></span>  
  
- <span data-ttu-id="0a73d-152">Возможность сохранения данных рабочего процесса, выгрузки рабочего процесса и последующих повторной загрузки и активации рабочего процесса в ответ на возобновление объектов <xref:System.Activities.Bookmark> в определенном рабочем процессе.</span><span class="sxs-lookup"><span data-stu-id="0a73d-152">The ability to persist a workflow’s data and unload the workflow, and then reload and reactivate the workflow in response to the resumption of <xref:System.Activities.Bookmark> objects in a particular workflow.</span></span>  
  
 <span data-ttu-id="0a73d-153">Рабочий процесс выполняет действия постоянно до тех пор, пока не закончатся все действия либо пока все выполняемые действия не будут находиться в состоянии ожидания входных данных.</span><span class="sxs-lookup"><span data-stu-id="0a73d-153">A workflow continuously executes activities until there are no more activities to execute or until all currently executing activities are waiting for input.</span></span> <span data-ttu-id="0a73d-154">В таком состоянии рабочий процесс неактивен.</span><span class="sxs-lookup"><span data-stu-id="0a73d-154">In this latter state, the workflow is idle.</span></span> <span data-ttu-id="0a73d-155">Узел обычно выгружает ставшие неактивными рабочие процессы и загружает их повторно, чтобы продолжить выполнение, когда приходит сообщение.</span><span class="sxs-lookup"><span data-stu-id="0a73d-155">It is common for a host to unload workflows that have gone idle and to reload them to continue execution when a message arrives.</span></span> <span data-ttu-id="0a73d-156"><xref:System.ServiceModel.Activities.WorkflowServiceHost> обеспечивает возможность применения этой функции и предоставляет расширяемую политику выгрузки.</span><span class="sxs-lookup"><span data-stu-id="0a73d-156"><xref:System.ServiceModel.Activities.WorkflowServiceHost> provides functionality for this feature and provides an extensible unload policy.</span></span> <span data-ttu-id="0a73d-157">Для блоков выполнения, использующих данные неустойчивого состояния или другие данные, которые не могут быть сохранены иначе, действие может указать узлу, что его не следует сохранять при помощи действия <xref:System.Activities.NoPersistHandle>.</span><span class="sxs-lookup"><span data-stu-id="0a73d-157">For blocks of execution that use volatile state data or other data that cannot be persisted, an activity can indicate to a host that it should not be persisted by using the <xref:System.Activities.NoPersistHandle>.</span></span> <span data-ttu-id="0a73d-158">Рабочий процесс также может явным образом сохранить данные в устойчивое хранилище при помощи действия <xref:System.Activities.Statements.Persist>.</span><span class="sxs-lookup"><span data-stu-id="0a73d-158">A workflow can also explicitly persist its data to a durable storage medium by using the <xref:System.Activities.Statements.Persist> activity.</span></span>
