---
title: Основные понятия рабочих процессов Windows
description: В этой статье описываются некоторые понятия разработки рабочих процессов в .NET Framework 4.6.1, которые могут быть незнакомы некоторым разработчикам.
ms.date: 03/30/2017
ms.assetid: 0e930e80-5060-45d2-8a7a-95c0690105d4
ms.openlocfilehash: 07498241280191fb62a35a559a3391f7148c05b9
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2020
ms.locfileid: "83419894"
---
# <a name="fundamental-windows-workflow-concepts"></a>Основные понятия рабочих процессов Windows
При разработке рабочих процессов в [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] используются концепции, которые могут быть незнакомы некоторым разработчикам. В этом разделе описаны некоторые концепции, а также их реализация.  
  
## <a name="workflows-and-activities"></a>Рабочие процессы и действия  
 Рабочий процесс ― это структурированная коллекция действий, которая моделирует процесс. Каждое действие в рабочем процессе моделируется как отдельное действие. Узел взаимодействует с рабочим процессом, используя <xref:System.Activities.WorkflowInvoker> для вызова рабочего процесса, как если бы он был методом, <xref:System.Activities.WorkflowApplication> для явного управления выполнением отдельного экземпляра рабочего процесса и <xref:System.ServiceModel.WorkflowServiceHost> для взаимодействия на основе сообщений в сценариях с несколькими экземплярами. Поскольку шаги рабочего процесса определены в виде иерархии действий, можно сказать, что действие, занимающее верхнюю позицию в иерархии, определяет сам рабочий процесс. Эта модель иерархии занимает место явных классов `SequentialWorkflow` и `StateMachineWorkflow` из предыдущих версий. Сами действия разрабатываются в виде коллекций других действий (с использованием в качестве основы класса <xref:System.Activities.Activity>, который обычно определяется на языке XAML) или пользовательских действий, созданных с помощью класса <xref:System.Activities.CodeActivity>, которые могут использовать среду выполнения для доступа к данным, либо с использованием класса <xref:System.Activities.NativeActivity>, который открывает автору действий среду выполнения рабочего процесса. Действия, разработанные при помощи <xref:System.Activities.CodeActivity> и <xref:System.Activities.NativeActivity>, создаются с использованием классов, совместимых со средой CLR, например C#.  
  
## <a name="activity-data-model"></a>Модель данных действия  
 Действия сохраняют данные и обмениваются ими с использованием типов, приведенных в следующей таблице.  
  
|||  
|-|-|  
|Переменная|Сохраняет данные в действии.|  
|Аргумент|Помещает данные в действие и выводит их из него.|  
|Выражение|Действие с повышенным возвращаемым значением, которое используется в привязках аргументов.|  
  
## <a name="workflow-runtime"></a>Среда выполнения рабочих процессов  
 Среда выполнения рабочих процессов - это среда, в которой выполняются рабочие процессы. <xref:System.Activities.WorkflowInvoker> - это самый простой способ выполнения рабочего процесса. Узел использует средство вызова <xref:System.Activities.WorkflowInvoker> для выполнения следующего:  
  
- Синхронный вызов рабочего процесса.  
  
- Поставка входных данных для рабочего процесса или извлечение выходных данных из него.  
  
- Добавление модулей, используемых действиями.  
  
 <xref:System.Activities.ActivityInstance> представляет собой потокобезопасный прокси-сервер, с помощью которого узлы могут взаимодействовать со средой выполнения. Узел использует средство вызова <xref:System.Activities.ActivityInstance> для выполнения следующего:  
  
- Получение экземпляра путем его создания или загрузки из хранилища экземпляров.  
  
- Получение уведомлений о событиях жизненного цикла экземпляра.  
  
- Управление выполнением рабочего процесса.  
  
- Поставка входных данных для рабочего процесса или извлечение выходных данных из него.  
  
- Сигнализация продолжения рабочего процесса и передача значений в рабочий процесс.  
  
- Сохранение данных рабочего процесса.  
  
- Добавление модулей, используемых действиями.  
  
 Действия получают доступ к среде выполнения рабочих процессов с помощью соответствующего производного класса <xref:System.Activities.ActivityContext>, например <xref:System.Activities.NativeActivityContext> или <xref:System.Activities.CodeActivityContext>. Они используют этот класс для разрешения аргументов и переменных, планирования дочерних действий и многих других операций.  
  
## <a name="services"></a>Службы  
 Рабочие процессы обеспечивают естественный способ реализации слабосвязанных служб и доступа к ним с помощью действий обмена сообщениями. Действия обмена сообщениями основаны на WCF и являются основным механизмом, используемым для извлечения данных в рабочий процесс и из него. Вы можете компоновать действия обмена сообщениями для моделирования шаблона обмена сообщениями любого нужного вам типа. Дополнительные сведения см. в разделе [действия обмена сообщениями](../wcf/feature-details/messaging-activities.md). Службы Workflow Services размещаются с помощью класса <xref:System.ServiceModel.Activities.WorkflowServiceHost>. Дополнительные сведения см. в разделе [Общие сведения о размещении служб рабочих процессов](../wcf/feature-details/hosting-workflow-services-overview.md). Дополнительные сведения о службах рабочих процессов см. в разделе [службы рабочих](../wcf/feature-details/workflow-services.md) процессов.  
  
## <a name="persistence-unloading-and-long-running-workflows"></a>Сохранение, выгрузка и длительные рабочие процессы  
 Windows Workflow упрощает создание длительных реактивных программ путем обеспечения следующего.  
  
- Действия, получающие доступ к внешним входным данным.  
  
- Возможность создания объектов <xref:System.Activities.Bookmark>, которые могут быть возобновлены прослушивателем узла.  
  
- Возможность сохранения данных рабочего процесса, выгрузки рабочего процесса и последующих повторной загрузки и активации рабочего процесса в ответ на возобновление объектов <xref:System.Activities.Bookmark> в определенном рабочем процессе.  
  
 Рабочий процесс выполняет действия постоянно до тех пор, пока не закончатся все действия либо пока все выполняемые действия не будут находиться в состоянии ожидания входных данных. В таком состоянии рабочий процесс неактивен. Узел обычно выгружает ставшие неактивными рабочие процессы и загружает их повторно, чтобы продолжить выполнение, когда приходит сообщение. <xref:System.ServiceModel.Activities.WorkflowServiceHost> обеспечивает возможность применения этой функции и предоставляет расширяемую политику выгрузки. Для блоков выполнения, использующих данные неустойчивого состояния или другие данные, которые не могут быть сохранены иначе, действие может указать узлу, что его не следует сохранять при помощи действия <xref:System.Activities.NoPersistHandle>. Рабочий процесс также может явным образом сохранить данные в устойчивое хранилище при помощи действия <xref:System.Activities.Statements.Persist>.
