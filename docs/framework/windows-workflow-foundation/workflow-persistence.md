---
title: Сохраняемость рабочего процесса
ms.date: 03/30/2017
helpviewer_keywords:
- programming [WF], persistence
ms.assetid: 39e69d1f-b771-4c16-9e18-696fa43b65b2
ms.openlocfilehash: db0e4acc76f758004948857fc0b23a9cbc62f244
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61669347"
---
# <a name="workflow-persistence"></a>Сохраняемость рабочего процесса
Сохраняемость рабочего процесса - это постоянное отслеживание состояний экземпляра рабочего процесса независимо от выполняемого процесса или данных компьютера. Делается это для обеспечения хорошо известной точки восстановления для экземпляра рабочего процесса в случае сбоя системы или сохранения памяти путем выгрузки экземпляров рабочих процессов, которые в настоящий момент не выполняют активных действий, или переноса состояния экземпляра рабочего процесса с одного узла на другой узел в ферме серверов.  
  
 Сохраняемость обеспечивает гибкость, масштабируемость и восстановление процесса в случае сбоя, а также возможность более эффективного управления памятью. Процесс сохраняемости состоит из определения точки сохраняемости, сбора данных для сохранения и, наконец, делегирование фактического хранения данных поставщику сохраняемости.  
  
 Чтобы включить сохраняемость для рабочего процесса, необходимо связать хранилище экземпляров с **WorkflowApplication** или **WorkflowServiceHost** как уже упоминалось в [как: Включение сохраняемости для рабочих процессов и служб рабочих процессов](how-to-enable-persistence-for-workflows-and-workflow-services.md). **WorkflowApplication** и **WorkflowServiceHost** позволяет включить сохранение экземпляров рабочего процесса в хранилище сохраняемости и загрузки экземпляров рабочего процесса в хранилище экземпляров, связанных с ними объем памяти, на основе данных экземпляра рабочего процесса, хранящиеся в хранилище сохраняемости.  
  
 [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] Поставляется с **SqlWorkflowInstanceStore** класс, который обеспечивает сохраняемость данных и метаданные экземпляров рабочего процесса в базу данных SQL Server 2005 или SQL Server 2008. См. в разделе [Store экземпляра рабочего процесса SQL](sql-workflow-instance-store.md) для получения дополнительных сведений.  
  
 Для сохранения и загрузки данных приложения вместе со сведениями, относящимися к экземпляру рабочего процесса, можно создать участников сохраняемости, расширяющих класс <xref:System.Activities.Persistence.PersistenceParticipant>. Участник сохраняемости принимает участие в процессе сохраняемости и сохраняет пользовательские сериализуемые данные в хранилище сохраняемости, загружает данные из хранилища экземпляров в память и выполняет любую дополнительную логику в транзакции сохраняемости. Дополнительные сведения см. в разделе [участников сохраняемости](persistence-participants.md).  
  
 Windows Server App Fabric упрощает процесс настройки сохраняемости. Дополнительные сведения см. в разделе [основные понятия сохраняемости в Windows Server App Fabric](https://go.microsoft.com/fwlink/?LinkId=201200)  
  
## <a name="implicit-persistence-points"></a>Неявные точки сохранения  
 В следующем списке содержатся примеры условий, при которых рабочий процесс сохраняется, если хранилище экземпляров связано с рабочим процессом.  
  
- Когда **TransactionScope** завершения действия или **TransactedReceiveScope** завершения действия.  
  
- Когда экземпляр рабочего процесса становится неактивным и **WorkflowIdleBehavior** устанавливается на узле рабочего процесса. Это происходит, например, при использовании действий обмена сообщениями или **задержка** действия.  
  
- Когда Workflowapplicatione переходит в состояние бездействия и **PersistableIdle** приложения свойству **PersistableIdleAction.Persist**.  
  
- Когда ведущему приложению указано сохранить или выгрузить экземпляр рабочего процесса.  
  
- При прерывании или завершении экземпляра рабочего процесса.  
  
- Когда **Persist** выполняется действие.  
  
- Когда экземпляр рабочего процесса, разработанный с помощью прежней версии Windows Workflow Foundation, встречает точку сохранения при выполнении взаимодействия.  
  
## <a name="in-this-section"></a>В этом разделе  
  
- [Хранилище экземпляров рабочих процессов SQL](sql-workflow-instance-store.md)  
  
- [Хранилища экземпляров](instance-stores.md)  
  
- [Участники сохраняемости](persistence-participants.md)  
  
- [Рекомендации по сохраняемости](persistence-best-practices.md)  
  
- [Несохраняемые экземпляры рабочих процессов](non-persisted-workflow-instances.md)  
  
- [Приостановка и возобновление рабочего процесса](pausing-and-resuming-a-workflow.md)
