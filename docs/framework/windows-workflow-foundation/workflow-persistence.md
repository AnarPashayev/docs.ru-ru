---
title: Сохраняемость рабочих процессов
ms.date: 03/30/2017
helpviewer_keywords:
- programming [WF], persistence
ms.assetid: 39e69d1f-b771-4c16-9e18-696fa43b65b2
ms.openlocfilehash: c49e287c6132103d4bb85a8ae892a76f9b582274
ms.sourcegitcommit: a4f9b754059f0210e29ae0578363a27b9ba84b64
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2019
ms.locfileid: "74837536"
---
# <a name="workflow-persistence"></a><span data-ttu-id="0fc51-102">Сохраняемость рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="0fc51-102">Workflow Persistence</span></span>
<span data-ttu-id="0fc51-103">Сохраняемость рабочего процесса - это постоянное отслеживание состояний экземпляра рабочего процесса независимо от выполняемого процесса или данных компьютера.</span><span class="sxs-lookup"><span data-stu-id="0fc51-103">Workflow persistence is the durable capture of a workflow instance's state, independent of process or computer information.</span></span> <span data-ttu-id="0fc51-104">Делается это для обеспечения хорошо известной точки восстановления для экземпляра рабочего процесса в случае сбоя системы или сохранения памяти путем выгрузки экземпляров рабочих процессов, которые в настоящий момент не выполняют активных действий, или переноса состояния экземпляра рабочего процесса с одного узла на другой узел в ферме серверов.</span><span class="sxs-lookup"><span data-stu-id="0fc51-104">This is done to provide a well-known point of recovery for the workflow instance in the event of system failure, or to preserve memory by unloading workflow instances that are not actively doing work, or to move the state of the workflow instance from one node to another node in a server farm.</span></span>  
  
 <span data-ttu-id="0fc51-105">Сохраняемость обеспечивает гибкость, масштабируемость и восстановление процесса в случае сбоя, а также возможность более эффективного управления памятью.</span><span class="sxs-lookup"><span data-stu-id="0fc51-105">Persistence enables process agility, scalability, recovery in the face of failure, and the ability to manage memory more efficiently.</span></span> <span data-ttu-id="0fc51-106">Процесс сохраняемости состоит из определения точки сохраняемости, сбора данных для сохранения и, наконец, делегирование фактического хранения данных поставщику сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="0fc51-106">The persistence process includes the identification of a persistence point, the gathering of the data to be saved, and finally the delegation of the actual storage of the data to a persistence provider.</span></span>  
  
 <span data-ttu-id="0fc51-107">Чтобы включить сохраняемость для рабочего процесса, необходимо связать хранилище экземпляров с **классом** **WorkflowApplication** или WorkflowServiceHost, как упоминалось в этой статьи. [Включение сохраняемости для рабочих процессов и служб рабочих](how-to-enable-persistence-for-workflows-and-workflow-services.md)процессов.</span><span class="sxs-lookup"><span data-stu-id="0fc51-107">To enable persistence for a workflow, you need to associate an instance store with the **WorkflowApplication** or **WorkflowServiceHost** as mentioned in [How to: Enable Persistence for Workflows and Workflow Services](how-to-enable-persistence-for-workflows-and-workflow-services.md).</span></span> <span data-ttu-id="0fc51-108">**WorkflowApplication** и **WorkflowServiceHost** используют хранилище экземпляров, связанное с ними, чтобы обеспечить сохранение экземпляров рабочих процессов в хранилище сохраняемости и загрузку экземпляров рабочих процессов в память на основе данных экземпляра рабочего процесса, хранящихся в хранилище сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="0fc51-108">The **WorkflowApplication** and **WorkflowServiceHost** use the instance store associated with them to enable persisting workflow instances into a persistence store and loading workflow instances into memory based on the workflow instance data stored in the persistence store.</span></span>  
  
 <span data-ttu-id="0fc51-109">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] поставляется с классом **SqlWorkflowInstanceStore** , который позволяет сохранять данные и метаданные об экземплярах рабочих процессов в базе данных SQL Server 2005 или SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="0fc51-109">The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with the **SqlWorkflowInstanceStore** class, which allows persistence of data and metadata about workflow instances into a SQL Server 2005 or SQL Server 2008 database.</span></span> <span data-ttu-id="0fc51-110">Дополнительные сведения см. в статье [хранилище экземпляров рабочих процессов SQL](sql-workflow-instance-store.md) .</span><span class="sxs-lookup"><span data-stu-id="0fc51-110">See [SQL Workflow Instance Store](sql-workflow-instance-store.md) for more details.</span></span>  
  
 <span data-ttu-id="0fc51-111">Для сохранения и загрузки данных приложения вместе со сведениями, относящимися к экземпляру рабочего процесса, можно создать участников сохраняемости, расширяющих класс <xref:System.Activities.Persistence.PersistenceParticipant>.</span><span class="sxs-lookup"><span data-stu-id="0fc51-111">To store and load your application-specific data along with the workflow instance-related information, you can create persistence participants that extend the <xref:System.Activities.Persistence.PersistenceParticipant> class.</span></span> <span data-ttu-id="0fc51-112">Участник сохраняемости принимает участие в процессе сохраняемости и сохраняет пользовательские сериализуемые данные в хранилище сохраняемости, загружает данные из хранилища экземпляров в память и выполняет любую дополнительную логику в транзакции сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="0fc51-112">A persistence participant participates in the persistence process to save custom serializable data into the persistence store, to load the data from the instance store into memory, and to perform any additional logic under a persistence transaction.</span></span> <span data-ttu-id="0fc51-113">Дополнительные сведения см. в разделе [сохраняемость участников](persistence-participants.md).</span><span class="sxs-lookup"><span data-stu-id="0fc51-113">For more information, see [Persistence Participants](persistence-participants.md).</span></span>  
  
 <span data-ttu-id="0fc51-114">Windows Server App Fabric упрощает процесс настройки сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="0fc51-114">Windows Server App Fabric simplifies the process of configuring persistence.</span></span> <span data-ttu-id="0fc51-115">Дополнительные сведения см. [в статье основные понятия сохраняемости в Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10)) .</span><span class="sxs-lookup"><span data-stu-id="0fc51-115">For more information, see [Persistence Concepts with Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10))</span></span>  
  
## <a name="implicit-persistence-points"></a><span data-ttu-id="0fc51-116">Неявные точки сохранения</span><span class="sxs-lookup"><span data-stu-id="0fc51-116">Implicit Persistence Points</span></span>  
 <span data-ttu-id="0fc51-117">В следующем списке содержатся примеры условий, при которых рабочий процесс сохраняется, если хранилище экземпляров связано с рабочим процессом.</span><span class="sxs-lookup"><span data-stu-id="0fc51-117">The following list contains examples of the conditions upon which a workflow is persisted when an instance store is associated with a workflow.</span></span>  
  
- <span data-ttu-id="0fc51-118">При завершении действия **TransactionScope** или завершении действия **TransactedReceiveScope** .</span><span class="sxs-lookup"><span data-stu-id="0fc51-118">When a **TransactionScope** activity completes or a **TransactedReceiveScope** activity completes.</span></span>  
  
- <span data-ttu-id="0fc51-119">Когда экземпляр рабочего процесса переходит в состояние бездействия и **воркфловидлебехавиор** задается на узле рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0fc51-119">When a workflow instance becomes idle and the **WorkflowIdleBehavior** is set on workflow host.</span></span> <span data-ttu-id="0fc51-120">Это происходит, например, при использовании действий обмена сообщениями или **задержки** .</span><span class="sxs-lookup"><span data-stu-id="0fc51-120">This occurs, for example, when you use messaging activities or a **Delay** activity.</span></span>  
  
- <span data-ttu-id="0fc51-121">Когда WorkflowApplication становится бездействующим, а свойство **персистаблеидле** приложения имеет значение **персистаблеидлеактион. PERSISTED**.</span><span class="sxs-lookup"><span data-stu-id="0fc51-121">When a WorkflowApplication becomes idle and the **PersistableIdle** property of the application is set to **PersistableIdleAction.Persist**.</span></span>  
  
- <span data-ttu-id="0fc51-122">Когда ведущему приложению указано сохранить или выгрузить экземпляр рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0fc51-122">When a host application is instructed to persist or unload a workflow instance.</span></span>  
  
- <span data-ttu-id="0fc51-123">При прерывании или завершении экземпляра рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="0fc51-123">When a workflow instance is terminated or finishes.</span></span>  
  
- <span data-ttu-id="0fc51-124">При выполнении действия **сохранения** .</span><span class="sxs-lookup"><span data-stu-id="0fc51-124">When a **Persist** activity executes.</span></span>  
  
- <span data-ttu-id="0fc51-125">Когда экземпляр рабочего процесса, разработанный с помощью прежней версии Windows Workflow Foundation, встречает точку сохранения при выполнении взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="0fc51-125">When an instance of a workflow developed using a previous version of Windows Workflow Foundation encounters a persistence point during interoperable execution.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="0fc51-126">Содержание</span><span class="sxs-lookup"><span data-stu-id="0fc51-126">In This Section</span></span>  
  
- [<span data-ttu-id="0fc51-127">Хранилище экземпляров рабочих процессов SQL</span><span class="sxs-lookup"><span data-stu-id="0fc51-127">SQL Workflow Instance Store</span></span>](sql-workflow-instance-store.md)  
  
- [<span data-ttu-id="0fc51-128">Хранилища экземпляров</span><span class="sxs-lookup"><span data-stu-id="0fc51-128">Instance Stores</span></span>](instance-stores.md)  
  
- [<span data-ttu-id="0fc51-129">Участники сохраняемости</span><span class="sxs-lookup"><span data-stu-id="0fc51-129">Persistence Participants</span></span>](persistence-participants.md)  
  
- [<span data-ttu-id="0fc51-130">Рекомендации по сохраняемости</span><span class="sxs-lookup"><span data-stu-id="0fc51-130">Persistence Best Practices</span></span>](persistence-best-practices.md)  
  
- [<span data-ttu-id="0fc51-131">Несохраняемые экземпляры рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="0fc51-131">Non-Persisted Workflow Instances</span></span>](non-persisted-workflow-instances.md)  
  
- [<span data-ttu-id="0fc51-132">Приостановка и возобновление рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="0fc51-132">Pausing and Resuming a Workflow</span></span>](pausing-and-resuming-a-workflow.md)
