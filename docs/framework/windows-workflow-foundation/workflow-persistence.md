---
title: Сохраняемость рабочих процессов
ms.date: 03/30/2017
helpviewer_keywords:
- programming [WF], persistence
ms.assetid: 39e69d1f-b771-4c16-9e18-696fa43b65b2
ms.openlocfilehash: c49e287c6132103d4bb85a8ae892a76f9b582274
ms.sourcegitcommit: a4f9b754059f0210e29ae0578363a27b9ba84b64
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2019
ms.locfileid: "74837536"
---
# <a name="workflow-persistence"></a>Сохраняемость рабочих процессов
Сохраняемость рабочего процесса - это постоянное отслеживание состояний экземпляра рабочего процесса независимо от выполняемого процесса или данных компьютера. Делается это для обеспечения хорошо известной точки восстановления для экземпляра рабочего процесса в случае сбоя системы или сохранения памяти путем выгрузки экземпляров рабочих процессов, которые в настоящий момент не выполняют активных действий, или переноса состояния экземпляра рабочего процесса с одного узла на другой узел в ферме серверов.  
  
 Сохраняемость обеспечивает гибкость, масштабируемость и восстановление процесса в случае сбоя, а также возможность более эффективного управления памятью. Процесс сохраняемости состоит из определения точки сохраняемости, сбора данных для сохранения и, наконец, делегирование фактического хранения данных поставщику сохраняемости.  
  
 Чтобы включить сохраняемость для рабочего процесса, необходимо связать хранилище экземпляров с **классом** **WorkflowApplication** или WorkflowServiceHost, как упоминалось в этой статьи. [Включение сохраняемости для рабочих процессов и служб рабочих](how-to-enable-persistence-for-workflows-and-workflow-services.md)процессов. **WorkflowApplication** и **WorkflowServiceHost** используют хранилище экземпляров, связанное с ними, чтобы обеспечить сохранение экземпляров рабочих процессов в хранилище сохраняемости и загрузку экземпляров рабочих процессов в память на основе данных экземпляра рабочего процесса, хранящихся в хранилище сохраняемости.  
  
 [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] поставляется с классом **SqlWorkflowInstanceStore** , который позволяет сохранять данные и метаданные об экземплярах рабочих процессов в базе данных SQL Server 2005 или SQL Server 2008. Дополнительные сведения см. в статье [хранилище экземпляров рабочих процессов SQL](sql-workflow-instance-store.md) .  
  
 Для сохранения и загрузки данных приложения вместе со сведениями, относящимися к экземпляру рабочего процесса, можно создать участников сохраняемости, расширяющих класс <xref:System.Activities.Persistence.PersistenceParticipant>. Участник сохраняемости принимает участие в процессе сохраняемости и сохраняет пользовательские сериализуемые данные в хранилище сохраняемости, загружает данные из хранилища экземпляров в память и выполняет любую дополнительную логику в транзакции сохраняемости. Дополнительные сведения см. в разделе [сохраняемость участников](persistence-participants.md).  
  
 Windows Server App Fabric упрощает процесс настройки сохраняемости. Дополнительные сведения см. [в статье основные понятия сохраняемости в Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10)) .  
  
## <a name="implicit-persistence-points"></a>Неявные точки сохранения  
 В следующем списке содержатся примеры условий, при которых рабочий процесс сохраняется, если хранилище экземпляров связано с рабочим процессом.  
  
- При завершении действия **TransactionScope** или завершении действия **TransactedReceiveScope** .  
  
- Когда экземпляр рабочего процесса переходит в состояние бездействия и **воркфловидлебехавиор** задается на узле рабочего процесса. Это происходит, например, при использовании действий обмена сообщениями или **задержки** .  
  
- Когда WorkflowApplication становится бездействующим, а свойство **персистаблеидле** приложения имеет значение **персистаблеидлеактион. PERSISTED**.  
  
- Когда ведущему приложению указано сохранить или выгрузить экземпляр рабочего процесса.  
  
- При прерывании или завершении экземпляра рабочего процесса.  
  
- При выполнении действия **сохранения** .  
  
- Когда экземпляр рабочего процесса, разработанный с помощью прежней версии Windows Workflow Foundation, встречает точку сохранения при выполнении взаимодействия.  
  
## <a name="in-this-section"></a>Содержание  
  
- [Хранилище экземпляров рабочих процессов SQL](sql-workflow-instance-store.md)  
  
- [Хранилища экземпляров](instance-stores.md)  
  
- [Участники сохраняемости](persistence-participants.md)  
  
- [Рекомендации по сохраняемости](persistence-best-practices.md)  
  
- [Несохраняемые экземпляры рабочих процессов](non-persisted-workflow-instances.md)  
  
- [Приостановка и возобновление рабочего процесса](pausing-and-resuming-a-workflow.md)
