---
title: Использование WorkflowInvoker и WorkflowApplication
ms.date: 03/30/2017
ms.assetid: cd0e583c-a3f9-4fa2-b247-c7b3368c48a7
ms.openlocfilehash: ffb8277d9b1b7369ada7add36cd833a64acbaa7d
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69962208"
---
# <a name="using-workflowinvoker-and-workflowapplication"></a><span data-ttu-id="70df7-102">Использование WorkflowInvoker и WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="70df7-102">Using WorkflowInvoker and WorkflowApplication</span></span>
<span data-ttu-id="70df7-103">Windows Workflow Foundation (WF) предоставляет несколько методов размещения рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="70df7-103">Windows Workflow Foundation (WF) provides several methods of hosting workflows.</span></span> <span data-ttu-id="70df7-104"><xref:System.Activities.WorkflowInvoker> предоставляет простой способ вызова рабочего процесса аналогично вызову метода и может использоваться только для рабочих процессов, не использующих сохраняемость.</span><span class="sxs-lookup"><span data-stu-id="70df7-104"><xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence.</span></span> <span data-ttu-id="70df7-105"><xref:System.Activities.WorkflowApplication> предоставляет улучшенную модель выполнения рабочих процессов, которая обеспечивает уведомления о событиях жизненного цикла, управление выполнением, возобновление закладок и сохраняемость.</span><span class="sxs-lookup"><span data-stu-id="70df7-105"><xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of lifecycle events, execution control, bookmark resumption, and persistence.</span></span> <span data-ttu-id="70df7-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> предоставляет поддержку для действий по обмену сообщениями и главным образом используется со службами Workflow Service.</span><span class="sxs-lookup"><span data-stu-id="70df7-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> provides support for messaging activities and is primarily used with workflow services.</span></span> <span data-ttu-id="70df7-107">В этом разделе вы познакомитесь с размещением рабочих процессов в <xref:System.Activities.WorkflowInvoker> и <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="70df7-107">This topic introduces you to workflow hosting with <xref:System.Activities.WorkflowInvoker> and <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="70df7-108">Дополнительные сведения о рабочих процессах размещения <xref:System.ServiceModel.Activities.WorkflowServiceHost>с помощью см. в разделе [службы рабочих процессов](../wcf/feature-details/workflow-services.md) и [размещение общих сведений о службах рабочих процессов](../wcf/feature-details/hosting-workflow-services-overview.md).</span><span class="sxs-lookup"><span data-stu-id="70df7-108">For more information about hosting workflows with <xref:System.ServiceModel.Activities.WorkflowServiceHost>, see [Workflow Services](../wcf/feature-details/workflow-services.md) and [Hosting Workflow Services Overview](../wcf/feature-details/hosting-workflow-services-overview.md).</span></span>  
  
## <a name="using-workflowinvoker"></a><span data-ttu-id="70df7-109">Использование WorkflowInvoker</span><span class="sxs-lookup"><span data-stu-id="70df7-109">Using WorkflowInvoker</span></span>  
 <span data-ttu-id="70df7-110"><xref:System.Activities.WorkflowInvoker> предоставляет модель для исполнения рабочего процесса аналогично вызову метода.</span><span class="sxs-lookup"><span data-stu-id="70df7-110"><xref:System.Activities.WorkflowInvoker> provides a model for executing a workflow as if it were a method call.</span></span> <span data-ttu-id="70df7-111">Чтобы вызвать рабочий процесс при помощи <xref:System.Activities.WorkflowInvoker>, вызовите метод <xref:System.Activities.WorkflowInvoker.Invoke%2A> и передайте определение вызываемого рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-111">To invoke a workflow using <xref:System.Activities.WorkflowInvoker>, call the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method and pass in the workflow definition of the workflow to invoke.</span></span> <span data-ttu-id="70df7-112">В данном примере действие <xref:System.Activities.Statements.WriteLine> вызывается при помощи <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="70df7-112">In this example, a <xref:System.Activities.Statements.WriteLine> activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#1)]  
  
 <span data-ttu-id="70df7-113">Если рабочий процесс вызывается при помощи <xref:System.Activities.WorkflowInvoker>, рабочий процесс исполняется в вызывающем потоке и метод <xref:System.Activities.WorkflowInvoker.Invoke%2A> блокируется до завершения рабочего процесса, включая период неактивности.</span><span class="sxs-lookup"><span data-stu-id="70df7-113">When a workflow is invoked using <xref:System.Activities.WorkflowInvoker>, the workflow executes on the calling thread and the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method blocks until the workflow is complete, including any idle time.</span></span> <span data-ttu-id="70df7-114">Чтобы задать интервал ожидания, в течение которого рабочий процесс должен завершиться, используйте одну из перегруженных версий метода <xref:System.Activities.WorkflowInvoker.Invoke%2A>, принимающую параметр <xref:System.TimeSpan>.</span><span class="sxs-lookup"><span data-stu-id="70df7-114">To configure a time-out interval in which the workflow must complete, use one of the <xref:System.Activities.WorkflowInvoker.Invoke%2A> overloads that takes a <xref:System.TimeSpan> parameter.</span></span> <span data-ttu-id="70df7-115">В данном примере рабочий процесс вызывается дважды с использованием двух разных интервалов ожидания.</span><span class="sxs-lookup"><span data-stu-id="70df7-115">In this example, a workflow is invoked twice with two different time-out intervals.</span></span> <span data-ttu-id="70df7-116">Первый рабочий процесс завершается, а второй не завершается.</span><span class="sxs-lookup"><span data-stu-id="70df7-116">The first workflow complets, but the second does not.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#50](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#50)]  
  
> [!NOTE]
> <span data-ttu-id="70df7-117">Исключение <xref:System.TimeoutException> создается только в случае, если время ожидания истекло и рабочий процесс перешел в состояние бездействия во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="70df7-117">The <xref:System.TimeoutException> is only thrown if the time-out interval elapses and the workflow becomes idle during execution.</span></span> <span data-ttu-id="70df7-118">Рабочий процесс, не завершающийся в течение отведенного времени ожидания, завершается успешно, если не переходит в состояние простоя.</span><span class="sxs-lookup"><span data-stu-id="70df7-118">A workflow that takes longer than the specified time-out interval to complete completes successfully if the workflow does not become idle.</span></span>  
  
 <span data-ttu-id="70df7-119"><xref:System.Activities.WorkflowInvoker> предоставляет также асинхронные версии метода вызова.</span><span class="sxs-lookup"><span data-stu-id="70df7-119"><xref:System.Activities.WorkflowInvoker> also provides asynchronous versions of the invoke method.</span></span> <span data-ttu-id="70df7-120">Дополнительные сведения см. в разделах <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> и <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="70df7-120">For more information, see <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> and <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span></span>  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="70df7-121">Настройка входных аргументов рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="70df7-121">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="70df7-122">Данные можно передать в рабочий процесс при помощи словаря входных параметров, ключом которого является имя аргумента, сопоставляемого с входными аргументами рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-122">Data can be passed into a workflow using a dictionary of input parameters, keyed by argument name, that map to the input arguments of the workflow.</span></span> <span data-ttu-id="70df7-123">В данном примере вызывается действие <xref:System.Activities.Statements.WriteLine>, а значение его аргумента <xref:System.Activities.Statements.WriteLine.Text%2A> указывается при помощи словаря входных параметров.</span><span class="sxs-lookup"><span data-stu-id="70df7-123">In this example, a <xref:System.Activities.Statements.WriteLine> is invoked and the value for its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#3)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="70df7-124">Получение выходных аргументов рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="70df7-124">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="70df7-125">Выходные параметры рабочего процесса можно получить при помощи словаря выходов, возвращаемого из вызова <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="70df7-125">The output parameters of a workflow can be obtained using the outputs dictionary that is returned from the call to <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span></span> <span data-ttu-id="70df7-126">В следующем примере вызывается рабочий процесс, состоящий из одного действия `Divide`, которое имеет два входных аргумента и два выходных аргумента.</span><span class="sxs-lookup"><span data-stu-id="70df7-126">The following example invokes a workflow consisting of a single `Divide` activity that has two input arguments and two output arguments.</span></span> <span data-ttu-id="70df7-127">При вызове рабочего процесса передается словарь `arguments`, содержащий значения каждого входного аргумента с указанием имени аргумента.</span><span class="sxs-lookup"><span data-stu-id="70df7-127">When the workflow is invoked, the `arguments` dictionary is passed which contains the values for each input argument, keyed by argument name.</span></span> <span data-ttu-id="70df7-128">После завершения вызова `Invoke` в словаре выходных данных `outputs` возвращается каждый выходной аргумент с указанием имени.</span><span class="sxs-lookup"><span data-stu-id="70df7-128">When the call to `Invoke` returns, each output argument is returned in the `outputs` dictionary, also keyed by argument name.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#120](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#120)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#20)]  
  
 <span data-ttu-id="70df7-129">Для рабочего процесса, производного от <xref:System.Activities.ActivityWithResult>, такого как `CodeActivity<TResult>` или `Activity<TResult>`, если имеются выходные аргументы, помимо правильно определенного выходного аргумента <xref:System.Activities.Activity%601.Result%2A>, для получения дополнительных аргументов необходимо использовать неуниверсальную перегруженную версию `Invoke`.</span><span class="sxs-lookup"><span data-stu-id="70df7-129">If the workflow derives from <xref:System.Activities.ActivityWithResult>, such as `CodeActivity<TResult>` or `Activity<TResult>`, and there are output arguments in addition to the well-defined <xref:System.Activities.Activity%601.Result%2A> output argument, a non-generic overload of `Invoke` must be used in order to retrieve the additional arguments.</span></span> <span data-ttu-id="70df7-130">Для этого определение рабочего процесса, переданное в `Invoke`, должно быть типа <xref:System.Activities.Activity>.</span><span class="sxs-lookup"><span data-stu-id="70df7-130">To do this, the workflow definition passed into `Invoke` must be of type <xref:System.Activities.Activity>.</span></span> <span data-ttu-id="70df7-131">В этом примере действие `Divide` является производным от `CodeActivity<int>`, но объявляется как <xref:System.Activities.Activity>, поэтому используется неуниверсальная перегруженная версия `Invoke`, которая возвращает словарь аргументов вместо одиночного значения.</span><span class="sxs-lookup"><span data-stu-id="70df7-131">In this example the `Divide` activity derives from `CodeActivity<int>`, but is declared as <xref:System.Activities.Activity> so that a non-generic overload of `Invoke` is used which returns a dictionary of arguments instead of a single return value.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#121](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#121)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#21)]  
  
## <a name="using-workflowapplication"></a><span data-ttu-id="70df7-132">Использование WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="70df7-132">Using WorkflowApplication</span></span>  
 <span data-ttu-id="70df7-133"><xref:System.Activities.WorkflowApplication> предоставляет широкий набор возможностей для управления экземплярами рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-133"><xref:System.Activities.WorkflowApplication> provides a rich set of features for workflow instance management.</span></span> <span data-ttu-id="70df7-134"><xref:System.Activities.WorkflowApplication> действует как потокобезопасный прокси-сервер для настоящего <xref:System.Activities.Hosting.WorkflowInstance>, инкапсулирующего среду выполнения и предоставляющего методы для создания и загрузки экземпляров рабочего процесса, приостановки и возобновления, прекращения и уведомления о событиях жизненного цикла.</span><span class="sxs-lookup"><span data-stu-id="70df7-134"><xref:System.Activities.WorkflowApplication> acts as a thread safe proxy to the actual  <xref:System.Activities.Hosting.WorkflowInstance>, which encapsulates the runtime, and provides methods for creating and loading workflow instances, pausing and resuming, terminating, and notification of lifecycle events.</span></span> <span data-ttu-id="70df7-135">Чтобы запустить рабочий процесс при помощи <xref:System.Activities.WorkflowApplication>, создайте <xref:System.Activities.WorkflowApplication>, подпишитесь на любые желаемые события жизненного цикла, начните рабочий процесс и дождитесь его завершения.</span><span class="sxs-lookup"><span data-stu-id="70df7-135">To run a workflow using <xref:System.Activities.WorkflowApplication> you create the <xref:System.Activities.WorkflowApplication>, subscribe to any desired lifecycle events, start the workflow, and then wait for it to finish.</span></span> <span data-ttu-id="70df7-136">В данном примере создается определение рабочего процесса, состоящее из действия <xref:System.Activities.Statements.WriteLine>, и <xref:System.Activities.WorkflowApplication> с помощью указанного определения рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-136">In this example, a workflow definition that consists of a <xref:System.Activities.Statements.WriteLine> activity is created and a <xref:System.Activities.WorkflowApplication> is created using the specified workflow definition.</span></span> <span data-ttu-id="70df7-137"><xref:System.Activities.WorkflowApplication.Completed%2A> обрабатывается, чтобы узел получил уведомление о завершении рабочего процесса. Рабочий процесс начался вызовом <xref:System.Activities.WorkflowApplication.Run%2A>, и узел ожидает завершения рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-137"><xref:System.Activities.WorkflowApplication.Completed%2A> is handled so the host is notified when the workflow completes, the workflow is started with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then the host waits for the workflow to complete.</span></span> <span data-ttu-id="70df7-138">После завершения рабочего процесса задается <xref:System.Threading.AutoResetEvent> и ведущее приложение может возобновить выполнение, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="70df7-138">When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application can resume execution, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#31](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#31)]  
  
### <a name="workflowapplication-lifecycle-events"></a><span data-ttu-id="70df7-139">События жизненного цикла WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="70df7-139">WorkflowApplication Lifecycle Events</span></span>  
 <span data-ttu-id="70df7-140">В дополнение к <xref:System.Activities.WorkflowApplication.Completed%2A> авторы узла могут получать уведомление, когда рабочий процесс выгружается (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), прекращается (<xref:System.Activities.WorkflowApplication.Aborted%2A>), переходит в состояние бездействия (<xref:System.Activities.WorkflowApplication.Idle%2A> и <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>) или когда происходит необработанное исключение (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span><span class="sxs-lookup"><span data-stu-id="70df7-140">In addition to <xref:System.Activities.WorkflowApplication.Completed%2A>, host authors can be notified when a workflow is unloaded (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), aborted (<xref:System.Activities.WorkflowApplication.Aborted%2A>), becomes idle (<xref:System.Activities.WorkflowApplication.Idle%2A> and <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>), or an unhandled exception occurs (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span></span> <span data-ttu-id="70df7-141">Разработчики приложения рабочего процесса могут обработать эти уведомления и предпринять надлежащие меры, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="70df7-141">Workflow application developers can handle these notifications and take appropriate action, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#32](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#32)]  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="70df7-142">Настройка входных аргументов рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="70df7-142">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="70df7-143">Данные могут передаваться в рабочий процесс в его начале при помощи словаря параметров, подобно тому, как данные передаются при помощи <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="70df7-143">Data can be passed into a workflow as it is started using a dictionary of parameters, similar to the way data is passed in when using <xref:System.Activities.WorkflowInvoker>.</span></span> <span data-ttu-id="70df7-144">Каждый элемент в словаре сопоставляется с входным аргументом указанного рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-144">Each item in the dictionary maps to an input argument of the specified workflow.</span></span> <span data-ttu-id="70df7-145">В данном примере вызывается рабочий процесс, состоящий из действия <xref:System.Activities.Statements.WriteLine>, и его аргумент <xref:System.Activities.Statements.WriteLine.Text%2A> указывается при помощи словаря входных параметров.</span><span class="sxs-lookup"><span data-stu-id="70df7-145">In this example, a workflow that consists of a <xref:System.Activities.Statements.WriteLine> activity is invoked and its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#30](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#30)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="70df7-146">Получение выходных аргументов рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="70df7-146">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="70df7-147">После завершения рабочего процесса любой из выходных аргументов можно извлечь в обработчик <xref:System.Activities.WorkflowApplication.Completed%2A>, обратившись к словарю <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="70df7-147">When a workflow completes, any output arguments can be retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler by accessing the <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> dictionary.</span></span> <span data-ttu-id="70df7-148">В следующем примере рабочий процесс размещается с помощью <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="70df7-148">The following example hosts a workflow using <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="70df7-149">Экземпляр создается с использованием определения рабочего процесса, состоящего из одного `DiceRoll` действия. <xref:System.Activities.WorkflowApplication></span><span class="sxs-lookup"><span data-stu-id="70df7-149">A <xref:System.Activities.WorkflowApplication> instance is constructed using a workflow definition consisting of a single `DiceRoll` activity.</span></span> <span data-ttu-id="70df7-150">Действие `DiceRoll` имеет два выходных аргумента, представляющих результаты броска игральных костей.</span><span class="sxs-lookup"><span data-stu-id="70df7-150">The `DiceRoll` activity has two output arguments that represent the results of the dice roll operation.</span></span> <span data-ttu-id="70df7-151">После завершения рабочего процесса выходные параметры возвращаются из обработчика <xref:System.Activities.WorkflowApplication.Completed%2A>.</span><span class="sxs-lookup"><span data-stu-id="70df7-151">When the workflow completes, the outputs are retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#130](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#130)]  
  
 [!code-csharp[CFX_WorkflowApplicationExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#21)]  
  
> [!NOTE]
> <span data-ttu-id="70df7-152"><xref:System.Activities.WorkflowApplication> и <xref:System.Activities.WorkflowInvoker> получают словарь входных аргументов и возвращают словарь аргументов `out`.</span><span class="sxs-lookup"><span data-stu-id="70df7-152"><xref:System.Activities.WorkflowApplication> and <xref:System.Activities.WorkflowInvoker> take a dictionary of input arguments and return a dictionary of `out` arguments.</span></span> <span data-ttu-id="70df7-153">Эти параметры словаря, свойства и возвращаемые значения имеют тип `IDictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="70df7-153">These dictionary parameters, properties, and return values are of type `IDictionary<string, object>`.</span></span> <span data-ttu-id="70df7-154">Фактически передаваемым экземпляром класса словаря может быть любой класс, который реализует `IDictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="70df7-154">The actual instance of the dictionary class that is passed in can be any class that implements `IDictionary<string, object>`.</span></span> <span data-ttu-id="70df7-155">В этих примерах используется `Dictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="70df7-155">In these examples, `Dictionary<string, object>` is used.</span></span> <span data-ttu-id="70df7-156">Дополнительные сведения о словарях см <xref:System.Collections.Generic.IDictionary%602> . в статьях и. <xref:System.Collections.Generic.Dictionary%602></span><span class="sxs-lookup"><span data-stu-id="70df7-156">For more information about dictionaries, see <xref:System.Collections.Generic.IDictionary%602> and <xref:System.Collections.Generic.Dictionary%602>.</span></span>  
  
### <a name="passing-data-into-a-running-workflow-using-bookmarks"></a><span data-ttu-id="70df7-157">Передача данных в запущенный рабочий процесс при помощи закладок</span><span class="sxs-lookup"><span data-stu-id="70df7-157">Passing Data into a Running Workflow Using Bookmarks</span></span>  
 <span data-ttu-id="70df7-158">Закладки - это механизм, при помощи которого действие может пассивно ждать возобновления; с их помощью можно передавать данные в запущенный экземпляр рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="70df7-158">Bookmarks are the mechanism by which an activity can passively wait to be resumed and are a mechanism for passing data into a running workflow instance.</span></span> <span data-ttu-id="70df7-159">Если действие ждет данные, оно может создать <xref:System.Activities.Bookmark> и зарегистрировать метод обратного вызова, который будет вызываться, когда возобновляется <xref:System.Activities.Bookmark>, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="70df7-159">If an activity is waiting for data, it can create a <xref:System.Activities.Bookmark> and register a callback method to be called when the <xref:System.Activities.Bookmark> is resumed, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#15](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#15)]  
  
 <span data-ttu-id="70df7-160">При выполнении действие `ReadLine` создает <xref:System.Activities.Bookmark>, регистрирует обратный вызов и ждет возобновления чтения с закладки <xref:System.Activities.Bookmark>.</span><span class="sxs-lookup"><span data-stu-id="70df7-160">When executed, the `ReadLine` activity creates a <xref:System.Activities.Bookmark>, registers a callback, and then waits for the <xref:System.Activities.Bookmark> to be resumed.</span></span> <span data-ttu-id="70df7-161">После возобновления чтения с закладки действие `ReadLine` присваивает данные, переданные с закладкой <xref:System.Activities.Bookmark>, своему аргументу <xref:System.Activities.Activity%601.Result%2A>.</span><span class="sxs-lookup"><span data-stu-id="70df7-161">When it is resumed, the `ReadLine` activity assigns the data that was passed with the <xref:System.Activities.Bookmark> to its <xref:System.Activities.Activity%601.Result%2A> argument.</span></span> <span data-ttu-id="70df7-162">В следующем примере создается рабочий процесс, использующий действие `ReadLine` для получения имени пользователя и его отображения в окне консоли.</span><span class="sxs-lookup"><span data-stu-id="70df7-162">In this example, a workflow is created that uses the `ReadLine` activity to gather the user’s name and display it to the console window.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#22](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#22)]  
  
 <span data-ttu-id="70df7-163">При выполнении действие `ReadLine` создает закладку <xref:System.Activities.Bookmark> с именем `UserName` и ждет возобновления чтения с этой закладки.</span><span class="sxs-lookup"><span data-stu-id="70df7-163">When the `ReadLine` activity is executed, it creates a <xref:System.Activities.Bookmark> named `UserName` and then waits for the bookmark to be resumed.</span></span> <span data-ttu-id="70df7-164">Узел собирает необходимые данные и возобновляет чтение с закладки <xref:System.Activities.Bookmark>.</span><span class="sxs-lookup"><span data-stu-id="70df7-164">The host collects the desired data and then resumes the <xref:System.Activities.Bookmark>.</span></span> <span data-ttu-id="70df7-165">Рабочий процесс возобновляется, отображает имя и затем завершается.</span><span class="sxs-lookup"><span data-stu-id="70df7-165">The workflow resumes, displays the name, and then completes.</span></span>  
  
 <span data-ttu-id="70df7-166">Ведущее приложение может проверять рабочий процесс на наличие активных закладок.</span><span class="sxs-lookup"><span data-stu-id="70df7-166">The host application can inspect the workflow to determine if there are any active bookmarks.</span></span> <span data-ttu-id="70df7-167">Это осуществляется вызовом метода <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> экземпляра <xref:System.Activities.WorkflowApplication> или проверкой <xref:System.Activities.WorkflowApplicationIdleEventArgs> в обработчике <xref:System.Activities.WorkflowApplication.Idle%2A>.</span><span class="sxs-lookup"><span data-stu-id="70df7-167">It can do this by calling the <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> method of a <xref:System.Activities.WorkflowApplication> instance, or by inspecting the <xref:System.Activities.WorkflowApplicationIdleEventArgs> in the <xref:System.Activities.WorkflowApplication.Idle%2A> handler.</span></span>  
  
 <span data-ttu-id="70df7-168">Следующий пример кода подобен предыдущему примеру, за исключением того, что активные закладки перечисляются до возобновления закладки.</span><span class="sxs-lookup"><span data-stu-id="70df7-168">The following code example is like the previous example except that the active bookmarks are enumerated before the bookmark is resumed.</span></span> <span data-ttu-id="70df7-169">Рабочий процесс запускается, и, когда создается <xref:System.Activities.Bookmark>, а рабочий процесс переходит в состояние бездействия, вызывается метод <xref:System.Activities.WorkflowApplication.GetBookmarks%2A>.</span><span class="sxs-lookup"><span data-stu-id="70df7-169">The workflow is started, and once the <xref:System.Activities.Bookmark> is created and the workflow goes idle, <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> is called.</span></span> <span data-ttu-id="70df7-170">После завершения рабочего процесса на консоль выводятся следующие данные.</span><span class="sxs-lookup"><span data-stu-id="70df7-170">When the workflow is completed, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="70df7-171">**Как вас зовут?**</span><span class="sxs-lookup"><span data-stu-id="70df7-171">**What is your name?**</span></span>  
<span data-ttu-id="70df7-172">**BookmarkName UserName — Овнердисплайнаме: ReadLine** </span><span class="sxs-lookup"><span data-stu-id="70df7-172">**BookmarkName: UserName - OwnerDisplayName: ReadLine** </span></span>  
<span data-ttu-id="70df7-173">**Стив** </span><span class="sxs-lookup"><span data-stu-id="70df7-173">**Steve** </span></span>  
<span data-ttu-id="70df7-174">**Привет, Виктор**</span><span class="sxs-lookup"><span data-stu-id="70df7-174">**Hello, Steve**</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#14](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#14)]  
  
 <span data-ttu-id="70df7-175">В следующем примере кода проверяются аргументы <xref:System.Activities.WorkflowApplicationIdleEventArgs>, переданные в обработчик <xref:System.Activities.WorkflowApplication.Idle%2A> экземпляра <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="70df7-175">The following code example inspects the <xref:System.Activities.WorkflowApplicationIdleEventArgs> passed into the <xref:System.Activities.WorkflowApplication.Idle%2A> handler of a <xref:System.Activities.WorkflowApplication> instance.</span></span> <span data-ttu-id="70df7-176">В этом примере рабочий процесс, переходящий в состояние бездействия, содержит одну закладку <xref:System.Activities.Bookmark> с именем `EnterGuess`, которая принадлежит действию с именем `ReadInt`.</span><span class="sxs-lookup"><span data-stu-id="70df7-176">In this example the workflow going idle has one <xref:System.Activities.Bookmark> with a name of `EnterGuess`, owned by an activity named `ReadInt`.</span></span> <span data-ttu-id="70df7-177">Этот пример кода основан на [следующем: Запустите рабочий процесс](how-to-run-a-workflow.md), который является частью учебника по [Начало работы](getting-started-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="70df7-177">This code example is based off of [How to: Run a Workflow](how-to-run-a-workflow.md), which is part of the [Getting Started Tutorial](getting-started-tutorial.md).</span></span> <span data-ttu-id="70df7-178">Если на данном этапе изменить обработчик <xref:System.Activities.WorkflowApplication.Idle%2A> и включить код из этого примера, то будут выведены следующие данные.</span><span class="sxs-lookup"><span data-stu-id="70df7-178">If the <xref:System.Activities.WorkflowApplication.Idle%2A> handler in that step is modified to contain the code from this example, the following output is displayed.</span></span>  
  
 <span data-ttu-id="70df7-179">**BookmarkName Ентергуесс — Овнердисплайнаме: ReadInt**</span><span class="sxs-lookup"><span data-stu-id="70df7-179">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span></span>
 
 [!code-csharp[CFX_WorkflowApplicationExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#2)]  
  
## <a name="summary"></a><span data-ttu-id="70df7-180">Сводка</span><span class="sxs-lookup"><span data-stu-id="70df7-180">Summary</span></span>  
 <span data-ttu-id="70df7-181"><xref:System.Activities.WorkflowInvoker> предоставляет упрощенный способ вызова рабочих процессов, и, хотя он предоставляет методы для передачи данных в начале рабочего процесса и извлечения данных из завершенного процесса, он не предусмотрен для более сложных сценариев, в которых можно использовать <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="70df7-181"><xref:System.Activities.WorkflowInvoker> provides a lightweight way to invoke workflows, and although it provides methods for passing data in at the start of a workflow and extracting data from a completed workflow, it does not provide for more complex scenarios which is where <xref:System.Activities.WorkflowApplication> can be used.</span></span>
