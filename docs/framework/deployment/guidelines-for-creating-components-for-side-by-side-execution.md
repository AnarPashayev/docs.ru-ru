---
title: Рекомендации по созданию компонентов для параллельного выполнения
description: Ознакомьтесь с рекомендациями по созданию компонентов для параллельного выполнения. Например, можно привязать удостоверение типа к определенной версии файла или использовать хранилище с поддержкой версий.
ms.date: 03/30/2017
helpviewer_keywords:
- side-by-side execution, multiple application versions
- side-by-side execution, multiple component versions
ms.assetid: 5c540161-6e40-42e9-be92-6175aee2c46a
ms.openlocfilehash: f0d25984f2444d29d9fc0edb3add23b6adc04c62
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2020
ms.locfileid: "85622644"
---
# <a name="guidelines-for-creating-components-for-side-by-side-execution"></a><span data-ttu-id="1b73b-104">Рекомендации по созданию компонентов для параллельного выполнения</span><span class="sxs-lookup"><span data-stu-id="1b73b-104">Guidelines for Creating Components for Side-by-Side Execution</span></span>
<span data-ttu-id="1b73b-105">Выполните эти общие рекомендации для создания управляемых приложений или компонентов для параллельного выполнения.</span><span class="sxs-lookup"><span data-stu-id="1b73b-105">Follow these general guidelines to create managed applications or components designed for side-by-side execution:</span></span>  
  
- <span data-ttu-id="1b73b-106">Удостоверение типа следует привязывать к определенной версии файла.</span><span class="sxs-lookup"><span data-stu-id="1b73b-106">Bind type identity to a particular version of a file.</span></span>  
  
     <span data-ttu-id="1b73b-107">Среда CLR привязывает удостоверение типа к определенной версии файла с помощью сборок со строгими именами.</span><span class="sxs-lookup"><span data-stu-id="1b73b-107">The common language runtime binds type identity to a particular file version by using strong-named assemblies.</span></span> <span data-ttu-id="1b73b-108">Чтобы создать приложение или компонент для параллельного выполнения, необходимо присвоить всем сборкам строгие имена.</span><span class="sxs-lookup"><span data-stu-id="1b73b-108">To create an application or component for side-by-side execution, you must give all assemblies a strong name.</span></span> <span data-ttu-id="1b73b-109">Это позволит создать удостоверение точного типа и гарантирует направление разрешений любого типа в нужный файл.</span><span class="sxs-lookup"><span data-stu-id="1b73b-109">This creates precise type identity and ensures that any type resolution is directed to the correct file.</span></span> <span data-ttu-id="1b73b-110">Сборка со строгим именем содержит версию, язык и региональные параметры и сведения об издателе, используемые средой выполнения для обнаружения необходимого файла для выполнения запроса привязки.</span><span class="sxs-lookup"><span data-stu-id="1b73b-110">A strong-named assembly contains version, culture, and publisher information that the runtime uses to locate the correct file to fulfill a binding request.</span></span>  
  
- <span data-ttu-id="1b73b-111">Используйте хранилище с поддержкой версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-111">Use version-aware storage.</span></span>  
  
     <span data-ttu-id="1b73b-112">Среда выполнения использует глобальный кэш сборок для обеспечения хранилища с поддержкой версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-112">The runtime uses the global assembly cache to provide version-aware storage.</span></span> <span data-ttu-id="1b73b-113">Глобальный кэш сборок — это структура каталога с поддержкой версий, устанавливаемая на каждом компьютере, где используется.NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1b73b-113">The global assembly cache is a version-aware directory structure installed on every computer that uses the .NET Framework.</span></span> <span data-ttu-id="1b73b-114">Сборки, установленные в глобальном кэше сборок, не перезаписываются при установке новой версии этой сборки.</span><span class="sxs-lookup"><span data-stu-id="1b73b-114">Assemblies installed in the global assembly cache are not overwritten when a new version of that assembly is installed.</span></span>  
  
- <span data-ttu-id="1b73b-115">Создайте приложение или компонент, работающий в изоляции.</span><span class="sxs-lookup"><span data-stu-id="1b73b-115">Create an application or component that runs in isolation.</span></span>  
  
     <span data-ttu-id="1b73b-116">Приложение или компонент, работающий в изоляции, должен осуществлять управление ресурсами, чтобы избежать конфликтов, когда два экземпляра приложения или компонента выполняются одновременно.</span><span class="sxs-lookup"><span data-stu-id="1b73b-116">An application or component that runs in isolation must manage resources to avoid conflicts when two instances of the application or component are running simultaneously.</span></span> <span data-ttu-id="1b73b-117">Приложение или компонент также должен использовать структуру файлов определенных версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-117">The application or component must also use a version-specific file structure.</span></span>  
  
## <a name="application-and-component-isolation"></a><span data-ttu-id="1b73b-118">Изоляция приложений и компонентов</span><span class="sxs-lookup"><span data-stu-id="1b73b-118">Application and Component Isolation</span></span>  
 <span data-ttu-id="1b73b-119">Одним из способов успешного создания приложения или компонента для параллельного выполнения является изоляция.</span><span class="sxs-lookup"><span data-stu-id="1b73b-119">One key to successfully designing an application or component for side-by-side execution is isolation.</span></span> <span data-ttu-id="1b73b-120">Приложение или компонент должен осуществлять управление всеми ресурсами, в частности вводом-выводом файлов, в изолированном режиме.</span><span class="sxs-lookup"><span data-stu-id="1b73b-120">The application or component must manage all resources, particularly file I/O, in an isolated manner.</span></span> <span data-ttu-id="1b73b-121">Соблюдайте следующие правила, чтобы гарантировать изолированную работу приложения или компонента.</span><span class="sxs-lookup"><span data-stu-id="1b73b-121">Follow these guidelines to make sure your application or component runs in isolation:</span></span>  
  
- <span data-ttu-id="1b73b-122">Выполняйте запись в реестр с учетом версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-122">Write to the registry in a version-specific way.</span></span> <span data-ttu-id="1b73b-123">Храните значения в кустах или ключах с указанием версии, не осуществляйте совместное использование информации или сведений о состоянии в разных версиях компонента.</span><span class="sxs-lookup"><span data-stu-id="1b73b-123">Store values in hives or keys that indicate the version, and do not share information or state across versions of a component.</span></span> <span data-ttu-id="1b73b-124">В этом случае два приложения или компонента, работающие одновременно, не смогут перезаписывать информацию.</span><span class="sxs-lookup"><span data-stu-id="1b73b-124">This prevents two applications or components running at the same time from overwriting information.</span></span>  
  
- <span data-ttu-id="1b73b-125">Создавайте именованные объекты ядра с учетом версий, чтобы не возникало состояние гонки.</span><span class="sxs-lookup"><span data-stu-id="1b73b-125">Make named kernel objects version-specific so that a race condition does not occur.</span></span> <span data-ttu-id="1b73b-126">Например, состояние гонки возникает, когда два семафора двух версий одного и того же приложения ждут друг друга.</span><span class="sxs-lookup"><span data-stu-id="1b73b-126">For example, a race condition occurs when two semaphores from two versions of the same application wait on each other.</span></span>  
  
- <span data-ttu-id="1b73b-127">Присваивайте файлам и каталогам имена с учетом версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-127">Make file and directory names version-aware.</span></span> <span data-ttu-id="1b73b-128">Это означает, что сведения о версии должны учитываться в файловых структурах.</span><span class="sxs-lookup"><span data-stu-id="1b73b-128">This means that file structures should rely on version information.</span></span>  
  
- <span data-ttu-id="1b73b-129">Создавайте учетные записи пользователей и группы с учетом версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-129">Create user accounts and groups in a version-specific manner.</span></span> <span data-ttu-id="1b73b-130">Учетные записи пользователей и группы, созданные приложением, должны идентифицироваться по версии.</span><span class="sxs-lookup"><span data-stu-id="1b73b-130">User accounts and groups created by an application should be identified by version.</span></span> <span data-ttu-id="1b73b-131">Не осуществляйте совместное использование учетных записей пользователей и групп разными версиями приложения.</span><span class="sxs-lookup"><span data-stu-id="1b73b-131">Do not share user accounts and groups between versions of an application.</span></span>  
  
## <a name="installing-and-uninstalling-versions"></a><span data-ttu-id="1b73b-132">Установка и удаление версий</span><span class="sxs-lookup"><span data-stu-id="1b73b-132">Installing and Uninstalling Versions</span></span>  
 <span data-ttu-id="1b73b-133">При разработке приложения для параллельного выполнения следуйте этим инструкциям по установке и удалению версий.</span><span class="sxs-lookup"><span data-stu-id="1b73b-133">When designing an application for side-by-side execution, follow these guidelines concerning installing and uninstalling versions:</span></span>  
  
- <span data-ttu-id="1b73b-134">Не удаляйте из реестра сведения, которые могут потребоваться другим приложениям, выполняемым с другой версией .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1b73b-134">Do not delete information from the registry that may be needed by other applications running under a different version of the .NET Framework.</span></span>  
  
- <span data-ttu-id="1b73b-135">Не заменяйте сведения, которые могут потребоваться другим приложениям, выполняемым с другой версией .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1b73b-135">Do not replace information in the registry that may be needed by other applications running under a different version of the .NET Framework.</span></span>  
  
- <span data-ttu-id="1b73b-136">Не отменяйте регистрацию COM-компонентов, которые могут потребоваться другим приложениям, выполняемым с другой версией .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1b73b-136">Do not unregister COM components that may be needed by other applications running under a different version of the .NET Framework.</span></span>  
  
- <span data-ttu-id="1b73b-137">Не изменяйте **InprocServer32** или другие записи в реестре для уже зарегистрированного COM-сервера.</span><span class="sxs-lookup"><span data-stu-id="1b73b-137">Do not change **InprocServer32** or other registry entries for a COM server that was already registered.</span></span>  
  
- <span data-ttu-id="1b73b-138">Не удаляйте учетные записи пользователей и группы, которые могут потребоваться другим приложениям, выполняемым с другой версией .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1b73b-138">Do not delete user accounts or groups that may be needed by other applications running under a different version of the .NET Framework.</span></span>  
  
- <span data-ttu-id="1b73b-139">Не следует добавлять в реестр что-либо, содержащее путь без версии.</span><span class="sxs-lookup"><span data-stu-id="1b73b-139">Do not add anything to the registry that contains an unversioned path.</span></span>  
  
## <a name="file-version-number-and-assembly-version-number"></a><span data-ttu-id="1b73b-140">Номер версии файла и номер версии сборки</span><span class="sxs-lookup"><span data-stu-id="1b73b-140">File Version Number and Assembly Version Number</span></span>  
 <span data-ttu-id="1b73b-141">Версия файла — это ресурс версии Win32, который не используется средой выполнения.</span><span class="sxs-lookup"><span data-stu-id="1b73b-141">File version is a Win32 version resource that is not used by the runtime.</span></span> <span data-ttu-id="1b73b-142">Как правило, версия файла обновляется даже при локальном обновлении.</span><span class="sxs-lookup"><span data-stu-id="1b73b-142">In general, you update the file version even for an in-place update.</span></span> <span data-ttu-id="1b73b-143">Два идентичных файла могут иметь разные сведения о версии файла, а два разных файла могут иметь одни и те же сведения о версии файла.</span><span class="sxs-lookup"><span data-stu-id="1b73b-143">Two identical files can have different file version information, and two different files can have the same file version information.</span></span>  
  
 <span data-ttu-id="1b73b-144">Версия сборки используется средой выполнения для привязки сборок.</span><span class="sxs-lookup"><span data-stu-id="1b73b-144">The assembly version is used by the runtime for assembly binding.</span></span> <span data-ttu-id="1b73b-145">Две одинаковые сборки с разными номерами версий рассматриваются средой выполнения как две разные сборки.</span><span class="sxs-lookup"><span data-stu-id="1b73b-145">Two identical assemblies with different version numbers are treated as two different assemblies by the runtime.</span></span>  
  
 <span data-ttu-id="1b73b-146">[Средство глобального кэша сборок (Gacutil.exe)](../tools/gacutil-exe-gac-tool.md) позволяет заменить сборку, если более новым является только номер версии файла.</span><span class="sxs-lookup"><span data-stu-id="1b73b-146">The [Global Assembly Cache tool (Gacutil.exe)](../tools/gacutil-exe-gac-tool.md) allows you to replace an assembly when only the file version number is newer.</span></span> <span data-ttu-id="1b73b-147">Установщик обычно переустанавливает сборку только в том случае, если номер версии сборки больше.</span><span class="sxs-lookup"><span data-stu-id="1b73b-147">The installer generally does not install over an assembly unless the assembly version number is greater.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1b73b-148">См. также</span><span class="sxs-lookup"><span data-stu-id="1b73b-148">See also</span></span>

- [<span data-ttu-id="1b73b-149">Параллельное выполнение</span><span class="sxs-lookup"><span data-stu-id="1b73b-149">Side-by-Side Execution</span></span>](side-by-side-execution.md)
- [<span data-ttu-id="1b73b-150">Практическое руководство. Включение и отключение автоматического перенаправления привязки</span><span class="sxs-lookup"><span data-stu-id="1b73b-150">How to: Enable and Disable Automatic Binding Redirection</span></span>](../configure-apps/how-to-enable-and-disable-automatic-binding-redirection.md)
