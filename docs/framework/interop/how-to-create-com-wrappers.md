---
title: Практическое руководство. Создание оболочек COM
ms.date: 03/30/2017
helpviewer_keywords:
- COM,wrappers creating
- COM,wrappers Visual Studio
ms.assetid: bdf89bea-1623-45ee-a57b-cf7c90395efa
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 7a6af73a5251cdc52589967178218f8675cac869
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69946461"
---
# <a name="how-to-create-com-wrappers"></a>Практическое руководство. Создание оболочек COM

Программы-оболочки модели COM можно создавать с использованием функций Visual Studio 2005 или средств платформы .NET Framework (Tlbimp.exe и Regasm.exe). Оба метода позволяют создать два типа программ-оболочек COM:

- [Вызываемая оболочка времени выполнения](../../standard/native-interop/runtime-callable-wrapper.md) из библиотеки типов для выполнения COM-объектов в управляемом коде.

- [Вызываемая оболочка COM](../../standard/native-interop/com-callable-wrapper.md) с соответствующими параметрами реестра для выполнения управляемого объекта в собственном приложении.

В Visual Studio 2005 оболочку COM можно добавить в проект в виде ссылки.

## <a name="wrap-com-objects-in-a-managed-application"></a>Создание оболочек для COM-объектов в управляемом приложении

### <a name="to-create-a-runtime-callable-wrapper-using-visual-studio"></a>Создание вызываемой оболочки времени выполнения с использованием Visual Studio

1. Откройте проект управляемого приложения.

2. В меню **Проект** выберите пункт **Показать все файлы**.

3. В меню **Проект** щелкните команду **Добавить ссылку**.

4. В диалоговом окне "Добавление ссылки" перейдите на вкладку **COM**, выберите нужный компонент и нажмите кнопку **ОК**.

     Обратите внимание, что в **обозревателе решений** в папку ссылок проекта добавляется COM-компонент.

Теперь можно написать код для доступа к COM-объекту. Сначала можно объявить объект, например с помощью оператора `Imports` для Visual Basic или оператора `Using` для C#.

> [!NOTE]
> При программировании компонентов Microsoft Office сначала необходимо установить [основные сборки взаимодействия Microsoft Office](https://go.microsoft.com/fwlink/?LinkId=50479) из Центра загрузки Майкрософт. На шаге 4 выберите последнюю доступную версию библиотеки объектов для нужного продукта Office, например **библиотеку объектов Microsoft Word 11.0**.  
  
### <a name="to-create-a-runtime-callable-wrapper-using-net-framework-tools"></a>Создание вызываемой оболочки времени выполнения с использованием средств платформы .NET Framework  
  
- Запустите средство [Tlbimp.exe (программа экспорта библиотек типов)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md).  
  
 Это средство создает сборку, которая содержит метаданные времени выполнения для типов, определенных в исходной библиотеке типов.  
  
## <a name="wrap-managed-objects-in-a-native-application"></a>Создание оболочек для управляемых объектов в собственном приложении  
  
### <a name="to-create-a-com-callable-wrapper-using-visual-studio"></a>Создание вызываемой оболочки COM с использованием Visual Studio  
  
1. Создайте проект библиотеки классов для управляемого класса, который требуется выполнять в машинном коде. Класс должен содержать конструктор без параметров.  
  
     Убедитесь, что в файле AssemblyInfo присутствует полный номер версии сборки, состоящий из четырех частей. Этот номер необходим для управления версиями в реестре Windows. Дополнительные сведения о номерах версий см. в разделе [Управление версиями сборки](../../../docs/framework/app-domains/assembly-versioning.md).  
  
2. В меню **Проект** выберите пункт **Свойства**.  
  
3. Откройте вкладку **Компиляция**.  
  
4. Установите флажок **Регистрация для COM-взаимодействия**.  
  
 При построении проекта сборка автоматически регистрируется для COM-взаимодействия. При создании собственного приложения в Visual Studio 2005 можно использовать сборку, щелкнув команду **Добавить ссылку** в меню **Проект**.  
  
### <a name="to-create-a-com-callable-wrapper-using-net-framework-tools"></a>Создание вызываемой оболочки COM с использованием средств платформы .NET Framework  
  
Запустите программу [Regasm.exe (средство регистрации сборок)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md).  
  
Это средство считывает метаданные сборки и добавляет в реестр необходимые записи. В результате этого клиенты COM получают возможность прозрачно создавать классы .NET Framework. Сборку можно использовать так, как если бы она была собственным COM-классом.  
  
Программу Regasm.exe можно запускать для сборки, расположенной в любом каталоге. После этого необходимо запустить [Gacutil.exe (программу глобального кэша сборок)](../../../docs/framework/tools/gacutil-exe-gac-tool.md), чтобы перенести ее в глобальный кэш сборок. При переносе сборки записи расположения в реестре сохраняют силу, поскольку во всех случаях, когда сборка не найдена, проверяется глобальный кэш сборок.  
  
## <a name="see-also"></a>См. также

- [Вызываемая оболочка времени выполнения](../../standard/native-interop/runtime-callable-wrapper.md)
- [Вызываемая оболочка COM](../../standard/native-interop/com-callable-wrapper.md)
