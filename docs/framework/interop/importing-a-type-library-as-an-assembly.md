---
title: Импорт библиотеки типов в виде сборки
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 4104ddba1942f9cb9bd860d53dc54968de5af891
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59151272"
---
# <a name="importing-a-type-library-as-an-assembly"></a>Импорт библиотеки типов в виде сборки
Определения COM-типов обычно хранятся в библиотеке типов. С другой стороны, CLS-совместимые компиляторы создают в сборке метаданные типов. Эти два источника сведений о типах заметно отличаются. В этом разделе описываются способы создания метаданных из библиотеки типов. Результирующая сборка и называется сборкой взаимодействия, а содержащиеся в ней сведения о типах позволяют приложениям .NET Framework использовать COM-типы.  
  
 Существует два способа, чтобы сделать эти сведения о типах доступными для приложения.  
  
-   Использование сборок взаимодействия только во время разработки. Начиная с версии [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] можно указать компилятору внедрять сведения о типах из сборки взаимодействия в исполняемый файл. Компилятор внедряет только сведения о типе, используемые приложением. Не требуется развертывать сборку взаимодействия с приложением. Это рекомендуемая методика.  
  
-   Развертывание сборок взаимодействия. Можно создать стандартную ссылку на сборку взаимодействия. В этом случае сборки взаимодействия должны быть развернуты вместе с приложением. Если вы применяете эту методику и не используете частный COM-компонент, всегда ссылайтесь на основную сборку взаимодействия (PIA), опубликованную автором COM-компонента, который планируется включить в управляемый код. Дополнительные сведения о создании и использовании основных сборок взаимодействия см. в разделе [Основные сборки взаимодействия](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).  
  
 При использовании сборок взаимодействия только во время разработки можно внедрить сведения о типе из основной сборки взаимодействия, опубликованной автором COM-компонента. Однако не требуется развертывать основную сборку взаимодействия с приложением.  
  
 Использование сборок взаимодействия только во время разработки приводит к уменьшению размера приложения, так как большинство приложений используют не все функции COM-компонента. Компилятор очень эффективен при внедрении сведений о типе. Если приложение использует только некоторые методы в COM-интерфейсе, компилятор не внедряет неиспользуемые методы. Когда приложение, содержащее внедренные сведения о типах, взаимодействует с другим таким приложением или с приложением, использующим основную сборку взаимодействия, среда CLR применяет правила эквивалентности типов, чтобы определить, представляют ли два типа с одинаковым именем один и тот же COM-тип. Чтобы использовать COM-объекты, знать эти правила не требуется. Однако если вас интересуют правила, см. раздел [Эквивалентность типов и внедренные типы взаимодействия](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).  
  
## <a name="generating-metadata"></a>Создание метаданных  
 Библиотеки COM-типов могут быть автономными файлами TLB, например Loanlib.tlb. Некоторые библиотеки типов встроены в раздел ресурсов файла DLL или EXE. Другими источниками данных библиотек типов являются файлы OLB и OCX.  
  
 После нахождения библиотеки типов, содержащей реализацию искомого COM-типа, для создания сборки взаимодействия, содержащей метаданные типа, разработчик может выбрать нужный из нескольких вариантов.  
  
-   Visual Studio  
  
     Visual Studio 2005 автоматически преобразует COM-типы библиотеки типов в метаданные сборки. Инструкции см. в разделе [Практическое руководство. Добавление ссылок на библиотеки типов](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md).  
  
-   [Программа импорта библиотек типов (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
  
     Программа экспорта библиотек типов предоставляет параметры командной строки для настройки метаданных в результирующем файле взаимодействия, импортирует типы из существующей библиотеки типов и создает сборку взаимодействия и пространство имен. Инструкции см. в разделе [Практическое руководство. Создание сборок взаимодействия из библиотек типов](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).  
  
-   Класс <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType>  
  
     Этот класс предоставляет методы преобразования компонентных классов и интерфейсов в библиотеке типов в метаданные сборки. Он создает такие же выходные метаданные, что и программа Tlbimp.exe. Однако, в отличие от программы Tlbimp.exe, класс <xref:System.Runtime.InteropServices.TypeLibConverter> может преобразовать в метаданные библиотеку типов, находящуюся в памяти.  
  
-   Настраиваемые оболочки  
  
     Если библиотека типов недоступна или является неверной, единственный выход — создать в управляемом исходном коде дубликат определения класса или интерфейса. После этого нужно скомпилировать исходный код с помощью компилятора, который обращается к среде выполнения, чтобы создать метаданные в сборке.  
  
     Чтобы определить COM-типы вручную, необходим доступ к следующим элементам:  
  
    -   точные описания определяемых компонентных классов и интерфейсов;  
  
    -   компилятор, например компилятор C#, который может создавать соответствующие определения классов .NET Framework;  
  
    -   ведения о правилах преобразования библиотек типов в сборки.  
  
     Написание настраиваемой оболочки — это сложная процедура. Дополнительные сведения о создании настраиваемой оболочки см. в разделе [Настройка стандартных оболочек](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).  
  
 Дополнительные сведения процессе импорта COM-взаимодействия см. в разделе [Обзор преобразования библиотек типов в сборки](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).  
  
## <a name="see-also"></a>См. также

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [Предоставление COM-компонентов платформе .NET Framework](../../../docs/framework/interop/exposing-com-components.md)
- [Общие сведения о преобразовании библиотеки типов в сборку](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))
- [Tlbimp.exe (программа экспорта библиотек типов)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)
- [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)) (Настройка стандартных оболочек)
- [Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100)) (Использование COM-типов в управляемом коде)
- [Компиляция проекта, использующего взаимодействие](../../../docs/framework/interop/compiling-an-interop-project.md)
- [Развертывание приложения взаимодействия](../../../docs/framework/interop/deploying-an-interop-application.md)
- [Практическое руководство. Добавление ссылок на библиотеки типов](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)
- [Практическое руководство. Создание сборок взаимодействия из библиотек типов](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)
