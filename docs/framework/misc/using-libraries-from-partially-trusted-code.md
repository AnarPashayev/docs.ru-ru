---
title: Использование библиотек из не вполне надежного кода
ms.date: 03/30/2017
helpviewer_keywords:
- security [.NET Framework], partially trusted code
- partially trusted code
- partial trust
- AllowPartiallyTrustedCallersAttribute attribute
- code access security, partially trusted code
- APTCA
ms.assetid: dd66cd4c-b087-415f-9c3e-94e3a1835f74
author: mairaw
ms.author: mairaw
ms.openlocfilehash: e08cb1b3f4708b4314f0cd663f70fa10aaa1aded
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69910685"
---
# <a name="using-libraries-from-partially-trusted-code"></a>Использование библиотек из не вполне надежного кода
[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]  
  
> [!NOTE]
> В этом разделе рассматривается поведение сборок со строгими именами и применяется только к сборкам [уровня 1](../../../docs/framework/misc/security-transparent-code-level-1.md) . Строгие имена не зависят от [кода, прозрачного для системы безопасности, сборки уровня 2](../../../docs/framework/misc/security-transparent-code-level-2.md) в .NET Framework 4 или более поздней версии. Дополнительные сведения об изменениях в системе безопасности см. в разделе [изменения безопасности](../../../docs/framework/security/security-changes.md).  
  
 Приложения, которые не получают полное доверие со стороны узла или песочницы, не могут вызывать общие управляемые библиотеки, если только автор библиотеки не разрешил это специально при помощи атрибута <xref:System.Security.AllowPartiallyTrustedCallersAttribute>. Таким образом, авторы приложений должны иметь в виду, что некоторые библиотеки будут им недоступны в контексте частичного доверия. По умолчанию весь код, выполняемый в [песочнице](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md) с частичным доверием и не включен в список сборок с полным доверием, является частично доверенным. Если не предполагается, что код будет запускаться в частично доверенном контексте или вызываться кодом с частичным доверием, данный раздел можно игнорировать. Однако при написании кода, который должен взаимодействовать с частично доверенным кодом или работать из частично доверенного контекста, следует учитывать следующие факторы.  
  
- Библиотеки должны быть подписаны строгим именем, чтобы их могли совместно использовать несколько приложений. Строгие имена позволяют помещать код в глобальный кэш сборок или добавлять его в список полного доверия песочницы <xref:System.AppDomain>, а также позволяют потребителям удостовериться, что данный фрагмент мобильного кода действительно исходит от вас.  
  
- По умолчанию общие библиотеки [уровня 1](../../../docs/framework/misc/security-transparent-code-level-1.md) со строгим именем выполняют неявную проверку [LinkDemand](../../../docs/framework/misc/link-demands.md) для полного доверия автоматически, без необходимости выполнять какие-либо действия с модулем записи библиотеки.  
  
- Если вызывающий объект не имеет полного доверия, однако пытается вызывать такую библиотеку, среда выполнения создает <xref:System.Security.SecurityException>, а вызывающему объекту запрещается связь с библиотекой.  
  
- Чтобы отключить автоматический **LinkDemand** и предотвратить возникновение исключения, можно поместить атрибут **AllowPartiallyTrustedCallersAttribute** в область сборки общей библиотеки. Этот атрибут позволяет вызывать библиотеки из частично доверенного управляемого кода.  
  
- На частично доверенный код, получающий доступ к библиотеке при помощи этого атрибута, по-прежнему налагаются дополнительные ограничения, определяемые <xref:System.AppDomain>.  
  
- Программного способа для частично доверенного кода не существует, чтобы вызвать библиотеку, которая не имеет атрибута **AllowPartiallyTrustedCallersAttribute** .  
  
 Для библиотек, которые являются частными для конкретного приложения, не требуется строгое имя или атрибут **AllowPartiallyTrustedCallersAttribute** и на него нельзя ссылаться потенциально вредоносный код за пределами приложения. Такой код защищен от преднамеренного или непреднамеренного неправильного использования со стороны мобильного кода с частичным доверием, и никаких дополнительных действий со стороны разработчика не требуется.  
  
 Рекомендуется явно разрешить использование частично доверенным кодом для следующих типов кода.  
  
- Код, который тщательно проверен на наличие уязвимостей в системе безопасности и соответствует рекомендациям, описанным в разделе [рекомендации по обеспечению безопасного программирования](../../standard/security/secure-coding-guidelines.md).  
  
- Строго именованные библиотеки кода, специально написанные для частично доверенных сценариев.  
  
- Все компоненты (с частичным или полным доверием), подписанные строгим именем, которые будут вызываться кодом, скачанным из Интернета.  
  
> [!NOTE]
> Некоторые классы в библиотеке классов .NET Framework не имеют атрибута **AllowPartiallyTrustedCallersAttribute** и не могут вызываться частично доверенным кодом.  
  
## <a name="see-also"></a>См. также

- [Управление доступом для кода](../../../docs/framework/misc/code-access-security.md)
