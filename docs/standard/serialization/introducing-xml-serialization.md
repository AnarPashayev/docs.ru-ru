---
title: Сведения о сериализации XML
description: Сериализация преобразует объект в форму, которую можно переносить. В этой статье представлен обзор сериализации XML и класса XmlSerializer.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- XML serialization, about XML serialization
- ICollection interface, serializing
- XmlSerializer class, serializing
- serialization, about serialization
- DataSet class, serializing
- XML Schema, serializing
ms.assetid: 8c63200d-db63-4a03-a93d-21641623df62
ms.openlocfilehash: 334cb3fe40c310189018d924aef552ecd87e9a65
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/15/2020
ms.locfileid: "90535414"
---
# <a name="xml-serialization"></a><span data-ttu-id="f9ae8-104">сериализация XML</span><span class="sxs-lookup"><span data-stu-id="f9ae8-104">XML serialization</span></span>

<span data-ttu-id="f9ae8-105">Сериализация представляет собой процесс преобразования объекта в форму, подготовленную для передачи.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-105">Serialization is the process of converting an object into a form that can be readily transported.</span></span> <span data-ttu-id="f9ae8-106">Например, можно сериализовать объект и передать его по Интернету с использованием протокола HTTP между клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-106">For example, you can serialize an object and transport it over the Internet using HTTP between a client and a server.</span></span> <span data-ttu-id="f9ae8-107">И наоборот, при десериализации объект воссоздается из потока.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-107">On the other end, deserialization reconstructs the object from the stream.</span></span>

 <span data-ttu-id="f9ae8-108">При XML-сериализации в поток XML сериализуются только открытые поля и значения свойств объекта.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-108">XML serialization serializes only the public fields and property values of an object into an XML stream.</span></span> <span data-ttu-id="f9ae8-109">XML-сериализация не учитывает информацию о типе.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-109">XML serialization does not include type information.</span></span> <span data-ttu-id="f9ae8-110">Например, если имеется объект **Book**, который существует в пространстве имен **Library**, нет никакой гарантии, что он десериализуется в объект аналогичного типа.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-110">For example, if you have a **Book** object that exists in the **Library** namespace, there is no guarantee that it is deserialized into an object of the same type.</span></span>

> [!NOTE]
> <span data-ttu-id="f9ae8-111">XML-сериализация не выполняет преобразование методов, индексаторов, закрытых полей или свойств только для чтения (кроме коллекций только для чтения).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-111">XML serialization does not convert methods, indexers, private fields, or read-only properties (except read-only collections).</span></span> <span data-ttu-id="f9ae8-112">Для сериализации всех полей и свойств объекта, как открытых, так и закрытых, используйте <xref:System.Runtime.Serialization.DataContractSerializer> вместо XML-сериализации.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-112">To serialize all an object's fields and properties, both public and private, use the <xref:System.Runtime.Serialization.DataContractSerializer> instead of XML serialization.</span></span>

 <span data-ttu-id="f9ae8-113">Центральным классом XML-сериализации является класс <xref:System.Xml.Serialization.XmlSerializer>, а наиболее важные методы в этом классе — **Serialize** и **Deserialize**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-113">The central class in XML serialization is the <xref:System.Xml.Serialization.XmlSerializer> class, and the most important methods in this class are the **Serialize** and **Deserialize** methods.</span></span> <span data-ttu-id="f9ae8-114"><xref:System.Xml.Serialization.XmlSerializer> создает файлы C# и компилирует их в файлы DLL для выполнения сериализации.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-114">The <xref:System.Xml.Serialization.XmlSerializer> creates C# files and compiles them into .dll files to perform this serialization.</span></span> <span data-ttu-id="f9ae8-115">В платформе .NET Framework 2.0 [инструмент создания XML-сериализатора (Sgen.exe)](xml-serializer-generator-tool-sgen-exe.md) предназначен для создания таких сборок сериализации заранее, они будут развертываться вместе с приложением и повышать производительность при запуске.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-115">In .NET Framework 2.0, the [XML Serializer Generator Tool (Sgen.exe)](xml-serializer-generator-tool-sgen-exe.md) is designed to generate these serialization assemblies in advance to be deployed with your application and improve startup performance.</span></span> <span data-ttu-id="f9ae8-116">Поток XML, создаваемый **XmlSerializer**, соответствует [рекомендациям для языка определения схемы XML (XSD) 1.0](https://www.w3.org/TR/xslt) консорциума W3C.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-116">The XML stream generated by the **XmlSerializer** is compliant with the World Wide Web Consortium (W3C) [XML Schema definition language (XSD) 1.0 recommendation](https://www.w3.org/TR/xslt).</span></span> <span data-ttu-id="f9ae8-117">Более того, создаваемые типы данных соответствуют документу "XML Schema Part 2: Datatypes" (Схема XML. Часть 2. Типы данных).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-117">Furthermore, the data types generated are compliant with the document titled "XML Schema Part 2: Datatypes."</span></span>

 <span data-ttu-id="f9ae8-118">Данные в объектах описываются с помощью конструкций языка программирования, например классов, полей, свойств, типов примитивов, массивов и даже встроенного XML в форме объектов **XmlElement** или **XmlAttribute**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-118">The data in your objects is described using programming language constructs like classes, fields, properties, primitive types, arrays, and even embedded XML in the form of **XmlElement** or **XmlAttribute** objects.</span></span> <span data-ttu-id="f9ae8-119">Предусмотрена возможность создания собственных классов, аннотируемых атрибутами, или использования инструмента определения схемы XML для создания классов на основе существующей схемы XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-119">You have the option of creating your own classes, annotated with attributes, or using the XML Schema Definition tool to generate the classes based on an existing XML Schema.</span></span>

 <span data-ttu-id="f9ae8-120">При наличии схемы XML можно запустить инструмент определения схемы XML, чтобы создать набор классов со строгим типом схемы, которые аннотированы атрибутами.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-120">If you have an XML Schema, you can run the XML Schema Definition tool to produce a set of classes that are strongly typed to the schema and annotated with attributes.</span></span> <span data-ttu-id="f9ae8-121">При сериализации экземпляра такого класса созданный XML соответствует схеме XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-121">When an instance of such a class is serialized, the generated XML adheres to the XML Schema.</span></span> <span data-ttu-id="f9ae8-122">Благодаря такому классу можно создать код с использованием объектной модели, которой легко управлять, и при этом гарантировать соответствие созданного XML схеме XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-122">Provided with such a class, you can program against an easily manipulated object model while being assured that the generated XML conforms to the XML schema.</span></span> <span data-ttu-id="f9ae8-123">Это альтернативный вариант использования других классов в платформе .NET Framework, например классов **XmlReader** и **XmlWriter**, для анализа и записи в поток XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-123">This is an alternative to using other classes in the .NET Framework, such as the **XmlReader** and **XmlWriter** classes, to parse and write an XML stream.</span></span> <span data-ttu-id="f9ae8-124">Дополнительные сведения см. в разделе [XML-документы и данные](../data/xml/index.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-124">For more information, see [XML Documents and Data](../data/xml/index.md).</span></span> <span data-ttu-id="f9ae8-125">Эти классы позволяют анализировать любой поток XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-125">These classes allow you to parse any XML stream.</span></span> <span data-ttu-id="f9ae8-126">И наоборот, используйте **XmlSerializer**, когда предполагается, что поток XML соответствует известной схеме XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-126">In contrast, use the **XmlSerializer** when the XML stream is expected to conform to a known XML Schema.</span></span>

 <span data-ttu-id="f9ae8-127">Атрибуты управляют потоком XML, который создан классом **XmlSerializer**, позволяя задавать пространство имен XML, имя элемента, имя атрибута потока XML и т. д.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-127">Attributes control the XML stream generated by the **XmlSerializer** class, allowing you to set the XML namespace, element name, attribute name, and so on, of the XML stream.</span></span> <span data-ttu-id="f9ae8-128">Дополнительные сведения об этих атрибутах и о том, как они управляют XML-сериализацией, см. в разделе [Управление сериализацией XML с использованием атрибутов](controlling-xml-serialization-using-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-128">For more information about these attributes and how they control XML serialization, see [Controlling XML Serialization Using Attributes](controlling-xml-serialization-using-attributes.md).</span></span> <span data-ttu-id="f9ae8-129">Таблица атрибутов, используемых для управления созданным XML, представлена в разделе [Атрибуты управления сериализацией XML](attributes-that-control-xml-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-129">For a table of those attributes that are used to control the generated XML, see [Attributes That Control XML Serialization](attributes-that-control-xml-serialization.md).</span></span>

 <span data-ttu-id="f9ae8-130">Класс **XmlSerializer** может продолжать сериализовывать объект и создавать поток XML с кодировкой SOAP.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-130">The **XmlSerializer** class can further serialize an object and generate an encoded SOAP XML stream.</span></span> <span data-ttu-id="f9ae8-131">Созданный XML соответствует требованиям раздела 5 документа консорциума World Wide Web ("www.w3.org") "Simple Object Access Protocol (SOAP) 1.1".</span><span class="sxs-lookup"><span data-stu-id="f9ae8-131">The generated XML adheres to section 5 of the World Wide Web Consortium document titled "Simple Object Access Protocol (SOAP) 1.1."</span></span> <span data-ttu-id="f9ae8-132">Дополнительные сведения об этом процессе см. в разделе [Практическое руководство. Сериализация объекта как потока XML с кодировкой SOAP](how-to-serialize-an-object-as-a-soap-encoded-xml-stream.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-132">For more information about this process, see [How to: Serialize an Object as a SOAP-Encoded XML Stream](how-to-serialize-an-object-as-a-soap-encoded-xml-stream.md).</span></span> <span data-ttu-id="f9ae8-133">Таблица атрибутов, используемых для управления созданным XML, представлена в разделе [Атрибуты управления сериализацией с кодировкой SOAP](attributes-that-control-encoded-soap-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-133">For a table of the attributes that control the generated XML, see [Attributes That Control Encoded SOAP Serialization](attributes-that-control-encoded-soap-serialization.md).</span></span>

 <span data-ttu-id="f9ae8-134">Класс **XmlSerializer** создает сообщения SOAP, созданные и переданные в XML-веб-службы.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-134">The **XmlSerializer** class generates the SOAP messages created by, and passed to, XML Web services.</span></span> <span data-ttu-id="f9ae8-135">Для управления сообщениями SOAP можно применять атрибуты к классам, возвращаемым значениям, параметрам и полям, обнаруженным в файле XML-веб-службы (файл ASMX).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-135">To control the SOAP messages, you can apply attributes to the classes, return values, parameters, and fields found in an XML Web service file (.asmx).</span></span> <span data-ttu-id="f9ae8-136">Можно применять оба атрибута, указанные в списках "Атрибуты управления XML-сериализацией" и "Атрибуты управления сериализацией с кодировкой SOAP", поскольку XML-веб-служба использует либо литеральный стиль, либо стиль с кодировкой SOAP.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-136">You can use both the attributes listed in "Attributes That Control XML Serialization" and "Attributes That Control Encoded SOAP Serialization" because an XML Web service can use either the literal or encoded SOAP style.</span></span> <span data-ttu-id="f9ae8-137">Дополнительные сведения о применении атрибутов для управления XML, созданным XML-веб-службой, см. в разделе [Сериализация XML с использованием XML-веб-служб](xml-serialization-with-xml-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-137">For more information about using attributes to control the XML generated by an XML Web service, see [XML Serialization with XML Web Services](xml-serialization-with-xml-web-services.md).</span></span> <span data-ttu-id="f9ae8-138">Дополнительные сведения о веб-службах XML и SOAP см. в разделе [Настройка форматирования сообщений SOAP](/previous-versions/dotnet/netframework-4.0/dkwy2d72(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-138">For more information about SOAP and XML Web services, see [Customizing SOAP Message Formatting](/previous-versions/dotnet/netframework-4.0/dkwy2d72(v=vs.100)).</span></span>

## <a name="security-considerations-for-xmlserializer-applications"></a><span data-ttu-id="f9ae8-139">Вопросы безопасности в отношении приложений с XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="f9ae8-139">Security Considerations for XmlSerializer Applications</span></span>

<span data-ttu-id="f9ae8-140">При создании приложения, использующего класс **XmlSerializer**, помните о следующих особенностях и их последствиях.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-140">When creating an application that uses the **XmlSerializer**, be aware of the following items and their implications:</span></span>

- <span data-ttu-id="f9ae8-141">**XmlSerializer** создает файлы C# (CS) и компилирует их в файлы DLL в каталоге, названном переменной среды TEMP. С помощью этих файлов DLL выполняется сериализация.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-141">The **XmlSerializer** creates C# (.cs) files and compiles them into .dll files in the directory named by the TEMP environment variable; serialization occurs with those DLLs.</span></span>

  > [!NOTE]
  > <span data-ttu-id="f9ae8-142">Такие сборки сериализации можно создавать заранее и подписать с помощью инструмента SGen.exe.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-142">These serialization assemblies can be generated in advance and signed by using the SGen.exe tool.</span></span> <span data-ttu-id="f9ae8-143">Такой способ невозможно использовать на сервере веб-служб.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-143">This does not work a server of Web services.</span></span> <span data-ttu-id="f9ae8-144">Другими словами, этот способ используется только для клиентов и сериализации вручную.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-144">In other words, it is only for client use and for manual serialization.</span></span>

  <span data-ttu-id="f9ae8-145">Код и файлы DLL уязвимы для вредоносного процесса в момент создания и компиляции.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-145">The code and the DLLs are vulnerable to a malicious process at the time of creation and compilation.</span></span> <span data-ttu-id="f9ae8-146">На компьютере с Microsoft Windows NT версии 4.0 или более поздней два или большее число пользователей могут иметь совместный доступ к каталогу TEMP.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-146">When using a computer running Microsoft Windows NT 4.0 or later, it might be possible for two or more users to share the TEMP directory.</span></span> <span data-ttu-id="f9ae8-147">Совместный доступ к каталогу TEMP представляет угрозу, если у двух учетных записей разные привилегии безопасности и приложение запускается из учетной записи с более высокими привилегиями с использованием **XmlSerializer**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-147">Sharing a TEMP directory is dangerous if the two accounts have different security privileges and the higher-privilege account runs an application using the **XmlSerializer**.</span></span> <span data-ttu-id="f9ae8-148">В таком случае один из пользователей может нарушить безопасность компьютера, заменив либо компилируемый файл CS, либо файл DLL.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-148">In this case, one user can breach the computer's security by replacing either the .cs or .dll file that is compiled.</span></span> <span data-ttu-id="f9ae8-149">Чтобы устранить такую уязвимость, нужно обязательно убедиться, что в каждой учетной записи на компьютере имеется отдельный профиль.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-149">To eliminate this concern, always be sure that each account on the computer has its own profile.</span></span> <span data-ttu-id="f9ae8-150">По умолчанию переменная среды TEMP указывает на разные каталоги для каждой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-150">By default, the TEMP environment variable points to a different directory for each account.</span></span>

- <span data-ttu-id="f9ae8-151">Если злоумышленник отправляет непрерывный поток данных XML на веб-сервер (атака типа "отказ в обслуживании"), **XmlSerializer** продолжает обрабатывать данные, пока на их обработку не будут потрачены все ресурсы системы.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-151">If a malicious user sends a continuous stream of XML data to a Web server (a denial of service attack), then the **XmlSerializer** continues to process the data until the computer runs low on resources.</span></span>

  <span data-ttu-id="f9ae8-152">Такой вид атаки блокируется, если используется компьютер с запущенными службами Internet Information Services (IIS) и приложение работает в среде IIS.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-152">This kind of attack is eliminated if you are using a computer running Internet Information Services (IIS), and your application is running within IIS.</span></span> <span data-ttu-id="f9ae8-153">В службах IIS используется логический элемент, который не обрабатывает потоки, размер которых больше заданного значения (по умолчанию 4 КБ).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-153">IIS features a gate that does not process streams longer than a set amount (the default is 4 KB).</span></span> <span data-ttu-id="f9ae8-154">Если создается приложение, не использующее службы IIS и выполняющее сериализацию с помощью **XmlSerializer**, необходимо реализовать похожий логический элемент, который будет блокировать атаки типа "отказ в обслуживании".</span><span class="sxs-lookup"><span data-stu-id="f9ae8-154">If you create an application that does not use IIS and deserializes with the **XmlSerializer**, you should implement a similar gate that prevents a denial of service attack.</span></span>

- <span data-ttu-id="f9ae8-155">**XmlSerializer** сериализует данные и запускает соответствующий код с использованием любого переданного ему типа.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-155">The **XmlSerializer** serializes data and runs any code using any type given to it.</span></span>

  <span data-ttu-id="f9ae8-156">Вредоносный объект может представлять угрозу в двух случаях.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-156">There are two ways in which a malicious object presents a threat.</span></span> <span data-ttu-id="f9ae8-157">Он может запустить вредоносный код или ввести его в файл C#, созданный **XmlSerializer**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-157">It could run malicious code or it could inject malicious code into the C# file created by the **XmlSerializer**.</span></span> <span data-ttu-id="f9ae8-158">В первом случае, если вредоносный объект пытается запустить разрушительную процедуру, система управления доступом для кода предотвращает повреждение.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-158">In the first case, if a malicious object tries to run a destructive procedure, code access security helps prevent any damage from being done.</span></span> <span data-ttu-id="f9ae8-159">Во втором случае теоретически существует вероятность того, что вредоносный объект может каким-либо способом ввести код в файл C#, созданный **XmlSerializer**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-159">In the second case, there is a theoretical possibility that a malicious object may somehow inject code into the C# file created by the **XmlSerializer**.</span></span> <span data-ttu-id="f9ae8-160">Несмотря на то что эта проблема была тщательно изучена и вероятность такой атаки минимальна, следует принять меры предосторожности, т. е. никогда не сериализовывать данные неизвестного и недоверенного типа.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-160">Although this issue has been examined thoroughly, and such an attack is considered unlikely, you should take the precaution of never serializing data with an unknown and untrusted type.</span></span>

- <span data-ttu-id="f9ae8-161">Сериализованные конфиденциальные данные могут быть уязвимы.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-161">Serialized sensitive data might be vulnerable.</span></span>

  <span data-ttu-id="f9ae8-162">После того как **XmlSerializer** сериализовал данные, их можно сохранить в файл XML или в другое хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-162">After the **XmlSerializer** has serialized data, it can be stored as an XML file or other data store.</span></span> <span data-ttu-id="f9ae8-163">Если хранилище данных доступно для других процессов или видно в интрасети или в Интернете, данные могут быть украдены и использованы с преступными намерениями.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-163">If your data store is available to other processes, or is visible on an intranet or the Internet, the data can be stolen and used maliciously.</span></span> <span data-ttu-id="f9ae8-164">Например, если создается приложение, которое сериализует заказы, содержащие номера кредитных карт, такие данные очень важны.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-164">For example, if you create an application that serializes orders that include credit card numbers, the data is highly sensitive.</span></span> <span data-ttu-id="f9ae8-165">Чтобы предотвратить злонамеренное использование, всегда защищайте хранилище данных и принимайте все меры, чтобы сделать его закрытым.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-165">To help prevent this, always protect the store for your data and take steps to keep it private.</span></span>

## <a name="serialization-of-a-simple-class"></a><span data-ttu-id="f9ae8-166">Сериализация простого класса</span><span class="sxs-lookup"><span data-stu-id="f9ae8-166">Serialization of a Simple Class</span></span>

<span data-ttu-id="f9ae8-167">В следующем примере кода показан базовый класс с открытым полем.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-167">The following code example shows a basic class with a public field.</span></span>

```vb
Public Class OrderForm
    Public OrderDate As DateTime
End Class
```

```csharp
public class OrderForm
{
    public DateTime OrderDate;
}
```

<span data-ttu-id="f9ae8-168">При сериализации экземпляра этого класса этот процесс может выглядеть следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-168">When an instance of this class is serialized, it might resemble the following.</span></span>

```xml
<OrderForm>
    <OrderDate>12/12/01</OrderDate>
</OrderForm>
```

<span data-ttu-id="f9ae8-169">Дополнительные примеры XML-сериализации см. в разделе [Примеры сериализации XML](examples-of-xml-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-169">For more examples of serialization, see [Examples of XML Serialization](examples-of-xml-serialization.md).</span></span>

## <a name="items-that-can-be-serialized"></a><span data-ttu-id="f9ae8-170">Элементы, которые можно сериализовать</span><span class="sxs-lookup"><span data-stu-id="f9ae8-170">Items That Can Be Serialized</span></span>

<span data-ttu-id="f9ae8-171">С помощью класса **XmlSerializer** можно сериализовать следующие элементы:</span><span class="sxs-lookup"><span data-stu-id="f9ae8-171">The following items can be serialized using the **XmlSerializer** class:</span></span>

- <span data-ttu-id="f9ae8-172">Открытые свойства чтения/записи и поля открытых классов.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-172">Public read/write properties and fields of public classes.</span></span>

- <span data-ttu-id="f9ae8-173">Классы, реализующие **ICollection** или **IEnumerable**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-173">Classes that implement **ICollection** or **IEnumerable**.</span></span>

  > [!NOTE]
  > <span data-ttu-id="f9ae8-174">Сериализуются только коллекции, а не открытые свойства.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-174">Only collections are serialized, not public properties.</span></span>

- <span data-ttu-id="f9ae8-175">Объекты **XmlElement**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-175">**XmlElement** objects.</span></span>

- <span data-ttu-id="f9ae8-176">Объекты **XmlNode**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-176">**XmlNode** objects.</span></span>

- <span data-ttu-id="f9ae8-177">Объекты **DataSet**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-177">**DataSet** objects.</span></span>

 <span data-ttu-id="f9ae8-178">Дополнительные сведения о сериализации и десериализации объектов см. в разделах [Практическое руководство. Сериализация объекта](how-to-serialize-an-object.md) и [Практическое руководство. Десериализация объекта](how-to-deserialize-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-178">For more information about serializing or deserializing objects, see [How to: Serialize an Object](how-to-serialize-an-object.md) and [How to: Deserialize an Object](how-to-deserialize-an-object.md).</span></span>

## <a name="advantages-of-using-xml-serialization"></a><span data-ttu-id="f9ae8-179">Преимущества XML-сериализации</span><span class="sxs-lookup"><span data-stu-id="f9ae8-179">Advantages of Using XML Serialization</span></span>

<span data-ttu-id="f9ae8-180">Класс **XmlSerializer** обеспечивает всестороннее и гибкое управление сериализацией объекта как XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-180">The **XmlSerializer** class gives you complete and flexible control when you serialize an object as XML.</span></span> <span data-ttu-id="f9ae8-181">При создании XML-веб-службы к классам и членам можно применять атрибуты управления сериализацией, чтобы выходные данные XML соответствовали определенной схеме.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-181">If you are creating an XML Web service, you can apply attributes that control serialization to classes and members to ensure that the XML output conforms to a specific schema.</span></span>

<span data-ttu-id="f9ae8-182">Например, **XmlSerializer** позволяет:</span><span class="sxs-lookup"><span data-stu-id="f9ae8-182">For example, **XmlSerializer** enables you to:</span></span>

- <span data-ttu-id="f9ae8-183">Указать, нужно ли кодировать поле или свойство как атрибут или элемент.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-183">Specify whether a field or property should be encoded as an attribute or an element.</span></span>

- <span data-ttu-id="f9ae8-184">Указать используемое пространство имен XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-184">Specify an XML namespace to use.</span></span>

- <span data-ttu-id="f9ae8-185">Указать имя элемента или атрибута, если имя поля или свойства неправильное.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-185">Specify the name of an element or attribute if a field or property name is inappropriate.</span></span>

<span data-ttu-id="f9ae8-186">Еще одним преимуществом XML-сериализации является отсутствие ограничений для разрабатываемых приложений, поскольку создаваемый поток XML соответствует определенной схеме.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-186">Another advantage of XML serialization is that you have no constraints on the applications you develop, as long as the XML stream that is generated conforms to a given schema.</span></span> <span data-ttu-id="f9ae8-187">Допустим, имеется схема, которая используется для описания книг.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-187">Imagine a schema that is used to describe books.</span></span> <span data-ttu-id="f9ae8-188">В ней представлены такие элементы, как название, автор, издатель и номер ISBN.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-188">It features a title, author, publisher, and ISBN number element.</span></span> <span data-ttu-id="f9ae8-189">Можно разработать приложение, которое обрабатывает данные XML любым удобным способом, например как заказ книги или список книг.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-189">You can develop an application that processes the XML data in any way you want, for example, as a book order, or as an inventory of books.</span></span> <span data-ttu-id="f9ae8-190">В любом случае единственным требованием является соответствие потока XML указанной схеме языка определения схемы XML (XSD).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-190">In either case, the only requirement is that the XML stream conforms to the specified XML Schema definition language (XSD) schema.</span></span>

## <a name="xml-serialization-considerations"></a><span data-ttu-id="f9ae8-191">Вопросы, связанные XML-сериализацией</span><span class="sxs-lookup"><span data-stu-id="f9ae8-191">XML Serialization Considerations</span></span>

<span data-ttu-id="f9ae8-192">При использовании класса **XmlSerializer** следует обратить внимание на следующие аспекты:</span><span class="sxs-lookup"><span data-stu-id="f9ae8-192">The following should be considered when using the **XmlSerializer** class:</span></span>

- <span data-ttu-id="f9ae8-193">Инструмент Sgen.exe разработан только для создания сборок сериализации для обеспечения оптимальной производительности.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-193">The Sgen.exe tool is expressly designed to generate serialization assemblies for optimum performance.</span></span>

- <span data-ttu-id="f9ae8-194">Сериализованные данные содержат только сами данные и структуру классов.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-194">The serialized data contains only the data itself and the structure of your classes.</span></span> <span data-ttu-id="f9ae8-195">Удостоверения типа и информация о сборке не сохраняются.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-195">Type identity and assembly information are not included.</span></span>

- <span data-ttu-id="f9ae8-196">Могут быть сериализованы только открытые свойства и поля.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-196">Only public properties and fields can be serialized.</span></span> <span data-ttu-id="f9ae8-197">Для свойств должны быть указаны открытые методы доступа (методы get и set).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-197">Properties must have public accessors (get and set methods).</span></span> <span data-ttu-id="f9ae8-198">Если необходимо сериализовать закрытые данные, вместо XML-сериализации используйте класс <xref:System.Runtime.Serialization.DataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-198">If you must serialize non-public data, use the <xref:System.Runtime.Serialization.DataContractSerializer> class rather than XML serialization.</span></span>

- <span data-ttu-id="f9ae8-199">Класс должен иметь конструктор без параметров, сериализуемый с помощью **XmlSerializer**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-199">A class must have a parameterless constructor to be serialized by **XmlSerializer**.</span></span>

- <span data-ttu-id="f9ae8-200">Методы не могут быть сериализованы.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-200">Methods cannot be serialized.</span></span>

- <span data-ttu-id="f9ae8-201">**XmlSerializer** может по-разному обрабатывать классы, реализующие **IEnumerable** или **ICollection**, если они соответствуют определенным требованиям, см. ниже.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-201">**XmlSerializer** can process classes that implement **IEnumerable** or **ICollection** differently if they meet certain requirements, as follows.</span></span>

  <span data-ttu-id="f9ae8-202">Класс, реализующий **IEnumerable**, должен реализовывать открытый метод **Add**, принимающий один параметр.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-202">A class that implements **IEnumerable** must implement a public **Add** method that takes a single parameter.</span></span> <span data-ttu-id="f9ae8-203">Параметр метода **Add** должен соответствовать (быть полиморфным) типу, возвращаемому из свойства **IEnumerator.Current**, которое возвращается из метода **GetEnumerator**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-203">The **Add** method's parameter must be consistent (polymorphic) with the type returned from the **IEnumerator.Current** property returned from the **GetEnumerator** method.</span></span>

  <span data-ttu-id="f9ae8-204">Класс, реализующий **ICollection** в дополнение к **IEnumerable** (например, **CollectionBase**), должен иметь открытое индексированное свойство **Item** (индексатор в C#), которое принимает целое число, и должен иметь открытое свойство **Count** типа **integer**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-204">A class that implements **ICollection** in addition to **IEnumerable** (such as **CollectionBase**) must have a public **Item** indexed property (an indexer in C#) that takes an integer and it must have a public **Count** property of type **integer**.</span></span> <span data-ttu-id="f9ae8-205">Параметр, передаваемый методу **Add**, должен быть того же типа, что и возвращаемый из свойства **Item**, или быть одной из баз такого типа.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-205">The parameter passed to the **Add** method must be the same type as that returned from the **Item** property, or one of that type's bases.</span></span>

  <span data-ttu-id="f9ae8-206">Для классов, реализующих **ICollection**, сериализуемые значения извлекаются из индексированного свойства **Item**, а не путем вызова **GetEnumerator**.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-206">For classes that implement **ICollection**, values to be serialized are retrieved from the indexed **Item** property rather than by calling **GetEnumerator**.</span></span> <span data-ttu-id="f9ae8-207">Кроме того, открытые поля и свойства не сериализуются, за исключением открытых полей, которые возвращают другой класс коллекции (реализующий **ICollection**).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-207">Also, public fields and properties are not serialized, with the exception of public fields that return another collection class (one that implements **ICollection**).</span></span> <span data-ttu-id="f9ae8-208">Дополнительные примеры XML-сериализации см. в разделе [Примеры сериализации XML](examples-of-xml-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-208">For an example, see [Examples of XML Serialization](examples-of-xml-serialization.md).</span></span>

## <a name="xsd-data-type-mapping"></a><span data-ttu-id="f9ae8-209">Сопоставление типа данных XSD</span><span class="sxs-lookup"><span data-stu-id="f9ae8-209">XSD Data Type Mapping</span></span>

<span data-ttu-id="f9ae8-210">Документ консорциума W3C под названием [XML Schema Part 2: Datatypes](https://www.w3.org/TR/xmlschema-2/) (Схема XML. Часть 2. Типы данных) описывает простые типы данных, которые разрешено использовать в схеме языка определения схемы XML (XSD).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-210">The W3C document titled [XML Schema Part 2: Datatypes](https://www.w3.org/TR/xmlschema-2/) specifies the simple data types that are allowed in an XML Schema definition language (XSD) schema.</span></span> <span data-ttu-id="f9ae8-211">Для большинства из них (например, **int** и **decimal**) существует соответствующий тип данных в платформе .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-211">For many of these (for example, **int** and **decimal**), there is a corresponding data type in the .NET Framework.</span></span> <span data-ttu-id="f9ae8-212">Однако для некоторых типов данных XML не предусмотрен соответствующий тип данных в платформе .NET Framework (например, тип данных **NMTOKEN**).</span><span class="sxs-lookup"><span data-stu-id="f9ae8-212">However, some XML data types do not have a corresponding data type in the .NET Framework (for example, the **NMTOKEN** data type).</span></span> <span data-ttu-id="f9ae8-213">В таких случаях при использовании инструмента определения схемы XML ([инструмент определения схемы XML (Xsd.exe)](xml-schema-definition-tool-xsd-exe.md)) для создания классов из схемы к члену строкового типа применяется соответствующий атрибут, и его свойство **DataType** задается как имя типа данных XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-213">In such cases, if you use the XML Schema Definition tool ([XML Schema Definition Tool (Xsd.exe)](xml-schema-definition-tool-xsd-exe.md)) to generate classes from a schema, an appropriate attribute is applied to a member of type string, and its **DataType** property is set to the XML data type name.</span></span> <span data-ttu-id="f9ae8-214">Например, если схема содержит элемент с именем "MyToken" с типом данных XML **NMTOKEN**, созданный класс может содержать член, см. пример ниже.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-214">For example, if a schema contains an element named "MyToken" with the XML data type **NMTOKEN**, the generated class might contain a member as shown in the following example.</span></span>

```vb
<XmlElement(DataType:="NMTOKEN")> _
Public MyToken As String
```

```csharp
[XmlElement(DataType = "NMTOKEN")]
public string MyToken;
```

<span data-ttu-id="f9ae8-215">Аналогичным образом, при создании класса, который должен соответствовать определенной схеме XML (XSD), следует применить соответствующий атрибут и задать его свойство **DataType** как необходимое имя типа данных XML.</span><span class="sxs-lookup"><span data-stu-id="f9ae8-215">Similarly, if you are creating a class that must conform to a specific XML Schema (XSD), you should apply the appropriate attribute and set its **DataType** property to the desired XML data type name.</span></span>

<span data-ttu-id="f9ae8-216">Полный список сопоставлений типов см. в свойстве **DataType** для любого из следующих классов атрибутов:</span><span class="sxs-lookup"><span data-stu-id="f9ae8-216">For a complete list of type mappings, see the **DataType** property for any of the following attribute classes:</span></span>

- <xref:System.Xml.Serialization.SoapAttributeAttribute>

- <xref:System.Xml.Serialization.SoapElementAttribute>

- <xref:System.Xml.Serialization.XmlArrayItemAttribute>

- <xref:System.Xml.Serialization.XmlAttributeAttribute>

- <xref:System.Xml.Serialization.XmlElementAttribute>

- <xref:System.Xml.Serialization.XmlRootAttribute>

## <a name="see-also"></a><span data-ttu-id="f9ae8-217">См. также</span><span class="sxs-lookup"><span data-stu-id="f9ae8-217">See also</span></span>

- <xref:System.Xml.Serialization.XmlSerializer>
- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.IO.FileStream>
- [<span data-ttu-id="f9ae8-218">Сериализация XML и SOAP</span><span class="sxs-lookup"><span data-stu-id="f9ae8-218">XML and SOAP Serialization</span></span>](xml-and-soap-serialization.md)
- [<span data-ttu-id="f9ae8-219">Двоичная сериализация</span><span class="sxs-lookup"><span data-stu-id="f9ae8-219">Binary Serialization</span></span>](binary-serialization.md)
- [<span data-ttu-id="f9ae8-220">Сериализация</span><span class="sxs-lookup"><span data-stu-id="f9ae8-220">Serialization</span></span>](index.md)
- <xref:System.Xml.Serialization.XmlSerializer>
- [<span data-ttu-id="f9ae8-221">Примеры сериализации XML</span><span class="sxs-lookup"><span data-stu-id="f9ae8-221">Examples of XML Serialization</span></span>](examples-of-xml-serialization.md)
- [<span data-ttu-id="f9ae8-222">Практическое руководство. Сериализация объекта</span><span class="sxs-lookup"><span data-stu-id="f9ae8-222">How to: Serialize an Object</span></span>](how-to-serialize-an-object.md)
- [<span data-ttu-id="f9ae8-223">Практическое руководство. Десериализация объекта</span><span class="sxs-lookup"><span data-stu-id="f9ae8-223">How to: Deserialize an Object</span></span>](how-to-deserialize-an-object.md)
