---
title: Когда следует использовать универсальные коллекции
ms.date: 04/30/2020
helpviewer_keywords:
- collections [.NET], generic
- generic collections [.NET]
ms.assetid: e7b868b1-11fe-4ac5-bed3-de68aca47739
ms.openlocfilehash: eeee207d7fe70cc736ca962ef99f3dac2295902b
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "94822897"
---
# <a name="when-to-use-generic-collections"></a><span data-ttu-id="e8b3d-102">Когда следует использовать универсальные коллекции</span><span class="sxs-lookup"><span data-stu-id="e8b3d-102">When to use generic collections</span></span>

<span data-ttu-id="e8b3d-103">При использовании универсальных коллекций автоматически обеспечивается безопасность типов без необходимости наследования от базового типа коллекции и реализации элементов определенного типа.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-103">Using generic collections gives you the automatic benefit of type safety without having to derive from a base collection type and implement type-specific members.</span></span> <span data-ttu-id="e8b3d-104">Типы универсальных коллекций обычно работают лучше, чем соответствующие типы неуниверсальных коллекций (и лучше, чем типы, являющиеся производными от базовых типов неуниверсальных коллекций), если элементами коллекции являются типы значений, поскольку при использовании универсальных коллекций упаковывать элементы не требуется.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-104">Generic collection types also generally perform better than the corresponding nongeneric collection types (and better than types that are derived from nongeneric base collection types) when the collection elements are value types, because with generics, there's no need to box the elements.</span></span>

<span data-ttu-id="e8b3d-105">В программах, предназначенных для .NET Standard 1.0 или более поздней версии, следует использовать универсальные классы-коллекции в пространстве имен <xref:System.Collections.Concurrent>, когда несколько потоков может одновременно добавлять элементы в коллекцию или удалять их оттуда.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-105">For programs that target .NET Standard 1.0 or later, use the generic collection classes in the <xref:System.Collections.Concurrent> namespace when multiple threads might be adding or removing items from the collection concurrently.</span></span> <span data-ttu-id="e8b3d-106">Кроме того, если требуется неизменность, рассмотрите универсальные классы коллекций в пространстве имен <xref:System.Collections.Immutable>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-106">Additionally, when immutability is desired, consider the generic collection classes in the <xref:System.Collections.Immutable> namespace.</span></span>

<span data-ttu-id="e8b3d-107">Следующие универсальные типы соответствуют существующим типам коллекций.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-107">The following generic types correspond to existing collection types:</span></span>

- <span data-ttu-id="e8b3d-108"><xref:System.Collections.Generic.List%601> — это универсальный класс, соответствующий <xref:System.Collections.ArrayList>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-108"><xref:System.Collections.Generic.List%601> is the generic class that corresponds to <xref:System.Collections.ArrayList>.</span></span>

- <span data-ttu-id="e8b3d-109"><xref:System.Collections.Generic.Dictionary%602> и <xref:System.Collections.Concurrent.ConcurrentDictionary%602> — универсальные классы, соответствующие <xref:System.Collections.Hashtable>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-109"><xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Concurrent.ConcurrentDictionary%602> are the generic classes that correspond to <xref:System.Collections.Hashtable>.</span></span>

- <span data-ttu-id="e8b3d-110"><xref:System.Collections.ObjectModel.Collection%601> — это универсальный класс, соответствующий <xref:System.Collections.CollectionBase>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-110"><xref:System.Collections.ObjectModel.Collection%601> is the generic class that corresponds to <xref:System.Collections.CollectionBase>.</span></span> <span data-ttu-id="e8b3d-111"><xref:System.Collections.ObjectModel.Collection%601> может использоваться как базовый класс, но, в отличие от <xref:System.Collections.CollectionBase>, он не является абстрактным, что значительно упрощает его использование.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-111"><xref:System.Collections.ObjectModel.Collection%601> can be used as a base class, but unlike <xref:System.Collections.CollectionBase>, it is not abstract, which makes it much easier to use.</span></span>

- <span data-ttu-id="e8b3d-112"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> — это универсальный класс, соответствующий <xref:System.Collections.ReadOnlyCollectionBase>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-112"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> is the generic class that corresponds to <xref:System.Collections.ReadOnlyCollectionBase>.</span></span> <span data-ttu-id="e8b3d-113"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> не является абстрактным и имеет конструктор, упрощающий представление существующего класса <xref:System.Collections.Generic.List%601> в виде коллекции только для чтения.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-113"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> is not abstract and has a constructor that makes it easy to expose an existing <xref:System.Collections.Generic.List%601> as a read-only collection.</span></span>

- <span data-ttu-id="e8b3d-114">Универсальные классы <xref:System.Collections.Generic.Queue%601>, <xref:System.Collections.Concurrent.ConcurrentQueue%601>, <xref:System.Collections.Immutable.ImmutableQueue%601>, <xref:System.Collections.Immutable.ImmutableArray%601>, <xref:System.Collections.Generic.SortedList%602> и <xref:System.Collections.Immutable.ImmutableSortedSet%601> соответствуют аналогичным неуниверсальным классам с теми же именами.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-114">The <xref:System.Collections.Generic.Queue%601>, <xref:System.Collections.Concurrent.ConcurrentQueue%601>, <xref:System.Collections.Immutable.ImmutableQueue%601>, <xref:System.Collections.Immutable.ImmutableArray%601>, <xref:System.Collections.Generic.SortedList%602>, and <xref:System.Collections.Immutable.ImmutableSortedSet%601> generic classes correspond to the respective nongeneric classes with the same names.</span></span>

## <a name="additional-types"></a><span data-ttu-id="e8b3d-115">Дополнительные типы</span><span class="sxs-lookup"><span data-stu-id="e8b3d-115">Additional Types</span></span>

<span data-ttu-id="e8b3d-116">Несколько типов универсальных коллекций не имеют неуниверсальных аналогов.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-116">Several generic collection types do not have nongeneric counterparts.</span></span> <span data-ttu-id="e8b3d-117">В их число входят следующие.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-117">They include the following:</span></span>

- <span data-ttu-id="e8b3d-118"><xref:System.Collections.Generic.LinkedList%601> является связанным списком общего назначения, обеспечивающий выполнение операций вставки и удаления O(1).</span><span class="sxs-lookup"><span data-stu-id="e8b3d-118"><xref:System.Collections.Generic.LinkedList%601> is a general-purpose linked list that provides O(1) insertion and removal operations.</span></span>

- <span data-ttu-id="e8b3d-119"><xref:System.Collections.Generic.SortedDictionary%602> — это сортируемый словарь с O(log `n`) операциями вставки и извлечения, что делает его полезной альтернативой для <xref:System.Collections.Generic.SortedList%602>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-119"><xref:System.Collections.Generic.SortedDictionary%602> is a sorted dictionary with O(log `n`) insertion and retrieval operations, which makes it a useful alternative to <xref:System.Collections.Generic.SortedList%602>.</span></span>

- <span data-ttu-id="e8b3d-120"><xref:System.Collections.ObjectModel.KeyedCollection%602> — это гибрид списка и словаря, который предоставляет способ хранения объектов, содержащих свои собственные ключи.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-120"><xref:System.Collections.ObjectModel.KeyedCollection%602> is a hybrid between a list and a dictionary, which provides a way to store objects that contain their own keys.</span></span>

- <span data-ttu-id="e8b3d-121"><xref:System.Collections.Concurrent.BlockingCollection%601> реализует класс коллекции с функциями границы и блокировки.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-121"><xref:System.Collections.Concurrent.BlockingCollection%601> implements a collection class with bounding and blocking functionality.</span></span>

- <span data-ttu-id="e8b3d-122"><xref:System.Collections.Concurrent.ConcurrentBag%601> предоставляет возможности быстрой вставки и удаления неупорядоченных элементов.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-122"><xref:System.Collections.Concurrent.ConcurrentBag%601> provides fast insertion and removal of unordered elements.</span></span>

### <a name="immutable-builders"></a><span data-ttu-id="e8b3d-123">Неизменяемые построители</span><span class="sxs-lookup"><span data-stu-id="e8b3d-123">Immutable builders</span></span>

<span data-ttu-id="e8b3d-124">Если в приложении требуется неизменяемая функциональность, пространство имен <xref:System.Collections.Immutable> предлагает универсальные типы коллекций, которые можно использовать.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-124">When you desire immutability functionality in your app, the <xref:System.Collections.Immutable> namespace offers generic collection types you can use.</span></span> <span data-ttu-id="e8b3d-125">Все неизменяемые типы коллекций предлагают классы `Builder`, которые могут оптимизировать производительность при выполнении сразу нескольких изменений.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-125">All of the immutable collection types offer `Builder` classes that can optimize performance when you're performing multiple mutations.</span></span> <span data-ttu-id="e8b3d-126">Класс `Builder` выполняет пакетную обработку операций в изменяемом состоянии.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-126">The `Builder` class batches operations in a mutable state.</span></span> <span data-ttu-id="e8b3d-127">После завершения всех изменений вызовите метод `ToImmutable`, чтобы "заморозить" все узлы и создать неизменяемую универсальную коллекцию, например <xref:System.Collections.Immutable.ImmutableList%601>.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-127">When all mutations have been completed, call the `ToImmutable` method to "freeze" all nodes and create an immutable generic collection, for example, an <xref:System.Collections.Immutable.ImmutableList%601>.</span></span>

<span data-ttu-id="e8b3d-128">Объект `Builder` можно создать, вызвав неуниверсальный метод `CreateBuilder()`.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-128">The `Builder` object can be created by calling the nongeneric `CreateBuilder()` method.</span></span> <span data-ttu-id="e8b3d-129">Из экземпляра `Builder` можно вызвать `ToImmutable()`.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-129">From a `Builder` instance, you can call `ToImmutable()`.</span></span> <span data-ttu-id="e8b3d-130">Аналогичным образом из коллекции `Immutable*` можно вызвать `ToBuilder()`, чтобы создать экземпляр построителя из универсальной неизменяемой коллекции.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-130">Likewise, from the `Immutable*` collection, you can call `ToBuilder()` to create a builder instance from the generic immutable collection.</span></span> <span data-ttu-id="e8b3d-131">Ниже указаны различные типы `Builder`.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-131">The following are the various `Builder` types.</span></span>

- <xref:System.Collections.Immutable.ImmutableArray%601.Builder>
- <xref:System.Collections.Immutable.ImmutableDictionary%602.Builder>
- <xref:System.Collections.Immutable.ImmutableHashSet%601.Builder>
- <xref:System.Collections.Immutable.ImmutableList%601.Builder>
- <xref:System.Collections.Immutable.ImmutableSortedDictionary%602.Builder>
- <xref:System.Collections.Immutable.ImmutableSortedSet%601.Builder>

## <a name="linq-to-objects"></a><span data-ttu-id="e8b3d-132">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="e8b3d-132">LINQ to Objects</span></span>

<span data-ttu-id="e8b3d-133">Функция LINQ to Objects позволяет использовать запросы LINQ для доступа к объектам в памяти при условии, что тип объекта реализует интерфейс <xref:System.Collections.IEnumerable?displayProperty=nameWithType> или <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="e8b3d-133">The LINQ to Objects feature enables you to use LINQ queries to access in-memory objects as long as the object type implements the <xref:System.Collections.IEnumerable?displayProperty=nameWithType> or <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> interface.</span></span> <span data-ttu-id="e8b3d-134">Запросы LINQ предоставляют общий шаблон для доступа к данным, являются более четкими и удобочитаемыми, чем стандартные циклы `foreach`, а также предоставляют возможности фильтрации, сортировки и группировки.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-134">LINQ queries provide a common pattern for accessing data; are typically more concise and readable than standard `foreach` loops; and provide filtering, ordering, and grouping capabilities.</span></span> <span data-ttu-id="e8b3d-135">LINQ запросы также могут повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-135">LINQ queries can also improve performance.</span></span> <span data-ttu-id="e8b3d-136">Дополнительные сведения см. в разделах [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md), [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md) и [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md).</span><span class="sxs-lookup"><span data-stu-id="e8b3d-136">For more information, see [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md), [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md), and [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md).</span></span>

## <a name="additional-functionality"></a><span data-ttu-id="e8b3d-137">Дополнительные функциональные возможности</span><span class="sxs-lookup"><span data-stu-id="e8b3d-137">Additional Functionality</span></span>
<span data-ttu-id="e8b3d-138">Некоторые универсальные типы имеют функциональные возможности, отсутствующие в неуниверсальных коллекциях.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-138">Some of the generic types have functionality that is not found in the nongeneric collection types.</span></span> <span data-ttu-id="e8b3d-139">Например, класс <xref:System.Collections.Generic.List%601> , который соответствует неуниверсальный классу <xref:System.Collections.ArrayList> , имеет ряд методов, которые принимают универсальные делегаты, такие как делегат <xref:System.Predicate%601> , который позволяет указать методы для поиска в списке, делегат <xref:System.Action%601> , который представляет методы, выполняемые с каждым элементом списка, и делегат <xref:System.Converter%602> , который позволяет определять преобразования между типами.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-139">For example, the <xref:System.Collections.Generic.List%601> class, which corresponds to the nongeneric <xref:System.Collections.ArrayList> class, has a number of methods that accept generic delegates, such as the <xref:System.Predicate%601> delegate that allows you to specify methods for searching the list, the <xref:System.Action%601> delegate that represents methods that act on each element of the list, and the <xref:System.Converter%602> delegate that lets you define conversions between types.</span></span>

<span data-ttu-id="e8b3d-140">Класс <xref:System.Collections.Generic.List%601> позволяет задавать свои собственные реализации универсального интерфейса <xref:System.Collections.Generic.IComparer%601> для сортировки и поиска в списке.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-140">The <xref:System.Collections.Generic.List%601> class allows you to specify your own <xref:System.Collections.Generic.IComparer%601> generic interface implementations for sorting and searching the list.</span></span> <span data-ttu-id="e8b3d-141">Классы <xref:System.Collections.Generic.SortedDictionary%602> и <xref:System.Collections.Generic.SortedList%602> также имеют эту возможность.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-141">The <xref:System.Collections.Generic.SortedDictionary%602> and <xref:System.Collections.Generic.SortedList%602> classes also have this capability.</span></span> <span data-ttu-id="e8b3d-142">Кроме того эти классы позволяют задавать функции сравнения при создании коллекции.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-142">In addition, these classes let you specify comparers when the collection is created.</span></span> <span data-ttu-id="e8b3d-143">Аналогично, классы <xref:System.Collections.Generic.Dictionary%602> и <xref:System.Collections.ObjectModel.KeyedCollection%602> позволяют задавать собственные сравнения на равенство.</span><span class="sxs-lookup"><span data-stu-id="e8b3d-143">In similar fashion, the <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.ObjectModel.KeyedCollection%602> classes let you specify your own equality comparers.</span></span>

## <a name="see-also"></a><span data-ttu-id="e8b3d-144">См. также</span><span class="sxs-lookup"><span data-stu-id="e8b3d-144">See also</span></span>

- [<span data-ttu-id="e8b3d-145">Коллекции и структуры данных</span><span class="sxs-lookup"><span data-stu-id="e8b3d-145">Collections and Data Structures</span></span>](index.md)
- [<span data-ttu-id="e8b3d-146">Часто используемые типы коллекций</span><span class="sxs-lookup"><span data-stu-id="e8b3d-146">Commonly Used Collection Types</span></span>](commonly-used-collection-types.md)
- [<span data-ttu-id="e8b3d-147">Универсальные шаблоны</span><span class="sxs-lookup"><span data-stu-id="e8b3d-147">Generics</span></span>](../generics/index.md)
