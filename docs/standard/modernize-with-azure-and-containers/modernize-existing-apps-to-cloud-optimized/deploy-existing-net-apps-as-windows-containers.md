---
title: Развертывание существующих приложений .NET в качестве контейнеров Windows
description: Модернизация существующих приложений .NET с помощью облака Azure и Windows контейнерах | Развертывание существующих приложений .NET в качестве контейнеров Windows
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 04/29/2018
ms.openlocfilehash: 9d84924317e7c6e3dd4386f851ee902e2b5a7caf
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2019
ms.locfileid: "59216669"
---
# <a name="deploy-existing-net-apps-as-windows-containers"></a>Развертывание существующих приложений .NET в качестве контейнеров Windows

Развертывания, которые основаны на контейнеры Windows применимы к оптимизированную для облачных приложений и облачных приложений.

Тем не менее, в этом руководстве и особенно в следующих разделах, здесь главным образом рассматривается использование контейнеров Windows для *оптимизированную для облачных* приложений, где не требуется перепроектирование приложения.

## <a name="what-are-containers-linux-or-windows"></a>Что такое контейнеры? (Windows или Linux)

Контейнеры — это способ переноса приложения в свой собственный пакет изолированной. В своем контейнере приложение не зависит от приложения или процессы, которые существуют вне контейнера. Все, что приложение от которых зависит запуск успешно как процесс — это внутри контейнера. Везде, где может переместить контейнер, требования приложения всегда будет выполняться, с точки зрения прямые зависимости, так как он входит в состав все, что ее необходимо выполнять (зависимости библиотек среды выполнения и т. д.).

Основной характеристикой контейнера является то, среде же в разных развертываниях, так как сам контейнер поставляется со всеми зависимостями, которые необходимы. Можно отлаживать приложение на вашем компьютере и затем развернуть ее на другом компьютере, с той же среде гарантируется.

Контейнер — это экземпляр образа контейнера. Образ контейнера — это способ упаковки приложения или службы (например, моментальный снимок), а затем развернуть его в виде надежного и воспроизводимого. Можно сказать, что Docker является не только технология его, также целой философией и процессом.

По мере контейнеры ежедневно чаще, они становятся во всей отрасли «единица развертывания».

## <a name="benefits-of-containers-docker-engine-on-linux-or-windows"></a>Преимущества контейнеров (подсистема Docker в Linux или Windows)

Построение приложений с помощью контейнеров, которое также может быть определено упрощенных стандартных блоках offers существенное увеличение количества в как гибкость для создания, доставки и запускает приложение, по какой-либо инфраструктурой.

С контейнерами вы можете воспользоваться любое приложение от разработки в рабочую среду с незначительной или нулевой изменения кода, благодаря интеграции Docker средства для разработчиков, операционные системы, и в облаке.

При развертывании на обычные виртуальные машины, у вас уже есть метод на месте для развертывания приложений ASP.NET на виртуальные машины. Вполне вероятно, однако, ваш метод включает в себя несколько действий вручную или сложные автоматизированные процессы с помощью средства развертывания, например Puppet или аналогичное средство. Может потребоваться для выполнения задач, таких как изменение элементов конфигурации, копирование содержимого приложения между серверами и выполнение интерактивной установки программ, основанных на MSI-файл настроек, следуют тестирования. Все эти окна мастеров в развертывании добавьте времени и риска развертываний. Каждый раз, когда зависимость отсутствует в целевой среде приведет к возникновению ошибок.

Процесс упаковки приложений полностью автоматизирована в контейнерах Windows. Контейнеры Windows основана на платформе Docker, что обеспечивает автоматические обновления и откаты для развертываний контейнеров. Основные улучшения, который можно получить с помощью подсистемы Docker является созданием образов, которые похожи на моментальные снимки, приложения, со всеми ее зависимостями. Образы — это образы Docker (Windows образ контейнера, в данном случае). Изображения, запускать приложения ASP.NET в контейнерах, без возврата к исходному коду. Моментальный снимок контейнера становится единицей развертывания.

Во многих организациях создания контейнеров имеющиеся монолитные приложения по следующим причинам:

-   **Release маневренность за счет улучшенному развертыванию**. Контейнеры обеспечивают контракт о согласованном развертывании между разработкой и операциями. При использовании контейнеров, не слышите разработчикам скажем, «Это работает на моем компьютере почему бы не в рабочей среде?» Они сказать «Запускается как контейнер, чтобы он выполнялся в рабочей среде.» Упакованные приложения, со всеми ее зависимостями, могут быть выполнены в любую поддерживаемую среду на базе контейнеров. Он будет выполняться того, который он был предназначен для выполнения в всех целей сценариев развертывания (разработки, контроля Качества, промежуточная обработка, производство). Контейнеры устранить большинство ограничиваются, при их перемещении от одного этапа к другому, что значительно повышает развертывания, и быстрее доставляйте.

-   **Сокращение затрат**. Контейнеры привести к снижению затрат, либо путем консолидации и удаления существующего оборудования, или путем запуска приложения с более высокой плотностью на единицу оборудования.

-   **Переносимость**. Контейнеры — модульность и портативных. Контейнеры docker, поддерживаются на любой серверных операционных систем (Linux и Windows), в любой крупной общедоступной облачной (Microsoft Azure, Amazon AWS, Google, IBM) и в локальной и частной или гибридной облачной среды.

-   **Элемент управления**. Контейнеры обеспечивают гибкую и безопасную среду, в который контролируется на уровне контейнера. Контейнер можно защитить, изолированной и даже ограничена из-за установки ограничения политики выполнения для контейнера. Как описано в разделе о контейнерах Windows Windows Server 2016 и Hyper-V контейнеры предоставляют варианты поддержки дополнительных корпоративных.

Значительные улучшения в элемент управления, гибкость и переносимость в конечном итоге привести к значительному снижению расходов при использовании контейнеров для разработки и обслуживания приложений.

## <a name="what-is-docker"></a>Что такое Docker?

[Docker](https://www.docker.com/) — [проект с открытым кодом](https://github.com/docker/docker) , позволяет автоматизировать развертывание приложений как переносимых, самодостаточных контейнеры, которые могут выполняться в облаке или локально. Docker — это также [компания](https://www.docker.com/), разрабатывающая эту технологию. Компания работает в сотрудничестве с облака, Linux и поставщики Windows, включая Майкрософт.

![](./media/image6.png)

> **Рис. 4-6.** Docker развертывает контейнеры на всех уровнях гибридного облака

Кому-либо знакомы с виртуальными машинами, контейнеры могут оказаться весьма примерно. Контейнер с операционной системой, содержит файловую систему и может осуществляться по сети, так же, как система физический или виртуальный компьютер. Тем не менее технология и принцип контейнеры значительно отличаются от виртуальных машин. С точки зрения разработчика контейнер должен считаться более одного процесса. По сути контейнер имеет единую точку входа для одного процесса.

Контейнеры docker (для простоты *контейнеры*) можно запустить в собственном коде в Linux и Windows. При выполнении регулярного контейнеры, контейнеры Windows можно выполнять только на узлах Windows (на сервере узла или виртуальной Машины) и контейнеры Linux можно запустить только на узлах Linux. Однако в последних версиях Windows Server и Hyper-V контейнеры, контейнере Linux также может запускать в собственном коде в Windows Server с помощью технологии изоляции Hyper-V, который в настоящее время доступна только в контейнеры Windows Server.

В ближайшем будущем смешанных средах, на которые у контейнеров Windows и Linux, будет возможно и даже распространенных.

## <a name="benefits-of-windows-containers-for-your-existing-net-applications"></a>Преимущества контейнеров Windows для переноса существующих приложений .NET

Преимущества использования контейнеров Windows, по сути те же преимущества, получаемых из контейнеров, в целом. С помощью контейнеров Windows — о значительно повышает гибкость, переносимость и управления.

Существующих приложений .NET см. Эти приложения, которые были созданы с помощью .NET Framework. Например, может быть традиционных веб-приложениях ASP.NET — они не используют .NET Core, который имеет более новую версию и выполнения на разных платформах в Linux, Windows и MacOS.

Основные зависимости в .NET Framework — Windows. Он также имеет дополнительный зависимости, такие как IIS и System.Web традиционные модели ASP.NET.

Приложения .NET Framework необходимо запустить на Windows, период. Если нужно упаковать в контейнер существующих приложений .NET Framework, и нельзя или нежелательно вкладывать средства в миграции на .NET Core («если все работает правильно, не будут перемещаться его»), единственным вариантом для контейнеров, является использование контейнеров Windows.

Поэтому одно из основных преимуществ использования контейнеров Windows является, что они позволяют вам модернизировать существующие приложения .NET Framework, работающие на Windows через создание контейнеров. В конечном счете контейнеры Windows получает преимущества, которые вы ищете, используя гибкости контейнеров, переносимость и улучшения контроля.

## <a name="choose-an-os-to-target-with-net-based-containers"></a>Выберите операционную Систему для нацеливания. Контейнеры на основе NET

Учитывая разнообразие операционных систем, поддерживаемых Docker, а также различия между .NET Framework и .NET Core, вы должны быть нацелены определенной ОС и определенные версии в зависимости от платформы, которую вы используете.

Для Windows можно использовать Windows Server Core или Windows Nano Server. Эти версии Windows предоставляют разные характеристики (например, IIS и резидентный веб-сервер, такой как Kestrel), которые могут быть необходимы в .NET Framework или .NET Core.

Для Linux доступно и поддерживается множество дистрибутивов в официальных образах Docker .NET (например, Debian).

Рис. 4-7 показаны версии ОС, которые можно создавать решения, в зависимости от версии приложения платформы .NET Framework.

![](./media/image7.png)

> **Рис. 4-7.** Операционные системы к целевому объекту, на основе версии .NET Framework

В сценарии миграции для существующих или устаревших приложений, с учетом приложений .NET Framework основных зависимостях находятся на Windows и IIS. Единственным вариантом является использование образов Docker на основе Windows Server Core и .NET Framework.

При добавлении имени образа в файл Dockerfile, можно выбрать операционную систему и версию с помощью тега, как показано в следующих примерах для образов контейнеров Windows на основе .NET Framework:

> | **Тег** | **Система и версия** |
> |---|---|
> | **microsoft/dotnet-framework:4.x-windowsservercore** | .NET framework 4.x в Windows Server Core |
> | **Microsoft/aspnet:4.x-windowsservercore** | .NET framework 4.x дополнительной настройки ASP.NET на Windows Server Core |

Для .NET Core (для нескольких платформ для Linux и Windows) теги будет выглядеть следующим образом:

> | **Тег** | **Система и версия**
> |---|---|
> | **Microsoft/DotNet:2.0.0-Runtime** | .NET core 2.0 доступны только для среды выполнения на платформе Linux |
> | **Microsoft/DotNet:2.0.0-Runtime-nanoserver** | На сервере Nano Server Windows только для среды выполнения .NET core 2.0 |

### <a name="multi-arch-images"></a>Мультиархитектурные образы

Начиная с середины 2017 г., также можно использовать новую функцию в Docker с именем [мультиархитектурного](https://github.com/moby/moby/issues/15866) изображения. Образы Docker для .NET core можно использовать теги мультиархитектурности. Dockerfile файлы больше не требуется определять операционной системы, которая будет использоваться. Мультиархитектурные позволяет одного тега, которое будет использоваться в нескольких конфигурациях компьютера. К примеру, с мультиархитектурного, можно использовать один обычный тег: **microsoft/dotnet:2.0.0-runtime**. Если этот тег из среды контейнеров Linux, запрашивать, вы получите образ на базе Debian. Если этот тег из среды контейнеров Windows, запрашивать, вы получите образов на основе Nano Server.

Для образов платформы .NET Framework так как в традиционном .NET Framework поддерживает только Windows, нельзя использовать функцию мультиархитектурные.

## <a name="windows-container-types"></a>Типы контейнеров Windows

Как и контейнеры Linux контейнеры Windows Server осуществляется с помощью подсистемы Docker. В отличие от контейнеров Linux контейнеры Windows включают два типа в другой контейнер или запустите раз Windows Server и изоляцию Hyper-V.

**Контейнеры Windows Server**: Обеспечивает изоляцию приложений благодаря изоляции процессов и пространств имен. Контейнер Windows Server использует ядро совместно с узлом контейнера и всех контейнеров, запущенных на узле. Эти контейнеры не предоставляют границу неблагоприятных безопасности и не следует использовать для изоляции ненадежного кода. Из-за пространство общего ядра эти контейнеры требуют той же версией ядра и конфигурации.

**Изоляцию Hyper-V**: Расширяет возможности изоляции по сравнению с контейнерами Windows Server, каждый контейнер запускается на виртуальной Машине высокой степенью оптимизации. В этой конфигурации ядро узла контейнера не используется совместно с другими контейнерами на одном узле. Эти контейнеры предназначены для неблагоприятных мультитенантных размещения, с тем же гарантии безопасности виртуальной машины. Поскольку эти контейнеры не используют ядро узла или других контейнеров на узле, они могут выполняться ядра с различными версиями и конфигурации (с поддерживаемой версии). Например все контейнеры Windows в Windows 10 используйте изоляцию Hyper-V использовать версию ядра Windows Server и конфигурации.

Запуск контейнера в Windows с или без изоляции Hyper-V является решением во время выполнения. Можно выбрать для первоначального создания контейнера с помощью изоляции Hyper-V и во время выполнения, решили запустить его как контейнер Windows Server.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Документация по контейнерам Windows**

    [https://docs.microsoft.com/virtualization/windowscontainers/](https://docs.microsoft.com/virtualization/windowscontainers/)

-   **Принципы работы контейнеров Windows**

    [https://docs.microsoft.com/virtualization/windowscontainers/about/](https://docs.microsoft.com/virtualization/windowscontainers/about/)

-   **Инфографика: Корпорация Майкрософт и контейнеры**

    [https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf](https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf)

## <a name="the-container-ecosystem-in-azure"></a>Экосистема контейнеров в Azure

В предыдущих разделах он были были изложены преимущества контейнеров Docker, а также сведения о образов контейнеров для конкретной для приложений .NET. Все, что к общим сведениям, — это основа для разработки или упаковать приложение в контейнер.
Тем не менее при рассмотрении в рабочей среде развертывания или даже среде разработки и тестирования и контроля Качества, Microsoft Azure предоставляет открытым и масштабными разнообразные варианты, экосистемы полный контейнеров в облаке (показано на схеме ниже). В зависимости от потребностей конкретного приложения следует выбрать один или другой продукт Azure.

![](./media/image7.5.png)

> **Рис. 4-7.5.** Экосистема контейнеров в Azure

В экосистеме контейнеров в Azure, следующие продукты поддерживаются контейнеры, которые считаются инфраструктуры:
-   **Экземпляры контейнеров Azure (ACI)**
-   **Виртуальные машины Azure** (с поддержкой контейнера)
-   **Масштабируемые наборы виртуальных машин Azure** (с поддержкой контейнера)

Из этих трех ACI предоставляет большие преимущества, который является тот факт, что не требуется для поддержания базовой операционной системы, нет необходимости автоматически обновлять и исправлять, т. д., но по-прежнему находится на уровне инфраструктуры, как лучше описано в следующих разделах настоящей книги ACI.

Продукты Azure вспомогательные контейнеров, которые находятся в то же время, более расположен в PaaS (платформа как услуга) уровне предназначены для:

-   **Служба приложений Azure**
-   **Служба Azure Kubernetes (AKS и ACS)**
-   **Azure Service Fabric** 
-   **Пакетная служба Azure** 

Затем реестр контейнеров Azure — это реестр высокой масштабируемой контейнера, размещенных в Azure, который можно использовать из всех предыдущих продуктов при регистрации и развертывания ваших образов настраиваемого контейнера.

Кроме того, из контейнеров, вы можете использовать другими управляемыми службами в Azure, таких как базы данных SQL Azure, кэш Redis для Azure, Azure Cosmos DB, и т.д. Кроме того, доступны сторонних решений и платформы в Azure Marketplace, например Cloud Foundry и OpenShift, где можно также использовать контейнеры в Azure. 

В следующих разделах вы можете изучить рекомендации корпорации Майкрософт о том, когда использовать каждый из этих продуктов и решений, специально ориентируясь на контейнеры Windows.

>[!div class="step-by-step"]
>[Назад](what-about-cloud-native-applications.md)
>[Вперед](when-not-to-deploy-to-windows-containers.md)