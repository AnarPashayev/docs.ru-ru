---
title: Разработка перечислений
ms.date: 10/22/2008
ms.technology: dotnet-standard
helpviewer_keywords:
- type design guidelines, enumerations
- simple enumerations
- enumerations [.NET Framework], design guidelines
- class library design guidelines [.NET Framework], enumerations
- flags enumerations
ms.assetid: dd53c952-9d9a-4736-86ff-9540e815d545
ms.openlocfilehash: 130e9b4e7f8d7076d1dc3f21f51dc07a68799bbe
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2020
ms.locfileid: "75709456"
---
# <a name="enum-design"></a>Разработка перечислений

Перечисления являются особым видом типа значения. Существует два вида перечислений: Простые перечисления и Флаговые перечисления.

Простые перечисления представляют небольшие закрытые наборы вариантов выбора. Распространенным примером простого перечисления является набор цветов.

Перечисление флагов предназначено для поддержки побитовых операций над значениями перечисления. Распространенным примером перечисления Flags является список параметров.

**✓ DO** использовать enum для строго типизированных параметров, свойств и возвращаемых значений, которые представляют собой наборы значений.

**✓ DO** предпочтительнее использовать вместо статических констант перечисления.

**X DO NOT** использовать enum для открытых наборов (например, версия операционной системы, имена друзьями, и т. д.).

**X DO NOT** предоставляют значения зарезервированных перечисления, которые предназначены для использования в будущем.

Вы всегда можете просто добавить значения к существующему перечислению на более позднем этапе. Дополнительные сведения о добавлении значений в перечисления см. в разделе [Добавление значений в перечисления](#add_value) . Зарезервированные значения просто засоряла набор реальных значений и обычно ведут к ошибкам пользователя.

**X AVOID** открытым доступом перечислений с только одним значением.

Распространенной практикой для обеспечения будущего расширяемости C API является добавление зарезервированных параметров в сигнатуры методов. Такие зарезервированные параметры могут быть выражены как перечисления с одним значением по умолчанию. Это не следует делать в управляемых API. Перегрузка метода позволяет добавлять параметры в будущих выпусках.

**X DO NOT** включать значения sentinel в перечислениях.

Хотя иногда они полезны разработчикам платформ, значения меток могут сбить с толку пользователей платформы. Они используются для отслеживания состояния перечисления, а не одного из значений набора, представленного перечислением.

**✓ DO** укажите значение 0 в простые перечисления.

Попробуйте вызвать значение, например "нет". Если такое значение не подходит для этого конкретного перечисления, то наиболее распространенному значению перечисления по умолчанию должно быть присвоено базовое значение, равное нулю.

**✓ CONSIDER** с помощью <xref:System.Int32> (по умолчанию в большинстве языков программирования) как базовый тип перечисления, если верно любое из следующих:

- Перечисление является перечислением Flags и имеет более 32 флагов или может быть больше в будущем.

- Базовый тип должен отличаться от <xref:System.Int32> для упрощения взаимодействия с неуправляемым кодом, ожидающим перечисления разного размера.

- Базовый тип меньшего размера приведет к значительному экономии пространства. Если предполагается, что перечисление будет использоваться в основном как аргумент для потока управления, размер делает незначительную разницу. Экономия размера может быть значительной, если:

  - Предполагается, что перечисление будет использоваться в качестве поля в очень часто создаваемой структуре или классе.

  - Предполагается, что пользователи будут создавать большие массивы или коллекции экземпляров перечисления.

  - Предполагается, что будет сериализовано большое количество экземпляров перечисления.

При использовании в памяти следует помнить, что управляемые объекты всегда `DWORD`ются по-разному, поэтому в экземпляре необходимо использовать несколько перечислений или другие небольшие структуры для упаковки меньшего перечислимого типа с целью создания разницы, так как общий размер экземпляра всегда будет округляться до `DWORD`.

**✓ DO** имя флага перечисления с множественного числа существительных и субстантивных словосочетаний и простые перечисления атрибутом существительные в единственном числе или субстантивные словосочетания.

**X DO NOT** расширить <xref:System.Enum?displayProperty=nameWithType> напрямую.

<xref:System.Enum?displayProperty=nameWithType> — это специальный тип, используемый средой CLR для создания определяемых пользователем перечислений. Большинство языков программирования предоставляют программный элемент, обеспечивающий доступ к этой функции. Например, в C# ключевом слове `enum` используется для определения перечисления.

<a name="design"></a>

### <a name="designing-flag-enums"></a>Разработка перечислений флагов

**✓ DO** применить <xref:System.FlagsAttribute?displayProperty=nameWithType> для перечислений флагов. Не применяйте этот атрибут к простым перечислениям.

**✓ DO** используют степень числа 2 для значений перечисления флагов, поэтому они могут быть свободно объединены с помощью битовой операции или.

**✓ CONSIDER** предоставляет специальные перечислимых значений для часто используется сочетание флагов.

Битовые операции являются сложной концепцией и не должны требоваться для простых задач. <xref:System.IO.FileAccess.ReadWrite> является примером такого специального значения.

**X AVOID** Создание перечисления флага, где определенные комбинации значений являются недопустимыми.

**X AVOID** с помощью флага нулевые значения перечисления, если значение представляет «все флаги сняты» и соответствующим образом, как предписано следующем правиле с именем.

**✓ DO** имя нулевое значение флага перечисления `None`. Для перечислимого типа значение всегда должно означать «все флаги сняты».

<a name="add_value"></a>

### <a name="adding-value-to-enums"></a>Добавление значения в перечисления

Очень часто обнаруживается, что необходимо добавить значения в перечисление после того, как вы уже отгрузили их. Существует потенциальная проблема совместимости приложений, когда вновь добавленное значение возвращается из существующего API, так как плохо написанные приложения могут неправильно работать с новым значением.

**✓ CONSIDER** Добавление значения перечислений, несмотря на риск совместимость небольших.

Если у вас есть реальные данные о несовместимости приложений, вызванные дополнениями к перечислению, рассмотрите возможность добавления нового API, возвращающего новые и устаревшие значения, и прекращения использования старого API, который должен возвращать только старые значения. Это обеспечит совместимость существующих приложений.

*Части © 2005, 2009 Корпорация Майкрософт. Все права защищены.*

*Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*

## <a name="see-also"></a>См. также:

- [Рекомендации по разработке типов](../../../docs/standard/design-guidelines/type.md)
- [Рекомендации по проектированию на основе Framework](../../../docs/standard/design-guidelines/index.md)
