---
title: Разработка конструктора
ms.date: 10/22/2008
ms.technology: dotnet-standard
helpviewer_keywords:
- member design guidelines, constructors
- constructors, design guidelines
- instance constructors
- type constructors
- virtual members
- constructors, types
- parameterless constructors
- static constructors
ms.assetid: b4496afe-5fa7-4bb0-85ca-70b0ef21e6fc
ms.openlocfilehash: 7ab795cd4c6e0ff5e1451c05987848c41bd69577
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76741733"
---
# <a name="constructor-design"></a>Разработка конструктора

Существует два вида конструкторов: конструкторы типов и конструкторы экземпляров.

Конструкторы типов являются статическими и выполняются средой CLR перед использованием типа. Конструкторы экземпляров запускаются при создании экземпляра типа.

Конструкторы типов не могут принимать параметры. Конструкторы экземпляров могут. Конструкторы экземпляров, которые не принимают параметры, часто называются конструкторами без параметров.

Конструкторы — это наиболее естественный способ создания экземпляров типа. Большинство разработчиков будут искать и пытаться использовать конструктор, прежде чем они рассчитают альтернативные способы создания экземпляров (например, фабричные методы).

✔️ Рассмотрите возможность предоставления простых, идеально используемых по умолчанию конструкторов.

Простой конструктор имеет очень небольшое количество параметров, и все параметры являются примитивами или перечислениями. Такие простые конструкторы увеличивают удобство использования платформы.

✔️ РЕКОМЕНДУЕТСЯ использовать статический фабричный метод вместо конструктора, если семантика требуемой операции не сопоставляется непосредственно с построением нового экземпляра или если следовать рекомендациям по проектированию конструктора, которые не являются естественными.

✔️ использовать параметры конструктора в качестве сочетаний клавиш для задания основных свойств.

В семантике между использованием пустого конструктора, за которым следуют некоторые наборы свойств, и использование конструктора с несколькими аргументами не должно быть различий.

✔️ использовать одно и то же имя для параметров конструктора и свойство, если параметры конструктора используются для просто установки свойства.

Единственное различие между такими параметрами и свойствами должно быть в регистре.

✔️ ВЫПОЛНИТЬ минимальную работу в конструкторе.

Конструкторы не должны выполнять много операций, кроме сбора параметров конструктора. Стоимость любой другой обработки должна быть отложена до необходимости.

✔️ Вызывайте исключения из конструкторов экземпляров, если это уместно.

✔️ явно объявите открытый конструктор без параметров в классах, если такой конструктор является обязательным.

Если вы не объявили явно какие-либо конструкторы в типе, многие языки ( C#такие как) автоматически добавляют открытый конструктор без параметров. (Абстрактные классы получают защищенный конструктор.)

Добавление параметризованного конструктора в класс не позволяет компилятору добавлять конструктор без параметров. Это часто приводит к случайным критическим изменениям.

❌ избежать явного определения конструкторов без параметров для структур.

Это делает создание массива быстрее, так как если конструктор без параметров не определен, он не должен выполняться в каждом слоте массива. Обратите внимание, что многие компиляторы, включая C#, не разрешают структурам использовать конструкторы без параметров по этой причине.

❌ избежать вызова виртуальных членов для объекта внутри его конструктора.

Вызов виртуального члена приведет к вызову наиболее производного переопределения, даже если конструктор самого производного типа еще не был полностью запущен.

## <a name="type-constructor-guidelines"></a>Рекомендации по конструктору типов

✔️ сделать статические конструкторы частными.

Статический конструктор, также называемый конструктором класса, используется для инициализации типа. Среда CLR вызывает статический конструктор перед созданием первого экземпляра типа или вызовом любых статических членов этого типа. Пользователь не может управлять при вызове статического конструктора. Если статический конструктор не является закрытым, он может быть вызван кодом, отличным от CLR. В зависимости от операций, выполняемых в конструкторе, это может привести к непредвиденному поведению. C# Компилятор принудительно применяет к закрытию статические конструкторы.

❌ не вызывайте исключения из статических конструкторов.

Если исключение создается из конструктора типов, этот тип не может использоваться в текущем домене приложения.

✔️ Рассмотрите возможность инициализации статических полей встроенным способом, а не явно используя статические конструкторы, так как среда выполнения может оптимизировать производительность типов, у которых нет явно определенного статического конструктора.

*Части © 2005, 2009 Корпорация Майкрософт. Все права защищены.*

*Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*

## <a name="see-also"></a>См. также:

- [Правила разработки членов](../../../docs/standard/design-guidelines/member.md)
- [Рекомендации по проектированию на основе Framework](../../../docs/standard/design-guidelines/index.md)
