---
title: Разработка конструктора
ms.date: 10/22/2008
ms.technology: dotnet-standard
helpviewer_keywords:
- member design guidelines, constructors
- constructors, design guidelines
- instance constructors
- type constructors
- virtual members
- constructors, types
- parameterless constructors
- static constructors
ms.assetid: b4496afe-5fa7-4bb0-85ca-70b0ef21e6fc
ms.openlocfilehash: 823bc893c9384bb687e5f9a196abe497db14f4db
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2020
ms.locfileid: "75709482"
---
# <a name="constructor-design"></a>Разработка конструктора

Существует два вида конструкторов: конструкторы типов и конструкторы экземпляров.

Конструкторы типов являются статическими и выполняются средой CLR перед использованием типа. Конструкторы экземпляров запускаются при создании экземпляра типа.

Конструкторы типов не могут принимать параметры. Конструкторы экземпляров могут. Конструкторы экземпляров, которые не принимают параметры, часто называются конструкторами без параметров.

Конструкторы — это наиболее естественный способ создания экземпляров типа. Большинство разработчиков будут искать и пытаться использовать конструктор, прежде чем они рассчитают альтернативные способы создания экземпляров (например, фабричные методы).

**✓ CONSIDER** предоставляет простой, в идеальном случае по умолчанию, конструкторы.

Простой конструктор имеет очень небольшое количество параметров, и все параметры являются примитивами или перечислениями. Такие простые конструкторы увеличивают удобство использования платформы.

**✓ CONSIDER** вместо статический фабричный метод конструктора, если семантика требуемой операции не сопоставляются непосредственно конструкцию нового экземпляра или следующие рекомендации по разработке конструктора неприменимыми.

**✓ DO** используйте параметры конструкторов как ярлыки для установки значений основных свойств.

В семантике между использованием пустого конструктора, за которым следуют некоторые наборы свойств, и использование конструктора с несколькими аргументами не должно быть различий.

**✓ DO** использовать то же имя для параметров конструктора и свойства, если параметры конструктора используются только для установки свойства.

Единственное различие между такими параметрами и свойствами должно быть в регистре.

**✓ DO** минимальных затрат в конструкторе.

Конструкторы не должны выполнять много операций, кроме сбора параметров конструктора. Стоимость любой другой обработки должна быть отложена до необходимости.

**✓ DO** вызывайте исключения из конструкторов экземпляров, если это необходимо.

**✓** Явным образом объявите открытый конструктор без параметров в классах, если такой конструктор является обязательным.

Если вы не объявили явно какие-либо конструкторы в типе, многие языки ( C#такие как) автоматически добавляют открытый конструктор без параметров. (Абстрактные классы получают защищенный конструктор.)

Добавление параметризованного конструктора в класс не позволяет компилятору добавлять конструктор без параметров. Это часто приводит к случайным критическим изменениям.

**X Избегайте** явного определения конструкторов без параметров для структур.

Это делает создание массива быстрее, так как если конструктор без параметров не определен, он не должен выполняться в каждом слоте массива. Обратите внимание, что многие компиляторы, включая C#, не разрешают структурам использовать конструкторы без параметров по этой причине.

**X AVOID** вызов виртуальные члены объекта внутри его конструктор.

Вызов виртуального члена приведет к вызову наиболее производного переопределения, даже если конструктор самого производного типа еще не был полностью запущен.

## <a name="type-constructor-guidelines"></a>Рекомендации по конструктору типов

**✓ DO** сделать частным статические конструкторы.

Статический конструктор, также называемый конструктором класса, используется для инициализации типа. Среда CLR вызывает статический конструктор перед созданием первого экземпляра типа или вызовом любых статических членов этого типа. Пользователь не может управлять при вызове статического конструктора. Если статический конструктор не является закрытым, он может быть вызван кодом, отличным от CLR. В зависимости от операций, выполняемых в конструкторе, это может привести к непредвиденному поведению. C# Компилятор принудительно применяет к закрытию статические конструкторы.

**X DO NOT** вызывайте исключения из статических конструкторов.

Если исключение создается из конструктора типов, этот тип не может использоваться в текущем домене приложения.

**✓ CONSIDER** Инициализация встроенного статических полей, а не явно с использованием статических конструкторов, так как среда выполнения может оптимизировать производительность типов, которые не являются явно определенного статического конструктора.

*Части © 2005, 2009 Корпорация Майкрософт. Все права защищены.*

*Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*

## <a name="see-also"></a>См. также:

- [Правила разработки членов](../../../docs/standard/design-guidelines/member.md)
- [Рекомендации по проектированию на основе Framework](../../../docs/standard/design-guidelines/index.md)
