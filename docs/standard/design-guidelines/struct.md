---
title: Разработка структур
ms.date: 10/22/2008
helpviewer_keywords:
- class library design guidelines [.NET Framework], structures
- deallocating structures
- allocating structures
- value types, structures
- structure design
- type design guidelines, structures
- structures [.NET Framework], design guidelines
ms.assetid: 1f48b2d8-608c-4be6-9ba4-d8f203ed9f9f
ms.openlocfilehash: 7bb7e63004df2eb7541ba8d4f1118ea2272db126
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/24/2020
ms.locfileid: "95730907"
---
# <a name="struct-design"></a>Разработка структур

Тип значения общего назначения чаще всего называется структурой, ключевым словом C#. В этом разделе приводятся рекомендации по проектированию общих структур.

 ❌ НЕ предоставляющих конструктор без параметров для структуры.

 После этого правила можно создавать массивы структур без необходимости запуска конструктора для каждого элемента массива. Обратите внимание, что C# не допускает, чтобы структуры имели конструкторы без параметров.

 ❌ НЕ определяйте изменяемые типы значений.

 У изменяемых типов значений есть несколько проблем. Например, когда метод считывания свойства возвращает тип значения, вызывающий объект получает копию. Поскольку копия создается неявным образом, разработчики могут не знать, что они изменяют копию, а не исходное значение. Кроме того, некоторые языки (динамические языки, в частности) имеют проблемы с использованием изменяемых типов значений, так как даже локальные переменные при разыменовании приводят к созданию копии.

 ✔️ обеспечить допустимость состояния, в котором все данные экземпляра имеют нулевое значение, false или null (при необходимости).

 Это предотвращает случайное создание недопустимых экземпляров при создании массива структур.

 ✔️ реализовать <xref:System.IEquatable%601> типы значений.

 <xref:System.Object.Equals%2A?displayProperty=nameWithType>Метод для типов значений вызывает упаковку и ее реализацию по умолчанию не очень эффективна, так как использует отражение. <xref:System.IEquatable%601.Equals%2A> может иметь гораздо более высокую производительность и может быть реализовано таким образом, что он не будет вызывать упаковку.

 ❌ НЕ расширяйте явно <xref:System.ValueType> . На самом деле, большинство языков препятствуют этому.

 Как правило, структуры могут быть очень полезными, но их следует использовать только для небольших, однострочных неизменяемых значений, которые не будут часто выдаваться в штучной упаковке.

 *Части © 2005, 2009 Корпорация Майкрософт. Все права защищены.*

 *Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*

## <a name="see-also"></a>См. также раздел

- [Рекомендации по проектированию типов](type.md)
- [Рекомендации по проектированию платформы](index.md)
- [Выбор между классом и структурой](choosing-between-class-and-struct.md)
