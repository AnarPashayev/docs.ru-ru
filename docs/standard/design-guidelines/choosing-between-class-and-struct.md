---
title: Выбор между классом и структурой
ms.date: 10/22/2008
ms.technology: dotnet-standard
helpviewer_keywords:
- class library design guidelines [.NET Framework], structures
- class library design guidelines [.NET Framework], classes
- structures [.NET Framework], vs. classes
- classes [.NET Framework], design guidelines
- type design guidelines, structures
- structures [.NET Framework], design guidelines
- classes [.NET Framework], vs. structures
- type design guidelines, classes
ms.assetid: f8b8ec9b-0ba7-4dea-aadf-a93395cd804f
ms.openlocfilehash: 76042bef1475f2fdf14e309390dcba6654ccfaa9
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76741747"
---
# <a name="choosing-between-class-and-struct"></a>Выбор между классом и структурой
Одним из основных решений по проектированию каждого разработчика инфраструктуры является необходимость разрабатывать тип как класс (ссылочный тип) или как структура (тип значения). Чтобы сделать это, важно понимать различия в поведении ссылочных типов и типов значений.

 Первое различие между ссылочными типами и типами значений, которое мы будем рассматривать, заключается в том, что ссылочные типы выделяются в куче и уничтожаются сборщиком мусора, тогда как типы значений выделяются либо в стеке, либо в виде встроенных строк, содержащих типы, и освобождаются, когда стек очищается или когда их вмещающий тип освобождается. Таким образом, выделение и освобождение типов значений являются общими дешевле, чем выделение и освобождение ссылочных типов.

 Затем массивы ссылочных типов выделяются вне строки, что означает, что элементы массива являются просто ссылками на экземпляры ссылочного типа, находящегося в куче. Массивы типов значений выделяются встроенным, то есть элементы массива являются реальными экземплярами типа значения. Таким образом, выделение и освобождение массивов типов значений значительно дешевле, чем выделение и освобождение массивов ссылочного типа. Кроме того, в большинстве случаев массивы типов значений представляют гораздо более высокий уровень локализации ссылок.

 Следующее отличие связано с использованием памяти. Типы значений упаковываются при приведении к ссылочному типу или к одному из интерфейсов, которые они реализуют. Они будут распакованы при приведении обратно к типу значения. Так как поля представляют собой объекты, выделенные в куче и собираемые сборщиком мусора, слишком много упаковки и распаковки могут негативно повлиять на кучу, сборщик мусора и в конечном итоге производительность приложения.  В отличие от этого, такая упаковка не происходит, так как ссылочные типы являются приведенными. (Дополнительные сведения см. в разделе [Упаковка и распаковка](../../csharp/programming-guide/types/boxing-and-unboxing.md)).

 Затем назначения ссылочного типа копируют ссылку, тогда как назначения типа значения копируют все значение. Таким образом, присваивания больших ссылочных типов дешевле, чем присваивания типов больших значений.

 Наконец, ссылочные типы передаются по ссылке, тогда как типы значений передаются по значению. Изменения в экземпляр ссылочного типа влияют на все ссылки, указывающие на экземпляр. Экземпляры типа значения копируются, когда они передаются по значению. При изменении экземпляра типа значения это само по себе не влияет на его копии. Поскольку копии не создаются явным образом пользователем, но неявно создаются при передаче аргументов или возвращении возвращаемых значений, типы значений, которые могут быть изменены, могут вызвать путаницу для многих пользователей. Поэтому типы значений должны быть неизменяемыми.

 Как правило, большинство типов в платформе должны быть классами. Однако существуют ситуации, в которых характеристики типа значения делают более подходящим использование структур.

 ✔️ Рассмотрите возможность определения структуры вместо класса, если экземпляры типа небольшие и часто используются кратковременно или обычно внедряются в другие объекты.

 ❌ избежать определения структуры, если тип имеет не все приведенные ниже характеристики.

- Он логически представляет одно значение, аналогично примитивным типам (`int`, `double`и т. д.).

- Он имеет размер экземпляра менее 16 байт.

- Это неизменяемое.

- Он не должен быть часто в штучной упаковке.

 Во всех остальных случаях типы следует определять как классы.

 *Части © 2005, 2009 Корпорация Майкрософт. Все права защищены.*

 *Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*

## <a name="see-also"></a>См. также:

- [Рекомендации по разработке типов](../../../docs/standard/design-guidelines/type.md)
- [Рекомендации по проектированию на основе Framework](../../../docs/standard/design-guidelines/index.md)
