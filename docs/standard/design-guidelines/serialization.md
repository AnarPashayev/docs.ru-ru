---
title: Serialization1
ms.date: 10/22/2008
ms.technology: dotnet-standard
ms.assetid: bebb27ac-9712-4196-9931-de19fc04dbac
author: KrzysztofCwalina
ms.openlocfilehash: f0ef8ab378fb3898f2d2e134f0b38668f6794ef3
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61650158"
---
# <a name="serialization"></a>Сериализация
Сериализацией называется процесс преобразования объекта в формат, который можно легко сохранять или передавать. Например можно сериализовать объект, передать его по Интернету с помощью протокола HTTP, а также десериализовать его на целевой машине.  
  
 .NET Framework предусматривает три основные технологии сериализации оптимизированные для различных сценариев. В следующей таблице описаны эти технологии, а также связанные с ними основные типы Framework.  
  
|**Имя технологии**|**Основные типы**|**Сценарии**|  
|-------------------------|--------------------|-------------------|  
|**Сериализация контрактов данных**|<xref:System.Runtime.Serialization.DataContractAttribute> <br /> <xref:System.Runtime.Serialization.DataMemberAttribute> <br /> <xref:System.Runtime.Serialization.DataContractSerializer> <br /> <xref:System.Runtime.Serialization.NetDataContractSerializer> <br /> <xref:System.Runtime.Serialization.Json.DataContractJsonSerializer> <br /> <xref:System.Runtime.Serialization.ISerializable>|Общее сохранение<br />Веб-службы<br />JSON|  
|**XML-сериализации**|<xref:System.Xml.Serialization.XmlSerializer>|Формат XML с возможностью полного контроля над формой XML|  
|**Сериализация во время выполнения (двоичная и SOAP)**|<xref:System.SerializableAttribute> <br /> <xref:System.Runtime.Serialization.ISerializable> <br /> <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> <br /> <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter>|Удаленное взаимодействие .NET|  
  
 **✓ DO** Вспомните сериализации при разработке новых типов.  
  
## <a name="choosing-the-right-serialization-technology-to-support"></a>Правильный выбор сериализации для поддержки  
 **✓ CONSIDER** поддержки сериализации контракта данных, если экземпляры этого типа, может потребоваться сохранить или использовать в веб-службы.  
  
 **✓ CONSIDER** поддержка XML-сериализации вместо или в дополнение к сериализации контракта данных, если требуется больший контроль над форматом XML, который создается при сериализации типа.  
  
 Это может потребоваться некоторые взаимодействия, создания сценариев, где необходимо использовать XML, которые не поддерживается при сериализации контракта данных, например, для создания XML-атрибуты.  
  
 **✓ CONSIDER** поддерживающий сериализацию во время выполнения, если экземпляров типа проходить через границы удаленного взаимодействия .NET.  
  
 **X AVOID** поддерживающий сериализацию во время выполнения или XML-сериализации только в целях общие сохраняемости. Вместо этого использовать сериализацию контракта данных.  
  
## <a name="supporting-data-contract-serialization"></a>Поддержка сериализации контракта данных  
 Типы могут поддерживать сериализацию контракта данных, применяя <xref:System.Runtime.Serialization.DataContractAttribute> к типу и <xref:System.Runtime.Serialization.DataMemberAttribute> к элементам (полям и свойствам) типа.  
  
 **✓ CONSIDER** пометить тип общедоступные элементы данных, если тип можно использовать в режиме частичного доверия.  
  
 С полным доверием сериализаторы контрактов данных обеспечивает сериализацию и десериализацию закрытых типах и членах, но только открытые члены можно сериализовать и десериализовать в режиме частичного доверия.  
  
 **✓ DO** реализовать Get и set для всех свойств, имеющих <xref:System.Runtime.Serialization.DataMemberAttribute>. Сериализаторы контрактов данных требуется метод считывания и метод задания значения тип считается сериализуемым. (В .NET Framework 3.5 SP1, некоторые свойства коллекции может быть только для чтения.) Если тип не будет использоваться в среде с частичным доверием, то один или несколько методов доступа к свойству могут быть закрытыми.  
  
 **✓ CONSIDER** с помощью обратные вызовы сериализации для инициализации десериализованный экземпляров.  
  
 При десериализации объектов конструкторы не вызываются. (Существуют исключения из правила. Конструкторы коллекций, отмеченные <xref:System.Runtime.Serialization.CollectionDataContractAttribute> вызываются во время десериализации.) Таким образом любая логика, выполняемая при нормальном построении должна быть реализована как один из обратных вызовов сериализации.  
  
 `OnDeserializedAttribute` — Это наиболее часто используемым атрибутом обратного вызова. Кроме того, в семейство входят атрибуты <xref:System.Runtime.Serialization.OnDeserializingAttribute>, <xref:System.Runtime.Serialization.OnSerializingAttribute> и <xref:System.Runtime.Serialization.OnSerializedAttribute>. Их можно использовать для пометки обратных вызовов, которые выполняются перед десериализацией, перед сериализацией и после сериализации соответственно.  
  
 **✓ CONSIDER** с помощью <xref:System.Runtime.Serialization.KnownTypeAttribute> для указания конкретных типов, которые должны использоваться при десериализации графа сложного объекта.  
  
 **✓ DO** рассмотрите возможность прямой и обратной совместимости при создании или изменении сериализуемые типы.  
  
 Необходимо помнить, что сериализуемые потоки будущих версий типа могут быть десериализованы в текущую версию типа и наоборот.  
  
 Убедитесь, что вы понимаете, что данные-члены, даже закрытые и внутренние, невозможно изменить их имена, типы или даже свой порядок в будущих версиях типов, если предприняты специальные меры для сохранения контракта с помощью явных параметров атрибутов контракта данных .  
  
 Проверьте совместимость сериализации, при внесении изменений в сериализуемые типы. Попробуйте десериализовать новую версию в предыдущую и наоборот.  
  
 **✓ CONSIDER** реализации <xref:System.Runtime.Serialization.IExtensibleDataObject> разрешающее полной совместимости между различными версиями типа.  
  
 Интерфейс дает сериализатору гарантию отсутствия потерь данных при выполнении циклов обработки значений. <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A?displayProperty=nameWithType> Свойство используется для хранения любых данных из будущей версии типа, неизвестные в текущей версии, и поэтому его нельзя хранить в элементах данных. Если текущая версия затем сериализуется и десериализуется в более позднюю, дополнительные данные будут доступны в сериализованном потоке.  
  
## <a name="supporting-xml-serialization"></a>Поддержка XML-сериализации  
 Сериализация контрактов данных является основной (по умолчанию) технологией сериализации в .NET Framework, однако существуют сценарии сериализации, сериализации контракта данных не поддерживает. Например, она не обеспечивает полный контроль над формой XML-кода, создаваемого или используемого сериализатором. Если необходим столь высокий уровень контроля, XML-сериализации должен использоваться, и вам нужно разработав типы для поддержки этой технологии сериализации.  
  
 **X AVOID** полученных проектирование к типам специально для сериализации XML, если нет очень сильный причины для контроля формы XML. Эта технология сериализации была заменена сериализацией контракта данных, описанной в предыдущем разделе.  
  
 **✓ CONSIDER** реализации <xref:System.Xml.Serialization.IXmlSerializable> интерфейс, если требуется, чтобы еще больше возможностей контроля формы сериализованного XML чем предлагаемый путем применения атрибутов XML-сериализации. Два метода интерфейса, <xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> и <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A>, позволяют полностью управлять сериализованного потока XML. Вы также можете управлять схемой XML, которая создается для типа, применяя `XmlSchemaProviderAttribute`.  
  
## <a name="supporting-runtime-serialization"></a>Поддержка сериализации во время выполнения  
 Сериализация во время выполнения — это технология, используемую при удаленном взаимодействии .NET. Если вы считаете, что типы передаются с помощью удаленного взаимодействия .NET, необходимо убедиться, что они поддерживают сериализацию во время выполнения.  
  
 Базовая поддержка сериализации во время выполнения может быть обеспечена с помощью атрибута <xref:System.SerializableAttribute>, и более сложных сценариях выполняется реализация простого шаблона сериализации среды выполнения (реализации <xref:System.Runtime.Serialization.ISerializable> и обеспечение конструктора сериализации).  
  
 **✓ CONSIDER** поддерживающий сериализацию во время выполнения, если к типам, которые будут использоваться при удаленном взаимодействии .NET. Например <xref:System.AddIn?displayProperty=nameWithType> пространства имен используется удаленное взаимодействие .NET и поэтому все типы, передаваемые между `System.AddIn` надстройки должны поддерживать сериализацию во время выполнения.  
  
 **✓ CONSIDER** реализации шаблона сериализуемые среды выполнения, если требуется полный контроль над процессом сериализации. Например, в том случае, когда необходимо преобразовать сериализуемые или десериализуемые данные.  
  
 Шаблон очень прост. Нужно всего лишь реализовать интерфейс <xref:System.Runtime.Serialization.ISerializable> и предусмотреть специальный конструктор, который будет использоваться при десериализации объекта.  
  
 **✓ DO** защищенный конструктор сериализации и предоставляют два параметра типизированных и именованных точно так, как показано в примере ниже.  
  
```csharp
[Serializable]  
public class Person : ISerializable
{  
    protected Person(SerializationInfo info, StreamingContext context)
    {  
        // ...  
    }  
}  
```
  
 **✓ DO** реализовать <xref:System.Runtime.Serialization.ISerializable> члены явным образом.  
  
 **✓ DO** запрос компоновки, чтобы применить <xref:System.Runtime.Serialization.ISerializable.GetObjectData%2A?displayProperty=nameWithType> реализации. Это гарантирует, что только полностью доверенный сериализатор и core имеют доступ к члену.  
  
 *Фрагменты: © Корпорация Майкрософт (Microsoft Corporation), 2005, 2009. Все права защищены.*  
  
 *Перепечатано разрешением Пирсона для образовательных учреждений, Inc. из [рекомендации по разработке Framework: Условные обозначения, стили и шаблоны для библиотеки .NET для повторного использования, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) Кшиштов Квалина и Брэд Абрамс, опубликованных 22 октября 2008 г., издательство Addison-Wesley Professional как части цикла разработки Microsoft Windows.*  
  
## <a name="see-also"></a>См. также

- [Рекомендации по проектированию на основе Framework](../../../docs/standard/design-guidelines/index.md)
- [Правила использования](../../../docs/standard/design-guidelines/usage-guidelines.md)
