---
title: Создание исключений
ms.date: 10/22/2008
helpviewer_keywords:
- exceptions, throwing
- explicitly throwing exceptions
- throwing exceptions, design guidelines
ms.assetid: 5388e02b-52f5-460e-a2b5-eeafe60eeebe
ms.openlocfilehash: 6f22878a9ddfb394f6705a335930ef2cc270895f
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "94821272"
---
# <a name="exception-throwing"></a>Создание исключений
Рекомендации по генерации исключений, описанные в этом разделе, занимают хорошее определение значения сбоя при выполнении. Сбой выполнения происходит каждый раз, когда член не может сделать то, что он был разработан (что подразумевает имя члена). Например, если `OpenFile` метод не может вернуть открытый обработчик файла вызывающему объекту, это будет считаться ошибкой при выполнении.

 Большинство разработчиков хорошо знакомы с использованием исключений для ошибок использования, таких как деление на ноль или ссылки со значением NULL. В платформе исключения используются для всех условий ошибок, включая ошибки выполнения.

 ❌ НЕ возвращайте коды ошибок.

 Исключения являются основным средством формирования отчетов об ошибках в платформах.

 ✔️ сообщать об ошибках выполнения, вызывая исключения.

 ✔️ Рассмотрите возможность завершения процесса, вызвав `System.Environment.FailFast` (.NET Framework 2,0), а не вызывая исключение, если в коде возникает ситуация, когда она является ненадежной для дальнейшего выполнения.

 ❌ НЕ используйте исключения для обычного потока управления, если это возможно.

 За исключением системных сбоев и операций с потенциальными состояниями гонки, конструкторы платформы должны проектировать интерфейсы API, чтобы пользователи могли писать код, который не создает исключения. Например, можно предоставить способ проверки предварительных условий перед вызовом члена, чтобы пользователи могли написать код, который не создает исключения.

 Элемент, используемый для проверки предусловий другого элемента, часто называется тест-инженером, а член, фактически выполняющий работу, называется злодея.

 Бывают случаи, когда шаблон Tester-Doer может иметь неприемлемые затраты на производительность. В таких случаях следует учитывать так называемый шаблон Try-Parse (Дополнительные сведения см. в разделе [исключения и производительность](exceptions-and-performance.md) ).

 ✔️ Рассмотрите последствия возникновения исключений в производительности. Скорости создания свыше 100 в секунду, скорее всего, заметно повлияют на производительность большинства приложений.

 ✔️ Задокументируйте все исключения, вызванные публичными вызываемыми членами, из-за нарушения контракта члена (а не системного сбоя) и их интерпретации в рамках контракта.

 Исключения, которые являются частью контракта, не должны изменяться от одной версии к следующей (т. е. тип исключения не должен изменяться, а новые исключения не должны добавляться).

 ❌ НЕ следует иметь открытые члены, которые могут создавать или не использовать ни один из параметров.

 ❌ НЕ имеют открытых членов, возвращающих исключения в качестве возвращаемого значения или `out` параметра.

 Возвращение исключений из общедоступных API, а не их создание, не нарушает многие преимущества отчетов об ошибках на основе исключений.

 ✔️ Рассмотрите возможность использования методов построителя исключений.

 Часто возникает исключение из разных мест. Чтобы избежать чрезмерного использования кода, используйте вспомогательные методы, которые создают исключения и инициализируют их свойства.

 Кроме того, члены, которые создают исключения, не получают встроенные. Перемещение инструкции Throw в построителе может привести к встраиванию элемента.

 ❌ НЕ создавайте исключения из блоков фильтра исключений.

 Если фильтр исключений вызывает исключение, исключение перехватывается средой CLR, а фильтр возвращает значение false. Это поведение не различается в результате применения фильтра и возвращает значение false явным образом и, следовательно, очень сложно отлаживать.

 ❌ Избегайте явной генерации исключений из блоков finally. Неявные исключения создаются в результате вызова вызывающих методов, которые являются приемлемыми.

 *Части © 2005, 2009 Корпорация Майкрософт. Все права защищены.*

 *Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*

## <a name="see-also"></a>См. также статью

- [Рекомендации по проектированию платформы](index.md)
- [Правила разработки исключений](exceptions.md)
