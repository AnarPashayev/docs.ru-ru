---
title: Рекомендации по бессерверной архитектуры ― Бессерверных приложений
description: Понимание проблем разработки бессерверных приложений, управление состоянием и постоянное хранилище, чтобы масштабировать, ведения журнала, трассировки и диагностики.
author: JEREMYLIKNESS
ms.author: jeliknes
ms.date: 06/26/2018
ms.openlocfilehash: b12a09c0fcef7e7ff954a3f959fb9e3080a6e859
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61940950"
---
# <a name="serverless-architecture-considerations"></a><span data-ttu-id="ae7bb-103">Рекомендации по бессерверной архитектуре</span><span class="sxs-lookup"><span data-stu-id="ae7bb-103">Serverless architecture considerations</span></span>

<span data-ttu-id="ae7bb-104">Внедрение бессерверной архитектуры поставляются с определенными задачами.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-104">Adopting a serverless architecture does come with certain challenges.</span></span> <span data-ttu-id="ae7bb-105">В этом разделе рассматриваются некоторые из наиболее типичные аспекты, которые следует учитывать.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-105">This section explores some of the more common considerations to be aware of.</span></span> <span data-ttu-id="ae7bb-106">Все эти проблемы имеют решения.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-106">All of these challenges have solutions.</span></span> <span data-ttu-id="ae7bb-107">Как и для всех вариантов архитектуры, решение для перехода на бессерверные технологии должен принимать только после тщательной проверки преимущества и недостатки.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-107">As with all architecture choices, the decision to go serverless should be made only after carefully considering the pros and cons.</span></span> <span data-ttu-id="ae7bb-108">В зависимости от потребностей вашего приложения можно решить, что бессерверной реализации не подходящим решением для определенных компонентов.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-108">Depending on the needs of your application, you may decide a serverless implementation isn't the right solution for certain components.</span></span>

## <a name="managing-state"></a><span data-ttu-id="ae7bb-109">Управление состоянием</span><span class="sxs-lookup"><span data-stu-id="ae7bb-109">Managing state</span></span>

<span data-ttu-id="ae7bb-110">Бессерверные функции, как и в случае с микрослужбами в целом, не имеют состояния по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-110">Serverless functions, as with microservices in general, are stateless by default.</span></span> <span data-ttu-id="ae7bb-111">Использования состояние позволяет без сервера является реальным, масштабировать и для обеспечения устойчивости без центральную точку сбоя.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-111">Avoiding state enables serverless to be ephemeral, to scale out, and to provide resiliency without a central point of failure.</span></span> <span data-ttu-id="ae7bb-112">В некоторых случаях бизнес-процессы требуют состояния.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-112">In some circumstances, business processes require state.</span></span> <span data-ttu-id="ae7bb-113">Если процесс требует состояние, можно двумя способами.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-113">If your process requires state, you have two options.</span></span> <span data-ttu-id="ae7bb-114">Можно внедрить модель, отличный от бессерверных или взаимодействия с отдельная служба, которая предоставляет состояние.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-114">You can adopt a model other than serverless, or interact with a separate service that provides state.</span></span> <span data-ttu-id="ae7bb-115">Добавление состояния может усложнить решение и усложнить масштабирования и потенциально создать единую точку отказа.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-115">Adding state can complicate the solution and make it harder to scale, and potentially create a single point of failure.</span></span> <span data-ttu-id="ae7bb-116">Внимательно рассмотрите, требуется ли функции абсолютно состояния.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-116">Carefully consider whether your function absolutely requires state.</span></span> <span data-ttu-id="ae7bb-117">Если вы ответили «Да», определяют ли по-прежнему имеет смысл для его реализации благодаря бессерверной архитектуре.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-117">If the answer is "yes," determine whether it still makes sense to implement it with serverless.</span></span>

<span data-ttu-id="ae7bb-118">Существует несколько решения для использования состоянии без ущерба для преимущества бессерверных приложений.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-118">There are several solutions to adopt state without compromising the benefits of serverless.</span></span> <span data-ttu-id="ae7bb-119">Ниже перечислены некоторые из наиболее популярных решений.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-119">Some of the more popular solutions include:</span></span>

* <span data-ttu-id="ae7bb-120">Использовать временное хранилище данных или распределенного кэша, например Redis</span><span class="sxs-lookup"><span data-stu-id="ae7bb-120">Use a temporary data store or distributed cache, like Redis</span></span>
* <span data-ttu-id="ae7bb-121">Store состояния в базе данных, например SQL или CosmosDB</span><span class="sxs-lookup"><span data-stu-id="ae7bb-121">Store state in a database, like SQL or CosmosDB</span></span>
* <span data-ttu-id="ae7bb-122">Обработки состояния через механизм рабочих процессов, таких как устойчивые функции</span><span class="sxs-lookup"><span data-stu-id="ae7bb-122">Handle state through a workflow engine like durable functions</span></span>

<span data-ttu-id="ae7bb-123">Суть в том, что следует иметь в виду необходим для любой управления состоянием, в рамках процессов, которые вы решили реализовать благодаря бессерверной архитектуре.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-123">The bottom line is that you should be aware of the need for any state management within processes you're considering to implement with serverless.</span></span>

## <a name="long-running-processes"></a><span data-ttu-id="ae7bb-124">Длительно выполняемых процессов</span><span class="sxs-lookup"><span data-stu-id="ae7bb-124">Long-running processes</span></span>

<span data-ttu-id="ae7bb-125">Многие преимущества бессерверных полагаться на временные процессах.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-125">Many benefits of serverless rely on the processes being ephemeral.</span></span> <span data-ttu-id="ae7bb-126">Короткое время упрощают для бессерверной поставщика для высвобождения ресурсов, как функции окончания и общая папка на узлах.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-126">Short run times make it easier for the serverless provider to free up resources as functions end and share functions across hosts.</span></span> <span data-ttu-id="ae7bb-127">Большинство поставщиков облачных служб ограничить общее время выполнения функции для около 10 минут.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-127">Most cloud providers limit the total time your function can run to around 10 minutes.</span></span> <span data-ttu-id="ae7bb-128">Если процесс может занять больше времени, можно рассмотреть альтернативную реализацию.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-128">If your process may take longer, you might consider an alternative implementation.</span></span>

<span data-ttu-id="ae7bb-129">Существует несколько исключений и решений.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-129">There are a few exceptions and solutions.</span></span> <span data-ttu-id="ae7bb-130">Одним из решений может быть прервать процесс на более мелкие компоненты, которые по отдельности занять меньше времени на выполнение.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-130">One solution may be to break your process into smaller components that individually take less time to run.</span></span> <span data-ttu-id="ae7bb-131">Если процесс выполняется долго из-за зависимостей, можно также асинхронных рабочих процессов, с помощью такого решения, как устойчивых функций.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-131">If your process runs long because of dependencies, you can also consider an asynchronous workflow using a solution like durable functions.</span></span> <span data-ttu-id="ae7bb-132">Устойчивые функции приостанавливать и поддержания состояния вашего процесса, пока он ожидает завершения внешнего процесса.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-132">Durable functions pause and maintain the state of your process while it's waiting on an external process to finish.</span></span> <span data-ttu-id="ae7bb-133">Асинхронной обработки уменьшает время, в которой выполняется процесс.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-133">Asynchronous handling reduces the time the actual process runs.</span></span>

## <a name="startup-time"></a><span data-ttu-id="ae7bb-134">Время запуска</span><span class="sxs-lookup"><span data-stu-id="ae7bb-134">Startup time</span></span>

<span data-ttu-id="ae7bb-135">Одна из потенциальных проблем с бессерверной реализациями — время запуска.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-135">One potential concern with serverless implementations is startup time.</span></span> <span data-ttu-id="ae7bb-136">В целях экономии ресурсов, многие поставщики бессерверной Создание инфраструктуры «по требованию».</span><span class="sxs-lookup"><span data-stu-id="ae7bb-136">To conserve resources, many serverless providers create infrastructure "on demand."</span></span> <span data-ttu-id="ae7bb-137">При независимой от сервера функции активации после определенного периода времени, ресурсов для размещения функция может потребоваться создать или перезапуска.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-137">When a serverless function is triggered after a period of time, the resources to host the function may need to be created or restarted.</span></span> <span data-ttu-id="ae7bb-138">В некоторых ситуациях холодного запуска может привести к задержкам несколько секунд.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-138">In some situations, cold starts may result in delays of several seconds.</span></span> <span data-ttu-id="ae7bb-139">Время запуска различается поставщиков и уровни обслуживания.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-139">Startup time varies across providers and service levels.</span></span> <span data-ttu-id="ae7bb-140">Если важно свести к минимуму для успеха приложения существует несколько подходов к времени запуска адрес.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-140">There are a few approaches to address startup time if it's important to minimize for the success of the app.</span></span>

* <span data-ttu-id="ae7bb-141">Некоторые поставщики разрешают пользователям оплачивать уровни обслуживания, которые гарантируют, что инфраструктура находится в «always on».</span><span class="sxs-lookup"><span data-stu-id="ae7bb-141">Some providers allow users to pay for service levels that guarantee infrastructure is "always on".</span></span>
* <span data-ttu-id="ae7bb-142">Реализуйте механизм поддержания активности (проверка связи конечной точки для обеспечения его «переходит в спящий режим»).</span><span class="sxs-lookup"><span data-stu-id="ae7bb-142">Implement a keep-alive mechanism (ping the endpoint to keep it "awake").</span></span>
* <span data-ttu-id="ae7bb-143">Используйте оркестрации как Kubernetes с помощью подхода контейнерных функции (узел уже выполняется, развертывания новых экземпляров выполняется очень быстро).</span><span class="sxs-lookup"><span data-stu-id="ae7bb-143">Use orchestration like Kubernetes with a containerized function approach (the host is already running so spinning up new instances is extremely fast).</span></span>

## <a name="database-updates-and-migrations"></a><span data-ttu-id="ae7bb-144">Обновления базы данных и миграции</span><span class="sxs-lookup"><span data-stu-id="ae7bb-144">Database updates and migrations</span></span>

<span data-ttu-id="ae7bb-145">Преимуществом кода без сервера является то, что вы можете выпустить новые функции, без необходимости повторного развертывания всего приложения.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-145">An advantage of serverless code is that you can release new functions without having to redeploy the entire application.</span></span> <span data-ttu-id="ae7bb-146">Это преимущество могут стать недостаток, если существует реляционной базы данных.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-146">This advantage can become a disadvantage when there's a relational database involved.</span></span> <span data-ttu-id="ae7bb-147">Изменение схемы базы данных не трудно выполнить синхронизацию с обновлениями без сервера.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-147">Changes to database schemas are difficult to synchronize with serverless updates.</span></span> <span data-ttu-id="ae7bb-148">Дополнительные сложности предназначена, когда что-то пошло, и необходимо выполнить откат изменений.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-148">Additional challenges are posed when things go wrong and the changes must be rolled back.</span></span> <span data-ttu-id="ae7bb-149">Целостность данных — одна из причин для микрослужб и бессерверных функций рекомендуется что у них есть свои собственные данные.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-149">Data integrity is one reason that a best practice for microservices and serverless functions is that they own their own data.</span></span> <span data-ttu-id="ae7bb-150">Это позволяет развертывать изменения как единое целое вычислительных ресурсов и данных.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-150">It is possible to deploy changes as a single unit of compute and data.</span></span> <span data-ttu-id="ae7bb-151">Реальность состоит в том, что во многих системах предыдущих версий компонентов больших серверной базы данных, которые должны быть согласованы с помощью бессерверной архитектуры.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-151">The reality is that many legacy systems feature a large back-end database that must be reconciled with the serverless architecture.</span></span>

<span data-ttu-id="ae7bb-152">Популярный подход для решения управления версиями схемы — никогда не изменяйте существующие свойства и столбцы, а также добавить новые данные.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-152">A popular approach to solve schema versioning is to never modify existing properties and columns, but instead add new information.</span></span> <span data-ttu-id="ae7bb-153">Например, рассмотрим изменение для перемещения из логического значения «завершено» флаг для todo list для «Дата завершения».</span><span class="sxs-lookup"><span data-stu-id="ae7bb-153">For example, consider a change to move from a Boolean "completed" flag for a todo list to a "completed date."</span></span> <span data-ttu-id="ae7bb-154">Вместо удаления старого поля, изменение базы данных выполняются следующие действия:</span><span class="sxs-lookup"><span data-stu-id="ae7bb-154">Instead of removing the old field, the database change will:</span></span>

1. <span data-ttu-id="ae7bb-155">Добавьте поле нового «Дата завершения».</span><span class="sxs-lookup"><span data-stu-id="ae7bb-155">Add a new "completed date" field.</span></span>
1. <span data-ttu-id="ae7bb-156">Преобразование «завершено» логическое поле для вычисляемой функции, который определяет, является ли дата завершения после текущей даты.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-156">Transform the "completed" Boolean field to a computed function that evaluates whether the completed date is after the current date.</span></span>
1. <span data-ttu-id="ae7bb-157">Добавление триггера для установки завершенного даты до текущей даты, когда задано значение завершенного логическое значение в значение true.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-157">Add a trigger to set the completed date to the current date when the completed Boolean is set to true.</span></span>

<span data-ttu-id="ae7bb-158">Последовательность изменений гарантирует, что устаревший код продолжает выполняться «как есть», пока новая бессерверных функций можно воспользоваться преимуществами нового поля.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-158">The sequence of changes ensures that legacy code continues to run "as is" while newer serverless functions can take advantage of the new field.</span></span>

<span data-ttu-id="ae7bb-159">Дополнительные сведения о данных в бессерверной архитектуры, см. в разделе [проблемы и решения распределенное управление данными](../microservices-architecture/architect-microservice-container-applications/distributed-data-management.md).</span><span class="sxs-lookup"><span data-stu-id="ae7bb-159">For more information about data in serverless architectures, see [Challenges and solutions for distributed data management](../microservices-architecture/architect-microservice-container-applications/distributed-data-management.md).</span></span>

## <a name="scaling"></a><span data-ttu-id="ae7bb-160">Масштабирование</span><span class="sxs-lookup"><span data-stu-id="ae7bb-160">Scaling</span></span>

<span data-ttu-id="ae7bb-161">Это распространенное заблуждение, что бессерверной означает «не server».</span><span class="sxs-lookup"><span data-stu-id="ae7bb-161">It's a common misconception that serverless means "no server."</span></span> <span data-ttu-id="ae7bb-162">Это на самом деле «меньше server».</span><span class="sxs-lookup"><span data-stu-id="ae7bb-162">It's in fact "less server."</span></span> <span data-ttu-id="ae7bb-163">Тот факт, что является инфраструктуры резервных важно понимать, когда дело доходит до масштабирования.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-163">The fact there is a backing infrastructure is important to understand when it comes to scaling.</span></span> <span data-ttu-id="ae7bb-164">Наиболее бессерверной платформы предоставляют набор элементов управления для обработки, как инфраструктура должны масштабироваться при увеличении плотность событий.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-164">Most serverless platforms provide a set of controls to handle how the infrastructure should scale when event density increases.</span></span> <span data-ttu-id="ae7bb-165">Можно выбрать из множества вариантов, но ваша стратегия зависит от функции.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-165">You can choose from a variety of options, but your strategy may vary depending on the function.</span></span> <span data-ttu-id="ae7bb-166">Кроме того функции обычно выполняются в узле связанных таким образом, чтобы функции на одном узле имеют одинаковые параметры масштабирования.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-166">Furthermore, functions are typically run under a related host, so that functions on the same host have the same scale options.</span></span> <span data-ttu-id="ae7bb-167">Поэтому это необходимо для организации и разработки стратегии, какие функции размещаются вместе на основании требований к масштабированию.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-167">Therefore it is necessary to organize and strategize which functions are hosted together based on scale requirements.</span></span>

<span data-ttu-id="ae7bb-168">Правила часто укажите способ вертикального масштабирования (увеличить ресурсы узла) и горизонтальное масштабирование (увеличение числа экземпляров узла) на основе различных параметров.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-168">Rules often specify how to scale-up (increase the host resources) and scale-out (increase the number of host instances) based on varying parameters.</span></span> <span data-ttu-id="ae7bb-169">Триггеры для шкал может включать в расписание, частоты запросов, использования ЦП и использование памяти.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-169">Triggers for scales may include schedule, request rates, CPU utilization, and memory usage.</span></span> <span data-ttu-id="ae7bb-170">Более высокая производительность часто придется заплатить больше.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-170">Higher performance often comes at a greater cost.</span></span> <span data-ttu-id="ae7bb-171">Подходы дешевле, с учетом потребления ресурсов могут масштабироваться с увеличением быстро при частоте запросов неожиданно.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-171">The less expensive, consumption-based approaches may not scale as quickly when the request rate suddenly increases.</span></span> <span data-ttu-id="ae7bb-172">Есть компромисс между платить заранее «страхования затраты», и платить строго «как вы go» и что подвергает риску ответы медленнее из-за внезапного увеличения спроса.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-172">There is a trade-off between paying up front "insurance cost" versus paying strictly "as you go" and risking slower responses due to sudden increases in demand.</span></span>

## <a name="monitoring-tracing-and-logging"></a><span data-ttu-id="ae7bb-173">Мониторинг, трассировка и ведение журнала</span><span class="sxs-lookup"><span data-stu-id="ae7bb-173">Monitoring, tracing, and logging</span></span>

<span data-ttu-id="ae7bb-174">Часто не уделяют должного внимания аспектом DevOps мониторинг приложений после развертывания.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-174">An often overlooked aspect of DevOps is monitoring applications once deployed.</span></span> <span data-ttu-id="ae7bb-175">Очень важно иметь стратегию для наблюдения за бессерверные функции.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-175">It's important to have a strategy for monitoring serverless functions.</span></span> <span data-ttu-id="ae7bb-176">Самая сложная задача — часто корреляции или распознает, когда пользователь вызывает несколько функций в рамках одного взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-176">The biggest challenge is often correlation, or recognizing when a user calls multiple functions as part of the same interaction.</span></span> <span data-ttu-id="ae7bb-177">Наиболее бессерверные платформы позволяют консоли, журнал, который можно импортировать в сторонние средства.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-177">Most serverless platforms allow console logging that can be imported into third-party tools.</span></span> <span data-ttu-id="ae7bb-178">Также вы можете автоматизировать сбор данных телеметрии, создавать и отслеживать идентификаторы корреляции и отслеживать определенные действия, чтобы получить подробное представление.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-178">There are also options to automate collection of telemetry, generate and track correlation IDs, and monitor specific actions to provide detailed insights.</span></span> <span data-ttu-id="ae7bb-179">Azure предоставляет расширенные [платформы Application Insights](https://docs.microsoft.com/azure/azure-functions/functions-monitoring) для мониторинга и анализа.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-179">Azure provides the advanced [Application Insights platform](https://docs.microsoft.com/azure/azure-functions/functions-monitoring) for monitoring and analytics.</span></span>

## <a name="inter-service-dependencies"></a><span data-ttu-id="ae7bb-180">Зависимости между службами</span><span class="sxs-lookup"><span data-stu-id="ae7bb-180">Inter-service dependencies</span></span>

<span data-ttu-id="ae7bb-181">Бессерверная архитектура может включать функции, которые зависят от других функций.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-181">A serverless architecture may include functions that rely on other functions.</span></span> <span data-ttu-id="ae7bb-182">На самом деле не нередко в бессерверной архитектуры, чтобы иметь несколько служб, которые вызывают друг друга в процессе взаимодействия или распределенной транзакции.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-182">In fact, it isn't uncommon in a serverless architecture to have multiple services call each other as part of an interaction or distributed transaction.</span></span> <span data-ttu-id="ae7bb-183">Чтобы избежать возникновения сильных взаимозависимостей, рекомендуется, что службы не ссылаются друг на друга непосредственно.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-183">To avoid strong coupling, it's recommended that services don't reference each other directly.</span></span> <span data-ttu-id="ae7bb-184">Если конечная точка для службы необходимо изменить, прямые ссылки может привести основных рефакторинга.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-184">When the endpoint for a service needs to change, direct references could result in major refactoring.</span></span> <span data-ttu-id="ae7bb-185">Предлагаемое решение — предоставить механизм обнаружения служб, таких как реестр, который предоставляет соответствующую конечную точку для типа запроса.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-185">A suggested solution is to provide a service discovery mechanism, such as a registry, that provides the appropriate end point for a request type.</span></span> <span data-ttu-id="ae7bb-186">Еще одно решение — использовать обмена сообщениями службы, такие как очереди или разделы для обмена данными между службами.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-186">Another solution is to leverage messaging services like queues or topics for communication between services.</span></span>

## <a name="managing-failure-and-providing-resiliency"></a><span data-ttu-id="ae7bb-187">Управление сбоя и предоставляя устойчивости</span><span class="sxs-lookup"><span data-stu-id="ae7bb-187">Managing failure and providing resiliency</span></span>

<span data-ttu-id="ae7bb-188">Это также необходимо иметь в виду *шаблона размыкателя цепи*: Если для какой-то причине службы продолжают возникать ошибки, не рекомендуется повторно вызывать эту службу.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-188">It's also important to consider the *circuit-breaker pattern*: If, for some reason, a service continues to fail, it isn't advisable to call that service repeatedly.</span></span> <span data-ttu-id="ae7bb-189">Вместо этого вызывается другую службу, или сообщение возвращается, пока не будет восстановлено состояние зависимые службы.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-189">Instead, an alternative service is called or a message returned until the health of the dependent service is re-established.</span></span> <span data-ttu-id="ae7bb-190">Бессерверная архитектура необходимо принимать во внимание стратегии для разрешения и управление зависимостями между службами.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-190">The serverless architecture needs to take into account the strategy for resolving and managing inter-service dependencies.</span></span>

<span data-ttu-id="ae7bb-191">Для продолжения шаблона размыкателя цепи, службы должны быть отказоустойчивой и устойчивость.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-191">To continue the circuit-breaker pattern, services need to be fault tolerant and resilient.</span></span> <span data-ttu-id="ae7bb-192">Устойчивость к сбоям означает способность приложения продолжать выполнение даже после непредвиденных исключений или обнаружены недопустимые состояния.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-192">Fault tolerance refers to the ability of your application to continue running even after unexpected exceptions or invalid states are encountered.</span></span> <span data-ttu-id="ae7bb-193">Отказоустойчивость обычно является функцией сам код, и как он написал для обработки исключений.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-193">Fault tolerance is typically a function of the code itself and how it's written to handle exceptions.</span></span> <span data-ttu-id="ae7bb-194">Устойчивость — это способность приложения находится на восстановление после сбоев.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-194">Resiliency refers to how capable the app is at recovering from failures.</span></span> <span data-ttu-id="ae7bb-195">Устойчивость часто осуществляется с бессерверной платформе.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-195">Resiliency is often managed by the serverless platform.</span></span> <span data-ttu-id="ae7bb-196">Платформы должны иметь возможность запустить новый экземпляр независимой от сервера функции при сбое существующий.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-196">The platform should be able to spin up a new serverless function instance when the existing one fails.</span></span> <span data-ttu-id="ae7bb-197">Платформа также должен быть достаточно «умными» для остановки развертывания новых экземпляров, когда каждый новый экземпляр выходит из строя.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-197">The platform should also be intelligent enough to stop spinning up new instances when every new instance fails.</span></span>

<span data-ttu-id="ae7bb-198">Дополнительные сведения см. в разделе [реализация шаблона Размыкателя цепи](../microservices-architecture/implement-resilient-applications/implement-circuit-breaker-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="ae7bb-198">For more information, see [Implementing the Circuit Breaker pattern](../microservices-architecture/implement-resilient-applications/implement-circuit-breaker-pattern.md).</span></span>

## <a name="versioning-and-greenblue-deployments"></a><span data-ttu-id="ae7bb-199">Управление версиями и зеленого и синего развертываний</span><span class="sxs-lookup"><span data-stu-id="ae7bb-199">Versioning and green/blue deployments</span></span>

<span data-ttu-id="ae7bb-200">Главным преимуществом бессерверной является возможность обновления определенной функции без необходимости повторного развертывания всего приложения.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-200">A major benefit of serverless is the ability to upgrade a specific function without having to redeploy the entire application.</span></span> <span data-ttu-id="ae7bb-201">Обновления для успешной работы функции необходимо включить управление версиями, таким образом, вызывающих служб направляются в правильную версию кода.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-201">For upgrades to be successful, functions must be versioned so that services calling them are routed to the correct version of code.</span></span> <span data-ttu-id="ae7bb-202">Важно также стратегии развертывания новых версий.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-202">A strategy for deploying new versions is also important.</span></span> <span data-ttu-id="ae7bb-203">Распространенным подходом является использование «зеленого и синего развертываний.»</span><span class="sxs-lookup"><span data-stu-id="ae7bb-203">A common approach is to use "green/blue deployments."</span></span> <span data-ttu-id="ae7bb-204">Зеленый развертывания является текущей функции.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-204">The green deployment is the current function.</span></span> <span data-ttu-id="ae7bb-205">Новая версия «blue» развертывается в рабочей среде и тестирование.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-205">A new "blue" version is deployed to production and tested.</span></span> <span data-ttu-id="ae7bb-206">При тестировании проходов, зеленого и синего версии меняются местами, поэтому новой версии следует в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-206">When testing passes, the green and blue versions are swapped so the new version comes live.</span></span> <span data-ttu-id="ae7bb-207">Если возникли проблемы, их можно переключать обратно.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-207">If any issues are encountered, they can be swapped back.</span></span> <span data-ttu-id="ae7bb-208">Поддержка управления версиями и зеленого и синего развертываний требуется сочетание разработки функции в соответствии с изменением версии и работы с ними бессерверная платформа для обработки развертывания.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-208">Supporting versioning and green/blue deployments requires a combination of authoring the functions to accommodate version changes and working with the serverless platform to handle deployments.</span></span> <span data-ttu-id="ae7bb-209">Один из возможных способов является использование учетных записей-посредников, которые описаны в [Azure бессерверной платформе](azure-functions.md#proxies) главы.</span><span class="sxs-lookup"><span data-stu-id="ae7bb-209">One possible approach is to use proxies, which are described in the [Azure serverless platform](azure-functions.md#proxies) chapter.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="ae7bb-210">[Назад](serverless-architecture.md)
>[Вперед](serverless-design-examples.md)</span><span class="sxs-lookup"><span data-stu-id="ae7bb-210">[Previous](serverless-architecture.md)
[Next](serverless-design-examples.md)</span></span>