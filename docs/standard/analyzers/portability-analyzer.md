---
title: Анализатор переносимости .NET
description: Сведения о том, как применять анализатор переносимости .NET для оценки переносимости кода в разных реализациях .NET, включая .NET Core, .NET Standard, UWP и Xamarin.
ms.date: 09/13/2019
ms.technology: dotnet-standard
ms.assetid: 0375250f-5704-4993-a6d5-e21c499cea1e
ms.openlocfilehash: e0a5c791926b36fe5a35c5446471c3dcdb75cd7b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "72774380"
---
# <a name="the-net-portability-analyzer"></a>Анализатор переносимости .NET

Хотите, чтобы ваши библиотеки поддерживали несколько платформ? Хотите узнать, какой объем работ требуется проделать, чтобы ваше приложение .NET Framework работало в .NET Core? [Анализатор переносимости .NET](https://github.com/microsoft/dotnet-apiport) — это средство, которое анализирует сборки и предоставляет подробный отчет об отсутствующих API-интерфейсах .NET для приложений или библиотек, которые переносятся на заданные целевые платформы .NET. Анализатор переносимости предлагается как [расширение Visual Studio](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer), которое анализирует одну сборку на проект, и как [консольное приложение ApiPort](https://aka.ms/apiportdownload), которое анализирует сборки по указанным файлам или каталогам.

После преобразования проекта для новой целевой платформы, например .NET Core, вы можете использовать [анализатор API](api-analyzer.md) на основе Roslyn для определения API, вызывающих исключение <xref:System.PlatformNotSupportedException>, и других проблем совместимости.

## <a name="common-targets"></a>Стандартные целевые платформы

- [.NET Core](../../core/index.md). Имеет модульную архитектуру, использует сценарии параллельного выполнения и поддерживает работу на различных платформах. Принцип параллелизма позволяет внедрять новые версии .NET Core, не нарушая функционирования других приложений. Если вашей целью является перенос приложения на .NET Core с поддержкой нескольких платформ, это рекомендуемый целевой объект.
- .[NET Standard](../../standard/net-standard.md): включает API .NET Standard, доступный во всех реализациях .NET. Если ваша цель — сделать библиотеку для выполнения на всех поддерживаемых платформах .NET, это рекомендуемый целевой объект.
- [ASP.NET Core](/aspnet/core): современная веб платформа, созданная на .NET Core. Если вашей целью является перенос веб-приложения на .NET Core для поддержки нескольких платформ, это рекомендуемый целевой объект.
- Платформа .NET Core и [ее расширения](../../core/porting/windows-compat-pack.md): включает в себя API .NET Core, а также пакет обеспечения совместимости Windows, который предоставляет множество доступных технологий .NET Framework. Это рекомендуемый целевой объект для переноса приложения из .NET Framework на .NET Core в Windows.
- Платформа .NET Standard и [ее расширения](../../core/porting/windows-compat-pack.md): включает в себя API .NET Standard, а также пакет обеспечения совместимости Windows, который предоставляет множество доступных технологий .NET Framework. Это рекомендуемый целевой объект для переноса библиотеки из .NET Framework на .NET Core в Windows.

## <a name="how-to-use-the-net-portability-analyzer"></a>Как использовать анализатор переносимости .NET

Чтобы начать пользоваться анализатором переносимости .NET в Visual Studio, скачайте и установите расширение из [Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer). Оно работает в Visual Studio 2017 и более поздних версиях. Его можно настроить в Visual Studio, выбрав **Анализ** > **Параметры анализатора переносимости** и указав целевые платформы, являющиеся платформами или версиями .NET, для которых вы хотите оценить пропуски в переносимости по сравнению с платформой или версией, на которой собрана ваша текущая сборка.

![Снимок экрана: анализатор переносимости](./media/portability-analyzer/portability-screenshot.png)

Можно также использовать консольное приложение ApiPort, загрузив его из [репозитория ApiPort](https://aka.ms/apiportdownload). Можно использовать параметр команды `listTargets`, чтобы отобразить список доступных целевых платформ, а затем выбрать целевые платформы, указав параметр команды `-t` или `--target`.

### <a name="analyze-portability"></a>Анализ переносимости
Чтобы проанализировать весь проект в Visual Studio, щелкните его правой кнопкой мыши в **обозревателе решений** и выберите пункт **Анализировать переносимость сборки**. Или в меню **Анализ** выберите **Анализировать переносимость сборки**. После этого выберите исполняемый файл или DLL-файл проекта.

![Снимок экрана: анализатор переносимости из обозревателя решений](./media/portability-analyzer/portability-solution-explorer.png)

Можно также использовать [консольное приложение ApiPort](https://aka.ms/apiportdownload).

- Для анализа текущего каталога выполните следующую команду: `ApiPort.exe analyze -f .`.
- Для анализа заданного списка DLL-файлов выполните следующую команду: `ApiPort.exe analyze -f first.dll -f second.dll -f third.dll`.
- Выполните `ApiPort.exe -?`, чтобы получить дополнительную помощь

Рекомендуется включать все связанные файлы EXE и DLL, которые у вас есть и которые вы хотите перенести, а также исключить файлы, от которых зависит приложение, но у вас их нет и вы не хотите их переносить. Это позволит получить наиболее актуальный отчет о переносимости.

### <a name="view-and-interpret-portability-result"></a>Просмотр и интерпретация результатов переносимости

В отчете отображаются только интерфейсы API, которые не поддерживаются целевой платформой.
После выполнения анализа в Visual Studio вы увидите ссылку на файл отчета о переносимости .NET. Если вы использовали [консольное приложение ApiPort](https://aka.ms/apiportdownload), ваш отчет о переносимости .NET сохраняется как файл в формате, который вы указали. По умолчанию используется файл Excel ( *.xlsx*) в текущем каталоге.

#### <a name="portability-summary"></a>Сводка переносимости

![Снимок экрана: сводка по переносимости](./media/portability-analyzer/api-catalog-portablility-summary.png)

В разделе со сводкой по переносимости в этом отчете показан процент переносимости для каждой сборки, включенной в анализ. В предыдущем примере 71,24 % API-интерфейсов .NET Framework, используемых в приложении `svcutil`, доступны в .NET Core и расширениях платформы. Если запустить анализатор переносимости .NET для нескольких сборок, каждая сборка должна иметь строку в сводном отчете о переносимости.

#### <a name="details"></a>Подробнее

![Снимок экрана: сведения о переносимости](./media/portability-analyzer/api-catalog-portablility-details.png)

В разделе **Details** (Подробные сведения) в отчете указываются API, отсутствующие на любой из выбранных **целевых платформ**.

- Тип целевого объекта: в типе есть API, отсутствующие на целевой платформе.
- Член целевого объекта: метод отсутствует на целевой платформе.
- Имя сборки: сборка .NET Framework, в которой находится отсутствующий API.
- Каждая из выбранных целевых платформ представлена одним столбцом, например ".NET Core": значение "Не поддерживается" означает, что API не поддерживается на этой целевой платформе.
- Рекомендованные изменения: рекомендованный API или технология для замены. В настоящее время это поле является пустым или устарело для многих интерфейсов API. Из-за большого числа API нам сложно поддерживать актуальность. Мы рассматриваем альтернативные решения, чтобы предоставлять клиентам полезные сведения.

#### <a name="missing-assemblies"></a>Отсутствующие сборки

![Снимок экрана: отсутствующие сборки](./media/portability-analyzer/api-catalog-missing-assemblies.png)

В отчете есть раздел "Отсутствующие сборки". В нем приводится список сборок, на которые ссылаются проанализированные сборки и которые не были проанализированы. Если эта сборка принадлежит вам, включите ее в анализ переносимости API, чтобы получить по ней подробный отчет о переносимости на уровне API. Если это сторонняя библиотека, проверьте, существует ли более новая версия, которая поддерживает вашу целевую платформу. Если да, возможно, следует перейти на новую версию. В конечном счете список должен включать все сторонние сборки, от которых зависит ваше приложение, и вы должны проверить, что у них есть версии, которые поддерживают вашу целевую платформу.

Дополнительные сведения об анализаторе переносимости .NET см. в [документации GitHub](https://github.com/Microsoft/dotnet-apiport#documentation) и видеоролике с [кратким обзором анализатора переносимости .NET](https://channel9.msdn.com/Blogs/Seth-Juarez/A-Brief-Look-at-the-NET-Portability-Analyzer) на Channel 9.
