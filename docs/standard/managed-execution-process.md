---
title: Процесс выполнения управляемого кода
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- source code language
- code, managed execution process
- runtime, managed execution process
- compiling source code, managed execution process
- managed execution process
- common language runtime, managed execution process
ms.assetid: 476b03dc-2b12-49a7-b067-41caeaa2f533
ms.openlocfilehash: 46a266849f137076170287aeb10becedf83ccf78
ms.sourcegitcommit: 00aa62e2f469c2272a457b04e66b4cc3c97a800b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/28/2020
ms.locfileid: "78160226"
---
# <a name="managed-execution-process"></a><span data-ttu-id="b93e0-102">Процесс управляемого выполнения</span><span class="sxs-lookup"><span data-stu-id="b93e0-102">Managed Execution Process</span></span>
<a name="introduction"></a> <span data-ttu-id="b93e0-103">Процесс управляемого исполнения включает следующие шаги, которые подробно разбираются позднее в этом разделе:</span><span class="sxs-lookup"><span data-stu-id="b93e0-103">The managed execution process includes the following steps, which are discussed in detail later in this topic:</span></span>  
  
1. <span data-ttu-id="b93e0-104">[Выбор компилятора](#choosing_a_compiler).</span><span class="sxs-lookup"><span data-stu-id="b93e0-104">[Choosing a compiler](#choosing_a_compiler).</span></span>  
  
     <span data-ttu-id="b93e0-105">Чтобы воспользоваться преимуществами среды CLR, необходимо использовать один или несколько языковых компиляторов, обращающихся к среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-105">To obtain the benefits provided by the common language runtime, you must use one or more language compilers that target the runtime.</span></span>  
  
2. <span data-ttu-id="b93e0-106">[Компиляция кода в MSIL](#compiling_to_msil).</span><span class="sxs-lookup"><span data-stu-id="b93e0-106">[Compiling your code to MSIL](#compiling_to_msil).</span></span>  
  
     <span data-ttu-id="b93e0-107">При компиляции исходный код преобразуется в MSIL и создаются необходимые метаданные.</span><span class="sxs-lookup"><span data-stu-id="b93e0-107">Compiling translates your source code into Microsoft intermediate language (MSIL) and generates the required metadata.</span></span>  
  
3. <span data-ttu-id="b93e0-108">[Компиляция инструкций MSIL в машинный код](#compiling_msil_to_native_code).</span><span class="sxs-lookup"><span data-stu-id="b93e0-108">[Compiling MSIL to native code](#compiling_msil_to_native_code).</span></span>  
  
     <span data-ttu-id="b93e0-109">Во время выполнения JIT-компилятор преобразует инструкции MSIL в машинный код.</span><span class="sxs-lookup"><span data-stu-id="b93e0-109">At execution time, a just-in-time (JIT) compiler translates the MSIL into native code.</span></span> <span data-ttu-id="b93e0-110">Во время этой компиляции выполняется проверка кода и метаданных MSIL с целью установить, можно ли для них определить, является ли код типобезопасным.</span><span class="sxs-lookup"><span data-stu-id="b93e0-110">During this compilation, code must pass a verification process that examines the MSIL and metadata to find out whether the code can be determined to be type safe.</span></span>  
  
4. <span data-ttu-id="b93e0-111">[Выполнение кода](#running_code).</span><span class="sxs-lookup"><span data-stu-id="b93e0-111">[Running code](#running_code).</span></span>  
  
     <span data-ttu-id="b93e0-112">Среда CLR предоставляет инфраструктуру, обеспечивающую выполнение кода, и ряд служб, которые можно использовать при выполнении.</span><span class="sxs-lookup"><span data-stu-id="b93e0-112">The common language runtime provides the infrastructure that enables execution to take place and services that can be used during execution.</span></span>  
  
<a name="choosing_a_compiler"></a>
## <a name="choosing-a-compiler"></a><span data-ttu-id="b93e0-113">Выбор компилятора</span><span class="sxs-lookup"><span data-stu-id="b93e0-113">Choosing a Compiler</span></span>  
 <span data-ttu-id="b93e0-114">Чтобы воспользоваться преимуществами, предоставляемыми средой CLR, необходимо применить один или несколько языковых компиляторов, ориентированных на среду выполнения, например компилятор Visual Basic, C#, Visual C++, F# или один из многочисленных компиляторов от независимых разработчиков, например компилятор Eiffel, Perl или COBOL.</span><span class="sxs-lookup"><span data-stu-id="b93e0-114">To obtain the benefits provided by the common language runtime (CLR), you must use one or more language compilers that target the runtime, such as Visual Basic, C#, Visual C++, F#, or one of many third-party compilers such as an Eiffel, Perl, or COBOL compiler.</span></span>  
  
 <span data-ttu-id="b93e0-115">Поскольку среда выполнения является многоязычной, она поддерживает широкий набор разнообразных типов данных и языковых средств.</span><span class="sxs-lookup"><span data-stu-id="b93e0-115">Because it is a multilanguage execution environment, the runtime supports a wide variety of data types and language features.</span></span> <span data-ttu-id="b93e0-116">Доступные средства среды выполнения определяются используемым языковым компилятором, и разработчики создают код с использованием этих средств.</span><span class="sxs-lookup"><span data-stu-id="b93e0-116">The language compiler you use determines which runtime features are available, and you design your code using those features.</span></span> <span data-ttu-id="b93e0-117">Используемый в коде синтаксис определяется компилятором, а не средой выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-117">Your compiler, not the runtime, establishes the syntax your code must use.</span></span> <span data-ttu-id="b93e0-118">Если компонент должен быть полностью доступен для компонентов, написанных на других языках, то экспортируемые этим компонентом типы должны предоставлять исключительно языковые функции, включенные в состав [статью Независимость от языка и независимые от языка компоненты](../../docs/standard/language-independence-and-language-independent-components.md) (CLS).</span><span class="sxs-lookup"><span data-stu-id="b93e0-118">If your component must be completely usable by components written in other languages, your component's exported types must expose only language features that are included in the [Language Independence and Language-Independent Components](../../docs/standard/language-independence-and-language-independent-components.md) (CLS).</span></span> <span data-ttu-id="b93e0-119">Атрибут <xref:System.CLSCompliantAttribute> позволяет гарантировать, что код является CLS-совместимым.</span><span class="sxs-lookup"><span data-stu-id="b93e0-119">You can use the <xref:System.CLSCompliantAttribute> attribute to ensure that your code is CLS-compliant.</span></span> <span data-ttu-id="b93e0-120">Для получения дополнительной информации см. [статью Независимость от языка и независимые от языка компоненты](../../docs/standard/language-independence-and-language-independent-components.md).</span><span class="sxs-lookup"><span data-stu-id="b93e0-120">For more information, see [Language Independence and Language-Independent Components](../../docs/standard/language-independence-and-language-independent-components.md).</span></span>  
  
 [<span data-ttu-id="b93e0-121">Вверх</span><span class="sxs-lookup"><span data-stu-id="b93e0-121">Back to top</span></span>](#introduction)  
  
<a name="compiling_to_msil"></a>
## <a name="compiling-to-msil"></a><span data-ttu-id="b93e0-122">Компиляция в MSIL</span><span class="sxs-lookup"><span data-stu-id="b93e0-122">Compiling to MSIL</span></span>  
 <span data-ttu-id="b93e0-123">При компиляции в управляемый код компилятор преобразует исходный код в промежуточный язык Microsoft (MSIL), представляющий собой независимый от процессора набор инструкций, который можно эффективно преобразовать в машинный код.</span><span class="sxs-lookup"><span data-stu-id="b93e0-123">When compiling to managed code, the compiler translates your source code into Microsoft intermediate language (MSIL), which is a CPU-independent set of instructions that can be efficiently converted to native code.</span></span> <span data-ttu-id="b93e0-124">Язык MSIL включает инструкции для загрузки, сохранения, инициализации и вызова методов для объектов, а также инструкции для арифметических и логических операций, потоков управления, прямого доступа к памяти, обработки исключений и других операций.</span><span class="sxs-lookup"><span data-stu-id="b93e0-124">MSIL includes instructions for loading, storing, initializing, and calling methods on objects, as well as instructions for arithmetic and logical operations, control flow, direct memory access, exception handling, and other operations.</span></span> <span data-ttu-id="b93e0-125">Перед выполнением код MSIL необходимо преобразовать в код для конкретного процессора, обычно с помощью [JIT-компилятора](#compiling_msil_to_native_code).</span><span class="sxs-lookup"><span data-stu-id="b93e0-125">Before code can be run, MSIL must be converted to CPU-specific code, usually by a [just-in-time (JIT) compiler](#compiling_msil_to_native_code).</span></span> <span data-ttu-id="b93e0-126">Поскольку среда CLR предоставляет для каждой поддерживаемой компьютерной архитектуры один или несколько JIT-компиляторов, один набор инструкций MSIL можно компилировать и выполнять в любой поддерживаемой архитектуре.</span><span class="sxs-lookup"><span data-stu-id="b93e0-126">Because the common language runtime supplies one or more JIT compilers for each computer architecture it supports, the same set of MSIL can be JIT-compiled and run on any supported architecture.</span></span>  
  
 <span data-ttu-id="b93e0-127">Когда компилятор создает код MSIL, одновременно создаются метаданные.</span><span class="sxs-lookup"><span data-stu-id="b93e0-127">When a compiler produces MSIL, it also produces metadata.</span></span> <span data-ttu-id="b93e0-128">Метаданные содержат описание типов в коде, включая определение каждого типа, сигнатуры каждого члена типа, члены, на которые есть ссылки в коде, а также другие сведения, используемые средой выполнения во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-128">Metadata describes the types in your code, including the definition of each type, the signatures of each type's members, the members that your code references, and other data that the runtime uses at execution time.</span></span> <span data-ttu-id="b93e0-129">MSIL и метаданные содержатся в переносимом исполняемом (PE) файле, который основывается на форматах Microsoft PE и COFF, ранее использовавшихся для исполняемого контента, но при этом расширяет их возможности.</span><span class="sxs-lookup"><span data-stu-id="b93e0-129">The MSIL and metadata are contained in a portable executable (PE) file that is based on and that extends the published Microsoft PE and common object file format (COFF) used historically for executable content.</span></span> <span data-ttu-id="b93e0-130">Этот формат файлов, позволяющий размещать код MSIL или машинный код, а также метаданные, позволяет операционной системе распознавать образы среды CLR.</span><span class="sxs-lookup"><span data-stu-id="b93e0-130">This file format, which accommodates MSIL or native code as well as metadata, enables the operating system to recognize common language runtime images.</span></span> <span data-ttu-id="b93e0-131">Наличие в файле метаданных наряду с MSIL позволяет коду описывать себя. Это устраняет потребность в библиотеках типов и языке IDL.</span><span class="sxs-lookup"><span data-stu-id="b93e0-131">The presence of metadata in the file together with MSIL enables your code to describe itself, which means that there is no need for type libraries or Interface Definition Language (IDL).</span></span> <span data-ttu-id="b93e0-132">Среда выполнения находит и извлекает метаданные из файла по мере необходимости при выполнении.</span><span class="sxs-lookup"><span data-stu-id="b93e0-132">The runtime locates and extracts the metadata from the file as needed during execution.</span></span>  
  
 [<span data-ttu-id="b93e0-133">Вверх</span><span class="sxs-lookup"><span data-stu-id="b93e0-133">Back to top</span></span>](#introduction)  
  
<a name="compiling_msil_to_native_code"></a>
## <a name="compiling-msil-to-native-code"></a><span data-ttu-id="b93e0-134">Компиляция инструкций MSIL в машинный код</span><span class="sxs-lookup"><span data-stu-id="b93e0-134">Compiling MSIL to Native Code</span></span>  
 <span data-ttu-id="b93e0-135">Перед запуском MSIL его необходимо скомпилировать в машинный код в среде CLR для архитектуры конечного компьютера.</span><span class="sxs-lookup"><span data-stu-id="b93e0-135">Before you can run Microsoft intermediate language (MSIL), it must be compiled against the common language runtime to native code for the target machine architecture.</span></span> <span data-ttu-id="b93e0-136">Платформа .NET Framework предоставляет два способа такого преобразования:</span><span class="sxs-lookup"><span data-stu-id="b93e0-136">The .NET Framework provides two ways to perform this conversion:</span></span>  
  
- <span data-ttu-id="b93e0-137">JIT-компилятор платформы .NET Framework;</span><span class="sxs-lookup"><span data-stu-id="b93e0-137">A .NET Framework just-in-time (JIT) compiler.</span></span>  
  
- <span data-ttu-id="b93e0-138">[Генератор образов в машинном коде (Ngen.exe)](../../docs/framework/tools/ngen-exe-native-image-generator.md) .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b93e0-138">The .NET Framework [Ngen.exe (Native Image Generator)](../../docs/framework/tools/ngen-exe-native-image-generator.md).</span></span>  
  
### <a name="compilation-by-the-jit-compiler"></a><span data-ttu-id="b93e0-139">Компиляция с помощью JIT-компилятора</span><span class="sxs-lookup"><span data-stu-id="b93e0-139">Compilation by the JIT Compiler</span></span>  
 <span data-ttu-id="b93e0-140">При JIT-компиляции язык MSIL преобразуется в машинный код во время выполнения приложения по требованию, когда загружается и выполняется содержимое сборки.</span><span class="sxs-lookup"><span data-stu-id="b93e0-140">JIT compilation converts MSIL to native code on demand at application run time, when the contents of an assembly are loaded and executed.</span></span> <span data-ttu-id="b93e0-141">Поскольку среда CLR предоставляет JIT-компилятор для каждой поддерживаемой архитектуры процессора, разработчики могут создавать набор сборок MSIL, которые могут компилироваться с помощью JIT-компилятора и выполняться на разных компьютерах с разной архитектурой.</span><span class="sxs-lookup"><span data-stu-id="b93e0-141">Because the common language runtime supplies a JIT compiler for each supported CPU architecture, developers can build a set of MSIL assemblies that can be JIT-compiled and run on different computers with different machine architectures.</span></span> <span data-ttu-id="b93e0-142">Если управляемый код вызывает специфический для платформы машинный API или библиотеку классов, то он будет выполняться только в соответствующей операционной системе.</span><span class="sxs-lookup"><span data-stu-id="b93e0-142">However, if your managed code calls platform-specific native APIs or a platform-specific class library, it will run only on that operating system.</span></span>  
  
 <span data-ttu-id="b93e0-143">При JIT-компиляции учитывается возможность того, что определенный код может никогда не вызываться во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-143">JIT compilation takes into account the possibility that some code might never be called during execution.</span></span> <span data-ttu-id="b93e0-144">Чтобы не тратить время и память на преобразование всего содержащегося в PE-файле MSIL в машинный код, при компиляции MSIL преобразуется в машинный код по мере необходимости во время выполнения. Полученный таким образом машинный код сохраняется в памяти, что позволяет использовать его при дальнейших вызовах в контексте этого процесса.</span><span class="sxs-lookup"><span data-stu-id="b93e0-144">Instead of using time and memory to convert all the MSIL in a PE file to native code, it converts the MSIL as needed during execution and stores the resulting native code in memory so that it is accessible for subsequent calls in the context of that process.</span></span> <span data-ttu-id="b93e0-145">Загрузчик создает и присоединяет заглушки к каждому методу в типе, когда тип загружается и инициализируется.</span><span class="sxs-lookup"><span data-stu-id="b93e0-145">The loader creates and attaches a stub to each method in a type when the type is loaded and initialized.</span></span> <span data-ttu-id="b93e0-146">При первом вызове метода заглушка передает управление JIT-компилятору, который преобразует MSIL для этого метода в машинный код и заменяет заглушку на созданный машинный код.</span><span class="sxs-lookup"><span data-stu-id="b93e0-146">When a method is called for the first time, the stub passes control to the JIT compiler, which converts the MSIL for that method into native code and modifies the stub to point directly to the generated native code.</span></span> <span data-ttu-id="b93e0-147">Поэтому последующие вызовы метода, скомпилированного с помощью JIT-компилятора, ведут непосредственно к машинному коду.</span><span class="sxs-lookup"><span data-stu-id="b93e0-147">Therefore, subsequent calls to the JIT-compiled method go directly to the native code.</span></span>  
  
### <a name="install-time-code-generation-using-ngenexe"></a><span data-ttu-id="b93e0-148">Создание кода во время установки с помощью NGen.exe</span><span class="sxs-lookup"><span data-stu-id="b93e0-148">Install-Time Code Generation Using NGen.exe</span></span>  
 <span data-ttu-id="b93e0-149">Тот факт, что JIT-компилятор преобразует MSIL-код сборки в машинный код при вызове отдельных методов, определенных в этой сборке, отрицательно сказывается на производительности во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-149">Because the JIT compiler converts an assembly's MSIL to native code when individual methods defined in that assembly are called, it affects performance adversely at run time.</span></span> <span data-ttu-id="b93e0-150">В большинстве случаев снижение производительности приемлемо.</span><span class="sxs-lookup"><span data-stu-id="b93e0-150">In most cases, that diminished performance is acceptable.</span></span> <span data-ttu-id="b93e0-151">Что более важно, код, созданный JIT-компилятором, будет привязан к процессу, вызвавшему компиляцию.</span><span class="sxs-lookup"><span data-stu-id="b93e0-151">More importantly, the code generated by the JIT compiler is bound to the process that triggered the compilation.</span></span> <span data-ttu-id="b93e0-152">Его нельзя сделать общим для нескольких процессов.</span><span class="sxs-lookup"><span data-stu-id="b93e0-152">It cannot be shared across multiple processes.</span></span> <span data-ttu-id="b93e0-153">Чтобы созданный код можно было использовать в нескольких вызовах приложения или в нескольких процессах, которые совместно используют набор сборок, среда CLR предоставляет режим предварительной компиляции.</span><span class="sxs-lookup"><span data-stu-id="b93e0-153">To allow the generated code to be shared across multiple invocations of an application or across multiple processes that share a set of assemblies, the common language runtime supports an ahead-of-time compilation mode.</span></span> <span data-ttu-id="b93e0-154">В таком режиме компиляции для преобразования сборок MSIL в машинный код в стиле JIT-компилятора используется [генератор образов в машинном коде (Ngen.exe)](../../docs/framework/tools/ngen-exe-native-image-generator.md).</span><span class="sxs-lookup"><span data-stu-id="b93e0-154">This ahead-of-time compilation mode uses the [Ngen.exe (Native Image Generator)](../../docs/framework/tools/ngen-exe-native-image-generator.md) to convert MSIL assemblies to native code much like the JIT compiler does.</span></span> <span data-ttu-id="b93e0-155">Однако, работа Ngen.exe отличается от JIT-компилятора в трех аспектах.</span><span class="sxs-lookup"><span data-stu-id="b93e0-155">However, the operation of Ngen.exe differs from that of the JIT compiler in three ways:</span></span>  
  
- <span data-ttu-id="b93e0-156">Ngen.exe выполняет преобразование из MSIL-кода в машинный код перед выполнением приложения, а не во время его выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-156">It performs the conversion from MSIL to native code before running the application instead of while the application is running.</span></span>  
  
- <span data-ttu-id="b93e0-157">При этом сборка компилируется целиком, а не по одному методу за раз.</span><span class="sxs-lookup"><span data-stu-id="b93e0-157">It compiles an entire assembly at a time, instead of one method at a time.</span></span>  
  
- <span data-ttu-id="b93e0-158">Она сохраняет созданный код в кэше образа машинного кода в виде файла на диске.</span><span class="sxs-lookup"><span data-stu-id="b93e0-158">It persists the generated code in the Native Image Cache as a file on disk.</span></span>  
  
### <a name="code-verification"></a><span data-ttu-id="b93e0-159">Проверка кода</span><span class="sxs-lookup"><span data-stu-id="b93e0-159">Code Verification</span></span>  
 <span data-ttu-id="b93e0-160">В процессе компиляции в машинный код MSIL-код должен пройти проверку, если только администратор не установил политику безопасности, разрешающую пропустить проверку кода.</span><span class="sxs-lookup"><span data-stu-id="b93e0-160">As part of its compilation to native code, the MSIL code must pass a verification process unless an administrator has established a security policy that allows the code to bypass verification.</span></span> <span data-ttu-id="b93e0-161">MSIL-код и метаданные проверяются на типобезопасность. Это подразумевает, что код должен обращаться только к тем адресам памяти, к которым ему разрешен доступ.</span><span class="sxs-lookup"><span data-stu-id="b93e0-161">Verification examines MSIL and metadata to find out whether the code is type safe, which means that it accesses only the memory locations it is authorized to access.</span></span> <span data-ttu-id="b93e0-162">Типобезопасность помогает изолировать объекты друг от друга и способствует их защите от непредумышленного или злонамеренного повреждения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-162">Type safety helps isolate objects from each other and helps protect them from inadvertent or malicious corruption.</span></span> <span data-ttu-id="b93e0-163">Она также гарантирует надежное применение условий безопасности для кода.</span><span class="sxs-lookup"><span data-stu-id="b93e0-163">It also provides assurance that security restrictions on code can be reliably enforced.</span></span>  
  
 <span data-ttu-id="b93e0-164">Среда выполнения основывается на истинности следующих утверждений для поддающегося проверке типобезопасного кода:</span><span class="sxs-lookup"><span data-stu-id="b93e0-164">The runtime relies on the fact that the following statements are true for code that is verifiably type safe:</span></span>  
  
- <span data-ttu-id="b93e0-165">ссылка на тип строго совместима с адресуемым типом;</span><span class="sxs-lookup"><span data-stu-id="b93e0-165">A reference to a type is strictly compatible with the type being referenced.</span></span>  
  
- <span data-ttu-id="b93e0-166">для объекта вызываются только правильно определенные операции;</span><span class="sxs-lookup"><span data-stu-id="b93e0-166">Only appropriately defined operations are invoked on an object.</span></span>  
  
- <span data-ttu-id="b93e0-167">удостоверения являются подлинными.</span><span class="sxs-lookup"><span data-stu-id="b93e0-167">Identities are what they claim to be.</span></span>  
  
 <span data-ttu-id="b93e0-168">В процессе проверки кода MSIL делается попытка подтвердить, что код может получать доступ к расположениям в памяти и вызывать методы только через правильно определенные типы.</span><span class="sxs-lookup"><span data-stu-id="b93e0-168">During the verification process, MSIL code is examined in an attempt to confirm that the code can access memory locations and call methods only through properly defined types.</span></span> <span data-ttu-id="b93e0-169">Например, код не должен разрешать доступ к полям объекта так, чтобы можно было выходить за границы расположения в памяти.</span><span class="sxs-lookup"><span data-stu-id="b93e0-169">For example, code cannot allow an object's fields to be accessed in a manner that allows memory locations to be overrun.</span></span> <span data-ttu-id="b93e0-170">Кроме того, проверка определяет, правильно ли был создан код MSIL, поскольку неверный код MSIL может приводить к нарушению правил строгой типизации.</span><span class="sxs-lookup"><span data-stu-id="b93e0-170">Additionally, verification inspects code to determine whether the MSIL has been correctly generated, because incorrect MSIL can lead to a violation of the type safety rules.</span></span> <span data-ttu-id="b93e0-171">В процессе проверки передается правильно определенный типобезопасный код.</span><span class="sxs-lookup"><span data-stu-id="b93e0-171">The verification process passes a well-defined set of type-safe code, and it passes only code that is type safe.</span></span> <span data-ttu-id="b93e0-172">Однако иногда типобезопасный код может не пройти проверку из-за ограничений процесса проверки, а некоторые языки по своей структуре не позволяют создавать поддающийся проверке типобезопасный код.</span><span class="sxs-lookup"><span data-stu-id="b93e0-172">However, some type-safe code might not pass verification because of some limitations of the verification process, and some languages, by design, do not produce verifiably type-safe code.</span></span> <span data-ttu-id="b93e0-173">Если в соответствии с политикой безопасности использование типобезопасного кода является обязательным и код не проходит проверку, то при выполнении кода создается исключение.</span><span class="sxs-lookup"><span data-stu-id="b93e0-173">If type-safe code is required by the security policy but the code does not pass verification, an exception is thrown when the code is run.</span></span>  
  
 [<span data-ttu-id="b93e0-174">Вверх</span><span class="sxs-lookup"><span data-stu-id="b93e0-174">Back to top</span></span>](#introduction)  
  
<a name="running_code"></a>
## <a name="running-code"></a><span data-ttu-id="b93e0-175">Выполнение кода</span><span class="sxs-lookup"><span data-stu-id="b93e0-175">Running Code</span></span>  
 <span data-ttu-id="b93e0-176">Среда CLR предоставляет инфраструктуру, обеспечивающую управляемое выполнение кода, и ряд служб, которые можно использовать при выполнении.</span><span class="sxs-lookup"><span data-stu-id="b93e0-176">The common language runtime provides the infrastructure that enables managed execution to take place and services that can be used during execution.</span></span> <span data-ttu-id="b93e0-177">Перед выполнением метода его необходимо скомпилировать в код для конкретного процессора.</span><span class="sxs-lookup"><span data-stu-id="b93e0-177">Before a method can be run, it must be compiled to processor-specific code.</span></span> <span data-ttu-id="b93e0-178">Каждый метод, для которого создан MSIL-код, компилируется с помощью JIT-компилятора при первом вызове и затем запускается.</span><span class="sxs-lookup"><span data-stu-id="b93e0-178">Each method for which MSIL has been generated is JIT-compiled when it is called for the first time, and then run.</span></span> <span data-ttu-id="b93e0-179">При следующем вызове метода будет выполняться существующий JIT-скомпилированный код.</span><span class="sxs-lookup"><span data-stu-id="b93e0-179">The next time the method is run, the existing JIT-compiled native code is run.</span></span> <span data-ttu-id="b93e0-180">Процесс JIT-компиляции и последующего выполнения кода повторяется до завершения выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-180">The process of JIT-compiling and then running the code is repeated until execution is complete.</span></span>  
  
 <span data-ttu-id="b93e0-181">Во время выполнения для управляемого кода доступны такие службы, как сборка мусора, обеспечение безопасности, взаимодействие с неуправляемым кодом, поддержка отладки на нескольких языках, а также поддержка расширенного развертывания и управления версиями.</span><span class="sxs-lookup"><span data-stu-id="b93e0-181">During execution, managed code receives services such as garbage collection, security, interoperability with unmanaged code, cross-language debugging support, and enhanced deployment and versioning support.</span></span>  
  
 <span data-ttu-id="b93e0-182">В Microsoft Windows Vista загрузчик операционной системы выполняет поиск управляемых модулей, анализируя бит в заголовке COFF.</span><span class="sxs-lookup"><span data-stu-id="b93e0-182">In Microsoft Windows Vista, the operating system loader checks for managed modules by examining a bit in the COFF header.</span></span> <span data-ttu-id="b93e0-183">Установленный бит обозначает управляемый модуль.</span><span class="sxs-lookup"><span data-stu-id="b93e0-183">The bit being set denotes a managed module.</span></span> <span data-ttu-id="b93e0-184">При обнаружении управляемых модулей загружается библиотека Mscoree.dll, а подпрограммы `_CorValidateImage` и `_CorImageUnloading` уведомляют загрузчик о загрузке и выгрузке образов управляемых модулей.</span><span class="sxs-lookup"><span data-stu-id="b93e0-184">If the loader detects managed modules, it loads mscoree.dll, and `_CorValidateImage` and `_CorImageUnloading` notify the loader when the managed module images are loaded and unloaded.</span></span> <span data-ttu-id="b93e0-185">Подпрограмма`_CorValidateImage` выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="b93e0-185">`_CorValidateImage` performs the following actions:</span></span>  
  
1. <span data-ttu-id="b93e0-186">Проверяет, является ли код допустимым управляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="b93e0-186">Ensures that the code is valid managed code.</span></span>  
  
2. <span data-ttu-id="b93e0-187">Заменяет точку входа в образе на точку входа в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="b93e0-187">Changes the entry point in the image to an entry point in the runtime.</span></span>  
  
 <span data-ttu-id="b93e0-188">В 64-разрядных системах Windows `_CorValidateImage` изменяет образ, находящийся в памяти, путем преобразования его из формата PE32 в формат PE32+.</span><span class="sxs-lookup"><span data-stu-id="b93e0-188">On 64-bit Windows, `_CorValidateImage` modifies the image that is in memory by transforming it from PE32 to PE32+ format.</span></span>  
  
 [<span data-ttu-id="b93e0-189">Вверх</span><span class="sxs-lookup"><span data-stu-id="b93e0-189">Back to top</span></span>](#introduction)  
  
## <a name="see-also"></a><span data-ttu-id="b93e0-190">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="b93e0-190">See also</span></span>

- [<span data-ttu-id="b93e0-191">Обзор</span><span class="sxs-lookup"><span data-stu-id="b93e0-191">Overview</span></span>](../../docs/framework/get-started/overview.md)
- [<span data-ttu-id="b93e0-192">Независимость от языка и независимые от языка компоненты</span><span class="sxs-lookup"><span data-stu-id="b93e0-192">Language Independence and Language-Independent Components</span></span>](../../docs/standard/language-independence-and-language-independent-components.md)
- [<span data-ttu-id="b93e0-193">Метаданные и компоненты с самоописанием</span><span class="sxs-lookup"><span data-stu-id="b93e0-193">Metadata and Self-Describing Components</span></span>](../../docs/standard/metadata-and-self-describing-components.md)
- [<span data-ttu-id="b93e0-194">Ilasm.exe (ассемблер IL)</span><span class="sxs-lookup"><span data-stu-id="b93e0-194">Ilasm.exe (IL Assembler)</span></span>](../../docs/framework/tools/ilasm-exe-il-assembler.md)
- [<span data-ttu-id="b93e0-195">Безопасность</span><span class="sxs-lookup"><span data-stu-id="b93e0-195">Security</span></span>](../../docs/standard/security/index.md)
- [<span data-ttu-id="b93e0-196">Взаимодействие с неуправляемым кодом</span><span class="sxs-lookup"><span data-stu-id="b93e0-196">Interoperating with Unmanaged Code</span></span>](../../docs/framework/interop/index.md)
- [<span data-ttu-id="b93e0-197">Deployment</span><span class="sxs-lookup"><span data-stu-id="b93e0-197">Deployment</span></span>](../../docs/framework/deployment/net-framework-applications.md)
- [<span data-ttu-id="b93e0-198">Сборки в .NET</span><span class="sxs-lookup"><span data-stu-id="b93e0-198">Assemblies in .NET</span></span>](assembly/index.md)
- [<span data-ttu-id="b93e0-199">Домены приложений</span><span class="sxs-lookup"><span data-stu-id="b93e0-199">Application Domains</span></span>](../../docs/framework/app-domains/application-domains.md)
