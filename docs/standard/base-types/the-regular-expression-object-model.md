---
title: Объектная модель регулярных выражений
description: Обзор объектной модели регулярных выражений в .NET. Вы можете работать с обработчиком регулярных выражений, а также объектами и коллекциями, связанными с сопоставлением, группированием и записью.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- searching with regular expressions, backreferences
- Regex class
- Match class
- pattern-matching with regular expressions, backreferences
- .NET regular expressions, classes
- CaptureCollection class
- Group class
- characters [.NET], backreferences
- substrings
- .NET regular expressions, backreferences
- searching with regular expressions, classes
- backreferences
- Capture class
- repeating groups of characters
- MatchCollection class
- parsing text with regular expressions, backreferences
- regular expressions [.NET]
- characters [.NET], regular expressions
- classes [.NET], regular expression
- regular expressions [.NET], classes
- characters [.NET], metacharacters
- metacharacters, regular expression classes
- metacharacters, backreferences
- parsing text with regular expressions, classes
- regular expressions [.NET], backreferences
- strings [.NET], regular expressions
- pattern-matching with regular expressions, classes
- GroupCollection class
ms.assetid: 49a21470-64ca-4b5a-a889-8e24e3c0af7e
ms.openlocfilehash: 996a8cca8222e3de6517ee6fa7cef3c4f44fc5a9
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/24/2020
ms.locfileid: "95734192"
---
# <a name="the-regular-expression-object-model"></a><span data-ttu-id="012ef-104">Объектная модель регулярных выражений</span><span class="sxs-lookup"><span data-stu-id="012ef-104">The Regular Expression Object Model</span></span>

<a name="introduction"></a> <span data-ttu-id="012ef-105">В этом разделе описывается объектная модель, используемая при работе с регулярными выражениями в .NET.</span><span class="sxs-lookup"><span data-stu-id="012ef-105">This topic describes the object model used in working with .NET regular expressions.</span></span> <span data-ttu-id="012ef-106">Он содержит следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="012ef-106">It contains the following sections:</span></span>  
  
- [<span data-ttu-id="012ef-107">Механизм регулярных выражений</span><span class="sxs-lookup"><span data-stu-id="012ef-107">The Regular Expression Engine</span></span>](#Engine)  
  
- [<span data-ttu-id="012ef-108">Объекты MatchCollection и Match</span><span class="sxs-lookup"><span data-stu-id="012ef-108">The MatchCollection and Match Objects</span></span>](#Match_and_MCollection)  
  
- [<span data-ttu-id="012ef-109">Коллекция Group</span><span class="sxs-lookup"><span data-stu-id="012ef-109">The Group Collection</span></span>](#GroupCollection)  
  
- [<span data-ttu-id="012ef-110">Захватываемая группа</span><span class="sxs-lookup"><span data-stu-id="012ef-110">The Captured Group</span></span>](#the_captured_group)  
  
- [<span data-ttu-id="012ef-111">Коллекция Capture</span><span class="sxs-lookup"><span data-stu-id="012ef-111">The Capture Collection</span></span>](#CaptureCollection)  
  
- [<span data-ttu-id="012ef-112">Отдельный захват</span><span class="sxs-lookup"><span data-stu-id="012ef-112">The Individual Capture</span></span>](#the_individual_capture)  
  
<a name="Engine"></a>

## <a name="the-regular-expression-engine"></a><span data-ttu-id="012ef-113">Механизм регулярных выражений</span><span class="sxs-lookup"><span data-stu-id="012ef-113">The Regular Expression Engine</span></span>  

 <span data-ttu-id="012ef-114">Механизм регулярных выражений в .NET представлен классом <xref:System.Text.RegularExpressions.Regex>.</span><span class="sxs-lookup"><span data-stu-id="012ef-114">The regular expression engine in .NET is represented by the <xref:System.Text.RegularExpressions.Regex> class.</span></span> <span data-ttu-id="012ef-115">Механизм отвечает за синтаксический анализ и компиляцию регулярного выражение, а также выполнение операций, которые сопоставляют шаблон регулярного выражения с входной строкой.</span><span class="sxs-lookup"><span data-stu-id="012ef-115">The regular expression engine is responsible for parsing and compiling a regular expression, and for performing operations that match the regular expression pattern with an input string.</span></span> <span data-ttu-id="012ef-116">Этот механизм представляет центральный компонент объектной модели регулярных выражений .NET.</span><span class="sxs-lookup"><span data-stu-id="012ef-116">The engine is the central component in the .NET regular expression object model.</span></span>  
  
 <span data-ttu-id="012ef-117">Вы можете использовать механизм регулярных выражений одним из двух способов:</span><span class="sxs-lookup"><span data-stu-id="012ef-117">You can use the regular expression engine in either of two ways:</span></span>  
  
- <span data-ttu-id="012ef-118">Вызывая статичные методы класса <xref:System.Text.RegularExpressions.Regex>.</span><span class="sxs-lookup"><span data-stu-id="012ef-118">By calling the static methods of the <xref:System.Text.RegularExpressions.Regex> class.</span></span> <span data-ttu-id="012ef-119">Параметры метода включают в себя входную строку и шаблон регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-119">The method parameters include the input string and the regular expression pattern.</span></span> <span data-ttu-id="012ef-120">Механизм регулярных выражений кэширует регулярные выражения, которые используются в вызовах статичных методов, чтобы повторные вызовы статичных методов регулярных выражений, применяющие одно и то же регулярное выражение, выполнялись относительно быстро.</span><span class="sxs-lookup"><span data-stu-id="012ef-120">The regular expression engine caches regular expressions that are used in static method calls, so repeated calls to static regular expression methods that use the same regular expression offer relatively good performance.</span></span>  
  
- <span data-ttu-id="012ef-121">Создавая экземпляр объекта <xref:System.Text.RegularExpressions.Regex>, передавая регулярное выражение конструктору класса.</span><span class="sxs-lookup"><span data-stu-id="012ef-121">By instantiating a <xref:System.Text.RegularExpressions.Regex> object, by passing a regular expression to the class constructor.</span></span> <span data-ttu-id="012ef-122">В этом случае объект <xref:System.Text.RegularExpressions.Regex> не изменяется (доступен только для чтения) и представляет механизм регулярных выражений, который тесно связана с одним регулярным выражением.</span><span class="sxs-lookup"><span data-stu-id="012ef-122">In this case, the <xref:System.Text.RegularExpressions.Regex> object is immutable (read-only) and represents a regular expression engine that is tightly coupled with a single regular expression.</span></span> <span data-ttu-id="012ef-123">Так как регулярные выражения, используемые экземплярами <xref:System.Text.RegularExpressions.Regex>, не кэшируются, не следует создавать экземпляр объекта <xref:System.Text.RegularExpressions.Regex> несколько раз с одним и тем же регулярным выражением.</span><span class="sxs-lookup"><span data-stu-id="012ef-123">Because regular expressions used by <xref:System.Text.RegularExpressions.Regex> instances are not cached, you should not instantiate a <xref:System.Text.RegularExpressions.Regex> object multiple times with the same regular expression.</span></span>  
  
 <span data-ttu-id="012ef-124">Вы можете вызывать методы класса <xref:System.Text.RegularExpressions.Regex>, чтобы выполнить следующие операции:</span><span class="sxs-lookup"><span data-stu-id="012ef-124">You can call the methods of the <xref:System.Text.RegularExpressions.Regex> class to perform the following operations:</span></span>  
  
- <span data-ttu-id="012ef-125">определить, соответствует ли строка шаблону регулярного выражения;</span><span class="sxs-lookup"><span data-stu-id="012ef-125">Determine whether a string matches a regular expression pattern.</span></span>  
  
- <span data-ttu-id="012ef-126">извлечь одно сопоставление или первое сопоставление;</span><span class="sxs-lookup"><span data-stu-id="012ef-126">Extract a single match or the first match.</span></span>  
  
- <span data-ttu-id="012ef-127">извлечь все сопоставления;</span><span class="sxs-lookup"><span data-stu-id="012ef-127">Extract all matches.</span></span>  
  
- <span data-ttu-id="012ef-128">заменить сопоставленную подстроку;</span><span class="sxs-lookup"><span data-stu-id="012ef-128">Replace a matched substring.</span></span>  
  
- <span data-ttu-id="012ef-129">разделить одну строку на массив строк.</span><span class="sxs-lookup"><span data-stu-id="012ef-129">Split a single string into an array of strings.</span></span>  
  
 <span data-ttu-id="012ef-130">Эти операции описаны в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="012ef-130">These operations are described in the following sections.</span></span>  
  
### <a name="matching-a-regular-expression-pattern"></a><span data-ttu-id="012ef-131">Сопоставление шаблона регулярного выражения</span><span class="sxs-lookup"><span data-stu-id="012ef-131">Matching a Regular Expression Pattern</span></span>  

 <span data-ttu-id="012ef-132">Метод <xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType> возвращает значение `true`, если строка соответствует шаблону; в противном случае возвращается значение `false`.</span><span class="sxs-lookup"><span data-stu-id="012ef-132">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType> method returns `true` if the string matches the pattern, or `false` if it does not.</span></span> <span data-ttu-id="012ef-133">Метод <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> часто используется для проверки входной строки.</span><span class="sxs-lookup"><span data-stu-id="012ef-133">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is often used to validate string input.</span></span> <span data-ttu-id="012ef-134">Например, следующий код проверяет, содержит ли строка допустимый номер социального страхования для США.</span><span class="sxs-lookup"><span data-stu-id="012ef-134">For example, the following code ensures that a string matches a valid social security number in the United States.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/validate1.cs#1)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/validate1.vb#1)]  
  
 <span data-ttu-id="012ef-135">Возможные интерпретации шаблона регулярного выражения `^\d{3}-\d{2}-\d{4}$` показаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-135">The regular expression pattern `^\d{3}-\d{2}-\d{4}$` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-136">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-136">Pattern</span></span>|<span data-ttu-id="012ef-137">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-137">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="012ef-138">Выделение начала входной строки.</span><span class="sxs-lookup"><span data-stu-id="012ef-138">Match the beginning of the input string.</span></span>|  
|`\d{3}`|<span data-ttu-id="012ef-139">Совпадение с тремя десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-139">Match three decimal digits.</span></span>|  
|`-`|<span data-ttu-id="012ef-140">Выделение дефиса.</span><span class="sxs-lookup"><span data-stu-id="012ef-140">Match a hyphen.</span></span>|  
|`\d{2}`|<span data-ttu-id="012ef-141">Совпадение с двумя десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-141">Match two decimal digits.</span></span>|  
|`-`|<span data-ttu-id="012ef-142">Выделение дефиса.</span><span class="sxs-lookup"><span data-stu-id="012ef-142">Match a hyphen.</span></span>|  
|`\d{4}`|<span data-ttu-id="012ef-143">Выделяются 4 десятичные цифры.</span><span class="sxs-lookup"><span data-stu-id="012ef-143">Match four decimal digits.</span></span>|  
|`$`|<span data-ttu-id="012ef-144">Соответствует концу входной строки.</span><span class="sxs-lookup"><span data-stu-id="012ef-144">Match the end of the input string.</span></span>|  
  
### <a name="extracting-a-single-match-or-the-first-match"></a><span data-ttu-id="012ef-145">Извлечение одного сопоставления или первого сопоставления</span><span class="sxs-lookup"><span data-stu-id="012ef-145">Extracting a Single Match or the First Match</span></span>  

 <span data-ttu-id="012ef-146">Метод <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> возвращает объект <xref:System.Text.RegularExpressions.Match>, который содержит сведения о первой подстроке, соответствующей шаблону регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-146">The <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.Match> object that contains information about the first substring that matches a regular expression pattern.</span></span> <span data-ttu-id="012ef-147">Если свойство `Match.Success` возвращает значение `true` (найдено соответствие), вы можете получить информацию о последующих соответствиях, вызвав метод <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-147">If the `Match.Success` property returns `true`, indicating that a match was found, you can retrieve information about subsequent matches by calling the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="012ef-148">Этот метод можно вызывать, пока свойство `Match.Success` не вернет значение `false`.</span><span class="sxs-lookup"><span data-stu-id="012ef-148">These method calls can continue until the `Match.Success` property returns `false`.</span></span> <span data-ttu-id="012ef-149">Например, следующий код использует метод <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> для поиска первого экземпляра повторяющегося слова в строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-149">For example, the following code uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> method to find the first occurrence of a duplicated word in a string.</span></span> <span data-ttu-id="012ef-150">Затем вызывается метод <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> для поиска других экземпляров.</span><span class="sxs-lookup"><span data-stu-id="012ef-150">It then calls the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method to find any additional occurrences.</span></span> <span data-ttu-id="012ef-151">Пример просматривает свойство `Match.Success` после каждого вызова метода, чтобы определить, было ли текущее сопоставление успешным и следует ли вызывать метод <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-151">The example examines the `Match.Success` property after each method call to determine whether the current match was successful and whether a call to the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method should follow.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match1.cs#2)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match1.vb#2)]  
  
 <span data-ttu-id="012ef-152">Возможные интерпретации шаблона регулярного выражения `\b(\w+)\W+(\1)\b` показаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-152">The regular expression pattern `\b(\w+)\W+(\1)\b` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-153">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-153">Pattern</span></span>|<span data-ttu-id="012ef-154">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-154">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="012ef-155">Сопоставление начинается на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-155">Begin the match on a word boundary.</span></span>|  
|`(\w+)`|<span data-ttu-id="012ef-156">Совпадение с одним или несколькими символами слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-156">Match one or more word characters.</span></span> <span data-ttu-id="012ef-157">Это первая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-157">This is the first capturing group.</span></span>|  
|`\W+`|<span data-ttu-id="012ef-158">Совпадение с одним или большим числом несловообразующих символов.</span><span class="sxs-lookup"><span data-stu-id="012ef-158">Match one or more non-word characters.</span></span>|  
|`(\1)`|<span data-ttu-id="012ef-159">Выделение первой захватываемой строки.</span><span class="sxs-lookup"><span data-stu-id="012ef-159">Match the first captured string.</span></span> <span data-ttu-id="012ef-160">Это вторая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-160">This is the second capturing group.</span></span>|  
|`\b`|<span data-ttu-id="012ef-161">Сопоставление заканчивается на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-161">End the match on a word boundary.</span></span>|  
  
### <a name="extracting-all-matches"></a><span data-ttu-id="012ef-162">Извлечение всех сопоставлений</span><span class="sxs-lookup"><span data-stu-id="012ef-162">Extracting All Matches</span></span>  

 <span data-ttu-id="012ef-163">Метод <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> возвращает объект <xref:System.Text.RegularExpressions.MatchCollection>, содержащий сведения о всех сопоставлениях, найденных механизмом регулярных выражений во входной строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-163">The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains information about all matches that the regular expression engine found in the input string.</span></span> <span data-ttu-id="012ef-164">Например, предыдущий пример можно изменить, чтобы вызывать метод <xref:System.Text.RegularExpressions.Regex.Matches%2A> вместо методов <xref:System.Text.RegularExpressions.Regex.Match%2A> и <xref:System.Text.RegularExpressions.Match.NextMatch%2A>.</span><span class="sxs-lookup"><span data-stu-id="012ef-164">For example, the previous example could be rewritten to call the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method instead of the <xref:System.Text.RegularExpressions.Regex.Match%2A> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A> methods.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/matches1.cs#3)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/matches1.vb#3)]  
  
### <a name="replacing-a-matched-substring"></a><span data-ttu-id="012ef-165">Замена сопоставленной подстроки</span><span class="sxs-lookup"><span data-stu-id="012ef-165">Replacing a Matched Substring</span></span>  

 <span data-ttu-id="012ef-166">Метод <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> заменяет каждую подстроку, соответствующую шаблону регулярного выражения, на указанную строку или шаблон регулярного выражения и возвращает всю замененную входную строку.</span><span class="sxs-lookup"><span data-stu-id="012ef-166">The <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method replaces each substring that matches the regular expression pattern with a specified string or regular expression pattern, and returns the entire input string with replacements.</span></span> <span data-ttu-id="012ef-167">Например, следующий код добавляет обозначение денежной единицы США перед десятичным числом в строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-167">For example, the following code adds a U.S. currency symbol before a decimal number in a string.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/replace1.cs#4)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/replace1.vb#4)]  
  
 <span data-ttu-id="012ef-168">Возможные интерпретации шаблона регулярного выражения `\b\d+\.\d{2}\b` показаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-168">The regular expression pattern `\b\d+\.\d{2}\b` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-169">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-169">Pattern</span></span>|<span data-ttu-id="012ef-170">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-170">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="012ef-171">Совпадение должно начинаться на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-171">Begin the match at a word boundary.</span></span>|  
|`\d+`|<span data-ttu-id="012ef-172">Совпадение с одной или несколькими десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-172">Match one or more decimal digits.</span></span>|  
|`\.`|<span data-ttu-id="012ef-173">Сопоставляется точка.</span><span class="sxs-lookup"><span data-stu-id="012ef-173">Match a period.</span></span>|  
|`\d{2}`|<span data-ttu-id="012ef-174">Совпадение с двумя десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-174">Match two decimal digits.</span></span>|  
|`\b`|<span data-ttu-id="012ef-175">Совпадение должно заканчиваться на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-175">End the match at a word boundary.</span></span>|  
  
 <span data-ttu-id="012ef-176">Шаблон замены `$$$&` интерпретируется, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-176">The replacement pattern `$$$&` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-177">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-177">Pattern</span></span>|<span data-ttu-id="012ef-178">Строка замены</span><span class="sxs-lookup"><span data-stu-id="012ef-178">Replacement string</span></span>|  
|-------------|------------------------|  
|`$$`|<span data-ttu-id="012ef-179">Символ доллара ($).</span><span class="sxs-lookup"><span data-stu-id="012ef-179">The dollar sign ($) character.</span></span>|  
|`$&`|<span data-ttu-id="012ef-180">Вся сопоставленная подстрока.</span><span class="sxs-lookup"><span data-stu-id="012ef-180">The entire matched substring.</span></span>|  
  
### <a name="splitting-a-single-string-into-an-array-of-strings"></a><span data-ttu-id="012ef-181">Разделение одной строки на массив строк</span><span class="sxs-lookup"><span data-stu-id="012ef-181">Splitting a Single String into an Array of Strings</span></span>  

 <span data-ttu-id="012ef-182">Метод <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> разделяет входную строку в позициях, заданных соответствием регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-182">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> method splits the input string at the positions defined by a regular expression match.</span></span> <span data-ttu-id="012ef-183">Например, следующий код помещает элементы нумерованного списка в массив строк.</span><span class="sxs-lookup"><span data-stu-id="012ef-183">For example, the following code places the items in a numbered list into a string array.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/split1.cs#5)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/split1.vb#5)]  
  
 <span data-ttu-id="012ef-184">Возможные интерпретации шаблона регулярного выражения `\b\d{1,2}\.\s` показаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-184">The regular expression pattern `\b\d{1,2}\.\s` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-185">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-185">Pattern</span></span>|<span data-ttu-id="012ef-186">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-186">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="012ef-187">Совпадение должно начинаться на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-187">Begin the match at a word boundary.</span></span>|  
|`\d{1,2}`|<span data-ttu-id="012ef-188">Совпадение с одной или двумя десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-188">Match one or two decimal digits.</span></span>|  
|`\.`|<span data-ttu-id="012ef-189">Сопоставляется точка.</span><span class="sxs-lookup"><span data-stu-id="012ef-189">Match a period.</span></span>|  
|`\s`|<span data-ttu-id="012ef-190">Соответствует пробелу.</span><span class="sxs-lookup"><span data-stu-id="012ef-190">Match a white-space character.</span></span>|  
  
<a name="Match_and_MCollection"></a>

## <a name="the-matchcollection-and-match-objects"></a><span data-ttu-id="012ef-191">Объекты MatchCollection и Match</span><span class="sxs-lookup"><span data-stu-id="012ef-191">The MatchCollection and Match Objects</span></span>  

 <span data-ttu-id="012ef-192">Методы Regex возвращают два объекта, входящие в объектную модель регулярного выражения: <xref:System.Text.RegularExpressions.MatchCollection> и <xref:System.Text.RegularExpressions.Match>.</span><span class="sxs-lookup"><span data-stu-id="012ef-192">Regex methods return two objects that are part of the regular expression object model: the <xref:System.Text.RegularExpressions.MatchCollection> object, and the <xref:System.Text.RegularExpressions.Match> object.</span></span>  
  
<a name="the_match_collection"></a>

### <a name="the-match-collection"></a><span data-ttu-id="012ef-193">Коллекция Match</span><span class="sxs-lookup"><span data-stu-id="012ef-193">The Match Collection</span></span>  

 <span data-ttu-id="012ef-194">Метод <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> возвращает объект <xref:System.Text.RegularExpressions.MatchCollection>, содержащий объекты <xref:System.Text.RegularExpressions.Match>, которые представляют все сопоставления, найденных механизмом регулярных выражений, в том порядке, в котором они присутствуют во входной строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-194">The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains <xref:System.Text.RegularExpressions.Match> objects that represent all the matches that the regular expression engine found, in the order in which they occur in the input string.</span></span> <span data-ttu-id="012ef-195">Если соответствий нет, метод возвращает объект <xref:System.Text.RegularExpressions.MatchCollection> без членов.</span><span class="sxs-lookup"><span data-stu-id="012ef-195">If there are no matches, the method returns a <xref:System.Text.RegularExpressions.MatchCollection> object with no members.</span></span> <span data-ttu-id="012ef-196">Свойство <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> позволяет получить доступ к отдельным членам коллекции по индексу (от нуля до значения свойства <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> минус 1).</span><span class="sxs-lookup"><span data-stu-id="012ef-196">The <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property lets you access individual members of the collection by index, from zero to one less than the value of the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="012ef-197"><xref:System.Text.RegularExpressions.MatchCollection.Item%2A> — это индексатор коллекции (для C#) и свойство по умолчанию (для Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="012ef-197"><xref:System.Text.RegularExpressions.MatchCollection.Item%2A> is the collection's indexer (in C#) and default property (in Visual Basic).</span></span>  
  
 <span data-ttu-id="012ef-198">По умолчанию вызов метода <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> использует отложенные вычисления для заполнения объекта <xref:System.Text.RegularExpressions.MatchCollection>.</span><span class="sxs-lookup"><span data-stu-id="012ef-198">By default, the call to the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method uses lazy evaluation to populate the <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="012ef-199">Доступ к свойствам, которым требуется полностью заполненная коллекция, например свойства <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> и <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType>, может быть связан с дополнительными затратами.</span><span class="sxs-lookup"><span data-stu-id="012ef-199">Access to properties that require a fully populated collection, such as the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> properties, may involve a performance penalty.</span></span> <span data-ttu-id="012ef-200">Поэтому мы рекомендуем обращаться к коллекции, используя объект <xref:System.Collections.IEnumerator>, возвращаемый методом <xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-200">As a result, we recommend that you access the collection by using the <xref:System.Collections.IEnumerator> object that is returned by the <xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="012ef-201">Некоторые языки предоставляют конструкции, такие как `For Each` в Visual Basic и `foreach` в C#, которые создают оболочку для интерфейса <xref:System.Collections.IEnumerator> коллекции.</span><span class="sxs-lookup"><span data-stu-id="012ef-201">Individual languages provide constructs, such as `For Each` in Visual Basic and `foreach` in C#, that wrap the collection's <xref:System.Collections.IEnumerator> interface.</span></span>  
  
 <span data-ttu-id="012ef-202">Следующий пример использует метод <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> для заполнения объекта <xref:System.Text.RegularExpressions.MatchCollection> всеми соответствиями, найденными во входной строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-202">The following example uses the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method to populate a <xref:System.Text.RegularExpressions.MatchCollection> object with all the matches found in an input string.</span></span> <span data-ttu-id="012ef-203">Пример перечисляет коллекцию, копирует соответствия в массив строк и записывает позиции символов в целочисленный массив.</span><span class="sxs-lookup"><span data-stu-id="012ef-203">The example enumerates the collection, copies the matches to a string array, and records the character positions in an integer array.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/matchcollection1.cs#6)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/matchcollection1.vb#6)]  
  
<a name="the_match"></a>

### <a name="the-match"></a><span data-ttu-id="012ef-204">Класс Match</span><span class="sxs-lookup"><span data-stu-id="012ef-204">The Match</span></span>  

 <span data-ttu-id="012ef-205">Класс <xref:System.Text.RegularExpressions.Match> представляет результат одного сопоставления регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-205">The <xref:System.Text.RegularExpressions.Match> class represents the result of a single regular expression match.</span></span> <span data-ttu-id="012ef-206">Доступ к объектам <xref:System.Text.RegularExpressions.Match> можно получить двумя способами:</span><span class="sxs-lookup"><span data-stu-id="012ef-206">You can access <xref:System.Text.RegularExpressions.Match> objects in two ways:</span></span>  
  
- <span data-ttu-id="012ef-207">Извлекая их из объекта <xref:System.Text.RegularExpressions.MatchCollection>, который возвращается методом <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-207">By retrieving them from the <xref:System.Text.RegularExpressions.MatchCollection> object that is returned by the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="012ef-208">Для извлечения отдельных объектов <xref:System.Text.RegularExpressions.Match> выполните итерацию коллекции, воспользовавшись конструкцией `foreach` (в C#) или `For Each`...`Next` (в Visual Basic), либо используйте свойство <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> для извлечения конкретного объекта <xref:System.Text.RegularExpressions.Match> по индексу или по имени.</span><span class="sxs-lookup"><span data-stu-id="012ef-208">To retrieve individual <xref:System.Text.RegularExpressions.Match> objects, iterate the collection by using a `foreach` (in C#) or `For Each`...`Next` (in Visual Basic) construct, or use the <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific <xref:System.Text.RegularExpressions.Match> object either by index or by name.</span></span> <span data-ttu-id="012ef-209">Вы также можете получить отдельные объекты <xref:System.Text.RegularExpressions.Match> из коллекции, циклически проходя по коллекции по индексу (от нуля до числа объектов в коллекции минус 1).</span><span class="sxs-lookup"><span data-stu-id="012ef-209">You can also retrieve individual <xref:System.Text.RegularExpressions.Match> objects from the collection by iterating the collection by index, from zero to one less that the number of objects in the collection.</span></span> <span data-ttu-id="012ef-210">Однако этот метод не использует отложенные вычисления, так как он обращается к свойству <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-210">However, this method does not take advantage of lazy evaluation, because it accesses the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property.</span></span>  
  
     <span data-ttu-id="012ef-211">Следующий пример извлекает отдельные объекты <xref:System.Text.RegularExpressions.Match> из объекта <xref:System.Text.RegularExpressions.MatchCollection>, циклически перебирая коллекцию с помощью конструкции `foreach` или `For Each`...`Next`.</span><span class="sxs-lookup"><span data-stu-id="012ef-211">The following example retrieves individual <xref:System.Text.RegularExpressions.Match> objects from a <xref:System.Text.RegularExpressions.MatchCollection> object by iterating the collection using the `foreach` or `For Each`...`Next` construct.</span></span> <span data-ttu-id="012ef-212">Регулярное выражение просто сопоставляет строку "abc" во входной строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-212">The regular expression simply matches the string "abc" in the input string.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match2.cs#7)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match2.vb#7)]  
  
- <span data-ttu-id="012ef-213">Вызывая метод <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType>, который возвращает объект <xref:System.Text.RegularExpressions.Match>, представляющий первое соответствие в строке или ее части.</span><span class="sxs-lookup"><span data-stu-id="012ef-213">By calling the <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method, which returns a <xref:System.Text.RegularExpressions.Match> object that represents the first match in a string or a portion of a string.</span></span> <span data-ttu-id="012ef-214">Вы можете определить, найдено ли соответствие, получив значение свойства `Match.Success`.</span><span class="sxs-lookup"><span data-stu-id="012ef-214">You can determine whether the match has been found by retrieving the value of the `Match.Success` property.</span></span> <span data-ttu-id="012ef-215">Чтобы извлечь объекты <xref:System.Text.RegularExpressions.Match>, представляющие последующие соответствия, вызывайте метод <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>, пока свойство `Success` полученного объекта <xref:System.Text.RegularExpressions.Match> не будет иметь значение `false`.</span><span class="sxs-lookup"><span data-stu-id="012ef-215">To retrieve <xref:System.Text.RegularExpressions.Match> objects that represent subsequent matches, call the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method repeatedly, until the `Success` property of the returned <xref:System.Text.RegularExpressions.Match> object is `false`.</span></span>  
  
     <span data-ttu-id="012ef-216">Следующий пример использует методы <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> и <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> для сопоставления строки "abc" во входной строке.</span><span class="sxs-lookup"><span data-stu-id="012ef-216">The following example uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> methods to match the string "abc" in the input string.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match3.cs#8)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match3.vb#8)]  
  
 <span data-ttu-id="012ef-217">Два свойства класса <xref:System.Text.RegularExpressions.Match> возвращают объекты коллекции:</span><span class="sxs-lookup"><span data-stu-id="012ef-217">Two properties of the <xref:System.Text.RegularExpressions.Match> class return collection objects:</span></span>  
  
- <span data-ttu-id="012ef-218">Свойство <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> возвращает объект <xref:System.Text.RegularExpressions.GroupCollection>, который содержит сведения о подстроках, соответствующих захватываемым группам в шаблоне регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-218">The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains information about the substrings that match capturing groups in the regular expression pattern.</span></span>  
  
- <span data-ttu-id="012ef-219">Свойство `Match.Captures` возвращает объект <xref:System.Text.RegularExpressions.CaptureCollection> с ограниченным применением.</span><span class="sxs-lookup"><span data-stu-id="012ef-219">The `Match.Captures` property returns a <xref:System.Text.RegularExpressions.CaptureCollection> object that is of limited use.</span></span> <span data-ttu-id="012ef-220">Коллекция не заполняется для объекта <xref:System.Text.RegularExpressions.Match>, свойство `Success` которого имеет значение `false`.</span><span class="sxs-lookup"><span data-stu-id="012ef-220">The collection is not populated for a <xref:System.Text.RegularExpressions.Match> object whose `Success` property is `false`.</span></span> <span data-ttu-id="012ef-221">В противном случае она содержит один объект <xref:System.Text.RegularExpressions.Capture>, содержащий такие же данные, что и объект <xref:System.Text.RegularExpressions.Match>.</span><span class="sxs-lookup"><span data-stu-id="012ef-221">Otherwise, it contains a single <xref:System.Text.RegularExpressions.Capture> object that has the same information as the <xref:System.Text.RegularExpressions.Match> object.</span></span>  
  
 <span data-ttu-id="012ef-222">Дополнительные сведения об этих объектах см. в разделах [Коллекция Group](#GroupCollection) и [Коллекция Capture](#CaptureCollection) далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="012ef-222">For more information about these objects, see [The Group Collection](#GroupCollection) and [The Capture Collection](#CaptureCollection) sections later in this topic.</span></span>  
  
 <span data-ttu-id="012ef-223">Два дополнительных свойства класса <xref:System.Text.RegularExpressions.Match> предоставляют сведения о соответствии.</span><span class="sxs-lookup"><span data-stu-id="012ef-223">Two additional properties of the <xref:System.Text.RegularExpressions.Match> class provide information about the match.</span></span> <span data-ttu-id="012ef-224">Свойство `Match.Value` возвращает подстроку из входной строки, соответствующую шаблону регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-224">The `Match.Value` property returns the substring in the input string that matches the regular expression pattern.</span></span> <span data-ttu-id="012ef-225">Свойства `Match.Index` возвращает начальную позицию сопоставленной подстроки во входной строке с основанием ноль.</span><span class="sxs-lookup"><span data-stu-id="012ef-225">The `Match.Index` property returns the zero-based starting position of the matched string in the input string.</span></span>  
  
 <span data-ttu-id="012ef-226">Класс <xref:System.Text.RegularExpressions.Match> также содержит два метода сопоставления шаблона:</span><span class="sxs-lookup"><span data-stu-id="012ef-226">The <xref:System.Text.RegularExpressions.Match> class also has two pattern-matching methods:</span></span>  
  
- <span data-ttu-id="012ef-227">Метод <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> ищет совпадение после соответствия, представленного текущим объектом <xref:System.Text.RegularExpressions.Match>, и возвращает объект <xref:System.Text.RegularExpressions.Match>, представляющий соответствие.</span><span class="sxs-lookup"><span data-stu-id="012ef-227">The <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method finds the match after the match represented by the current <xref:System.Text.RegularExpressions.Match> object, and returns a <xref:System.Text.RegularExpressions.Match> object that represents that match.</span></span>  
  
- <span data-ttu-id="012ef-228">Метод <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> выполняет указанную замену в сопоставленной строке и возвращает результат.</span><span class="sxs-lookup"><span data-stu-id="012ef-228">The <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method performs a specified replacement operation on the matched string and returns the result.</span></span>  
  
 <span data-ttu-id="012ef-229">В следующем примере метод <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> используется для добавления символа $ и пробела перед каждым числом из двух дробных разрядов.</span><span class="sxs-lookup"><span data-stu-id="012ef-229">The following example uses the <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method to prepend a $ symbol and a space before every number that includes two fractional digits.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/result1.cs#9)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/result1.vb#9)]  
  
 <span data-ttu-id="012ef-230">Шаблон регулярного выражения `\b\d+(,\d{3})*\.\d{2}\b` определяется, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-230">The regular expression pattern `\b\d+(,\d{3})*\.\d{2}\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-231">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-231">Pattern</span></span>|<span data-ttu-id="012ef-232">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-232">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="012ef-233">Совпадение должно начинаться на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-233">Begin the match at a word boundary.</span></span>|  
|`\d+`|<span data-ttu-id="012ef-234">Совпадение с одной или несколькими десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-234">Match one or more decimal digits.</span></span>|  
|`(,\d{3})*`|<span data-ttu-id="012ef-235">Совпадение с нулем или несколькими вхождениями запятой, за которыми следуют три десятичные цифры.</span><span class="sxs-lookup"><span data-stu-id="012ef-235">Match zero or more occurrences of a comma followed by three decimal digits.</span></span>|  
|`\.`|<span data-ttu-id="012ef-236">Совпадение с символом десятичной точки.</span><span class="sxs-lookup"><span data-stu-id="012ef-236">Match the decimal point character.</span></span>|  
|`\d{2}`|<span data-ttu-id="012ef-237">Совпадение с двумя десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-237">Match two decimal digits.</span></span>|  
|`\b`|<span data-ttu-id="012ef-238">Совпадение должно заканчиваться на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-238">End the match at a word boundary.</span></span>|  
  
 <span data-ttu-id="012ef-239">Шаблон замены `$$ $&` указывает, что сопоставленную подстроку следует заменить на символ доллара ($) (шаблон `$$`), пробел и значение соответствия (шаблон `$&`).</span><span class="sxs-lookup"><span data-stu-id="012ef-239">The replacement pattern `$$ $&` indicates that the matched substring should be replaced by a dollar sign ($) symbol (the `$$` pattern), a space, and the value of the match (the `$&` pattern).</span></span>  
  
 [<span data-ttu-id="012ef-240">К началу</span><span class="sxs-lookup"><span data-stu-id="012ef-240">Back to top</span></span>](#introduction)  
  
<a name="GroupCollection"></a>

## <a name="the-group-collection"></a><span data-ttu-id="012ef-241">Коллекция Group</span><span class="sxs-lookup"><span data-stu-id="012ef-241">The Group Collection</span></span>  

 <span data-ttu-id="012ef-242">Свойство <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> возвращает объект <xref:System.Text.RegularExpressions.GroupCollection>, содержащий объекты <xref:System.Text.RegularExpressions.Group>, которые представляют захватываемые группы в одном соответствии.</span><span class="sxs-lookup"><span data-stu-id="012ef-242">The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains <xref:System.Text.RegularExpressions.Group> objects that represent captured groups in a single match.</span></span> <span data-ttu-id="012ef-243">Первый объект <xref:System.Text.RegularExpressions.Group> в коллекции (объект с нулевым индексом) представляет все сопоставление.</span><span class="sxs-lookup"><span data-stu-id="012ef-243">The first <xref:System.Text.RegularExpressions.Group> object in the collection (at index 0) represents the entire match.</span></span> <span data-ttu-id="012ef-244">Каждый последующий объект представляет результаты одной захватываемой группы.</span><span class="sxs-lookup"><span data-stu-id="012ef-244">Each object that follows represents the results of a single capturing group.</span></span>  
  
 <span data-ttu-id="012ef-245">Вы можете извлечь отдельные объекты <xref:System.Text.RegularExpressions.Group> из коллекции, используя свойство <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-245">You can retrieve individual <xref:System.Text.RegularExpressions.Group> objects in the collection by using the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="012ef-246">Неименованные группы можно извлечь по их номеру в коллекции, а именованные группы — по имени или номеру.</span><span class="sxs-lookup"><span data-stu-id="012ef-246">You can retrieve unnamed groups by their ordinal position in the collection, and retrieve named groups either by name or by ordinal position.</span></span> <span data-ttu-id="012ef-247">Неименованные выделения идут в коллекции первыми и индексируются слева направо в том порядке, в котором они указаны в шаблоне регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-247">Unnamed captures appear first in the collection, and are indexed from left to right in the order in which they appear in the regular expression pattern.</span></span> <span data-ttu-id="012ef-248">Именованные выделения индексируются после неименованных слева направо в том порядке, в котором они указаны в шаблоне регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-248">Named captures are indexed after unnamed captures, from left to right in the order in which they appear in the regular expression pattern.</span></span> <span data-ttu-id="012ef-249">Чтобы определить, какие нумерованные группы доступны в коллекции, возвращаемой для определенного метода сопоставления регулярного выражения, вызовите метод <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType> экземпляра.</span><span class="sxs-lookup"><span data-stu-id="012ef-249">To determine what numbered groups are available in the collection returned for a particular regular expression matching method, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="012ef-250">Чтобы определить, какие именованные группы доступны в коллекции, вызовите метод <xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType> экземпляра.</span><span class="sxs-lookup"><span data-stu-id="012ef-250">To determine what named groups are available in the collection, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="012ef-251">Оба метода полезны в процедурах общего назначения, которые анализируют соответствия, найденные любым регулярным выражением.</span><span class="sxs-lookup"><span data-stu-id="012ef-251">Both methods are particularly useful in general-purpose routines that analyze the matches found by any regular expression.</span></span>  
  
 <span data-ttu-id="012ef-252">Свойство <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> — это индексатор коллекции для C# и свойство объекта по умолчанию для Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="012ef-252">The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property is the indexer of the collection in C# and the collection object's default property in Visual Basic.</span></span> <span data-ttu-id="012ef-253">Это значит, что доступ к отдельным объектам <xref:System.Text.RegularExpressions.Group> можно получить по индексу (или, для именованных групп, по имени) следующим образом:</span><span class="sxs-lookup"><span data-stu-id="012ef-253">This means that individual <xref:System.Text.RegularExpressions.Group> objects can be accessed by index (or by name, in the case of named groups) as follows:</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#13](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/groupsyntax1.cs#13)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/groupsyntax1.vb#13)]  
  
 <span data-ttu-id="012ef-254">В следующем примере определяется регулярное выражение, которое использует конструкции группировки для выделения месяца, дня и года из даты.</span><span class="sxs-lookup"><span data-stu-id="012ef-254">The following example defines a regular expression that uses grouping constructs to capture the month, day, and year of a date.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/groupcollection1.cs#10)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/groupcollection1.vb#10)]  
  
 <span data-ttu-id="012ef-255">Шаблон регулярного выражения `\b(\w+)\s(\d{1,2}),\s(\d{4})\b` определяется, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-255">The regular expression pattern `\b(\w+)\s(\d{1,2}),\s(\d{4})\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-256">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-256">Pattern</span></span>|<span data-ttu-id="012ef-257">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-257">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="012ef-258">Совпадение должно начинаться на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-258">Begin the match at a word boundary.</span></span>|  
|`(\w+)`|<span data-ttu-id="012ef-259">Совпадение с одним или несколькими символами слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-259">Match one or more word characters.</span></span> <span data-ttu-id="012ef-260">Это первая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-260">This is the first capturing group.</span></span>|  
|`\s`|<span data-ttu-id="012ef-261">Соответствует пробелу.</span><span class="sxs-lookup"><span data-stu-id="012ef-261">Match a white-space character.</span></span>|  
|`(\d{1,2})`|<span data-ttu-id="012ef-262">Совпадение с одной или двумя десятичными цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-262">Match one or two decimal digits.</span></span> <span data-ttu-id="012ef-263">Это вторая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-263">This is the second capturing group.</span></span>|  
|`,`|<span data-ttu-id="012ef-264">Сопоставление запятой.</span><span class="sxs-lookup"><span data-stu-id="012ef-264">Match a comma.</span></span>|  
|`\s`|<span data-ttu-id="012ef-265">Соответствует пробелу.</span><span class="sxs-lookup"><span data-stu-id="012ef-265">Match a white-space character.</span></span>|  
|`(\d{4})`|<span data-ttu-id="012ef-266">Выделяются 4 десятичные цифры.</span><span class="sxs-lookup"><span data-stu-id="012ef-266">Match four decimal digits.</span></span> <span data-ttu-id="012ef-267">Это третья группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-267">This is the third capturing group.</span></span>|  
|`\b`|<span data-ttu-id="012ef-268">Сопоставление заканчивается на границе слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-268">End the match on a word boundary.</span></span>|  
  
 [<span data-ttu-id="012ef-269">К началу</span><span class="sxs-lookup"><span data-stu-id="012ef-269">Back to top</span></span>](#introduction)  
  
<a name="the_captured_group"></a>

## <a name="the-captured-group"></a><span data-ttu-id="012ef-270">Захватываемая группа</span><span class="sxs-lookup"><span data-stu-id="012ef-270">The Captured Group</span></span>  

 <span data-ttu-id="012ef-271">Класс <xref:System.Text.RegularExpressions.Group> представляет результат одной захватываемой группы.</span><span class="sxs-lookup"><span data-stu-id="012ef-271">The <xref:System.Text.RegularExpressions.Group> class represents the result from a single capturing group.</span></span> <span data-ttu-id="012ef-272">Объекты Group, представляющие захватываемые группы, заданные в регулярном выражении, возвращаются свойством <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> объекта <xref:System.Text.RegularExpressions.GroupCollection>, который возвращается свойством <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-272">Group objects that represent the capturing groups defined in a regular expression are returned by the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property of the <xref:System.Text.RegularExpressions.GroupCollection> object returned by the <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="012ef-273">Свойство <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> — это индексатор (для C#) и свойство по умолчанию (для Visual Basic) класса <xref:System.Text.RegularExpressions.Group>.</span><span class="sxs-lookup"><span data-stu-id="012ef-273">The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property is the indexer (in C#) and the default property (in Visual Basic) of the <xref:System.Text.RegularExpressions.Group> class.</span></span> <span data-ttu-id="012ef-274">Вы также можете извлечь отдельные члены, циклически перебирая коллекцию с помощью конструкции `foreach` или `For Each`.</span><span class="sxs-lookup"><span data-stu-id="012ef-274">You can also retrieve individual members by iterating the collection using the `foreach` or `For Each` construct.</span></span> <span data-ttu-id="012ef-275">Пример см. в предыдущем разделе.</span><span class="sxs-lookup"><span data-stu-id="012ef-275">For an example, see the previous section.</span></span>  
  
 <span data-ttu-id="012ef-276">В следующем примере вложенные конструкции группировки используются для записи подстрок в группы.</span><span class="sxs-lookup"><span data-stu-id="012ef-276">The following example uses nested grouping constructs to capture substrings into groups.</span></span> <span data-ttu-id="012ef-277">Шаблон регулярного выражения `(a(b))c` сопоставляет строку "abc".</span><span class="sxs-lookup"><span data-stu-id="012ef-277">The regular expression pattern `(a(b))c` matches the string "abc".</span></span> <span data-ttu-id="012ef-278">Он назначает подстроку "ab" первой захватываемой группе, а подстроку "b" — второй захватываемой группе.</span><span class="sxs-lookup"><span data-stu-id="012ef-278">It assigns the substring "ab" to the first capturing group, and the substring "b" to the second capturing group.</span></span>  
  
 [!code-csharp[RegularExpressions.Classes#6](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#6)]
 [!code-vb[RegularExpressions.Classes#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#6)]  
  
 <span data-ttu-id="012ef-279">В следующем примере именованные конструкции группировки используются для выделения подстрок из строки, содержащей данные в формате "DATANAME:VALUE", которые регулярное выражение разделяет в позиции двоеточия (:).</span><span class="sxs-lookup"><span data-stu-id="012ef-279">The following example uses named grouping constructs to capture substrings from a string that contains data in the format "DATANAME:VALUE", which the regular expression splits at the colon (:).</span></span>  
  
 [!code-csharp[RegularExpressions.Classes#8](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#8)]
 [!code-vb[RegularExpressions.Classes#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#8)]  
  
 <span data-ttu-id="012ef-280">Шаблон регулярного выражения `^(?<name>\w+):(?<value>\w+)` определяется, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-280">The regular expression pattern `^(?<name>\w+):(?<value>\w+)` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-281">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-281">Pattern</span></span>|<span data-ttu-id="012ef-282">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-282">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="012ef-283">Начало совпадения в начале входной строки.</span><span class="sxs-lookup"><span data-stu-id="012ef-283">Begin the match at the beginning of the input string.</span></span>|  
|`(?<name>\w+)`|<span data-ttu-id="012ef-284">Совпадение с одним или несколькими символами слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-284">Match one or more word characters.</span></span> <span data-ttu-id="012ef-285">Имя захватываемой группы — `name`.</span><span class="sxs-lookup"><span data-stu-id="012ef-285">The name of this capturing group is `name`.</span></span>|  
|`:`|<span data-ttu-id="012ef-286">Сопоставление двоеточия.</span><span class="sxs-lookup"><span data-stu-id="012ef-286">Match a colon.</span></span>|  
|`(?<value>\w+)`|<span data-ttu-id="012ef-287">Совпадение с одним или несколькими символами слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-287">Match one or more word characters.</span></span> <span data-ttu-id="012ef-288">Имя захватываемой группы — `value`.</span><span class="sxs-lookup"><span data-stu-id="012ef-288">The name of this capturing group is `value`.</span></span>|  
  
 <span data-ttu-id="012ef-289">Свойства класса <xref:System.Text.RegularExpressions.Group> предоставляют сведения о захватываемой группе. Свойство `Group.Value` содержит выделенную подстроку, свойство `Group.Index` указывает начальную позицию захватываемой группы во входном тексте, свойство `Group.Length` содержит длину выделенного текста, а свойство `Group.Success` указывает, соответствует ли подстрока шаблону, заданному захватываемой группой.</span><span class="sxs-lookup"><span data-stu-id="012ef-289">The properties of the <xref:System.Text.RegularExpressions.Group> class provide information about the captured group: The `Group.Value` property contains the captured substring, the `Group.Index` property indicates the starting position of the captured group in the input text, the `Group.Length` property contains the length of the captured text, and the `Group.Success` property indicates whether a substring matched the pattern defined by the capturing group.</span></span>  
  
 <span data-ttu-id="012ef-290">Применение квантификаторов к группе (см. раздел [Квантификаторы](quantifiers-in-regular-expressions.md)) изменяет связь одного выделения в захватываемой группе двумя способами:</span><span class="sxs-lookup"><span data-stu-id="012ef-290">Applying quantifiers to a group (for more information, see [Quantifiers](quantifiers-in-regular-expressions.md)) modifies the relationship of one capture per capturing group in two ways:</span></span>  
  
- <span data-ttu-id="012ef-291">Если квантификатор `*` или `*?` (который указывает ноль или больше соответствий) применен к группе, во входной строке может отсутствовать соответствие захватываемой группе.</span><span class="sxs-lookup"><span data-stu-id="012ef-291">If the `*` or `*?` quantifier (which specifies zero or more matches) is applied to a group, a capturing group may not have a match in the input string.</span></span> <span data-ttu-id="012ef-292">Если выделенного текста нет, свойства объекта <xref:System.Text.RegularExpressions.Group> задаются, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-292">When there is no captured text, the properties of the <xref:System.Text.RegularExpressions.Group> object are set as shown in the following table.</span></span>  
  
    |<span data-ttu-id="012ef-293">Свойство объекта Group</span><span class="sxs-lookup"><span data-stu-id="012ef-293">Group property</span></span>|<span data-ttu-id="012ef-294">Значение</span><span class="sxs-lookup"><span data-stu-id="012ef-294">Value</span></span>|  
    |--------------------|-----------|  
    |`Success`|`false`|  
    |`Value`|<xref:System.String.Empty?displayProperty=nameWithType>|  
    |`Length`|<span data-ttu-id="012ef-295">0</span><span class="sxs-lookup"><span data-stu-id="012ef-295">0</span></span>|  
  
     <span data-ttu-id="012ef-296">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="012ef-296">The following example provides an illustration.</span></span> <span data-ttu-id="012ef-297">В шаблоне регулярного выражения `aaa(bbb)*ccc` первая захватываемая группа (подстрока "bbb") может быть сопоставлена ноль или больше раз.</span><span class="sxs-lookup"><span data-stu-id="012ef-297">In the regular expression pattern `aaa(bbb)*ccc`, the first capturing group (the substring "bbb") can be matched zero or more times.</span></span> <span data-ttu-id="012ef-298">Так как входная строка "aaaccc" соответствует шаблону, захватываемая группа не имеет соответствия.</span><span class="sxs-lookup"><span data-stu-id="012ef-298">Because the input string "aaaccc" matches the pattern, the capturing group does not have a match.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/nocapture1.cs#11)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/nocapture1.vb#11)]  
  
- <span data-ttu-id="012ef-299">Квантификаторы могут сопоставлять множество вхождений шаблона, заданного захватываемой группой.</span><span class="sxs-lookup"><span data-stu-id="012ef-299">Quantifiers can match multiple occurrences of a pattern that is defined by a capturing group.</span></span> <span data-ttu-id="012ef-300">В этом случае свойства `Value` и `Length` объекта <xref:System.Text.RegularExpressions.Group> содержат сведения только о последней выделенной подстроке.</span><span class="sxs-lookup"><span data-stu-id="012ef-300">In this case, the `Value` and `Length` properties of a <xref:System.Text.RegularExpressions.Group> object contain information only about the last captured substring.</span></span> <span data-ttu-id="012ef-301">Например, следующее регулярное выражение сопоставляет предложение, заканчивающееся на точку.</span><span class="sxs-lookup"><span data-stu-id="012ef-301">For example, the following regular expression matches a single sentence that ends in a period.</span></span> <span data-ttu-id="012ef-302">Оно использует две конструкции группировки: первая выделяет отдельные слова вместе с пробелом, вторая выделяет отдельные слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-302">It uses two grouping constructs: The first captures individual words along with a white-space character; the second captures individual words.</span></span> <span data-ttu-id="012ef-303">Как видно из результата выполнения примера, хотя регулярное выражение успешно выделяет все предложение, вторая захватываемая группа выделяет только последнее слово.</span><span class="sxs-lookup"><span data-stu-id="012ef-303">As the output from the example shows, although the regular expression succeeds in capturing an entire sentence, the second capturing group captures only the last word.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/lastcapture1.cs#12)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/lastcapture1.vb#12)]  
  
 [<span data-ttu-id="012ef-304">К началу</span><span class="sxs-lookup"><span data-stu-id="012ef-304">Back to top</span></span>](#introduction)  
  
<a name="CaptureCollection"></a>

## <a name="the-capture-collection"></a><span data-ttu-id="012ef-305">Коллекция Capture</span><span class="sxs-lookup"><span data-stu-id="012ef-305">The Capture Collection</span></span>  

 <span data-ttu-id="012ef-306">Объект <xref:System.Text.RegularExpressions.Group> содержит сведения только о последнем выделении.</span><span class="sxs-lookup"><span data-stu-id="012ef-306">The <xref:System.Text.RegularExpressions.Group> object contains information only about the last capture.</span></span> <span data-ttu-id="012ef-307">Однако весь набор выделений, созданный захватываемой группой, по-прежнему доступен из объекта <xref:System.Text.RegularExpressions.CaptureCollection>, возвращаемого свойством <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="012ef-307">However, the entire set of captures made by a capturing group is still available from the <xref:System.Text.RegularExpressions.CaptureCollection> object that is returned by the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="012ef-308">Каждый член коллекции — это объект <xref:System.Text.RegularExpressions.Capture>, представляющий выделение этой захватываемой группы в порядке захвата (и, следовательно, в порядке сопоставления выделенных строк слева направо во входной строке).</span><span class="sxs-lookup"><span data-stu-id="012ef-308">Each member of the collection is a <xref:System.Text.RegularExpressions.Capture> object that represents a capture made by that capturing group, in the order in which they were captured (and, therefore, in the order in which the captured strings were matched from left to right in the input string).</span></span> <span data-ttu-id="012ef-309">Вы можете извлечь отдельные объекты <xref:System.Text.RegularExpressions.Capture> из коллекции одним из двух способов:</span><span class="sxs-lookup"><span data-stu-id="012ef-309">You can retrieve individual <xref:System.Text.RegularExpressions.Capture> objects from the collection in either of two ways:</span></span>  
  
- <span data-ttu-id="012ef-310">циклически перебирая коллекцию с помощью конструкции `foreach` (для C#) или `For Each` (для Visual Basic);</span><span class="sxs-lookup"><span data-stu-id="012ef-310">By iterating through the collection using a construct such as `foreach` (in C#) or `For Each` (in Visual Basic).</span></span>  
  
- <span data-ttu-id="012ef-311">используя свойство <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType> для извлечения определенного объекта по индексу.</span><span class="sxs-lookup"><span data-stu-id="012ef-311">By using the <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific object by index.</span></span> <span data-ttu-id="012ef-312">Свойство <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A> — это свойство по умолчанию (для Visual Basic) индексатор (для C#) класса <xref:System.Text.RegularExpressions.CaptureCollection>.</span><span class="sxs-lookup"><span data-stu-id="012ef-312">The <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A> property is the <xref:System.Text.RegularExpressions.CaptureCollection> object's default property (in Visual Basic) or indexer (in C#).</span></span>  
  
 <span data-ttu-id="012ef-313">Если квантификатор не применен к захватываемой группе, объект <xref:System.Text.RegularExpressions.CaptureCollection> содержит один объект <xref:System.Text.RegularExpressions.Capture>, который не представляет особого интереса, так как он содержит сведения о том же соответствии, что и объект <xref:System.Text.RegularExpressions.Group>.</span><span class="sxs-lookup"><span data-stu-id="012ef-313">If a quantifier is not applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains a single <xref:System.Text.RegularExpressions.Capture> object that is of little interest, because it provides information about the same match as its <xref:System.Text.RegularExpressions.Group> object.</span></span> <span data-ttu-id="012ef-314">Если к захватываемой группе применен квантификатор, объект <xref:System.Text.RegularExpressions.CaptureCollection> содержит все выделения захватываемой группы, а последний член коллекции представляет то же выделение, что и объект <xref:System.Text.RegularExpressions.Group>.</span><span class="sxs-lookup"><span data-stu-id="012ef-314">If a quantifier is applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains all captures made by the capturing group, and the last member of the collection represents the same capture as the <xref:System.Text.RegularExpressions.Group> object.</span></span>  
  
 <span data-ttu-id="012ef-315">Например, если использовать шаблон регулярного выражения `((a(b))c)+` (где квантификатор "+" указывает одно или несколько соответствий) для выделения соответствий из строки "abcabcabc", объект <xref:System.Text.RegularExpressions.CaptureCollection> для каждого объекта <xref:System.Text.RegularExpressions.Group> содержит три члена.</span><span class="sxs-lookup"><span data-stu-id="012ef-315">For example, if you use the regular expression pattern `((a(b))c)+` (where the + quantifier specifies one or more matches) to capture matches from the string "abcabcabc", the <xref:System.Text.RegularExpressions.CaptureCollection> object for each <xref:System.Text.RegularExpressions.Group> object contains three members.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capturecollection1.cs#14)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capturecollection1.vb#14)]  
  
 <span data-ttu-id="012ef-316">Следующий пример использует регулярное выражение `(Abc)+` для поиска одного или нескольких последовательных вхождений строки "Abc" в строке "XYZAbcAbcAbcXYZAbcAb".</span><span class="sxs-lookup"><span data-stu-id="012ef-316">The following example uses the regular expression `(Abc)+` to find one or more consecutive runs of the string "Abc" in the string "XYZAbcAbcAbcXYZAbcAb".</span></span> <span data-ttu-id="012ef-317">Этот пример демонстрирует использование свойства <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> для получения нескольких групп выделенных подстрок.</span><span class="sxs-lookup"><span data-stu-id="012ef-317">The example illustrates the use of the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property to return multiple groups of captured substrings.</span></span>  
  
 [!code-csharp[RegularExpressions.Classes#5](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#5)]
 [!code-vb[RegularExpressions.Classes#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#5)]  
  
 [<span data-ttu-id="012ef-318">К началу</span><span class="sxs-lookup"><span data-stu-id="012ef-318">Back to top</span></span>](#introduction)  
  
<a name="the_individual_capture"></a>

## <a name="the-individual-capture"></a><span data-ttu-id="012ef-319">Отдельное выделение</span><span class="sxs-lookup"><span data-stu-id="012ef-319">The Individual Capture</span></span>  

 <span data-ttu-id="012ef-320">Класс <xref:System.Text.RegularExpressions.Capture> содержит результаты одного выделения части выражения.</span><span class="sxs-lookup"><span data-stu-id="012ef-320">The <xref:System.Text.RegularExpressions.Capture> class contains the results from a single subexpression capture.</span></span> <span data-ttu-id="012ef-321">Свойство <xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType> содержит сопоставленный текст, а свойство <xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType> указывает начальную позицию сопоставленной подстроки во входной строке с основанием ноль.</span><span class="sxs-lookup"><span data-stu-id="012ef-321">The <xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType> property contains the matched text, and the <xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType> property indicates the zero-based position in the input string at which the matched substring begins.</span></span>  
  
 <span data-ttu-id="012ef-322">Следующий пример ищет во входной строке температуру выбранных городов.</span><span class="sxs-lookup"><span data-stu-id="012ef-322">The following example parses an input string for the temperature of selected cities.</span></span> <span data-ttu-id="012ef-323">Запятая (",") используется для разделения города и температуры, а точка с запятой (";") — для разделения данных каждого города.</span><span class="sxs-lookup"><span data-stu-id="012ef-323">A comma (",") is used to separate a city and its temperature, and a semicolon (";") is used to separate each city's data.</span></span> <span data-ttu-id="012ef-324">Вся входная строка представляет одно соответствие.</span><span class="sxs-lookup"><span data-stu-id="012ef-324">The entire input string represents a single match.</span></span> <span data-ttu-id="012ef-325">В шаблоне регулярного выражения `((\w+(\s\w+)*),(\d+);)+`, который используется для анализа строки, название города назначается второй захватываемой группе, а температура — четвертой захватываемой группе.</span><span class="sxs-lookup"><span data-stu-id="012ef-325">In the regular expression pattern `((\w+(\s\w+)*),(\d+);)+`, which is used to parse the string, the city name is assigned to the second capturing group, and the temperature is assigned to the fourth capturing group.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#16](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capture1.cs#16)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capture1.vb#16)]  
  
 <span data-ttu-id="012ef-326">Определение регулярного выражения показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="012ef-326">The regular expression is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="012ef-327">Шаблон</span><span class="sxs-lookup"><span data-stu-id="012ef-327">Pattern</span></span>|<span data-ttu-id="012ef-328">Описание</span><span class="sxs-lookup"><span data-stu-id="012ef-328">Description</span></span>|  
|-------------|-----------------|  
|`\w+`|<span data-ttu-id="012ef-329">Совпадение с одним или несколькими символами слова.</span><span class="sxs-lookup"><span data-stu-id="012ef-329">Match one or more word characters.</span></span>|  
|`(\s\w+)*`|<span data-ttu-id="012ef-330">Сопоставляется ноль или несколько экземпляров пробела, за которыми следует один или несколько словообразующих символов.</span><span class="sxs-lookup"><span data-stu-id="012ef-330">Match zero or more occurrences of a white-space character followed by one or more word characters.</span></span> <span data-ttu-id="012ef-331">Этот шаблон выделяет названия городов из нескольких слов.</span><span class="sxs-lookup"><span data-stu-id="012ef-331">This pattern matches multi-word city names.</span></span> <span data-ttu-id="012ef-332">Это третья группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-332">This is the third capturing group.</span></span>|  
|`(\w+(\s\w+)*)`|<span data-ttu-id="012ef-333">Сопоставляется один или несколько словообразующих символов, за которыми следует ноль или несколько пробелов и один или несколько словообразующих символов.</span><span class="sxs-lookup"><span data-stu-id="012ef-333">Match one or more word characters followed by zero or more occurrences of a white-space character and one or more word characters.</span></span> <span data-ttu-id="012ef-334">Это вторая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-334">This is the second capturing group.</span></span>|  
|`,`|<span data-ttu-id="012ef-335">Сопоставление запятой.</span><span class="sxs-lookup"><span data-stu-id="012ef-335">Match a comma.</span></span>|  
|`(\d+)`|<span data-ttu-id="012ef-336">Сопоставление с одной или несколькими цифрами.</span><span class="sxs-lookup"><span data-stu-id="012ef-336">Match one or more digits.</span></span> <span data-ttu-id="012ef-337">Это четвертая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-337">This is the fourth capturing group.</span></span>|  
|`;`|<span data-ttu-id="012ef-338">Сопоставление точки с запятой.</span><span class="sxs-lookup"><span data-stu-id="012ef-338">Match a semicolon.</span></span>|  
|`((\w+(\s\w+)*),(\d+);)+`|<span data-ttu-id="012ef-339">Шаблона из слова, за которым следуют другие слова, запятая, одна или несколько цифр и точка запятая сопоставляется один или более раз.</span><span class="sxs-lookup"><span data-stu-id="012ef-339">Match the pattern of a word followed by any additional words followed by a comma, one or more digits, and a semicolon, one or more times.</span></span> <span data-ttu-id="012ef-340">Это первая группа записи.</span><span class="sxs-lookup"><span data-stu-id="012ef-340">This is the first capturing group.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="012ef-341">См. также</span><span class="sxs-lookup"><span data-stu-id="012ef-341">See also</span></span>

- <xref:System.Text.RegularExpressions>
- [<span data-ttu-id="012ef-342">Регулярные выражения .NET</span><span class="sxs-lookup"><span data-stu-id="012ef-342">.NET Regular Expressions</span></span>](regular-expressions.md)
- [<span data-ttu-id="012ef-343">Элементы языка регулярных выражений — краткий справочник</span><span class="sxs-lookup"><span data-stu-id="012ef-343">Regular Expression Language - Quick Reference</span></span>](regular-expression-language-quick-reference.md)
