---
title: Проверка строк на соответствие формату электронной почты
description: Вы можете ознакомиться с примером того, как регулярное выражение проверяет строки на соответствие формату электронной почты в .NET.
ms.date: 06/30/2020
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- regular expressions, examples
- user input, examples
- Regex.IsMatch method
- regular expressions [.NET Framework], examples
- examples [Visual Basic], strings
- IsValidEmail
- validation, email strings
- input, checking
- strings [.NET Framework], examples [Visual Basic]
- email [.NET Framework], validating
- IsMatch method
ms.assetid: 7536af08-4e86-4953-98a1-a8298623df92
ms.openlocfilehash: 90e79af649727330c2afa1ccb8c64ffe34733f92
ms.sourcegitcommit: 6d4ee46871deb9ea1e45bb5f3784474e240bbc26
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2020
ms.locfileid: "90022952"
---
# <a name="how-to-verify-that-strings-are-in-valid-email-format"></a>Проверка строк на соответствие формату электронной почты

В следующем примере регулярное выражение используется, чтобы проверить, имеет ли строка допустимый формат адреса электронной почты.

Это регулярное выражение довольно простое по сравнению с тем, которое может применяться в качестве сообщения электронной почты. Использование регулярного выражения для проверки сообщения электронной почты полезно для того, чтобы убедиться в правильности структуры сообщения, но оно не заменяет собой проверку факта существования сообщения электронной почты.

✔️ Используйте небольшое регулярное выражение для проверки действительной структуры сообщения электронной почты.

✔️ Отправьте тестовое сообщение по адресу, предоставленному пользователем приложения.

❌ НЕ используйте регулярное выражение в качестве единственного способа проверки сообщения электронной почты.

Если вы попытаетесь создать _идеальное_ регулярное выражение для проверки правильности структуры сообщения, выражение становится настолько сложным, что его практически невозможно отладить или улучшить. Регулярные выражения не могут проверить существование сообщения электронной почты, даже если оно структурировано правильно. Лучшим способом проверки сообщения электронной почты является отправка тестового сообщения электронной почты по адресу.

[!INCLUDE [regex](../../../includes/regex.md)]

## <a name="example"></a>Пример

В примере определяется метод `IsValidEmail`, который возвращает значение `true`, если строка содержит допустимый адрес электронной почты, и значение `false`, если она его не содержит, но не выполняет никаких других действий.

Чтобы проверить, что адрес электронной почты допустим, метод `IsValidEmail` вызывает метод <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=nameWithType> с шаблоном регулярного выражения `(@)(.+)$` для выделения доменного имени из адреса электронной почты. Третий параметр — это делегат <xref:System.Text.RegularExpressions.MatchEvaluator> , представляющий метод, который обрабатывает и заменяет найденный текст. Шаблон регулярного выражения интерпретируется следующим образом.

| Шаблон | Описание                                                                         |
|---------|-------------------------------------------------------------------------------------|
| `(@)`   | Совпадение с символом @. Это часть первой группы записи.                           |
| `(.+)`  | Совпадение с одним или несколькими вхождениями любого символа. Это часть второй группы записи. |
| `$`     | Совпадение должно заканчиваться в конце строки.                                             |

Доменное имя вместе с символом @ передается методу `DomainMapper` , который использует класс <xref:System.Globalization.IdnMapping> для преобразования символов Юникода, находящихся вне диапазона символов US-ASCII, в формат Punycode. Метод также устанавливает флаг `invalid` в значение `True`, если метод <xref:System.Globalization.IdnMapping.GetAscii%2A?displayProperty=nameWithType> находит какие-либо недопустимые символы в доменном имени. Метод возвращает доменное имя в формате Punycode, которому предшествует символ @, методу `IsValidEmail` .

> [!TIP]
> Рекомендуется использовать простой шаблон регулярного выражения `(@)(.+)$` для нормализации домена, а затем возвратить значение, указывающее, что проверка завершилась успешно или сбоем. Однако в примере в этой статье описывается дальнейшее использование регулярного выражения для проверки сообщения электронной почты. Независимо от способа проверки сообщения электронной почты, необходимо всегда отправлять тестовое сообщение по адресу, чтобы убедиться, что он существует.

Метод `IsValidEmail` затем вызывает метод <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29?displayProperty=nameWithType>, чтобы убедиться, что адрес соответствует шаблону регулярного выражения.

Метод `IsValidEmail` просто определяет, допустим ли формат электронной почты для адреса электронной почты; он не проверяет существование сообщения электронной почты. Кроме того, метод `IsValidEmail` не проверяет, является ли доменное имя верхнего уровня действительным доменным именем, присутствующим в [базе данных корневых зон IANA](https://www.iana.org/domains/root/db), что потребовало бы операции поиска.

:::code language="csharp" source="snippets/how-to-verify-that-strings-are-in-valid-email-format/csharp/RegexUtilities.cs":::

:::code language="vb" source="snippets/how-to-verify-that-strings-are-in-valid-email-format/vb/RegexUtilities.vb":::

Возможные интерпретации шаблона регулярного выражения `^[^@\s]+@[^@\s]+\.[^@\s]+$` в этом примере показаны в следующей таблице. Регулярное выражение компилируется с флагом <xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType>.

| Шаблон   | Описание                                                                              |
|-----------|------------------------------------------------------------------------------------------|
| `^`       | Соответствие должно обнаруживаться в начале строки.                                              |
| `[^@\s]+` | Совпадение с одним или несколькими вхождениями любого символа, кроме символа @ или пробела. |
| `@`       | Совпадение с символом @.                                                                   |
| `[^@\s]+` | Совпадение с одним или несколькими вхождениями любого символа, кроме символа @ или пробела. |
| `\.`      | Совпадение с символом точки.                                                         |
| `[^@\s]+` | Совпадение с одним или несколькими вхождениями любого символа, кроме символа @ или пробела. |
| `$`       | Совпадение должно заканчиваться в конце строки.                                                  |

> [!IMPORTANT]
> Это регулярное выражение не предназначено для проверки каждого аспекта допустимого адреса электронной почты. Он предоставляется в качестве примера для расширения по мере необходимости.

## <a name="see-also"></a>См. также

- [Регулярные выражения в .NET Framework](regular-expressions.md)
- [Насколько тщательно следует проверять адрес электронной почты?](https://softwareengineering.stackexchange.com/questions/78353/how-far-should-one-take-e-mail-address-validation#78363)
