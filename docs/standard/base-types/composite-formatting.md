---
title: Составное форматирование
description: Сведения о составном форматировании .NET, которое принимает в качестве входных данных список объектов и строку составного формата, содержащую фиксированный текст с индексированными заполнителями.
ms.date: 10/26/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- parameter specifiers
- strings [.NET Framework], alignment
- format specifiers, composite formatting
- strings [.NET Framework], composite
- composite formatting
- objects [.NET Framework], formatting multiple objects
ms.assetid: 87b7d528-73f6-43c6-b71a-f23043039a49
ms.openlocfilehash: 36197b382c449a2570e1d5530f307c4e66b0d983
ms.sourcegitcommit: b16c00371ea06398859ecd157defc81301c9070f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2020
ms.locfileid: "84447268"
---
# <a name="composite-formatting"></a><span data-ttu-id="0df9b-103">Составное форматирование</span><span class="sxs-lookup"><span data-stu-id="0df9b-103">Composite formatting</span></span>

<span data-ttu-id="0df9b-104">В качестве входных данных для составного форматирования в .NET используется список объектов и строка составного формата.</span><span class="sxs-lookup"><span data-stu-id="0df9b-104">The .NET composite formatting feature takes a list of objects and a composite format string as input.</span></span> <span data-ttu-id="0df9b-105">Строка составного формата состоит из фиксированного текста, в который включены индексированные местозаполнители, которые называются элементами форматирования и соответствуют объектам из списка.</span><span class="sxs-lookup"><span data-stu-id="0df9b-105">A composite format string consists of fixed text intermixed with indexed placeholders, called format items, that correspond to the objects in the list.</span></span> <span data-ttu-id="0df9b-106">Операция форматирования создает результирующую строку, состоящую из исходного фиксированного текста, в который включено строковое представление объектов из списка.</span><span class="sxs-lookup"><span data-stu-id="0df9b-106">The formatting operation yields a result string that consists of the original fixed text intermixed with the string representation of the objects in the list.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="0df9b-107">Вместо использования строк составного формата можно использовать *интерполированные строки*, если их поддерживает язык и языковая версия, которые вы используете.</span><span class="sxs-lookup"><span data-stu-id="0df9b-107">Instead of using composite format strings, you can use *interpolated strings* if the language and language version that you're using support them.</span></span> <span data-ttu-id="0df9b-108">Интерполированная строка — это строка, которая содержит *интерполированные выражения*.</span><span class="sxs-lookup"><span data-stu-id="0df9b-108">An interpolated string is a string that contains *interpolated expressions*.</span></span> <span data-ttu-id="0df9b-109">Каждое интерполированное выражение завершается значением выражения и включается в строку результатов, если строка назначена.</span><span class="sxs-lookup"><span data-stu-id="0df9b-109">Each interpolated expression is resolved with the expression's value and included in the result string when the string is assigned.</span></span> <span data-ttu-id="0df9b-110">Дополнительные сведения см. в разделе [Интерполяция строк (справочник по C#)](../../csharp/language-reference/tokens/interpolated.md) и [Интерполированные строки (справочник по Visual Basic)](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md).</span><span class="sxs-lookup"><span data-stu-id="0df9b-110">For more information, see [String interpolation (C# Reference)](../../csharp/language-reference/tokens/interpolated.md) and [Interpolated strings (Visual Basic Reference)](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md).</span></span>

<span data-ttu-id="0df9b-111">Возможность составного форматирования поддерживается следующими методами:</span><span class="sxs-lookup"><span data-stu-id="0df9b-111">The composite formatting feature is supported by methods such as the following:</span></span>  
  
- <span data-ttu-id="0df9b-112">Метод <xref:System.String.Format%2A?displayProperty=nameWithType>, который возвращает отформатированную результирующую строку.</span><span class="sxs-lookup"><span data-stu-id="0df9b-112"><xref:System.String.Format%2A?displayProperty=nameWithType>, which returns a formatted result string.</span></span>  
  
- <span data-ttu-id="0df9b-113">Метод <xref:System.Text.StringBuilder.AppendFormat%2A?displayProperty=nameWithType>, который добавляет отформатированную результирующую строку в объект <xref:System.Text.StringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-113"><xref:System.Text.StringBuilder.AppendFormat%2A?displayProperty=nameWithType>, which appends a formatted result string to a <xref:System.Text.StringBuilder> object.</span></span>
- <span data-ttu-id="0df9b-114">Некоторые перегруженные версии метода <xref:System.Console.WriteLine%2A?displayProperty=nameWithType>, которые отображают отформатированную результирующую строку в консоли.</span><span class="sxs-lookup"><span data-stu-id="0df9b-114">Some overloads of the <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> method, which display a formatted result string to the console.</span></span>  
  
- <span data-ttu-id="0df9b-115">Некоторые перегруженные версии метода <xref:System.IO.TextWriter.WriteLine%2A?displayProperty=nameWithType>, которые записывают отформатированную результирующую строку в поток или файл.</span><span class="sxs-lookup"><span data-stu-id="0df9b-115">Some overloads of the <xref:System.IO.TextWriter.WriteLine%2A?displayProperty=nameWithType> method, which write the formatted result string to a stream or file.</span></span> <span data-ttu-id="0df9b-116">Классы, производные от <xref:System.IO.TextWriter>, например <xref:System.IO.StreamWriter> и <xref:System.Web.UI.HtmlTextWriter>, также поддерживают эту функцию.</span><span class="sxs-lookup"><span data-stu-id="0df9b-116">The classes derived from <xref:System.IO.TextWriter>, such as <xref:System.IO.StreamWriter> and <xref:System.Web.UI.HtmlTextWriter>, also share this functionality.</span></span>  
  
- <span data-ttu-id="0df9b-117">Метод <xref:System.Diagnostics.Debug.WriteLine%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, который выводит отформатированное сообщение в прослушиватели трассировки.</span><span class="sxs-lookup"><span data-stu-id="0df9b-117"><xref:System.Diagnostics.Debug.WriteLine%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, which outputs a formatted message to trace listeners.</span></span>  
  
- <span data-ttu-id="0df9b-118">Методы <xref:System.Diagnostics.Trace.TraceError%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, <xref:System.Diagnostics.Trace.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> и <xref:System.Diagnostics.Trace.TraceWarning%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, которые выводят отформатированные сообщения в прослушиватели трассировки.</span><span class="sxs-lookup"><span data-stu-id="0df9b-118">The <xref:System.Diagnostics.Trace.TraceError%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, <xref:System.Diagnostics.Trace.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, and <xref:System.Diagnostics.Trace.TraceWarning%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> methods, which output formatted messages to trace listeners.</span></span>  
  
- <span data-ttu-id="0df9b-119">Метод <xref:System.Diagnostics.TraceSource.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, который записывает информационный метод в прослушиватели трассировки.</span><span class="sxs-lookup"><span data-stu-id="0df9b-119">The <xref:System.Diagnostics.TraceSource.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> method, which writes an informational method to trace listeners.</span></span>  
  
## <a name="composite-format-string"></a><span data-ttu-id="0df9b-120">Строка составного формата</span><span class="sxs-lookup"><span data-stu-id="0df9b-120">Composite Format String</span></span>  
 <span data-ttu-id="0df9b-121">Строка составного формата и список объектов используются в качестве аргументов методов, поддерживающих составное форматирование.</span><span class="sxs-lookup"><span data-stu-id="0df9b-121">A composite format string and object list are used as arguments of methods that support the composite formatting feature.</span></span> <span data-ttu-id="0df9b-122">Строка составного формата состоит из блоков фиксированного текста числом от нуля и больше, перемежаемых одним или несколькими элементами форматирования.</span><span class="sxs-lookup"><span data-stu-id="0df9b-122">A composite format string consists of zero or more runs of fixed text intermixed with one or more format items.</span></span> <span data-ttu-id="0df9b-123">Фиксированным текстом может являться произвольная строка, а каждый элемент форматирования должен соответствовать объекту или упакованной структуре из списка.</span><span class="sxs-lookup"><span data-stu-id="0df9b-123">The fixed text is any string that you choose, and each format item corresponds to an object or boxed structure in the list.</span></span> <span data-ttu-id="0df9b-124">В ходе составного форматирования создается новая результирующая строка, в которой все элементы форматирования заменены на строковое представление соответствующих объектов из списка.</span><span class="sxs-lookup"><span data-stu-id="0df9b-124">The composite formatting feature returns a new result string where each format item is replaced by the string representation of the corresponding object in the list.</span></span>  
  
 <span data-ttu-id="0df9b-125">Рассмотрим следующий фрагмент кода <xref:System.String.Format%2A>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-125">Consider the following <xref:System.String.Format%2A> code fragment.</span></span>  
  
 [!code-csharp[Formatting.Composite#1](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#1)]
 [!code-vb[Formatting.Composite#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#1)]  
  
 <span data-ttu-id="0df9b-126">Здесь "`Name =`" и "`, hours =`" — фиксированный текст.</span><span class="sxs-lookup"><span data-stu-id="0df9b-126">The fixed text is "`Name =` " and "`, hours =` ".</span></span> <span data-ttu-id="0df9b-127">Элементы форматирования — это "`{0}`" c индексом 0, который соответствует объекту `name`, и "`{1:hh}`" с индексом 1, который соответствует объекту `DateTime.Now`.</span><span class="sxs-lookup"><span data-stu-id="0df9b-127">The format items are "`{0}`", whose index is 0, which corresponds to the object `name`, and "`{1:hh}`", whose index is 1, which corresponds to the object `DateTime.Now`.</span></span>  
  
## <a name="format-item-syntax"></a><span data-ttu-id="0df9b-128">Синтаксис элементов форматирования</span><span class="sxs-lookup"><span data-stu-id="0df9b-128">Format Item Syntax</span></span>  
 <span data-ttu-id="0df9b-129">Каждый элемент форматирования имеет следующий вид и состоит из следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="0df9b-129">Each format item takes the following form and consists of the following components:</span></span>  
  
 <span data-ttu-id="0df9b-130">`{` *index*[`,`*alignment*][`:`*formatString*]`}`</span><span class="sxs-lookup"><span data-stu-id="0df9b-130">`{` *index*[`,`*alignment*][`:`*formatString*]`}`</span></span>  
  
 <span data-ttu-id="0df9b-131">Парные фигурные скобки ("{" и "}") здесь обязательны.</span><span class="sxs-lookup"><span data-stu-id="0df9b-131">The matching braces ("{" and "}") are required.</span></span>  
  
### <a name="index-component"></a><span data-ttu-id="0df9b-132">Индекс</span><span class="sxs-lookup"><span data-stu-id="0df9b-132">Index Component</span></span>  
 <span data-ttu-id="0df9b-133">Обязательный компонент *index*, также называемый описателем параметра, — это число, определяющее соответствующий объект из списка; индексация элементов ведется от нуля.</span><span class="sxs-lookup"><span data-stu-id="0df9b-133">The mandatory *index* component, also called a parameter specifier, is a number starting from 0 that identifies a corresponding item in the list of objects.</span></span> <span data-ttu-id="0df9b-134">Иными словами, элемент форматирования с индексом 0 отвечает за формат первого объекта в списке, элемент форматирования с индексом 1 служит для форматирования второго объекта в списке и т. д.</span><span class="sxs-lookup"><span data-stu-id="0df9b-134">That is, the format item whose parameter specifier is 0 formats the first object in the list, the format item whose parameter specifier is 1 formats the second object in the list, and so on.</span></span> <span data-ttu-id="0df9b-135">В пример ниже входят четыре описателя параметров (с номерами от 0 до 3) для представления простых чисел меньше 10.</span><span class="sxs-lookup"><span data-stu-id="0df9b-135">The following example includes four parameter specifiers, numbered zero through three,  to represent prime numbers less than ten:</span></span>  
  
 [!code-csharp[Formatting.Composite#7](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/index1.cs#7)]
 [!code-vb[Formatting.Composite#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/index1.vb#7)]  
  
 <span data-ttu-id="0df9b-136">На один и тот же элемент в списке объектов может ссылаться сразу несколько элементов форматирования — достигается это путем задания одинакового описателя параметра.</span><span class="sxs-lookup"><span data-stu-id="0df9b-136">Multiple format items can refer to the same element in the list of objects by specifying the same parameter specifier.</span></span> <span data-ttu-id="0df9b-137">Например, одно и то же числовое значение можно отформатировать в шестнадцатеричном, экспоненциальном и десятичном виде путем задания следующей строки составного форматирования: "0x{0:X} {0:E} {0:N}", как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="0df9b-137">For example, you can format the same numeric value in hexadecimal, scientific, and number format by specifying a composite format string such as : "0x{0:X} {0:E} {0:N}", as the following example shows.</span></span>  
  
 [!code-csharp[Formatting.Composite#10](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/index1.cs#10)]
 [!code-vb[Formatting.Composite#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/index1.vb#10)]  
  
 <span data-ttu-id="0df9b-138">Любой элемент форматирования может ссылаться на произвольный объект списка.</span><span class="sxs-lookup"><span data-stu-id="0df9b-138">Each format item can refer to any object in the list.</span></span> <span data-ttu-id="0df9b-139">Например, если имеется три объекта, то можно отформатировать сначала второй, а затем первый и третий объекты, указав следующую строку составного форматирования: "{1} {0} {2}".</span><span class="sxs-lookup"><span data-stu-id="0df9b-139">For example, if there are three objects, you can format the second, first, and third object by specifying a composite format string like this: "{1} {0} {2}".</span></span> <span data-ttu-id="0df9b-140">Объекты, на которые не ссылаются элементы форматирования, пропускаются.</span><span class="sxs-lookup"><span data-stu-id="0df9b-140">An object that is not referenced by a format item is ignored.</span></span> <span data-ttu-id="0df9b-141">Если описатель параметра ссылается на элемент за пределами списка объектов, то во время выполнения создается исключение <xref:System.FormatException>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-141">A <xref:System.FormatException> is thrown at run time if a parameter specifier designates an item outside the bounds of the list of objects.</span></span>  
  
### <a name="alignment-component"></a><span data-ttu-id="0df9b-142">Выравнивание</span><span class="sxs-lookup"><span data-stu-id="0df9b-142">Alignment Component</span></span>  
 <span data-ttu-id="0df9b-143">Необязательный компонент *alignment* — это целое число со знаком, которое служит для указания желательной ширины поля форматирования.</span><span class="sxs-lookup"><span data-stu-id="0df9b-143">The optional *alignment* component is a signed integer indicating the preferred formatted field width.</span></span> <span data-ttu-id="0df9b-144">Если значение *alignment* меньше длины форматируемой строки, то *alignment* пропускается, и в качестве значения ширины поля используется длина форматируемой строки.</span><span class="sxs-lookup"><span data-stu-id="0df9b-144">If the value of *alignment* is less than the length of the formatted string, *alignment* is ignored and the length of the formatted string is used as the field width.</span></span> <span data-ttu-id="0df9b-145">Форматируемые данные выравниваются в поле по правому краю, если *alignment* имеет положительное значение, или по левому краю, если *alignment* имеет отрицательное значение.</span><span class="sxs-lookup"><span data-stu-id="0df9b-145">The formatted data in the field is right-aligned if *alignment* is positive and left-aligned if *alignment* is negative.</span></span> <span data-ttu-id="0df9b-146">При необходимости отформатированная строка дополняется пробелами.</span><span class="sxs-lookup"><span data-stu-id="0df9b-146">If padding is necessary, white space is used.</span></span> <span data-ttu-id="0df9b-147">При использовании компонента *alignment* необходимо поставить запятую.</span><span class="sxs-lookup"><span data-stu-id="0df9b-147">The comma is required if *alignment*  is specified.</span></span>  
  
 <span data-ttu-id="0df9b-148">В примере ниже определяются два массива: один содержит имена сотрудников, а второй — количество часов, которые они проработали в течение двух недель.</span><span class="sxs-lookup"><span data-stu-id="0df9b-148">The following example defines two arrays, one containing the names of employees and the other containing the hours they worked over a two-week period.</span></span> <span data-ttu-id="0df9b-149">Строка составного формата выравнивает имена по левому краю 20-символьного поля, а часы работы — по правому краю 5-символьного поля.</span><span class="sxs-lookup"><span data-stu-id="0df9b-149">The composite format string left-aligns the names in a 20-character field, and right-aligns their hours in a 5-character field.</span></span> <span data-ttu-id="0df9b-150">Обратите внимание, что строка стандартного формата "N1" также используется для форматирования часов с одной цифрой дробной части.</span><span class="sxs-lookup"><span data-stu-id="0df9b-150">Note that the "N1" standard format string is also used to format the hours with one fractional digit.</span></span>  
  
 [!code-csharp[Formatting.Composite#8](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/alignment1.cs#8)]
 [!code-vb[Formatting.Composite#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/alignment1.vb#8)]  
  
### <a name="format-string-component"></a><span data-ttu-id="0df9b-151">Компонент строки формата</span><span class="sxs-lookup"><span data-stu-id="0df9b-151">Format String Component</span></span>  
 <span data-ttu-id="0df9b-152">Необязательный компонент *formatString* — это строка формата, соответствующая типу форматируемого объекта.</span><span class="sxs-lookup"><span data-stu-id="0df9b-152">The optional *formatString* component is a format string that is appropriate for the type of object being formatted.</span></span> <span data-ttu-id="0df9b-153">Если соответствующий объект является объектом <xref:System.DateTime>, используется строка стандартного или настраиваемого формата чисел, а если соответствующий объект является значением перечисления, используется [строка формата перечисления](enumeration-format-strings.md).</span><span class="sxs-lookup"><span data-stu-id="0df9b-153">Specify a standard or custom numeric format string if the corresponding object is a numeric value, a standard or custom date and time format string if the corresponding object is a <xref:System.DateTime> object, or an [enumeration format string](enumeration-format-strings.md) if the corresponding object is an enumeration value.</span></span> <span data-ttu-id="0df9b-154">Если компонент *formatString* не задан, то для числовых значений, значений даты и времени, а также перечислений используется общий формат ("G").</span><span class="sxs-lookup"><span data-stu-id="0df9b-154">If *formatString* is not specified, the general ("G") format specifier for a numeric, date and time, or enumeration type is used.</span></span> <span data-ttu-id="0df9b-155">При использовании компонента *formatString* необходимо двоеточие.</span><span class="sxs-lookup"><span data-stu-id="0df9b-155">The colon is required if *formatString* is specified.</span></span>  
  
 <span data-ttu-id="0df9b-156">В следующей таблице перечислены типы и категории типов в библиотеке классов .NET Framework, которые поддерживают предопределенный набор строк формата, а также ссылки на разделы, в которых перечисляются поддерживаемые строки формата.</span><span class="sxs-lookup"><span data-stu-id="0df9b-156">The following table lists types or categories of types in the .NET Framework class library that support a predefined set of format strings, and provides links to the topics that list the supported format strings.</span></span> <span data-ttu-id="0df9b-157">Обратите внимание, что форматирование строк — это расширяемый механизм, который позволяет определять новые строки формата для всех существующих типов, а также определять набор строк формата, поддерживаемых прикладным типом.</span><span class="sxs-lookup"><span data-stu-id="0df9b-157">Note that string formatting is an extensible mechanism that makes it possible to define new format strings for all existing types as well as to define a set of format strings supported by an application-defined type.</span></span> <span data-ttu-id="0df9b-158">Подробнее см. в разделах, посвященных интерфейсам <xref:System.IFormattable> и <xref:System.ICustomFormatter>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-158">For more information, see the <xref:System.IFormattable> and <xref:System.ICustomFormatter> interface topics.</span></span>  
  
|<span data-ttu-id="0df9b-159">Тип или категория типов</span><span class="sxs-lookup"><span data-stu-id="0df9b-159">Type or type category</span></span>|<span data-ttu-id="0df9b-160">См.</span><span class="sxs-lookup"><span data-stu-id="0df9b-160">See</span></span>|  
|---------------------------|---------|  
|<span data-ttu-id="0df9b-161">Типы даты и времени (<xref:System.DateTime>, <xref:System.DateTimeOffset>)</span><span class="sxs-lookup"><span data-stu-id="0df9b-161">Date and time types (<xref:System.DateTime>, <xref:System.DateTimeOffset>)</span></span>|[<span data-ttu-id="0df9b-162">Строки стандартных форматов даты и времени</span><span class="sxs-lookup"><span data-stu-id="0df9b-162">Standard Date and Time Format Strings</span></span>](standard-date-and-time-format-strings.md)<br /><br /> [<span data-ttu-id="0df9b-163">Строки настраиваемых форматов даты и времени</span><span class="sxs-lookup"><span data-stu-id="0df9b-163">Custom Date and Time Format Strings</span></span>](custom-date-and-time-format-strings.md)|  
|<span data-ttu-id="0df9b-164">Типы перечисления (все типы, производные от <xref:System.Enum?displayProperty=nameWithType>)</span><span class="sxs-lookup"><span data-stu-id="0df9b-164">Enumeration types (all types derived from <xref:System.Enum?displayProperty=nameWithType>)</span></span>|[<span data-ttu-id="0df9b-165">Строки форматов перечисления</span><span class="sxs-lookup"><span data-stu-id="0df9b-165">Enumeration Format Strings</span></span>](enumeration-format-strings.md)|  
|<span data-ttu-id="0df9b-166">Числовые типы (<xref:System.Numerics.BigInteger>, <xref:System.Byte>, <xref:System.Decimal>, <xref:System.Double>, <xref:System.Int16>, <xref:System.Int32>, <xref:System.Int64>, <xref:System.SByte>, <xref:System.Single>, <xref:System.UInt16>, <xref:System.UInt32>, <xref:System.UInt64>)</span><span class="sxs-lookup"><span data-stu-id="0df9b-166">Numeric types (<xref:System.Numerics.BigInteger>, <xref:System.Byte>, <xref:System.Decimal>, <xref:System.Double>, <xref:System.Int16>, <xref:System.Int32>, <xref:System.Int64>, <xref:System.SByte>, <xref:System.Single>, <xref:System.UInt16>, <xref:System.UInt32>, <xref:System.UInt64>)</span></span>|[<span data-ttu-id="0df9b-167">Строки стандартных числовых форматов</span><span class="sxs-lookup"><span data-stu-id="0df9b-167">Standard Numeric Format Strings</span></span>](standard-numeric-format-strings.md)<br /><br /> [<span data-ttu-id="0df9b-168">Строки настраиваемых числовых форматов</span><span class="sxs-lookup"><span data-stu-id="0df9b-168">Custom Numeric Format Strings</span></span>](custom-numeric-format-strings.md)|  
|<xref:System.Guid>|<xref:System.Guid.ToString%28System.String%29?displayProperty=nameWithType>|  
|<xref:System.TimeSpan>|[<span data-ttu-id="0df9b-169">Строки стандартного формата TimeSpan</span><span class="sxs-lookup"><span data-stu-id="0df9b-169">Standard TimeSpan Format Strings</span></span>](standard-timespan-format-strings.md)<br /><br /> [<span data-ttu-id="0df9b-170">Строки настраиваемого формата TimeSpan</span><span class="sxs-lookup"><span data-stu-id="0df9b-170">Custom TimeSpan Format Strings</span></span>](custom-timespan-format-strings.md)|  
  
### <a name="escaping-braces"></a><span data-ttu-id="0df9b-171">Оформление фигурных скобок</span><span class="sxs-lookup"><span data-stu-id="0df9b-171">Escaping Braces</span></span>  
 <span data-ttu-id="0df9b-172">Начало и конец элемента форматирования обозначаются соответственно открывающей и закрывающей фигурной скобкой.</span><span class="sxs-lookup"><span data-stu-id="0df9b-172">Opening and closing braces are interpreted as starting and ending a format item.</span></span> <span data-ttu-id="0df9b-173">Это означает, что для вывода открывающих и закрывающих фигурных скобок необходимо использовать escape-последовательности.</span><span class="sxs-lookup"><span data-stu-id="0df9b-173">Consequently, you must use an escape sequence to display a literal opening brace or closing brace.</span></span> <span data-ttu-id="0df9b-174">Для вывода открывающей или закрывающей фигурной скобки в фиксированном тексте следует поставить две открывающие или, соответственно, закрывающие фигурные скобки подряд ("{{" или "}}").</span><span class="sxs-lookup"><span data-stu-id="0df9b-174">Specify two opening braces ("{{") in the fixed text to display one opening brace ("{"), or two closing braces ("}}") to display one closing brace ("}").</span></span> <span data-ttu-id="0df9b-175">Фигурные скобки в элементе форматирования интерпретируются последовательно в порядке их обнаружения.</span><span class="sxs-lookup"><span data-stu-id="0df9b-175">Braces in a format item are interpreted sequentially in the order they are encountered.</span></span> <span data-ttu-id="0df9b-176">Интерпретация вложенных скобок не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="0df9b-176">Interpreting nested braces is not supported.</span></span>  
  
 <span data-ttu-id="0df9b-177">Порядок интерпретации скобок может привести к непредвиденным результатам.</span><span class="sxs-lookup"><span data-stu-id="0df9b-177">The way escaped braces are interpreted can lead to unexpected results.</span></span> <span data-ttu-id="0df9b-178">Например, рассмотрим элемент форматирования "{{{{0:D}}}}", который должен вывести открывающую фигурную скобку, числовое значение, отформатированное в десятичном виде, и закрывающую фигурную скобку.</span><span class="sxs-lookup"><span data-stu-id="0df9b-178">For example, consider the format item "{{{0:D}}}", which is intended to display an opening brace, a numeric value formatted as a decimal number, and a closing brace.</span></span> <span data-ttu-id="0df9b-179">В действительности элемент форматирования будет интерпретирован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0df9b-179">However, the format item is actually interpreted in the following manner:</span></span>  
  
1. <span data-ttu-id="0df9b-180">Первые две открывающие фигурные скобки ("{{") составляют escape-последовательность, которая дает в итоге одиночную открывающую фигурную скобку.</span><span class="sxs-lookup"><span data-stu-id="0df9b-180">The first two opening braces ("{{") are escaped and yield one opening brace.</span></span>  
  
2. <span data-ttu-id="0df9b-181">Следующие три знака ("{0:") воспринимаются как начало элемента форматирования.</span><span class="sxs-lookup"><span data-stu-id="0df9b-181">The next three characters ("{0:") are interpreted as the start of a format item.</span></span>  
  
3. <span data-ttu-id="0df9b-182">Следующий знак ("D") должен интерпретироваться как указатель на десятичный числовой формат, но стоящая за ним пара фигурных скобок ("}}") дает в результате одиночную фигурную скобку.</span><span class="sxs-lookup"><span data-stu-id="0df9b-182">The next character ("D") would be interpreted as the Decimal standard numeric format specifier, but the next two escaped braces ("}}") yield a single brace.</span></span> <span data-ttu-id="0df9b-183">Поскольку результирующая строка ("D}") не является стандартным описателем числового формата, то она будет интерпретирована как строка пользовательского формата, что приведет к выводу строки "D}".</span><span class="sxs-lookup"><span data-stu-id="0df9b-183">Because the resulting string ("D}") is not a standard numeric format specifier, the resulting string is interpreted as a custom format string that means display the literal string "D}".</span></span>  
  
4. <span data-ttu-id="0df9b-184">Последняя фигурная скобка ("}") интерпретируется как конец элемента форматирования.</span><span class="sxs-lookup"><span data-stu-id="0df9b-184">The last brace ("}") is interpreted as the end of the format item.</span></span>  
  
5. <span data-ttu-id="0df9b-185">Итоговый результат, который будет выведен — строка "{D}".</span><span class="sxs-lookup"><span data-stu-id="0df9b-185">The final result that is displayed is the literal string, "{D}".</span></span> <span data-ttu-id="0df9b-186">Числовое значение, которое требовалось отформатировать, выведено не будет.</span><span class="sxs-lookup"><span data-stu-id="0df9b-186">The numeric value that was to be formatted is not displayed.</span></span>  
  
 <span data-ttu-id="0df9b-187">Одним из способов избежать неправильной интерпретации фигурных скобок и элементов форматирования при написании кода является раздельное форматирование фигурных скобок и элементов форматирования.</span><span class="sxs-lookup"><span data-stu-id="0df9b-187">One way to write your code to avoid misinterpreting escaped braces and format items is to format the braces and format item separately.</span></span> <span data-ttu-id="0df9b-188">Это означает, что первая операция форматирования должна выводить строку с открывающей фигурной скобкой, следующая операция — результат обработки элемента форматирования, а последняя операция — строку с закрывающей фигурной скобкой.</span><span class="sxs-lookup"><span data-stu-id="0df9b-188">That is, in the first format operation display a literal opening brace, in the next operation display the result of the format item, then in the final operation display a literal closing brace.</span></span> <span data-ttu-id="0df9b-189">Этот подход показан в приведенном ниже примере.</span><span class="sxs-lookup"><span data-stu-id="0df9b-189">The following example illustrates this approach.</span></span>  
  
 [!code-csharp[Formatting.Composite#2](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Escaping1.cs#2)]
 [!code-vb[Formatting.Composite#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Escaping1.vb#2)]  
  
### <a name="processing-order"></a><span data-ttu-id="0df9b-190">Порядок обработки</span><span class="sxs-lookup"><span data-stu-id="0df9b-190">Processing Order</span></span>  
 <span data-ttu-id="0df9b-191">Если вызов метода составного форматирования содержит аргумент <xref:System.IFormatProvider>, значение которого не равно `null`, среда выполнения вызывает метод <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType>, чтобы запросить реализацию <xref:System.ICustomFormatter>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-191">If the call to the composite formatting method includes an <xref:System.IFormatProvider> argument whose value is not `null`, the runtime calls its <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> method to request an <xref:System.ICustomFormatter> implementation.</span></span> <span data-ttu-id="0df9b-192">Если метод может возвращать реализацию <xref:System.ICustomFormatter>, он кэшируется на время вызова метода составного форматирования.</span><span class="sxs-lookup"><span data-stu-id="0df9b-192">If the method is able to return an <xref:System.ICustomFormatter> implementation, it's cached for the duration of the call of the composite formatting method.</span></span>
  
 <span data-ttu-id="0df9b-193">Каждое значение в списке параметров, соответствующее элементу форматирования, преобразуется в строку следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0df9b-193">Each value in the parameter list that corresponds to a format item is converted to a string as follows:</span></span>  
  
1. <span data-ttu-id="0df9b-194">Если форматируемое значение является значением `null`, возвращается пустая строка <xref:System.String.Empty?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-194">If the value to be formatted is `null`, an empty string <xref:System.String.Empty?displayProperty=nameWithType> is returned.</span></span>  
  
2. <span data-ttu-id="0df9b-195">Если реализация <xref:System.ICustomFormatter> доступна, среда выполнения вызывает ее метод <xref:System.ICustomFormatter.Format%2A>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-195">If an <xref:System.ICustomFormatter> implementation is available, the runtime calls its <xref:System.ICustomFormatter.Format%2A> method.</span></span> <span data-ttu-id="0df9b-196">Она передает в метод значение элемента форматирования *formatString* (при его наличии) или значение `null` (в случае его отсутствия) вместе с реализацией <xref:System.IFormatProvider>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-196">It passes the method the format item's *formatString* value, if one is present, or `null` if it's not, along with the <xref:System.IFormatProvider> implementation.</span></span> <span data-ttu-id="0df9b-197">Если вызов метода <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> возвращает `null`, выполнение переходит к следующему шагу; в противном случае возвращается результат вызова <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-197">If the call to the <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> method returns `null`, execution proceeds to the next step; otherwise, the result of the <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> call is returned.</span></span>
  
3. <span data-ttu-id="0df9b-198">Если значение реализует интерфейс <xref:System.IFormattable>, вызывается метод <xref:System.IFormattable.ToString%28System.String%2CSystem.IFormatProvider%29> этого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="0df9b-198">If the value implements the <xref:System.IFormattable> interface, the interface's <xref:System.IFormattable.ToString%28System.String%2CSystem.IFormatProvider%29> method is called.</span></span> <span data-ttu-id="0df9b-199">Методу передается значение *formatString* (при его наличии в элементе форматирования) или значение `null` (в случае его отсутствия).</span><span class="sxs-lookup"><span data-stu-id="0df9b-199">The method is passed the *formatString* value, if one is present in the format item, or `null` if it's not.</span></span> <span data-ttu-id="0df9b-200">Аргумент <xref:System.IFormatProvider> определяется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0df9b-200">The <xref:System.IFormatProvider> argument is determined as follows:</span></span>  
  
    - <span data-ttu-id="0df9b-201">Для числового значения, если вызывается метод составного форматирования с аргументом <xref:System.IFormatProvider>, не равным null, то среда выполнения запрашивает объект <xref:System.Globalization.NumberFormatInfo> из метода <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-201">For a numeric value, if a composite formatting method with a non-null <xref:System.IFormatProvider> argument is called, the runtime requests a <xref:System.Globalization.NumberFormatInfo> object from its <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0df9b-202">Если не удалось предоставить объект, если аргумент имеет значение `null` или метод составного форматирования не имеет параметра <xref:System.IFormatProvider>, то используется объект <xref:System.Globalization.NumberFormatInfo> для языка и региональных параметров текущего потока.</span><span class="sxs-lookup"><span data-stu-id="0df9b-202">If it's unable to supply one, if the value of the argument is `null`, or if the composite formatting method doesn't have an <xref:System.IFormatProvider> parameter, the <xref:System.Globalization.NumberFormatInfo> object for the current thread culture is used.</span></span>  
  
    - <span data-ttu-id="0df9b-203">Для значения даты и времени, если вызывается метод составного форматирования с аргументом <xref:System.IFormatProvider>, не равным null, то среда выполнения запрашивает объект <xref:System.Globalization.DateTimeFormatInfo> из метода <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-203">For a date and time value, if a composite formatting method with a non-null <xref:System.IFormatProvider> argument is called, the runtime requests a <xref:System.Globalization.DateTimeFormatInfo> object from its <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0df9b-204">Если не удалось предоставить объект, если аргумент имеет значение `null` или метод составного форматирования не имеет параметра <xref:System.IFormatProvider>, то используется объект <xref:System.Globalization.DateTimeFormatInfo> для языка и региональных параметров текущего потока.</span><span class="sxs-lookup"><span data-stu-id="0df9b-204">If it's unable to supply one, if the value of the argument is `null`, or if the composite formatting method doesn't have an <xref:System.IFormatProvider> parameter, the <xref:System.Globalization.DateTimeFormatInfo> object for the current thread culture is used.</span></span>  
  
    - <span data-ttu-id="0df9b-205">Для объектов других типов, если метод составного форматирования вызывается с аргументом <xref:System.IFormatProvider>, то его значение передается непосредственно в реализацию <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-205">For objects of other types, if a composite formatting method is called with an <xref:System.IFormatProvider> argument, its value is passed directly to the <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="0df9b-206">В противном случае `null` передается в реализацию <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-206">Otherwise, `null` is passed to the <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType> implementation.</span></span>  
  
4. <span data-ttu-id="0df9b-207">Вызывается метод `ToString` без параметров, который переопределяет <xref:System.Object.ToString?displayProperty=nameWithType> или наследует поведение базового класса.</span><span class="sxs-lookup"><span data-stu-id="0df9b-207">The type's parameterless `ToString` method, which either overrides <xref:System.Object.ToString?displayProperty=nameWithType> or inherits the behavior of its base class, is called.</span></span> <span data-ttu-id="0df9b-208">В этом случае строка формата, указанная в компоненте *formatString* в элементе форматирования (при его наличии), игнорируется.</span><span class="sxs-lookup"><span data-stu-id="0df9b-208">In this case, the format string specified by the *formatString* component in the format item, if it's present, is ignored.</span></span>  
  
 <span data-ttu-id="0df9b-209">После выполнения предшествующих шагов производится выравнивание.</span><span class="sxs-lookup"><span data-stu-id="0df9b-209">Alignment is applied after the preceding steps have been performed.</span></span>  
  
## <a name="code-examples"></a><span data-ttu-id="0df9b-210">Примеры кода</span><span class="sxs-lookup"><span data-stu-id="0df9b-210">Code Examples</span></span>  
 <span data-ttu-id="0df9b-211">В приведенном ниже примере одна строка создается с помощью составного форматирования, а другая – с помощью метода `ToString`.</span><span class="sxs-lookup"><span data-stu-id="0df9b-211">The following example shows one string created using composite formatting and another created using an object's `ToString` method.</span></span> <span data-ttu-id="0df9b-212">Оба способа форматирования дают идентичные результаты.</span><span class="sxs-lookup"><span data-stu-id="0df9b-212">Both types of formatting produce equivalent results.</span></span>  
  
 [!code-csharp[Formatting.Composite#3](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#3)]
 [!code-vb[Formatting.Composite#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#3)]  
  
 <span data-ttu-id="0df9b-213">Предположим, что сейчас май, а текущий день недели — четверг. Тогда значение обеих строк в предыдущем примере будет `Thursday May` для языка и региональных параметров "Английский (США)".</span><span class="sxs-lookup"><span data-stu-id="0df9b-213">Assuming that the current day is a Thursday in May, the value of both strings in the preceding example is `Thursday May` in the U.S. English culture.</span></span>  
  
 <span data-ttu-id="0df9b-214">Метод <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> предоставляет те же функциональные возможности, что и метод <xref:System.String.Format%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-214"><xref:System.Console.WriteLine%2A?displayProperty=nameWithType> exposes the same functionality as <xref:System.String.Format%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0df9b-215">Единственное различие между этими двумя методами состоит в том, что метод <xref:System.String.Format%2A?displayProperty=nameWithType> возвращает результаты в виде строки, а метод <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> записывает результаты в поток вывода, связанный с объектом <xref:System.Console>.</span><span class="sxs-lookup"><span data-stu-id="0df9b-215">The only difference between the two methods is that <xref:System.String.Format%2A?displayProperty=nameWithType> returns its result as a string, while <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> writes the result to the output stream associated with the <xref:System.Console> object.</span></span> <span data-ttu-id="0df9b-216">В следующем примере для форматирования значения переменной <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> в виде денежного значения используется метод `MyInt`.</span><span class="sxs-lookup"><span data-stu-id="0df9b-216">The following example uses the <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> method to format the value of `MyInt` to a currency value.</span></span>  
  
 [!code-csharp[Formatting.Composite#4](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#4)]
 [!code-vb[Formatting.Composite#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#4)]  
  
 <span data-ttu-id="0df9b-217">В следующем примере демонстрируется форматирование нескольких объектов, в том числе форматирование одного и того же объекта двумя разными способами.</span><span class="sxs-lookup"><span data-stu-id="0df9b-217">The following example demonstrates formatting multiple objects, including formatting one object two different ways.</span></span>  
  
 [!code-csharp[Formatting.Composite#5](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#5)]
 [!code-vb[Formatting.Composite#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#5)]  
  
 <span data-ttu-id="0df9b-218">В следующем примере показывается использование выравнивания при форматировании.</span><span class="sxs-lookup"><span data-stu-id="0df9b-218">The following example demonstrates the use of alignment in formatting.</span></span> <span data-ttu-id="0df9b-219">Форматируемые аргументы разделены знаками вертикальной черты ("|"), которые иллюстрируют выравнивание.</span><span class="sxs-lookup"><span data-stu-id="0df9b-219">The arguments that are formatted are placed between vertical bar characters (&#124;) to highlight the resulting alignment.</span></span>  
  
 [!code-csharp[Formatting.Composite#6](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#6)]
 [!code-vb[Formatting.Composite#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#6)]  
  
## <a name="see-also"></a><span data-ttu-id="0df9b-220">См. также</span><span class="sxs-lookup"><span data-stu-id="0df9b-220">See also</span></span>

- <xref:System.Console.WriteLine%2A>
- <xref:System.String.Format%2A?displayProperty=nameWithType>
- [<span data-ttu-id="0df9b-221">Интерполяция строк (C#)</span><span class="sxs-lookup"><span data-stu-id="0df9b-221">String interpolation (C#)</span></span>](../../csharp/language-reference/tokens/interpolated.md)
- [<span data-ttu-id="0df9b-222">Интерполяция строк (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="0df9b-222">String interpolation (Visual Basic)</span></span>](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md)
- [<span data-ttu-id="0df9b-223">Типы форматирования</span><span class="sxs-lookup"><span data-stu-id="0df9b-223">Formatting Types</span></span>](formatting-types.md)
- [<span data-ttu-id="0df9b-224">Строки стандартных числовых форматов</span><span class="sxs-lookup"><span data-stu-id="0df9b-224">Standard Numeric Format Strings</span></span>](standard-numeric-format-strings.md)
- [<span data-ttu-id="0df9b-225">Строки настраиваемых числовых форматов</span><span class="sxs-lookup"><span data-stu-id="0df9b-225">Custom Numeric Format Strings</span></span>](custom-numeric-format-strings.md)
- [<span data-ttu-id="0df9b-226">Строки стандартных форматов даты и времени</span><span class="sxs-lookup"><span data-stu-id="0df9b-226">Standard Date and Time Format Strings</span></span>](standard-date-and-time-format-strings.md)
- [<span data-ttu-id="0df9b-227">Строки настраиваемых форматов даты и времени</span><span class="sxs-lookup"><span data-stu-id="0df9b-227">Custom Date and Time Format Strings</span></span>](custom-date-and-time-format-strings.md)
- [<span data-ttu-id="0df9b-228">Строки стандартного формата TimeSpan</span><span class="sxs-lookup"><span data-stu-id="0df9b-228">Standard TimeSpan Format Strings</span></span>](standard-timespan-format-strings.md)
- [<span data-ttu-id="0df9b-229">Строки настраиваемого формата TimeSpan</span><span class="sxs-lookup"><span data-stu-id="0df9b-229">Custom TimeSpan Format Strings</span></span>](custom-timespan-format-strings.md)
- [<span data-ttu-id="0df9b-230">Строки форматов перечисления</span><span class="sxs-lookup"><span data-stu-id="0df9b-230">Enumeration Format Strings</span></span>](enumeration-format-strings.md)
