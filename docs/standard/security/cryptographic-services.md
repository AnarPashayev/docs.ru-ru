---
title: службы шифрования
description: Общие сведения о методах шифрования и методиках, поддерживаемых .NET.
ms.date: 07/14/2020
ms.technology: dotnet-standard
helpviewer_keywords:
- cryptography [.NET]
- pattern of derived class inheritance
- digital signatures
- asymmetric cryptographic algorithms
- digital signatures, public-key systems
- public keys
- decryption [.NET]
- private keys
- MAC algorithms
- cryptographic algorithms
- private keys, overview
- encryption [.NET]
- security [.NET], encryption
- cryptographic services
- symmetric cryptographic algorithms
- hash
- message authentication codes
- derived class inheritance
- cryptography [.NET], about
- random number generation
ms.assetid: f96284bc-7b73-44b5-ac59-fac613ad09f8
ms.openlocfilehash: 4cd4e493e0e7d159b2749dac78b9a560e20fd75c
ms.sourcegitcommit: b7a8b09828bab4e90f66af8d495ecd7024c45042
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87557025"
---
# <a name="cryptographic-services"></a><span data-ttu-id="b67f1-103">службы шифрования</span><span class="sxs-lookup"><span data-stu-id="b67f1-103">Cryptographic Services</span></span>

<span data-ttu-id="b67f1-104">Общедоступные сети, такие как Интернет, не предоставляют средств обеспечения защищенного взаимодействия между объектами.</span><span class="sxs-lookup"><span data-stu-id="b67f1-104">Public networks such as the Internet do not provide a means of secure communication between entities.</span></span> <span data-ttu-id="b67f1-105">При взаимодействии через такие сети может происходить чтение или даже изменение передаваемой информации неправомочными третьими лицами.</span><span class="sxs-lookup"><span data-stu-id="b67f1-105">Communication over such networks is susceptible to being read or even modified by unauthorized third parties.</span></span> <span data-ttu-id="b67f1-106">Использование криптографии обеспечивает защиту данных от просмотра, обнаружение изменения данных и безопасный обмен данными на основе незащищенных каналов.</span><span class="sxs-lookup"><span data-stu-id="b67f1-106">Cryptography helps protect data from being viewed, provides ways to detect whether data has been modified, and helps provide a secure means of communication over otherwise nonsecure channels.</span></span> <span data-ttu-id="b67f1-107">Например, данные могут быть зашифрованы с помощью некоторого криптографического алгоритма, переданы в зашифрованном виде, а затем расшифрованы лицом, которому они предназначались.</span><span class="sxs-lookup"><span data-stu-id="b67f1-107">For example, data can be encrypted by using a cryptographic algorithm, transmitted in an encrypted state, and later decrypted by the intended party.</span></span> <span data-ttu-id="b67f1-108">Если зашифрованные данные будут перехвачены третьим лицом, расшифровать их будет трудно.</span><span class="sxs-lookup"><span data-stu-id="b67f1-108">If a third party intercepts the encrypted data, it will be difficult to decipher.</span></span>

<span data-ttu-id="b67f1-109">В .NET классы в <xref:System.Security.Cryptography> пространстве имен управляют множеством сведений о криптографии.</span><span class="sxs-lookup"><span data-stu-id="b67f1-109">In .NET, the classes in the <xref:System.Security.Cryptography> namespace manage many details of cryptography for you.</span></span> <span data-ttu-id="b67f1-110">Некоторые из них являются оболочками для реализации операционных систем, а другие — исключительно управляемыми реализациями.</span><span class="sxs-lookup"><span data-stu-id="b67f1-110">Some are wrappers for operating system implementations, while others are purely managed implementations.</span></span> <span data-ttu-id="b67f1-111">При использовании этих классов вам вовсе не обязательно быть экспертом в криптографии.</span><span class="sxs-lookup"><span data-stu-id="b67f1-111">You do not need to be an expert in cryptography to use these classes.</span></span> <span data-ttu-id="b67f1-112">При создании экземпляра одного из классов, реализующих алгоритмы шифрования, ключи создаются автоматически с целью удобства использования, а принятые по умолчанию значения свойств призваны обеспечить максимальную защищенность.</span><span class="sxs-lookup"><span data-stu-id="b67f1-112">When you create a new instance of one of the encryption algorithm classes, keys are autogenerated for ease of use, and default properties are as safe and secure as possible.</span></span>

<span data-ttu-id="b67f1-113">В этом обзоре представлены краткие сведения о методах и методиках шифрования, поддерживаемых .NET, включая манифесты ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="b67f1-113">This overview provides a synopsis of the encryption methods and practices supported by .NET, including the ClickOnce manifests.</span></span>

## <a name="cryptographic-primitives"></a><span data-ttu-id="b67f1-114">Криптографические примитивы</span><span class="sxs-lookup"><span data-stu-id="b67f1-114">Cryptographic Primitives</span></span>

<span data-ttu-id="b67f1-115">В типичной ситуации, когда используется криптография, две стороны (Анна и Виктор) осуществляют связь по незащищенному каналу.</span><span class="sxs-lookup"><span data-stu-id="b67f1-115">In a typical situation where cryptography is used, two parties (Alice and Bob) communicate over a nonsecure channel.</span></span> <span data-ttu-id="b67f1-116">Анна и Виктор хотят быть уверены в том, что передаваемые ими данные не могут быть прочитаны даже в случае возможного перехвата.</span><span class="sxs-lookup"><span data-stu-id="b67f1-116">Alice and Bob want to ensure that their communication remains incomprehensible by anyone who might be listening.</span></span> <span data-ttu-id="b67f1-117">Более того, так как Анна и Виктор находятся в удаленных друг от друга местах, Анна должна быть уверена, что информация, которую она получает от Виктора, не подвергается изменению во время передачи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-117">Furthermore, because Alice and Bob are in remote locations, Alice must make sure that the information she receives from Bob has not been modified by anyone during transmission.</span></span> <span data-ttu-id="b67f1-118">Также она должна быть уверена в том, что получаемые ею данные действительно исходят от Виктора, а не от кого-то, выдающего себя за него.</span><span class="sxs-lookup"><span data-stu-id="b67f1-118">In addition, she must make sure that the information really does originate from Bob and not from someone who is impersonating Bob.</span></span>

<span data-ttu-id="b67f1-119">Криптография используется для достижения следующих целей:</span><span class="sxs-lookup"><span data-stu-id="b67f1-119">Cryptography is used to achieve the following goals:</span></span>

- <span data-ttu-id="b67f1-120">конфиденциальность: защита данных или личной информации пользователя от несанкционированного просмотра;</span><span class="sxs-lookup"><span data-stu-id="b67f1-120">Confidentiality: To help protect a user's identity or data from being read.</span></span>

- <span data-ttu-id="b67f1-121">целостность данных: защита данных от несанкционированного изменения;</span><span class="sxs-lookup"><span data-stu-id="b67f1-121">Data integrity: To help protect data from being changed.</span></span>

- <span data-ttu-id="b67f1-122">аутентификация: проверка того, что данные исходят действительно от определенного лица;</span><span class="sxs-lookup"><span data-stu-id="b67f1-122">Authentication: To ensure that data originates from a particular party.</span></span>

- <span data-ttu-id="b67f1-123">неотрекаемость: ни одна сторона не должна иметь возможность отрицать факт отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-123">Non-repudiation: To prevent a particular party from denying that they sent a message.</span></span>

<span data-ttu-id="b67f1-124">Для достижения этих целей можно использовать алгоритмы и правила, известные как криптографические примитивы, для создания криптографической схемы.</span><span class="sxs-lookup"><span data-stu-id="b67f1-124">To achieve these goals, you can use a combination of algorithms and practices known as cryptographic primitives to create a cryptographic scheme.</span></span> <span data-ttu-id="b67f1-125">В таблице ниже приведены криптографические примитивы и описано их использование.</span><span class="sxs-lookup"><span data-stu-id="b67f1-125">The following table lists the cryptographic primitives and their uses.</span></span>

|<span data-ttu-id="b67f1-126">Криптографический примитив</span><span class="sxs-lookup"><span data-stu-id="b67f1-126">Cryptographic primitive</span></span>|<span data-ttu-id="b67f1-127">Использование</span><span class="sxs-lookup"><span data-stu-id="b67f1-127">Use</span></span>|
|-----------------------------|---------|
|<span data-ttu-id="b67f1-128">Шифрование с закрытым ключом (симметричное шифрование)</span><span class="sxs-lookup"><span data-stu-id="b67f1-128">Secret-key encryption (symmetric cryptography)</span></span>|<span data-ttu-id="b67f1-129">Осуществляет преобразование данных с целью предотвращения их просмотра третьей стороной.</span><span class="sxs-lookup"><span data-stu-id="b67f1-129">Performs a transformation on data to keep it from being read by third parties.</span></span> <span data-ttu-id="b67f1-130">При таком способе шифрования для шифрования и расшифровки данных используется один общий закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="b67f1-130">This type of encryption uses a single shared, secret key to encrypt and decrypt data.</span></span>|
|<span data-ttu-id="b67f1-131">Шифрование с открытым ключом (асимметричное шифрование)</span><span class="sxs-lookup"><span data-stu-id="b67f1-131">Public-key encryption (asymmetric cryptography)</span></span>|<span data-ttu-id="b67f1-132">Осуществляет преобразование данных с целью предотвращения их просмотра третьей стороной.</span><span class="sxs-lookup"><span data-stu-id="b67f1-132">Performs a transformation on data to keep it from being read by third parties.</span></span> <span data-ttu-id="b67f1-133">При таком способе шифрования для шифрования и расшифровки данных используется набор, состоящий из открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-133">This type of encryption uses a public/private key pair to encrypt and decrypt data.</span></span>|
|<span data-ttu-id="b67f1-134">Создание криптографической подписи</span><span class="sxs-lookup"><span data-stu-id="b67f1-134">Cryptographic signing</span></span>|<span data-ttu-id="b67f1-135">Позволяет проверить, действительно ли данные исходят от конкретного лица, с помощью уникальной цифровой подписи этого лица.</span><span class="sxs-lookup"><span data-stu-id="b67f1-135">Helps verify that data originates from a specific party by creating a digital signature that is unique to that party.</span></span> <span data-ttu-id="b67f1-136">Этот процесс также использует хэш-функции.</span><span class="sxs-lookup"><span data-stu-id="b67f1-136">This process also uses hash functions.</span></span>|
|<span data-ttu-id="b67f1-137">Криптографическое хэширование</span><span class="sxs-lookup"><span data-stu-id="b67f1-137">Cryptographic hashes</span></span>|<span data-ttu-id="b67f1-138">Отображает данные любого размера в байтовую последовательность фиксированной длины.</span><span class="sxs-lookup"><span data-stu-id="b67f1-138">Maps data from any length to a fixed-length byte sequence.</span></span> <span data-ttu-id="b67f1-139">Результаты хэширования статистически уникальны; отличающаяся хотя бы одним байтом последовательность не будет преобразована в то же самое значение.</span><span class="sxs-lookup"><span data-stu-id="b67f1-139">Hashes are statistically unique; a different two-byte sequence will not hash to the same value.</span></span>|

## <a name="secret-key-encryption"></a><span data-ttu-id="b67f1-140">Шифрование с закрытым ключом</span><span class="sxs-lookup"><span data-stu-id="b67f1-140">Secret-Key Encryption</span></span>

<span data-ttu-id="b67f1-141">При шифровании с закрытым ключом для шифрования и расшифровки данных используется один закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="b67f1-141">Secret-key encryption algorithms use a single secret key to encrypt and decrypt data.</span></span> <span data-ttu-id="b67f1-142">Необходимо обезопасить этот ключ от несанкционированного доступа, потому что любое обладающее им лицо может использовать его для расшифровки данных или шифрования собственных данных с подменой источника.</span><span class="sxs-lookup"><span data-stu-id="b67f1-142">You must secure the key from access by unauthorized agents, because any party that has the key can use it to decrypt your data or encrypt their own data, claiming it originated from you.</span></span>

<span data-ttu-id="b67f1-143">Шифрование с закрытым ключом называют также симметричным шифрованием, так как для шифрования и расшифровки используется один и тот же ключ.</span><span class="sxs-lookup"><span data-stu-id="b67f1-143">Secret-key encryption is also referred to as symmetric encryption because the same key is used for encryption and decryption.</span></span> <span data-ttu-id="b67f1-144">Алгоритмы шифрования с закрытым ключом являются очень быстрыми (по сравнению с алгоритмами шифрования с открытым ключом) и хорошо подходят для осуществления криптографических преобразований больших массивов данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-144">Secret-key encryption algorithms are very fast (compared with public-key algorithms) and are well suited for performing cryptographic transformations on large streams of data.</span></span> <span data-ttu-id="b67f1-145">Асимметричные алгоритмы шифрования, такие как RSA, имеют математические ограничения на объем шифруемых данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-145">Asymmetric encryption algorithms such as RSA are limited mathematically in how much data they can encrypt.</span></span> <span data-ttu-id="b67f1-146">Для симметричных алгоритмов шифрования подобные проблемы обычно не возникают.</span><span class="sxs-lookup"><span data-stu-id="b67f1-146">Symmetric encryption algorithms do not generally have those problems.</span></span>

<span data-ttu-id="b67f1-147">Разновидность алгоритмов шифрования с закрытым ключом, называемая блочным шифром, используется для шифрования целого блока данных за один раз.</span><span class="sxs-lookup"><span data-stu-id="b67f1-147">A type of secret-key algorithm called a block cipher is used to encrypt one block of data at a time.</span></span> <span data-ttu-id="b67f1-148">Блочные шифры (такие как DES, TrippleDES и AES) преобразуют входной блок данных длиной в *n* байтов в выходной блок зашифрованных данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-148">Block ciphers such as Data Encryption Standard (DES), TripleDES, and Advanced Encryption Standard (AES) cryptographically transform an input block of *n* bytes into an output block of encrypted bytes.</span></span> <span data-ttu-id="b67f1-149">Если необходимо зашифровать или расшифровать последовательность байтов, следует делать это блок за блоком.</span><span class="sxs-lookup"><span data-stu-id="b67f1-149">If you want to encrypt or decrypt a sequence of bytes, you have to do it block by block.</span></span> <span data-ttu-id="b67f1-150">Так как значение *n* достаточно мало (8 байт для DES и TripleDES; 16 байт (по умолчанию), 24 или 32 байта для AES), данные большей длины, чем *n* , должны шифроваться блоками, по одному за раз.</span><span class="sxs-lookup"><span data-stu-id="b67f1-150">Because *n* is small (8 bytes for DES and TripleDES; 16 bytes [the default], 24 bytes, or 32 bytes for AES), data values that are larger than *n* have to be encrypted one block at a time.</span></span> <span data-ttu-id="b67f1-151">Блоки данных размером менее *n* байт должны быть увеличены до *n* байт перед обработкой.</span><span class="sxs-lookup"><span data-stu-id="b67f1-151">Data values that are smaller than *n* have to be expanded to *n* in order to be processed.</span></span>

<span data-ttu-id="b67f1-152">Одна из простейших форм блочного шифра называется режимом электронной кодовой книги (ECB).</span><span class="sxs-lookup"><span data-stu-id="b67f1-152">One simple form of block cipher is called the electronic codebook (ECB) mode.</span></span> <span data-ttu-id="b67f1-153">Режим ECB не считается безопасным, так как в нем не используется вектор инициализации для инициализации первого текстового блока.</span><span class="sxs-lookup"><span data-stu-id="b67f1-153">ECB mode is not considered secure, because it does not use an initialization vector to initialize the first plaintext block.</span></span> <span data-ttu-id="b67f1-154">Для заданного закрытого ключа *k*простой блочный шифр, не использующий вектор инициализации, зашифрует одинаковые входные блоки текста в одинаковые выходные блоки зашифрованного текста.</span><span class="sxs-lookup"><span data-stu-id="b67f1-154">For a given secret key *k*, a simple block cipher that does not use an initialization vector will encrypt the same input block of plaintext into the same output block of ciphertext.</span></span> <span data-ttu-id="b67f1-155">Поэтому, если во входном текстовом потоке есть одинаковые блоки, в зашифрованном потоке также будут одинаковые блоки.</span><span class="sxs-lookup"><span data-stu-id="b67f1-155">Therefore, if you have duplicate blocks in your input plaintext stream, you will have duplicate blocks in your output ciphertext stream.</span></span> <span data-ttu-id="b67f1-156">Такие повторяющиеся выходные блоки сообщают неправомочным пользователям о ненадежных алгоритмах шифрования, которыми можно воспользоваться, и о возможных типах атак.</span><span class="sxs-lookup"><span data-stu-id="b67f1-156">These duplicate output blocks alert unauthorized users to the weak encryption used the algorithms that might have been employed, and the possible modes of attack.</span></span> <span data-ttu-id="b67f1-157">Шифр ECB поэтому очень уязвим для анализа и, в конечном итоге, для взлома ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-157">The ECB cipher mode is therefore quite vulnerable to analysis, and ultimately, key discovery.</span></span>

<span data-ttu-id="b67f1-158">Классы блочных шифров, предоставляемые библиотекой базовых классов, используют режим сцепления, называемый сцеплением шифровальных блоков (CBC), хотя эту настройку по умолчанию можно изменить.</span><span class="sxs-lookup"><span data-stu-id="b67f1-158">The block cipher classes that are provided in the base class library use a default chaining mode called cipher-block chaining (CBC), although you can change this default if you want.</span></span>

<span data-ttu-id="b67f1-159">Шифры CBC решают проблемы, связанные с использованием шифров ECB, благодаря использованию вектора инициализации (IV) для шифрования первого текстового блока.</span><span class="sxs-lookup"><span data-stu-id="b67f1-159">CBC ciphers overcome the problems associated with ECB ciphers by using an initialization vector (IV) to encrypt the first block of plaintext.</span></span> <span data-ttu-id="b67f1-160">Перед шифрованием каждого блока открытого текста он объединяется с зашифрованным текстом предыдущего блока с помощью поразрядной исключающей операции OR (`XOR`).</span><span class="sxs-lookup"><span data-stu-id="b67f1-160">Each subsequent block of plaintext undergoes a bitwise exclusive OR (`XOR`) operation with the previous ciphertext block before it is encrypted.</span></span> <span data-ttu-id="b67f1-161">Поэтому каждый блок зашифрованного текста зависит от всех предыдущих блоков.</span><span class="sxs-lookup"><span data-stu-id="b67f1-161">Each ciphertext block is therefore dependent on all previous blocks.</span></span> <span data-ttu-id="b67f1-162">При использовании этой системы шифрования стандартные заголовки сообщений, которые могут быть известны неправомочному пользователю, не могут быть использованы им для восстановления закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-162">When this system is used, common message headers that might be known to an unauthorized user cannot be used to reverse-engineer a key.</span></span>

<span data-ttu-id="b67f1-163">Одним из способов раскрытия данных, зашифрованных с помощью шифра CBC, является подбор ключа методом полного перебора возможных ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-163">One way to compromise data that is encrypted with a CBC cipher is to perform an exhaustive search of every possible key.</span></span> <span data-ttu-id="b67f1-164">В зависимости от длины использованного для шифрования ключа такой подбор занимает очень много времени даже на самых быстрых компьютерах, поэтому он является практически неосуществимым.</span><span class="sxs-lookup"><span data-stu-id="b67f1-164">Depending on the size of the key that is used to perform encryption, this kind of search is very time-consuming using even the fastest computers and is therefore infeasible.</span></span> <span data-ttu-id="b67f1-165">Шифры с большей длиной ключа труднее взломать.</span><span class="sxs-lookup"><span data-stu-id="b67f1-165">Larger key sizes are more difficult to decipher.</span></span> <span data-ttu-id="b67f1-166">Несмотря на то что использование шифрования не гарантирует теоретическую невозможность раскрытия зашифрованных данных неправомочным лицом, стоимость такого взлома становится чрезвычайно высокой.</span><span class="sxs-lookup"><span data-stu-id="b67f1-166">Although encryption does not make it theoretically impossible for an adversary to retrieve the encrypted data, it does raise the cost of doing this.</span></span> <span data-ttu-id="b67f1-167">Если процесс подбора ключа и раскрытия зашифрованных данных занимает три месяца, в то время как сами данные актуальны в течение всего нескольких дней, подбор ключа методом полного перебора не представляет практической ценности.</span><span class="sxs-lookup"><span data-stu-id="b67f1-167">If it takes three months to perform an exhaustive search to retrieve data that is meaningful only for a few days, the exhaustive search method is impractical.</span></span>

<span data-ttu-id="b67f1-168">Недостатком шифрования с закрытым ключом является необходимость того, чтобы две стороны согласовали ключ и вектор инициализации, для чего может потребоваться их передача через систему связи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-168">The disadvantage of secret-key encryption is that it presumes two parties have agreed on a key and IV, and communicated their values.</span></span> <span data-ttu-id="b67f1-169">Вектор инициализации не считается секретным и может передаваться вместе с сообщением в текстовом формате.</span><span class="sxs-lookup"><span data-stu-id="b67f1-169">The IV is not considered a secret and can be transmitted in plaintext with the message.</span></span> <span data-ttu-id="b67f1-170">Однако ключ не должен стать известен неправомочным пользователям.</span><span class="sxs-lookup"><span data-stu-id="b67f1-170">However, the key must be kept secret from unauthorized users.</span></span> <span data-ttu-id="b67f1-171">Из-за этих проблем шифрование с закрытым ключом часто используется в сочетании с шифрованием с открытым ключом для безопасной передачи ключа и вектора инициализации.</span><span class="sxs-lookup"><span data-stu-id="b67f1-171">Because of these problems, secret-key encryption is often used together with public-key encryption to privately communicate the values of the key and IV.</span></span>

<span data-ttu-id="b67f1-172">Предположим, что Анна и Виктор являются двумя сторонами, которые хотят осуществлять связь по незащищенному каналу. Они могли бы воспользоваться шифрованием с закрытым ключом следующим образом. Анна и Виктор соглашаются использовать некоторый определенный алгоритм (например, AES) с определенным ключом и вектором инициализации.</span><span class="sxs-lookup"><span data-stu-id="b67f1-172">Assuming that Alice and Bob are two parties who want to communicate over a nonsecure channel, they might use secret-key encryption as follows: Alice and Bob agree to use one particular algorithm (AES, for example) with a particular key and IV.</span></span> <span data-ttu-id="b67f1-173">Алиса формирует сообщение и создает сетевой поток (например, именованный канал или сетевую почту), на который отправляется сообщение.</span><span class="sxs-lookup"><span data-stu-id="b67f1-173">Alice composes a message and creates a network stream (perhaps a named pipe or network email) on which to send the message.</span></span> <span data-ttu-id="b67f1-174">Затем она шифрует текст с помощью ключа и вектора инициализации и по интрасети пересылает зашифрованное сообщение и вектор инициализации Виктору.</span><span class="sxs-lookup"><span data-stu-id="b67f1-174">Next, she encrypts the text using the key and IV, and sends the encrypted message and IV to Bob over the intranet.</span></span> <span data-ttu-id="b67f1-175">Виктор принимает зашифрованный текст и осуществляет расшифровку, используя ранее согласованные ключ и вектор инициализации.</span><span class="sxs-lookup"><span data-stu-id="b67f1-175">Bob receives the encrypted text and decrypts it by using the IV and previously agreed upon key.</span></span> <span data-ttu-id="b67f1-176">Если передача перехватывается, перехватчик не сможет восстановить исходное сообщение, так как он не знает ключ.</span><span class="sxs-lookup"><span data-stu-id="b67f1-176">If the transmission is intercepted, the interceptor cannot recover the original message, because they do not know the key.</span></span> <span data-ttu-id="b67f1-177">В этой ситуации в секрете должен сохраняться только ключ.</span><span class="sxs-lookup"><span data-stu-id="b67f1-177">In this scenario, only the key must remain secret.</span></span> <span data-ttu-id="b67f1-178">В более реалистичном случае либо Анна, либо Виктор создает закрытый ключ и использует шифрование с открытым ключом (асимметричное) для передачи другой стороне закрытого (симметричного) ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-178">In a real world scenario, either Alice or Bob generates a secret key and uses public-key (asymmetric) encryption to transfer the secret (symmetric) key to the other party.</span></span> <span data-ttu-id="b67f1-179">Подробнее о шифровании с открытым ключом читайте в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="b67f1-179">For more information about public-key encryption, see the next section.</span></span>

<span data-ttu-id="b67f1-180">.NET предоставляет следующие классы, реализующие алгоритмы шифрования с закрытым ключом:</span><span class="sxs-lookup"><span data-stu-id="b67f1-180">.NET provides the following classes that implement secret-key encryption algorithms:</span></span>

- <xref:System.Security.Cryptography.Aes>

- <span data-ttu-id="b67f1-181"><xref:System.Security.Cryptography.HMACSHA256>, <xref:System.Security.Cryptography.HMACSHA384> и <xref:System.Security.Cryptography.HMACSHA512>.</span><span class="sxs-lookup"><span data-stu-id="b67f1-181"><xref:System.Security.Cryptography.HMACSHA256>, <xref:System.Security.Cryptography.HMACSHA384> and <xref:System.Security.Cryptography.HMACSHA512>.</span></span> <span data-ttu-id="b67f1-182">(Это технически алгоритмы с закрытым ключом, так как они представляют коды проверки подлинности сообщений, вычисляемые с помощью криптографической хэш-функции в сочетании с секретным ключом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-182">(These are technically secret-key algorithms because they represent message authentication codes that are calculated by using a cryptographic hash function combined with a secret key.</span></span> <span data-ttu-id="b67f1-183">См. раздел [хэш-значения](#hash-values)далее в этой статье.)</span><span class="sxs-lookup"><span data-stu-id="b67f1-183">See [Hash Values](#hash-values), later in this article.)</span></span>

## <a name="public-key-encryption"></a><span data-ttu-id="b67f1-184">Шифрование с открытым ключом</span><span class="sxs-lookup"><span data-stu-id="b67f1-184">Public-Key Encryption</span></span>

<span data-ttu-id="b67f1-185">При шифровании с открытым ключом используются закрытый ключ, который должен храниться в секрете от неправомочных пользователей, а также открытый ключ, который может предоставляться кому угодно.</span><span class="sxs-lookup"><span data-stu-id="b67f1-185">Public-key encryption uses a private key that must be kept secret from unauthorized users and a public key that can be made public to anyone.</span></span> <span data-ttu-id="b67f1-186">Открытый и закрытый ключи математически взаимосвязаны. Данные, зашифрованные с помощью открытого ключа, можно расшифровать исключительно с помощью соответствующего закрытого ключа, а цифровая подпись данных, подписанных с помощью закрытого ключа, может быть проверена только с помощью соответствующего открытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-186">The public key and the private key are mathematically linked; data that is encrypted with the public key can be decrypted only with the private key, and data that is signed with the private key can be verified only with the public key.</span></span> <span data-ttu-id="b67f1-187">Открытый ключ можно предоставить любому лицу; он используется для шифрования данных, которые должны быть отправлены хранителю закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-187">The public key can be made available to anyone; it is used for encrypting data to be sent to the keeper of the private key.</span></span> <span data-ttu-id="b67f1-188">Алгоритмы шифрования с открытым ключом также известны как асимметричные алгоритмы, потому что для шифрования данных требуется один ключ, а для расшифровки — другой.</span><span class="sxs-lookup"><span data-stu-id="b67f1-188">Public-key cryptographic algorithms are also known as asymmetric algorithms because one key is required to encrypt data, and another key is required to decrypt data.</span></span> <span data-ttu-id="b67f1-189">Основное правило шифрования запрещает повторное использование ключа; оба ключа в каждом сеансе шифрования должны быть уникальными.</span><span class="sxs-lookup"><span data-stu-id="b67f1-189">A basic cryptographic rule prohibits key reuse, and both keys should be unique for each communication session.</span></span> <span data-ttu-id="b67f1-190">Однако на практике асимметричные ключи обычно используются подолгу.</span><span class="sxs-lookup"><span data-stu-id="b67f1-190">However, in practice, asymmetric keys are generally long-lived.</span></span>

<span data-ttu-id="b67f1-191">Две стороны (Анна и Виктор) могут использовать шифрование с открытым ключом следующим образом. Сначала Анна создает набор, состоящий из открытого и закрытого ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-191">Two parties (Alice and Bob) might use public-key encryption as follows: First, Alice generates a public/private key pair.</span></span> <span data-ttu-id="b67f1-192">Если Виктор хочет послать Анне зашифрованное сообщение, он запрашивает у нее ее открытый ключ.</span><span class="sxs-lookup"><span data-stu-id="b67f1-192">If Bob wants to send Alice an encrypted message, he asks her for her public key.</span></span> <span data-ttu-id="b67f1-193">Анна высылает Виктору свой открытый ключ через незащищенную сеть, и Виктор использует полученный ключ для шифрования своего сообщения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-193">Alice sends Bob her public key over a nonsecure network, and Bob uses this key to encrypt a message.</span></span> <span data-ttu-id="b67f1-194">Виктор пересылает зашифрованное сообщение Анне, а она расшифровывает его с помощью своего закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-194">Bob sends the encrypted message to Alice, and she decrypts it by using her private key.</span></span> <span data-ttu-id="b67f1-195">Если Виктор получил ключ Анны по незащищенному каналу, например через открытую сеть, он оказывается уязвимым для атак типа «злоумышленник в середине».</span><span class="sxs-lookup"><span data-stu-id="b67f1-195">If Bob received Alice's key over a nonsecure channel, such as a public network, Bob is open to a man-in-the-middle attack.</span></span> <span data-ttu-id="b67f1-196">Поэтому Виктору необходимо убедиться в том, что Анна имеет правильную копию открытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-196">Therefore, Bob must verify with Alice that he has a correct copy of her public key.</span></span>

<span data-ttu-id="b67f1-197">Во время передачи Виктору открытого ключа Анны может произойти несанкционированный перехват ключа третьим лицом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-197">During the transmission of Alice's public key, an unauthorized agent might intercept the key.</span></span> <span data-ttu-id="b67f1-198">Более того, возможна ситуация, что то же самое лицо перехватит зашифрованное сообщение Виктора.</span><span class="sxs-lookup"><span data-stu-id="b67f1-198">Furthermore, the same agent might intercept the encrypted message from Bob.</span></span> <span data-ttu-id="b67f1-199">Тем не менее неправомочная сторона не может расшифровать сообщение с помощью открытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-199">However, the agent cannot decrypt the message with the public key.</span></span> <span data-ttu-id="b67f1-200">Сообщение можно расшифровать только с помощью закрытого ключа Анны, который не передавался через какие-либо системы связи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-200">The message can be decrypted only with Alice's private key, which has not been transmitted.</span></span> <span data-ttu-id="b67f1-201">Анна не использует свой закрытый ключ для шифрования ответного сообщения Виктору, потому что любое лицо может расшифровать это сообщение с помощью открытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-201">Alice does not use her private key to encrypt a reply message to Bob, because anyone with the public key could decrypt the message.</span></span> <span data-ttu-id="b67f1-202">Если Анна желает послать Виктору ответное сообщение, она запрашивает у Виктора его открытый ключ и шифрует свое сообщение, используя его.</span><span class="sxs-lookup"><span data-stu-id="b67f1-202">If Alice wants to send a message back to Bob, she asks Bob for his public key and encrypts her message using that public key.</span></span> <span data-ttu-id="b67f1-203">Затем Виктор расшифровывает сообщение с помощью своего соответствующего закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-203">Bob then decrypts the message using his associated private key.</span></span>

<span data-ttu-id="b67f1-204">В этом случае Анна и Виктор используют шифрование с открытым ключом (асимметричное) для передачи закрытого (симметричного) ключа, а затем пользуются шифрованием с этим закрытым ключом в течение сеанса связи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-204">In this scenario, Alice and Bob use public-key (asymmetric) encryption to transfer a secret (symmetric) key and use secret-key encryption for the remainder of their session.</span></span>

<span data-ttu-id="b67f1-205">В списке ниже сравниваются алгоритмы шифрования с открытым и закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-205">The following list offers comparisons between public-key and secret-key cryptographic algorithms:</span></span>

- <span data-ttu-id="b67f1-206">Алгоритмы шифрования с открытым ключом используют буфер фиксированного размера, в то время как алгоритмы шифрования с закрытым ключом могут использовать буфер переменного размера.</span><span class="sxs-lookup"><span data-stu-id="b67f1-206">Public-key cryptographic algorithms use a fixed buffer size, whereas secret-key cryptographic algorithms use a variable-length buffer.</span></span>

- <span data-ttu-id="b67f1-207">Алгоритмы шифрования с открытым ключом нельзя использовать для сцепления блоков данных в потоки тем же образом, как в алгоритмах шифрования с закрытым ключом, потому что можно шифровать только маленькие порции данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-207">Public-key algorithms cannot be used to chain data together into streams the way secret-key algorithms can, because only small amounts of data can be encrypted.</span></span> <span data-ttu-id="b67f1-208">Поэтому асимметричные операции не используют такую же потоковую модель, как симметричные операции.</span><span class="sxs-lookup"><span data-stu-id="b67f1-208">Therefore, asymmetric operations do not use the same streaming model as symmetric operations.</span></span>

- <span data-ttu-id="b67f1-209">Шифрование с открытым ключом имеет намного большее пространство ключей (диапазон возможных значений ключа), чем шифрование с закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-209">Public-key encryption has a much larger keyspace (range of possible values for the key) than secret-key encryption.</span></span> <span data-ttu-id="b67f1-210">Поэтому такое шифрование менее уязвимо к атакам полного перебора, когда проверяются все возможные значения ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-210">Therefore, public-key encryption is less susceptible to exhaustive attacks that try every possible key.</span></span>

- <span data-ttu-id="b67f1-211">Открытые ключи можно легко распространять, так как они не требуют особой защиты при условии, что существует некий способ установления подлинности источника.</span><span class="sxs-lookup"><span data-stu-id="b67f1-211">Public keys are easy to distribute because they do not have to be secured, provided that some way exists to verify the identity of the sender.</span></span>

- <span data-ttu-id="b67f1-212">Некоторые алгоритмы шифрования с открытым ключом (такие как RSA и DSA, но не Диффи-Хелмана) можно использовать для создания цифровых подписей, служащих для подтверждения подлинности лица, от которого исходят данные.</span><span class="sxs-lookup"><span data-stu-id="b67f1-212">Some public-key algorithms (such as RSA and DSA, but not Diffie-Hellman) can be used to create digital signatures to verify the identity of the sender of data.</span></span>

- <span data-ttu-id="b67f1-213">Алгоритмы шифрования с открытым ключом являются весьма медленными по сравнению с алгоритмами шифрования с закрытым ключом и не предназначены для шифрования больших объемов данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-213">Public-key algorithms are very slow compared with secret-key algorithms, and are not designed to encrypt large amounts of data.</span></span> <span data-ttu-id="b67f1-214">Использование шифрования с открытым ключом имеет смысл только при передаче очень малых массивов данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-214">Public-key algorithms are useful only for transferring very small amounts of data.</span></span> <span data-ttu-id="b67f1-215">Обычно шифрование с открытым ключом применяется для того, чтобы зашифровать ключ и вектор инициализации, которые будут использоваться при шифровании с закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-215">Typically, public-key encryption is used to encrypt a key and IV to be used by a secret-key algorithm.</span></span> <span data-ttu-id="b67f1-216">После передачи ключа и вектора инициализации используется уже шифрование с закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-216">After the key and IV are transferred, secret-key encryption is used for the remainder of the session.</span></span>

<span data-ttu-id="b67f1-217">.NET предоставляет следующие классы, реализующие алгоритмы с открытым ключом:</span><span class="sxs-lookup"><span data-stu-id="b67f1-217">.NET provides the following classes that implement public-key algorithms:</span></span>

- <xref:System.Security.Cryptography.RSA>

- <xref:System.Security.Cryptography.ECDsa>

- <xref:System.Security.Cryptography.ECDiffieHellman>

- <xref:System.Security.Cryptography.DSA>

<span data-ttu-id="b67f1-218">RSA допускает шифрование и подписывание, но DSA можно использовать только для подписывания.</span><span class="sxs-lookup"><span data-stu-id="b67f1-218">RSA allows both encryption and signing, but DSA can be used only for signing.</span></span> <span data-ttu-id="b67f1-219">DSA не так безопасен, как RSA, и мы рекомендуем RSA.</span><span class="sxs-lookup"><span data-stu-id="b67f1-219">DSA is not as secure as RSA, and we recommend RSA.</span></span> <span data-ttu-id="b67f1-220">Диффи-Хелмана можно использовать только для создания ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-220">Diffie-Hellman can be used only for key generation.</span></span> <span data-ttu-id="b67f1-221">В целом, алгоритмы с открытым ключом имеют более ограниченную сферу применения, чем алгоритмы с закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b67f1-221">In general, public-key algorithms are more limited in their uses than private-key algorithms.</span></span>

## <a name="digital-signatures"></a><span data-ttu-id="b67f1-222">цифровые подписи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-222">Digital Signatures</span></span>

<span data-ttu-id="b67f1-223">Алгоритмы шифрования с открытым ключом также можно использовать для создания цифровых подписей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-223">Public-key algorithms can also be used to form digital signatures.</span></span> <span data-ttu-id="b67f1-224">Цифровые подписи удостоверяют подлинность источника данных (если вы доверяете открытому ключу источника) и защищают целостность данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-224">Digital signatures authenticate the identity of a sender (if you trust the sender's public key) and help protect the integrity of data.</span></span> <span data-ttu-id="b67f1-225">С помощью открытого ключа, созданного Анной, получатель отправленных ею данных может проверить, что их источником действительно является Анна, сравнив цифровую подпись полученных данных с открытым ключом Анны.</span><span class="sxs-lookup"><span data-stu-id="b67f1-225">Using a public key generated by Alice, the recipient of Alice's data can verify that Alice sent it by comparing the digital signature to Alice's data and Alice's public key.</span></span>

<span data-ttu-id="b67f1-226">Чтобы использовать шифрование с открытым ключом для создания цифровой подписи сообщения, Анна сначала применяет к этому сообщению хэш-алгоритм, который создает хэш сообщения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-226">To use public-key cryptography to digitally sign a message, Alice first applies a hash algorithm to the message to create a message digest.</span></span> <span data-ttu-id="b67f1-227">Хэш сообщения является компактным и уникальным представлением данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-227">The message digest is a compact and unique representation of data.</span></span> <span data-ttu-id="b67f1-228">Для создания своей личной цифровой подписи Анна шифрует хэш сообщения с помощью своего закрытого ключа.</span><span class="sxs-lookup"><span data-stu-id="b67f1-228">Alice then encrypts the message digest with her private key to create her personal signature.</span></span> <span data-ttu-id="b67f1-229">При получении сообщения и цифровой подписи Виктор расшифровывает подпись с помощью открытого ключа Анны, восстанавливая хэш сообщения, а затем хэширует сообщение с помощью того же алгоритма, который использовала Анна.</span><span class="sxs-lookup"><span data-stu-id="b67f1-229">Upon receiving the message and signature, Bob decrypts the signature using Alice's public key to recover the message digest and hashes the message using the same hash algorithm that Alice used.</span></span> <span data-ttu-id="b67f1-230">Если вычисленный Виктором хэш в точности совпадает с хэшем, полученным от Анны, Виктор может быть уверен в том, что сообщение пришло действительно от владельца закрытого ключа и что данные в нем не были изменены.</span><span class="sxs-lookup"><span data-stu-id="b67f1-230">If the message digest that Bob computes exactly matches the message digest received from Alice, Bob is assured that the message came from the possessor of the private key and that the data has not been modified.</span></span> <span data-ttu-id="b67f1-231">Если Виктор уверен, что именно Анна владеет закрытым ключом, он удостоверяется в том, что сообщение пришло от нее.</span><span class="sxs-lookup"><span data-stu-id="b67f1-231">If Bob trusts that Alice is the possessor of the private key, he knows that the message came from Alice.</span></span>

> [!NOTE]
> <span data-ttu-id="b67f1-232">Цифровая подпись может быть проверена любым лицом, потому что открытый ключ отправителя является общедоступным и обычно включается в формат цифровой подписи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-232">A signature can be verified by anyone because the sender's public key is common knowledge and is typically included in the digital signature format.</span></span> <span data-ttu-id="b67f1-233">Рассматриваемый метод не обеспечивает секретности сообщения; для обеспечения секретности его следует еще и зашифровать.</span><span class="sxs-lookup"><span data-stu-id="b67f1-233">This method does not retain the secrecy of the message; for the message to be secret, it must also be encrypted.</span></span>

<span data-ttu-id="b67f1-234">.NET предоставляет следующие классы, реализующие алгоритмы цифровых подписей:</span><span class="sxs-lookup"><span data-stu-id="b67f1-234">.NET provides the following classes that implement digital signature algorithms:</span></span>

- <xref:System.Security.Cryptography.RSA>

- <xref:System.Security.Cryptography.ECDsa>

- <xref:System.Security.Cryptography.DSA>

## <a name="hash-values"></a><span data-ttu-id="b67f1-235">Хэш-значения</span><span class="sxs-lookup"><span data-stu-id="b67f1-235">Hash Values</span></span>

<span data-ttu-id="b67f1-236">Хэш-алгоритмы преобразуют двоичные последовательности произвольной длины в двоичные последовательности фиксированного меньшего размера, известные как хэш-значения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-236">Hash algorithms map binary values of an arbitrary length to smaller binary values of a fixed length, known as hash values.</span></span> <span data-ttu-id="b67f1-237">Хэш-значение является числовым представлением порции данных.</span><span class="sxs-lookup"><span data-stu-id="b67f1-237">A hash value is a numerical representation of a piece of data.</span></span> <span data-ttu-id="b67f1-238">Если в хэшированном абзаце текста изменяется хотя бы одна буква, результат хэширования также меняется.</span><span class="sxs-lookup"><span data-stu-id="b67f1-238">If you hash a paragraph of plaintext and change even one letter of the paragraph, a subsequent hash will produce a different value.</span></span> <span data-ttu-id="b67f1-239">Если хэш является криптостойким, его значение значительно изменится.</span><span class="sxs-lookup"><span data-stu-id="b67f1-239">If the hash is cryptographically strong, its value will change significantly.</span></span> <span data-ttu-id="b67f1-240">Например, если изменяется один бит сообщения, результат выполнения криптостойкой хэш-функции может отличаться на 50 %.</span><span class="sxs-lookup"><span data-stu-id="b67f1-240">For example, if a single bit of a message is changed, a strong hash function may produce an output that differs by 50 percent.</span></span> <span data-ttu-id="b67f1-241">Несколько входных значений могут преобразовываться в один хэш-код.</span><span class="sxs-lookup"><span data-stu-id="b67f1-241">Many input values may hash to the same output value.</span></span> <span data-ttu-id="b67f1-242">Однако в вычислительном плане немыслимо найти два разных входных набора данных, результаты хэширования которых полностью совпадают.</span><span class="sxs-lookup"><span data-stu-id="b67f1-242">However, it is computationally infeasible to find two distinct inputs that hash to the same value.</span></span>

<span data-ttu-id="b67f1-243">Две стороны (Анна и Виктор) могут использовать хэш-функцию для проверки целостности сообщений.</span><span class="sxs-lookup"><span data-stu-id="b67f1-243">Two parties (Alice and Bob) could use a hash function to ensure message integrity.</span></span> <span data-ttu-id="b67f1-244">Им нужно выбрать хэш-алгоритм для подписывания сообщений.</span><span class="sxs-lookup"><span data-stu-id="b67f1-244">They would select a hash algorithm to sign their messages.</span></span> <span data-ttu-id="b67f1-245">Анна будет писать сообщение, а затем создавать его хэш с помощью выбранного алгоритма.</span><span class="sxs-lookup"><span data-stu-id="b67f1-245">Alice would write a message, and then create a hash of that message by using the selected algorithm.</span></span> <span data-ttu-id="b67f1-246">Затем стороны могут применять один из указанных ниже вариантов дальнейших действий.</span><span class="sxs-lookup"><span data-stu-id="b67f1-246">They would then follow one of the following methods:</span></span>

- <span data-ttu-id="b67f1-247">Анна отправляет Виктору сообщение с открытым текстом и хэш сообщения (цифровую подпись).</span><span class="sxs-lookup"><span data-stu-id="b67f1-247">Alice sends the plaintext message and the hashed message (digital signature) to Bob.</span></span> <span data-ttu-id="b67f1-248">Виктор получает сообщение, применяет к нему хэш-алгоритм и сравнивает свое значение хэша со значением, полученным от Анны.</span><span class="sxs-lookup"><span data-stu-id="b67f1-248">Bob receives and hashes the message and compares his hash value to the hash value that he received from Alice.</span></span> <span data-ttu-id="b67f1-249">Если хэш-значения совпадают, значит, данные не изменялись.</span><span class="sxs-lookup"><span data-stu-id="b67f1-249">If the hash values are identical, the message was not altered.</span></span> <span data-ttu-id="b67f1-250">Если хэш-значения не совпадают, значит, данные изменялись после создания.</span><span class="sxs-lookup"><span data-stu-id="b67f1-250">If the values are not identical, the message was altered after Alice wrote it.</span></span>

  <span data-ttu-id="b67f1-251">К сожалению, этот способ не позволяет установить подлинность отправителя.</span><span class="sxs-lookup"><span data-stu-id="b67f1-251">Unfortunately, this method does not establish the authenticity of the sender.</span></span> <span data-ttu-id="b67f1-252">Любой человек может выдавать себя за Анну и отправлять сообщения Виктору.</span><span class="sxs-lookup"><span data-stu-id="b67f1-252">Anyone can impersonate Alice and send a message to Bob.</span></span> <span data-ttu-id="b67f1-253">Для этого достаточно подписывать сообщения с помощью такого же хэш-алгоритма, и Виктор сможет лишь проверить, соответствует ли сообщение подписи.</span><span class="sxs-lookup"><span data-stu-id="b67f1-253">They can use the same hash algorithm to sign their message, and all Bob can determine is that the message matches its signature.</span></span> <span data-ttu-id="b67f1-254">Это одна из форм атаки «злоумышленник в середине».</span><span class="sxs-lookup"><span data-stu-id="b67f1-254">This is one form of a man-in-the-middle attack.</span></span> <span data-ttu-id="b67f1-255">Дополнительные сведения см. в статье [Пример защищенного обмена данными для криптографии следующего поколения (CNG)](https://docs.microsoft.com/previous-versions/cc488018(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="b67f1-255">For more information, see [Cryptography Next Generation (CNG) Secure Communication Example](https://docs.microsoft.com/previous-versions/cc488018(v=vs.100)).</span></span>

- <span data-ttu-id="b67f1-256">Анна отправляет Виктору сообщение с открытым текстом по незащищенному открытому каналу.</span><span class="sxs-lookup"><span data-stu-id="b67f1-256">Alice sends the plaintext message to Bob over a nonsecure public channel.</span></span> <span data-ttu-id="b67f1-257">По защищенному закрытому каналу она оправляет Виктору хэш сообщения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-257">She sends the hashed message to Bob over a secure private channel.</span></span> <span data-ttu-id="b67f1-258">Виктор получает сообщение с открытым текстом, хэширует его и сравнивает хэш со значением, полученным по закрытому каналу.</span><span class="sxs-lookup"><span data-stu-id="b67f1-258">Bob receives the plaintext message, hashes it, and compares the hash to the privately exchanged hash.</span></span> <span data-ttu-id="b67f1-259">Если хэши совпадают, Виктор может сделать два вывода:</span><span class="sxs-lookup"><span data-stu-id="b67f1-259">If the hashes match, Bob knows two things:</span></span>

  - <span data-ttu-id="b67f1-260">сообщение не было изменено;</span><span class="sxs-lookup"><span data-stu-id="b67f1-260">The message was not altered.</span></span>

  - <span data-ttu-id="b67f1-261">отправитель сообщения подлинный (Анна).</span><span class="sxs-lookup"><span data-stu-id="b67f1-261">The sender of the message (Alice) is authentic.</span></span>

  <span data-ttu-id="b67f1-262">Для того чтобы такая система работала, Анна должна скрывать оригинальное хэш-значение от всех, кроме Виктора.</span><span class="sxs-lookup"><span data-stu-id="b67f1-262">For this system to work, Alice must hide her original hash value from all parties except Bob.</span></span>

- <span data-ttu-id="b67f1-263">Анна по незащищенному открытому каналу отправляет Виктору сообщение в виде открытого текста, а хэш сообщения помещает на свой общедоступный веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="b67f1-263">Alice sends the plaintext message to Bob over a nonsecure public channel and places the hashed message on her publicly viewable Web site.</span></span>

  <span data-ttu-id="b67f1-264">Такой подход позволяет защититься от изменения хэша третьей стороной.</span><span class="sxs-lookup"><span data-stu-id="b67f1-264">This method prevents message tampering by preventing anyone from modifying the hash value.</span></span> <span data-ttu-id="b67f1-265">Хотя сообщение и его хэш могут видеть все, изменить хэш может только Анна.</span><span class="sxs-lookup"><span data-stu-id="b67f1-265">Although the message and its hash can be read by anyone, the hash value can be changed only by Alice.</span></span> <span data-ttu-id="b67f1-266">Злоумышленнику, который хочет выдать себя за Анну, потребуется доступ к её веб-сайту.</span><span class="sxs-lookup"><span data-stu-id="b67f1-266">An attacker who wants to impersonate Alice would require access to Alice's Web site.</span></span>

<span data-ttu-id="b67f1-267">Ни один из описанных выше способов не защищает Анну от чтения ее сообщений третьими лицами, так как сообщения передаются в виде открытого текста.</span><span class="sxs-lookup"><span data-stu-id="b67f1-267">None of the previous methods will prevent someone from reading Alice's messages, because they are transmitted in plaintext.</span></span> <span data-ttu-id="b67f1-268">Для обеспечения полной защиты обычно требуется использовать цифровые подписи и шифрование.</span><span class="sxs-lookup"><span data-stu-id="b67f1-268">Full security typically requires digital signatures (message signing) and encryption.</span></span>

<span data-ttu-id="b67f1-269">.NET предоставляет следующие классы, реализующие алгоритмы хэширования:</span><span class="sxs-lookup"><span data-stu-id="b67f1-269">.NET provides the following classes that implement hashing algorithms:</span></span>

- <span data-ttu-id="b67f1-270"><xref:System.Security.Cryptography.SHA256>.</span><span class="sxs-lookup"><span data-stu-id="b67f1-270"><xref:System.Security.Cryptography.SHA256>.</span></span>

- <span data-ttu-id="b67f1-271"><xref:System.Security.Cryptography.SHA384>.</span><span class="sxs-lookup"><span data-stu-id="b67f1-271"><xref:System.Security.Cryptography.SHA384>.</span></span>

- <span data-ttu-id="b67f1-272"><xref:System.Security.Cryptography.SHA512>.</span><span class="sxs-lookup"><span data-stu-id="b67f1-272"><xref:System.Security.Cryptography.SHA512>.</span></span>

<span data-ttu-id="b67f1-273">.NET также предоставляет <xref:System.Security.Cryptography.MD5> и <xref:System.Security.Cryptography.SHA1> .</span><span class="sxs-lookup"><span data-stu-id="b67f1-273">.NET also provides <xref:System.Security.Cryptography.MD5> and <xref:System.Security.Cryptography.SHA1>.</span></span> <span data-ttu-id="b67f1-274">Но алгоритмы MD5 и SHA-1 были бы небезопасными, и вместо этого рекомендуется использовать SHA-2.</span><span class="sxs-lookup"><span data-stu-id="b67f1-274">But the MD5 and SHA-1 algorithms have been found to be insecure, and SHA-2 is now recommended instead.</span></span> <span data-ttu-id="b67f1-275">SHA-2 включает SHA256, SHA384 и SHA512.</span><span class="sxs-lookup"><span data-stu-id="b67f1-275">SHA-2 includes SHA256, SHA384, and SHA512.</span></span>

## <a name="random-number-generation"></a><span data-ttu-id="b67f1-276">генерация случайных чисел</span><span class="sxs-lookup"><span data-stu-id="b67f1-276">Random Number Generation</span></span>

<span data-ttu-id="b67f1-277">Генерация случайных чисел является неотъемлемой частью многих криптографических операций.</span><span class="sxs-lookup"><span data-stu-id="b67f1-277">Random number generation is integral to many cryptographic operations.</span></span> <span data-ttu-id="b67f1-278">Например, криптографические ключи должны выбираться настолько случайно, насколько это возможно, чтобы было фактически невозможно воспроизвести их значения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-278">For example, cryptographic keys need to be as random as possible so that it is infeasible to reproduce them.</span></span> <span data-ttu-id="b67f1-279">Криптографические генераторы случайных чисел должны генерировать результат, который нельзя предсказать вычислительными методами с вероятностью хотя бы 50 %.</span><span class="sxs-lookup"><span data-stu-id="b67f1-279">Cryptographic random number generators must generate output that is computationally infeasible to predict with a probability that is better than one half.</span></span> <span data-ttu-id="b67f1-280">Поэтому все методы предсказания очередного случайного бита не должны быть точнее, чем простое угадывание.</span><span class="sxs-lookup"><span data-stu-id="b67f1-280">Therefore, any method of predicting the next output bit must not perform better than random guessing.</span></span> <span data-ttu-id="b67f1-281">Классы в .NET Framework используют генераторы случайных чисел для создания криптографических ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-281">The classes in the .NET Framework use random number generators to generate cryptographic keys.</span></span>

<span data-ttu-id="b67f1-282">Класс <xref:System.Security.Cryptography.RandomNumberGenerator> является реализацией алгоритма генерации случайных чисел.</span><span class="sxs-lookup"><span data-stu-id="b67f1-282">The <xref:System.Security.Cryptography.RandomNumberGenerator> class is an implementation of a random number generator algorithm.</span></span>

## <a name="clickonce-manifests"></a><span data-ttu-id="b67f1-283">Манифесты ClickOnce</span><span class="sxs-lookup"><span data-stu-id="b67f1-283">ClickOnce Manifests</span></span>

<span data-ttu-id="b67f1-284">В .NET Framework 3,5 следующие классы шифрования позволяют получить и проверить сведения о сигнатурах манифеста для приложений, развернутых с помощью [технологии ClickOnce](/visualstudio/deployment/clickonce-security-and-deployment):</span><span class="sxs-lookup"><span data-stu-id="b67f1-284">In the .NET Framework 3.5, the following cryptography classes let you obtain and verify information about manifest signatures for applications that are deployed using [ClickOnce technology](/visualstudio/deployment/clickonce-security-and-deployment):</span></span>

- <span data-ttu-id="b67f1-285">Класс <xref:System.Security.Cryptography.ManifestSignatureInformation> получает сведения о подписи манифеста при использовании перегрузок его метода <xref:System.Security.Cryptography.ManifestSignatureInformation.VerifySignature%2A> .</span><span class="sxs-lookup"><span data-stu-id="b67f1-285">The <xref:System.Security.Cryptography.ManifestSignatureInformation> class obtains information about a manifest signature when you use its <xref:System.Security.Cryptography.ManifestSignatureInformation.VerifySignature%2A> method overloads.</span></span>

- <span data-ttu-id="b67f1-286">С помощью перечисления <xref:System.Security.ManifestKinds> можно указать манифесты, которые нужно проверить.</span><span class="sxs-lookup"><span data-stu-id="b67f1-286">You can use the <xref:System.Security.ManifestKinds> enumeration to specify which manifests to verify.</span></span> <span data-ttu-id="b67f1-287">Результатом проверки является одно из значений перечисления <xref:System.Security.Cryptography.SignatureVerificationResult> .</span><span class="sxs-lookup"><span data-stu-id="b67f1-287">The result of the verification is one of the <xref:System.Security.Cryptography.SignatureVerificationResult> enumeration values.</span></span>

- <span data-ttu-id="b67f1-288">Класс <xref:System.Security.Cryptography.ManifestSignatureInformationCollection> предоставляет коллекцию объектов проверенных подписей <xref:System.Security.Cryptography.ManifestSignatureInformation> только для чтения.</span><span class="sxs-lookup"><span data-stu-id="b67f1-288">The <xref:System.Security.Cryptography.ManifestSignatureInformationCollection> class provides a read-only collection of <xref:System.Security.Cryptography.ManifestSignatureInformation> objects of the verified signatures.</span></span>

 <span data-ttu-id="b67f1-289">Кроме того, перечисленные ниже классы предоставляют сведения о конкретных подписях.</span><span class="sxs-lookup"><span data-stu-id="b67f1-289">In addition, the following classes provide specific signature information:</span></span>

- <span data-ttu-id="b67f1-290"><xref:System.Security.Cryptography.StrongNameSignatureInformation> содержит сведения о строгом имени подписи для манифеста.</span><span class="sxs-lookup"><span data-stu-id="b67f1-290"><xref:System.Security.Cryptography.StrongNameSignatureInformation> holds the strong name signature information for a manifest.</span></span>

- <span data-ttu-id="b67f1-291"><xref:System.Security.Cryptography.X509Certificates.AuthenticodeSignatureInformation> представляет сведения о подписи Authenticode для манифеста.</span><span class="sxs-lookup"><span data-stu-id="b67f1-291"><xref:System.Security.Cryptography.X509Certificates.AuthenticodeSignatureInformation> represents the Authenticode signature information for a manifest.</span></span>

- <span data-ttu-id="b67f1-292"><xref:System.Security.Cryptography.X509Certificates.TimestampInformation> содержит сведения о метке времени в подписи Authenticode.</span><span class="sxs-lookup"><span data-stu-id="b67f1-292"><xref:System.Security.Cryptography.X509Certificates.TimestampInformation> contains information about the time stamp on an Authenticode signature.</span></span>

- <span data-ttu-id="b67f1-293"><xref:System.Security.Cryptography.X509Certificates.TrustStatus> предоставляет простой способ проверить, является ли подпись Authenticode достоверной.</span><span class="sxs-lookup"><span data-stu-id="b67f1-293"><xref:System.Security.Cryptography.X509Certificates.TrustStatus> provides a simple way to check whether an Authenticode signature is trusted.</span></span>

## <a name="cryptography-next-generation-cng-classes"></a><span data-ttu-id="b67f1-294">Классы криптографии следующего поколения (CNG)</span><span class="sxs-lookup"><span data-stu-id="b67f1-294">Cryptography Next Generation (CNG) Classes</span></span>

<span data-ttu-id="b67f1-295">В .NET Framework 3,5 и более поздних версиях классы шифрования следующего поколения (CNG) предоставляют управляемую оболочку вокруг собственных функций CNG.</span><span class="sxs-lookup"><span data-stu-id="b67f1-295">In the .NET Framework 3.5 and later versions, the Cryptography Next Generation (CNG) classes provide a managed wrapper around the native CNG functions.</span></span> <span data-ttu-id="b67f1-296">(CNG является заменой CryptoAPI.) Эти классы имеют "CNG" как часть своих имен.</span><span class="sxs-lookup"><span data-stu-id="b67f1-296">(CNG is the replacement for CryptoAPI.) These classes have "Cng" as part of their names.</span></span> <span data-ttu-id="b67f1-297">Центральным в группе классов оболочек CNG является класс контейнера ключей <xref:System.Security.Cryptography.CngKey> , который абстрагирует хранение и использование ключей CNG.</span><span class="sxs-lookup"><span data-stu-id="b67f1-297">Central to the CNG wrapper classes is the <xref:System.Security.Cryptography.CngKey> key container class, which abstracts the storage and use of CNG keys.</span></span> <span data-ttu-id="b67f1-298">Этот класс позволяет безопасно хранить пару ключей или открытый ключ и ссылаться на него, используя простое строковое имя.</span><span class="sxs-lookup"><span data-stu-id="b67f1-298">This class lets you store a key pair or a public key securely and refer to it by using a simple string name.</span></span> <span data-ttu-id="b67f1-299">Класс цифровых подписей <xref:System.Security.Cryptography.ECDsaCng> и класс шифрования <xref:System.Security.Cryptography.ECDiffieHellmanCng> на основе эллиптических кривых используют объекты <xref:System.Security.Cryptography.CngKey> .</span><span class="sxs-lookup"><span data-stu-id="b67f1-299">The elliptic curve-based <xref:System.Security.Cryptography.ECDsaCng> signature class and the <xref:System.Security.Cryptography.ECDiffieHellmanCng> encryption class can use <xref:System.Security.Cryptography.CngKey> objects.</span></span>

<span data-ttu-id="b67f1-300">Класс <xref:System.Security.Cryptography.CngKey> используется для множества дополнительных операций, включая открытие, создание, удаление и экспорт ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-300">The <xref:System.Security.Cryptography.CngKey> class is used for a variety of additional operations, including opening, creating, deleting, and exporting keys.</span></span> <span data-ttu-id="b67f1-301">Он также предоставляет доступ к базовому дескриптору ключа, используемому при непосредственном вызове собственных функций.</span><span class="sxs-lookup"><span data-stu-id="b67f1-301">It also provides access to the underlying key handle to use when calling native functions directly.</span></span>

<span data-ttu-id="b67f1-302">.NET Framework 3,5 также включает множество вспомогательных классов CNG, таких как следующие:</span><span class="sxs-lookup"><span data-stu-id="b67f1-302">The .NET Framework 3.5 also includes a variety of supporting CNG classes, such as the following:</span></span>

- <span data-ttu-id="b67f1-303"><xref:System.Security.Cryptography.CngProvider> поддерживает поставщика хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-303"><xref:System.Security.Cryptography.CngProvider> maintains a key storage provider.</span></span>

- <span data-ttu-id="b67f1-304"><xref:System.Security.Cryptography.CngAlgorithm> поддерживает алгоритм CNG.</span><span class="sxs-lookup"><span data-stu-id="b67f1-304"><xref:System.Security.Cryptography.CngAlgorithm> maintains a CNG algorithm.</span></span>

- <span data-ttu-id="b67f1-305"><xref:System.Security.Cryptography.CngProperty> поддерживает часто используемые свойства ключей.</span><span class="sxs-lookup"><span data-stu-id="b67f1-305"><xref:System.Security.Cryptography.CngProperty> maintains frequently used key properties.</span></span>

## <a name="see-also"></a><span data-ttu-id="b67f1-306">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="b67f1-306">See also</span></span>

- <span data-ttu-id="b67f1-307">[Криптографическая модель](cryptography-model.md) — описывает, как криптография реализуется в библиотеке базовых классов.</span><span class="sxs-lookup"><span data-stu-id="b67f1-307">[Cryptography Model](cryptography-model.md) - Describes how cryptography is implemented in the base class library.</span></span>
- [<span data-ttu-id="b67f1-308">Кросс-платформенная криптография</span><span class="sxs-lookup"><span data-stu-id="b67f1-308">Cross-Platform Cryptography</span></span>](cross-platform-cryptography.md)
- [<span data-ttu-id="b67f1-309">Уязвимости в учете времени при симметричной расшифровке в режиме CBC с использованием заполнения</span><span class="sxs-lookup"><span data-stu-id="b67f1-309">Timing vulnerabilities with CBC-mode symmetric decryption using padding</span></span>](vulnerabilities-cbc-mode.md)
- [<span data-ttu-id="b67f1-310">ASP.NET Core Защита данных</span><span class="sxs-lookup"><span data-stu-id="b67f1-310">ASP.NET Core Data Protection</span></span>](/aspnet/core/security/data-protection/introduction)
