---
title: Безопасные рекомендации по кодированию для .NET
description: Дизайн кода для работы с . Разрешения, применяемые NET, и другие меры по обеспечению соблюдения, чтобы предотвратить доступ вредоносного кода к данным или выполнение других действий.
ms.date: 06/28/2018
helpviewer_keywords:
- managed wrapper to native code implementation
- secure coding
- reusable components
- library code that exposes protected resources
- code, security
- code security
- secure coding, options
- components [.NET], security
- code security, options
- security-neutral code
- security [.NET], coding guidelines
ms.assetid: 4f882d94-262b-4494-b0a6-ba9ba1f5f177
ms.openlocfilehash: 05f7e039ecdc0cd33baa015872924fb9e1f078aa
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187728"
---
# <a name="secure-coding-guidelines"></a>Безопасные рекомендации по кодированию

Защита на основе фактических данных и управление доступом для кода предоставляют очень мощные, четкие механизмы для обеспечения безопасности. Большинство кода приложений может просто использовать инфраструктуру, реализованную .NET. В некоторых случаях требуется дополнительная защита на уровне приложения, построенная либо путем расширения системы, либо с помощью новых специальных методов.

Используя в коде принудительные разрешения и другие меры принуждения.NET, следует возводить барьеры, чтобы предотвратить доступ к информации, которую вы не хотите, чтобы он получил или выполнял другие нежелательные действия. Кроме того, необходимо соблюсти баланс между безопасностью и удобством использования во всех планируемых сценариях с использованием доверенного кода.

В этом обзоре описываются различные способы разработки кода, взаимодействующего с системой безопасности.

## <a name="securing-resource-access"></a>Обеспечение доступа к ресурсам

При разработке и написания кода необходимо защитить и ограничить доступ данного кода к ресурсам, особенно при использовании или вызове кода неизвестного происхождения. Убедиться, что ваш код является безопасным, можно с помощью следующих методов.

- Не используйте управление доступом для кода (CAS).

- Не используйте частично доверенный код.

- Не используйте атрибут [AllowPartiallyTrustedCaller](xref:System.Security.AllowPartiallyTrustedCallersAttribute) (APTCA).

- Не используйте удаленное взаимодействие .NET.

- Не используйте модель DCOM.

- Не используйте двоичные модули форматирования.

Код безопасности доступа и безопасности прозрачный код не поддерживается в качестве границы безопасности с частично доверенным кодом. Мы не рекомендуем загружать и выполнять код из неизвестных источников, не предприняв дополнительные меры безопасности. Ниже приведены дополнительные меры безопасности.

- Виртуализация

- Контейнеры AppContainer

- Пользователи операционной системы (ОС) и разрешения

- Контейнеры Hyper-V

## <a name="security-neutral-code"></a>Нейтральный код безопасности

Нейтральный код не взаимодействует явным образом с системой безопасности. Он работает с любыми полученными разрешениями. Хотя приложения, не успевающие за исключением безопасности, связанные с защищенными операциями (например, использование файлов, сетей и т.д.), могут привести к необработанному исключению, нейтральный код безопасности по-прежнему использует преимущества технологий безопасности в .NET .

Библиотека нейтрального кода имеет особенности, которые следует понимать. Предположим, что в вашей библиотеке предоставляются элементы API, которые используют файлы или вызывают неуправляемый код. Если ваш код не имеет соответствующего разрешения, он не будет работать, как описано. Однако даже если код имеет разрешения, вызывающий его код приложения должен иметь те же разрешения, чтобы он мог работать. Если код вызова не имеет нужного <xref:System.Security.SecurityException> разрешения, появляется в результате ходьбы стека безопасности доступа к коду.

## <a name="application-code-that-isnt-a-reusable-component"></a>Код приложения, который не является многоразовым компонентом

Если ваш код является частью приложения, которое не будет вызываться другим кодом, безопасность проста и специальное кодирование может не потребоваться. Однако помните, что вредоносный код может вызвать ваш код. Хотя управление доступом для кода может предотвратить доступ вредоносного кода к ресурсам, такой код все еще может считывать значения полей или свойств, которые могут содержать конфиденциальные сведения.

Кроме того, если код принимает ввод пользователя из Интернета или других ненадежных источников, будьте осторожны, чтобы не были введены вредоносные данные.

## <a name="managed-wrapper-to-native-code-implementation"></a>Управляемая обертка к реализации родного кода

Обычно в этом сценарии некоторые полезные функции реализуются в машинном коде, который требуется сделать доступным для управляемого кода. Управляемые оболочки легко создаются с помощью вызова неуправляемого кода или COM-взаимодействия. Однако если это сделать, для успешного выполнения вызывающим ваши оболочки объектам необходимо предоставить права на неуправляемый код. В соответствии с политикой по умолчанию это означает, что код, загруженный из интрасети или Интернета, не будет работать с обертками.

Вместо того, чтобы давать неуправляемые права кода всем приложениям, которые используют эти обертки, лучше отдать эти права только коду обертки. Если эта базовая функциональность не предоставляет никакие ресурсы и реализация также безопасна, оболочке достаточно просто объявить свои права, что позволяет любому коду вызывать ее. При использовании ресурсов написание безопасного кода должно быть таким же, как в случае кода библиотеки, описанного в следующем разделе. Поскольку оболочка потенциально предоставляет вызывающим объектам доступ к этим ресурсам, необходима тщательная проверка безопасности машинного кода, за которую отвечает оболочка.

## <a name="library-code-that-exposes-protected-resources"></a>Библиотечный код, который предоставляет защищенные ресурсы

Следующий подход является наиболее мощным и, следовательно, потенциально опасным (если сделано неправильно) для кодирования безопасности: ваша библиотека служит интерфейсом для другого кода для доступа к определенным ресурсам, которые в противном случае не доступны, так же, как классы .NET обеспечивают соблюдение разрешения на ресурсы, которые они используют. При предоставлении доступа к ресурсу код должен сначала запросить соответствующее разрешение на ресурс (т. е. он должен выполнить проверку безопасности), а затем объявить свои права на выполнение текущей операции.

## <a name="related-topics"></a>Связанные разделы

|Title|Описание|
|-----------|-----------------|
|[Обеспечение безопасности данных](securing-state-data.md)|Описание порядка защиты закрытых членов.|
|[Безопасность и ввод данных пользователем](security-and-user-input.md)|Вопросы безопасности для приложений, которые принимают пользовательский ввод.|
|[Безопасность и конфликты](security-and-race-conditions.md)|Описывается, как избежать состояний соперничества в коде.|
|[Безопасность и создание кода "на лету"](security-and-on-the-fly-code-generation.md)|Вопросы безопасности для приложений, создающих динамический код.|
|[Безопасность на основе ролей](role-based-security.md)|Подробно описывает безопасность на основе ролей .NET и предоставляет инструкции по ее использованию в коде.|
