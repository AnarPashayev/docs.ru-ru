---
title: Файловый и потоковый ввод-вывод — .NET
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- IO namespace
- files, I/O
- System.IO namespace
- I/O [.NET Framework]
- streams, I/O
- data streams, I/O
ms.assetid: 4f4a33a9-66b7-4cd7-a285-4ad3e4276cd2
ms.openlocfilehash: 3c69e0fd23b1f8bc11fe908c66ba492f31a53f30
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "75706599"
---
# <a name="file-and-stream-io"></a>Файловый и потоковый ввод-вывод

Файловый и потоковый ввод-вывод относятся к передаче данных с носителя информации или на него. В .NET Framework пространства имен `System.IO` содержат типы, которые обеспечивают как синхронные, так и асинхронные операции чтения и записи для потоков и файлов. Кроме того, эти пространства имен содержат типы, выполняющие сжатие и распаковку файлов, а также типы, которые обеспечивают взаимодействие через каналы и последовательные порты.

Файл — это упорядоченная и именованная последовательность байтов, имеющая постоянное хранилище. При работе с файлами используются пути к каталогам, запоминающие устройства, а также имена файлов и каталогов. В отличие от файла, поток — это последовательность байтов, которую можно использовать для записи или чтения из вспомогательного запоминающего устройства, являющегося одним из устройств хранения информации (например, дисков или памяти). Есть несколько видов запоминающих устройств, отличных от дисков, и существует несколько видов потоков, помимо файловых потоков, например сетевые потоки, потоки памяти и потоки каналов.

## <a name="files-and-directories"></a>Файлы и каталоги

Типы в пространстве имен <xref:System.IO?displayProperty=nameWithType> можно использовать для взаимодействия с файлами и каталогами. Например, можно получать и задавать свойства файлов и каталогов, а также извлекать коллекции файлов и каталогов на основе критерия поиска.

Соглашения об именовании и способы указать путь к файлу в системах Windows, включая синтаксис устройств DOS, поддерживаемый в .NET Core 1.1 и более поздних версиях и платформе .NET Framework 4.6.2 и более поздних версиях, см. в разделе [Форматы путей файлов в системах Windows](file-path-formats.md).

Ниже перечислены некоторые часто используемые классы для файлов и каталогов:

- <xref:System.IO.File> предоставляет статические методы для создания, копирования, удаления, перемещения и открытия файлов, а также помогает создать объект <xref:System.IO.FileStream>.

- <xref:System.IO.FileInfo> предоставляет методы экземпляра для создания, копирования, удаления, перемещения и открытия файлов, а также помогает создать объект <xref:System.IO.FileStream>.

- <xref:System.IO.Directory> предоставляет статические методы для создания, перемещения и перечисления в каталогах и подкаталогах.

- <xref:System.IO.DirectoryInfo> предоставляет методы экземпляра для создания, перемещения и перечисления в каталогах и подкаталогах.

- <xref:System.IO.Path> предоставляет методы и свойства для обработки строк каталогов межплатформенным способом.

При вызове методов для работы с файловой системой следует всегда использовать надежные механизмы обработки исключений. Дополнительные сведения см. в [разделе об обработке ошибок ввода-вывода](handling-io-errors.md).

Помимо использования этих классов, пользователи Visual Basic могут использовать методы и свойства, предоставляемые классом <xref:Microsoft.VisualBasic.FileIO.FileSystem?displayProperty=nameWithType> для файлового ввода-вывода.

См. практическое руководство по [ Копирование каталогов](how-to-copy-directories.md), [Практическое руководство. Создание списка каталогов](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5cf8zcfh(v=vs.100)) и [Практическое руководство. перечислить каталоги и файлы](how-to-enumerate-directories-and-files.md).

## <a name="streams"></a>Потоки

Абстрактный базовый класс <xref:System.IO.Stream> поддерживает чтение и запись байтов. Все классы, представляющие потоки, являются производными от класса <xref:System.IO.Stream>. Класс <xref:System.IO.Stream> и его производные классы обеспечивают общий способ просмотра источников данных и хранилищ объектов, а также изолируют программиста от специфических особенностей операционной системы и базовых устройств.

Потоки включают три основные операции:

- Чтение — перенос информации из потока в структуру данных, такую как массив байтов.

- Запись — перенос данных в поток из источника данных.

- Поиск — определение и изменение текущей позиции внутри потока.

В зависимости от базового источника или хранилища данных поток может поддерживать лишь некоторые из этих возможностей. Например, класс <xref:System.IO.Pipes.PipeStream> не поддерживает поиск. Свойства <xref:System.IO.Stream.CanRead%2A>, <xref:System.IO.Stream.CanWrite%2A> и <xref:System.IO.Stream.CanSeek%2A> потока определяют операции, поддерживаемые потоком.

Ниже перечислены некоторые часто используемые классы потока:

- <xref:System.IO.FileStream> — для чтения и записи в файл.

- <xref:System.IO.IsolatedStorage.IsolatedStorageFileStream> — для чтения и записи в файл в изолированном хранилище.

- <xref:System.IO.MemoryStream> — для чтения и записи в память в качестве резервного хранилища.

- <xref:System.IO.BufferedStream> — для повышения быстродействия операций чтения и записи.

- <xref:System.Net.Sockets.NetworkStream> — для чтения и записи на сетевые сокеты.

- <xref:System.IO.Pipes.PipeStream> — для чтения и записи в анонимные и именованные каналы.

- <xref:System.Security.Cryptography.CryptoStream> — для связи потоков данных с криптографическими преобразованиями.

Пример асинхронной работы с потоками см. в разделе [Асинхронный файловый ввод-вывод](asynchronous-file-i-o.md).

## <a name="readers-and-writers"></a>Средства чтения и записи

Пространство имен <xref:System.IO?displayProperty=nameWithType> также предоставляет типы для чтения закодированных символов из потоков и их записи в потоки. Как правило, потоки предназначены для ввода и вывода байтов. Типы чтения и записи обрабатывают преобразование закодированных символов в байты или из байтов, чтобы поток мог завершить операцию. Каждый класс чтения и записи связан с потоком, который можно получить с помощью свойства класса `BaseStream`.

Ниже перечислены некоторые часто используемые классы для чтения и записи:

- <xref:System.IO.BinaryReader> и <xref:System.IO.BinaryWriter> — для чтения и записи простых типов данных, таких как двоичные значения.

- <xref:System.IO.StreamReader> и <xref:System.IO.StreamWriter> — для чтения и записи символов с использованием закодированного значения для преобразования символов в байты или из байтов.

- <xref:System.IO.StringReader> и <xref:System.IO.StringWriter> — для чтения и записи символов в строки или из строк.

- <xref:System.IO.TextReader> и <xref:System.IO.TextWriter> используются в качестве абстрактных базовых классов для других средств чтения и записи, которые считывают и записывают символы и строки, а не двоичные данные.

См. практическое руководство по [ Считывание текста из файла](how-to-read-text-from-a-file.md), [Практическое руководство. Запись текста в файл](how-to-write-text-to-a-file.md), [Практическое руководство. Считывание символов из строки](how-to-read-characters-from-a-string.md) и [Практическое руководство. Запись символов в строку](how-to-write-characters-to-a-string.md).

## <a name="asynchronous-io-operations"></a>Асинхронные операции ввода-вывода

Чтение и запись больших объемов данных может быть ресурсоемкой. Эти задачи необходимо выполнять асинхронно, если приложение должно продолжать отвечать на запросы пользователя. В случае синхронных операций ввода-вывода поток пользовательского интерфейса будет заблокирован до тех пор, пока ресурсоемкая операция не завершится.  При разработке приложений Microsoft Store для Windows 8.x используйте асинхронные операции ввода-вывода, чтобы не создавалось впечатления, что приложение прекратило свою работу.

Имена асинхронных элементов содержат `Async`, например: <xref:System.IO.Stream.CopyToAsync%2A>, <xref:System.IO.Stream.FlushAsync%2A>, <xref:System.IO.Stream.ReadAsync%2A> и <xref:System.IO.Stream.WriteAsync%2A>. Используйте эти методы с ключевыми словами `async` и `await`.

Дополнительные сведения см. в разделе [Асинхронный файловый ввод-вывод](asynchronous-file-i-o.md).

## <a name="compression"></a>Сжатие

Сжатием называется процесс сокращения размера сохраняемого файла. Распаковка — это процесс извлечения содержимого сжатого файла, что приводит его в формат, пригодный для использования. Пространство имен <xref:System.IO.Compression?displayProperty=nameWithType> содержит типы для сжатия и распаковки файлов и потоков.

При сжатии и распаковке файлов и потоков часто используются следующие классы:

- <xref:System.IO.Compression.ZipArchive> — для создания и восстановления содержимого ZIP-архива.

- <xref:System.IO.Compression.ZipArchiveEntry> — для представления сжатого файла.

- <xref:System.IO.Compression.ZipFile> — для создания, извлечения и открытия сжатого пакета.

- <xref:System.IO.Compression.ZipFileExtensions> — для создания и извлечения содержимого из сжатого пакета.

- <xref:System.IO.Compression.DeflateStream> — для сжатия и распаковки потоков с помощью алгоритма Deflate.

- <xref:System.IO.Compression.GZipStream> — для сжатия и распаковки потоков в формате gzip.

См. практическое руководство по [ Сжатие и извлечение файлов](how-to-compress-and-extract-files.md).

## <a name="isolated-storage"></a>Изолированное хранилище

Изолированное хранилище — это механизм хранения данных, обеспечивающий изоляцию и безопасность путем определения стандартизованных способов сопоставления кода с хранимыми данными. Хранилище предоставляет виртуальную файловую систему, изолированную по пользователю, сборке и (необязательно) домену. Изолированное хранилище особенно полезно в том случае, когда приложение не имеет разрешения на доступ к файлам пользователя. Можно сохранить параметры или файлы для приложения таким способом, который контролируется политикой безопасности компьютера.

Изолированное хранилище недоступно для приложений Microsoft Store для Windows 8.x. Вместо этого используйте классы данных приложения в пространстве имен <xref:Windows.Storage?displayProperty=nameWithType>. Дополнительные сведения см. в разделе [Данные приложения](https://docs.microsoft.com/previous-versions/windows/apps/hh464917%28v=win.10%29).

Часто используются следующие классы, реализующие изолированное хранилище:

- <xref:System.IO.IsolatedStorage.IsolatedStorage> предоставляет базовый класс для реализации изолированного хранилища.

- <xref:System.IO.IsolatedStorage.IsolatedStorageFile> предоставляет область изолированного хранилища, в которой содержатся файлы и каталоги.

- <xref:System.IO.IsolatedStorage.IsolatedStorageFileStream> представляет файл в изолированном хранилище.

См. раздел [Изолированное хранилище](isolated-storage.md).

## <a name="io-operations-in-windows-store-apps"></a>Операции ввода-вывода в приложениях Microsoft Store

.NET для приложений Магазина Windows 8.x содержит множество типов для чтения и записи в потоки, однако этот набор содержит не все типы ввода-вывода платформы .NET Framework.

Следует отметить некоторые важные различия в использовании операций ввода-вывода в приложениях Microsoft Store для Windows 8.x:

- Специальные типы, относящиеся к операциям с файлами, такие как <xref:System.IO.File>, <xref:System.IO.FileInfo>, <xref:System.IO.Directory> и <xref:System.IO.DirectoryInfo>, не включены в .NET для приложений Магазина Windows 8.x. Вместо этого используйте типы в пространстве имен <xref:Windows.Storage?displayProperty=nameWithType> среды выполнения Windows, например <xref:Windows.Storage.StorageFile> и <xref:Windows.Storage.StorageFolder>.

- Изолированное хранилище недоступно; вместо этого используйте [данные приложения](https://docs.microsoft.com/previous-versions/windows/apps/hh464917(v=win.10)).

- Используйте асинхронные методы, такие как <xref:System.IO.Stream.ReadAsync%2A> и <xref:System.IO.Stream.WriteAsync%2A>, чтобы предотвратить блокировку потока пользовательского интерфейса.

- Типы сжатия на основе пути <xref:System.IO.Compression.ZipFile> и <xref:System.IO.Compression.ZipFileExtensions> недоступны. Вместо этого используйте типы в пространстве имен <xref:Windows.Storage.Compression?displayProperty=nameWithType>.

При необходимости можно осуществлять преобразование между потоками .NET Framework и потоками среды выполнения Windows. Дополнительные сведения см. в разделе [Практическое руководство. Преобразование между потоками .NET Framework и потоками среды выполнения Windows](how-to-convert-between-dotnet-streams-and-winrt-streams.md) или <xref:System.IO.WindowsRuntimeStreamExtensions>.

Дополнительные сведения об операциях ввода-вывода в приложении Microsoft Store для Windows 8.x: [Краткое руководство. Чтение и запись файлов](https://docs.microsoft.com/previous-versions/windows/apps/hh758325(v=win.10)).

## <a name="io-and-security"></a>Ввод-вывод и безопасность

При использовании классов в пространстве имен <xref:System.IO?displayProperty=nameWithType> необходимо выполнить требования безопасности операционной системы, такие как списки управления доступом для контроля доступа к файлам и каталогам. Это требование дополняет остальные требования <xref:System.Security.Permissions.FileIOPermission>. Списками управления доступом можно управлять программно. Дополнительные сведения см. в разделе [Практическое руководство. Добавление или удаление записей списка управления доступом](how-to-add-or-remove-access-control-list-entries.md).

По умолчанию политика безопасности не позволяет обращаться к файлам на компьютере пользователя через Интернет или из приложений интрасети. Поэтому при составлении кода не используйте классы ввода-вывода, которым нужен путь к физическому файлу, загружаемому через Интернет или интрасеть. Вместо этого используйте [изолированное хранилище](isolated-storage.md) для обычных приложений .NET Framework или [данные приложения](https://docs.microsoft.com/previous-versions/windows/apps/hh464917(v=win.10)) для приложений Microsoft Store для Windows 8.x.

Проверка безопасности выполняется только при создании потока. Поэтому не рекомендуется открывать поток, а затем передавать его коду с меньшим уровнем доверия или доменам приложений.

## <a name="related-topics"></a>См. также

- [Распространенные задачи ввода-вывода](common-i-o-tasks.md)\
Содержит список задач ввода-вывода, связанных с файлами, каталогами и потоками, а также ссылки на соответствующее содержимое и примеры для каждой задачи.

- [Асинхронный файловый ввод-вывод](asynchronous-file-i-o.md)\
Описывает преимущества и основные операции асинхронного ввода и вывода.

- [Изолированное хранилище](isolated-storage.md)\
Описывает механизм хранения данных, обеспечивающий автономность и безопасность путем определения стандартизованных способов сопоставления кода с защищенными данными.

- [Каналы](pipe-operations.md)\
Описывает операции с анонимными и именованными каналами в .NET Framework.

- [Сопоставленные в памяти файлы](memory-mapped-files.md)\
Описание отображаемых в память файлов, позволяющих разместить содержимое файлов с диска в виртуальной памяти. С их помощью можно вносить изменения в очень большие файлы и создавать совместно используемую память для межпроцессного взаимодействия.
