---
title: Рекомендации по размещению веб-приложений ASP.NET Core в Azure
description: Разработка современных веб-приложений с помощью ASP.NET Core и Azure | Рекомендации по размещению веб-приложений ASP.NET Core в Azure
author: ardalis
ms.author: wiwagn
ms.date: 01/30/2019
ms.openlocfilehash: 136ad9992ea94b027f095f47df0388408029f24e
ms.sourcegitcommit: 8699383914c24a0df033393f55db3369db728a7b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65638919"
---
# <a name="azure-hosting-recommendations-for-aspnet-core-web-apps"></a><span data-ttu-id="756e0-103">Рекомендации по размещению веб-приложений ASP.NET Core в Azure</span><span class="sxs-lookup"><span data-stu-id="756e0-103">Azure hosting recommendations for ASP.NET Core web apps</span></span>

> <span data-ttu-id="756e0-104">"Руководители бизнес-подразделений обходятся без участия ИТ-отдела, приобретая нужные приложения (SaaS) так легко и недорого, словно покупают их в магазине.</span><span class="sxs-lookup"><span data-stu-id="756e0-104">"Line-of-business leaders everywhere are bypassing IT departments to get applications from the cloud (aka SaaS) and paying for them like they would a magazine subscription.</span></span> <span data-ttu-id="756e0-105">После того как услуга больше не нужна, они могут просто отменить подписку, не оставляя после себя простаивающего без дела оборудования".</span><span class="sxs-lookup"><span data-stu-id="756e0-105">And when the service is no longer required, they can cancel the subscription with no equipment left unused in the corner."</span></span>  
> <span data-ttu-id="756e0-106">_\- Дэрил Пламмер (Daryl Plummer), аналитик Gartner_</span><span class="sxs-lookup"><span data-stu-id="756e0-106">_\- Daryl Plummer, Gartner analyst_</span></span>

<span data-ttu-id="756e0-107">Платформа Windows Azure позволяет реализовать любые требования для приложения с любой архитектурой.</span><span class="sxs-lookup"><span data-stu-id="756e0-107">Whatever your application's needs and architecture, Windows Azure can support it.</span></span> <span data-ttu-id="756e0-108">Вам может потребоваться разместить как самый простой статический веб-сайт, так и сложное приложение, состоящее из десятков услуг.</span><span class="sxs-lookup"><span data-stu-id="756e0-108">Your hosting needs can be as simple as a static website to a sophisticated application made up of dozens of services.</span></span> <span data-ttu-id="756e0-109">Для монолитных веб-приложений ASP.NET Core и вспомогательных услуг существует ряд хорошо известных рекомендуемых конфигураций.</span><span class="sxs-lookup"><span data-stu-id="756e0-109">For ASP.NET Core monolithic web applications and supporting services, there are several well-known configurations that are recommended.</span></span> <span data-ttu-id="756e0-110">Приведенные в этой статье рекомендации сгруппированы по виду размещаемых ресурсов (полное приложение, отдельные процессы или данные).</span><span class="sxs-lookup"><span data-stu-id="756e0-110">The recommendations on this article are grouped based on the kind of resource to be hosted, whether full applications, individual processes, or data.</span></span>

## <a name="web-applications"></a><span data-ttu-id="756e0-111">Веб-приложения</span><span class="sxs-lookup"><span data-stu-id="756e0-111">Web applications</span></span>

<span data-ttu-id="756e0-112">Вариант размещения веб-приложений:</span><span class="sxs-lookup"><span data-stu-id="756e0-112">Web applications can be hosted with:</span></span>

- <span data-ttu-id="756e0-113">Веб-приложения службы приложений</span><span class="sxs-lookup"><span data-stu-id="756e0-113">App Service Web Apps</span></span>

- <span data-ttu-id="756e0-114">Контейнеры</span><span class="sxs-lookup"><span data-stu-id="756e0-114">Containers</span></span>

- <span data-ttu-id="756e0-115">Виртуальные машины</span><span class="sxs-lookup"><span data-stu-id="756e0-115">Virtual Machines (VMs)</span></span>

<span data-ttu-id="756e0-116">В большинстве сценариев рекомендуется подход с веб-приложениями службы приложений.</span><span class="sxs-lookup"><span data-stu-id="756e0-116">Of these, App Service Web Apps is the recommended approach for most scenarios.</span></span> <span data-ttu-id="756e0-117">Для архитектуры микрослужб следует рассмотреть подход на основе контейнеров.</span><span class="sxs-lookup"><span data-stu-id="756e0-117">For microservice architectures, consider a container-based approach.</span></span> <span data-ttu-id="756e0-118">Если вам требуется больший контроль над машинами, на которых выполняется ваше приложение, рассмотрите возможность использования виртуальных машин Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-118">If you need more control over the machines running your application, consider Azure Virtual Machines.</span></span>

### <a name="app-service-web-apps"></a><span data-ttu-id="756e0-119">Веб-приложения службы приложений</span><span class="sxs-lookup"><span data-stu-id="756e0-119">App Service Web Apps</span></span>

<span data-ttu-id="756e0-120">Веб-приложения службы приложений предоставляют полностью управляемую платформу, оптимизированную для размещения веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="756e0-120">App Service Web Apps offers a fully managed platform optimized for hosting web applications.</span></span> <span data-ttu-id="756e0-121">Это предложение на основе модели "платформа как услуга" (PaaS) позволяет вам сосредоточиться на бизнес-логике, передав все задачи по организации инфраструктуры для выполнения и масштабирования приложения на сторону Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-121">It's a platform as a service (PaaS) offering that lets you focus on your business logic, while Azure takes care of the infrastructure needed to run and scale the app.</span></span> <span data-ttu-id="756e0-122">Некоторые основные возможности веб-приложений служб приложений:</span><span class="sxs-lookup"><span data-stu-id="756e0-122">Some key features of App Service Web Apps:</span></span>

- <span data-ttu-id="756e0-123">Оптимизация принципов DevOps (непрерывная интеграция и поставка, несколько окружений, A/B-тестирование, поддержка скриптов).</span><span class="sxs-lookup"><span data-stu-id="756e0-123">DevOps optimization (continuous integration and delivery, multiple environments, A/B testing, scripting support).</span></span>

- <span data-ttu-id="756e0-124">Глобальная масштабируемость и высокий уровень доступности.</span><span class="sxs-lookup"><span data-stu-id="756e0-124">Global scale and high availability.</span></span>

- <span data-ttu-id="756e0-125">Подключения к платформам SaaS и локальным данным.</span><span class="sxs-lookup"><span data-stu-id="756e0-125">Connections to SaaS platforms and your on-premises data.</span></span>

- <span data-ttu-id="756e0-126">Безопасность и соответствие требованиям.</span><span class="sxs-lookup"><span data-stu-id="756e0-126">Security and compliance.</span></span>

- <span data-ttu-id="756e0-127">Интеграция Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="756e0-127">Visual Studio integration.</span></span>

- <span data-ttu-id="756e0-128">Поддержка контейнеров Windows и Linux с помощью [веб-приложения для контейнеров](https://azure.microsoft.com/en-us/services/app-service/containers/).</span><span class="sxs-lookup"><span data-stu-id="756e0-128">Support for Linux and Windows containers via [Web App for Containers](https://azure.microsoft.com/en-us/services/app-service/containers/).</span></span>

<span data-ttu-id="756e0-129">Служба приложений Azure оптимально подходит для большинства веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="756e0-129">Azure App Service is the best choice for most web apps.</span></span> <span data-ttu-id="756e0-130">Функции развертывания и управления интегрированы в платформу, обеспечивается возможность быстрого масштабирования сайтов для обработки больших объемов трафика, а встроенные компоненты балансировки нагрузки и диспетчера трафика позволяют гарантировать высокий уровень доступности.</span><span class="sxs-lookup"><span data-stu-id="756e0-130">Deployment and management are integrated into the platform, sites can scale quickly to handle high traffic loads, and the built-in load balancing and traffic manager provide high availability.</span></span> <span data-ttu-id="756e0-131">Вы можете перенести существующий сайт в службу приложений Azure с помощью средства миграции в Интернете, использовать специальное приложение с открытым исходным кодом из коллекции веб-приложений, а также создать новый сайт с помощью удобных для вас средств и платформы.</span><span class="sxs-lookup"><span data-stu-id="756e0-131">You can move existing sites to Azure App Service easily with an online migration tool, use an open-source app from the Web Application Gallery, or create a new site using the framework and tools of your choice.</span></span> <span data-ttu-id="756e0-132">С помощью функции веб-заданий вы можете с легкостью реализовать фоновую обработку заданий в своем веб-приложении службы приложений.</span><span class="sxs-lookup"><span data-stu-id="756e0-132">The WebJobs feature makes it easy to add background job processing to your App Service web app.</span></span>

### <a name="azure-kubernetes-service"></a><span data-ttu-id="756e0-133">Служба контейнеров Azure</span><span class="sxs-lookup"><span data-stu-id="756e0-133">Azure Kubernetes Service</span></span>

<span data-ttu-id="756e0-134">Служба контейнеров Azure (AKS) управляет размещенной средой Kubernetes, позволяя быстро и легко развертывать и администрировать контейнерные приложения даже без опыта оркестрации контейнеров.</span><span class="sxs-lookup"><span data-stu-id="756e0-134">Azure Kubernetes Service (AKS) manages your hosted Kubernetes environment, making it quick and easy to deploy and manage containerized applications without container orchestration expertise.</span></span> <span data-ttu-id="756e0-135">Это позволяет устранить нагрузку, связанную с текущими операциями и обслуживанием, благодаря подготовке, обновлению и масштабированию ресурсов по требованию без перевода приложения в автономный режим.</span><span class="sxs-lookup"><span data-stu-id="756e0-135">It also eliminates the burden of ongoing operations and maintenance by provisioning, upgrading, and scaling resources on demand, without taking your applications offline.</span></span>

<span data-ttu-id="756e0-136">AKS снижает сложность и операционные затраты на управление кластером Kubernetes, перенося большую часть ответственности на Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-136">AKS reduces the complexity and operational overhead of managing a Kubernetes cluster by offloading much of that responsibility to Azure.</span></span> <span data-ttu-id="756e0-137">Как размещенная служба, Kubernetes Azure отвечает за критические задачи, такие как мониторинг работоспособности и техническое обслуживание.</span><span class="sxs-lookup"><span data-stu-id="756e0-137">As a hosted Kubernetes service, Azure handles critical tasks like health monitoring and maintenance for you.</span></span> <span data-ttu-id="756e0-138">Кроме того, вы платите только за узлы агентов в своих кластерах, а не за главные узлы.</span><span class="sxs-lookup"><span data-stu-id="756e0-138">Also, you pay only for the agent nodes within your clusters, not for the masters.</span></span> <span data-ttu-id="756e0-139">Как управляемая служба, Kubernetes AKS предоставляет:</span><span class="sxs-lookup"><span data-stu-id="756e0-139">As a managed Kubernetes service, AKS provides:</span></span>

- <span data-ttu-id="756e0-140">Автоматические обновления и исправления версий Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="756e0-140">Automated Kubernetes version upgrades and patching.</span></span>
- <span data-ttu-id="756e0-141">Простое масштабирование кластеров.</span><span class="sxs-lookup"><span data-stu-id="756e0-141">Easy cluster scaling.</span></span>
- <span data-ttu-id="756e0-142">Самовосстанавливающуюся размещенную область управления (главные узлы).</span><span class="sxs-lookup"><span data-stu-id="756e0-142">Self-healing hosted control plane (masters).</span></span>
- <span data-ttu-id="756e0-143">Сокращение затрат — вы платите только за выполняющиеся узлы пула агентов.</span><span class="sxs-lookup"><span data-stu-id="756e0-143">Cost savings - pay only for running agent pool nodes.</span></span>

<span data-ttu-id="756e0-144">Когда Azure управляет узлами в кластере AKS, вам больше не нужно выполнять вручную многие задачи, например обновление кластера.</span><span class="sxs-lookup"><span data-stu-id="756e0-144">With Azure handling the management of the nodes in your AKS cluster, you no longer need to perform many tasks manually, like cluster upgrades.</span></span> <span data-ttu-id="756e0-145">Так как Azure выполняет эти важные задачи обслуживания без вашего участия, AKS не предоставляет к кластеру прямой доступ (например, с помощью SSH).</span><span class="sxs-lookup"><span data-stu-id="756e0-145">Because Azure handles these critical maintenance tasks for you, AKS doesn't provide direct access (such as with SSH) to the cluster.</span></span>

### <a name="azure-virtual-machines"></a><span data-ttu-id="756e0-146">Виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="756e0-146">Azure Virtual Machines</span></span>

<span data-ttu-id="756e0-147">Если вам требуется внести серьезные изменения в существующее приложение для работы в службе приложений, вы можете упростить миграцию в облако с помощью виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="756e0-147">If you have an existing application that would require substantial modifications to run in App Service, you could choose Virtual Machines in order to simplify migrating to the cloud.</span></span> <span data-ttu-id="756e0-148">Тем не менее для корректной настройки, защиты и обслуживания виртуальных машин требуется гораздо больше времени и опыта по сравнению со службой приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-148">However, correctly configuring, securing, and maintaining VMs requires much more time and IT expertise compared to Azure App Service.</span></span> <span data-ttu-id="756e0-149">Если вы планируете использовать виртуальные машины Azure, необходимо учитывать затраты времени и ресурсов на текущее обслуживание, установку исправлений и обновлений, а также на управление средой виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="756e0-149">If you're considering Azure Virtual Machines, make sure you take into account the ongoing maintenance effort required to patch, update, and manage your VM environment.</span></span> <span data-ttu-id="756e0-150">Виртуальные машины Azure реализуются на основе концепции "инфраструктура как услуга" (IaaS), тогда как служба приложений построена на основе модели "платформа как услуга" (PaaS).</span><span class="sxs-lookup"><span data-stu-id="756e0-150">Azure Virtual Machines is infrastructure as a service (IaaS), while App Service is PaaS.</span></span> <span data-ttu-id="756e0-151">Также следует учесть, может ли развертывание приложения как контейнера Windows в веб-приложении для контейнеров быть приемлемым вариантом для вашего сценария.</span><span class="sxs-lookup"><span data-stu-id="756e0-151">You should also consider whether deploying your app as a Windows Container to Web App for Containers might be a viable option for your scenario.</span></span>

## <a name="logical-processes"></a><span data-ttu-id="756e0-152">Логические процессы</span><span class="sxs-lookup"><span data-stu-id="756e0-152">Logical processes</span></span>

<span data-ttu-id="756e0-153">Отдельные логические процессы, которые могут быть отделены от остальной части приложения, могут развертываться независимо от функций Azure в режиме "без сервера".</span><span class="sxs-lookup"><span data-stu-id="756e0-153">Individual logical processes that can be decoupled from the rest of the application may be deployed independently to Azure Functions in a "serverless" manner.</span></span> <span data-ttu-id="756e0-154">Благодаря функциям Azure вы можете просто написать код для решения возникшей проблемы, не беспокоясь о приложении или инфраструктуре, необходимых для его выполнения.</span><span class="sxs-lookup"><span data-stu-id="756e0-154">Azure Functions lets you just write the code you need for a given problem, without worrying about the application or infrastructure to run it.</span></span> <span data-ttu-id="756e0-155">Вы можете выбрать удобный для вас язык программирования, например C\#, F\#, Node.js, Python или PHP, который поможет наиболее эффективно решить задачу в вашей ситуации.</span><span class="sxs-lookup"><span data-stu-id="756e0-155">You can choose from a variety of programming languages, including C\#, F\#, Node.js, Python, and PHP, allowing you to pick the most productive language for the task at hand.</span></span> <span data-ttu-id="756e0-156">Как и в случае с большинством облачных решений, вы платите только за время использования и при необходимости всегда можете рассчитывать на возможность масштабирования с использованием функций Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-156">Like most cloud-based solutions, you pay only for the amount of time your use, and you can trust Azure Functions to scale up as needed.</span></span>

## <a name="data"></a><span data-ttu-id="756e0-157">Данные</span><span class="sxs-lookup"><span data-stu-id="756e0-157">Data</span></span>

<span data-ttu-id="756e0-158">Azure предлагает широкий спектр вариантов хранения данных, благодаря чему вы можете выбирать подходящий поставщик для вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="756e0-158">Azure offers a wide variety of data storage options, so that your application can use the appropriate data provider for the data in question.</span></span>

<span data-ttu-id="756e0-159">Для работы с транзакционными и реляционными данными лучше всего подходят базы данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-159">For transactional, relational data, Azure SQL Databases are the best option.</span></span> <span data-ttu-id="756e0-160">Для данных, предназначенных преимущественно для высокопроизводительных операций чтения, эффективным решением будет кэш Redis на основе базы данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-160">For high performance read-mostly data, a Redis cache backed by an Azure SQL Database is a good solution.</span></span>

<span data-ttu-id="756e0-161">Неструктурированные данные JSON могут храниться разными способами, включая столбцы базы данных SQL, большие двоичные объекты, таблицы в службе хранилища Azure или DocumentDB.</span><span class="sxs-lookup"><span data-stu-id="756e0-161">Unstructured JSON data can be stored in a variety of ways, from SQL Database columns to Blobs or Tables in Azure Storage, to DocumentDB.</span></span> <span data-ttu-id="756e0-162">Среди этих вариантов лучшую производительность при обработке запросов обеспечивает DocumentDB, который является оптимальным вариантом для работы с большим числом документов JSON, требующих поддержки запросов.</span><span class="sxs-lookup"><span data-stu-id="756e0-162">Of these, DocumentDB offers the best querying functionality, and is the recommended option for large numbers of JSON-based documents that must support querying.</span></span>

<span data-ttu-id="756e0-163">Для данных на основе промежуточных команд или событий, используемых для оркестрации поведения приложения, можно использовать служебную шину или очереди хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-163">Transient command- or event-based data used to orchestrate application behavior can use Azure Service Bus or Azure Storage Queues.</span></span> <span data-ttu-id="756e0-164">Служебная шина Azure обеспечивает большую гибкость и является оптимальным вариантом для нетривиального обмена сообщениями в рамках одного приложения или между приложениями.</span><span class="sxs-lookup"><span data-stu-id="756e0-164">Azure Storage Bus offers more flexibility and is the recommended service for non-trivial messaging within and between applications.</span></span>

## <a name="architecture-recommendations"></a><span data-ttu-id="756e0-165">Рекомендации по выбору архитектуры</span><span class="sxs-lookup"><span data-stu-id="756e0-165">Architecture recommendations</span></span>

<span data-ttu-id="756e0-166">Архитектура приложения определяется предъявляемыми к нему требованиями.</span><span class="sxs-lookup"><span data-stu-id="756e0-166">Your application's requirements should dictate its architecture.</span></span> <span data-ttu-id="756e0-167">Существует множество различных служб Azure.</span><span class="sxs-lookup"><span data-stu-id="756e0-167">There are many different Azure services available.</span></span> <span data-ttu-id="756e0-168">Очень важно выбрать подходящую.</span><span class="sxs-lookup"><span data-stu-id="756e0-168">Choosing the right one is an important decision.</span></span> <span data-ttu-id="756e0-169">Корпорация Майкрософт предлагает коллекцию эталонных образцов архитектуры, на основе которой можно определить типовые архитектуры, оптимизированные для распространенных сценариев.</span><span class="sxs-lookup"><span data-stu-id="756e0-169">Microsoft offers a gallery of reference architectures to help identify typical architectures optimized for common scenarios.</span></span> <span data-ttu-id="756e0-170">Вы сможете найти архитектуру, которая будет в точности соответствовать потребностям вашего приложения или, как минимум, может быть использована в качестве отправной точки.</span><span class="sxs-lookup"><span data-stu-id="756e0-170">You may find a reference architecture that maps closely to your application's requirements, or at least offers a starting point.</span></span>

<span data-ttu-id="756e0-171">Пример эталонного образца архитектуры показан на рис. 11-2.</span><span class="sxs-lookup"><span data-stu-id="756e0-171">Figure 11-2 shows an example reference architecture.</span></span> <span data-ttu-id="756e0-172">На этой схеме описывается рекомендуемый подход к выбору архитектуры для системы управления содержимым веб-сайта Sitecore, оптимизированного для маркетинговых задач.</span><span class="sxs-lookup"><span data-stu-id="756e0-172">This diagram describes a recommended architecture approach for a Sitecore content management system website optimized for marketing.</span></span>

![](./media/image11-2.png)

<span data-ttu-id="756e0-173">**Рис. 11-1.**</span><span class="sxs-lookup"><span data-stu-id="756e0-173">**Figure 11-1.**</span></span> <span data-ttu-id="756e0-174">Эталонный образец архитектуры маркетингового веб-сайта Sitecore.</span><span class="sxs-lookup"><span data-stu-id="756e0-174">Sitecore marketing website reference architecture.</span></span>

<span data-ttu-id="756e0-175">**Ссылки — рекомендации по размещению в Azure**</span><span class="sxs-lookup"><span data-stu-id="756e0-175">**References – Azure hosting recommendations**</span></span>

- <span data-ttu-id="756e0-176">Архитектуры решений Azure\\</span><span class="sxs-lookup"><span data-stu-id="756e0-176">Azure Solution Architectures\\</span></span>
  <https://azure.microsoft.com/solutions/architecture/>

- <span data-ttu-id="756e0-177">Руководство для разработчиков Azure\\</span><span class="sxs-lookup"><span data-stu-id="756e0-177">Azure Developer Guide\\</span></span>
  <https://azure.microsoft.com/campaigns/developer-guide/>

- <span data-ttu-id="756e0-178">Общие сведения об устройствах\\</span><span class="sxs-lookup"><span data-stu-id="756e0-178">Web Apps overview\\</span></span>
  <https://docs.microsoft.com/azure/app-service/app-service-web-overview>

- <span data-ttu-id="756e0-179">Веб-приложение для контейнеров\\</span><span class="sxs-lookup"><span data-stu-id="756e0-179">Web App for Containers\\</span></span>
  <https://azure.microsoft.com/en-us/services/app-service/containers/>

- <span data-ttu-id="756e0-180">Общие сведения о службе контейнеров Azure (AKS)\\</span><span class="sxs-lookup"><span data-stu-id="756e0-180">Introduction to Azure Kubernetes Service (AKS)\\</span></span>
  <https://docs.microsoft.com/azure/aks/intro-kubernetes>

>[!div class="step-by-step"]
>[<span data-ttu-id="756e0-181">Назад</span><span class="sxs-lookup"><span data-stu-id="756e0-181">Previous</span></span>](development-process-for-azure.md)
