---
title: Потоки и работа с ними
ms.date: 11/08/2018
ms.technology: dotnet-standard
helpviewer_keywords:
- multiple threads
- threading [.NET]
- threading [.NET], multiple threads
ms.assetid: 5baac3aa-e603-4fa6-9f89-0f2c1084e6b1
ms.openlocfilehash: ad36789579b95e0129e402765194b9f5e45a4cc1
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2019
ms.locfileid: "73127503"
---
# <a name="threads-and-threading"></a>Потоки и работа с ними

Многопоточность позволяет увеличивать скорость реагирования приложения и, если приложение работает в многопроцессорной или многоядерной системе, его пропускную способность.

## <a name="processes-and-threads"></a>Процессы и потоки

*Процесс* — это исполнение программы. Операционная система использует процессы для разделения исполняемых приложений. *Поток* — это основная единица, которой операционная система выделяет время процессора. Каждый поток имеет [приоритет планирования](scheduling-threads.md) и набор структур, в которых система сохраняет контекст потока, когда выполнение потока приостановлено. Контекст потока содержит все сведения, позволяющие потоку безболезненно возобновить выполнение, в том числе набор регистров процессора и стек потока. Несколько потоков могут выполняться в контексте процесса. Все потоки процесса используют общий диапазон виртуальных адресов. Поток может исполнять любую часть программного кода, включая части, выполняемые в данный момент другим потоком.

> [!NOTE]
> Платформа .NET Framework предоставляет способ изоляции приложений в процессе с помощью *доменов приложений*. (Домены приложений недоступны в .NET Core.) Дополнительные сведения см. в разделе [Домены приложений и потоки](../../framework/app-domains/application-domains.md#application-domains-and-threads) в статье [Домены приложений](../../framework/app-domains/application-domains.md).

По умолчанию программа .NET запускается с одним потоком, часто называемым *основным* потоком. Тем не менее она может создавать дополнительные потоки для выполнения кода параллельно или одновременно с основным потоком. Эти потоки часто называются *рабочими потоками*.

## <a name="when-to-use-multiple-threads"></a>Цели применения нескольких потоков

Используйте несколько потоков, чтобы увеличить скорость реагирования приложения и воспользоваться преимуществами многопроцессорной или многоядерной системы, чтобы увеличить пропускную способность приложения.

Представьте себе классическое приложение, в котором основной поток отвечает за элементы пользовательского интерфейса и реагирует на действия пользователя. Используйте рабочие потоки для выполнения длительных операций, которые, в противном случае будут занимать основной поток, в результате чего пользовательский интерфейс будет недоступен. Также можно использовать выделенный поток для связи с сетью или устройством, чтобы быстрее реагировать на входящие сообщения или события.

Если программа выполняет операции, которые могут выполняться параллельно, можно уменьшить общее время выполнения путем выполнения этих операций в отдельных потоках и запуска программы в многопроцессорной или многоядерной системе. В такой системе использование многопоточности может увеличить пропускную способность, а также повысить скорость реагирования.

## <a name="how-to-use-multithreading-in-net"></a>Как использовать многопоточность в .NET

Начиная с .NET Framework 4 для многопоточности рекомендуется использовать [библиотеку параллельных задач (TPL)](../parallel-programming/task-parallel-library-tpl.md) и [Parallel LINQ (PLINQ)](../parallel-programming/parallel-linq-plinq.md). Дополнительные сведения см. в разделе [Параллельное программирование](../parallel-programming/index.md).

Библиотека параллельных задач и PLINQ полагаются на потоки <xref:System.Threading.ThreadPool>. Класс <xref:System.Threading.ThreadPool?displayProperty=nameWithType> предоставляет приложения .NET с пулом рабочих потоков. Вы также можете использовать потоки из пула потоков. Дополнительные сведения см. в разделе [Управляемый пул потоков](the-managed-thread-pool.md).

Наконец, можно использовать класс <xref:System.Threading.Thread?displayProperty=nameWithType>, который представляет управляемый поток. Дополнительные сведения см. в разделе [Использование потоков и работа с потоками](using-threads-and-threading.md).

Несколько потоков могут требовать доступ к общему ресурсу. Чтобы сохранить ресурс в неповрежденном состоянии и избежать состояния гонки, необходимо синхронизировать доступ к нему потоков. Вы также можете координировать взаимодействие нескольких потоков. Платформа .NET предоставляет ряд типов для синхронизации доступа к общему ресурсу или координации взаимодействия потоков. Дополнительные сведения см. в разделе [Обзор примитивов синхронизации](overview-of-synchronization-primitives.md).

Исключения следует обрабатывать в потоках. Необработанные исключения в потоках, как правило, приводят к завершению процесса. Дополнительные сведения см. в статье [Исключения в управляемых потоках](exceptions-in-managed-threads.md).

## <a name="see-also"></a>См. также

- [Объекты и функциональные возможности работы с потоками](threading-objects-and-features.md)
- [Рекомендации по работе с потоками](managed-threading-best-practices.md)
- [Параллельная обработка, параллелизм и асинхронное программирование в .NET](../parallel-processing-and-concurrency.md)
- [Процессы и потоки](/windows/desktop/procthread/about-processes-and-threads)
