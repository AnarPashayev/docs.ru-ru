---
title: Практическое руководство. Синхронизация параллельных операций с барьером
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Barrier, how to use
ms.assetid: e1a253ff-e0fb-4df8-95ff-d01a90d4cb19
ms.openlocfilehash: dc0955ba6194dd936da19c634ada797d6cbd3720
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/24/2020
ms.locfileid: "95716477"
---
# <a name="how-to-synchronize-concurrent-operations-with-a-barrier"></a>Практическое руководство. Синхронизация параллельных операций с барьером

В следующем примере показано, как синхронизировать параллельные задачи с помощью объекта <xref:System.Threading.Barrier>.  
  
## <a name="example"></a>Пример  

 Следующая программа подсчитывает количество итераций (или этапов), необходимых для того, чтобы каждый из двух потоков одновременно нашел свое частичное решение, используя алгоритм перемешивания слов. В каждом потоке перемешиваются свои слова, а затем операция барьера после этапа сравнивает два результата и проверяет, правильно ли собрано полное предложение.  
  
 [!code-csharp[CDS_Barrier#01](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_barrier/cs/barrier.cs#01)]
 [!code-vb[CDS_Barrier#01](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_barrier/vb/barrier_vb.vb#01)]  
  
 Объект <xref:System.Threading.Barrier> приостанавливает параллельное выполнение отдельных задач, пока все задачи не достигнут этого барьера. Это полезно в тех случаях, когда параллельная операция имеет четко определенные этапы, по каждому из которых требуется синхронизация между задачами. В нашем примере операция осуществляется в два этапа. На первом этапе каждая задача заполняет данными свой сегмент буфера. Каждая задача, которая завершает заполнение своего сегмента, сообщает барьеру о готовности и переходит в режим ожидания. Когда все задачи отправят барьеру сигналы, блокировка снимается и начинается второй этап. Этот барьер нужен для того, чтобы каждая задача на втором этапе получила доступ ко всем данным, созданным до этого момента. Без этого барьера первая задача, выполнившая свою работу, может начать чтение из буферов, которые еще не заполнены другими задачами. Этот подход позволяет синхронизировать любое количество этапов.  
  
## <a name="see-also"></a>См. также раздел

- [Структуры данных для параллельного программирования](../parallel-programming/data-structures-for-parallel-programming.md)
