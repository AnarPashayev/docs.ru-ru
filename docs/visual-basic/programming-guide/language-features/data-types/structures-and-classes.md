---
title: Структуры и классы (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
ms.openlocfilehash: 3635729705520518d4c950f8a79da7d1249285bf
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61751076"
---
# <a name="structures-and-classes-visual-basic"></a>Структуры и классы (Visual Basic)
Visual Basic унифицирован синтаксис структур и классов, в результате чего обе эти сущности поддерживают большинство тех же функций. Тем не менее существуют важные различия между структуры и классы.  
  
 Классы имеют преимущество ссылочных типов — передачи ссылки является более эффективным, чем переменные структур со всеми данными. С другой стороны структуры не требуют выделения памяти в куче глобального.  
  
 Так как не может наследовать от структуры, структуры следует использовать только для объектов, которые не обязательно должны быть расширены. Используйте структуры, если объект, который вы хотите создать имеет размер мелких и принимать во внимание характеристики производительности классов и структур.  
  
## <a name="similarities"></a>Сходства  
 Структуры и классы схожи в следующих аспектах:  
  
- Оба являются *контейнера* типов, это означает, что они содержат другие типы в качестве членов.  
  
- Обе имеют члены, которые могут включать конструкторы, методы, свойства, поля, константы, перечисления, события и обработчики событий. Тем не менее, не следует путать эти элементы с объявленным *элементы* структуры.  
  
- Члены могут иметь индивидуальные уровни доступа. Например, можно объявить один член `Public` и другой `Private`.  
  
- Они могут реализовывать интерфейсы.  
  
- Они имеют общие конструкторы, с параметрами или без.  
  
- Они могут предоставлять *свойство по умолчанию*, если это свойство принимает хотя бы один параметр.  
  
- Они могут объявлять и создавать события, и могут объявлять делегаты.  
  
## <a name="differences"></a>Различия  
 Структуры и классы отличаются следующими особенностями:  
  
- Структуры являются *типы значений*; классы являются *ссылочные типы*. Переменная типа структуры содержит структуры данных, а чем содержащий ссылку на данные в виде типа класса.  
  
- Структуры используют расположение стека; классы используют выделение кучи.  
  
- Все элементы структуры являются `Public` по умолчанию; класса переменные и константы — это `Private` по умолчанию, хотя другие члены класса являются `Public` по умолчанию. Это поведение для членов класса обеспечивает совместимость с системой Visual Basic 6.0, значений по умолчанию.  
  
- Структуры должны иметь по крайней мере один не совместно переменную или без общего доступа элемента события; класс может быть полностью пустым.  
  
- Элементы структуры не могут объявляться как `Protected`; члены класса могут.  
  
- Процедура структуры может обрабатывать события только в том случае, если это [Shared](../../../../visual-basic/language-reference/modifiers/shared.md) `Sub` процедуры и только с помощью параметра [оператор AddHandler](../../../../visual-basic/language-reference/statements/addhandler-statement.md); любая процедура класса может обработать событие, используя либо [ Обрабатывает](../../../../visual-basic/language-reference/statements/handles-clause.md) ключевое слово или `AddHandler` инструкции. Дополнительные сведения см. в статье [Events (Visual Basic)](../../../../visual-basic/programming-guide/language-features/events/index.md) (События в Visual Basic).  
  
- Структура объявления переменных нельзя указать инициализаторы или исходные размеры массивов; возможность объявления переменных класса.  
  
- Структуры неявно наследуются от <xref:System.ValueType?displayProperty=nameWithType> класса и не может наследовать от любого другого типа; классы могут наследовать от любого класса или классов, отличных от <xref:System.ValueType?displayProperty=nameWithType>.  
  
- Структуры не наследуются; классы являются.  
  
- Структуры никогда не завершается, поэтому общеязыковой среды выполнения (CLR) никогда не вызывает <xref:System.Object.Finalize%2A> метод для структур; классы завершаются сборщиком мусора (GC), который вызывает <xref:System.Object.Finalize%2A> для класса, когда обнаруживает, что нет активных ссылок остальные.  
  
- Структуры не требуется конструктор. Выполняет класс.  
  
- Структуры могут иметь конструкторы экземпляров только в том случае, если они принимают параметры; классы могут иметь их с параметрами или без.  
  
 Каждая структура имеет неявный открытый конструктор без параметров. Этот конструктор инициализирует элементы структуры данных, к значениям по умолчанию. Не удалось переопределить это поведение.  
  
## <a name="instances-and-variables"></a>Экземпляры и переменные  
 Поскольку структуры являются типами значений, каждая переменная структуры постоянно привязан к отдельному экземпляру структуры. Классы являются ссылочными типами, и переменная объекта может ссылаться на различные экземпляры класса в разное время. Это различие влияет на использование структуры и классы из следующих способов:  
  
- **Инициализация.** Переменная структуры неявно включает в себя инициализацию элементов с помощью структуры конструктор без параметров. Таким образом `Dim s As struct1` эквивалентен `Dim s As struct1 = New struct1()`.  
  
- **Назначение переменных.** Если присвоить одну переменную структуры в другую или экземпляр структуры передается в аргумент процедуры, текущие значения всех элементов переменной копируются в новую структуру. Когда переменная объекта присваивается другой или передается в процедуру, копируется только указатель ссылки.  
  
- **Назначение Nothing.** Можно присвоить значение [ничего не](../../../../visual-basic/language-reference/nothing.md) к структуре переменной, но экземпляр продолжает быть связанным с переменной. Можно по-прежнему вызывать его методы и доступ к элементам данных, несмотря на то, что назначением повторно инициализируются элементы переменной.  
  
     Напротив, если задано значение переменной объекта `Nothing`, она не связана ни с каким экземпляром класса, и доступ к любым элементам через переменную нельзя, пока не будет присвоен другой экземпляр.  
  
- **Несколько экземпляров.** Переменная объекта может иметь разные экземпляры класса назначается в разное время, и несколько переменных объекта могут ссылаться на один и тот же экземпляр класса, в то же время. Изменения, внесенные в значения членов класса влияет на эти члены при доступе через другую переменную, указывающую на тот же экземпляр.  
  
     Элементы структуры изолированы в пределах своего экземпляра. Изменения, их значения не отражаются в другие переменные структуры, даже в других экземпляров одной и той же `Structure` объявления.  
  
- **Проверки на равенство.** Равенство двух структур должны выполняться с помощью теста поэлементно. Две объектные переменные можно сравнивать с помощью <xref:System.Object.Equals%2A> метод. <xref:System.Object.Equals%2A> Определяет, указывают ли две переменные на один экземпляр.  
  
## <a name="see-also"></a>См. также

- [Типы данных](../../../../visual-basic/programming-guide/language-features/data-types/index.md)
- [Составные типы данных](../../../../visual-basic/programming-guide/language-features/data-types/composite-data-types.md)
- [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)
- [Структуры](../../../../visual-basic/programming-guide/language-features/data-types/structures.md)
- [Устранение неполадок, связанных с типами данных](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)
- [Структуры и другие элементы программирования](../../../../visual-basic/programming-guide/language-features/data-types/structures-and-other-programming-elements.md)
- [Объекты и классы](../../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)
