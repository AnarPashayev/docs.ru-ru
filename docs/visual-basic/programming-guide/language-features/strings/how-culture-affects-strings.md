---
title: Влияние языка и региональных параметров на строки
ms.date: 07/20/2015
helpviewer_keywords:
- locale [Visual Basic], effect on strings
- strings [Visual Basic], locale dependence
ms.assetid: c4664444-ee0d-47bf-bef1-eaa3c54bdd7f
ms.openlocfilehash: 2520a7684b8710abd949543e3f17f77d3c631d22
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74352480"
---
# <a name="how-culture-affects-strings-in-visual-basic"></a>Влияние языка и региональных параметров на строки в Visual Basic
На этой странице справки обсуждается, как Visual Basic использует сведения о языке и региональных параметрах для преобразования строк и сравнения.  
  
## <a name="when-to-use-culture-specific-strings"></a>Когда следует использовать строки, относящиеся к языку и региональным параметрам  
 Как правило, следует использовать строки, зависящие от языка и региональных параметров, для всех данных, представленных и считываемых пользователями, и использовать строки инвариантных языка и региональных параметров для внутренних данных приложения.  
  
 Например, если приложение запрашивает у пользователей ввод даты в виде строки, оно должно предполагать, что пользователи будут форматировать строки в соответствии с их культурой, и приложение должно соответствующим образом преобразовать строку. Если приложение затем представляет эту дату в пользовательском интерфейсе, оно должно быть представлено в культуре пользователя.  
  
 Однако если приложение передает дату на центральный сервер, то она должна отформатировать строку в соответствии с одной конкретной культурой, чтобы предотвратить путаницу между потенциально разными форматами даты.  
  
## <a name="culture-sensitive-functions"></a>Функции с учетом языка и региональных параметров  
 Все функции преобразования строк Visual Basic (за исключением функций `Str` и `Val`) используют сведения о языке и региональных параметрах приложения, чтобы гарантировать, что преобразования и сравнения подходят для языка и региональных параметров пользователя приложения.  
  
 Ключом к успешному использованию функций преобразования строк в приложениях, работающих на компьютерах с различными параметрами языка и региональных параметров, является понимание того, какие функции используют конкретный параметр языка и региональных параметров, и используется текущий параметр языка и региональных параметров. Обратите внимание, что параметры языка и региональных параметров приложения по умолчанию унаследованы от региональных параметров операционной системы. Дополнительные сведения см. в разделе функции <xref:Microsoft.VisualBasic.Strings.Asc%2A>, <xref:Microsoft.VisualBasic.Strings.AscW%2A>, <xref:Microsoft.VisualBasic.Strings.Chr%2A>, <xref:Microsoft.VisualBasic.Strings.ChrW%2A>, <xref:Microsoft.VisualBasic.Strings.Format%2A>, <xref:Microsoft.VisualBasic.Conversion.Hex%2A>, <xref:Microsoft.VisualBasic.Conversion.Oct%2A>и [преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md).  
  
 `Str` (преобразует числа в строки) и `Val` (преобразует строки в числа) функции не используют сведения о языке и региональных параметрах приложения при преобразовании между строками и числами. Вместо этого они распознают только точку (.) в качестве допустимого десятичного разделителя. Аналогами этих функций, учитывающими культурные особенности, являются:  
  
- **Преобразования, использующие текущий язык и региональные параметры.** Функции `CStr` и `Format` преобразуют число в строку, а функции `CDbl` и `CInt` преобразуют строку в число.  
  
- **Преобразования, использующие конкретный язык и региональные параметры.** Каждый объект Number имеет `ToString(IFormatProvider)` метод, который преобразует число в строку, и метод `Parse(String, IFormatProvider)`, который преобразует строку в число. Например, тип `Double` предоставляет методы <xref:System.Double.ToString%28System.IFormatProvider%29> и <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29>.  
  
 Дополнительные сведения см. в разделах <xref:Microsoft.VisualBasic.Conversion.Str%2A> и <xref:Microsoft.VisualBasic.Conversion.Val%2A>.  
  
## <a name="using-a-specific-culture"></a>Использование определенного языка и региональных параметров  
 Представьте, что вы разрабатываете приложение, которое отправляет в веб-службу дату (в формате строки). В этом случае приложение должно использовать определенную культуру для преобразования строк. Чтобы проиллюстрировать причину, рассмотрим результат использования метода <xref:System.DateTime.ToString> даты: Если приложение использует этот метод для форматирования даты 4 июля 2005, то при запуске с использованием языка и региональных параметров США English (EN-US) возвращается "7/4/2005 12:00:00 AM", но при запуске с использованием немецкого языка (de-DE) он возвращает "04.07.2005 00:00:00".  
  
 Если необходимо выполнить преобразование строк в определенном формате языка и региональных параметров, следует использовать класс `CultureInfo`, встроенный в .NET Framework. Можно создать новый объект `CultureInfo` для определенного языка и региональных параметров, передав имя языка и региональных параметров в конструктор <xref:System.Globalization.CultureInfo.%23ctor%2A>. Поддерживаемые имена языков и региональных параметров перечислены на странице справки <xref:System.Globalization.CultureInfo> класса.  
  
 Кроме того, можно получить экземпляр *инвариантного языка и региональных параметров* из свойства <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>. Инвариантный язык и региональные параметры основаны на английской культуре, но есть некоторые различия. Например, инвариантный язык и региональные параметры задают 24-часовой формат времени вместо 12-часового.  
  
 Чтобы преобразовать дату в строку языка и региональных параметров, передайте объект <xref:System.Globalization.CultureInfo> в метод <xref:System.DateTime.ToString%28System.IFormatProvider%29> объекта Date. Например, следующий код отображает "07/04/2005 00:00:00", независимо от настроек языка и региональных параметров приложения.  
  
 [!code-vb[VbVbalrConcepts#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConcepts/VB/Class1.vb#1)]  
  
> [!NOTE]
> Литералы даты всегда обрабатываются в соответствии с языком и региональными параметрами английского языка.  
  
## <a name="comparing-strings"></a>Сравнение строк  
 Существуют две важные ситуации, в которых требуется сравнение строк:  
  
- **Сортировка данных для просмотра пользователю.** Используйте операции на основе текущего языка и региональных параметров, чтобы строки были отсортированы соответствующим образом.  
  
- **Определение точного совпадения двух внутренних строк приложения (обычно в целях безопасности).** Используйте операции, которые не учитывают текущий язык и региональные параметры.  
  
 Оба типа сравнений можно выполнять с помощью функции Visual Basic <xref:Microsoft.VisualBasic.Strings.StrComp%2A>. Укажите необязательный аргумент `Compare` для управления типом сравнения: `Text` для большинства входных и выходных данных `Binary` для определения точных совпадений.  
  
 Функция `StrComp` возвращает целое число, указывающее связь между двумя сравниваемыми строками на основе порядка сортировки. Положительное значение для результата указывает, что первая строка больше, чем вторая строка. Отрицательный результат указывает, что первая строка меньше, а нулевое значение указывает на равенство между строками.  
  
 [!code-vb[VbVbalrStrings#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class1.vb#22)]  
  
 Можно также использовать .NET Frameworkный участник функции `StrComp`, метод <xref:System.String.Compare%2A?displayProperty=nameWithType>. Это статический перегруженный метод базового класса String. В следующем примере показано, как используется этот метод:  
  
 [!code-vb[VbVbalrStrings#48](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class2.vb#48)]  
  
 Для более точного контроля над выполнением сравнений можно использовать дополнительные перегрузки метода <xref:System.String.Compare%2A>. Используя метод <xref:System.String.Compare%2A?displayProperty=nameWithType>, можно использовать аргумент `comparisonType`, чтобы указать тип сравнения для использования.  
  
|Значение аргумента `comparisonType`|Тип сравнения|Время использования|  
|---|---|---|  
|`Ordinal`|Сравнение на основе байтов компонента строк.|Используйте это значение при сравнении: идентификаторы с учетом регистра, параметры, связанные с безопасностью, или другие нелингвистические идентификаторы, где байты должны точно совпадать.|  
|`OrdinalIgnoreCase`|Сравнение на основе байтов компонента строк.<br /><br /> `OrdinalIgnoreCase` использует инвариантные сведения о культуре, чтобы определить, когда два символа отличаются только прописными буквами.|Используйте это значение при сравнении: идентификаторы без учета регистра, параметры, связанные с безопасностью, и данные, хранящиеся в Windows.|  
|`CurrentCulture` или `CurrentCultureIgnoreCase`|Сравнение на основе интерпретации строк в текущем языке и региональных параметрах.|Используйте эти значения при сравнении: данные, отображаемые пользователю, большинство вводимых пользователем данных и другие данные, для которых требуется лингвистическая интерпретация.|  
|`InvariantCulture` или `InvariantCultureIgnoreCase`|Сравнение на основе интерпретации строк в инвариантном языке и региональных параметрах.<br /><br /> Это отличается от `Ordinal` и `OrdinalIgnoreCase`, поскольку инвариантные язык и региональные параметры рассматривают символы за пределами принятого диапазона как эквивалентные инвариантные символы.|Используйте эти значения только при сравнении сохраняемых данных или при отображении лингвистических релевантных данных, для которых требуется фиксированный порядок сортировки.|  
  
### <a name="security-considerations"></a>Вопросы безопасности  
 Если приложение принимает решения по обеспечению безопасности на основе результатов операции сравнения или изменения регистра, то операция должна использовать метод <xref:System.String.Compare%2A?displayProperty=nameWithType> и передавать `Ordinal` или `OrdinalIgnoreCase` аргументу `comparisonType`.  
  
## <a name="see-also"></a>См. также

- <xref:System.Globalization.CultureInfo>
- [Знакомство со строками в Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/introduction-to-strings.md)
- [Type Conversion Functions](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)
