---
title: Влияние языка и региональных параметров на строки в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- locale [Visual Basic], effect on strings
- strings [Visual Basic], locale dependence
ms.assetid: c4664444-ee0d-47bf-bef1-eaa3c54bdd7f
ms.openlocfilehash: c498ae0a9d39240e715e6ba66e57c5e1d3ebbfbc
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64610419"
---
# <a name="how-culture-affects-strings-in-visual-basic"></a>Влияние языка и региональных параметров на строки в Visual Basic
Эта страница справки описывается, как Visual Basic использует язык и региональные параметры для выполнения преобразования строк и сравнения.  
  
## <a name="when-to-use-culture-specific-strings"></a>Когда следует использовать строки, зависящие от языка и региональных параметров  
 Как правило следует использовать строки, зависящие от языка и региональных параметров для всех данных, адресованных и пользователям и использовать строки языка и региональных параметров для внутренних данных приложения.  
  
 Например если приложение запрашивает пользователям вводить дату в виде строки, следует ожидать, что пользователи форматирования строк в соответствии с их язык и региональные параметры и приложения должны соответствующим образом преобразовать строку. Если приложение затем представляет эти данные в своем пользовательском интерфейсе, оно должно представлять их в язык и региональные параметры пользователя.  
  
 Тем не менее если приложение загружает данные на центральный сервер, следует отформатировать строку в соответствии с одного определенного языка и региональных параметров, чтобы избежать путаницы между потенциально различные форматы даты.  
  
## <a name="culture-sensitive-functions"></a>Функции с учетом языка и региональных параметров  
 Все функции преобразования строк Visual Basic (за исключением `Str` и `Val` функций) используйте информацию о языке и региональных параметрах, чтобы убедиться, что преобразования и сравнения подходят для языка и региональных параметров приложения пользователь.  
  
 Ключ успешно с помощью функции преобразования строк в приложениях, работающих на компьютерах с помощью различных языковых и региональных параметров — понять, какие функции использовать региональных параметров, а какие текущего языка и региональных параметров. Обратите внимание на то, что параметры языка и региональных параметров приложения по умолчанию, унаследованные от параметров языка и региональных параметров операционной системы. Дополнительные сведения см. в разделе <xref:Microsoft.VisualBasic.Strings.Asc%2A>, <xref:Microsoft.VisualBasic.Strings.AscW%2A>, <xref:Microsoft.VisualBasic.Strings.Chr%2A>, <xref:Microsoft.VisualBasic.Strings.ChrW%2A>, <xref:Microsoft.VisualBasic.Strings.Format%2A>, <xref:Microsoft.VisualBasic.Conversion.Hex%2A>, <xref:Microsoft.VisualBasic.Conversion.Oct%2A>, и [функции преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md).  
  
 `Str` (Преобразование чисел в строки) и `Val` функции (преобразование строк в числа) не используют информацию о языке и региональных параметрах, при преобразовании между строками и числами. Вместо этого они распознает только точку (.) в качестве допустимого десятичного разделителя. Учитывающими аналоги этих функций:  
  
- **Преобразования, использующие текущий язык и региональные параметры.** `CStr` И `Format` функции преобразования числа в строку и `CDbl` и `CInt` функции преобразуют строку в число.  
  
- **Преобразования, использующие определенного языка и региональных параметров.** Каждый объект number имеет `ToString(IFormatProvider)` метод, который преобразует число в строку и `Parse(String, IFormatProvider)` метод, который преобразует строку в число. Например `Double` тип предоставляет <xref:System.Double.ToString%28System.IFormatProvider%29> и <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29> методы.  
  
 Дополнительные сведения см. в разделах <xref:Microsoft.VisualBasic.Conversion.Str%2A> и <xref:Microsoft.VisualBasic.Conversion.Val%2A>.  
  
## <a name="using-a-specific-culture"></a>С помощью определенного языка и региональных параметров  
 Представьте себе, что вы разрабатываете приложение, которое отправляет дату (представлен в виде строки) на веб-службу. В этом случае приложение должно использовать определенные язык и региональные параметры для преобразования строк. Чтобы проиллюстрировать, почему, рассмотрим использование даты <xref:System.DateTime.ToString> метод: Если приложение использует этот метод для форматирования даты 4 июля 2005 г., возвращается значение «7/4/2005 12:00:00 AM» при запуске с английского языка США (en US), но возвращает «04.07.2005 00:00:00 "при запуске с культурой немецкий (de-DE).  
  
 Если вам нужно выполнить преобразование строк в формате конкретного языка и региональных параметров, следует использовать `CultureInfo` класс, который встроен в [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]. Вы можете создать новую `CultureInfo` объект для определенного языка и региональных параметров, передав имя культуры <xref:System.Globalization.CultureInfo.%23ctor%2A> конструктор. Имена поддерживаемых языка и региональных параметров, перечислены в <xref:System.Globalization.CultureInfo> класс страницы справки.  
  
 Кроме того, можно получить экземпляр *инвариантного языка и региональных параметров* из <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> свойство. Инвариантный язык и региональные параметры основан на английский язык и региональные параметры, но существуют некоторые различия. К примеру инвариантного языка и региональных параметров указывает 24-часовом формате, а не 12-часовом формате.  
  
 Чтобы преобразовать дату в строку культуры, передайте <xref:System.Globalization.CultureInfo> в объект даты <xref:System.DateTime.ToString%28System.IFormatProvider%29> метод. Например, следующий код отображает «07/04/2005 00:00:00», независимо от параметров языка и региональных параметров приложения.  
  
 [!code-vb[VbVbalrConcepts#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConcepts/VB/Class1.vb#1)]  
  
> [!NOTE]
>  Литералы даты всегда интерпретируются в соответствии с английского языка и региональных параметров.  
  
## <a name="comparing-strings"></a>Сравнение строк  
 Существуют две важные ситуации, где необходимы сравнения строк:  
  
- **Сортировка данных для отображения пользователю.** Использование операций с учетом текущего языка и региональных параметров, чтобы соответствующим образом сортировки строк.  
  
- **Определение, если две строки внутри приложения точно соответствовать (обычно по соображениям безопасности).** Используйте операции, которые не зависят текущего языка и региональных параметров.  
  
 Оба типа сравнения с помощью Visual Basic можно выполнить <xref:Microsoft.VisualBasic.Strings.StrComp%2A> функции. Укажите необязательное `Compare` аргументом, задающим тип сравнения: `Text` для большинства входных и выходных данных `Binary` для определения точных совпадений.  
  
 `StrComp` Функция возвращает целое число, указывающее на соотношение двух сравниваемых строк на основе порядка сортировки. Положительное значение для результата указывает, что первая строка больше второй строки. Отрицательный результат указывает, первая строка меньше и нулевое значение указывает на равенство между строками.  
  
 [!code-vb[VbVbalrStrings#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class1.vb#22)]  
  
 Можно также использовать [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] партнер `StrComp` функции <xref:System.String.Compare%2A?displayProperty=nameWithType> метод. Это статический перегруженный метод базового строкового класса. В следующем примере показано, как используется этот метод:  
  
 [!code-vb[VbVbalrStrings#48](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class2.vb#48)]  
  
 Для более детального контроля над выполнением сравнения можно использовать дополнительные перегрузки <xref:System.String.Compare%2A> метод. С помощью <xref:System.String.Compare%2A?displayProperty=nameWithType> метод, можно использовать `comparisonType` аргумент, чтобы указать тип выполняемого сравнения для использования.  
  
|Значение для `comparisonType` аргумент|Тип сравнения|Время использования|  
|---|---|---|  
|`Ordinal`|Сравнение основано на байтов, составляющих строку.|Используйте это значение при сравнении: идентификаторы с учетом регистра, параметры безопасности или других нелингвистических идентификаторов, где байты должны точно совпадать.|  
|`OrdinalIgnoreCase`|Сравнение основано на байтов, составляющих строку.<br /><br /> `OrdinalIgnoreCase` использует сведения инвариантный язык и региональные параметры для определения того, два символа отличаются только регистром.|Используйте это значение при сравнении: идентификаторы без учета регистра, параметры безопасности и данных, хранящихся в Windows.|  
|`CurrentCulture` или `CurrentCultureIgnoreCase`|Сравнение основано на интерпретации строк в текущих региональных параметров.|Эти значения используются при сравнении: данные, которые отображаются для пользователя, большинства пользовательского ввода и других данных, требующих лингвистической интерпретации.|  
|`InvariantCulture` или `InvariantCultureIgnoreCase`|Сравнение основано на интерпретации строк в инвариантного языка и региональных параметров.<br /><br /> Это отличается от `Ordinal` и `OrdinalIgnoreCase`, так как инвариантный язык и региональные параметры символов находится вне диапазона допустимых считает эквивалентными инвариантными символами.|Эти значения используются только при сравнении сохраняемых данных или Отображение лингвистических данных, требующее фиксированного порядка сортировки.|  
  
### <a name="security-considerations"></a>Вопросы безопасности  
 Если приложение принимает решения относительно безопасности, на основе результата сравнения или операциями изменения регистра, то следует использовать операцию <xref:System.String.Compare%2A?displayProperty=nameWithType> и передайте `Ordinal` или `OrdinalIgnoreCase` для `comparisonType` аргумент.  
  
## <a name="see-also"></a>См. также

- <xref:System.Globalization.CultureInfo>
- [Знакомство со строками в Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/introduction-to-strings.md)
- [Функции преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)
