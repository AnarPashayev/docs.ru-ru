---
title: Уровни доступа
ms.date: 05/10/2018
helpviewer_keywords:
- members [Visual Basic], accessing in Visual Basic
- Friend access modifier
- access levels, declared elements
- access levels
- access modifiers
- Public access modifier
- Protected access modifier
- Protected Friend access modifier
- Private Protected access modifier
- Private access modifier
- declared elements [Visual Basic], access level
ms.assetid: 6e06c1ab-fd78-47f0-83a8-1152780b5e1a
ms.openlocfilehash: 33a218a2acc3c876428d6c9a887280a559f84323
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74348684"
---
# <a name="access-levels-in-visual-basic"></a>Уровни доступа в Visual Basic

*Уровень доступа* объявленного элемента — это степень возможности доступа к нему, то есть код, имеющий разрешение на чтение или запись в него. Это определяется не только способом объявления самого элемента, но и уровнем доступа контейнера элемента. Код, который не может получить доступ к содержащему элементу, не может получить доступ к каким-либо содержащимся в нем элементам, даже объявленным как `Public` Например, к переменной `Public` в структуре `Private` можно обращаться из класса, который содержит структуру, но не за пределами этого класса.

## <a name="public"></a>Public

Ключевое слово [Public](../../../language-reference/modifiers/public.md) в операторе объявления указывает, что доступ к элементу можно получить из кода в любом месте того же проекта, из других проектов, которые ссылаются на проект, и из любой сборки, построенной из проекта. В следующем коде показан пример объявления `Public`:

```vb
Public Class ClassForEverybody
```

`Public` можно использовать только на уровне модуля, интерфейса или пространства имен. Это означает, что можно объявить открытый элемент на уровне исходного файла или пространства имен либо внутри интерфейса, модуля, класса или структуры, но не в процедуре.
  
## <a name="protected"></a>Protected

Ключевое слово [protected](../../../language-reference/modifiers/protected.md) в операторе объявления указывает, что доступ к элементу может осуществляться только в том же классе или из класса, производного от этого класса. В следующем коде показан пример объявления `Protected`:

```vb
Protected Class ClassForMyHeirs
```

`Protected` можно использовать только на уровне класса и только при объявлении члена класса. Это означает, что можно объявить защищенный элемент в классе, но не на уровне исходного файла или пространства имен или внутри интерфейса, модуля, структуры или процедуры.

## <a name="friend"></a>Friend

Ключевое слово [Friend](../../../language-reference/modifiers/friend.md) в операторе объявления указывает, что к элементу можно получить доступ из той же сборки, но не за пределы сборки. В следующем коде показан пример объявления `Friend`:

```vb
Friend stringForThisProject As String
```

`Friend` можно использовать только на уровне модуля, интерфейса или пространства имен. Это означает, что можно объявить дружественный элемент на уровне исходного файла или пространства имен либо внутри интерфейса, модуля, класса или структуры, но не в процедуре.

## <a name="protected-friend"></a>Protected Friend

Сочетание ключевого слова [Protected Friend](../../../language-reference/modifiers/protected-friend.md) в операторе объявления указывает, что доступ к элементу можно получить либо из производных классов, либо из той же сборки или в обоих случаях. В следующем коде показан пример объявления `Protected Friend`:

```vb
Protected Friend stringForProjectAndHeirs As String
```

`Protected Friend` можно использовать только на уровне класса и только при объявлении члена класса. Это означает, что можно объявить защищенный дружественный элемент в классе, но не на уровне исходного файла или пространства имен или внутри интерфейса, модуля, структуры или процедуры.

## <a name="private"></a>Private

Ключевое слово [Private](../../../language-reference/modifiers/private.md) в операторе объявления указывает, что доступ к элементу может осуществляться только в том же модуле, классе или структуре. В следующем коде показан пример объявления `Private`:

```vb
Private _numberForMeOnly As Integer
```

`Private` можно использовать только на уровне модуля. Это означает, что можно объявить закрытый элемент внутри модуля, класса или структуры, но не на уровне исходного файла или пространства имен, внутри интерфейса или в процедуре.

На уровне модуля инструкция `Dim` без каких-либо ключевых слов уровня доступа эквивалентна объявлению `Private`. Однако может потребоваться использовать ключевое слово `Private`, чтобы облегчить чтение и интерпретацию кода.

## <a name="private-protected"></a>Частный защищенный

Сочетание ключевого слова [Private protected](../../../language-reference/modifiers/private-protected.md) в операторе объявления указывает, что доступ к элементу возможен только в пределах того же класса, а также из производных классов, найденных в той же сборке, что и содержащий его класс. Модификатор доступа `Private Protected` поддерживается начиная с Visual Basic 15,5.

В следующем примере показано объявление `Private Protected`:

```vb
Private Protected internalValue As Integer
```

Элемент `Private Protected` можно объявить только внутри класса. Его нельзя объявить в интерфейсе или структуре, а также нельзя объявлять на уровне исходного файла или пространства имен, внутри интерфейса, структуры или в процедуре.

Модификатор доступа `Private Protected` поддерживается Visual Basic 15,5 и более поздних версий. Чтобы использовать его, добавьте следующий элемент в файл проекта Visual Basic ( *\*. vbproj*). Если в системе установлен Visual Basic 15,5 или более поздней версии, он позволяет воспользоваться всеми возможностями языка, поддерживаемыми последней версией компилятора Visual Basic.

```xml
<PropertyGroup>
   <LangVersion>latest</LangVersion>
</PropertyGroup>
```

Чтобы использовать модификатор доступа `Private Protected`, необходимо добавить следующий элемент в файл проекта Visual Basic ( *\*. vbproj*):

```xml
<PropertyGroup>
   <LangVersion>15.5</LangVersion>
</PropertyGroup>
```

Дополнительные сведения см. [в разделе Задание языковой версии Visual Basic](../../../language-reference/configure-language-version.md).

## <a name="access-modifiers"></a>Модификаторы доступа

Ключевые слова, определяющие уровень доступа, называются *модификаторами доступа*. В следующей таблице сравниваются модификаторы доступа.

|Модификатор доступа|Предоставленный уровень доступа|Элементы, которые можно объявить с этим уровнем доступа|Контекст объявления, в котором можно использовать этот модификатор|
|---------------------|--------------------------|-----------------------------------------------------|----------------------------------------------------------------|
|`Public`|Неограниченный<br /><br /> Любой код, который может видеть открытый элемент, может получить к нему доступ|Интерфейсы<br /><br /> Модули<br /><br /> Классы<br /><br /> Структуры<br /><br /> Члены структуры<br /><br /> Процедуры<br /><br /> Свойства<br /><br /> Переменные члена<br /><br /> Константы<br /><br /> Перечисления<br /><br /> События<br /><br /> Внешние объявления<br /><br /> Делегаты|Исходный файл<br /><br /> Пространство имен<br /><br /> Интерфейс<br /><br /> Модуль<br /><br /> Class<br /><br /> Структура|
|`Protected`|Наследование:<br /><br /> Код в классе, который объявляет защищенный элемент или производный от него класс, может получить доступ к элементу|Интерфейсы<br /><br /> Классы<br /><br /> Структуры<br /><br /> Процедуры<br /><br /> Свойства<br /><br /> Переменные члена<br /><br /> Константы<br /><br /> Перечисления<br /><br /> События<br /><br /> Внешние объявления<br /><br /> Делегаты|Class|
|`Friend`|Сборка:<br /><br /> Код в сборке, который объявляет дружественный элемент, может получить к нему доступ|Интерфейсы<br /><br /> Модули<br /><br /> Классы<br /><br /> Структуры<br /><br /> Члены структуры<br /><br /> Процедуры<br /><br /> Свойства<br /><br /> Переменные члена<br /><br /> Константы<br /><br /> Перечисления<br /><br /> События<br /><br /> Внешние объявления<br /><br /> Делегаты|Исходный файл<br /><br /> Пространство имен<br /><br /> Интерфейс<br /><br /> Модуль<br /><br /> Class<br /><br /> Структура|
|`Protected` `Friend`|Объединение `Protected` и `Friend`:<br /><br /> Код в том же классе или в той же сборке, что и защищенный дружественный элемент, или в любом классе, производном от класса элемента, может получить к нему доступ|Интерфейсы<br /><br /> Классы<br /><br /> Структуры<br /><br /> Процедуры<br /><br /> Свойства<br /><br /> Переменные члена<br /><br /> Константы<br /><br /> Перечисления<br /><br /> События<br /><br /> Внешние объявления<br /><br /> Делегаты|Class|
|`Private`|Контекст объявления:<br /><br /> Код в типе, который объявляет закрытый элемент, включая код внутри содержащихся типов, может получить доступ к элементу|Интерфейсы<br /><br /> Классы<br /><br /> Структуры<br /><br /> Члены структуры<br /><br /> Процедуры<br /><br /> Свойства<br /><br /> Переменные члена<br /><br /> Константы<br /><br /> Перечисления<br /><br /> События<br /><br /> Внешние объявления<br /><br /> Делегаты|Модуль<br /><br /> Class<br /><br /> Структура|
|`Private Protected`|Код в классе, объявляющий закрытый защищенный элемент, или код в производном классе, находящийся в той же сборке, что и класс BAS.|Интерфейсы<br /><br /> Классы<br /><br /> Структуры<br /><br /> Процедуры<br /><br /> Свойства<br /><br /> Переменные члена<br /><br /> Константы<br /><br /> Перечисления<br /><br /> События<br /><br /> Внешние объявления<br /><br /> Делегаты|Class|

## <a name="see-also"></a>См. также

- [Оператор Dim](../../../language-reference/statements/dim-statement.md)
- [Статические](../../../language-reference/modifiers/static.md)
- [Имена объявленных элементов](declared-element-names.md)
- [Ссылки на объявленные элементы](references-to-declared-elements.md)
- [Характеристики объявленных элементов](declared-element-characteristics.md)
- [Время существования в Visual Basic](lifetime.md)
- [Область в Visual Basic](scope.md)
- [Практическое руководство. Управление доступностью переменной](how-to-control-the-availability-of-a-variable.md)
- [Переменные](../variables/index.md)
- [Объявление переменных](../variables/variable-declaration.md)
