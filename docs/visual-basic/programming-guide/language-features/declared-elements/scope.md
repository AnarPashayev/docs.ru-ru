---
title: Область видимости в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- module scope [Visual Basic]
- scope [Visual Basic], levels
- module level
- procedures [Visual Basic], scope
- declared elements [Visual Basic], scope
- namespaces [Visual Basic], scope
- scope [Visual Basic], declared elements
- scope [Visual Basic], about scope
- levels of scope [Visual Basic]
- block scope [Visual Basic]
- scope [Visual Basic], Visual Basic
- procedure scope [Visual Basic]
ms.assetid: 208106fe-79c9-4eec-93c6-55f08548895f
ms.openlocfilehash: 6139af65958cefe43578f436204fa6836a71de0b
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61917843"
---
# <a name="scope-in-visual-basic"></a>Область видимости в Visual Basic
*Область* объявленного элемента представляет собой весь код, который могут ссылаться на нее без уточнения его имени или обеспечение его доступности через [оператор Imports (пространство имен .NET и тип)](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md). Элемент может иметь область на одном из следующих уровней:  
  
|Уровень|Описание|  
|-----------|-----------------|  
|Область действия блока|Доступно только в коде блока, в котором она объявлена|  
|Область действия процедуры|Доступен в коде в рамках процедуры, в котором она объявлена.|  
|Области модуля|Для всего кода внутри модуля, класса или структуры, в котором она объявлена|  
|Область видимости пространства имен|Доступен в коде в пространстве имен, в котором она объявлена.|  
  
 Эти уровни области хода выполнения от самой узкой (блока) для широкой (пространства имен), где *наиболее узкой области* означает наименьший объем кода, которые могут обращаться к элементу без уточнения. Дополнительные сведения см. в разделе «Уровни Scope» на этой странице.  
  
## <a name="specifying-scope-and-defining-variables"></a>Указание области и определение переменных  
 Укажите область действия элемента, при объявлении. Область может зависеть от следующих факторов:  
  
- Регион (блокировка, процедуры, модуля, класса или структуры), в которой объявляется элемент  
  
- Пространство имен, содержащее объявление этого элемента  
  
- Уровень доступа, объявляемые для элемента  
  
 Соблюдайте осторожность при определении переменных с одинаковыми именами, но разными областями действия, так как это может привести к непредвиденным результатам. Для получения дополнительной информации см. [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md).  
  
## <a name="levels-of-scope"></a>Уровни области действия  
 Программный элемент доступен во всем регионе, в котором она объявлена. Весь код в одном регионе можно обращаться к элементу без указания полного имени.  
  
### <a name="block-scope"></a>Область видимости блока  
 Блок — это набор операторов, заключенных в начальными и конечными операторы объявления, например следующие:  
  
- `Do` и `Loop`  
  
- `For` [`Each`] и `Next`  
  
- `If` и `End If`  
  
- `Select` и `End Select`  
  
- `SyncLock` и `End SyncLock`  
  
- `Try` и `End Try`  
  
- `While` и `End While`  
  
- `With` и `End With`  
  
 Если вы объявляете переменную в пределах блока, его можно использовать только внутри этого блока. В следующем примере область целочисленной переменной `cube` представляет собой блок между `If` и `End If`, и вы больше не может ссылаться на `cube` операторами блока.  
  
```  
If n < 1291 Then  
    Dim cube As Integer  
    cube = n ^ 3  
End If  
```  
  
> [!NOTE]
>  Даже если областью видимости переменной ограничен блок, его время существования по-прежнему всей процедуры. При вводе блока более одного раза в процессе, каждый блок переменная сохраняет предыдущее значение. Чтобы избежать непредвиденных результатов, в этом случае, имеет смысл для инициализации переменных в начале блока.  
  
### <a name="procedure-scope"></a>Область действия процедуры  
 Элемент, объявленный в процедуре недоступен вне этой процедуры. Его можно использовать только процедура, который содержит объявление. Переменные на этом уровне также называются *локальные переменные*. Они объявляются с [оператор Dim](../../../../visual-basic/language-reference/statements/dim-statement.md)с или без [статический](../../../../visual-basic/language-reference/modifiers/static.md) ключевое слово.  
  
 Область процедуры и блок тесно связаны. При объявлении переменной внутри процедуры, но вне любого блока, в рамках этой процедуры можно представить что переменная имеет область видимости блока, где блок является всей процедуры.  
  
> [!NOTE]
>  Все локальные элементы, даже если они являются `Static` переменные, процедуры, в котором они появляются. Невозможно объявить элемент с использованием [открытый](../../../../visual-basic/language-reference/modifiers/public.md) ключевое слово в процедуре.  
  
### <a name="module-scope"></a>Области модуля  
 Для удобства один термин *уровне модуля* применяется одинаково для модулей, классов и структур. Можно объявить элементы этого уровня, объявляются за пределами любой процедуры или блока, но внутри модуля, класса или структуры.  
  
 При объявлении на уровне модуля, выбранного уровня доступа определяет область. Пространство имен, содержащее модуля, класса или структуры также влияет на область.  
  
 Элементы, для которых объявляется [частного](../../../../visual-basic/language-reference/modifiers/private.md) уровень доступа, доступны для каждой процедуры в этом модуле, но не для кода в другом модуле. `Dim` Инструкции на уровне модуля по умолчанию равно `Private` Если вы не используете все ключевые слова уровня доступа. Тем не менее, внесения областью и нужный уровень доступа более очевидным с помощью `Private` ключевое слово в `Dim` инструкции.  
  
 В следующем примере все процедуры, определенные в модуле могут ссылаться со строковой переменной `strMsg`. Когда вызывается вторая процедура, он отображает содержимое переменной строки `strMsg` в диалоговом окне.  
  
```  
' Put the following declaration at module level (not in any procedure).  
Private strMsg As String  
' Put the following Sub procedure in the same module.  
Sub initializePrivateVariable()  
    strMsg = "This variable cannot be used outside this module."  
End Sub  
' Put the following Sub procedure in the same module.  
Sub usePrivateVariable()  
    MsgBox(strMsg)  
End Sub  
```  
  
### <a name="namespace-scope"></a>Область видимости пространства имен  
 При объявлении элемента на уровне модуля с [Friend](../../../../visual-basic/language-reference/modifiers/friend.md) или [открытый](../../../../visual-basic/language-reference/modifiers/public.md) ключевое слово, он становится доступным для всех процедур пространства имен, в котором объявлен элемент. Со следующими изменениями в предыдущем примере строковая переменная `strMsg` можно обращаться к любым кодом в ее объявлении пространства имен.  
  
```  
' Include this declaration at module level (not inside any procedure).  
Public strMsg As String  
```  
  
 Область видимости пространства имен включает в себя вложенные пространства имен. Элемент, доступный в пространстве имен можно получить из любого пространства имен, вложенных в это пространство имен.  
  
 Если проект не содержит [оператор Namespace](../../../../visual-basic/language-reference/statements/namespace-statement.md)s, весь проект находится в том же пространстве имен. В этом случае область пространства имен может рассматриваться как область проекта. `Public` элементы модуля, класса или структуры также доступны для любого проекта, который ссылается на проект.  
  
## <a name="choice-of-scope"></a>Выбор области действия  
 При объявлении переменной, вам следует помнить следующие моменты при выборе ее области действия.  
  
### <a name="advantages-of-local-variables"></a>Преимущества локальных переменных  
 Локальные переменные являются хорошим выбором для любого типа временных вычислений по следующим причинам:  
  
- **Предотвращение конфликтов имен.** Имена локальных переменных не приводит к конфликту. Например, можно создать несколько разных процедур, содержащих переменную с именем `intTemp`. В течение каждого `intTemp` объявлена как локальная переменная, каждая процедура распознает только свою собственную версию из `intTemp`. Любая процедура может изменить значение в ее локальных `intTemp` без влияния на `intTemp` переменных в других процедур.  
  
- **Потребление памяти.** Локальные переменные потребляют память только во время выполнения процедуры. Их память освобождается, когда процедура возвращает в вызывающий код. Напротив [Shared](../../../../visual-basic/language-reference/modifiers/shared.md) и [статический](../../../../visual-basic/language-reference/modifiers/static.md) переменные потребление ресурсов памяти, пока не завершится работа приложения, поэтому использовать их только при необходимости. *Переменные экземпляра* потребляют память, пока их экземпляр продолжает существовать, что делает их менее эффективно, чем локальные переменные, но потенциально более эффективно, чем `Shared` или `Static` переменные.  
  
### <a name="minimizing-scope"></a>Сокращение области действия  
 Как правило, при объявлении любая переменная или константа, он является хорошим стилем программирования вносить Добивайтесь максимального сужения области (области видимости блока является узкая). Это помогает освободить ресурсы памяти и сводит к минимуму вероятность коде недопустимой переменной. Аналогичным образом, следует объявить переменную [статический](../../../../visual-basic/language-reference/modifiers/static.md) только когда это необходимо сохранить ее значение между вызовами процедур.  
  
## <a name="see-also"></a>См. также

- [Характеристики объявленных элементов](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-characteristics.md)
- [Практическое руководство. Управление областью действия переменной](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)
- [Время существования в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/lifetime.md)
- [Уровни доступа в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)
- [Ссылки на объявленные элементы](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)
- [Объявление переменных](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)
