---
title: Время существования в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- static variables [Visual Basic], lifetime
- static variables [Visual Basic], Visual Basic
- declared elements [Visual Basic], lifetime
- Shared variable lifetime [Visual Basic]
- lifetime [Visual Basic], declared elements
- lifetime [Visual Basic], Visual Basic
- lifetime [Visual Basic]
ms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7
ms.openlocfilehash: 7a8730834c5241ddb1271d689cdda8942741f15f
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61917934"
---
# <a name="lifetime-in-visual-basic"></a>Время существования в Visual Basic
*Время существования* объявленного элемента — это период времени, во время которого он доступен для использования. Переменные являются только элементы, которые имеют время существования. Для этой цели компилятор обрабатывает параметры процедуры, и функция возвращает как особые случаи переменных. Время существования переменной представляет период времени, в течение которого он может содержать значение. Его значение может меняться в течение времени существования, но он всегда содержит некоторое значение.  
  
## <a name="different-lifetimes"></a>Различные жизненные циклы  
 Объект *переменной-члена* (объявлен на уровне модуля, вне любых процедур) обычно имеет то же время существования, что и элемент, в котором она объявлена. Не совместно переменной, объявленной в классе или структуре существует как отдельный экземпляр для каждого экземпляра класса или структуры, в котором она объявлена. Каждая такая переменная имеет то же время существования экземпляра. Тем не менее `Shared` переменная имеет сроком существования, который продолжается в течение всего времени работы приложения.  
  
 Объект *локальной переменной* (объявлен внутри процедуры) существует только в том случае, пока выполняется процедура, в котором она объявлена. Это также относится к параметрам этой процедуры и значениям, возвращаемым функциями. Тем не менее если процедура вызывает другие процедуры, локальные переменные сохраняют свои значения во время работы вызываемых процедур.  
  
## <a name="beginning-of-lifetime"></a>Начало времени существования  
 Время существования локальной переменной начинается при передаче управления в процедуру, в котором она объявлена. Каждой локальной переменной присваивается значение по умолчанию для своего типа данных сразу же начинает процедуру под управлением. Когда в процедуре встречается `Dim` инструкцию, которая определяет начальные значения, он задает этих переменных те значения, даже если ваш код уже назначены другие значения.  
  
 Каждый член структуры переменной инициализируется, как если бы он был отдельной переменной. Аналогичным образом каждый элемент массива инициализируется по отдельности.  
  
 Переменные, объявленные в блоке внутри процедуры (такие как `For` цикла), инициализируются при входе в процедуру. Инициализация вступили в силу независимо от того, имеется ли ваш код никогда не исполняет блока.  
  
## <a name="end-of-lifetime"></a>Окончание времени существования  
 По окончании выполнения процедуры значения ее локальных переменных не сохраняются, и Visual Basic возвращает их память. При следующем вызове процедуры, все ее локальные переменные создаются заново и повторно инициализированы.  
  
 При завершении экземпляра класса или структуры уничтожении его переменные теряют свои памяти и их значения. Каждый новый экземпляр класса или структуры, создает и повторно инициализирует ее не совместно переменные. Тем не менее `Shared` переменные сохраняются, пока не завершится работа приложения.  
  
## <a name="extension-of-lifetime"></a>Продление срока жизни  
 Если объявить локальную переменную с `Static` ключевое слово, существования длиннее, чем время выполнения процедуры. В следующей таблице показано, как объявление процедуры определяет, как долго `Static` переменная существует.  
  
|Расположение процедуры и совместное использование|Время существования статической переменной начинается|Заканчивается время существования статической переменной|  
|------------------------------------|-------------------------------------|-----------------------------------|  
|В модуле (общий по умолчанию)|При первом вызове процедуры|При остановке приложения|  
|В классе `Shared` (процедура не является членом экземпляра)|При первом вызове процедуры в определенном экземпляре или на само имя класса или структуры|При остановке приложения|  
|В экземпляре класса не `Shared` (процедура является членом экземпляра)|При первом вызове процедуры для определенного экземпляра|Когда экземпляр освобождается для сборки мусора (GC)|  
  
## <a name="static-variables-of-the-same-name"></a>Статические переменные с тем же именем  
 Можно объявить статические переменные с тем же именем, в более чем одной процедуры. После этого компилятор Visual Basic считает, что каждый из таких переменных как отдельный элемент. Инициализация одной из этих переменных не влияет на значения остальных. Это же относится, если определить процедуру с набором перегрузки и объявить статическую переменную с тем же именем в каждой перегрузке.  
  
## <a name="containing-elements-for-static-variables"></a>Содержащий элементы для статических переменных  
 Можно объявить статической локальной переменной в пределах класса, то есть внутри процедуры в этом классе. Тем не менее статической локальной переменной в структуре нельзя объявлять как член структуры или как локальную переменную процедуры в этой структуре.  
  
## <a name="example"></a>Пример  
  
### <a name="description"></a>Описание  
 В следующем примере объявляется переменная с [статический](../../../../visual-basic/language-reference/modifiers/static.md) ключевое слово. (Обратите внимание, что нет необходимости `Dim` ключевое слово при [оператор Dim](../../../../visual-basic/language-reference/statements/dim-statement.md) использует модификатор, такой как `Static`.)  
  
### <a name="code"></a>Код  
 [!code-vb[VbVbalrKeywords#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrKeywords/VB/class7.vb#13)]  
  
### <a name="comments"></a>Комментарии  
 В приведенном выше примере переменная `applesSold` продолжает существовать после описания процедуры `runningTotal` возвращает в вызывающий код. В следующий раз `runningTotal` вызове `applesSold` сохраняет ранее вычисленное значение.  
  
 Если `applesSold` была объявлена без использования `Static`, предыдущие накопленные значения не будет сохранено в вызовы `runningTotal`. В следующий раз `runningTotal` был вызван `applesSold` будет заново, инициализируются значением 0, и `runningTotal` просто возвращала бы то же значение, с которым он был вызван.  
  
### <a name="compiling-the-code"></a>Компиляция кода  
 Вы можете инициализировать значение как часть объявления статической локальной переменной. Если объявить массив, который должен быть `Static`, можно инициализировать его ранг (размерность), длина каждого из измерений и значения отдельных элементов.  
  
### <a name="security"></a>Безопасность  
 В предыдущем примере, можно создать одинаковое время существования путем объявления `applesSold` на уровне модуля. При изменении области видимости переменной таким образом, тем не менее, процедура больше не будет иметь монопольный доступ к нему. Поскольку другие процедуры удалось получить доступ к `applesSold` и измените его значение, промежуточных итогов могут быть ненадежными, и код может быть более сложным в обслуживании.  
  
## <a name="see-also"></a>См. также

- [Общие](../../../../visual-basic/language-reference/modifiers/shared.md)
- [Nothing](../../../../visual-basic/language-reference/nothing.md)
- [Имена объявленных элементов](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)
- [Ссылки на объявленные элементы](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)
- [Область, в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)
- [Уровни доступа в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)
- [Переменные](../../../../visual-basic/programming-guide/language-features/variables/index.md)
- [Объявление переменных](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)
- [Устранение неполадок, связанных с типами данных](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)
- [Статические](../../../../visual-basic/language-reference/modifiers/static.md)
