---
title: Значения возврата ref
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: f2a92c584dbb12a322e28435d797fa4d7c2f6dbb
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186936"
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="4405d-102">Поддержка значений возврата ссылок (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="4405d-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="4405d-103">Начиная с C'7.0, язык C's поддерживает *значения возврата ссылок.*</span><span class="sxs-lookup"><span data-stu-id="4405d-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="4405d-104">Один из способов понять значения возврата ссылок заключается в том, что они противоположны аргументам, которые передаются ссылкой на метод.</span><span class="sxs-lookup"><span data-stu-id="4405d-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="4405d-105">При изменении аргумента, передаваемого ссылкой, изменения отражаются в значении переменной на вызываемом абоненте.</span><span class="sxs-lookup"><span data-stu-id="4405d-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="4405d-106">Когда метод предоставляет значение возврата ссылки вызывающему, изменения, внесенные в значение возврата ссылки абонентом, отражаются в данных вызываемого метода.</span><span class="sxs-lookup"><span data-stu-id="4405d-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="4405d-107">Visual Basic не позволяет автору методы со значениями возврата ссылок, но позволяет потреблять значения возврата ссылки.</span><span class="sxs-lookup"><span data-stu-id="4405d-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="4405d-108">Другими словами, можно вызвать метод со значением возврата ссылки и изменить значение возврата, а изменения в значении возврата ссылки отражаются в данных вызываемого метода.</span><span class="sxs-lookup"><span data-stu-id="4405d-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="4405d-109">Изменение значения возврата рефа напрямую</span><span class="sxs-lookup"><span data-stu-id="4405d-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="4405d-110">Для методов, которые всегда `ByRef` преуспевают и не имеют параметров, можно изменить значение возврата ссылки напрямую.</span><span class="sxs-lookup"><span data-stu-id="4405d-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="4405d-111">Это делается, назначая новое значение выражениям, возвращающие значение возврата ссылки.</span><span class="sxs-lookup"><span data-stu-id="4405d-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span>

<span data-ttu-id="4405d-112">Следующий пример C's `NumericValue.IncrementValue` определяет метод, который приращает внутреннее значение и возвращает его в качестве эталонного значения возврата.</span><span class="sxs-lookup"><span data-stu-id="4405d-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="4405d-113">Значение возврата ссылки затем изменяется абонентом в следующем примере Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="4405d-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="4405d-114">Обратите внимание, что `NumericValue.IncrementValue` строка с вызовом метода не присваивает значение методу.</span><span class="sxs-lookup"><span data-stu-id="4405d-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="4405d-115">Вместо этого он присваивает значение значению значения возврата ссылки, возвращаемому методом.</span><span class="sxs-lookup"><span data-stu-id="4405d-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="4405d-116">Использование метода помощника</span><span class="sxs-lookup"><span data-stu-id="4405d-116">Using a helper method</span></span>

<span data-ttu-id="4405d-117">В других случаях изменение значения возврата ссылки вызова метода непосредственно не всегда может быть желательным.</span><span class="sxs-lookup"><span data-stu-id="4405d-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="4405d-118">Например, метод поиска, возвращающем строку, не всегда может найти совпадение.</span><span class="sxs-lookup"><span data-stu-id="4405d-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="4405d-119">В этом случае необходимо изменить значение возврата ссылки только в случае успешного поиска.</span><span class="sxs-lookup"><span data-stu-id="4405d-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="4405d-120">Следующий пример C-пример иллюстрирует этот сценарий.</span><span class="sxs-lookup"><span data-stu-id="4405d-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="4405d-121">Он определяет `Sentence` класс, написанный в `FindNext` C, включает метод, который находит следующее слово в предложении, которое начинается с указанной подстроки.</span><span class="sxs-lookup"><span data-stu-id="4405d-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="4405d-122">Строка возвращается как значение, возвращаемое по ссылке, а переменная `Boolean`, переданная в метод по ссылке, показывает, дал ли поиск какие-то результаты.</span><span class="sxs-lookup"><span data-stu-id="4405d-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="4405d-123">Значение возврата ссылки указывает на то, что помимо чтения возвращенного значения, вызываемый абонент также `Sentence` может изменить его, и что изменение отражено в данных, содержащихся внутри класса.</span><span class="sxs-lookup"><span data-stu-id="4405d-123">The reference return value indicates that in addition to reading the returned value, the caller can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="4405d-124">Непосредственное изменение значения возврата ссылки в этом случае не является надежным, так как вызов метода может не найти совпадение и вернуть первое слово в предложении.</span><span class="sxs-lookup"><span data-stu-id="4405d-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="4405d-125">В этом случае вызываец непреднамеренно изменит первое слово предложения.</span><span class="sxs-lookup"><span data-stu-id="4405d-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="4405d-126">Это может быть предотвращено абонентом, возвращающимся `null` (или `Nothing` в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="4405d-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="4405d-127">Но в этом случае, пытаясь изменить `Nothing` строку, <xref:System.NullReferenceException>значение которой бросает .</span><span class="sxs-lookup"><span data-stu-id="4405d-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="4405d-128">Если также может быть предотвращено возвращением <xref:System.String.Empty?displayProperty=nameWithType>вызывающего абонента, но <xref:System.String.Empty?displayProperty=nameWithType>для этого требуется, чтобы абонент определил переменную строки, значение которой находится в.</span><span class="sxs-lookup"><span data-stu-id="4405d-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="4405d-129">В то время как вызываец может изменить эту строку, сама модификация не служит никакой `Sentence` цели, так как измененная строка не имеет никакого отношения к словам в предложении, хранящемся классом.</span><span class="sxs-lookup"><span data-stu-id="4405d-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="4405d-130">Лучший способ справиться с этим сценарием — передать значение возврата ссылки на метод помощника.</span><span class="sxs-lookup"><span data-stu-id="4405d-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="4405d-131">Затем метод помощника содержит логику, чтобы определить, удалось ли вызов метода, и, если это произошло, изменить значение возврата ссылки.</span><span class="sxs-lookup"><span data-stu-id="4405d-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="4405d-132">Следующий пример обеспечивает возможную реализацию.</span><span class="sxs-lookup"><span data-stu-id="4405d-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="4405d-133">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="4405d-133">See also</span></span>

- [<span data-ttu-id="4405d-134">Передача аргументов по стоимости и ссылке</span><span class="sxs-lookup"><span data-stu-id="4405d-134">Passing arguments by value and by reference</span></span>](passing-arguments-by-value-and-by-reference.md)
- [<span data-ttu-id="4405d-135">Процедуры в Visual Basic</span><span class="sxs-lookup"><span data-stu-id="4405d-135">Procedures in Visual Basic</span></span>](index.md)
