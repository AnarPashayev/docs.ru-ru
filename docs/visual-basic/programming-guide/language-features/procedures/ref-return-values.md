---
title: Значения возврата ref
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: f2a92c584dbb12a322e28435d797fa4d7c2f6dbb
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186936"
---
# <a name="support-for-reference-return-values-visual-basic"></a>Поддержка значений возврата ссылок (Visual Basic)

Начиная с C'7.0, язык C's поддерживает *значения возврата ссылок.* Один из способов понять значения возврата ссылок заключается в том, что они противоположны аргументам, которые передаются ссылкой на метод. При изменении аргумента, передаваемого ссылкой, изменения отражаются в значении переменной на вызываемом абоненте. Когда метод предоставляет значение возврата ссылки вызывающему, изменения, внесенные в значение возврата ссылки абонентом, отражаются в данных вызываемого метода.

Visual Basic не позволяет автору методы со значениями возврата ссылок, но позволяет потреблять значения возврата ссылки. Другими словами, можно вызвать метод со значением возврата ссылки и изменить значение возврата, а изменения в значении возврата ссылки отражаются в данных вызываемого метода.

## <a name="modifying-the-ref-return-value-directly"></a>Изменение значения возврата рефа напрямую

Для методов, которые всегда `ByRef` преуспевают и не имеют параметров, можно изменить значение возврата ссылки напрямую. Это делается, назначая новое значение выражениям, возвращающие значение возврата ссылки.

Следующий пример C's `NumericValue.IncrementValue` определяет метод, который приращает внутреннее значение и возвращает его в качестве эталонного значения возврата.

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

Значение возврата ссылки затем изменяется абонентом в следующем примере Visual Basic. Обратите внимание, что `NumericValue.IncrementValue` строка с вызовом метода не присваивает значение методу. Вместо этого он присваивает значение значению значения возврата ссылки, возвращаемому методом.

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a>Использование метода помощника

В других случаях изменение значения возврата ссылки вызова метода непосредственно не всегда может быть желательным. Например, метод поиска, возвращающем строку, не всегда может найти совпадение. В этом случае необходимо изменить значение возврата ссылки только в случае успешного поиска.

Следующий пример C-пример иллюстрирует этот сценарий. Он определяет `Sentence` класс, написанный в `FindNext` C, включает метод, который находит следующее слово в предложении, которое начинается с указанной подстроки. Строка возвращается как значение, возвращаемое по ссылке, а переменная `Boolean`, переданная в метод по ссылке, показывает, дал ли поиск какие-то результаты. Значение возврата ссылки указывает на то, что помимо чтения возвращенного значения, вызываемый абонент также `Sentence` может изменить его, и что изменение отражено в данных, содержащихся внутри класса.

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

Непосредственное изменение значения возврата ссылки в этом случае не является надежным, так как вызов метода может не найти совпадение и вернуть первое слово в предложении. В этом случае вызываец непреднамеренно изменит первое слово предложения. Это может быть предотвращено абонентом, возвращающимся `null` (или `Nothing` в Visual Basic). Но в этом случае, пытаясь изменить `Nothing` строку, <xref:System.NullReferenceException>значение которой бросает . Если также может быть предотвращено возвращением <xref:System.String.Empty?displayProperty=nameWithType>вызывающего абонента, но <xref:System.String.Empty?displayProperty=nameWithType>для этого требуется, чтобы абонент определил переменную строки, значение которой находится в. В то время как вызываец может изменить эту строку, сама модификация не служит никакой `Sentence` цели, так как измененная строка не имеет никакого отношения к словам в предложении, хранящемся классом.

Лучший способ справиться с этим сценарием — передать значение возврата ссылки на метод помощника. Затем метод помощника содержит логику, чтобы определить, удалось ли вызов метода, и, если это произошло, изменить значение возврата ссылки. Следующий пример обеспечивает возможную реализацию.

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a>См. также раздел

- [Передача аргументов по стоимости и ссылке](passing-arguments-by-value-and-by-reference.md)
- [Процедуры в Visual Basic](index.md)
