---
title: Возвращаемые ссылочные значения (Visual Basic)
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: d0600f7d9030324160343e800c37e0f5e68bff61
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59133982"
---
# <a name="support-for-reference-return-values-visual-basic"></a>Поддержка использования возвращаемых ссылочных значений (Visual Basic)

Начиная с C# 7.0, C# поддерживает язык *ссылаться на возвращаемые значения*. Один из способов понять возвращаемые ссылочные значения являются противоположностью аргументы, передаваемые по ссылке в метод. При изменении аргумент, переданный по ссылке, изменения отражаются в значение переменной в вызывающем объекте. Если метод предоставляет возвращаемые ссылочные значения вызывающему, изменения, внесенные в возвращаемое ссылочное значение вызывающим объектом, отражаются в данных вызываемого метода.

Visual Basic не поддерживает возможность автору методы со ссылкой на возвращаемые значения, но он позволяет использовать возвращаемые ссылочные значения. Другими словами можно вызвать метод в возвращаемые ссылочные значения и изменять это возвращаемое значение и возвращаемое ссылочное значение изменения отражаются в данных вызываемого метода.

## <a name="modifying-the-ref-return-value-directly"></a>Непосредственное изменение возвращаемого ссылочного значения

Для методов, которые всегда завершаются успешно и не имеют `ByRef` параметры, которые можно изменить непосредственно возвращаемое ссылочное значение. Для этого необходимо назначить новое значение для выражений, которые возвращает возвращаемое ссылочное значение. 

Следующие C# примере определяется `NumericValue.IncrementValue` метод, который увеличивает внутреннего значения и возвращает его как ссылку на возвращаемое значение. 

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

Возвращаемое ссылочное значение изменяется в вызывающем объекте, в следующем примере Visual Basic. Обратите внимание, что строки с `NumericValue.IncrementValue` вызов метода не присвоить значение в метод. Вместо этого он присваивает значение возвращаемое ссылочное значение, возвращенное методом.

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a>С помощью вспомогательного метода

В других случаях непосредственное изменение возвращаемое ссылочное значение вызова метода, не всегда может быть нежелательно. Например метод поиска, который возвращает строку, не всегда будут возвращаться совпадения. В этом случае вы хотите изменить возвращаемое ссылочное значение только в том случае, если поиск прошел успешно.

Следующие C# примере показан этот сценарий. Он определяет `Sentence` классом, написанным на C# включает в себя `FindNext` метод, который выполняет поиск следующего слова в предложении, которое начинается с заданной подстроки. Строка возвращается как значение, возвращаемое по ссылке, а переменная `Boolean`, переданная в метод по ссылке, показывает, дал ли поиск какие-то результаты. Возвращаемое ссылочное значение указывает, что вызывающий объект не только читайте возвращаемого значения; Он также можно изменить его, и эти изменения отражаются в данных, содержащихся в внутреннего использования в `Sentence` класса.

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

Непосредственное изменение ссылки на возвращаемое значение в этом случае не является надежным, так как вызов метода не сможет найти соответствие и возвращает первое слово в предложении. В этом случае вызывающий объект случайно изменит первым словом предложения. Это может быть запрещен, возвращая вызывающим `null` (или `Nothing` в Visual Basic). Но в этом случае попытка изменить строку, значение которого равно `Nothing` вызывает <xref:System.NullReferenceException>. Если удалось избежать, возвращая вызывающий объект <xref:System.String.Empty?displayProperty=nameWithType>, но это требует, что вызывающий объект определил строковую переменную, значение которого равно <xref:System.String.Empty?displayProperty=nameWithType>. Вызывающий объект можно изменить эту строку, изменение самого бессмысленно, поскольку измененной строки не имеют отношения к слова в предложении, хранящихся в `Sentence` класса.

Лучший способ обработки этого сценария является передача по ссылке на вспомогательный метод возвращаемое ссылочное значение. Вспомогательный метод затем содержит логику для определения успешного вызова метода и, в противном случае изменение ссылки возвращаемое значение. Ниже приведены возможные реализации.

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a>См. также

- [Передача аргументов по значению и по ссылке](passing-arguments-by-value-and-by-reference.md)
- [Процедуры в Visual Basic](index.md)
