---
title: Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- procedures [Visual Basic], parameters
- procedure overloading [Visual Basic], optional parameters
- procedures [Visual Basic], defining
- Visual Basic code, procedures
- procedure parameters
- procedures [Visual Basic], overloading
- procedures [Visual Basic], multiple versions
ms.assetid: 825f9d56-4cde-43fd-993a-b9171717e2eb
ms.openlocfilehash: 58c52a7d73efbd96d772dd85d6bf2c9084fb1241
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61863653"
---
# <a name="how-to-overload-a-procedure-that-takes-optional-parameters-visual-basic"></a>Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр (Visual Basic)
Если процедура имеет один или несколько [необязательно](../../../../visual-basic/language-reference/modifiers/optional.md) параметров, нельзя определить перегруженную версию, соответствующую любой из ее неявных перегрузок. Дополнительные сведения см. в разделе «Неявные перегрузки для необязательные параметры» в [вопросы, связанные с перегрузкой процедур](./considerations-in-overloading-procedures.md).  
  
## <a name="one-optional-parameter"></a>Один необязательный параметр  
  
#### <a name="to-overload-a-procedure-that-takes-one-optional-parameter"></a>Перегрузка процедуры, которая принимает один необязательный параметр  
  
1. Запись `Sub` или `Function` оператора объявления, которая включает необязательный параметр в списке параметров. Не используйте `Optional` ключевое слово в данной перегруженной версии.  
  
2. Перед `Sub` или `Function` ключевого слова with [перегружает](../../../../visual-basic/language-reference/modifiers/overloads.md) ключевое слово.  
  
3. Напишите код процедуры, который должен выполняться, когда вызывающий код предоставляет необязательный аргумент.  
  
4. Завершите процедуру `End Sub` или `End Function` инструкцию соответствующим образом.  
  
5. Напишите вторую инструкцию объявления, идентичный первому объявлению, за исключением того, чтобы он включал необязательного параметра в списке параметров.  
  
6. Напишите код процедуры, который должен выполняться, когда вызывающий код не предоставляет необязательный аргумент. Завершите процедуру `End Sub` или `End Function` инструкцию соответствующим образом.  
  
     В следующем примере показана процедура, определенная с необязательным параметром, аналогичный набор две перегруженные процедуры и, наконец, примеры недопустимых и допустимых перегруженных версий.  
  
     [!code-vb[VbVbcnProcedures#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#59)]  
  
     [!code-vb[VbVbcnProcedures#60](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#60)]  
  
     [!code-vb[VbVbcnProcedures#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#61)]  
  
## <a name="multiple-optional-parameters"></a>Несколько необязательных параметров  
 Для процедуры с более чем один необязательный параметр обычно необходимо более двух перегруженных версий. Например если существуют два необязательных параметра, а вызывающий код может использовать или опустить каждый из них независимо от другого, требуется четыре перегруженные версии, по одному для каждого из возможных сочетаний предоставленных аргументов.  
  
 С увеличением числа необязательных параметров, повышает сложность перегрузки. Если некоторые сочетания указанные аргументы недопустимы, для N необязательных параметров требуется 2 ^ N перегруженных версий. В зависимости от природы процедуры может оказаться, что ясности логики по правому краю лишние усилия для определения всех перегруженных версий.  
  
#### <a name="to-overload-a-procedure-that-takes-more-than-one-optional-parameter"></a>Перегрузка процедуры, которая принимает более чем один необязательный параметр  
  
1. Определите, какие комбинации предоставленных аргументов необязательно являются допустимыми в логику процедуры. Недопустимое сочетание может возникнуть, если один необязательный параметр зависит от другого. Например если один параметр принимает имя супруга, а другой принимает возраст супруга, сочетание аргументов возраста, но при пропуске названия неприемлем.  
  
2. Для каждой допустимой комбинации предоставленных аргументов необязательно писать `Sub` или `Function` оператора объявления, который определяет соответствующий список параметров. Не используйте `Optional` ключевое слово.  
  
3. В каждое объявление перед `Sub` или `Function` ключевого слова with [перегружает](../../../../visual-basic/language-reference/modifiers/overloads.md) ключевое слово.  
  
4. После каждого объявления напишите код процедуры, который должен выполняться, когда вызывающий код предоставляет список аргументов, соответствующий списку параметров в объявлении.  
  
5. Завершите выполнение каждой процедуры с `End Sub` или `End Function` инструкцию соответствующим образом.  
  
## <a name="see-also"></a>См. также

- [Процедуры](./index.md)
- [Параметры и аргументы процедуры](./procedure-parameters-and-arguments.md)
- [Необязательные параметры](./optional-parameters.md)
- [Массивы параметров](./parameter-arrays.md)
- [Перегрузка процедур](./procedure-overloading.md)
- [Рекомендации по устранению неполадок](./troubleshooting-procedures.md)
- [Практическое руководство. Определение различных версий процедуры](./how-to-define-multiple-versions-of-a-procedure.md)
- [Практическое руководство. Вызов перегруженной процедуры](./how-to-call-an-overloaded-procedure.md)
- [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)
- [Разрешение перегрузки](./overload-resolution.md)
