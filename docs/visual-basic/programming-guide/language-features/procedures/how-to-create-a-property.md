---
title: Практическое руководство. Создание свойства
ms.date: 07/20/2015
helpviewer_keywords:
- procedures [Visual Basic], defining
- Visual Basic code, procedures
- Visual Basic code, properties
- properties [Visual Basic]
ms.assetid: 4d229712-6be8-4c5c-bac5-06995ce9185a
ms.openlocfilehash: ee5a9f687765ce064eb3c3f84218ed36eb916d9d
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74349702"
---
# <a name="how-to-create-a-property-visual-basic"></a>Практическое руководство. Создание свойства (Visual Basic)
Определение свойства заключается между оператором `Property` и оператором `End Property`. В этом определении определяется процедура `Get`, процедура `Set` или и то, и другое. Весь код свойства находится в пределах этих процедур.  
  
 `Get` процедура получает значение свойства, а процедура `Set` сохраняет значение. Если требуется, чтобы свойство имело доступ на чтение и запись, необходимо определить обе процедуры. Для свойства, доступного только для чтения, вы определяете только `Get`, а для свойства только для записи вы определяете только `Set`.  
  
### <a name="to-create-a-property"></a>Создание свойства  
  
1. За пределами любого свойства или процедуры используйте [инструкцию Property](../../../../visual-basic/language-reference/statements/property-statement.md), за которой следует оператор `End Property`.  
  
2. Если свойство принимает параметры, используйте ключевое слово `Property` с именем процедуры, а затем список параметров в круглых скобках.  
  
3. Используйте круглые скобки с предложением `As`, чтобы указать тип данных значения свойства. Необходимо указать тип данных даже для свойства, доступного только на запись.  
  
4. При необходимости добавьте `Get` и `Set` процедуры. См. следующие направления.  
  
### <a name="to-create-a-get-procedure-that-retrieves-a-property-value"></a>Создание процедуры Get, которая получает значение свойства  
  
1. Между инструкциями `Property` и `End Property` напишите [инструкцию GET](../../../../visual-basic/language-reference/statements/get-statement.md), за которой следует оператор `End Get`. Для процедуры `Get` не нужно определять никаких параметров.  
  
2. Поместите операторы кода, чтобы получить значение свойства между операторами `Get` и `End Get`. Этот код может включать другие вычисления и манипуляции с данными в дополнение к формированию и возврату значения свойства.  
  
3. Используйте оператор `Return`, чтобы вернуть значение свойства в вызывающий код.  
  
 Необходимо написать `Get` процедуру для свойства, доступного для чтения и записи, и для свойства, доступного только для чтения. Не следует определять `Get`ую процедуру для свойства, доступного только на запись.  
  
### <a name="to-create-a-set-procedure-that-writes-a-propertys-value"></a>Создание процедуры Set, которая записывает значение свойства  
  
1. Между инструкциями `Property` и `End Property` напишите [инструкцию SET](../../../../visual-basic/language-reference/statements/set-statement.md), за которой следует оператор `End Set`.  
  
2. В операторе `Set` используйте ключевое слово `Set` со списком параметров в круглых скобках. Этот список параметров должен включать по крайней мере параметр значения для значения, переданного вызывающим кодом. Имя по умолчанию для этого параметра value — `Value`, но при необходимости можно использовать другое имя. Параметр значения должен иметь тот же тип данных, что и само свойство.  
  
3. Поместите инструкции кода для хранения значения в свойстве между операторами `Set` и `End Set`. Этот код может включать другие вычисления и манипуляции с данными в дополнение к проверке и хранению значения свойства.  
  
4. Используйте параметр value, чтобы принять значение, предоставленное вызывающим кодом. Это значение можно сохранить непосредственно в операторе присваивания или использовать в выражении для вычисления внутреннего значения, которое должно быть сохранено.  
  
 Для свойства, доступного для чтения и записи, и для свойства только для записи необходимо написать `Set` процедуру. Не следует определять `Set`ую процедуру для свойства, доступного только для чтения.  
  
## <a name="example"></a>Пример  
 В следующем примере создается свойство для чтения и записи, которое хранит полное имя как два составных имени, имя и фамилию. Когда вызывающий код считывает `fullName`, `Get` процедура объединяет два составных имени и возвращает полное имя. Когда вызывающий код присваивает новое полное имя, процедура `Set` пытается разбить ее на два составных имени. Если не удается найти пробел, он сохраняется как первое имя.  
  
 [!code-vb[VbVbcnProcedures#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#8)]  
  
 В следующем примере показаны типичные вызовы процедур свойств `fullName`. Первый вызов задает значение свойства, а второй вызов извлекает его.  
  
 [!code-vb[VbVbcnProcedures#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#9)]  
  
## <a name="see-also"></a>См. также

- [Процедуры](./index.md)
- [Процедуры свойств](./property-procedures.md)
- [Параметры и аргументы процедуры](./procedure-parameters-and-arguments.md)
- [Различия между свойствами и переменными в Visual Basic](./differences-between-properties-and-variables.md)
- [Практическое руководство. Объявление свойства со смешанным уровнем доступа](./how-to-declare-a-property-with-mixed-access-levels.md)
- [Практическое руководство. Вызов процедуры свойства](./how-to-call-a-property-procedure.md)
- [Инструкции. объявление и вызов свойства по умолчанию в Visual Basic](./how-to-declare-and-call-a-default-property.md)
- [Практическое руководство. Запись значения в свойство](./how-to-put-a-value-in-a-property.md)
- [Практическое руководство. Получение значения из свойства](./how-to-get-a-value-from-a-property.md)
