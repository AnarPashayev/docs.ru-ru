---
title: Overload Resolution
ms.date: 07/20/2015
helpviewer_keywords:
- Visual Basic code, procedures
- overload resolution
- procedures [Visual Basic], overloading
- procedures [Visual Basic], calling
- procedure overloading [Visual Basic], overload resolution
- signatures [Visual Basic], procedure
- overloads [Visual Basic], resolution
ms.assetid: 766115d1-4352-45fb-859f-6063e0de0ec0
ms.openlocfilehash: 84d52bbbfb34c2e5d67ed6a1810ab3e32fafda22
ms.sourcegitcommit: 43d10ef65f0f1fd6c3b515e363bde11a3fcd8d6d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2020
ms.locfileid: "78266876"
---
# <a name="overload-resolution-visual-basic"></a>Разрешение перегрузки (Visual Basic)
Когда компилятор Visual Basic сталкивается с вызовом процедуры, которая определена в нескольких перегруженных версиях, компилятор должен решить, какую из перегрузок вызывать. Он делает это, выполняя следующие шаги:  
  
1. **Доступность.** Он устраняет любые перегрузки с уровнем доступа, который предотвращает вызов кода вызова от вызова.  
  
2. **Количество параметров.** Он устраняет любые перегрузки, определяющие другое количество параметров, чем в вызове.  
  
3. **Типы параметров данных.** Компилятор дает приоритеты, отдавая предпочтение методам расширения. Если найден какой-либо метод экземпляра, который требует только расширения конверсий в соответствии с вызовом процедуры, все методы расширения отбрасываются, а компилятор продолжает только с кандидатами метода экземпляра. Если такой метод экземпляра не найден, он продолжается как с экземпляром, так и с методами расширения.  
  
     На этом этапе он устраняет любую перегрузку, для которой типы данных вызывающих аргументов не могут быть преобразованы в типы параметров, определенные в перегрузке.  
  
4. **Сужение конверсий.** Он устраняет любые перегрузки, требующие сужения преобразования от типов вызывающего аргумента к определенным типам параметров. Это верно ли тип проверки переключатель `On` ( `Off`Option[Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)) является или .  
  
5. **Наименьшее расширение.** Компилятор рассматривает оставшиеся перегрузки парами. Для каждой пары сравниваются типы данных определенных параметров. Если типы в одной из перегрузок расширяются до соответствующих типов в другом, компилятор устраняет последнее. То есть он сохраняет перегрузку, которая требует наименьшего количества расширения.  
  
6. **Единый кандидат.** Он продолжает рассматривать перегрузки в парах до тех пор, пока не останется только одна перегрузка, и не разрешит вызов этой перегрузки. Если компилятор не может уменьшить перегрузки до одного кандидата, он генерирует ошибку.  
  
 На следующей иллюстрации показан процесс, определяющий, какой из набора перегруженных версий вызывается.  
  
 ![Схема потока перегруженного процесса разрешения](./media/overload-resolution/determine-overloaded-version.gif "Разрешение среди перегруженных версий")
  
 Следующий пример иллюстрирует этот процесс разрешения перегрузок.  
  
 [!code-vb[VbVbcnProcedures#62](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#62)]  
  
 [!code-vb[VbVbcnProcedures#63](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#63)]  
  
 В первом вызове компилятор устраняет первую перегрузку, поскольку тип первого аргумента ()`Short`сужается до типа соответствующего параметра ().`Byte` Затем он устраняет третью перегрузку, потому `Single`что каждый тип аргумента во`Integer` второй `Single`перегрузке (и)`Short` расширяется до соответствующего типа в третьей перегрузке (и). Вторая перегрузка требует меньшего расширения, поэтому компилятор использует ее для вызова.  
  
 Во втором вызове компилятор не может устранить любые перегрузки на основе сужения. Он устраняет третью перегрузку по той же причине, что и в первом вызове, потому что он может вызвать вторую перегрузку с меньшим расширением типов аргументов. Однако компилятор не может решить проблему между первой и второй перегрузками. Каждый из них имеет один определенный тип параметра, `Single` который `Double`расширяется до соответствующего типа в другом (к`Byte` `Short`, но к). Таким образом, компилятор генерирует ошибку разрешения перегрузки.  
  
## <a name="overloaded-optional-and-paramarray-arguments"></a>Перегруженные Факультативные и ParamArray Аргументы  
 Если две перегрузки процедуры имеют одинаковые подписи, за исключением того, что последний параметр объявлен [необязательным](../../../../visual-basic/language-reference/modifiers/optional.md) в одном, а [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md) в другом, компилятор разрешает вызов этой процедуры следующим образом:  
  
|Если вызов поставляет последний аргумент, как|Компилятор разрешает вызов перегрузки, объявляя последний аргумент|  
|---|---|  
|Нет значения (аргумент опущен)|`Optional`|  
|Одно значение|`Optional`|  
|Два или более значений в списке, разделенном запятой|`ParamArray`|  
|Массив любой длины (включая пустой массив)|`ParamArray`|  
  
## <a name="see-also"></a>См. также раздел

- [Дополнительные параметры](./optional-parameters.md)
- [Массивы параметров](./parameter-arrays.md)
- [Перегрузка процедур](./procedure-overloading.md)
- [Рекомендации по устранению неполадок](./troubleshooting-procedures.md)
- [Практическое руководство. Определение различных версий процедуры](./how-to-define-multiple-versions-of-a-procedure.md)
- [Практическое руководство. Вызов перегруженной процедуры](./how-to-call-an-overloaded-procedure.md)
- [Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр](./how-to-overload-a-procedure-that-takes-optional-parameters.md)
- [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)
- [Вопросы, связанные с перегрузкой процедур](./considerations-in-overloading-procedures.md)
- [Перегрузки](../../../../visual-basic/language-reference/modifiers/overloads.md)
- [Методы расширения](./extension-methods.md)
