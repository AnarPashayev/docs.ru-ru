---
title: Разрешение перегрузки (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- Visual Basic code, procedures
- overload resolution
- procedures [Visual Basic], overloading
- procedures [Visual Basic], calling
- procedure overloading [Visual Basic], overload resolution
- signatures [Visual Basic], procedure
- overloads [Visual Basic], resolution
ms.assetid: 766115d1-4352-45fb-859f-6063e0de0ec0
ms.openlocfilehash: 4f81c7377423899c142c4270f325bbd7ed20b877
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61792034"
---
# <a name="overload-resolution-visual-basic"></a>Разрешение перегрузки (Visual Basic)
Когда компилятор Visual Basic обнаруживает вызов процедуры, которая определена в нескольких перегруженных версиях, компилятор должен определить, какую из перегрузок для вызова. Это достигается путем выполнения следующих шагов:  
  
1. **Специальные возможности.** Это исключает ни одной перегрузке с уровнем доступа, который запрещает вызов этого метода вызывающий код.  
  
2. **Число параметров.** Это исключает ни одной перегрузке, определяющий разное число параметров, чем задано в вызове.  
  
3. **Типы данных параметров.** Компилятор отдает предпочтение методам экземпляра по сравнению с методами расширения. Если найдено любой метод экземпляра, для которого требуется только расширяющие преобразования в соответствии с вызова процедуры, удаляются все методы расширения, и компилятор продолжает выполняться с использованием только методы экземпляров. Если такого метода экземпляр не найден, он продолжает с экземпляром и методы расширения.  
  
     На этом шаге он исключает ни одной перегрузке, для которого не может преобразовать типы данных аргументов вызова для типов параметров, определенных в перегрузке.  
  
4. **Сужающие преобразования.** Это устраняет любые перегрузку, которая требует сужающего преобразования из типов аргументов вызова в типы определенных параметров. Это верно, является ли переключатель проверки типа ([оператор Option Strict](../../../../visual-basic/language-reference/statements/option-strict-statement.md)) является `On` или `Off`.  
  
5. **Наименьшее расширение.** Компилятор считает, что оставшиеся перегрузки парами. Для каждой пары он сравнивает типы данных определенных параметров. Если типы в одну из перегрузок все расширяется до соответствующих типов в другой, компилятор исключает последнюю. То есть остается перегрузка, которая требует наименьший объем расширения.  
  
6. **Единственный вариант.** Он продолжает рассматривать перегрузки парами пока только одна перегрузка остается, и он разрешает вызов этой перегрузки. Если компилятор не может уменьшить перегрузок единственный вариант, он создает ошибку.  
  
 Ниже показан процесс, который определяет набор перегруженных версий для вызова.  
  
 ![Схема потока перегруженного процесса разрешения](./media/overload-resolution/determine-overloaded-version.gif "разрешение для перегруженных версий,")    
  
 Следующий пример иллюстрирует этот процесс разрешения перегрузки.  
  
 [!code-vb[VbVbcnProcedures#62](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#62)]  
  
 [!code-vb[VbVbcnProcedures#63](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#63)]  
  
 В первом вызове компилятор устраняет первую перегрузку, так как тип первого аргумента (`Short`) сужается к типу соответствующего параметра (`Byte`). Затем исключаются третья перегрузка, так как каждый тип аргумента во второй перегрузке (`Short` и `Single`) можно расширить до соответствующего типа в третьей перегрузке (`Integer` и `Single`). Вторая перегрузка требует меньшего расширения, поэтому компилятор использует его для вызова.  
  
 Во втором вызове компилятор не может устранить перегрузок на основании сужающим. Это устраняет третья перегрузка по той же причине, как и в первом вызове, так как оно может вызвать вторую перегрузку с меньшим расширением типов аргументов. Однако компилятору не удается разрешить между первой и второй перегрузок. Каждый имеет один определенный тип параметра, можно расширить до соответствующего типа в другой (`Byte` для `Short`, но `Single` для `Double`). Поэтому компилятор создает ошибку разрешения перегрузки.  
  
## <a name="overloaded-optional-and-paramarray-arguments"></a>Перегрузка необязательных аргументов и массива аргументов  
 Если две перегрузки процедуры имеют идентичные подписи, за исключением того, что последний параметр объявляется [необязательно](../../../../visual-basic/language-reference/modifiers/optional.md) в одном и [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md) в другой, компилятор разрешает вызов процедуры, как выглядит следующим образом:  
  
|Если задан как последний аргумент при вызове|Компилятор разрешает вызов перегрузки, объявление как последний аргумент|  
|---|---|  
|Нет значения (аргумент опущен)|`Optional`|  
|Одиночное значение|`Optional`|  
|Два или несколько значений в список с разделителями запятыми|`ParamArray`|  
|Массив любой длины (в том числе пустой массив)|`ParamArray`|  
  
## <a name="see-also"></a>См. также

- [Необязательные параметры](./optional-parameters.md)
- [Массивы параметров](./parameter-arrays.md)
- [Перегрузка процедур](./procedure-overloading.md)
- [Рекомендации по устранению неполадок](./troubleshooting-procedures.md)
- [Практическое руководство. Определение различных версий процедуры](./how-to-define-multiple-versions-of-a-procedure.md)
- [Практическое руководство. Вызов перегруженной процедуры](./how-to-call-an-overloaded-procedure.md)
- [Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр](./how-to-overload-a-procedure-that-takes-optional-parameters.md)
- [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)
- [Вопросы, связанные с перегрузкой процедур](./considerations-in-overloading-procedures.md)
- [Перегрузки](../../../../visual-basic/language-reference/modifiers/overloads.md)
- [Методы расширения](./extension-methods.md)
