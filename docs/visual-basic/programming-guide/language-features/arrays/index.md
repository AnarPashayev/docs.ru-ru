---
title: Массивы
ms.date: 12/06/2017
f1_keywords:
- vb.Array
helpviewer_keywords:
- arrays [Visual Basic]
- Visual Basic, arrays
ms.assetid: dbf29737-b589-4443-bee6-a27588d9c67e
ms.openlocfilehash: 5093f28f05c5b72294dce9a4e69723acafb31a9f
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2020
ms.locfileid: "84413095"
---
# <a name="arrays-in-visual-basic"></a><span data-ttu-id="23ab6-102">Массивы в Visual Basic</span><span class="sxs-lookup"><span data-stu-id="23ab6-102">Arrays in Visual Basic</span></span>

<span data-ttu-id="23ab6-103">Массив — это набор значений, которые являются терминами *элементы*, логически взаимосвязаны друг с другом.</span><span class="sxs-lookup"><span data-stu-id="23ab6-103">An array is a set of values, which are termed *elements*, that are logically related to each other.</span></span> <span data-ttu-id="23ab6-104">Например, массив может состоять из числа учащихся в словаре грамматики. Каждый элемент массива — это количество учащихся одного уровня.</span><span class="sxs-lookup"><span data-stu-id="23ab6-104">For example, an array may consist of the number of students in each grade in a grammar school; each element of the array is the number of students in a single grade.</span></span> <span data-ttu-id="23ab6-105">Аналогичным образом массив может состоять из оценок учащегося для класса. Каждый элемент массива является однозначным.</span><span class="sxs-lookup"><span data-stu-id="23ab6-105">Similarly, an array may consist of a student's grades for a class; each element of the array is a single grade.</span></span>

<span data-ttu-id="23ab6-106">Можно хранить отдельные переменные для хранения каждого из наших элементов данных.</span><span class="sxs-lookup"><span data-stu-id="23ab6-106">It is possible individual variables to store each of our data items.</span></span> <span data-ttu-id="23ab6-107">Например, если наше приложение анализирует оценки учащихся, можно использовать отдельную переменную для каждой категории учащегося, например `englishGrade1` , и `englishGrade2` т. д. Этот подход имеет три основных ограничения:</span><span class="sxs-lookup"><span data-stu-id="23ab6-107">For example, if our application analyzes student grades, we can use a separate variable for each student's grade, such as `englishGrade1`, `englishGrade2`, etc. This approach has three major limitations:</span></span>

- <span data-ttu-id="23ab6-108">Во время разработки мы должны знать, сколько оценок нужно обменять.</span><span class="sxs-lookup"><span data-stu-id="23ab6-108">We have to know at design time exactly how many grades we have to handle.</span></span>
- <span data-ttu-id="23ab6-109">Обработка большого количества оценок быстро оказывается неудобной.</span><span class="sxs-lookup"><span data-stu-id="23ab6-109">Handling large numbers of grades quickly becomes unwieldy.</span></span> <span data-ttu-id="23ab6-110">Это, в свою очередь, значительно повышает вероятность возникновения серьезных ошибок в приложении.</span><span class="sxs-lookup"><span data-stu-id="23ab6-110">This in turn makes an application much more likely to have serious bugs.</span></span>
- <span data-ttu-id="23ab6-111">Его сложно поддерживать.</span><span class="sxs-lookup"><span data-stu-id="23ab6-111">It is difficult to maintain.</span></span> <span data-ttu-id="23ab6-112">Для каждого нового добавляемого класса необходимо, чтобы приложение было изменено, перекомпилировано и развернуто.</span><span class="sxs-lookup"><span data-stu-id="23ab6-112">Each new grade that we add requires that the application be modified, recompiled, and redeployed.</span></span>

<span data-ttu-id="23ab6-113">Используя массив, можно ссылаться на эти связанные значения по одному и тому же имени и использовать число, которое называется *индексом* или *подиндексом* для обозначения отдельного элемента в зависимости от его позиции в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-113">By using an array, you can refer to these related values by the same name, and use a number that’s called an *index* or *subscript* to identify an individual element based on its position in the array.</span></span> <span data-ttu-id="23ab6-114">Индексы в диапазоне от 0 до 1 меньше, чем общее число элементов в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-114">The indexes of an array range from 0 to one less than the total number of elements in the array.</span></span> <span data-ttu-id="23ab6-115">При использовании синтаксиса Visual Basic для определения размера массива указывается его самый высокий индекс, а не общее число элементов в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-115">When you use Visual Basic syntax to define the size of an array, you specify its highest index, not the total number of elements in the array.</span></span> <span data-ttu-id="23ab6-116">Можно работать с массивом как с единицей, а возможность итерации элементов освобождает вас от необходимости знать, сколько элементов оно содержит во время разработки.</span><span class="sxs-lookup"><span data-stu-id="23ab6-116">You can work with the array as a unit, and the ability to iterate its elements frees you from needing to know exactly how many elements it contains at design time.</span></span>

<span data-ttu-id="23ab6-117">Несколько простых примеров перед подробным описанием:</span><span class="sxs-lookup"><span data-stu-id="23ab6-117">Some quick examples before explanation:</span></span>

```vb
' Declare a single-dimension array of 5 numbers.
Dim numbers(4) As Integer

' Declare a single-dimension array and set its 4 values.
Dim numbers = New Integer() {1, 2, 4, 8}

' Change the size of an existing array to 16 elements and retain the current values.
ReDim Preserve numbers(15)

' Redefine the size of an existing array and reset the values.
ReDim numbers(15)

' Declare a 6 x 6 multidimensional array.
Dim matrix(5, 5) As Double

' Declare a 4 x 3 multidimensional array and set array element values.
Dim matrix = New Integer(3, 2) {{1, 2, 3}, {2, 3, 4}, {3, 4, 5}, {4, 5, 6}}

' Declare a jagged array
Dim sales()() As Double = New Double(11)() {}
```

## <a name="array-elements-in-a-simple-array"></a><span data-ttu-id="23ab6-118">Элементы массива в простом массиве</span><span class="sxs-lookup"><span data-stu-id="23ab6-118">Array elements in a simple array</span></span>

<span data-ttu-id="23ab6-119">Давайте создадим массив с именем `students` для хранения числа учащихся в каждом классе в школе.</span><span class="sxs-lookup"><span data-stu-id="23ab6-119">Let's create an array named `students` to store the number of students in each grade in a grammar school.</span></span> <span data-ttu-id="23ab6-120">Индексы элементов находятся в диапазоне от 0 до 6.</span><span class="sxs-lookup"><span data-stu-id="23ab6-120">The indexes of the elements range from 0 through 6.</span></span> <span data-ttu-id="23ab6-121">Использование этого массива проще, чем объявление семи переменных.</span><span class="sxs-lookup"><span data-stu-id="23ab6-121">Using this array is simpler than declaring seven variables.</span></span>

<span data-ttu-id="23ab6-122">На следующем рисунке показан `students` массив.</span><span class="sxs-lookup"><span data-stu-id="23ab6-122">The following illustration shows the `students` array.</span></span> <span data-ttu-id="23ab6-123">Для каждого элемента массива:</span><span class="sxs-lookup"><span data-stu-id="23ab6-123">For each element of the array:</span></span>

- <span data-ttu-id="23ab6-124">индекс элемента представляет школьный класс (индекс 0 представляет детский сад);</span><span class="sxs-lookup"><span data-stu-id="23ab6-124">The index of the element represents the grade (index 0 represents kindergarten).</span></span>

- <span data-ttu-id="23ab6-125">значение, содержащееся в элементе, представляет число учеников в этом классе.</span><span class="sxs-lookup"><span data-stu-id="23ab6-125">The value that’s contained in the element represents the number of students in that grade.</span></span>

![Схема, показывающая массив чисел учащихся](./media/index/students-array-elements.gif)

<span data-ttu-id="23ab6-127">В следующем примере содержится код Visual Basic, который создает и использует массив:</span><span class="sxs-lookup"><span data-stu-id="23ab6-127">The following example contains the Visual Basic code that creates and uses the array:</span></span>

[!code-vb[simple-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/simple-array.vb)]

<span data-ttu-id="23ab6-128">В этом примере выполняется три вещи:</span><span class="sxs-lookup"><span data-stu-id="23ab6-128">The example does three things:</span></span>

- <span data-ttu-id="23ab6-129">Он объявляет `students` массив с семью элементами.</span><span class="sxs-lookup"><span data-stu-id="23ab6-129">It declares a `students` array with seven elements.</span></span> <span data-ttu-id="23ab6-130">Число `6` в объявлении массива указывает последний индекс в массиве; он меньше, чем число элементов в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-130">The number `6` in the array declaration indicates the last index in the array; it is one less than the number of elements in the array.</span></span>
- <span data-ttu-id="23ab6-131">Он присваивает значения каждому элементу в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-131">It assigns values to each element in the array.</span></span> <span data-ttu-id="23ab6-132">Доступ к элементам массива осуществляется с помощью имени массива, включая индекс отдельного элемента в круглых скобках.</span><span class="sxs-lookup"><span data-stu-id="23ab6-132">Array elements are accessed by using the array name and including the index of the individual element in parentheses.</span></span>
- <span data-ttu-id="23ab6-133">В нем перечисляются все значения массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-133">It lists each value of the array.</span></span> <span data-ttu-id="23ab6-134">В примере используется [`For`](../../../language-reference/statements/for-next-statement.md) оператор для доступа к каждому элементу массива по номеру индекса.</span><span class="sxs-lookup"><span data-stu-id="23ab6-134">The example uses a [`For`](../../../language-reference/statements/for-next-statement.md) statement to access each element of the array by its index number.</span></span>

<span data-ttu-id="23ab6-135">`students`Массив в предыдущем примере является одномерным массивом, так как он использует один индекс.</span><span class="sxs-lookup"><span data-stu-id="23ab6-135">The `students` array in the preceding example is a one-dimensional array because it uses one index.</span></span> <span data-ttu-id="23ab6-136">Массив, использующий более одного индекса или подстрочного, называется *многомерным*.</span><span class="sxs-lookup"><span data-stu-id="23ab6-136">An array that uses more than one index or subscript is called *multidimensional*.</span></span> <span data-ttu-id="23ab6-137">Дополнительные сведения см. в остальной части этой статьи и [в разделе измерения массива в Visual Basic](array-dimensions.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-137">For more information, see the rest of this article and [Array Dimensions in Visual Basic](array-dimensions.md).</span></span>

## <a name="creating-an-array"></a><span data-ttu-id="23ab6-138">Создание массива</span><span class="sxs-lookup"><span data-stu-id="23ab6-138">Creating an array</span></span>

<span data-ttu-id="23ab6-139">Размер массива можно определить несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="23ab6-139">You can define the size of an array in several ways:</span></span>

- <span data-ttu-id="23ab6-140">Размер можно указать при объявлении массива:</span><span class="sxs-lookup"><span data-stu-id="23ab6-140">You can specify the size when the array is declared:</span></span>

  [!code-vb[creating1](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#1)]

- <span data-ttu-id="23ab6-141">Можно использовать предложение, `New` чтобы указать размер массива при его создании:</span><span class="sxs-lookup"><span data-stu-id="23ab6-141">You can use a `New` clause to supply the size of an array when it’s created:</span></span>

  [!code-vb[creating2](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#2)]

<span data-ttu-id="23ab6-142">При наличии существующего массива его размер можно переопределить с помощью [`ReDim`](../../../language-reference/statements/redim-statement.md) инструкции.</span><span class="sxs-lookup"><span data-stu-id="23ab6-142">If you have an existing array, you can redefine its size by using the [`ReDim`](../../../language-reference/statements/redim-statement.md) statement.</span></span> <span data-ttu-id="23ab6-143">Можно указать, что `ReDim` инструкция сохранит значения в массиве, или можно указать, что он создает пустой массив.</span><span class="sxs-lookup"><span data-stu-id="23ab6-143">You can specify that the `ReDim` statement keep the values that are in the array, or you can specify that it create an empty array.</span></span> <span data-ttu-id="23ab6-144">В приведенном ниже примере показаны различные варианты использования оператора `ReDim` для изменения размера существующего массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-144">The following example shows different uses of the `ReDim` statement to modify the size of an existing array.</span></span>

[!code-vb[redimensioning](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#3)]

<span data-ttu-id="23ab6-145">Дополнительные сведения см. в описании [оператора ReDim](../../../language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-145">For more information, see the [ReDim Statement](../../../language-reference/statements/redim-statement.md).</span></span>

## <a name="storing-values-in-an-array"></a><span data-ttu-id="23ab6-146">Сохранение значений в массиве</span><span class="sxs-lookup"><span data-stu-id="23ab6-146">Storing values in an array</span></span>

<span data-ttu-id="23ab6-147">К любой позиции в массиве можно получить доступ, используя индекс типа `Integer`.</span><span class="sxs-lookup"><span data-stu-id="23ab6-147">You can access each location in an array by using an index of type `Integer`.</span></span> <span data-ttu-id="23ab6-148">Вы можете сохранять и извлекать значения массива, ссылаясь на позицию в нем с помощью индекса, заключенного в скобки.</span><span class="sxs-lookup"><span data-stu-id="23ab6-148">You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses.</span></span> <span data-ttu-id="23ab6-149">Индексы для многомерных массивов разделяются запятыми (,).</span><span class="sxs-lookup"><span data-stu-id="23ab6-149">Indexes for multidimensional arrays are separated by commas (,).</span></span> <span data-ttu-id="23ab6-150">Для каждого измерения массива требуется один индекс.</span><span class="sxs-lookup"><span data-stu-id="23ab6-150">You need one index for each array dimension.</span></span>

<span data-ttu-id="23ab6-151">В следующем примере показаны некоторые инструкции, которые хранят и извлекают значения в массивах.</span><span class="sxs-lookup"><span data-stu-id="23ab6-151">The following example shows some statements that store and retrieve values in arrays.</span></span>

[!code-vb[store-and-retrieve](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/store-and-retrieve.vb)]

## <a name="populating-an-array-with-array-literals"></a><span data-ttu-id="23ab6-152">Заполнение массива литералами массива</span><span class="sxs-lookup"><span data-stu-id="23ab6-152">Populating an array with array literals</span></span>

<span data-ttu-id="23ab6-153">С помощью литерала массива можно заполнить массив начальным набором значений во время его создания.</span><span class="sxs-lookup"><span data-stu-id="23ab6-153">By using an array literal, you can populate an array with an initial set of values at the same time that you create it.</span></span> <span data-ttu-id="23ab6-154">Литерал массива состоит из списка разделенных запятыми значений, заключенных в фигурные скобки (`{}`).</span><span class="sxs-lookup"><span data-stu-id="23ab6-154">An array literal consists of a list of comma-separated values that are enclosed in braces (`{}`).</span></span>

<span data-ttu-id="23ab6-155">При создании массива с помощью литерала массива можно либо указать тип массива, либо использовать определение типа для задания типа массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-155">When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type.</span></span> <span data-ttu-id="23ab6-156">В следующем примере показаны оба варианта.</span><span class="sxs-lookup"><span data-stu-id="23ab6-156">The following example shows both options.</span></span>

[!code-vb[create-with-literals](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#4)]

<span data-ttu-id="23ab6-157">При использовании вывода типа тип массива определяется *главным типом* в списке литеральных значений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-157">When you use type inference, the type of the array is determined by the *dominant type* in the list of literal values.</span></span> <span data-ttu-id="23ab6-158">Главным типом является тип, к которому могут расширяться все другие типы в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-158">The dominant type is the type to which all other types in the array can widen.</span></span> <span data-ttu-id="23ab6-159">Если такой уникальный тип нельзя определить, то главным будет тип, до которого можно сузить все другие типы массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-159">If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow.</span></span> <span data-ttu-id="23ab6-160">Если ни один из указанных уникальных типов нельзя определить, главным типом будет `Object`.</span><span class="sxs-lookup"><span data-stu-id="23ab6-160">If neither of these unique types can be determined, the dominant type is `Object`.</span></span> <span data-ttu-id="23ab6-161">Например, если список значений для литерала массива содержит значения типов `Integer`, `Long`и `Double`, результирующий массив будет иметь тип `Double`.</span><span class="sxs-lookup"><span data-stu-id="23ab6-161">For example, if the list of values that’s supplied to the array literal contains values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`.</span></span> <span data-ttu-id="23ab6-162">Поскольку `Integer` и `Long` расширяются только до `Double` , `Double` является главным типом.</span><span class="sxs-lookup"><span data-stu-id="23ab6-162">Because `Integer` and `Long` widen only to `Double`, `Double` is the dominant type.</span></span> <span data-ttu-id="23ab6-163">Для получения дополнительной информации см. [Widening and Narrowing Conversions](../data-types/widening-and-narrowing-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-163">For more information, see [Widening and Narrowing Conversions](../data-types/widening-and-narrowing-conversions.md).</span></span>

> [!NOTE]
> <span data-ttu-id="23ab6-164">Вывод типа можно использовать только для массивов, определенных как локальные переменные в члене типа.</span><span class="sxs-lookup"><span data-stu-id="23ab6-164">You can use type inference only for arrays that are defined as local variables in a type member.</span></span> <span data-ttu-id="23ab6-165">Если явное определение типа отсутствует, массивы, определенные с литералами массива на уровне класса, имеют тип `Object[]` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-165">If an explicit type definition is absent, arrays defined with array literals at the class level are of type `Object[]`.</span></span> <span data-ttu-id="23ab6-166">Дополнительные сведения см. в разделе [определение локального типа](../variables/local-type-inference.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-166">For more information, see [Local type inference](../variables/local-type-inference.md).</span></span>

<span data-ttu-id="23ab6-167">Обратите внимание, что в предыдущем примере определяется `values` как массив типа, `Double` хотя все литералы массива имеют тип `Integer` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-167">Note that the previous example defines `values` as an array of type `Double` even though all the array literals are of type `Integer`.</span></span> <span data-ttu-id="23ab6-168">Этот массив можно создать, так как значения в литерале массива могут расширяться до `Double` значений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-168">You can create this array because the values in the array literal can widen to `Double` values.</span></span>

<span data-ttu-id="23ab6-169">Можно также создать и заполнить многомерный массив с помощью *вложенных литералов массива*.</span><span class="sxs-lookup"><span data-stu-id="23ab6-169">You can also create and populate a multidimensional array by using *nested array literals*.</span></span> <span data-ttu-id="23ab6-170">Вложенные литералы массива должны иметь ряд измерений, которые соответствуют результирующему массиву.</span><span class="sxs-lookup"><span data-stu-id="23ab6-170">Nested array literals must have a number of dimensions that’s consistent with the resulting array.</span></span> <span data-ttu-id="23ab6-171">В следующем примере создается двухмерный массив целых чисел с помощью вложенных литералов массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-171">The following example creates a two-dimensional array of integers by using nested array literals.</span></span>

[!code-vb[nested-array-literals](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#5)]

<span data-ttu-id="23ab6-172">При использовании вложенных литералов массива для создания и заполнения массива возникает ошибка, если число элементов в литералах вложенных массивов не совпадает.</span><span class="sxs-lookup"><span data-stu-id="23ab6-172">When using nested array literals to create and populate an array, an error occurs if the number of elements in the nested array literals don't match.</span></span> <span data-ttu-id="23ab6-173">Ошибка также возникает, если вы явно объявили переменную массива так, чтобы число измерений не превышало литералы массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-173">An error also occurs if you explicitly declare the array variable to have a different number of dimensions than the array literals.</span></span>

<span data-ttu-id="23ab6-174">Точно так же, как и для одномерные массивов, при создании многомерного массива с вложенными литералами массива можно полагаться на определение типа.</span><span class="sxs-lookup"><span data-stu-id="23ab6-174">Just as you can for one-dimensional arrays, you can rely on type inference when creating a multidimensional array with nested array literals.</span></span> <span data-ttu-id="23ab6-175">Выводимый тип является главным типом для всех значений во всех литералах массива для всех уровней вложенности.</span><span class="sxs-lookup"><span data-stu-id="23ab6-175">The inferred type is the dominant type for all the values in all the array literals for all nesting level.</span></span> <span data-ttu-id="23ab6-176">В следующем примере создается двухмерный массив типа `Double[,]` из значений типа `Integer` и `Double` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-176">The following example creates a two-dimensional array of type `Double[,]` from values that are of type `Integer` and `Double`.</span></span>

[!code-vb[nested-type-inference](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#6)]

<span data-ttu-id="23ab6-177">Дополнительные примеры можно найти в статье [How to: Initialize an Array Variable in Visual Basic](how-to-initialize-an-array-variable.md) (Практическое руководство. Инициализация переменной массива в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="23ab6-177">For additional examples, see [How to: Initialize an Array Variable in Visual Basic](how-to-initialize-an-array-variable.md).</span></span>

## <a name="iterating-through-an-array"></a><span data-ttu-id="23ab6-178">Проход по массиву</span><span class="sxs-lookup"><span data-stu-id="23ab6-178">Iterating through an array</span></span>

<span data-ttu-id="23ab6-179">При итерации по массиву вы обращаетесь к каждому элементу в массиве от самого низкого индекса к верхнему или от самого низкого.</span><span class="sxs-lookup"><span data-stu-id="23ab6-179">When you iterate through an array, you access each element in the array from the lowest index to the highest or from the highest to the lowest.</span></span> <span data-ttu-id="23ab6-180">Как правило, используйте [для... Next](../../../language-reference/statements/for-next-statement.md) или [For Each... Оператор Next](../../../language-reference/statements/for-each-next-statement.md) для итерации элементов массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-180">Typically, use either the [For...Next Statement](../../../language-reference/statements/for-next-statement.md) or the [For Each...Next Statement](../../../language-reference/statements/for-each-next-statement.md) to iterate through the elements of an array.</span></span> <span data-ttu-id="23ab6-181">Если вы не знакомы с верхними границами массива, можно вызвать <xref:System.Array.GetUpperBound%2A?displayProperty=nameWithType> метод, чтобы получить наибольшее значение индекса.</span><span class="sxs-lookup"><span data-stu-id="23ab6-181">When you don't know the upper bounds of the array, you can call the <xref:System.Array.GetUpperBound%2A?displayProperty=nameWithType> method to get the highest value of the index.</span></span> <span data-ttu-id="23ab6-182">Хотя наименьшее значение индекса почти всегда равно 0, можно вызвать <xref:System.Array.GetLowerBound%2A?displayProperty=nameWithType> метод, чтобы получить наименьшее значение индекса.</span><span class="sxs-lookup"><span data-stu-id="23ab6-182">Although lowest index value is almost always 0, you can call the <xref:System.Array.GetLowerBound%2A?displayProperty=nameWithType> method to get the lowest value of the index.</span></span>

<span data-ttu-id="23ab6-183">В следующем примере выполняется итерация по одномерным массиву с помощью [`For...Next`](../../../language-reference/statements/for-next-statement.md) инструкции.</span><span class="sxs-lookup"><span data-stu-id="23ab6-183">The following example iterates through a one-dimensional array by using the [`For...Next`](../../../language-reference/statements/for-next-statement.md) statement.</span></span>

[!code-vb[iterate-one-dimensional-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/iterate1d.vb)]

<span data-ttu-id="23ab6-184">В следующем примере выполняется перебор многомерного массива с помощью [`For...Next`](../../../language-reference/statements/for-next-statement.md) инструкции.</span><span class="sxs-lookup"><span data-stu-id="23ab6-184">The following example iterates through a multidimensional array by using a [`For...Next`](../../../language-reference/statements/for-next-statement.md) statement.</span></span> <span data-ttu-id="23ab6-185">Метод <xref:System.Array.GetUpperBound%2A> имеет параметр, который определяет измерение.</span><span class="sxs-lookup"><span data-stu-id="23ab6-185">The <xref:System.Array.GetUpperBound%2A> method has a parameter that specifies the dimension.</span></span> <span data-ttu-id="23ab6-186">`GetUpperBound(0)`Возвращает самый верхний индекс первого измерения и `GetUpperBound(1)` возвращает наибольший индекс второго измерения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-186">`GetUpperBound(0)` returns the highest index of the first dimension, and `GetUpperBound(1)` returns the highest index of the second dimension.</span></span>

[!code-vb[iterate-two-dimensional-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/iterate2d.vb)]

<span data-ttu-id="23ab6-187">В следующем примере используется объект [For Each... Оператор Next](../../../language-reference/statements/for-each-next-statement.md)для итерации одномерного массива и двумерного массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-187">The following example uses a [For Each...Next Statement](../../../language-reference/statements/for-each-next-statement.md)to iterate through a one-dimensional array and a two-dimensional array.</span></span>

[!code-vb[iterate-for-each-next](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/iterate-for-each-next.vb)]

## <a name="array-size"></a><span data-ttu-id="23ab6-188">Размер массива</span><span class="sxs-lookup"><span data-stu-id="23ab6-188">Array size</span></span>

<span data-ttu-id="23ab6-189">Размер массива является произведением длин всех его измерений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-189">The size of an array is the product of the lengths of all its dimensions.</span></span> <span data-ttu-id="23ab6-190">Он представляет собой общее число элементов, в данный момент содержащихся в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-190">It represents the total number of elements currently contained in the array.</span></span>  <span data-ttu-id="23ab6-191">Например, в следующем примере объявляется двухмерный массив с четырьмя элементами в каждом измерении.</span><span class="sxs-lookup"><span data-stu-id="23ab6-191">For example, the following example declares a 2-dimensional array with four elements in each dimension.</span></span> <span data-ttu-id="23ab6-192">Как видно из выходных данных в примере, размер массива равен 16 (или (3 + 1) \* (3 + 1).</span><span class="sxs-lookup"><span data-stu-id="23ab6-192">As the output from the example shows, the array's size is 16 (or (3 + 1) \* (3 + 1).</span></span>

[!code-vb[array-size](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-size.vb)]

> [!NOTE]
> <span data-ttu-id="23ab6-193">Это обсуждение размера массива не применяется к массивам зубчатых размеров.</span><span class="sxs-lookup"><span data-stu-id="23ab6-193">This discussion of array size does not apply to jagged arrays.</span></span> <span data-ttu-id="23ab6-194">Сведения о массивах немассивности и определении размера массива массивов см [. в разделе массива массивов](#jagged-arrays) .</span><span class="sxs-lookup"><span data-stu-id="23ab6-194">For information on jagged arrays and determining the size of a jagged array, see the [Jagged arrays](#jagged-arrays) section.</span></span>

<span data-ttu-id="23ab6-195">Размер массива можно определить с помощью свойства <xref:System.Array.Length%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="23ab6-195">You can find the size of an array by using the <xref:System.Array.Length%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="23ab6-196">Длину каждого измерения многомерного массива можно узнать с помощью <xref:System.Array.GetLength%2A?displayProperty=nameWithType> метода.</span><span class="sxs-lookup"><span data-stu-id="23ab6-196">You can find the length of each dimension of a multidimensional array by using the <xref:System.Array.GetLength%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="23ab6-197">Можно изменить размер переменной массива, назначив ей новый объект массива или используя инструкцию [ `ReDim` инструкции](../../../language-reference/statements/redim-statement.md) .</span><span class="sxs-lookup"><span data-stu-id="23ab6-197">You can resize an array variable by assigning a new array object to it or by using the [`ReDim` Statement](../../../language-reference/statements/redim-statement.md) statement.</span></span> <span data-ttu-id="23ab6-198">В следующем примере оператор используется `ReDim` для изменения массива 100-element на массив 51-element.</span><span class="sxs-lookup"><span data-stu-id="23ab6-198">The following example uses the `ReDim` statement to change a 100-element array to a 51-element array.</span></span>

[!code-vb[resize-an-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-size2.vb)]

<span data-ttu-id="23ab6-199">Существует ряд особенностей, о которых следует помнить при работе с размером массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-199">There are several things to keep in mind when dealing with the size of an array.</span></span>

|||
|---|---|
|<span data-ttu-id="23ab6-200">Длина измерения</span><span class="sxs-lookup"><span data-stu-id="23ab6-200">Dimension Length</span></span>|<span data-ttu-id="23ab6-201">Индекс каждого измерения основан на 0, что означает, что он находится в диапазоне от 0 до верхней границы.</span><span class="sxs-lookup"><span data-stu-id="23ab6-201">The index of each dimension is 0-based, which means it ranges from 0 to its upper bound.</span></span> <span data-ttu-id="23ab6-202">Таким образом, длина данного измерения больше, чем объявленная верхняя граница этого измерения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-202">Therefore, the length of a given dimension is one greater than the declared upper bound of that dimension.</span></span>|
|<span data-ttu-id="23ab6-203">Ограничения длины</span><span class="sxs-lookup"><span data-stu-id="23ab6-203">Length Limits</span></span>|<span data-ttu-id="23ab6-204">Длина каждого измерения массива ограничена максимальным значением `Integer` типа данных, которое равно <xref:System.Int32.MaxValue?displayProperty=nameWithType> или (2 ^ 31)-1.</span><span class="sxs-lookup"><span data-stu-id="23ab6-204">The length of every dimension of an array is limited to the maximum value of the `Integer` data type, which is <xref:System.Int32.MaxValue?displayProperty=nameWithType> or (2 ^ 31) - 1.</span></span> <span data-ttu-id="23ab6-205">Однако общий размер массива также ограничен доступной памятью в системе.</span><span class="sxs-lookup"><span data-stu-id="23ab6-205">However, the total size of an array is also limited by the memory available on your system.</span></span> <span data-ttu-id="23ab6-206">При попытке инициализировать массив, размер которого превышает объем доступной памяти, среда выполнения создает исключение <xref:System.OutOfMemoryException> .</span><span class="sxs-lookup"><span data-stu-id="23ab6-206">If you attempt to initialize an array that exceeds the amount of available memory, the runtime throws an <xref:System.OutOfMemoryException>.</span></span>|
|<span data-ttu-id="23ab6-207">Размер и размер элемента</span><span class="sxs-lookup"><span data-stu-id="23ab6-207">Size and Element Size</span></span>|<span data-ttu-id="23ab6-208">Размер массива не зависит от типа его элементов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-208">An array's size is independent of the data type of its elements.</span></span> <span data-ttu-id="23ab6-209">Размер всегда представляет общее число элементов, а не число байтов, используемых в памяти.</span><span class="sxs-lookup"><span data-stu-id="23ab6-209">The size always represents the total number of elements, not the number of bytes that they consume in memory.</span></span>|
|<span data-ttu-id="23ab6-210">Затраты памяти</span><span class="sxs-lookup"><span data-stu-id="23ab6-210">Memory Consumption</span></span>|<span data-ttu-id="23ab6-211">Небезопасно делать какие-либо предположения относительно способа хранения массива в памяти.</span><span class="sxs-lookup"><span data-stu-id="23ab6-211">It is not safe to make any assumptions regarding how an array is stored in memory.</span></span> <span data-ttu-id="23ab6-212">Хранение зависит от разрядности платформы, поэтому один и тот же массив может занимать больше памяти в 64-разрядных системах, чем в 32-разрядных.</span><span class="sxs-lookup"><span data-stu-id="23ab6-212">Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system.</span></span> <span data-ttu-id="23ab6-213">В зависимости от конфигурации системы при инициализации массива среда CLR может использовать такие способы хранения, как упаковка элементов максимально близко друг к другу или выравнивание всех элементов по естественным аппаратным границам памяти.</span><span class="sxs-lookup"><span data-stu-id="23ab6-213">Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries.</span></span> <span data-ttu-id="23ab6-214">Кроме того, массив нуждается в хранении служебной информации, и размер этой информации возрастает при добавлении каждого измерения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-214">Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.</span></span>|

## <a name="the-array-type"></a><span data-ttu-id="23ab6-215">Тип массива</span><span class="sxs-lookup"><span data-stu-id="23ab6-215">The array type</span></span>

<span data-ttu-id="23ab6-216">Каждый массив имеет тип данных, который отличается от типа данных его элементов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-216">Every array has a data type, which differs from the data type of its elements.</span></span> <span data-ttu-id="23ab6-217">Не существует единого типа данных, подходящего для всех массивов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-217">There is no single data type for all arrays.</span></span> <span data-ttu-id="23ab6-218">Вместо этого тип данных массива определяется числом измерений ( *рангом*) массива и типом данных его элементов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-218">Instead, the data type of an array is determined by the number of dimensions, or *rank*, of the array, and the data type of the elements in the array.</span></span> <span data-ttu-id="23ab6-219">Две переменные массива имеют один и тот же тип данных, только если они имеют одинаковый ранг и их элементы имеют один и тот же тип данных.</span><span class="sxs-lookup"><span data-stu-id="23ab6-219">Two array variables are of the same data type only when they have the same rank and their elements have the same data type.</span></span> <span data-ttu-id="23ab6-220">Длины измерений массива не влияют на тип данных массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-220">The lengths of the dimensions of an array do not influence the array data type.</span></span>

<span data-ttu-id="23ab6-221">Каждый массив наследуется от класса <xref:System.Array?displayProperty=nameWithType>, и вы можете объявить переменную типа `Array`, но не можете создать массив типа `Array`.</span><span class="sxs-lookup"><span data-stu-id="23ab6-221">Every array inherits from the <xref:System.Array?displayProperty=nameWithType> class, and you can declare a variable to be of type `Array`, but you cannot create an array of type `Array`.</span></span> <span data-ttu-id="23ab6-222">Например, несмотря на то, что следующий код объявляет `arr` переменную как тип `Array` и вызывает <xref:System.Array.CreateInstance%2A?displayProperty=nameWithType> метод для создания экземпляра массива, тип массива доказывается на Object [].</span><span class="sxs-lookup"><span data-stu-id="23ab6-222">For example, although the following code declares the `arr` variable to be of type `Array` and calls the <xref:System.Array.CreateInstance%2A?displayProperty=nameWithType> method to instantiate the array, the array's type proves to be Object[].</span></span>

[!code-vb[array-class](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-class.vb)]

<span data-ttu-id="23ab6-223">Кроме того, [оператор ReDim`Array` не может работать с переменной, объявленной с типом ](../../../language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-223">Also, the [ReDim Statement](../../../language-reference/statements/redim-statement.md) cannot operate on a variable declared as type `Array`.</span></span> <span data-ttu-id="23ab6-224">По этим причинам, а для обеспечения безопасности типа рекомендуется объявлять каждый массив как конкретный тип.</span><span class="sxs-lookup"><span data-stu-id="23ab6-224">For these reasons, and for type safety, it is advisable to declare every array as a specific type.</span></span>

<span data-ttu-id="23ab6-225">Выяснить тип данных массива или его элементов можно несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="23ab6-225">You can find out the data type of either an array or its elements in several ways.</span></span>

- <span data-ttu-id="23ab6-226">Можно вызвать <xref:System.Object.GetType%2A> метод для переменной, чтобы получить <xref:System.Type> объект, представляющий тип переменной во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-226">You can call the <xref:System.Object.GetType%2A> method on the variable to get a <xref:System.Type> object that represents the run-time type of the variable.</span></span> <span data-ttu-id="23ab6-227">Объект <xref:System.Type> содержит подробные сведения в своих свойствах и методах.</span><span class="sxs-lookup"><span data-stu-id="23ab6-227">The <xref:System.Type> object holds extensive information in its properties and methods.</span></span>
- <span data-ttu-id="23ab6-228">Можно передать переменную в функцию, <xref:Microsoft.VisualBasic.Information.TypeName%2A> чтобы получить `String` с именем типа времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-228">You can pass the variable to the <xref:Microsoft.VisualBasic.Information.TypeName%2A> function to get a `String` with the name of run-time type.</span></span>

<span data-ttu-id="23ab6-229">В следующем примере `GetType` `TypeName` для определения типа массива вызывается метод и функция.</span><span class="sxs-lookup"><span data-stu-id="23ab6-229">The following example calls the both the `GetType` method and the `TypeName` function to determine the type of an array.</span></span> <span data-ttu-id="23ab6-230">Тип массива — `Byte(,)` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-230">The array type is `Byte(,)`.</span></span> <span data-ttu-id="23ab6-231">Обратите внимание, что <xref:System.Type.BaseType%2A?displayProperty=nameWithType> свойство также указывает, что базовый тип массива байтов является <xref:System.Array> классом.</span><span class="sxs-lookup"><span data-stu-id="23ab6-231">Note that the <xref:System.Type.BaseType%2A?displayProperty=nameWithType> property also indicates that the base type of the byte array is the <xref:System.Array> class.</span></span>

[!code-vb[array-type](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-type.vb)]

## <a name="arrays-as-return-values-and-parameters"></a><span data-ttu-id="23ab6-232">Массивы как возвращаемые значения и параметры</span><span class="sxs-lookup"><span data-stu-id="23ab6-232">Arrays as return values and parameters</span></span>

<span data-ttu-id="23ab6-233">Чтобы вернуть массив из процедуры `Function`, укажите тип данных массива и число измерений в качестве типа возвращаемого значения [оператора Function](../../../language-reference/statements/function-statement.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-233">To return an array from a `Function` procedure, specify the array data type and the number of dimensions as the return type of the [Function Statement](../../../language-reference/statements/function-statement.md).</span></span> <span data-ttu-id="23ab6-234">Внутри функции объявите локальную переменную массива с тем же числом измерений и типом данных.</span><span class="sxs-lookup"><span data-stu-id="23ab6-234">Within the function, declare a local array variable with same data type and number of dimensions.</span></span> <span data-ttu-id="23ab6-235">В [оператор Return](../../../language-reference/statements/return-statement.md) включите локальную переменную массива без скобок.</span><span class="sxs-lookup"><span data-stu-id="23ab6-235">In the [Return Statement](../../../language-reference/statements/return-statement.md), include the local array variable without parentheses.</span></span>

<span data-ttu-id="23ab6-236">Чтобы задать массив в качестве параметра процедуры `Sub` или `Function` , определите параметр как массив с указанными типом данных и количеством измерений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-236">To specify an array as a parameter to a `Sub` or `Function` procedure, define the parameter as an array with a specified data type and number of dimensions.</span></span> <span data-ttu-id="23ab6-237">В вызове процедуры передайте переменную массива с тем же типом данных и количеством измерений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-237">In the call to the procedure, pass an array variable with the same data type and number of dimensions.</span></span>

<span data-ttu-id="23ab6-238">В следующем примере `GetNumbers` функция возвращает `Integer()` одномерный массив типа `Integer` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-238">In the following example, the `GetNumbers` function returns an `Integer()`, a one-dimensional array of type `Integer`.</span></span> <span data-ttu-id="23ab6-239">Процедура `ShowNumbers` принимает аргумент `Integer()` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-239">The `ShowNumbers` procedure accepts an `Integer()` argument.</span></span>

[!code-vb[return-value-and-params](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/return-values-and-params.vb)]

<span data-ttu-id="23ab6-240">В следующем примере `GetNumbersMultiDim` функция возвращает `Integer(,)` , двухмерный массив типа `Integer` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-240">In the following example, the `GetNumbersMultiDim` function returns an `Integer(,)`, a two-dimensional array of type `Integer`.</span></span>  <span data-ttu-id="23ab6-241">Процедура `ShowNumbersMultiDim` принимает аргумент `Integer(,)` .</span><span class="sxs-lookup"><span data-stu-id="23ab6-241">The `ShowNumbersMultiDim` procedure accepts an `Integer(,)` argument.</span></span>

[!code-vb[multidimensional-return-value](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/return-values-and-params-2d.vb)]

## <a name="jagged-arrays"></a><span data-ttu-id="23ab6-242">Массивы массивов</span><span class="sxs-lookup"><span data-stu-id="23ab6-242">Jagged arrays</span></span>

<span data-ttu-id="23ab6-243">Иногда структура данных в приложении является двухмерной, но не прямоугольной.</span><span class="sxs-lookup"><span data-stu-id="23ab6-243">Sometimes the data structure in your application is two-dimensional but not rectangular.</span></span> <span data-ttu-id="23ab6-244">Например, массив можно использовать для хранения данных о высокой температуре каждого дня месяца.</span><span class="sxs-lookup"><span data-stu-id="23ab6-244">For example, you might use an array to store data about the high temperature of each day of the month.</span></span> <span data-ttu-id="23ab6-245">Первое измерение массива представляет месяц, но второе измерение представляет количество дней, а число дней в месяце является неравномерным.</span><span class="sxs-lookup"><span data-stu-id="23ab6-245">The first dimension of the array represents the month, but the second dimension represents the number of days, and the number of days in a month is not uniform.</span></span> <span data-ttu-id="23ab6-246">Немассивный *массив*, который также называется *массивом массивов*, предназначен для таких сценариев.</span><span class="sxs-lookup"><span data-stu-id="23ab6-246">A *jagged array*, which is also called an *array of arrays*, is designed for such scenarios.</span></span> <span data-ttu-id="23ab6-247">Немассивный массив — это массив, элементы которого также являются массивами.</span><span class="sxs-lookup"><span data-stu-id="23ab6-247">A jagged array is an array whose elements are also arrays.</span></span> <span data-ttu-id="23ab6-248">Массив массивов и каждый элемент в нем могут иметь одно или несколько измерений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-248">A jagged array and each element in a jagged array can have one or more dimensions.</span></span>

<span data-ttu-id="23ab6-249">В следующем примере используется массив месяцев, каждый элемент которого является массивом дней.</span><span class="sxs-lookup"><span data-stu-id="23ab6-249">The following example uses an array of months, each element of which is an array of days.</span></span> <span data-ttu-id="23ab6-250">В примере используется массив массива, поскольку разные месяцы имеют разное количество дней.</span><span class="sxs-lookup"><span data-stu-id="23ab6-250">The example uses a jagged array because different months have different numbers of days.</span></span>  <span data-ttu-id="23ab6-251">В примере показано создание массива массивов, присвоение ему значений, а также извлечение и отображение его значений.</span><span class="sxs-lookup"><span data-stu-id="23ab6-251">The example shows how to create a jagged array, assign values to it, and retrieve and display its values.</span></span>

[!code-vb[jagged-arrays](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/jagged.vb)]

<span data-ttu-id="23ab6-252">В предыдущем примере значения массива массивов назначаются для элемента в отдельности с помощью `For...Next` цикла.</span><span class="sxs-lookup"><span data-stu-id="23ab6-252">The previous example assigns values to the jagged array on an element-by-element basis by using a `For...Next` loop.</span></span> <span data-ttu-id="23ab6-253">Можно также присваивать значения элементам массива массивов с помощью вложенных литералов массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-253">You can also assign values to the elements of a jagged array by using nested array literals.</span></span> <span data-ttu-id="23ab6-254">Однако попытка использовать вложенные литералы массива (например, `Dim valuesjagged = {{1, 2}, {2, 3, 4}}` ) приводит к возникновению ошибки компилятора [BC30568](../../../misc/bc30568.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-254">However, the attempt to use nested array literals (for example, `Dim valuesjagged = {{1, 2}, {2, 3, 4}}`) generates compiler error [BC30568](../../../misc/bc30568.md).</span></span> <span data-ttu-id="23ab6-255">Чтобы исправить ошибку, заключите внутренние литералы массива в круглые скобки.</span><span class="sxs-lookup"><span data-stu-id="23ab6-255">To correct the error, enclose the inner array literals in parentheses.</span></span> <span data-ttu-id="23ab6-256">Круглые скобки принудительно оценивают выражение литерала массива, а результирующие значения используются с литералом внешнего массива, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="23ab6-256">The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following example shows.</span></span>

[!code-vb[jagged-array-initialization](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/jagged-assign.vb)]

<span data-ttu-id="23ab6-257">Массив массива является одномерным массивом, элементы которого содержат массивы.</span><span class="sxs-lookup"><span data-stu-id="23ab6-257">A jagged array is a one-dimensional array whose elements contain arrays.</span></span> <span data-ttu-id="23ab6-258">Таким образом, <xref:System.Array.Length%2A?displayProperty=nameWithType> свойство и `Array.GetLength(0)` метод возвращают количество элементов в одномерном массиве и выдают исключение, `Array.GetLength(1)` <xref:System.IndexOutOfRangeException> так как массив массива не является многомерным.</span><span class="sxs-lookup"><span data-stu-id="23ab6-258">Therefore, the <xref:System.Array.Length%2A?displayProperty=nameWithType> property and the `Array.GetLength(0)` method return the number of elements in the one-dimensional array, and `Array.GetLength(1)` throws an <xref:System.IndexOutOfRangeException> because a jagged array is not multidimensional.</span></span> <span data-ttu-id="23ab6-259">Число элементов в каждом подмассиве определяется путем извлечения значения свойства каждого подмассива <xref:System.Array.Length%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="23ab6-259">You determine the number of elements in each subarray by retrieving the value of each subarray's <xref:System.Array.Length%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="23ab6-260">В следующем примере показано, как определить количество элементов массива массивов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-260">The following example illustrates how to determine the number of elements in a jagged array.</span></span>

[!code-vb[jagged-array-size](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/jagged-length.vb)]

## <a name="zero-length-arrays"></a><span data-ttu-id="23ab6-261">Массивы нулевой длины</span><span class="sxs-lookup"><span data-stu-id="23ab6-261">Zero-length arrays</span></span>

<span data-ttu-id="23ab6-262">Visual Basic отличает неинициализированный массив (массив, значение которого равно `Nothing` ) и *массив нулевой длины* или пустой массив (массив без элементов). Неинициализированный массив — это тот, который не был измерен или имел присвоенные ему значения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-262">Visual Basic differentiates between a uninitialized array (an array whose value is `Nothing`) and a *zero-length array* or empty array (an array that has no elements.) An uninitialized array is one that has not been dimensioned or had any values assigned to it.</span></span> <span data-ttu-id="23ab6-263">Пример:</span><span class="sxs-lookup"><span data-stu-id="23ab6-263">For example:</span></span>

```vb
Dim arr() As String
```

<span data-ttu-id="23ab6-264">Массив нулевой длины объявляется с измерением-1.</span><span class="sxs-lookup"><span data-stu-id="23ab6-264">A zero-length array is declared with a dimension of -1.</span></span> <span data-ttu-id="23ab6-265">Пример:</span><span class="sxs-lookup"><span data-stu-id="23ab6-265">For example:</span></span>

```vb
Dim arrZ(-1) As String
```

<span data-ttu-id="23ab6-266">Массив нулевой длины может потребоваться создать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="23ab6-266">You might need to create a zero-length array under the following circumstances:</span></span>

- <span data-ttu-id="23ab6-267">Без риска возникновения <xref:System.NullReferenceException> исключения код должен обращаться к членам <xref:System.Array> класса, например <xref:System.Array.Length%2A> или <xref:System.Array.Rank%2A> , или вызвать функцию Visual Basic, например <xref:Microsoft.VisualBasic.Information.UBound%2A> .</span><span class="sxs-lookup"><span data-stu-id="23ab6-267">Without risking a <xref:System.NullReferenceException> exception, your code must access members of the <xref:System.Array> class, such as <xref:System.Array.Length%2A> or <xref:System.Array.Rank%2A>, or call a Visual Basic function such as <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span></span>

- <span data-ttu-id="23ab6-268">Вы хотите, чтобы ваш код был простым, не требуя проверки в `Nothing` качестве специального случая.</span><span class="sxs-lookup"><span data-stu-id="23ab6-268">You want to keep your code simple by not having to check for `Nothing` as a special case.</span></span>

- <span data-ttu-id="23ab6-269">Код взаимодействует с интерфейсом API, который требует передачи массива нулевой длины в одну или несколько процедур или возвращает массив нулевой длины из одной или нескольких процедур.</span><span class="sxs-lookup"><span data-stu-id="23ab6-269">Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.</span></span>

## <a name="splitting-an-array"></a><span data-ttu-id="23ab6-270">Разделение массива</span><span class="sxs-lookup"><span data-stu-id="23ab6-270">Splitting an array</span></span>

<span data-ttu-id="23ab6-271">В некоторых случаях может потребоваться разделить один массив на несколько массивов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-271">In some cases, you may need to split a single array into multiple arrays.</span></span> <span data-ttu-id="23ab6-272">Это включает определение точки или точек, в которых массив должен быть разделен, а затем спиттинг массив в два или более отдельных массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-272">This involves identifying the point or points at which the array is to be split, and then spitting the array into two or more separate arrays.</span></span>

> [!NOTE]
> <span data-ttu-id="23ab6-273">В этом разделе не рассматривается разделение одной строки на массив строк, основанный на каком-либо разделителе.</span><span class="sxs-lookup"><span data-stu-id="23ab6-273">This section does not discuss splitting a single string into a string array based on some delimiter.</span></span> <span data-ttu-id="23ab6-274">Сведения о разбиении строки см. в описании <xref:System.String.Split%2A?displayProperty=nameWithType> метода.</span><span class="sxs-lookup"><span data-stu-id="23ab6-274">For information on splitting a string, see the <xref:System.String.Split%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="23ab6-275">Ниже приведены наиболее распространенные критерии разделения массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-275">The most common criteria for splitting an array are:</span></span>

- <span data-ttu-id="23ab6-276">Количество элементов в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-276">The number of elements in the array.</span></span> <span data-ttu-id="23ab6-277">Например, может потребоваться разделить массив больше, чем заданное число элементов, на несколько приблизительно равных частей.</span><span class="sxs-lookup"><span data-stu-id="23ab6-277">For example, you might want to split an array of more than a specified number of elements into a number of approximately equal parts.</span></span> <span data-ttu-id="23ab6-278">Для этой цели можно использовать значение, возвращаемое <xref:System.Array.Length%2A?displayProperty=nameWithType> <xref:System.Array.GetLength%2A?displayProperty=nameWithType> методом или.</span><span class="sxs-lookup"><span data-stu-id="23ab6-278">For this purpose, you can use the value returned by either the <xref:System.Array.Length%2A?displayProperty=nameWithType> or <xref:System.Array.GetLength%2A?displayProperty=nameWithType> method.</span></span>

- <span data-ttu-id="23ab6-279">Значение элемента, которое служит разделителем, указывающим место разделения массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-279">The value of an element, which serves as a delimiter that indicates where the array should be split.</span></span> <span data-ttu-id="23ab6-280">Можно выполнить поиск определенного значения, вызвав <xref:System.Array.FindIndex%2A?displayProperty=nameWithType> <xref:System.Array.FindLastIndex%2A?displayProperty=nameWithType> методы и.</span><span class="sxs-lookup"><span data-stu-id="23ab6-280">You can search for a specific value by calling the <xref:System.Array.FindIndex%2A?displayProperty=nameWithType> and <xref:System.Array.FindLastIndex%2A?displayProperty=nameWithType> methods.</span></span>

<span data-ttu-id="23ab6-281">После определения индекса или индексов, на которых массив должен быть разделен, можно создать отдельные массивы, вызвав <xref:System.Array.Copy%2A?displayProperty=nameWithType> метод.</span><span class="sxs-lookup"><span data-stu-id="23ab6-281">Once you've determined the index or indexes at which the array should be split, you can then create the individual arrays by calling the <xref:System.Array.Copy%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="23ab6-282">В следующем примере массив разбивается на два массива приблизительно равного размера.</span><span class="sxs-lookup"><span data-stu-id="23ab6-282">The following example splits an array into two arrays of approximately equal size.</span></span> <span data-ttu-id="23ab6-283">(Если общее число элементов массива нечетное, первый массив содержит еще один элемент, чем второй.)</span><span class="sxs-lookup"><span data-stu-id="23ab6-283">(If the total number of array elements is odd, the first array has one more element than the second.)</span></span>

[!code-vb[splitting-an-array-by-length](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/split1.vb)]

<span data-ttu-id="23ab6-284">В следующем примере массив строк разбивается на два массива на основе наличия элемента, значение которого равно "zzz", которое служит разделителем массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-284">The following example splits a string array into two arrays based on the presence of an element whose value is "zzz", which serves as the array delimiter.</span></span> <span data-ttu-id="23ab6-285">Новые массивы не включают элемент, содержащий разделитель.</span><span class="sxs-lookup"><span data-stu-id="23ab6-285">The new arrays do not include the element that contains the delimiter.</span></span>

[!code-vb[splitting-an-array-by-delimiter](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/split2.vb)]

## <a name="joining-arrays"></a><span data-ttu-id="23ab6-286">Соединение массивов</span><span class="sxs-lookup"><span data-stu-id="23ab6-286">Joining arrays</span></span>

<span data-ttu-id="23ab6-287">Можно также объединить несколько массивов в один массив большего размера.</span><span class="sxs-lookup"><span data-stu-id="23ab6-287">You can also combine a number of arrays into a single larger array.</span></span> <span data-ttu-id="23ab6-288">Для этого также используется <xref:System.Array.Copy%2A?displayProperty=nameWithType> метод.</span><span class="sxs-lookup"><span data-stu-id="23ab6-288">To do this, you also use the <xref:System.Array.Copy%2A?displayProperty=nameWithType> method.</span></span>

> [!NOTE]
> <span data-ttu-id="23ab6-289">В этом разделе не обсуждается объединение массива строк в одну строку.</span><span class="sxs-lookup"><span data-stu-id="23ab6-289">This section does not discuss joining a string array into a single string.</span></span> <span data-ttu-id="23ab6-290">Сведения о присоединении массива строк см. в описании <xref:System.String.Join%2A?displayProperty=nameWithType> метода.</span><span class="sxs-lookup"><span data-stu-id="23ab6-290">For information on joining a string array, see the <xref:System.String.Join%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="23ab6-291">Перед копированием элементов каждого массива в новый массив необходимо убедиться, что массив был инициализирован так, чтобы он был достаточно большим для размещения нового массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-291">Before copying the elements of each array into the new array, you must first ensure that you have initialized the array so that it is large enough to accommodate the new array.</span></span> <span data-ttu-id="23ab6-292">Это можно сделать одним из двух способов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-292">You can do this in one of two ways:</span></span>

- <span data-ttu-id="23ab6-293">Используйте [`ReDim Preserve`](../../../language-reference/statements/redim-statement.md) инструкцию для динамического расширения массива перед добавлением в него новых элементов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-293">Use the [`ReDim Preserve`](../../../language-reference/statements/redim-statement.md) statement to dynamically expand the array before adding new elements to it.</span></span> <span data-ttu-id="23ab6-294">Это самый простой способ, но это может привести к снижению производительности и чрезмерному потреблению памяти при копировании больших массивов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-294">This is the easiest technique, but it can result in performance degradation and excessive memory consumption when you are copying large arrays.</span></span>
- <span data-ttu-id="23ab6-295">Вычислите общее число элементов, необходимых для нового большого массива, а затем добавьте в него элементы каждого исходного массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-295">Calculate the total number of elements needed for the new large array, then add the elements of each source array to it.</span></span>

<span data-ttu-id="23ab6-296">В следующем примере используется второй подход к добавлению четырех массивов с десятью элементами в один массив.</span><span class="sxs-lookup"><span data-stu-id="23ab6-296">The following example uses the second approach to add four arrays with ten elements each to a single array.</span></span>

[!code-vb[joining-an-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/join.vb)]

<span data-ttu-id="23ab6-297">Поскольку в этом случае исходные массивы невелики, можно также динамически расширять массив по мере добавления элементов каждого нового массива в него.</span><span class="sxs-lookup"><span data-stu-id="23ab6-297">Since in this case the source arrays are all small, we can also dynamically expand the array as we add the elements of each new array to it.</span></span> <span data-ttu-id="23ab6-298">Эту задачу решает следующий код.</span><span class="sxs-lookup"><span data-stu-id="23ab6-298">The following example does that.</span></span>

[!code-vb[joining-an-array-dynamically](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/join2.vb)]

## <a name="collections-as-an-alternative-to-arrays"></a><span data-ttu-id="23ab6-299">Коллекции в качестве альтернативы массивам</span><span class="sxs-lookup"><span data-stu-id="23ab6-299">Collections as an alternative to arrays</span></span>

<span data-ttu-id="23ab6-300">Массивы удобнее всего использовать для создания фиксированного числа строго типизированных объектов и работы с ними.</span><span class="sxs-lookup"><span data-stu-id="23ab6-300">Arrays are most useful for creating and working with a fixed number of strongly typed objects.</span></span> <span data-ttu-id="23ab6-301">Коллекции предоставляют более гибкий способ работы с группами объектов.</span><span class="sxs-lookup"><span data-stu-id="23ab6-301">Collections provide a more flexible way to work with groups of objects.</span></span> <span data-ttu-id="23ab6-302">В отличие от массивов, требующих явного изменения размера массива [ `ReDim` инструкцией](../../../language-reference/statements/redim-statement.md), коллекции растут и сжимаются динамически в соответствии с потребностями приложения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-302">Unlike arrays, which require that you explicitly change the size of an array with the [`ReDim` Statement](../../../language-reference/statements/redim-statement.md), collections grow and shrink dynamically as the needs of an application change.</span></span>

<span data-ttu-id="23ab6-303">При использовании `ReDim` для переизмерения массива Visual Basic создает новый массив и освобождает предыдущий.</span><span class="sxs-lookup"><span data-stu-id="23ab6-303">When you use `ReDim` to redimension an array, Visual Basic creates a new array and releases the previous one.</span></span> <span data-ttu-id="23ab6-304">Это занимает время выполнения.</span><span class="sxs-lookup"><span data-stu-id="23ab6-304">This takes execution time.</span></span> <span data-ttu-id="23ab6-305">Таким образом, если количество элементов, с которыми вы работаете, часто меняются, или вы не можете предсказать максимальное количество элементов, вы обычно получаете лучшую производительность, используя коллекцию.</span><span class="sxs-lookup"><span data-stu-id="23ab6-305">Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you'll usually obtain better performance by using a collection.</span></span>

<span data-ttu-id="23ab6-306">Некоторые коллекции допускают назначение ключа любому объекту, который добавляется в коллекцию, чтобы в дальнейшем можно было быстро извлечь связанный с ключом объект из коллекции.</span><span class="sxs-lookup"><span data-stu-id="23ab6-306">For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.</span></span>

<span data-ttu-id="23ab6-307">Если коллекция содержит элементы только одного типа данных, можно использовать один из классов в пространстве имен <xref:System.Collections.Generic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="23ab6-307">If your collection contains elements of only one data type, you can use one of the classes in the <xref:System.Collections.Generic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="23ab6-308">Универсальная коллекция обеспечивает строгую типизацию, так что в нее нельзя добавить другие типы данных.</span><span class="sxs-lookup"><span data-stu-id="23ab6-308">A generic collection enforces type safety so that no other data type can be added to it.</span></span>

<span data-ttu-id="23ab6-309">Более подробную информацию о коллекциях см. в статье [Коллекции](../../concepts/collections.md).</span><span class="sxs-lookup"><span data-stu-id="23ab6-309">For more information about collections, see [Collections](../../concepts/collections.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="23ab6-310">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="23ab6-310">Related topics</span></span>

|<span data-ttu-id="23ab6-311">Термин</span><span class="sxs-lookup"><span data-stu-id="23ab6-311">Term</span></span>|<span data-ttu-id="23ab6-312">Определение</span><span class="sxs-lookup"><span data-stu-id="23ab6-312">Definition</span></span>|
|----------|----------------|
|[<span data-ttu-id="23ab6-313">Array Dimensions in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="23ab6-313">Array Dimensions in Visual Basic</span></span>](array-dimensions.md)|<span data-ttu-id="23ab6-314">Объяснение ранга и измерений в массиве.</span><span class="sxs-lookup"><span data-stu-id="23ab6-314">Explains rank and dimensions in arrays.</span></span>|
|<span data-ttu-id="23ab6-315">[How to: Initialize an Array Variable in Visual Basic](how-to-initialize-an-array-variable.md) (Практическое руководство. Инициализация переменной массива в Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="23ab6-315">[How to: Initialize an Array Variable in Visual Basic](how-to-initialize-an-array-variable.md)</span></span>|<span data-ttu-id="23ab6-316">Описывается заполнение массивов начальными значениями.</span><span class="sxs-lookup"><span data-stu-id="23ab6-316">Describes how to populate arrays with initial values.</span></span>|
|<span data-ttu-id="23ab6-317">[How to: Sort An Array in Visual Basic](how-to-sort-an-array.md) (Практическое руководство. Сортировка массива в Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="23ab6-317">[How to: Sort An Array in Visual Basic](how-to-sort-an-array.md)</span></span>|<span data-ttu-id="23ab6-318">Показано, как сортировать элементы массива в алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="23ab6-318">Shows how to sort the elements of an array alphabetically.</span></span>|
|[<span data-ttu-id="23ab6-319">Практическое руководство. Присвоение одного массива другому</span><span class="sxs-lookup"><span data-stu-id="23ab6-319">How to: Assign One Array to Another Array</span></span>](how-to-assign-one-array-to-another-array.md)|<span data-ttu-id="23ab6-320">Описываются правила и действия для присвоения массива другой переменной массива.</span><span class="sxs-lookup"><span data-stu-id="23ab6-320">Describes the rules and steps for assigning an array to another array variable.</span></span>|
|[<span data-ttu-id="23ab6-321">Устранение неполадок, связанных с массивами</span><span class="sxs-lookup"><span data-stu-id="23ab6-321">Troubleshooting Arrays</span></span>](troubleshooting-arrays.md)|<span data-ttu-id="23ab6-322">Рассматриваются некоторые общие проблемы, возникающие при работе с массивами.</span><span class="sxs-lookup"><span data-stu-id="23ab6-322">Discusses some common problems that arise when working with arrays.</span></span>|

## <a name="see-also"></a><span data-ttu-id="23ab6-323">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="23ab6-323">See also</span></span>

- <xref:System.Array?displayProperty=nameWithType>
- [<span data-ttu-id="23ab6-324">Оператор Dim</span><span class="sxs-lookup"><span data-stu-id="23ab6-324">Dim Statement</span></span>](../../../language-reference/statements/dim-statement.md)
- [<span data-ttu-id="23ab6-325">Оператор reDim</span><span class="sxs-lookup"><span data-stu-id="23ab6-325">ReDim Statement</span></span>](../../../language-reference/statements/redim-statement.md)
