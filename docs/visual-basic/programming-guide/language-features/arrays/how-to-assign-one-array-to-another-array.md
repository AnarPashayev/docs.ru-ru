---
title: Практическое руководство. Присвоение одного массива другому
ms.date: 07/20/2015
helpviewer_keywords:
- covariance, arrays
- arrays [Visual Basic], assigning
- arrays [Visual Basic], covariance
ms.assetid: 1ae89ea5-f292-4282-bcfc-e9b06b37fbd5
ms.openlocfilehash: be5337e36c2cc7ad9f9b32182b8575ac66bb4a50
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74351891"
---
# <a name="how-to-assign-one-array-to-another-array-visual-basic"></a>Практическое руководство. Присвоение одного массива другому (Visual Basic)

Поскольку массивы являются объектами, их можно использовать в инструкциях присваивания, например в других типах объектов. Переменная массива содержит указатель на данные, образующей элементы массива, и сведения о ранге и длине, и присваивание копирует только этот указатель.

### <a name="to-assign-one-array-to-another-array"></a>Назначение одного массива другому массиву

1. Убедитесь, что два массива имеют одинаковый ранг (число измерений) и совместимые типы данных элементов.

2. Используйте стандартную инструкцию присваивания, чтобы присвоить исходный массив целевому массиву. Не используйте имя массива с круглыми скобками.

    ```vb
    Dim formArray() As System.Windows.Forms.Form
    Dim controlArray() As System.Windows.Forms.Control
    controlArray = formArray
    ```

При назначении одного массива другому применяются следующие правила.

- **Равные ранги.** Ранг (количество измерений) массива назначения должен быть таким же, как и у исходного массива.

  При условии, что ранги двух массивов равны, измерения не обязательно должны быть равны. Количество элементов в заданном измерении может изменяться во время назначения.

- **Типы элементов.** Оба массива должны иметь элементы *ссылочного типа* либо оба массива должны иметь элементы *типа значения* . Для получения дополнительной информации см. [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md).

  - Если оба массива имеют элементы типа значения, то типы данных элементов должны быть одинаковыми. Единственным исключением является то, что можно назначить массив `Enum`ных элементов массиву базового типа этого `Enum`.

  - Если оба массива имеют элементы ссылочного типа, тип исходного элемента должен быть производным от типа целевого элемента. В этом случае два массива имеют те же отношения наследования, что и их элементы. Это называется *ковариацией массивов*.

Компилятор сообщает об ошибке, если приведенные выше правила нарушаются, например, если типы данных несовместимы или ранги не равны. В код можно добавить обработку ошибок, чтобы убедиться, что массивы совместимы, прежде чем пытаться выполнить назначение. Можно также использовать ключевое слово [оператора TryCast](../../../../visual-basic/language-reference/operators/trycast-operator.md) , если необходимо избежать возникновения исключения.

## <a name="see-also"></a>См. также

- [Массивы](../../../../visual-basic/programming-guide/language-features/arrays/index.md)
- [Устранение неполадок, связанных с массивами](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)
- [Оператор Enum](../../../../visual-basic/language-reference/statements/enum-statement.md)
- [Преобразования массивов](../../../../visual-basic/programming-guide/language-features/data-types/array-conversions.md)
