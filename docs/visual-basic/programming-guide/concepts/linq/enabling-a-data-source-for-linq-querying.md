---
title: Включение источника данных для LINQ Querying2
ms.date: 07/20/2015
ms.assetid: c412f0cf-ff0e-4993-ab3d-1b49e23f00f8
ms.openlocfilehash: ecd43b371a8e907e9bcfc8687c04bdd0350235ac
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/03/2020
ms.locfileid: "75636891"
---
# <a name="enabling-a-data-source-for-linq-querying"></a>Включение источника данных для запросов LINQ

Существует множество способов расширения LINQ, позволяющих выполнять запросы к любому источнику данных в шаблоне LINQ. Источник данных может быть, например, структурой данных, веб-службой, файловой системой или базой данных. Шаблон LINQ упрощает для клиентов запрос к источнику данных, для которого включен запрос LINQ, поскольку синтаксис и шаблон запроса не меняются. Ниже приведены способы расширения LINQ к этим источникам данных.

- Реализация интерфейса <xref:System.Collections.Generic.IEnumerable%601> в типе для поддержки LINQ to Objects запросов этого типа.

- Создание методов стандартных операторов запросов, таких как <xref:System.Linq.Enumerable.Where%2A> и <xref:System.Linq.Enumerable.Select%2A>, расширяющих тип, для включения пользовательских запросов LINQ этого типа.

- Создание поставщика для источника данных, который реализует интерфейс <xref:System.Linq.IQueryable%601>. Поставщик, реализующий этот интерфейс, получает запросы LINQ в виде деревьев выражений, которые могут выполняться особым образом, например удаленно.

- Создание поставщика для источника данных, использующего преимущества существующей технологии LINQ. Такой поставщик позволит выполнять не только запросы, но и операции вставки, обновления, удаления и сопоставления для определяемых пользователем типов.

Эти варианты рассматриваются далее.

## <a name="how-to-enable-linq-querying-of-your-data-source"></a>Включение поддержки запросов LINQ к пользовательскому источнику данных

### <a name="in-memory-data"></a>Данные в памяти
 Запросы LINQ к данным в памяти можно включить двумя способами. Если данные имеют тип, реализующий <xref:System.Collections.Generic.IEnumerable%601>, можно запросить данные с помощью LINQ to Objects. Если нет смысла включать перечисление типа путем реализации интерфейса <xref:System.Collections.Generic.IEnumerable%601>, можно определить методы стандартных операторов запросов LINQ в этом типе или создать методы стандартных операторов запросов LINQ, расширяющие тип. Пользовательские реализации стандартных операторов запроса должны использовать отложенное выполнение для возврата результатов.

### <a name="remote-data"></a>Удаленные данные
 Лучшим вариантом для включения запросов LINQ к удаленному источнику данных является реализация интерфейса <xref:System.Linq.IQueryable%601>. Однако это отличается от расширения поставщика, например [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] для источника данных. В Visual Studio 2008 отсутствуют модели поставщиков для расширения существующих технологий LINQ, таких как [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], в другие типы источника данных.

## <a name="iqueryable-linq-providers"></a>Поставщики IQueryable LINQ
 Поставщики LINQ, реализующие <xref:System.Linq.IQueryable%601>, могут сильно различаться по сложности. В этом разделе рассматриваются различные уровни сложности.

 Менее сложные поставщики `IQueryable` могут взаимодействовать с одним методом веб-службы. Этот тип поставщиков является очень специализированным, так как он требует наличия определенных сведений в обрабатываемых запросах. Он имеет закрытую систему типов, возможно, предоставляя один тип результата. Большая часть выполнения запроса происходит локально, например с помощью реализации <xref:System.Linq.Enumerable> стандартных операторов запроса. Менее сложный поставщик может проверять только одно выражение вызова метода в дереве выражений, которое представляет запрос, и оставляет оставшуюся логику запроса обрабатываться в другом месте.

 Поставщик `IQueryable` средней сложности может использовать источник данных, который имеет ограниченно выразительный язык запросов. Если он предназначен для веб-службы, он может взаимодействовать с несколькими методами веб-службы и выбирать метод для вызова на основании вопроса, содержащегося в запросе. Поставщик средней сложности будет иметь более богатую систему типов, чем простой поставщик, но она по-прежнему будет фиксированной. Например, поставщик может предоставлять типы, имеющие связи "один ко многим", которые можно обойти, но он не предоставляет технологии отображения для определяемых пользователем типов.

 Сложный поставщик `IQueryable`, например поставщик [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], может преобразовывать запросы LINQ на выразительный язык запросов, например SQL. Сложные поставщики более общие, чем менее сложные, поскольку они могут обрабатывать более широкий диапазон вопросов в запросе. Он также имеет открытую систему типов и поэтому должен содержать расширяемую инфраструктуру для сопоставления определяемых пользователем типов. Разработка сложного поставщика требует значительных усилий.

## <a name="see-also"></a>См. также:

- <xref:System.Linq.IQueryable%601>
- <xref:System.Collections.Generic.IEnumerable%601>
- <xref:System.Linq.Enumerable>
- [Общие сведения о стандартных операторах запроса (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md)
- [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)
