---
title: Безопасность LINQ to XML
ms.date: 07/20/2015
ms.assetid: d99b4af2-d447-4a3b-991b-6da0231a8637
ms.openlocfilehash: 01b03dc5792981d41d16cc7b551892bd6fe2bcde
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74331742"
---
# <a name="linq-to-xml-security-visual-basic"></a><span data-ttu-id="38411-102">Безопасность LINQ to XML (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="38411-102">LINQ to XML Security (Visual Basic)</span></span>
<span data-ttu-id="38411-103">В этом разделе обсуждаются проблемы безопасности, связанные с LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="38411-103">This topic describes security issues associated with LINQ to XML.</span></span> <span data-ttu-id="38411-104">Кроме того, в нем даются рекомендации по снижению рисков нарушения безопасности.</span><span class="sxs-lookup"><span data-stu-id="38411-104">In addition, it provides some guidance for mitigating security exposure.</span></span>  
  
## <a name="linq-to-xml-security-overview"></a><span data-ttu-id="38411-105">Общие сведения о безопасности LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="38411-105">LINQ to XML Security Overview</span></span>  
 <span data-ttu-id="38411-106">Технология LINQ to XML разрабатывалась в большей степени для повышения удобства программирования, чем для серверных приложений с жесткими требованиями к безопасности.</span><span class="sxs-lookup"><span data-stu-id="38411-106">LINQ to XML is designed more for programming convenience than for server-side applications with stringent security requirements.</span></span> <span data-ttu-id="38411-107">Большинство XML-сценариев состоит из обработки доверенных XML-документов, а не тех XML-документов, не заслуживающих доверия, которые передаются на сервер.</span><span class="sxs-lookup"><span data-stu-id="38411-107">Most XML scenarios consist of processing trusted XML documents, rather than processing untrusted XML documents that are uploaded to a server.</span></span> <span data-ttu-id="38411-108">Технология LINQ to XML оптимизирована для таких сценариев.</span><span class="sxs-lookup"><span data-stu-id="38411-108">LINQ to XML is optimized for these scenarios.</span></span>  
  
 <span data-ttu-id="38411-109">Если нужно обработать не заслуживающие доверия данные из неизвестного источника, рекомендуется использовать экземпляр класса <xref:System.Xml.XmlReader>, настроенного на предотвращение путем фильтрации известных атак XML типа «отказ в обслуживании».</span><span class="sxs-lookup"><span data-stu-id="38411-109">If you must process untrusted data from unknown sources, Microsoft recommends that you use an instance of the <xref:System.Xml.XmlReader> class that has been configured to filter out known XML denial of service (DoS) attacks.</span></span>  
  
 <span data-ttu-id="38411-110">Если объект <xref:System.Xml.XmlReader> сконфигурирован для снижения риска атак типа «отказ в обслуживании», его можно использовать для заполнения дерева LINQ to XML и одновременно воспользоваться преимуществами повышения продуктивности программиста, связанными с LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="38411-110">If you have configured an <xref:System.Xml.XmlReader> to mitigate denial of service attacks, you can use that reader to populate a LINQ to XML tree and still benefit from the programmer productivity enhancements of LINQ to XML.</span></span> <span data-ttu-id="38411-111">Многие приемы снижения рисков включают создание агентов чтения, настроенных на решение проблем безопасности, а затем создание экземпляра XML-дерева с помощью такого настроенного агента чтения.</span><span class="sxs-lookup"><span data-stu-id="38411-111">Many mitigation techniques involve creating readers that are configured to mitigate the security issue, and then instantiating an XML tree through the configured reader.</span></span>  
  
 <span data-ttu-id="38411-112">XML по своей природе уязвим для атак типа «отказ в обслуживании» из-за того, что XML-документы не ограничены по размеру, глубине, длине имен элементов и так далее.</span><span class="sxs-lookup"><span data-stu-id="38411-112">XML is intrinsically vulnerable to denial of service attacks because documents are unbounded in size, depth, element name size, and more.</span></span> <span data-ttu-id="38411-113">Независимо от компонента, с помощью которого обрабатывается XML, следует всегда быть готовым к очистке домена приложения, если он потребляет излишне много ресурсов.</span><span class="sxs-lookup"><span data-stu-id="38411-113">Regardless of the component that you use to process XML, you should always be prepared to recycle the application domain if it uses excessive resources.</span></span>  
  
## <a name="mitigation-of-xml-xsd-xpath-and-xslt-attacks"></a><span data-ttu-id="38411-114">Предотвращение атак XML, XSD, XPath и XSLT</span><span class="sxs-lookup"><span data-stu-id="38411-114">Mitigation of XML, XSD, XPath, and XSLT Attacks</span></span>  
 <span data-ttu-id="38411-115">Технология LINQ to XML построена на основе объектов <xref:System.Xml.XmlReader> и <xref:System.Xml.XmlWriter>.</span><span class="sxs-lookup"><span data-stu-id="38411-115">LINQ to XML is built upon <xref:System.Xml.XmlReader> and <xref:System.Xml.XmlWriter>.</span></span> <span data-ttu-id="38411-116">LINQ to XML поддерживает XSD и XPath через методы расширения в пространствах имен <xref:System.Xml.Schema?displayProperty=nameWithType> и <xref:System.Xml.XPath?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="38411-116">LINQ to XML supports XSD and XPath through extension methods in the <xref:System.Xml.Schema?displayProperty=nameWithType> and <xref:System.Xml.XPath?displayProperty=nameWithType> namespaces.</span></span> <span data-ttu-id="38411-117">Используя классы <xref:System.Xml.XmlReader>, <xref:System.Xml.XPath.XPathNavigator> и <xref:System.Xml.XmlWriter> совместно с LINQ to XML, можно вызывать XSLT для преобразования XML-деревьев.</span><span class="sxs-lookup"><span data-stu-id="38411-117">Using the <xref:System.Xml.XmlReader>, <xref:System.Xml.XPath.XPathNavigator>, and <xref:System.Xml.XmlWriter> classes in conjunction with LINQ to XML, you can invoke XSLT to transform XML trees.</span></span>  
  
 <span data-ttu-id="38411-118">При работе в менее защищенной среде возникает несколько проблем безопасности, связанных с XML и использованием классов в <xref:System.Xml?displayProperty=nameWithType>, <xref:System.Xml.Schema?displayProperty=nameWithType>, <xref:System.Xml.XPath?displayProperty=nameWithType> и <xref:System.Xml.Xsl?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="38411-118">If you are operating in a less secure environment, there are a number of security issues that are associated with XML and the use of the classes in <xref:System.Xml?displayProperty=nameWithType>, <xref:System.Xml.Schema?displayProperty=nameWithType>, <xref:System.Xml.XPath?displayProperty=nameWithType>, and <xref:System.Xml.Xsl?displayProperty=nameWithType>.</span></span> <span data-ttu-id="38411-119">Эти проблемы включают следующие, но не ограничиваются ими.</span><span class="sxs-lookup"><span data-stu-id="38411-119">These issues include, but are not limited to, the following:</span></span>  
  
- <span data-ttu-id="38411-120">Языки XSD, XPath и XSLT основаны на использовании строк, поэтому в них могут быть определены операции, которые занимают много времени и требуют большого объема памяти.</span><span class="sxs-lookup"><span data-stu-id="38411-120">XSD, XPath, and XSLT are string-based languages in which you can specify operations that consume a lot of time or memory.</span></span> <span data-ttu-id="38411-121">Разработчики приложений, принимающих строки XSD, XPath и XSLT из источников, не заслуживающих доверия, отвечают за то, чтобы осуществлялась проверка этих строк на отсутствие вредоносного кода и чтобы она не приводила к чрезмерному потреблению системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="38411-121">It is the responsibility of application programmers who take XSD, XPath, or XSLT strings from untrusted sources to validate that the strings are not malicious, or to monitor and mitigate the possibility that evaluating these strings will lead to excessive system resource consumption.</span></span>  
  
- <span data-ttu-id="38411-122">XSD-схемы (включая встроенные схемы) по своей природе уязвимы для атак типа «отказ в обслуживании», поэтому не следует принимать схемы из источников, не заслуживающих доверия.</span><span class="sxs-lookup"><span data-stu-id="38411-122">XSD schemas (including inline schemas) are inherently vulnerable to denial of service attacks; you should not accept schemas from untrusted sources.</span></span>  
  
- <span data-ttu-id="38411-123">XSD и XSLT могут включать ссылки на другие файлы, что может привести к возникновению атак, охватывающих несколько зон и доменов.</span><span class="sxs-lookup"><span data-stu-id="38411-123">XSD and XSLT can include references to other files, and such references can result in cross-zone and cross-domain attacks.</span></span>  
  
- <span data-ttu-id="38411-124">Внешние сущности в DTD могут привести к атакам, распространяющимся на несколько зон и доменов.</span><span class="sxs-lookup"><span data-stu-id="38411-124">External entities in DTDs can result in cross-zone and cross-domain attacks.</span></span>  
  
- <span data-ttu-id="38411-125">DTD уязвимы для атак типа «отказ в обслуживании».</span><span class="sxs-lookup"><span data-stu-id="38411-125">DTDs are vulnerable to denial of service attacks.</span></span>  
  
- <span data-ttu-id="38411-126">Подверженными атакам типа «отказ в обслуживании» становятся XML-документы с чрезмерно глубокой структурой, поэтому следует ограничивать глубину вложенности элементов в XML-документах.</span><span class="sxs-lookup"><span data-stu-id="38411-126">Exceptionally deep XML documents can pose denial of service issues; you might want to limit the depth of XML documents.</span></span>  
  
- <span data-ttu-id="38411-127">Поддерживающие компоненты, такие как объекты <xref:System.Xml.NameTable>, <xref:System.Xml.XmlNamespaceManager> и <xref:System.Xml.XmlResolver>, не следует принимать из сборок, не заслуживающих доверия.</span><span class="sxs-lookup"><span data-stu-id="38411-127">Do not accept supporting components, such as <xref:System.Xml.NameTable>, <xref:System.Xml.XmlNamespaceManager>, and <xref:System.Xml.XmlResolver> objects, from untrusted assemblies.</span></span>  
  
- <span data-ttu-id="38411-128">С целью снижения угрозы атак, которые могут быть связаны с обработкой больших документов, рекомендуется считывать данные в виде фрагментов.</span><span class="sxs-lookup"><span data-stu-id="38411-128">Read data in chunks to mitigate large document attacks.</span></span>  
  
- <span data-ttu-id="38411-129">Предпосылкой возникновения многих атак может стать применение блоков скриптов в таблице стилей XSLT.</span><span class="sxs-lookup"><span data-stu-id="38411-129">Script blocks in XSLT style sheets can expose a number of attacks.</span></span>  
  
- <span data-ttu-id="38411-130">Перед конструированием динамических выражений XPath следует выполнять тщательную проверку.</span><span class="sxs-lookup"><span data-stu-id="38411-130">Validate carefully before constructing dynamic XPath expressions.</span></span>  
  
## <a name="linq-to-xml-security-issues"></a><span data-ttu-id="38411-131">Вопросы безопасности LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="38411-131">LINQ to XML Security Issues</span></span>  
 <span data-ttu-id="38411-132">Вопросы безопасности в этом разделе не упорядочены в каком-либо особом формате.</span><span class="sxs-lookup"><span data-stu-id="38411-132">The security issues in this topic are not presented in any particular order.</span></span> <span data-ttu-id="38411-133">Важны все вопросы, поэтому их необходимо решать должным образом.</span><span class="sxs-lookup"><span data-stu-id="38411-133">All issues are important and should be addressed as appropriate.</span></span>  
  
 <span data-ttu-id="38411-134">Успешная атака с целью повышения прав доступа предоставляет вредоносной сборке более полный контроль над средой.</span><span class="sxs-lookup"><span data-stu-id="38411-134">A successful elevation of privilege attack gives a malicious assembly more control over its environment.</span></span> <span data-ttu-id="38411-135">Успешная атака с целью повышения прав доступа может привести к раскрытию данных, отказу в обслуживании и так далее.</span><span class="sxs-lookup"><span data-stu-id="38411-135">A successful elevation of privilege attack can result in disclosure of data, denial of service, and more.</span></span>  
  
 <span data-ttu-id="38411-136">В приложениях не следует раскрывать данные перед пользователями, не имеющими прав на просмотр этих данных.</span><span class="sxs-lookup"><span data-stu-id="38411-136">Applications should not disclose data to users who are not authorized to see that data.</span></span>  
  
 <span data-ttu-id="38411-137">Проведение атаки типа «отказ в обслуживании» приводит к тому, что синтаксический анализатор XML или средства LINQ to XML начинают потреблять чрезмерный объем памяти или ресурсов ЦП.</span><span class="sxs-lookup"><span data-stu-id="38411-137">Denial of service attacks cause the XML parser or LINQ to XML to consume excessive amounts of memory or CPU time.</span></span> <span data-ttu-id="38411-138">Атаки типа «отказ в обслуживании» считаются менее серьезными, чем атаки с целью повышения прав доступа или атаки, направленные на раскрытие данных.</span><span class="sxs-lookup"><span data-stu-id="38411-138">Denial of service attacks are considered to be less severe than elevation of privilege attacks or disclosure of data attacks.</span></span> <span data-ttu-id="38411-139">Однако и с ними следует считаться в той ситуации, когда сервер должен обрабатывать XML-документы из источников, не заслуживающих доверия.</span><span class="sxs-lookup"><span data-stu-id="38411-139">However, they are important in a scenario where a server needs to process XML documents from untrusted sources.</span></span>  
  
### <a name="exceptions-and-error-messages-might-reveal-data"></a><span data-ttu-id="38411-140">Исключения и сообщения об ошибках могут привести к раскрытию данных</span><span class="sxs-lookup"><span data-stu-id="38411-140">Exceptions and Error Messages Might Reveal Data</span></span>  
 <span data-ttu-id="38411-141">В описании ошибки раскрываются такие сведения, как преобразуемые данные, имена файлов или подробности реализации.</span><span class="sxs-lookup"><span data-stu-id="38411-141">The description of an error might reveal data, such as the data being transformed, file names, or implementation details.</span></span> <span data-ttu-id="38411-142">Сообщения об ошибках не должны передаваться вызывающим объектам, которые не являются надежными.</span><span class="sxs-lookup"><span data-stu-id="38411-142">Error messages should not be exposed to callers that are not trusted.</span></span> <span data-ttu-id="38411-143">Необходимо перехватывать все ошибки и создавать собственные сообщения об ошибках.</span><span class="sxs-lookup"><span data-stu-id="38411-143">You should catch all errors and report errors with your own custom error messages.</span></span>  
  
### <a name="do-not-call-codeaccesspermissionsassert-in-an-event-handler"></a><span data-ttu-id="38411-144">Отказ от вызова CodeAccessPermissions.Assert в обработчике события</span><span class="sxs-lookup"><span data-stu-id="38411-144">Do Not Call CodeAccessPermissions.Assert in an Event Handler</span></span>  
 <span data-ttu-id="38411-145">Сборка может иметь меньшее или большее количество разрешений.</span><span class="sxs-lookup"><span data-stu-id="38411-145">An assembly can have lesser or greater permissions.</span></span> <span data-ttu-id="38411-146">Сборка с большими разрешениями имеет более полный контроль над компьютером и средой.</span><span class="sxs-lookup"><span data-stu-id="38411-146">An assembly that has greater permissions has greater control over the computer and its environments.</span></span>  
  
 <span data-ttu-id="38411-147">Если в коде сборки с большими разрешениями вызывается метод <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> в обработчике события, а затем полученное XML-дерево передается вредоносной сборке, имеющей меньшие разрешения, то в последней сборке может быть активизировано событие.</span><span class="sxs-lookup"><span data-stu-id="38411-147">If code in an assembly with greater permissions calls <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> in an event handler, and then the XML tree is passed to a malicious assembly that has restricted permissions, the malicious assembly can cause an event to be raised.</span></span> <span data-ttu-id="38411-148">При этом в обработчике этого события будет выполняться код из сборки с большими разрешениями, поэтому появится возможность применять вредоносную сборку с повышенными правами доступа.</span><span class="sxs-lookup"><span data-stu-id="38411-148">Because the event runs code that is in the assembly with greater permissions, the malicious assembly would then be operating with elevated privileges.</span></span>  
  
 <span data-ttu-id="38411-149">Корпорация Майкрософт рекомендует ни в коем случае не вызывать метод <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> в обработчике события.</span><span class="sxs-lookup"><span data-stu-id="38411-149">Microsoft recommends that you never call <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> in an event handler.</span></span>  
  
### <a name="dtds-are-not-secure"></a><span data-ttu-id="38411-150">Небезопасные определения DTD</span><span class="sxs-lookup"><span data-stu-id="38411-150">DTDs are Not Secure</span></span>  
 <span data-ttu-id="38411-151">Сущности в DTD изначально являются небезопасными.</span><span class="sxs-lookup"><span data-stu-id="38411-151">Entities in DTDs are inherently not secure.</span></span> <span data-ttu-id="38411-152">Применение XML-документа, содержащего DTD, с недобрыми намерениями может привести к тому, что синтаксический анализатор захватит всю память и ресурсы ЦП, создав предпосылки атаки типа «отказ в обслуживании».</span><span class="sxs-lookup"><span data-stu-id="38411-152">It is possible for a malicious XML document that contains a DTD to cause the parser to use all memory and CPU time, causing a denial of service attack.</span></span> <span data-ttu-id="38411-153">Поэтому в LINQ to XML обработка DTD отключена по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="38411-153">Therefore, in LINQ to XML, DTD processing is turned off by default.</span></span> <span data-ttu-id="38411-154">Не следует принимать определения DTD из ненадежных источников.</span><span class="sxs-lookup"><span data-stu-id="38411-154">You should not accept DTDs from untrusted sources.</span></span>  
  
 <span data-ttu-id="38411-155">Примером использования DTD из ненадежных источников служит веб-приложение, позволяющее пользователям Интернета передавать XML-файл, ссылающийся на определение DTD и DTD-файл.</span><span class="sxs-lookup"><span data-stu-id="38411-155">One example of accepting DTDs from untrusted sources is a Web application that allows Web users to upload an XML file that references a DTD and a DTD file.</span></span> <span data-ttu-id="38411-156">При проверке этого файла на наличие вредоносного определения DTD может произойти атака типа «отказ в обслуживании» на сервер.</span><span class="sxs-lookup"><span data-stu-id="38411-156">Upon validation of the file, a malicious DTD could execute a denial of service attack on your server.</span></span> <span data-ttu-id="38411-157">Другим примером приема DTD из ненадежных источников является применение ссылки на DTD в общем сетевом ресурсе, также разрешающем анонимный FTP-доступ.</span><span class="sxs-lookup"><span data-stu-id="38411-157">Another example of accepting DTDs from untrusted sources is to reference a DTD on a network share that also allows anonymous FTP access.</span></span>  
  
### <a name="avoid-excessive-buffer-allocation"></a><span data-ttu-id="38411-158">Отказ от выделения чрезмерного объема буферной памяти</span><span class="sxs-lookup"><span data-stu-id="38411-158">Avoid Excessive Buffer Allocation</span></span>  
 <span data-ttu-id="38411-159">Разработчики приложений должны учитывать, что применение слишком крупных источников данных может привести к исчерпанию ресурсов и возникновению атаки типа «отказ в обслуживании».</span><span class="sxs-lookup"><span data-stu-id="38411-159">Application developers should be aware that extremely large data sources can lead to resource exhaustion and denial of service attacks.</span></span>  
  
 <span data-ttu-id="38411-160">Если злонамеренный пользователь предоставляет или передает очень большой XML-документ, это может стать причиной чрезмерного потребления системных ресурсов LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="38411-160">If a malicious user submits or uploads a very large XML document, it could cause LINQ to XML to consume excessive system resources.</span></span> <span data-ttu-id="38411-161">Это равнозначно атаке типа «отказ в обслуживании».</span><span class="sxs-lookup"><span data-stu-id="38411-161">This can constitute a denial of service attack.</span></span> <span data-ttu-id="38411-162">Чтобы избежать этого, можно задать значение свойства <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> и создать модуль чтения, который в дальнейшем будет ограничивать размер загружаемого документа.</span><span class="sxs-lookup"><span data-stu-id="38411-162">To prevent this, you can set the <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> property, and create a reader that is then limited in the size of document that it can load.</span></span> <span data-ttu-id="38411-163">Затем с помощью средства чтения создается XML-дерево.</span><span class="sxs-lookup"><span data-stu-id="38411-163">You then use the reader to create the XML tree.</span></span>  
  
 <span data-ttu-id="38411-164">Например, если известно, что максимальный ожидаемый размер XML-документов из не заслуживающего доверия источника меньше 50 КБ, присвойте свойству <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> значение 100 000.</span><span class="sxs-lookup"><span data-stu-id="38411-164">For example, if you know that the maximum expected size of your XML documents coming from an untrusted source will be less than 50K bytes, set <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> to 100,000.</span></span> <span data-ttu-id="38411-165">При этом обработка XML-документов не будет нарушена, но уменьшится риск атаки типа «отказ в обслуживании», при которой могут передаваться документы, требующие большого объема памяти.</span><span class="sxs-lookup"><span data-stu-id="38411-165">This will not encumber your processing of XML documents, and at the same time it will mitigate denial of service threats where documents might be uploaded that would consume large amounts of memory.</span></span>  
  
### <a name="avoid-excess-entity-expansion"></a><span data-ttu-id="38411-166">Предотвращение чрезмерного раскрытия сущности</span><span class="sxs-lookup"><span data-stu-id="38411-166">Avoid Excess Entity Expansion</span></span>  
 <span data-ttu-id="38411-167">Одна из известных атак типа «отказ в обслуживании» при использовании DTD основана на документе, вызывающем чрезмерное раскрытие сущности.</span><span class="sxs-lookup"><span data-stu-id="38411-167">One of the known denial of service attacks when using a DTD is a document that causes excessive entity expansion.</span></span> <span data-ttu-id="38411-168">Чтобы избежать этого, можно задать значение свойства <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> и создать модуль чтения, который в дальнейшем будет ограничивать число символов, являющихся результатом раскрытия сущности.</span><span class="sxs-lookup"><span data-stu-id="38411-168">To prevent this, you can set the <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> property, and create a reader that is then limited in the number of characters that result from entity expansion.</span></span> <span data-ttu-id="38411-169">Затем с помощью средства чтения создается XML-дерево.</span><span class="sxs-lookup"><span data-stu-id="38411-169">You then use the reader to create the XML tree.</span></span>  
  
### <a name="limit-the-depth-of-the-xml-hierarchy"></a><span data-ttu-id="38411-170">Ограничение глубины XML-иерархии</span><span class="sxs-lookup"><span data-stu-id="38411-170">Limit the Depth of the XML Hierarchy</span></span>  
 <span data-ttu-id="38411-171">Одной из возможных атак типа «отказ в обслуживании» является предоставление документа с избыточной глубиной иерархии.</span><span class="sxs-lookup"><span data-stu-id="38411-171">One possible denial of service attack is when a document is submitted that has excessive depth of hierarchy.</span></span> <span data-ttu-id="38411-172">Чтобы избежать этого, можно заключить <xref:System.Xml.XmlReader> в собственный класс, который подсчитывает глубину вложенности элементов.</span><span class="sxs-lookup"><span data-stu-id="38411-172">To prevent this, you can wrap a <xref:System.Xml.XmlReader> in your own class that counts the depth of elements.</span></span> <span data-ttu-id="38411-173">Если эта глубина превышает заранее определенную приемлемую величину, можно завершить обработку вредоносного документа.</span><span class="sxs-lookup"><span data-stu-id="38411-173">If the depth exceeds a predetermined reasonable level, you can terminate the processing of the malicious document.</span></span>  
  
### <a name="protect-against-untrusted-xmlreader-or-xmlwriter-implementations"></a><span data-ttu-id="38411-174">Защита от не заслуживающих доверия реализаций XmlReader и XmlWriter</span><span class="sxs-lookup"><span data-stu-id="38411-174">Protect Against Untrusted XmlReader or XmlWriter Implementations</span></span>  
 <span data-ttu-id="38411-175">Администраторы должны убедиться, что все внешние реализации <xref:System.Xml.XmlReader> и <xref:System.Xml.XmlWriter> имеют строгие имена и зарегистрированы в конфигурации компьютера.</span><span class="sxs-lookup"><span data-stu-id="38411-175">Administrators should verify that any externally supplied <xref:System.Xml.XmlReader> or <xref:System.Xml.XmlWriter> implementations have strong names and have been registered in the machine configuration.</span></span> <span data-ttu-id="38411-176">Это позволяет предотвратить загрузку злонамеренного кода под видом модуля чтения или записи.</span><span class="sxs-lookup"><span data-stu-id="38411-176">This prevents malicious code masquerading as a reader or writer from being loaded.</span></span>  
  
### <a name="periodically-free-objects-that-reference-xname"></a><span data-ttu-id="38411-177">Периодическое освобождение объектов, ссылающихся на XName</span><span class="sxs-lookup"><span data-stu-id="38411-177">Periodically Free Objects that Reference XName</span></span>  
 <span data-ttu-id="38411-178">Чтобы защититься от атак определенных типов, разработчики приложений должны регулярно освобождать все объекты, имеющие ссылку на объект <xref:System.Xml.Linq.XName> в домене приложения.</span><span class="sxs-lookup"><span data-stu-id="38411-178">To protect against certain kinds of attacks, application programmers should free all objects that reference an <xref:System.Xml.Linq.XName> object in the application domain on a regular basis.</span></span>  
  
### <a name="protect-against-random-xml-names"></a><span data-ttu-id="38411-179">Защита от случайно сформированных XML-имен</span><span class="sxs-lookup"><span data-stu-id="38411-179">Protect Against Random XML Names</span></span>  
 <span data-ttu-id="38411-180">Приложениям, принимающим данные из источников, не заслуживающих доверия, следует заключать модули <xref:System.Xml.XmlReader> в пользовательский код для проверки на наличие случайно сформированных XML-имен и пространств имен.</span><span class="sxs-lookup"><span data-stu-id="38411-180">Applications that take data from untrusted sources should consider using an <xref:System.Xml.XmlReader> that is wrapped in custom code to inspect for the possibility of random XML names and namespaces.</span></span> <span data-ttu-id="38411-181">При обнаружении таких случайно сформированных XML-имен или пространств имен приложение может завершить обработку вредоносного документа.</span><span class="sxs-lookup"><span data-stu-id="38411-181">If such random XML names and namespaces are detected, the application can then terminate the processing of the malicious document.</span></span>  
  
 <span data-ttu-id="38411-182">Может потребоваться ограничить количество имен в каждом конкретном пространстве имен (включая имена вне пространства имен) до приемлемого предела.</span><span class="sxs-lookup"><span data-stu-id="38411-182">You might want to limit the number of names in any given namespace (including names in no namespace) to a reasonable limit.</span></span>  
  
### <a name="annotations-are-accessible-by-software-components-that-share-a-linq-to-xml-tree"></a><span data-ttu-id="38411-183">Доступ к заметкам для компонентов программного обеспечения, имеющих совместный доступ к дереву LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="38411-183">Annotations Are Accessible by Software Components that Share a LINQ to XML Tree</span></span>  
 <span data-ttu-id="38411-184">LINQ to XML может использоваться для обеспечения конвейерной обработки, при которой для загрузки, проверки, выполнения запросов, преобразования, обновления и сохранения XML-данных, передаваемых между компонентами в виде XML-деревьев, применяются разные компоненты приложения.</span><span class="sxs-lookup"><span data-stu-id="38411-184">LINQ to XML could be used to build processing pipelines in which different application components load, validate, query, transform, update, and save XML data that is passed between components as XML trees.</span></span> <span data-ttu-id="38411-185">Это может способствовать оптимизации производительности, поскольку издержки загрузки и сериализации объектов в XML-текст возникают только в конечных точках конвейера.</span><span class="sxs-lookup"><span data-stu-id="38411-185">This can help optimize performance, because the overhead of loading and serializing objects to XML text is done only at the ends of the pipeline.</span></span> <span data-ttu-id="38411-186">Однако разработчики должны знать, что все заметки и обработчики событий, созданные одним компонентом, доступны для других компонентов.</span><span class="sxs-lookup"><span data-stu-id="38411-186">Developers must be aware, however, that all annotations and event handlers created by one component are accessible to other components.</span></span> <span data-ttu-id="38411-187">Это может привести к появлению различных уязвимых мест, если одни компоненты заслуживают доверия в меньшей степени, чем другие.</span><span class="sxs-lookup"><span data-stu-id="38411-187">This can create a number of vulnerabilities if the components have different levels of trust.</span></span> <span data-ttu-id="38411-188">Чтобы построить безопасные конвейеры из компонентов, в меньшей степени заслуживающих доверия, необходимо сериализовать объекты LINQ to XML в XML-текст перед их передачей менее доверенному компоненту.</span><span class="sxs-lookup"><span data-stu-id="38411-188">To build secure pipelines across less trusted components, you must serialize LINQ to XML objects to XML text before passing the data to an untrusted component.</span></span>  
  
 <span data-ttu-id="38411-189">Определенный уровень безопасности предоставляется средой CLR.</span><span class="sxs-lookup"><span data-stu-id="38411-189">Some security is provided by the common language runtime (CLR).</span></span> <span data-ttu-id="38411-190">Например, компонент, не содержащий закрытый класс, не может получить доступ к заметкам, которые обозначены ключами с помощью этого класса.</span><span class="sxs-lookup"><span data-stu-id="38411-190">For example, a component that does not include a private class cannot access annotations keyed by that class.</span></span> <span data-ttu-id="38411-191">Однако заметки могут быть удалены компонентами, не имеющими возможность их читать.</span><span class="sxs-lookup"><span data-stu-id="38411-191">However, annotations can be deleted by components that cannot read them.</span></span> <span data-ttu-id="38411-192">Это может использоваться в качестве атаки для злонамеренного изменения данных.</span><span class="sxs-lookup"><span data-stu-id="38411-192">This could be used as a tampering attack.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="38411-193">См. также</span><span class="sxs-lookup"><span data-stu-id="38411-193">See also</span></span>

- [<span data-ttu-id="38411-194">Руководством по программированию (LINQ to XML) (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="38411-194">Programming Guide (LINQ to XML) (Visual Basic)</span></span>](../../../../visual-basic/programming-guide/concepts/linq/programming-guide-linq-to-xml.md)
