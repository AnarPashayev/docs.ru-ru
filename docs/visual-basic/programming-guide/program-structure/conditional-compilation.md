---
title: Условная компиляция в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- conditional compilation [Visual Basic], about conditional compilation
- compilation [Visual Basic], conditional
ms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848
ms.openlocfilehash: 1bee64568ff92468e29226a395f7e5335387e256
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69945586"
---
# <a name="conditional-compilation-in-visual-basic"></a>Условная компиляция в Visual Basic
В *условной компиляции*определенные блоки кода в программе компилируются выборочно, а другие игнорируются.  
  
 Например, может потребоваться написать инструкции отладки, которые сравнивают скорость различных подходов к одной задаче программирования, или вы можете локализовать приложение для нескольких языков. Операторы условной компиляции предназначены для запуска во время компиляции, а не во время выполнения.  
  
 Вы запишите блоки кода для условной компиляции с помощью `#If...Then...#Else` директивы. Например, чтобы создать версии одного и того же приложения на французском и немецком языках из одного и того же исходного кода, необходимо внедрить в `#If...Then` инструкции сегменты кода для конкретной платформы, используя предопределенные константы `FrenchVersion` и `GermanVersion`. В следующем примере показано, как:  
  
 [!code-vb[VbVbalrConditionalComp#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConditionalComp/VB/Class1.vb#5)]  
  
 Если для `FrenchVersion` `True` константы условной компиляции задано значение во время компиляции, то компилируется условный код для французской версии. Если для `GermanVersion` `True`константы задано значение, компилятор использует немецкую версию. Если ни один из них `True`не имеет значение, код в `Else` последнем блоке выполняется.  
  
> [!NOTE]
> Автозаполнение не будет работать при редактировании кода и использовании директив условной компиляции, если код не является частью текущей ветви.  
  
## <a name="declaring-conditional-compilation-constants"></a>Объявление констант условной компиляции  
 Константы условной компиляции можно задать одним из трех способов:  
  
- В **конструкторе проектов**  
  
- В командной строке при использовании компилятора командной строки  
  
- В коде  
  
 Константы условной компиляции имеют специальную область и недоступны из стандартного кода. Область константы условной компиляции зависит от того, как она задана. В следующей таблице перечислены области констант, объявленных с помощью каждого из трех описанных выше способов.  
  
|Как задается константа|Область действия константы|  
|---|---|  
|**Конструктор проектов**|Открыт для всех файлов в проекте|  
|Командная строка|Открытый для всех файлов, переданных компилятору командной строки|  
|`#Const`оператор в коде|Закрытый для файла, в котором он объявлен|  
  
|Задание констант в конструкторе проектов|  
|---|  
|— Перед созданием исполняемого файла задайте константы в **конструкторе проектов** , выполнив действия, описанные в разделе [Управление свойствами проекта и решения](/visualstudio/ide/managing-project-and-solution-properties).|  
  
|Задание констант в командной строке|  
|---|  
|— Используйте параметр **/d** для ввода констант условной компиляции, как показано в следующем примере:<br />     `vbc MyProj.vb /d:conFrenchVersion=–1:conANSI=0`<br />     Между параметром **/d** и первой константой не должно быть пробелов. Дополнительные сведения см. в разделе [/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md).<br />     Объявления из командной строки переопределяют объявления, указанные в **конструкторе проектов**, но не удаляют их. Аргументы, заданные в **конструкторе проектов** , действуют для последующих компиляций.<br />     При написании констант в самом коде нет никаких правил для их размещения, поскольку их областью действия является весь модуль, в котором они объявляются.|  
  
|Задание констант в коде|  
|---|  
|-Поместите константы в блок объявления модуля, в котором они используются. Это помогает организовать структурирование кода и облегчить его чтение.|  
  
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание|  
|---|---|  
|[Соглашения о структуре программы и коде](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)|Предоставляет рекомендации по упрощению чтения и сопровождения кода.|  
  
## <a name="reference"></a>Ссылка  
 [Директива #Const](../../../visual-basic/language-reference/directives/const-directive.md)  
  
 [Директивы #If...Then...#Else](../../../visual-basic/language-reference/directives/if-then-else-directives.md)  
  
 [/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md)
