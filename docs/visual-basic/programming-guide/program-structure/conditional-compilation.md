---
title: Условная компиляция в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- conditional compilation [Visual Basic], about conditional compilation
- compilation [Visual Basic], conditional
ms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848
ms.openlocfilehash: 4698435cb2ab15d16d8a8a898a01a9ffbc4f69c2
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64639805"
---
# <a name="conditional-compilation-in-visual-basic"></a>Условная компиляция в Visual Basic
В *условной компиляции*, одни блоки кода в программе компилируются, а остальные игнорируются.  
  
 Например, может потребоваться написать инструкций отладки, которые сравнивают скорость различные подходы к той же задачи программирования, или может потребоваться локализации приложения для нескольких языков. Условная компиляция инструкции предназначены для выполнения во время компиляции, а не во время выполнения.  
  
 Блоки кода для условной компиляции с `#If...Then...#Else` директива. Например, для создания на французском и немецком языках версии того же приложения с использованием того же исходного кода, необходимо внедрить сегменты кода платформы в `#If...Then` инструкции с помощью предопределенных констант `FrenchVersion` и `GermanVersion`. В следующем примере показано, как:  
  
 [!code-vb[VbVbalrConditionalComp#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConditionalComp/VB/Class1.vb#5)]  
  
 Если вы установите для параметра `FrenchVersion` для константы условной компиляции `True` во время компиляции, компилируется условный код для французской версии. Если вы установите для параметра `GermanVersion` константа, которая `True`, компилятор использует версия для немецкого языка. Если ни один равно `True`, код в последнем `Else` блоке.  
  
> [!NOTE]
>  Автозавершение будут не работает при редактировании кода и с помощью директив условной компиляции, если код не является частью текущей ветви.  
  
## <a name="declaring-conditional-compilation-constants"></a>Объявление констант условной компиляции  
 Константы условной компиляции можно задать одним из трех способов:  
  
- В **в конструкторе проектов**  
  
- В командной строке при использовании компилятора командной строки  
  
- В коде  
  
 Константы условной компиляции находятся в отдельной области и недоступны из обычного кода. Область константы условной компиляции, зависит от того, который имеет значение. Ниже перечислены области константы, объявленные с помощью каждого из трех описанных выше методов.  
  
|Способ задания константы|Область действия констант|  
|---|---|  
|**Конструктор проектов**|Открыта для всех файлов в проекте|  
|Командная строка|Открыта для всех файлов, передаваемые компилятору командной строки|  
|`#Const` в коде|Внутри файла, в котором она объявлена|  
  
|Чтобы задать константы в конструкторе проектов|  
|---|  
|-Прежде чем создавать исполняемый файл, задайте константы **конструктор проектов** , выполнив действия, описанные в [управление проектом и свойства решения](/visualstudio/ide/managing-project-and-solution-properties).|  
  
|Чтобы задать константы из командной строки|  
|---|  
|— Используйте **/d** вставьте константы условной компиляции, как показано в следующем примере:<br />     `vbc MyProj.vb /d:conFrenchVersion=–1:conANSI=0`<br />     Без пробела между **/d** коммутатора и первая константа. Дополнительные сведения см. в разделе [/ define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md).<br />     Объявления из командной строки переопределяют объявления в **конструктор проектов**, но не удаляют их. Задать аргументы в **конструктор проектов** остаются в силе для последующих компиляциях.<br />     При написании константы в коде, не существует strict правил по их расположению, однако их область действия всего модуля, в котором они объявлены.|  
  
|Чтобы задать константы в коде|  
|---|  
|-Установите константы в блоке объявления модуля, в котором они используются. Это позволяет сохранить код и облегчить для чтения.|  
  
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание|  
|---|---|  
|[Соглашения о структуре программы и коде](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)|Рекомендации по упрощению чтение и обслуживание кода.|  
  
## <a name="reference"></a>Ссылка  
 [Директива #Const](../../../visual-basic/language-reference/directives/const-directive.md)  
  
 [Директивы #If...Then...#Else](../../../visual-basic/language-reference/directives/if-then-else-directives.md)  
  
 [/ define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md)
