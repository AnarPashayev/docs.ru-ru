---
title: Оператор If
ms.date: 07/20/2015
f1_keywords:
- vb.IfOperator
- IfOperator
helpviewer_keywords:
- ternary operators [Visual Basic]
- conditional execution
- If expressions [Visual Basic]
- conditional operator [Visual Basic]
- If Operator [Visual Basic]
ms.assetid: dd56c9df-7cd4-442c-9ba6-20c70ee44c8f
ms.openlocfilehash: 3b45a5afe331bd00c2b92f8c305351b77bc319cf
ms.sourcegitcommit: 99b153b93bf94d0fecf7c7bcecb58ac424dfa47c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2020
ms.locfileid: "80249491"
---
# <a name="if-operator-visual-basic"></a>Оператор If (Visual Basic)

Использует оценку короткого замыкания, чтобы условно вернуть одно из двух значений. Оператор `If` может быть вызван с тремя аргументами или с двумя аргументами.

## <a name="syntax"></a>Синтаксис

```vb
If( [argument1,] argument2, argument3 )
```

## <a name="if-operator-called-with-three-arguments"></a>Если оператор называется с тремя аргументами

Когда `If` называется с помощью трех аргументов, первый аргумент должен `Boolean`оценить значение, которое может быть брошено как . Это `Boolean` значение будет определять, какой из двух других аргументов оценивается и возвращается. Следующий список применяется `If` только тогда, когда оператор вызывается с помощью трех аргументов.

### <a name="parts"></a>Компоненты

|Термин|Определение|
|---|---|
|`argument1`|Обязательный элемент. `Boolean`. Определяет, какой из других аргументов следует оценить и вернуть.|
|`argument2`|Обязательный элемент. `Object`. Оценено и `argument1` возвращено, если оценивается в `True`.|
|`argument3`|Обязательный элемент. `Object`. Оценено и `argument1` возвращено, если `False` оценивается или `argument1` если это [nullable](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md) `Boolean` переменная, которая оценивает [ничего.](../../../visual-basic/language-reference/nothing.md)|

Оператор, `If` который называется с тремя `IIf` аргументами, работает как функция, за исключением того, что он использует оценку короткого замыкания. Функция `IIf` всегда оценивает все три своих аргумента, `If` в то время как оператор, который имеет три аргумента оценивает только два из них. Первый `If` аргумент оценивается и результат `Boolean` отбрасывается как значение, `True` или `False`. Если значение `True` `argument2` оценивается и его значение возвращается, но `argument3` не оценивается. Если `Boolean` значение выражения `False` `argument3` оценивается и его значение возвращается, но `argument2` не оценивается. Следующие примеры иллюстрируют использование, `If` когда используются три аргумента:

[!code-vb[VbVbalrOperators#100](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#100)]

Следующий пример иллюстрирует значение оценки короткого замыкания. В примере показаны две `number` попытки разделить переменную по переменной, `divisor` за исключением случаев, когда `divisor` она равна нулю. В этом случае 0 должно быть возвращено, и не следует предусмотреть попытку выполнения разделения, поскольку в результате будет допущена ошибка времени выполнения. Поскольку `If` выражение использует оценку короткого замыкания, оно оценивает второй или третий аргумент, в зависимости от значения первого аргумента. Если первый аргумент верный, то делегатор не равен нулю, и можно смело оценить второй аргумент и выполнить разделение. Если первый аргумент является ложным, оценивается только третий аргумент и возвращается 0. Поэтому, когда делегатор 0, не предпринимается никаких попыток выполнения разделения и никаких ошибок. Однако, `IIf` поскольку не используется оценка короткого замыкания, второй аргумент оценивается даже тогда, когда первый аргумент является ложным. Это приводит к ошибке "разрыва за нулем" времени.

[!code-vb[VbVbalrOperators#101](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#101)]

## <a name="if-operator-called-with-two-arguments"></a>Если оператор вызывается с двумя аргументами

Первый аргумент `If` может быть опущен. Это позволяет вызывать оператора, используя только два аргумента. Следующий список применяется `If` только тогда, когда оператор вызывается с двумя аргументами.

### <a name="parts"></a>Компоненты

|Термин|Определение|
|---|---|
|`argument2`|Обязательный элемент. `Object`. Должен быть эталонный или недействительный тип значения. Оценено и возвращено когда оно `Nothing`оценивает к что-нибыдь за .|
|`argument3`|Обязательный элемент. `Object`. Оценено и `argument2` возвращено, если оценивается в `Nothing`.|

Когда `Boolean` аргумент опущен, первым аргументом должен быть тип значения ссылки или необдумируемый. Если первый аргумент `Nothing`оценивается в, значение второго аргумента возвращается. Во всех остальных случаях значение первого аргумента возвращается. Следующий пример иллюстрирует, как работает эта оценка:

[!code-vb[VbVbalrOperators#102](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#102)]

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualBasic.Interaction.IIf%2A>
- [Типы значений, допускающие значение NULL](../../programming-guide/language-features/data-types/nullable-value-types.md)
- [Nothing](../nothing.md)
