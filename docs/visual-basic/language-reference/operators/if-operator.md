---
title: Оператор If (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.IfOperator
- IfOperator
helpviewer_keywords:
- ternary operators [Visual Basic]
- conditional execution
- If expressions [Visual Basic]
- conditional operator [Visual Basic]
- If Operator [Visual Basic]
ms.assetid: dd56c9df-7cd4-442c-9ba6-20c70ee44c8f
ms.openlocfilehash: 9ab01755d75c91ce87acf83e7f406b26c466aef6
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "58834639"
---
# <a name="if-operator-visual-basic"></a>Оператор If (Visual Basic)
Использует сокращенные вычисления условно возвращать одно из двух значений. `If` Оператор может вызываться с тремя аргументами или с двумя аргументами.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
If( [argument1,] argument2, argument3 )  
```  
  
## <a name="if-operator-called-with-three-arguments"></a>Оператор If с тремя аргументами  
 Когда `If` вызывается с помощью три аргумента, первый аргумент должен иметь значение, которое может быть приведен как `Boolean`. Что `Boolean` значение будет определять, какой из двух других аргументов вычисляется и возвращается. Следующий список применяется, только если `If` оператор был вызван с тремя аргументами.  
  
## <a name="parts"></a>Части  
  
|Термин|Определение|  
|---|---|  
|`argument1`|Обязательный. `Boolean`. Определяет, какая из других аргументов для оценки и возврата.|  
|`argument2`|Обязательный. `Object`. Если вычисленное и возвращаются в `argument1` принимает значение `True`.|  
|`argument3`|Обязательный. `Object`. Если вычисленное и возвращаются в `argument1` принимает значение `False` или, если `argument1` — [Nullable](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md) `Boolean` переменной, результатом которого является [ничего не](../../../visual-basic/language-reference/nothing.md).|  
  
 `If` Оператор, который вызывается с тремя аргументами работает подобно `IIf` функции, за исключением того, что она использует сокращенным вычислением. `IIf` Функция всегда проверяет все три аргументов, тогда как `If` оператор, который имеет три аргумента принимает только два из них. Первый `If` вычисления аргумента и результат приводится к `Boolean` значение, `True` или `False`. Если значение равно `True`, `argument2` является вычисляется и возвращается его значение, но `argument3` не вычисляется. Если значение `Boolean` выражение является `False`, `argument3` является вычисляется и возвращается его значение, но `argument2` не вычисляется. Следующие примеры иллюстрируют использование `If` при использовании три аргумента:  
  
 [!code-vb[VbVbalrOperators#100](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#100)]  
  
 В следующем примере показано значение сокращенным вычислением. В примере показано две попытки деления переменной `number` переменной `divisor` кроме случая, когда `divisor` равно нулю. В этом случае должно возвращаться значение 0 и не должно быть предпринята попытка выполнить деление потому, что приведет к ошибке времени выполнения. Так как `If` использование выражений сокращенным вычислением, оно оценивается как второй или третий аргумент, в зависимости от значения первого аргумента. Если первый аргумент имеет значение true, делитель не равен нулю, и безопасно вычисления второго аргумента и деление. Если первый аргумент имеет значение false, вычисляется только третий аргумент, и возвращается значение 0. Таким образом, если делитель равен 0, не предпринимается попытка выполнить деление и ошибка не появляется. Тем не менее поскольку `IIf` не использует сокращенные вычисления, второй аргумент вычисляется даже в том случае, если первый аргумент имеет значение false. Это приводит к ошибке деления на ноль во время выполнения.  
  
 [!code-vb[VbVbalrOperators#101](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#101)]  
  
## <a name="if-operator-called-with-two-arguments"></a>Оператор If с двумя аргументами  
 Первый аргумент `If` можно опустить. Благодаря этому оператор, вызываемый с помощью только два аргумента. Следующий список применяется, только если `If` оператор был вызван с двумя аргументами.  
  
## <a name="parts"></a>Части  
  
|Термин|Определение|  
|---|---|  
|`argument2`|Обязательный. `Object`. Должен быть ссылкой или тип, допускающий значение NULL. Вычисляется и возвращается, если оно оценивается как-либо отличное от `Nothing`.|  
|`argument3`|Обязательный. `Object`. Если вычисленное и возвращаются в `argument2` принимает значение `Nothing`.|  
  
 Когда `Boolean` аргумент указан, первый аргумент должен быть ссылкой или тип, допускающий значение NULL. Если первый аргумент принимает значение `Nothing`, возвращается значение второго аргумента. Во всех остальных случаях возвращается значение первого аргумента. В следующем примере показано, как работает это вычисление.  
  
 [!code-vb[VbVbalrOperators#102](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#102)]  
  
## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualBasic.Interaction.IIf%2A>
- [Типы значений, допускающие значение NULL](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)
- [Nothing](../../../visual-basic/language-reference/nothing.md)
