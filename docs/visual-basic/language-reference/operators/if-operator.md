---
title: Оператор If (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.IfOperator
- IfOperator
helpviewer_keywords:
- ternary operators [Visual Basic]
- conditional execution
- If expressions [Visual Basic]
- conditional operator [Visual Basic]
- If Operator [Visual Basic]
ms.assetid: dd56c9df-7cd4-442c-9ba6-20c70ee44c8f
ms.openlocfilehash: 483b58dd9c79c716fdc3d272cf699e33dec9c671
ms.sourcegitcommit: 9bd1c09128e012b6e34bdcbdf3576379f58f3137
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/23/2019
ms.locfileid: "72799009"
---
# <a name="if-operator-visual-basic"></a>Оператор If (Visual Basic)

Использует сокращенную оценку, чтобы условно вернуть одно из двух значений. Оператор `If` может быть вызван с тремя аргументами или с двумя аргументами.

## <a name="syntax"></a>Синтаксис

```vb
If( [argument1,] argument2, argument3 )
```

## <a name="if-operator-called-with-three-arguments"></a>Оператор If с тремя аргументами

Если `If` вызывается с помощью трех аргументов, первый аргумент должен иметь значение, которое можно привести как `Boolean`. Это значение `Boolean` определит, какое из двух других аргументов вычисляется и возвращается. Следующий список применяется только в том случае, если оператор `If` вызывается с помощью трех аргументов.

### <a name="parts"></a>Части

|Термин|Определение|
|---|---|
|`argument1`|Обязательный. `Boolean` Определяет, какие из других аргументов следует вычислить и вернуть.|
|`argument2`|Обязательный. `Object` Вычисляется и возвращается, если `argument1` вычисляется как `True`.|
|`argument3`|Обязательный. `Object` Вычисляется и возвращается, если `argument1` принимает значение `False` или если `argument1` является [обнуляемым](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)`Boolean` переменной, результатом которой является [Nothing](../../../visual-basic/language-reference/nothing.md).|

Оператор `If`, который вызывается с тремя аргументами, работает как функция `IIf`, за исключением того, что он использует сокращенную оценку. Функция `IIf` всегда вычисляет все три аргумента, в то время как оператор `If` с тремя аргументами вычисляет только два из них. Первый аргумент `If` вычисляется, а результат приводится как `Boolean`ое значение, `True` или `False`. Если значение равно `True`, вычисляется `argument2` и возвращается его значение, но `argument3` не вычисляется. Если значение `Boolean` выражения `False`, вычисляется `argument3` и возвращается его значение, но `argument2` не вычисляется. В следующих примерах показано использование `If` при использовании трех аргументов:

[!code-vb[VbVbalrOperators#100](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#100)]

В следующем примере показано значение сокращенного вычисления. В примере показаны две попытки деления переменной `number` переменной `divisor`, за исключением случаев, когда `divisor` равен нулю. В этом случае возвращается значение 0, и для выполнения деления не нужно предпринимать никаких попыток, поскольку это приведет к ошибке времени выполнения. Поскольку выражение `If` использует сокращенное вычисление, оно вычисляет второй или третий аргумент в зависимости от значения первого аргумента. Если первый аргумент имеет значение true, то делитель не равен нулю и может быть защищен для вычисления второго аргумента и выполнения деления. Если первый аргумент имеет значение false, то вычисляется только третий аргумент и возвращается значение 0. Таким образом, если делитель равен 0, попытки выполнить деление не выполняются и результаты ошибок не выводятся. Однако, поскольку `IIf` не использует сокращенную оценку, второй аргумент вычисляется даже в том случае, если первый аргумент имеет значение false. Это приводит к ошибке деления на ноль во время выполнения.

[!code-vb[VbVbalrOperators#101](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#101)]

## <a name="if-operator-called-with-two-arguments"></a>Оператор If с двумя аргументами

Первый аргумент для `If` можно опустить. Это позволяет вызывать оператор, используя только два аргумента. Следующий список применяется только в том случае, если оператор `If` вызывается с двумя аргументами.

### <a name="parts"></a>Части

|Термин|Определение|
|---|---|
|`argument2`|Обязательный. `Object` Должен быть ссылкой или типом, допускающим значение null. Вычисляется и возвращается, если он равен чему-либо, кроме `Nothing`.|
|`argument3`|Обязательный. `Object` Вычисляется и возвращается, если `argument2` вычисляется как `Nothing`.|

Если аргумент `Boolean` опущен, первый аргумент должен быть ссылкой или типом, допускающим значение null. Если первый аргумент равен `Nothing`, возвращается значение второго аргумента. Во всех остальных случаях возвращается значение первого аргумента. В следующем примере показано, как работает эта оценка.

[!code-vb[VbVbalrOperators#102](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#102)]

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualBasic.Interaction.IIf%2A>
- [Типы значений, допускающие значение NULL](../../programming-guide/language-features/data-types/nullable-value-types.md)
- [Nothing](../nothing.md)
