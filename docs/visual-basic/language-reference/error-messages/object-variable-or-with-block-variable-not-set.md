---
title: Не задана переменная объекта или переменная блока With
ms.date: 07/20/2015
f1_keywords:
- vbrID91
ms.assetid: 2f03e611-f0ed-465c-99a2-a816e034faa3
ms.openlocfilehash: 07c215d373e4ac1cbadf82a48b8cb3d90efdbdb4
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2019
ms.locfileid: "70040558"
---
# <a name="object-variable-or-with-block-variable-not-set"></a>Не задана переменная объекта или переменная блока With
Указана недопустимая объектная переменная.   Эта ошибка может возникать по нескольким причинам:

- Переменная объявлена без указания типа. Если переменная объявлена без указания типа, по умолчанию используется тип `Object`.

    Например, переменная, объявленная с `Dim x` типом, будет иметь `Object;` тип переменной, объявленной с `Dim x As String` типом `String`.

    > [!TIP]
    > Оператор запрещает неявную типизацию, которая приводит к `Object` типу. `Option Strict` Если опустить тип, возникнет ошибка времени компиляции. См. [оператор Option Case](../../../visual-basic/language-reference/statements/option-strict-statement.md).

- Предпринимается попытка сослаться на объект, для `Nothing`которого задано значение.

- Предпринята попытка получить доступ к элементу переменной массива, которая была неправильно объявлена.

    Например, массив, объявленный как `products() As String` , вызовет ошибку при попытке сослаться на элемент массива. `products(3) = "Widget"` Массив не содержит элементов и обрабатывается как объект.

- Попытка получить доступ к коду в `With...End With` блоке до инициализации блока.   Блок необходимо инициализировать, `With` выполнив точку входа оператора. `With...End With`

> [!NOTE]
> В более ранних версиях Visual Basic или VBA эта ошибка также была активирована путем присвоения значения переменной без использования `Set` ключевого слова (`x = "name"` вместо `Set x = "name"`). `Set` Ключевое слово больше не является допустимым в Visual Basic .NET.

## <a name="to-correct-this-error"></a>Исправление ошибки

1. Задайте `Option Strict` для`On` значение, добавив следующий код в начало файла:

    ```vb
    Option Strict On
    ```

    При запуске проекта в **Список ошибок** для любой переменной, указанной без типа, отобразится ошибка компилятора.

2. Если вы не хотите включать `Option Strict`, найдите в коде любые переменные, которые были указаны без типа (`Dim x` вместо `Dim x As String`), и добавьте предполагаемый тип к объявлению.

3. Убедитесь, что вы не ссылаетесь на переменную объекта, для `Nothing`которой было задано значение.  Найдите ключевое слово `Nothing`в коде и измените код таким образом, чтобы объект не был установлен в `Nothing` значение до тех пор, пока вы не задали ссылку на него.

4. Прежде чем обращаться к ним, убедитесь, что все переменные массива имеют размеры. Можно либо назначить измерение при первом создании массива (`Dim x(5) As String` `Dim x() As String`вместо `ReDim` ), либо использовать ключевое слово, чтобы задать размеры массива до первого доступа к нему.

5. Убедитесь, что `With` блок инициализирован путем `With` выполнения точки входа оператора.

## <a name="see-also"></a>См. также

- [Объявление объектной переменной](../../../visual-basic/programming-guide/language-features/variables/object-variable-declaration.md)
- [Оператор reDim](../../../visual-basic/language-reference/statements/redim-statement.md)
- [Оператор With...End With](../../../visual-basic/language-reference/statements/with-end-with-statement.md)
