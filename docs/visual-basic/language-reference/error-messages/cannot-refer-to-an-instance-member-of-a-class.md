---
title: Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса
ms.date: 07/20/2015
f1_keywords:
- vbc30369
- bc30369
helpviewer_keywords:
- Shared
- BC30369
ms.assetid: 39d9466b-c1f3-4406-91a5-3d6c52d23a3d
ms.openlocfilehash: aad068b5857eb956ded63fa2a57cb163d3cf5c58
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62013846"
---
# <a name="cannot-refer-to-an-instance-member-of-a-class-from-within-a-shared-method-or-shared-member-initializer-without-an-explicit-instance-of-the-class"></a>Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса
Вы попытались ссылается на член, не являющийся общим класса из общей процедуры. Ниже приведен пример такой ситуации.  
  
```  
Class sample  
    Public x as Integer  
    Public Shared Sub setX()  
        x = 10  
    End Sub  
End Class  
```  
  
 В предыдущем примере, оператор присваивания `x = 10` это сообщение об ошибке. Это обусловлено тем, общая процедура пытается получить доступ к переменной экземпляра.  
  
 Переменная `x` является членом экземпляра, так как он не объявлен как [Shared](../../../visual-basic/language-reference/modifiers/shared.md). Каждый экземпляр класса `sample` содержит собственные переменные `x`. Когда один экземпляр задает или изменяет значение `x`, он не влияет на значение `x` в других экземплярах.  
  
 Однако процедура `setX` — `Shared` среди всех экземпляров класса `sample`. Это означает, что он не связан с любого экземпляра класса, но вместо этого работает независимо от отдельных экземпляров. Так как она не связана с конкретным экземпляром, `setX` не может обращаться к переменной экземпляра. Она должна работать только с `Shared` переменные. Когда `setX` задает или изменяет значение общей переменной, что новое значение становится доступным для всех экземпляров класса.  
  
 **Идентификатор ошибки:** BC30369  
  
## <a name="to-correct-this-error"></a>Исправление ошибки  
  
1. Должен ли элемент общим для всех экземпляров класса, или хранить отдельно для каждого экземпляра.  
  
2. Одна копия элемент общим для всех экземпляров, добавьте `Shared` ключевое слово в объявлении члена. Сохранить `Shared` ключевое слово в объявлении процедуры.  
  
3. Если требуется, чтобы каждый экземпляр для отдельных копия элемента, не указывайте `Shared` для объявления элемента. Удалить `Shared` ключевое слово из объявления процедуры.  
  
## <a name="see-also"></a>См. также

- [Общие](../../../visual-basic/language-reference/modifiers/shared.md)
