---
title: Оператор Delegate
ms.date: 07/20/2015
f1_keywords:
- vb.Delegate
helpviewer_keywords:
- delegate keyword [Visual Basic]
- Delegate statement [Visual Basic]
ms.assetid: f799c518-0817-40cc-ad0b-4da846fdba57
ms.openlocfilehash: 662d2c3c0767adfe406e0a6f1b1e6dccd704e795
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74354075"
---
# <a name="delegate-statement"></a>Оператор Delegate
Используется для объявления делегата. Делегат — это ссылочный тип, который ссылается на метод `Shared` типа или на метод экземпляра объекта. Для создания экземпляра этого класса делегата можно использовать любую процедуру с соответствующими параметрами и типами возвращаемых данных. Затем процедуру можно вызвать позже с помощью экземпляра делегата.  
  
## <a name="syntax"></a>Синтаксис  
  
```vb  
[ <attrlist> ] [ accessmodifier ] _  
[ Shadows ] Delegate [ Sub | Function ] name [( Of typeparamlist )] [([ parameterlist ])] [ As type ]  
```  
  
## <a name="parts"></a>Части  
  
|Термин|Определение|  
|---|---|  
|`attrlist`|Необязательно. Список атрибутов, применяемых к этому делегату. Несколько атрибутов разделяются запятыми. [Список атрибутов](../../../visual-basic/language-reference/statements/attribute-list.md) необходимо заключить в угловые скобки ("`<`" и "`>`").|  
|`accessmodifier`|Необязательно. Указывает, какой код может получить доступ к делегату. Ниже указаны доступные значения.<br /><br /> - [общедоступная](../../../visual-basic/language-reference/modifiers/public.md). Любой код, который может получить доступ к элементу, который объявляет делегат, может получить к нему доступ.<br />-   [защищено](../../../visual-basic/language-reference/modifiers/protected.md). Доступ к нему могут получить только код внутри класса делегата или производного класса.<br />-   [Friend](../../../visual-basic/language-reference/modifiers/friend.md). Доступ к делегату могут получить только код в той же сборке.<br />- [закрытый](../../../visual-basic/language-reference/modifiers/private.md). Только код внутри элемента, объявляющего делегат, может получить к нему доступ.<br /><br /> - [защищенный дружественный](../../language-reference/modifiers/protected-friend.md) код только внутри класса делегата, производного класса или той же сборки может получить доступ к делегату. <br />- [закрытый защищенный](../../language-reference/modifiers/private-protected.md) код в классе делегата или в производном классе в той же сборке может получить доступ к делегату. |  
|`Shadows`|Необязательно. Указывает, что этот делегат повторно объявляет и скрывает идентично именованный элемент программирования или набор перегруженных элементов в базовом классе. Можно скрыть любой тип объявленного элемента, используя любой другой тип.<br /><br /> Скрытый элемент недоступен из производного класса, который его скрывает, за исключением тех классов, из которых недоступен скрывающий элемент. Например, если элемент `Private` затеняет элемент базового класса, код, который не имеет разрешения на доступ к элементу `Private`, вместо этого обращается к элементу базового класса.|  
|`Sub`|Необязательно, но должен появиться либо `Sub`, либо `Function`. Объявляет эту процедуру как делегат `Sub` процедуру, которая не возвращает значение.|  
|`Function`|Необязательно, но должен появиться либо `Sub`, либо `Function`. Объявляет эту процедуру как делегат `Function` процедуру, возвращающую значение.|  
|`name`|Обязательно. Имя типа делегата; соответствует стандартным соглашениям об именовании переменных.|  
|`typeparamlist`|Необязательно. Список параметров типа для этого делегата. Несколько параметров типа разделяются запятыми. При необходимости каждый параметр типа можно объявить как Variant с помощью `In` и `Out` универсальных модификаторов. Необходимо заключить [список типов](../../../visual-basic/language-reference/statements/type-list.md) в круглые скобки и ввести ключевое слово `Of`.|  
|`parameterlist`|Необязательно. Список параметров, которые передаются в процедуру при ее вызове. [Список параметров](../../../visual-basic/language-reference/statements/parameter-list.md) необходимо заключить в круглые скобки.|  
|`type`|Требуется, если указана процедура `Function`. Тип данных возвращаемого значения.|  
  
## <a name="remarks"></a>Заметки  
 Оператор `Delegate` определяет параметры и возвращаемые типы класса делегата. Для создания экземпляра этого класса делегата можно использовать любую процедуру с соответствующими параметрами и типами возвращаемых данных. Затем процедуру можно вызвать с помощью экземпляра делегата, вызвав метод `Invoke` делегата.  
  
 Делегаты могут быть объявлены на уровне пространства имен, модуля, класса или структуры, но не внутри процедуры.  
  
 Каждый класс делегата определяет конструктор, которому передается спецификация метода объекта. Аргумент конструктора делегата должен быть ссылкой на метод или лямбда-выражение.  
  
 Чтобы указать ссылку на метод, используйте следующий синтаксис:  
  
 `AddressOf` [`expression`.]`methodname`  
  
 Тип `expression` во время компиляции должен представлять собой имя класса или интерфейса, который содержит метод с указанным именем, сигнатура которого соответствует сигнатуре класса делегата. `methodname` должен быть общим методом или методом экземпляра. `methodname` всегда является обязательным, даже если делегат создается для метода по умолчанию в классе.  
  
 Чтобы указать лямбда-выражение, используйте следующий синтаксис:  
  
 `Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`  
  
 Сигнатура функции должна соответствовать сигнатуре типа делегата. Дополнительные сведения о лямбда-выражениях см. в разделе [Лямбда-выражения](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).  
  
 и [делегатах](../../../visual-basic/programming-guide/language-features/delegates/index.md).  
  
## <a name="example"></a>Пример  
 В следующем примере оператор `Delegate` используется для объявления делегата для работы с двумя числами и возвращения числа. Метод `DelegateTest` принимает экземпляр делегата этого типа и использует его для работы с парами чисел.  
  
 [!code-vb[VbVbalrDelegates#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#14)]  
  
## <a name="see-also"></a>См. также

- [Оператор AddressOf](../../../visual-basic/language-reference/operators/addressof-operator.md)
- [Of](../../../visual-basic/language-reference/statements/of-clause.md)
- [Делегаты](../../../visual-basic/programming-guide/language-features/delegates/index.md)
- [Практическое руководство. Использование универсального класса](../../../visual-basic/programming-guide/language-features/data-types/how-to-use-a-generic-class.md)
- [Generic Types in Visual Basic](../../../visual-basic/programming-guide/language-features/data-types/generic-types.md)
- [Ковариация и контрвариантность](../../programming-guide/concepts/covariance-contravariance/index.md)
- [In](../../../visual-basic/language-reference/modifiers/in-generic-modifier.md)
- [Out](../../../visual-basic/language-reference/modifiers/out-generic-modifier.md)
