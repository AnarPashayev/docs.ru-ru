---
title: Оператор Const (Visual Basic)
ms.date: 05/12/2018
f1_keywords:
- vb.Const
helpviewer_keywords:
- Const statement [Visual Basic]
ms.assetid: 495b318d-b7c5-4198-94f8-0790a541b07a
ms.openlocfilehash: 522ac71767707ae90a3f1d11d45ef8b29471ae6c
ms.sourcegitcommit: eff6adb61852369ab690f3f047818c90580e7eb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/07/2019
ms.locfileid: "72005123"
---
# <a name="const-statement-visual-basic"></a>Оператор Const (Visual Basic)
Объявляет и определяет одну или несколько констант.  
  
## <a name="syntax"></a>Синтаксис  
  
```vb  
[ <attributelist> ] [ accessmodifier ] [ Shadows ]   
Const constantlist  
```  
  
## <a name="parts"></a>Части  
 `attributelist`  
 Необязательный параметр. Список атрибутов, которые применяются ко всем константам, объявленным в этой инструкции. См. [список атрибутов](../../../visual-basic/language-reference/statements/attribute-list.md) в угловых скобках ("`<`" и "`>`").  
  
 `accessmodifier`  
 Необязательный параметр. Используйте его, чтобы указать, какой код может получить доступ к этим константам. Может быть [общедоступным](../../../visual-basic/language-reference/modifiers/public.md), [защищенным](../../../visual-basic/language-reference/modifiers/protected.md), [дружественным](../../../visual-basic/language-reference/modifiers/friend.md), [защищенным дружественным](../modifiers/protected-friend.md), [частным](../../../visual-basic/language-reference/modifiers/private.md)или [частным](../../language-reference/modifiers/private-protected.md).
  
 `Shadows`  
 Необязательный параметр. Используйте его для повторного объявления и скрытия программного элемента в базовом классе. См. раздел [Shadows](../../../visual-basic/language-reference/modifiers/shadows.md).  
  
 `constantlist`  
 Обязательный. Список констант, объявляемых в этой инструкции.  
  
 `constant` `[ ,` `constant` `... ]`  
  
 Каждый элемент `constant` имеет перечисленные ниже синтаксис и компоненты.  
  
 `constantname` `[ As` `datatype` `] =` `initializer`  
  
|Отделение|Описание|  
|----------|-----------------|  
|`constantname`|Обязательный. Имя константы. См. раздел [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md).|  
|`datatype`|Требуется, если `Option Strict` имеет значение `On`. Тип данных константы.|  
|`initializer`|Обязательный. Выражение, которое вычисляется во время компиляции и присваивается константе.|  
  
## <a name="remarks"></a>Примечания  
 Если у вас есть значение, которое никогда не изменяется в приложении, можно определить именованную константу и использовать ее вместо литерального значения. Имя проще запомнить, чем значение. Вы можете определить константу только один раз и использовать ее во многих местах кода. Если в более поздней версии необходимо переопределить значение, то только `Const` — единственное место, необходимое для внесения изменений.  
  
 @No__t-0 можно использовать только на уровне модуля или процедуры. Это означает, что *контекст объявления* для переменной должен быть классом, структурой, модулем, процедурой или блоком и не может быть исходным файлом, пространством имен или интерфейсом. Дополнительные сведения см. в разделе [Контексты объявления и уровни доступа по умолчанию](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).  
  
 Локальные константы (внутри процедуры) по умолчанию имеют открытый доступ, и в них нельзя использовать какие-либо модификаторы доступа. Константы класса и члена модуля (вне любой процедуры) по умолчанию имеют частный доступ, а константы членов структуры по умолчанию имеют открытый доступ. Уровни доступа можно изменить с помощью модификаторов доступа.  
  
## <a name="rules"></a>Правила  
  
- **Контекст объявления.** Константа, объявленная на уровне модуля вне любой процедуры, является *константой-членом*; Он является членом класса, структуры или модуля, объявляющего его.  
  
     Константа, объявленная на уровне процедуры, является *локальной константой*; Он является локальным для процедуры или блока, объявляющего ее.  
  
- **Атрибута.** Атрибуты можно применять только к константам членов, а не к локальным константам. Атрибут вносит сведения в метаданные сборки, что не имеет смысла для временного хранения, например локальных констант.  
  
- **Модификаторы.** По умолчанию все константы имеют `Shared`, `Static` и `ReadOnly`. При объявлении константы нельзя использовать какие-либо из этих ключевых слов.  
  
     На уровне процедуры нельзя использовать `Shadows` или модификаторы доступа для объявления локальных констант.  
  
- **Несколько констант.** В одном операторе объявления можно объявить несколько констант, указав для каждого из них значение `constantname`. Несколько констант разделяются запятыми.  
  
## <a name="data-type-rules"></a>Правила типов данных  
  
- **Типы данных.** Оператор `Const` может объявлять тип данных переменной. Можно указать любой тип данных или имя перечисления.  
  
- **Тип по умолчанию.** Если не указать `datatype`, константа принимает тип данных `initializer`. Если указать как `datatype`, так и `initializer`, тип данных `initializer` должен быть преобразован в `datatype`. Если ни `datatype`, ни `initializer` отсутствует, по умолчанию используется тип данных `Object`.  
  
- **Различные типы.** Можно указать различные типы данных для разных констант, используя отдельное предложение `As` для каждой объявляемой переменной. Однако нельзя объявить несколько констант, имеющих один и тот же тип, используя общее предложение `As`.  
  
- **Инициализации.** Необходимо инициализировать значение каждой константы в `constantlist`. Чтобы указать выражение, присваиваемое константе, используется `initializer`. Выражение может быть любым сочетанием литералов, других уже определенных констант и уже определенных элементов перечисления. Для объединения таких элементов можно использовать арифметические и логические операторы.  
  
     Нельзя использовать переменные или функции в `initializer`. Однако можно использовать ключевые слова преобразования, такие как `CByte` и `CShort`. Можно также использовать `AscW`, если вы вызываете его с константой `String` или `Char`, так как это может быть вычислено во время компиляции.  
  
## <a name="behavior"></a>Поведение  
  
- **Которых.** Локальные константы доступны только в пределах их процедуры или блока. Константы членов доступны из любого места в своем классе, структуре или модуле.  
  
- **Квалификацию.** Код за пределами класса, структуры или модуля должен уточнять имя константы-члена именем этого класса, структуры или модуля. Код за пределами процедуры или блока не может ссылаться на любые локальные константы в этой процедуре или блоке.  
  
## <a name="example"></a>Пример  
 В следующем примере оператор `Const` используется для объявления констант для использования вместо литеральных значений.  
  
 [!code-vb[VbVbalrStatements#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#13)]  
  
## <a name="example"></a>Пример  
 Если вы определяете константу с типом данных `Object`, компилятор Visual Basic присваивает ему тип `initializer`, а не `Object`. В следующем примере константа `naturalLogBase` имеет тип времени выполнения `Decimal`.  
  
 [!code-vb[VbVbalrStatements#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#87)]  
  
 В предыдущем примере используется метод <xref:System.Type.ToString%2A> для объекта <xref:System.Type>, возвращаемого [оператором GetType](../../../visual-basic/language-reference/operators/gettype-operator.md), так как <xref:System.Type> не может быть преобразован в `String` с помощью `CStr`.  
  
## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualBasic.Strings.Asc%2A>
- <xref:Microsoft.VisualBasic.Strings.AscW%2A>
- [Оператор Enum](../../../visual-basic/language-reference/statements/enum-statement.md)
- [Директива #Const](../../../visual-basic/language-reference/directives/const-directive.md)
- [Оператор Dim](../../../visual-basic/language-reference/statements/dim-statement.md)
- [Оператор reDim](../../../visual-basic/language-reference/statements/redim-statement.md)
- [Явные и неявные преобразования](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)
- [Константы и перечисления](../../../visual-basic/programming-guide/language-features/constants-enums/index.md)
- [Константы и перечисления](../../../visual-basic/language-reference/constants-and-enumerations.md)
- [Функции преобразования типов](../../../visual-basic/language-reference/functions/type-conversion-functions.md)
