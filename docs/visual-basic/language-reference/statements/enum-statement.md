---
title: Оператор Enum (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.Enum
helpviewer_keywords:
- enumerated constants [Visual Basic]
- Enum statement [Visual Basic]
- Private keyword [Visual Basic], Enum statements
- Public keyword [Visual Basic], in Enum statement
- variables [Visual Basic], enumeration
- constants [Visual Basic], enumerated
ms.assetid: a45e51f1-65ff-48e1-bf32-79130f137377
ms.openlocfilehash: 0a761c39b51a8d71919a84cbbbf6739fc1f5bcea
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64754616"
---
# <a name="enum-statement-visual-basic"></a>Оператор Enum (Visual Basic)

Объявляет перечисление и определяет значения его членов.

## <a name="syntax"></a>Синтаксис

```
[ <attributelist> ] [ accessmodifier ]  [ Shadows ]
Enum enumerationname [ As datatype ]
   memberlist
End Enum
```

## <a name="parts"></a>Части

- `attributelist`

  Необязательный параметр. Список атрибутов, применяемых к этому перечислению. Необходимо заключить [список атрибутов](../../../visual-basic/language-reference/statements/attribute-list.md) в угловые скобки (»`<`«и»`>`«).

  <xref:System.FlagsAttribute> Атрибут указывает, что значение экземпляра перечисления может содержать несколько членов перечисления, и что каждый элемент представляет собой битовое поле, в значение перечисления.

- `accessmodifier`

  Необязательный параметр. Указывает, какой код может обращаться к этого перечисления. Ниже указаны доступные значения.

  - [Public](../../../visual-basic/language-reference/modifiers/public.md)

  - [Protected](../../../visual-basic/language-reference/modifiers/protected.md)

  - [Friend](../../../visual-basic/language-reference/modifiers/friend.md)

  - [Закрытые](../../../visual-basic/language-reference/modifiers/private.md)

  - [Protected Friend](../../language-reference/modifiers/protected-friend.md)

  - [Private Protected](../../language-reference/modifiers/private-protected.md)

- `Shadows`

  Необязательный параметр. Указывает, что это перечисление повторно объявляет и скрывает одинаково названные элементы программирования или набор перегруженных элементов в базовом классе. Можно указать [Shadows](../../../visual-basic/language-reference/modifiers/shadows.md) только на самом перечислении, а не на любой из его элементов.

- `enumerationname`

  Обязательный. Имя перечисления. Сведения о допустимых именах см. в разделе [имена объявленных элементов](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md).

- `datatype`

  Необязательный параметр. Тип данных перечисления и все его члены.

- `memberlist`

  Обязательный. Список констант элементов, объявляемых в данной инструкции. Несколько элементов отображаются на отдельных строках исходного кода.

  Каждый `member` имеет следующие синтаксис и составляющие: `[<attribute list>] member name [ = initializer ]`

  |Отделение|Описание|
  |---|---|
  |`membername`|Обязательный. Имя данного элемента.|
  |`initializer`|Необязательный параметр. Выражение, вычисляемое во время компиляции и назначены этому члену.|

- `End` `Enum`

  Завершает блок `Enum`.

## <a name="remarks"></a>Примечания

Если у вас есть набор неизменных значений, логически связанных друг с другом, их можно определить друг с другом в перечислении. Это обеспечивает значимые имена для перечисления и его элементы, которые являются легче для запоминания, чем их значения. Затем можно использовать члены перечисления во многих местах в коде.

Преимущества использования перечисления включают следующее:

- Сокращает число ошибок, вызванных перемещением или неправильным вводом значений.

- Позволяет легко изменять значения в будущем.

- Делает код более удобным для чтения, это означает, что маловероятно, что появилось новых ошибок.

- Обеспечение прямой совместимости. Если вы используете перечисления, код является менее вероятны ошибки, если в будущем кто-то изменяет значения, соответствующие именам элементов.

Перечисление имеет имя, базовый тип данных и набор элементов. Каждый элемент представляет константу.

Перечисление, объявленные на уровне класса, структуры, модуля или интерфейс, вне любых процедур — *член перечисления*. Он является членом класса, структуры, модуля или интерфейса, объявляющего его.

Член перечисления может быть организован в любом месте в пределах их класса, структуры, модуля или интерфейса. Код вне класса, структуры или модуля необходимо указать имя перечисления элементов с именем этого класса, структуры или модуля. Можно избежать необходимости использовать полные имена, добавив [Imports](../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md) инструкции к исходному файлу.

Перечисление, объявленное на уровне пространства имен, за пределами класса, структуры, модуля или интерфейса, является членом пространства имен, в котором он находится.

*Контекст объявления* для перечисления должен быть исходный файл, пространство имен, класс, структура, модуль или интерфейс, а не может быть процедурой. Дополнительные сведения см. в разделе [Контексты объявления и уровни доступа по умолчанию](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).

Можно применять атрибуты к перечислению в целом, но не к его членам по отдельности. Атрибут вносит сведения для метаданных сборки.

## <a name="data-type"></a>Тип данных

`Enum` Инструкции можно объявить тип данных перечисления. Каждый элемент имеет тип данных перечисления. Можно указать `Byte`, `Integer`, `Long`, `SByte`, `Short`, `UInteger`, `ULong`, или `UShort`.

Если вы не укажете `datatype` для перечисления, каждый элемент имеет тип данных его `initializer`. Если задан и `datatype` и `initializer`, тип данных `initializer` должно быть преобразуемым в `datatype`. Если ни один из `datatype` , ни `initializer` присутствует, по умолчанию тип данных `Integer`.

## <a name="initializing-members"></a>Инициализация членов

`Enum` Оператор может инициализировать содержимое выбранных элементов в `memberlist`. Использовании `initializer` позволяет указать выражение для назначения к элементу.

Если вы не укажете `initializer` для члена, Visual Basic инициализирует его, либо до нуля (если он является первым `member` в `memberlist`), или значение на единицу, чем непосредственно перед `member`.

Выражения, предоставленного в каждом `initializer` может быть любое сочетание литералов, другие константы, которые уже определены и членов перечисления, которые уже определены, включая предыдущего члена этого перечисления. Арифметические и логические операторы можно использовать для объединения этих элементов.

Нельзя использовать переменные или функции в `initializer`. Тем не менее, можно использовать ключевое слово преобразования, такие как `CByte` и `CShort`. Можно также использовать `AscW` при ее вызове с константой `String` или `Char` аргумент, поскольку, может быть вычислено во время компиляции.

Перечисления не могут иметь значения с плавающей запятой. Если члену присваивается значение с плавающей запятой и `Option Strict` установлен в значение on, возникает ошибка компилятора. Если `Option Strict` выключен, то значение автоматически преобразуется в `Enum` типа.

Если значение элемента, превышает диапазон допустимых значений для базового типа данных или инициализации любого члена, максимальное значение для базового типа данных, компилятор сообщает об ошибке.

## <a name="modifiers"></a>Модификаторы

Класс, структура, модуль и интерфейс элемента перечисления по умолчанию для общего доступа. Вы можете настроить уровни доступа с помощью модификаторов доступа. Пространство имен члены перечисления по умолчанию дружественный доступ. Вы можете настроить уровни доступа к общедоступным, но не к закрытым или защищенным. Дополнительные сведения см. в разделе [уровни в Visual Basic доступа](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md).

Все члены перечисления имеют общий доступ, и их невозможно использовать модификаторы доступа. Тем не менее если перечисление само имеет более ограниченный уровень доступа, указанный уровень доступа перечисления имеет приоритет.

По умолчанию все перечисления являются типами и их полей являются константами. Таким образом `Shared`, `Static`, и `ReadOnly` ключевые слова нельзя использовать при объявлении перечисления или его элементов.

## <a name="assigning-multiple-values"></a>Назначение нескольких значений

Перечисления обычно представляют собой взаимоисключающие значения. Включив <xref:System.FlagsAttribute> атрибут в `Enum` объявление, можно вместо этого назначить несколько значений экземпляра перечисления. <xref:System.FlagsAttribute> Атрибут указывает, что перечисление рассматриваться как битовое поле, то есть набор флагов. Они называются *побитовое* перечисления.

При объявлении перечисления с помощью <xref:System.FlagsAttribute> атрибут, мы рекомендуем использовать степени числа 2, который является, 1, 2, 4, 8, 16 и т. д., для значений. Мы также рекомендуем использовать «None» имя элемента, значение которого равно 0. Дополнительные рекомендации см. в разделе <xref:System.FlagsAttribute> и <xref:System.Enum>.

## <a name="example"></a>Пример

В следующем примере показано использование оператора `Enum`. Обратите внимание, что элемент называется `EggSizeEnum.Medium`, а не как `Medium`.

[!code-vb[VbEnumsTask#41](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class1.vb#41)]

## <a name="example"></a>Пример

В следующем примере метод находится за пределами `Egg` класса. Таким образом `EggSizeEnum` полностью принимается в качестве `Egg.EggSizeEnum`.

[!code-vb[VbEnumsTask#42](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class1.vb#42)]

## <a name="example"></a>Пример

В следующем примере используется `Enum` инструкции для определения связанного набора именованных констант. В этом случае значения являются цветами, которые можно выбрать для создаваемых форм ввода данных для базы данных.

[!code-vb[VbEnumsTask#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class2.vb#30)]

## <a name="example"></a>Пример

Пример значения, включающих положительные и отрицательные числа.

[!code-vb[VbEnumsTask#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class2.vb#31)]

## <a name="example"></a>Пример

В следующем примере `As` предложение используется для указания `datatype` перечисления.

[!code-vb[VbEnumsTask#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class2.vb#6)]

## <a name="example"></a>Пример

Приведенный ниже показано, как использовать побитовое перечисление. Несколько значений могут назначаться экземпляр побитового перечисления. `Enum` Объявление включает в себя <xref:System.FlagsAttribute> атрибут, который указывает, что перечисление может обрабатываться как набор флагов.

[!code-vb[VbEnumsTask#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class1.vb#61)]

## <a name="example"></a>Пример

Приведенный ниже пример проходит через перечисления. Она использует <xref:System.Enum.GetNames%2A> метод для получения массива имен членов из перечисления, и <xref:System.Enum.GetValues%2A> для извлечения массива значений элементов.

[!code-vb[VbEnumsTask#51](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbEnumsTask/VB/Class1.vb#51)]

## <a name="see-also"></a>См. также

- <xref:System.Enum>
- <xref:Microsoft.VisualBasic.Strings.AscW%2A>
- [Оператор Const](../../../visual-basic/language-reference/statements/const-statement.md)
- [Оператор Dim](../../../visual-basic/language-reference/statements/dim-statement.md)
- [Явные и неявные преобразования](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)
- [Функции преобразования типов](../../../visual-basic/language-reference/functions/type-conversion-functions.md)
- [Константы и перечисления](../../../visual-basic/language-reference/constants-and-enumerations.md)
