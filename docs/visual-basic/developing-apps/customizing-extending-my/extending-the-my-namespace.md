---
title: Расширение пространства имен My в Visual Basic
ms.date: 07/20/2015
f1_keywords:
- vb.AddingMyExtensions
helpviewer_keywords:
- My namespace [Visual Basic], customizing
- My namespace
- My namespace [Visual Basic], extending
ms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e
ms.openlocfilehash: 31593fa8b0cc2670b9d59b8cd61ae66efd219269
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64659754"
---
# <a name="extending-the-my-namespace-in-visual-basic"></a>Расширение пространства имен My в Visual Basic
`My` Пространства имен в Visual Basic предоставляет свойства и методы, которые позволяют легко воспользоваться преимуществами мощной платформы .NET Framework. `My` Пространство имен упрощает типовых задач программирования, часто уменьшая трудной задачей для одной строки кода. Кроме того `My` пространства имен является полностью расширяемым, таким образом, чтобы можно было настроить поведение `My` и добавлять новые службы в его иерархию для адаптации к потребностям конкретного приложения. В этом разделе обсуждается настройка существующих членов `My` пространства имен и добавить пользовательские классы для `My` пространства имен.  
  
 **Содержание раздела**  
  
- [Настройка существующих элементов пространства имен My](#customizing)  
  
- [Добавление членов в Мои объекты](#addingtoobjects)  
  
- [Добавление пользовательских объектов в пространство имен My](#addingcustom)  
  
- [Добавление элементов в пространство имен My](#addingtonamespace)  
  
- [Добавление событий в настраиваемые Мои объекты](#addingevents)  
  
- [Рекомендации по проектированию](#design)  
  
- [Разработка библиотек классов для My](#designing)  
  
- [Упаковка и развертывание расширения](#packaging)  
  
## <a name="customizing"></a> Настройка существующих элементов пространства имен My  
 `My` Пространства имен в Visual Basic предоставляет часто используемые сведения о приложении, компьютера и многое другое. Полный список объектов в `My` пространства имен, см. в разделе [Мои ссылки](../../../visual-basic/language-reference/keywords/my-reference.md). Может потребоваться настроить существующие члены `My` пространства имен, чтобы они лучше соответствовали требованиям приложения. Любое свойство объекта в `My` пространство имен, не только для чтения можно задать пользовательское значение.  
  
 Например, предположим, что часто `My.User` объект для доступа к текущему контексту безопасности пользователя, запустившего приложение. Тем не менее ваша компания использует объект пользовательский для предоставления дополнительных сведений и возможностей для пользователей компании. В этом случае можно заменить значение по умолчанию `My.User.CurrentPrincipal` свойство с помощью экземпляра собственного пользовательского объекта-участника, как показано в следующем примере.  
  
 [!code-vb[VbVbcnExtendingMy#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#1)]  
  
 Установка `CurrentPrincipal` свойство `My.User` объекта изменяет удостоверение, под которой выполняется приложение. `My.User` Объект, в свою очередь, возвращает сведения о только что указанный пользователь.  
  
## <a name="addingtoobjects"></a> Добавление членов в Мои объекты  
 Типы, возвращаемые `My.Application` и `My.Computer` определяются как `Partial` классы. Таким образом, вы можете расширить `My.Application` и `My.Computer` объектов путем создания `Partial` класс с именем `MyApplication` или `MyComputer`. Класс не может быть `Private` класса. Если класс задан как часть `My` пространства имен, можно добавить свойства и методы, которые будут входить в состав `My.Application` или `My.Computer` объектов.  
  
 Например, в следующем примере добавляется свойство с именем `DnsServerIPAddresses` для `My.Computer` объекта.  
  
 [!code-vb[VbVbcnExtendingMy#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class2.vb#2)]  
  
## <a name="addingcustom"></a> Добавление пользовательских объектов в пространство имен My  
 Несмотря на то что `My` пространство имен предоставляет решения для многих распространенных задач программирования, встречаются задачи, `My` пространства имен не рассматриваются. Например приложение может получить доступ к пользовательским службам каталогов для пользовательских данных, или ваше приложение может использовать сборки, которые не устанавливаются по умолчанию с помощью Visual Basic. Вы можете расширить `My` пространство имен и включить пользовательские решения для распространенных задачах, относящиеся к используемой среде. `My` Пространства имен можно легко расширить для добавления новых элементов для удовлетворения растущих потребностей приложения. Кроме того, можно развернуть в `My` расширения пространства имен для других разработчиков, как шаблон Visual Basic.  
  
### <a name="addingtonamespace"></a> Добавление элементов в пространство имен My  
 Так как `My` — это пространство имен как и любое другое пространство имен, можно добавить свойства верхнего уровня к нему, просто добавив модуль и указав `Namespace` из `My`. Снабдите модуль `HideModuleName` атрибута, как показано в следующем примере. `HideModuleName` Атрибут гарантирует, что IntelliSense не будет отображать имя модуля при его отображении членами `My` пространства имен.  
  
 [!code-vb[VbVbcnExtendingMy#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#3)]  
  
 Добавление членов в `My` пространства имен, добавить свойства для модуля. Для каждого свойства, добавляемого `My` пространства имен, добавьте закрытое поле типа `ThreadSafeObjectProvider(Of T)`, где типом является тип, возвращаемый вашим пользовательским свойством. Это поле используется для создания экземпляров объектов поточно ориентированными, возвращаемый этим свойством, вызвав `GetInstance` метод. Таким образом каждый поток, который обращается к расширенному свойству получает собственный экземпляр возвращаемого типа. В следующем примере добавляется свойство с именем `SampleExtension` типа `SampleExtension` для `My` пространство имен:  
  
 [!code-vb[VbVbcnExtendingMy#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#4)]  
  
## <a name="addingevents"></a> Добавление событий в настраиваемые Мои объекты  
 Можно использовать `My.Application` объект для предоставления событий для настраиваемых `My` объектов путем расширения `MyApplication` разделяемый класс в `My` пространства имен. Для проектов на основе Windows, можно дважды щелкнуть **Мой проект** узел проекта в **обозревателе решений**. В Visual Basic **конструктор проектов**, нажмите кнопку `Application` вкладке и нажмите кнопку `View Application Events` кнопки. Создается новый файл с именем ApplicationEvents.vb. Он содержит следующий код для расширения `MyApplication` класса.  
  
 [!code-vb[VbVbcnExtendingMy#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#5)]  
  
 Можно добавить обработчики событий для настраиваемых `My` объектов путем добавления пользовательских обработчиков событий для `MyApplication` класса. Пользовательские события позволяют добавлять код, который будет выполняться при добавлении обработчика событий, удалении, или события. Обратите внимание, что `AddHandler` кода для пользовательского события выполняется только в том случае, если пользователь для обработки события добавляется код. Например, рассмотрим, `SampleExtension` объект из предыдущего раздела имеет `Load` событие, которое вы хотите добавить пользовательский обработчик событий для. В следующем примере кода показан пользовательский обработчик событий с именем `SampleExtensionLoad` , которые будут вызываться при `My.SampleExtension.Load` событием. При добавлении кода для обработки нового `My.SampleExtensionLoad` событий, `AddHandler` выполняется часть этого кода пользовательское событие. `MyApplication_SampleExtensionLoad` Метод включен в пример кода демонстрирует пример обработчика событий, который обрабатывает `My.SampleExtensionLoad` событий. Обратите внимание, что `SampleExtensionLoad` события будут доступны при выборе **Мои события приложения** параметр в левом раскрывающемся списке над редактором кода при редактировании файла ApplicationEvents.vb.  
  
 [!code-vb[VbVbcnExtendingMy#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#6)]  
  
## <a name="design"></a> Рекомендации по проектированию  
 При разработке расширений для `My` пространства имен, следуйте приведенным ниже рекомендациям, чтобы свести к минимуму затраты на обслуживание компонентов расширения.  
  
- **Содержит только логику расширения.** Логика `My` расширение пространства имен должен содержать только код, необходимый для предоставления требуемой функциональности в `My` пространства имен. Так как расширение будет присутствовать в проектах пользователей в виде исходного кода, обновление компонента расширения влечет за собой высокую стоимость обслуживания и по возможности следует избегать.  
  
- **Свести к минимуму предположения проекта.** При создании расширений пространства `My` пространства имен, не следует считать набор ссылок, импорта на уровне проекта или особых параметров компилятора (например, `Option Strict` off). Вместо этого следует свести к минимуму зависимости и определяйте все ссылки на типы с помощью `Global` ключевое слово. Кроме того, убедитесь, что расширение компилируется с `Option Strict` on, чтобы свести к минимуму ошибки в модуле.  
  
- **Изолируйте код расширения.** Поместив данный код в одном файле расширение делает простым развертыванием в качестве шаблона элемента Visual Studio. Дополнительные сведения см. в разделе «Упаковка и развертывание расширения» далее в этом разделе. Поместив все `My` кода расширения пространства имен в одном файле или отдельную папку в проекте также поможет пользователям найти `My` расширение пространства имен.  
  
## <a name="designing"></a> Разработка библиотек классов для My  
 Как и в случае с большинством объектных моделей, некоторые шаблоны проектирования хорошо работать в `My` пространства имен, а другие нет. При разработке расширения для `My` пространства имен, необходимо учитывать следующие принципы:  
  
- **Методы без отслеживания состояния.** Методы в `My` пространства имен следует создать полноценное решение для определенной задачи. Убедитесь, что значения параметров, которые передаются в метод предоставить все входные данные, необходимые для выполнения конкретной задачи. Не следует создавать методы, основанные на предыдущее состояние, например открытые подключения к ресурсам.  
  
- **Глобальные экземпляры.** Единственное состояние, которое хранится в `My` пространства имен является глобальным для проекта. Например `My.Application.Info` инкапсулирует состояние, общее для всего приложения.  
  
- **Простые типы параметров.** Усложнять вещи, избежав сложных типов параметров. Вместо этого создайте методы, которые либо принимают параметр ввода, либо принимают простые типы входных данных, такие как строки, типы-примитивы и т. д.  
  
- **Фабричные методы.** Некоторые типы трудно создать экземпляр. Предоставляет фабричные методы расширения для `My` пространство имен позволяет более легко находить и использовать типы, которые попадают в эту категорию. Пример фабричный метод, который хорошо работает — `My.Computer.FileSystem.OpenTextFileReader`. Существует несколько типов потоков в .NET Framework. В частности, указав текстовых файлов `OpenTextFileReader` поможет пользователю понять, какой поток следует использовать.  
  
 Эти правила не противоречат общие принципы проектирования библиотек классов. Вместо этого они приведены рекомендации, которые оптимизированы для разработчиков, использующих Visual Basic и `My` пространства имен. Общие принципы проектирования для создания библиотеки классов, см. в разделе [рекомендации по разработке Framework](../../../standard/design-guidelines/index.md).  
  
## <a name="packaging"></a> Упаковка и развертывание расширения  
 Можно включить `My` расширения пространства имен в шаблон проекта Visual Studio, или можно упаковать и развернуть их в качестве шаблона элемента Visual Studio. При упаковке вашей `My` расширения пространства имен в качестве шаблона элемента Visual Studio, можно воспользоваться преимуществами дополнительных возможностей, предоставляемых Visual Basic. Эти возможности позволяют включить расширение, когда проект ссылается на отдельную сборку, или предоставить пользователям возможность явно добавлять вашей `My` расширение пространства имен с помощью **Мои расширения** страницы в Visual Basic Конструктор проектов.  
  
 Дополнительные сведения о развертывании `My` расширения пространства имен, см. в разделе [упаковка и развертывание пользовательских Мои расширения](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md).  
  
## <a name="see-also"></a>См. также

- [Упаковка и развертывание пользовательских расширений пространства имен My](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)
- [Расширение модели приложения Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)
- [Настройка доступа к объектам через My](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)
- [Страница "Мои расширения", конструктор проектов](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)
- [Страница "Приложение" в конструкторе проектов (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)
- [Partial](../../../visual-basic/language-reference/modifiers/partial.md)
