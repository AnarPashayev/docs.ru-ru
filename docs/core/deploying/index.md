---
title: Публикация приложений
description: Дополнительные сведения о публикации приложения .NET Core. .NET Core может публиковать приложения для конкретной платформы или кроссплатформенные приложения. Приложение можно опубликовать как автономное или как зависимое от среды. Каждый режим влияет на то, как пользователь запускает приложение.
ms.date: 04/01/2020
ms.openlocfilehash: 27206065c899e41a44685f72cfb35ae57986aa4c
ms.sourcegitcommit: 4d45bda8cd9558ea8af4be591e3d5a29360c1ece
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2020
ms.locfileid: "91654676"
---
# <a name="net-core-application-publishing-overview"></a>Общие сведения о публикации приложений .NET Core

Приложения, создаваемые с помощью .NET Core, могут быть опубликованы в двух разных режимах, и режим влияет на то, как пользователь запускает приложение.

При публикации *автономного* приложения создается приложение, которое включает среду выполнения и библиотеки .NET Core, а также приложение и его зависимости. Пользователи приложения могут запустить его на компьютере, на котором не установлена среда выполнения .NET Core.

При публикации приложения в качестве *зависимого от среды* создается приложение, которое включает только само приложение и его зависимости. Пользователям приложения необходимо отдельно установить среду выполнения .NET Core.

Оба режима публикации по умолчанию создают исполняемый файл, зависящий от платформы. Приложения, зависящие от среды, могут создаваться без исполняемого файла, и эти приложения являются кросс-платформенными.

При создании исполняемого файла можно указать целевую платформу с идентификатором среды выполнения (RID). Дополнительные сведения об идентификаторах среды выполнения см. в [каталоге RID для .NET Core](../rid-catalog.md).

В следующей таблице приведены команды, используемые для публикации автономных и зависящих от среды для каждой версии пакета SDK:

| Type                                                                                     | SDK 2.1 | SDK 3.x | Команда |
| ---------------------------------------------------------------------------------------  | ------- | ------- | ------- |
| [зависящий от среды исполняемый файл](#publish-framework-dependent) для текущей платформы. |         | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |
| [зависящий от среды исполняемый файл](#publish-framework-dependent) для определенной платформы.  |         | ✔️      | [`dotnet publish -r <RID> --self-contained false`](../tools/dotnet-publish.md) |
| [зависящий от среды кросс-платформенный двоичный файл](#publish-framework-dependent).               | ✔️      | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |
| [автономный исполняемый файл](#publish-self-contained).                                    | ✔️      | ✔️      | [`dotnet publish -r <RID>`](../tools/dotnet-publish.md) |

Дополнительные сведения см. в разделе [Команда .NET Core dotnet publish](../tools/dotnet-publish.md).

## <a name="produce-an-executable"></a>Создание исполняемого файла

Исполняемые файлы не являются кроссплатформенными. Они относятся к операционной системе и архитектуре ЦП. При публикации приложения и создании исполняемого файла можно опубликовать приложение как [автономное](#publish-self-contained) или [зависящее от среды](#publish-framework-dependent). Публикация автономного приложения включает среду выполнения .NET Core, и пользователям приложения не нужно беспокоиться об установке .NET Core перед запуском приложения. Приложения, опубликованные как зависимые от среды, не включают в себя среду выполнения и библиотеки .NET Core; в пакет входят только зависимости от приложений и сторонних производителей.

Следующие команды создают исполняемый файл:

| Type                                                                                     | SDK 2.1 | SDK 3.x | Команда |
| ---------------------------------------------------------------------------------------- | ------- | ------- | ------- |
| [зависящий от среды исполняемый файл](#publish-framework-dependent) для текущей платформы. |         | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |
| [зависящий от среды исполняемый файл](#publish-framework-dependent) для определенной платформы.  |         | ✔️      | [`dotnet publish -r <RID> --self-contained false`](../tools/dotnet-publish.md) |
| [автономный исполняемый файл](#publish-self-contained).                                    | ✔️      | ✔️      | [`dotnet publish -r <RID>`](../tools/dotnet-publish.md) |

## <a name="produce-a-cross-platform-binary"></a>Создание кроссплатформенного двоичного файла

Кросс-платформенные двоичные файлы создаются при публикации приложения, [зависящего от среды](#publish-framework-dependent), в виде файла *DLL*. Файл *DLL* называется по имени вашего проекта. Например, если ваше приложение называется **word_reader**, создается файл с именем *word_reader.dll*. Приложения, опубликованные таким образом, выполняются с помощью команды `dotnet <filename.dll>` на любой платформе.

Кроссплатформенные двоичные файлы могут выполняться в любой операционной системе, если целевая среда выполнения .NET Core уже установлена. Если целевая среда выполнения .NET Core не установлена, приложение может работать с помощью более новой среды выполнения, если оно настроено соответствующим образом. Дополнительные сведения см. в разделе [Накат зависящих от среды приложений](../versions/selection.md#framework-dependent-apps-roll-forward).

Следующая команда создает кроссплатформенный двоичный файл:

| Type                                                                                 | SDK 2.1 | SDK 3.x | Команда |
| -----------------------------------------------------------------------------------  | ------- | ------- | ------- |
| [зависящий от среды кросс-платформенный двоичный файл](#publish-framework-dependent).           | ✔️      | ✔️      | [`dotnet publish`](../tools/dotnet-publish.md) |

## <a name="publish-framework-dependent"></a>Публикация зависящих от среды приложений

Приложения, опубликованные как зависящие от среды, являются кросс-платформенными и не включают среду выполнения .NET Core. Пользователь приложения должен установить среду выполнения .NET Core.

При публикации приложения, зависящего от среды, создается [кросс-платформенный двоичный файл](#produce-a-cross-platform-binary) с расширением *DLL* и [исполняемый файл, зависящий от платформы](#produce-an-executable), предназначенный для текущей платформы. Файл *DLL* является кроссплатформенным, а исполняемый файл — нет. Например, при публикации приложения с именем **word_reader** для Windows создается исполняемый файл *word_reader.exe* и файл *word_reader.dll*. Для Linux или macOS создается исполняемый файл *word_reader*, а также *word_reader.dll*. Дополнительные сведения об идентификаторах среды выполнения см. в [каталоге RID для .NET Core](../rid-catalog.md).

> [!IMPORTANT]
> Пакет SDK для .NET Core 2.1 не создает исполняемые файлы, зависящие от платформы, при публикации приложения, зависящего от среды.

Кроссплатформенный двоичный файл приложения можно запустить с помощью команды `dotnet <filename.dll>` и выполнять на любой платформе. Если приложение использует пакет NuGet с реализациями, зависящими от платформы, все зависимости платформ копируются в папку публикации вместе с приложением.

Вы можете создать исполняемый файл для конкретной платформы, передав параметры `-r <RID> --self-contained false` в команде [`dotnet publish`](../tools/dotnet-publish.md). Если параметр `-r` опущен, для текущей платформы создается исполняемый файл. Все пакеты NuGet, имеющие зависящие от платформы зависимости для целевой платформы, копируются в папку публикации.

### <a name="advantages"></a>Преимущества

- **Небольшое развертывание**\
Распределяются только приложение и его зависимости. Среда выполнения и библиотеки .NET Core устанавливаются пользователем, и все приложения совместно используют среду выполнения.

- **Кроссплатформенные приложения**\
Ваше приложение и библиотеки на основе .NET работают в других операционных системах. Для приложения не нужно определять целевую платформу. Дополнительные сведения о формате файлов .NET см. в разделе [Формат файла сборки .NET](../../standard/assembly/file-format.md).

- **Использует последнюю исправленную версию среды выполнения**\
Приложение использует самую новую среду выполнения (в рамках целевого основного и дополнительного семейства .NET Core), установленную в целевой системе. Это означает, что приложение будет автоматически использовать последнюю исправленную версию среды выполнения .NET Core. Поведение по умолчанию можно переопределить. Дополнительные сведения см. в разделе [Накат зависящих от среды приложений](../versions/selection.md#framework-dependent-apps-roll-forward).

### <a name="disadvantages"></a>Недостатки

- **Требует предварительной установки среды выполнения**\
Приложение может выполняться, только если в системе уже установлена целевая версия .NET Core. Вы можете настроить поведение наката для приложения, чтобы либо требовать определенную версию .NET Core, либо разрешить более новую версию .NET Core. Дополнительные сведения см. в разделе [Накат зависящих от среды приложений](../versions/selection.md#framework-dependent-apps-roll-forward).

- **Платформа .NET Core может измениться**\
Среду выполнения и библиотеки .NET Core можно обновлять на компьютере, где выполняется приложение. В редких случаях это может изменить поведение приложения, если вы используете библиотеки .NET Core, как большинство приложений. Вы можете настроить, как приложение использует более новые версии .NET Core. Дополнительные сведения см. в разделе [Накат зависящих от среды приложений](../versions/selection.md#framework-dependent-apps-roll-forward).

Приведенные ниже недостатки применимы только к пакету SDK для .NET Core 2.1.

- **Используйте команду `dotnet`, чтобы запустить приложение**\
Для запуска приложения пользователи должны выполнить команду `dotnet <filename.dll>`. Пакет SDK для .NET Core 2.1 не создает исполняемые файлы, зависящие от платформы, при публикации приложения, зависящего от среды.

### <a name="examples"></a>Примеры

Публикация кросс-платформенного приложения, зависящего от среды. Исполняемый файл, предназначенный для текущей платформы, создается вместе с *DLL*-файлом.

```dotnet
dotnet publish
```

Публикация кросс-платформенного приложения, зависящего от среды. Вместе с *DLL*-файлом создается 64-разрядный исполняемый файл Linux. Эта команда не работает с пакетом SDK для .NET Core 2.1.

```dotnet
dotnet publish -r linux-x64 --self-contained false
```

## <a name="publish-self-contained"></a>Публикация автономных приложений

При публикации автономного приложения создается исполняемый файл, зависящий от платформы. Выходная папка публикации содержит все компоненты приложения, включая библиотеки .NET Core и целевую среду выполнения. Приложение изолировано от других приложений .NET Core и не использует локально установленную общую среду выполнения. Пользователю приложения не требуется загружать и устанавливать .NET Core.

Исполняемый двоичный файл создается для указанной целевой платформы. Например, если у вас есть приложение с именем **word_reader** и вы публикуете автономный исполняемый файл для Windows, создается файл *word_reader.exe*. При публикации для Linux или macOS создается файл *word_reader*. Целевая платформа и архитектура указываются с помощью параметра `-r <RID>` для команды [`dotnet publish`](../tools/dotnet-publish.md). Дополнительные сведения об идентификаторах среды выполнения см. в [каталоге RID для .NET Core](../rid-catalog.md).

Если приложение имеет зависимости для определенной платформы, например пакет NuGet, содержащий зависимости для определенной платформы, они копируются в папку публикации вместе с приложением.

### <a name="advantages"></a>Преимущества

- **Управление версией .NET Core**\
Вы управляете, какая версия .NET Core развертывается вместе с приложением.

- **Нацеливание на конкретные платформы**\
Поскольку необходимо опубликовать приложение для каждой платформы, вы знаете, где будет выполняться приложение. Если в .NET Core появляется новая платформа, пользователи не смогут запустить приложение на этой платформе до выпуска версии, предназначенной для этой платформы. Вы можете протестировать приложение на наличие проблем совместимости перед тем, как пользователи запустят приложение на новой платформе.

### <a name="disadvantages"></a>Недостатки

- **Более крупные развертывания**\
Так как приложение включает среду выполнения .NET Core и все зависимости приложения, размер скачиваемого файла и требуемого пространства на жестком диске больше, чем для версии, [зависящей от среды](#publish-framework-dependent).

  > [!TIP]
  > Вы можете уменьшить размер развертывания в системах Linux примерно на 28 МБ с помощью [*инвариантного режима глобализации*](https://github.com/dotnet/runtime/blob/master/docs/design/features/globalization-invariant-mode.md) в .NET Core. С его помощью приложение будет обрабатывать все языки и региональные параметры как [инвариантные языки и региональные параметры](xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType).

  > [!TIP]
  > Существует [предварительная версия функция усечения](trim-self-contained.md) позволяющая еще больше уменьшить размер развертывания.

- **Усложненное обновление версии .NET Core**\
Среду выполнения .NET Core (распространяемую с вашим приложением) можно обновить только путем выпуска новой версии приложения. Однако при необходимости.NET Core обновит критически важные обновления системы безопасности для библиотеки платформы на компьютере, на котором выполняется приложение. Ответственность за полную проверку этого сценария обновления системы безопасности лежит на вас.

### <a name="examples"></a>Примеры

Публикация автономного приложения. Создается 64-разрядный исполняемый файл macOS.

```dotnet
dotnet publish -r osx-x64
```

Публикация автономного приложения. Создается 64-разрядный исполняемый файл Windows.

```dotnet
dotnet publish -r win-x64
```

## <a name="publish-with-readytorun-images"></a>Публикация с использованием образов ReadyToRun

Публикация с использованием образов ReadyToRun помогает оптимизировать время запуска приложения, хотя размер приложения при этом будет увеличен. Дополнительные сведения о публикации с использованием ReadyToRun см. [здесь](ready-to-run.md).

### <a name="advantages"></a>Преимущества

- **Оптимизированное времени запуска**\
Приложение будет тратить меньше времени на выполнение JIT.

### <a name="disadvantages"></a>Недостатки

- **Больший размер**\
Приложение будет занимать больше места на диске.

### <a name="examples"></a>Примеры

Опубликуйте автономное приложение с помощью ReadyToRun. Создается 64-разрядный исполняемый файл macOS.

```dotnet
dotnet publish -c Release -r osx-x64 -p:PublishReadyToRun=true
```

Опубликуйте автономное приложение с помощью ReadyToRun. Создается 64-разрядный исполняемый файл Windows.

```dotnet
dotnet publish -c Release -r win-x64 -p:PublishReadyToRun=true
```

## <a name="see-also"></a>См. также

- [Развертывание приложений .NET Core с помощью .NET Core CLI.](deploy-with-cli.md)
- [Развертывание приложений .NET Core с помощью Visual Studio.](deploy-with-vs.md)
- [Каталог идентификаторов сред выполнения (RID) в .NET Core.](../rid-catalog.md)
- [Выбор версии .NET Core для использования.](../versions/selection.md)
