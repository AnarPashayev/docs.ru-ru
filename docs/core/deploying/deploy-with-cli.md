---
title: Публикации приложений .NET Core с помощью интерфейса командной строки
description: Научитесь публиковать приложения .NET Core с помощью средств командной строки (CLI) в составе .NET Core SDK.
author: thraka
ms.author: adegeo
ms.date: 01/16/2019
dev_langs:
- csharp
- vb
ms.custom: seodec18
ms.openlocfilehash: 41af1c708a264833f1f7217529b5c0206d405449
ms.sourcegitcommit: 9a39f2a06f110c9c7ca54ba216900d038aa14ef3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "74428916"
---
# <a name="publish-net-core-apps-with-the-cli"></a>Публикации приложений .NET Core с помощью интерфейса командной строки

В этой статье рассказывается, как опубликовать приложение .NET Core из командной строки. Платформа .NET Core предоставляет три способа публикации приложений. Зависящее от платформы развертывание создает кроссплатформенный DLL-файл, который использует локально установленную среду выполнения .NET Core. Зависящий от платформы исполняемый файл использует локально установленную среду выполнения .NET Core. Автономный исполняемый файл создает зависящий от платформы исполняемый файл и включает локальную копию среды выполнения .NET Core.

Общие сведения о режимах развертывания см. в разделе [Развертывание приложений .NET Core](index.md).

Ищете справку по работе с командной строкой? В следующей таблице показаны некоторые примеры публикации приложений. Вы можете указать целевую платформу с помощью параметра `-f <TFM>` или путем редактирования файла проекта. Дополнительные сведения см. в статье [Основы публикации](#publishing-basics).

| Режим публикации | Версия SDK | Команда |
| ------------ | ----------- | ------- |
| развертывание, зависящее от платформы; | 2.x | `dotnet publish -c Release` |
| Исполняемый файл, зависящий от платформы | 2.2 | `dotnet publish -c Release -r <RID> --self-contained false` |
|                                | 3.0 | `dotnet publish -c Release -r <RID> --self-contained false` |
|                                | 3.0* | `dotnet publish -c Release` |
| автономное развертывание;      | 2.1 | `dotnet publish -c Release -r <RID> --self-contained true` |
|                                | 2.2 | `dotnet publish -c Release -r <RID> --self-contained true` |
|                                | 3.0 | `dotnet publish -c Release -r <RID> --self-contained true` |

\* При использовании пакета SDK версии 3.0 режим публикации по умолчанию при выполнении базовой команды `dotnet publish` предусматривает использование зависящего от платформы исполняемого файла. Это относится только к проектам, предназначенным для **.NET Core 2.1** или **.NET Core 3.0**.

## <a name="publishing-basics"></a>Основы публикации

Параметр `<TargetFramework>` файла проекта указывает целевую платформу по умолчанию при публикации приложения. Можно изменить целевую платформу на любой допустимый [моникер целевой платформы (TFM)](../../standard/frameworks.md). Например, если проект использует `<TargetFramework>netcoreapp2.2</TargetFramework>`, создается двоичный файл, предназначенный для .NET Core 2.2. TFM, указанный в этом параметре, является целевым объектом по умолчанию, используемым командой [`dotnet publish`](../tools/dotnet-publish.md).

Если вам нужно охватить несколько платформ, можно задать в параметре `<TargetFrameworks>` несколько значений TFM, разделенных точками с запятой. Вы можете опубликовать одну из платформ с помощью команды `dotnet publish -f <TFM>`. Например, если вы используете `<TargetFrameworks>netcoreapp2.1;netcoreapp2.2</TargetFrameworks>` и запускаете `dotnet publish -f netcoreapp2.1`, создается двоичный файл, предназначенный для .NET Core 2.1.

Если не указано иное, выходной каталог команды [`dotnet publish`](../tools/dotnet-publish.md) — `./bin/<BUILD-CONFIGURATION>/<TFM>/publish/`. Значение по умолчанию для режима **BUILD-CONFIGURATION** — **Отладка**, если с помощью параметра `-c` не задано иное. Например `dotnet publish -c Release -f netcoreapp2.1` публикует в `myfolder/bin/Release/netcoreapp2.1/publish/`.

Если вы используете .NET Core SDK 3.0, режим публикации по умолчанию для приложений, нацеленных на .NET Core версии 2.1, 2.2 или 3.0, — это исполняемый файл, зависящий от платформы.

Если вы используете .NET Core SDK 2.1, режим публикации по умолчанию для приложений, нацеленных на .NET Core версии 2.1 или 2.2, — это развертывание, зависящее от платформы.

### <a name="native-dependencies"></a>Машинные зависимости

Если приложение имеет машинные зависимости, оно не может выполняться в другой операционной системе. Например, если приложение использует нативный интерфейс Windows API, оно не будет работать в macOS или Linux. Необходимо написать код для конкретной платформы и скомпилировать исполняемый файл для каждой платформы.

Учтите также, что если ссылка на библиотеку имеет машинную зависимость, приложения могут не выполняться на всех платформах. Тем не менее возможно, что пакет NuGet, на который вы ссылаетесь, включает версии для конкретных платформ, которые разрешают машинные зависимости за вас.

При распространении приложения с машинными зависимостями может потребоваться использовать `dotnet publish -r <RID>` для указания целевой платформы публикации. Список идентификаторов сред выполнения см. в [каталоге идентификаторов сред выполнения](../rid-catalog.md).

Дополнительные сведения о двоичных файлах для определенной платформы см. в разделах [Исполняемый файл, зависящий от платформы](#framework-dependent-executable) и [Автономное развертывание](#self-contained-deployment).

## <a name="sample-app"></a>Пример приложения

Чтобы изучить команды публикации, можно использовать следующее приложение. Приложение можно создать, выполнив следующие команды в окне терминала:

```dotnetcli
mkdir apptest1
cd apptest1
dotnet new console
dotnet add package Figgle
```

Файл `Program.cs` или `Program.vb`, созданный с помощью шаблона консоли, необходимо изменить на следующее:

```csharp
using System;

namespace apptest1
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(Figgle.FiggleFonts.Standard.Render("Hello, World!"));
        }
    }
}
```

```vb
Module Program
    Sub Main(args As String())
        Console.WriteLine(Figgle.FiggleFonts.Standard.Render("Hello, World!"))
    End Sub
End Module
```

При выполнении приложения ([`dotnet run`](../tools/dotnet-run.md)) отображается следующий результат:

```terminal
  _   _      _ _         __        __         _     _ _
 | | | | ___| | | ___    \ \      / /__  _ __| | __| | |
 | |_| |/ _ \ | |/ _ \    \ \ /\ / / _ \| '__| |/ _` | |
 |  _  |  __/ | | (_) |    \ V  V / (_) | |  | | (_| |_|
 |_| |_|\___|_|_|\___( )    \_/\_/ \___/|_|  |_|\__,_(_)
                     |/
```

## <a name="framework-dependent-deployment"></a>развертывание, зависящее от платформы;

В случае командной строки пакета SDK для .NET Core 2.x зависящее от платформы развертывание (FDD) является режимом по умолчанию для базовой команды `dotnet publish`.

При публикации приложения в качестве FDD файл `<PROJECT-NAME>.dll` создается в папке `./bin/<BUILD-CONFIGURATION>/<TFM>/publish/`. Чтобы запустить приложение, перейдите к папке выходных данных и используйте команду `dotnet <PROJECT-NAME>.dll`.

Ваше приложение будет настроено для конкретной версии .NET Core. Целевую среду выполнения .NET Core необходимо установить на компьютере, где вы хотите запустить приложение. Например, если приложение предназначено для .NET Core 2.2, то на любом компьютере, где работает ваше приложение, должна быть установлена среда выполнения .NET Core 2.2. Как уже говорилось в разделе [Основы публикации](#publishing-basics), можно изменить файл проекта для изменения целевой платформы по умолчанию или для выбора нескольких платформ.

Публикация FDD создает приложение, которое автоматически использует новейшую версию исправлений безопасности .NET Core, доступных в системе, где выполняется приложение. Дополнительные сведения о привязке версий во время компиляции см. в разделе [Выбор используемой версии .NET Core](../versions/selection.md#framework-dependent-apps-roll-forward).

## <a name="framework-dependent-executable"></a>Исполняемый файл, зависящий от платформы

В случае интерфейса командной строки пакета SDK для .NET Core 3.x зависящий от платформы исполняемый файл (FDE) является режимом по умолчанию для базовой команды `dotnet publish`. Указывать другие параметры, если вы будете работать в текущей операционной системе, не нужно.

В этом режиме для размещения кроссплатформенного приложения создается исполняемый файл основного приложения для конкретной платформы. Этот режим аналогичен FDD, так как FDD требуется основное приложение в виде команды `dotnet`. Имя исполняемого файла основного приложения зависит от платформы и обычно похоже на `<PROJECT-FILE>.exe`. Вы можете запустить этот исполняемый файл напрямую вместо вызова метода `dotnet <PROJECT-FILE>.dll` (который по-прежнему допустим для запуска приложения).

Ваше приложение будет настроено для конкретной версии .NET Core. Целевую среду выполнения .NET Core необходимо установить на компьютере, где вы хотите запустить приложение. Например, если приложение предназначено для .NET Core 2.2, то на любом компьютере, где работает ваше приложение, должна быть установлена среда выполнения .NET Core 2.2. Как уже говорилось в разделе [Основы публикации](#publishing-basics), можно изменить файл проекта для изменения целевой платформы по умолчанию или для выбора нескольких платформ.

Публикация FDE создает приложение, которое автоматически использует новейшую версию исправлений безопасности .NET Core, доступных в системе, где выполняется приложение. Дополнительные сведения о привязке версий во время компиляции см. в разделе [Выбор используемой версии .NET Core](../versions/selection.md#framework-dependent-apps-roll-forward).

Вы обязаны (за исключением случая .NET Core 3.x при выборе текущей платформы как целевой) использовать перечисленные ниже параметры с командой `dotnet publish` для публикации FDE:

- `-r <RID>` — этот параметр использует идентификатор (RID) для указания целевой платформы. Список идентификаторов сред выполнения см. в [каталоге идентификаторов сред выполнения](../rid-catalog.md).

- `--self-contained false` — этот параметр указывает пакету SDK для .NET Core, что исполняемый файл нужно создать как FDE.

При использовании параметра `-r` путь к папке выходных данных изменяется на `./bin/<BUILD-CONFIGURATION>/<TFM>/<RID>/publish/`

Если вы используете [пример приложения](#sample-app), запустите `dotnet publish -f netcoreapp2.2 -r win10-x64 --self-contained false`. Эта команда создает следующий исполняемый файл: `./bin/Debug/netcoreapp2.2/win10-x64/publish/apptest1.exe`

> [!NOTE]
> Можно уменьшить размер развертывания, включив **инвариантный режим глобализации**. Он подходит для приложений, которые не имеют глобальных параметров и могут использовать соглашения о форматировании, соглашения о регистре, сравнение строк и порядок сортировки для [инвариантного языка и региональных параметров](xref:System.Globalization.CultureInfo.InvariantCulture). Дополнительные сведения об **инвариантном режиме глобализации** и том, как его включить, см. в статье об [инвариантном режиме глобализации .NET Core](https://github.com/dotnet/corefx/blob/master/Documentation/architecture/globalization-invariant-mode.md).

## <a name="self-contained-deployment"></a>автономное развертывание;

При публикации автономного развертывания (SCD) пакет SDK для .NET Core создает исполняемый файл для конкретной платформы. Публикация SCD включает в себя все необходимые файлы .NET Core для запуска приложения, но не включает [машинные зависимости .NET Core](https://github.com/dotnet/core/blob/master/Documentation/prereqs.md). Эти зависимости должны присутствовать в системе перед запуском приложения.

При публикации SCD создается приложение, которое не будет автоматически использовать новейшую версию исправлений безопасности .NET Core. Дополнительные сведения о привязке версий во время компиляции см. в разделе [Выбор используемой версии .NET Core](../versions/selection.md#self-contained-deployments-include-the-selected-runtime).

Необходимо использовать следующие параметры командной строки с командой `dotnet publish` для публикации SCD:

- `-r <RID>` — этот параметр использует идентификатор (RID) для указания целевой платформы. Список идентификаторов сред выполнения см. в [каталоге идентификаторов сред выполнения](../rid-catalog.md).

- `--self-contained true` — этот параметр указывает пакету SDK для .NET Core, что исполняемый файл нужно создать как SCD.

> [!NOTE]
> Можно уменьшить размер развертывания, включив **инвариантный режим глобализации**. Он подходит для приложений, которые не имеют глобальных параметров и могут использовать соглашения о форматировании, соглашения о регистре, сравнение строк и порядок сортировки для [инвариантного языка и региональных параметров](xref:System.Globalization.CultureInfo.InvariantCulture). Дополнительные сведения об **инвариантном режиме глобализации** и том, как его включить, см. в статье об [инвариантном режиме глобализации .NET Core](https://github.com/dotnet/corefx/blob/master/Documentation/architecture/globalization-invariant-mode.md).

## <a name="see-also"></a>См. также

- [Общие сведения о развертывании приложений для .NET Core](index.md)
- [Каталог идентификаторов сред выполнения (RID) в .NET Core](../rid-catalog.md)
