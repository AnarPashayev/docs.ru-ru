---
title: Переход с DNX на интерфейс CLI .NET Core
description: Переход от средств DNX к средствам CLI .NET Core.
ms.date: 06/20/2016
ms.custom: seodec18
ms.openlocfilehash: 0f00ee6c05a47d976028c3cd4eade2b2b399260b
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2019
ms.locfileid: "59160840"
---
# <a name="migrating-from-dnx-to-net-core-cli-projectjson"></a><span data-ttu-id="3bd11-103">Переход с DNX на интерфейс CLI .NET Core (project.json)</span><span class="sxs-lookup"><span data-stu-id="3bd11-103">Migrating from DNX to .NET Core CLI (project.json)</span></span>

## <a name="overview"></a><span data-ttu-id="3bd11-104">Обзор</span><span class="sxs-lookup"><span data-stu-id="3bd11-104">Overview</span></span>
<span data-ttu-id="3bd11-105">В версии-кандидате 1 .NET Core и ASP.NET Core 1.0 были представлены инструменты DNX.</span><span class="sxs-lookup"><span data-stu-id="3bd11-105">The RC1 release of .NET Core and ASP.NET Core 1.0 introduced DNX tooling.</span></span> <span data-ttu-id="3bd11-106">С выпуском версии-кандидата 2 .NET Core и ASP.NET Core 1.0 был осуществлен переход на интерфейс командной строки (CLI) .NET Core с DNX.</span><span class="sxs-lookup"><span data-stu-id="3bd11-106">The RC2 release of .NET Core and ASP.NET Core 1.0 moved from DNX to the .NET Core CLI.</span></span>

<span data-ttu-id="3bd11-107">Давайте в общих чертах вспомним, что такое DNX.</span><span class="sxs-lookup"><span data-stu-id="3bd11-107">As a slight refresher, let's recap what DNX was about.</span></span> <span data-ttu-id="3bd11-108">DNX — это среда выполнения и набор инструментов, которые использовались для создания приложений .NET Core, и в частности приложений ASP.NET Core 1.0.</span><span class="sxs-lookup"><span data-stu-id="3bd11-108">DNX was a runtime and a toolset used to build .NET Core and, more specifically, ASP.NET Core 1.0 applications.</span></span> <span data-ttu-id="3bd11-109">Это решение состояло из трех основных компонентов:</span><span class="sxs-lookup"><span data-stu-id="3bd11-109">It consisted of 3 main pieces:</span></span>

1. <span data-ttu-id="3bd11-110">DNVM — скрипт установки для получения DNX;</span><span class="sxs-lookup"><span data-stu-id="3bd11-110">DNVM - an install script for obtaining DNX</span></span>
2. <span data-ttu-id="3bd11-111">DNX (среда выполнения Dotnet) — среда выполнения вашего кода;</span><span class="sxs-lookup"><span data-stu-id="3bd11-111">DNX (Dotnet Execution Runtime) - the runtime that executes your code</span></span>
3. <span data-ttu-id="3bd11-112">DNU (служебная программа для разработки Dotnet) — средство для управления зависимостями, сборки и публикации приложений.</span><span class="sxs-lookup"><span data-stu-id="3bd11-112">DNU (Dotnet Developer Utility) - tooling for managing dependencies, building and publishing your applications</span></span>

<span data-ttu-id="3bd11-113">С появлением интерфейса CLI все перечисленные выше компоненты входят в одни набор инструментов.</span><span class="sxs-lookup"><span data-stu-id="3bd11-113">With the introduction of the CLI, all of the above are now part of a single toolset.</span></span> <span data-ttu-id="3bd11-114">Однако, поскольку среда DNX была доступна в версии-кандидате 1, у вас могут быть созданные с ее помощью проекты, которые может потребоваться перенести в новый инструментарий CLI.</span><span class="sxs-lookup"><span data-stu-id="3bd11-114">However, since DNX was available in RC1 timeframe, you might have projects that were built using it that you would want to move off to the new CLI tooling.</span></span>

<span data-ttu-id="3bd11-115">В этом руководстве рассматриваются основные действия по переносу проектов из DNX в интерфейс CLI .NET Core.</span><span class="sxs-lookup"><span data-stu-id="3bd11-115">This migration guide will cover the essentials on how to migrate projects off of DNX and onto .NET Core CLI.</span></span> <span data-ttu-id="3bd11-116">Если вы создаете проект в .NET Core с нуля, то этот документ вам не нужен.</span><span class="sxs-lookup"><span data-stu-id="3bd11-116">If you are just starting a project on .NET Core from scratch, you can freely skip this document.</span></span>

## <a name="main-changes-in-the-tooling"></a><span data-ttu-id="3bd11-117">Основные изменения в инструментарии</span><span class="sxs-lookup"><span data-stu-id="3bd11-117">Main changes in the tooling</span></span>
<span data-ttu-id="3bd11-118">В инструментарии реализован ряд важных изменений, с которыми необходимо предварительно ознакомиться.</span><span class="sxs-lookup"><span data-stu-id="3bd11-118">There are some general changes in the tooling that should be outlined first.</span></span>

### <a name="no-more-dnvm"></a><span data-ttu-id="3bd11-119">Отсутствие DNVM</span><span class="sxs-lookup"><span data-stu-id="3bd11-119">No more DNVM</span></span>
<span data-ttu-id="3bd11-120">DNVM (сокращение от *DotNet Version Manager*, диспетчер версий DotNet) — это bash-скрипт или скрипт PowerShell, который использовался для установки DNX на компьютере.</span><span class="sxs-lookup"><span data-stu-id="3bd11-120">DNVM, short for *DotNet Version Manager* was a bash/PowerShell script used to install a DNX on your machine.</span></span> <span data-ttu-id="3bd11-121">Он помогал пользователям получить DNX из указанного канала (или канала по умолчанию), а также пометить определенную среду DNX как активную, в результате чего она помещалась в переменную $PATH для данного сеанса.</span><span class="sxs-lookup"><span data-stu-id="3bd11-121">It helped users get the DNX they need from the feed they specified (or default ones) as well as mark a certain DNX "active", which would put it on the $PATH for the given session.</span></span> <span data-ttu-id="3bd11-122">Это позволяло использовать различные средства.</span><span class="sxs-lookup"><span data-stu-id="3bd11-122">This would allow you to use the various tools.</span></span>

<span data-ttu-id="3bd11-123">Поддержка DNVM прекращена, так как его функциональность стала избыточной вследствие изменений, реализованных в средствах CLI .NET Core.</span><span class="sxs-lookup"><span data-stu-id="3bd11-123">DNVM was discontinued because its feature set was made redundant by changes coming in the .NET Core CLI tools.</span></span>

<span data-ttu-id="3bd11-124">Средства CLI упаковываются двумя основными способами:</span><span class="sxs-lookup"><span data-stu-id="3bd11-124">The CLI tools come packaged in two main ways:</span></span>

1. <span data-ttu-id="3bd11-125">собственные установщики для конкретной платформы;</span><span class="sxs-lookup"><span data-stu-id="3bd11-125">Native installers for a given platform</span></span>
2. <span data-ttu-id="3bd11-126">скрипт установки для других ситуаций (например, серверов CI).</span><span class="sxs-lookup"><span data-stu-id="3bd11-126">Install script for other situations (like CI servers)</span></span>

<span data-ttu-id="3bd11-127">С учетом этого возможности установки DNVM больше не нужны.</span><span class="sxs-lookup"><span data-stu-id="3bd11-127">Given this, the DNVM install features are not needed.</span></span> <span data-ttu-id="3bd11-128">Но как насчет возможностей выбора среды выполнения?</span><span class="sxs-lookup"><span data-stu-id="3bd11-128">But what about the runtime selection features?</span></span>

<span data-ttu-id="3bd11-129">Вы ссылаетесь на среду выполнения в файле `project.json`, добавляя пакет определенной версии в список зависимостей.</span><span class="sxs-lookup"><span data-stu-id="3bd11-129">You reference a runtime in your `project.json` by adding a package of a certain version to your dependencies.</span></span> <span data-ttu-id="3bd11-130">После внесения этого изменения ваше приложение сможет использовать двоичные файлы новой среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="3bd11-130">With this change, your application will be able to use the new runtime bits.</span></span> <span data-ttu-id="3bd11-131">Получение этих двоичных файлов на компьютере производится так же, как и при использовании CLI: вы устанавливаете среду выполнения с помощью одного из поддерживаемых собственных установщиков или посредством скрипта установки.</span><span class="sxs-lookup"><span data-stu-id="3bd11-131">Getting these bits to your machine is the same as with the CLI: you install the runtime via one of the native installers it supports or via its install script.</span></span>

### <a name="different-commands"></a><span data-ttu-id="3bd11-132">Разные команды</span><span class="sxs-lookup"><span data-stu-id="3bd11-132">Different commands</span></span>
<span data-ttu-id="3bd11-133">Если вы использовали среду DNX, то применяли некоторые команды из трех ее компонентов (DNX, DNU и DNVM).</span><span class="sxs-lookup"><span data-stu-id="3bd11-133">If you were using DNX, you used some commands from one of its three parts (DNX, DNU or DNVM).</span></span> <span data-ttu-id="3bd11-134">В CLI некоторые из этих команд изменились, некоторые стали недоступны, а другие сохранились, но имеют немного другую семантику.</span><span class="sxs-lookup"><span data-stu-id="3bd11-134">With the CLI, some of these commands change, some are not available and some are the same but have slightly different semantics.</span></span>

<span data-ttu-id="3bd11-135">В таблице ниже приведены команды DNX и DNU и их аналоги в CLI.</span><span class="sxs-lookup"><span data-stu-id="3bd11-135">The table below shows the mapping between the DNX/DNU commands and their CLI counterparts.</span></span>

| <span data-ttu-id="3bd11-136">Команда DNX</span><span class="sxs-lookup"><span data-stu-id="3bd11-136">DNX command</span></span>                    | <span data-ttu-id="3bd11-137">Команда CLI</span><span class="sxs-lookup"><span data-stu-id="3bd11-137">CLI command</span></span>    | <span data-ttu-id="3bd11-138">Описание</span><span class="sxs-lookup"><span data-stu-id="3bd11-138">Description</span></span>                                                                                                     |
|--------------------------------|----------------|-----------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3bd11-139">dnx run</span><span class="sxs-lookup"><span data-stu-id="3bd11-139">dnx run</span></span>                        | <span data-ttu-id="3bd11-140">dotnet run</span><span class="sxs-lookup"><span data-stu-id="3bd11-140">dotnet run</span></span>     | <span data-ttu-id="3bd11-141">Выполнение кода из источника.</span><span class="sxs-lookup"><span data-stu-id="3bd11-141">Run code from source.</span></span>                                                                                           |
| <span data-ttu-id="3bd11-142">dnu build</span><span class="sxs-lookup"><span data-stu-id="3bd11-142">dnu build</span></span>                      | <span data-ttu-id="3bd11-143">dotnet build</span><span class="sxs-lookup"><span data-stu-id="3bd11-143">dotnet build</span></span>   | <span data-ttu-id="3bd11-144">Сборка двоичного файла с кодом на языке IL.</span><span class="sxs-lookup"><span data-stu-id="3bd11-144">Build an IL binary of your code.</span></span>                                                                                |
| <span data-ttu-id="3bd11-145">dnu pack</span><span class="sxs-lookup"><span data-stu-id="3bd11-145">dnu pack</span></span>                       | <span data-ttu-id="3bd11-146">dotnet pack</span><span class="sxs-lookup"><span data-stu-id="3bd11-146">dotnet pack</span></span>    | <span data-ttu-id="3bd11-147">Упаковка кода в пакет NuGet.</span><span class="sxs-lookup"><span data-stu-id="3bd11-147">Package up a NuGet package of your code.</span></span>                                                                        |
| <span data-ttu-id="3bd11-148">dnx \[команда] (например, dnx web)</span><span class="sxs-lookup"><span data-stu-id="3bd11-148">dnx \[command] (for example, "dnx web")</span></span> | <span data-ttu-id="3bd11-149">Н/Д \*</span><span class="sxs-lookup"><span data-stu-id="3bd11-149">N/A\*</span></span>          | <span data-ttu-id="3bd11-150">Выполнение команды в среде DNX в соответствии с определением в файле project.json.</span><span class="sxs-lookup"><span data-stu-id="3bd11-150">In DNX world, run a command as defined in the project.json.</span></span>                                                     |
| <span data-ttu-id="3bd11-151">dnu install</span><span class="sxs-lookup"><span data-stu-id="3bd11-151">dnu install</span></span>                    | <span data-ttu-id="3bd11-152">Н/Д \*</span><span class="sxs-lookup"><span data-stu-id="3bd11-152">N/A\*</span></span>          | <span data-ttu-id="3bd11-153">В среде DNX установка пакета в качестве зависимости.</span><span class="sxs-lookup"><span data-stu-id="3bd11-153">In the DNX world, install a package as a dependency.</span></span>                                                            |
| <span data-ttu-id="3bd11-154">dnu restore</span><span class="sxs-lookup"><span data-stu-id="3bd11-154">dnu restore</span></span>                    | <span data-ttu-id="3bd11-155">dotnet restore</span><span class="sxs-lookup"><span data-stu-id="3bd11-155">dotnet restore</span></span> | <span data-ttu-id="3bd11-156">Восстановление зависимостей, указанных в файле project.json.</span><span class="sxs-lookup"><span data-stu-id="3bd11-156">Restore dependencies specified in your project.json.</span></span> <span data-ttu-id="3bd11-157">([см. примечание](#dotnet-restore-note))</span><span class="sxs-lookup"><span data-stu-id="3bd11-157">([see note](#dotnet-restore-note))</span></span>                                                            |
| <span data-ttu-id="3bd11-158">dnu publish</span><span class="sxs-lookup"><span data-stu-id="3bd11-158">dnu publish</span></span>                    | <span data-ttu-id="3bd11-159">dotnet publish</span><span class="sxs-lookup"><span data-stu-id="3bd11-159">dotnet publish</span></span> | <span data-ttu-id="3bd11-160">Публикация приложения для развертывания в одной из трех форм (переносимое, переносимое с машинным кодом или автономное).</span><span class="sxs-lookup"><span data-stu-id="3bd11-160">Publish your application for deployment in one of the three forms (portable, portable with native and standalone).</span></span> |
| <span data-ttu-id="3bd11-161">dnu wrap</span><span class="sxs-lookup"><span data-stu-id="3bd11-161">dnu wrap</span></span>                       | <span data-ttu-id="3bd11-162">Н/Д \*</span><span class="sxs-lookup"><span data-stu-id="3bd11-162">N/A\*</span></span>          | <span data-ttu-id="3bd11-163">В среде DNX упаковка файла project.json в файл CSPROJ.</span><span class="sxs-lookup"><span data-stu-id="3bd11-163">In DNX world, wrap a project.json in csproj.</span></span>                                                                    |
| <span data-ttu-id="3bd11-164">dnu commands</span><span class="sxs-lookup"><span data-stu-id="3bd11-164">dnu commands</span></span>                   | <span data-ttu-id="3bd11-165">Н/Д \*</span><span class="sxs-lookup"><span data-stu-id="3bd11-165">N/A\*</span></span>          | <span data-ttu-id="3bd11-166">В среде DNX управление глобально установленными командами.</span><span class="sxs-lookup"><span data-stu-id="3bd11-166">In DNX world, manage the globally installed commands.</span></span>                                                           |

<span data-ttu-id="3bd11-167">(\*) — поддержка этих возможностей в CLI не предусмотрена.</span><span class="sxs-lookup"><span data-stu-id="3bd11-167">(\*) - these features are not supported in the CLI by design.</span></span>

## <a name="dnx-features-that-are-not-supported"></a><span data-ttu-id="3bd11-168">Неподдерживаемые возможности DNX</span><span class="sxs-lookup"><span data-stu-id="3bd11-168">DNX features that are not supported</span></span>
<span data-ttu-id="3bd11-169">Как видно в приведенной выше таблице, в среде DNX имелись возможности, которые мы решили не поддерживать в CLI, по крайней мере на данный момент.</span><span class="sxs-lookup"><span data-stu-id="3bd11-169">As the table above shows, there are features from the DNX world that we decided not to support in the CLI, at least for the time being.</span></span> <span data-ttu-id="3bd11-170">В этом разделе будут рассмотрены наиболее важные из них, а также приведено обоснование прекращению их поддержки и обходные решения для их реализации.</span><span class="sxs-lookup"><span data-stu-id="3bd11-170">This section will go through the most important ones and outline the rationale behind not supporting them as well as workarounds if you do need them.</span></span>

### <a name="global-commands"></a><span data-ttu-id="3bd11-171">Глобальные команды</span><span class="sxs-lookup"><span data-stu-id="3bd11-171">Global commands</span></span>
<span data-ttu-id="3bd11-172">В DNU появилось такое понятие, как "глобальные команды".</span><span class="sxs-lookup"><span data-stu-id="3bd11-172">DNU came with a concept called "global commands".</span></span> <span data-ttu-id="3bd11-173">По существу, это консольные приложения, упакованные в виде пакетов NuGet со скриптом оболочки, который вызывает указанную среду DNX для запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="3bd11-173">These were, essentially, console applications packaged up as NuGet packages with a shell script that would invoke the DNX you specified to run the application.</span></span>

<span data-ttu-id="3bd11-174">В интерфейсе CLI такого понятия нет.</span><span class="sxs-lookup"><span data-stu-id="3bd11-174">The CLI does not support this concept.</span></span> <span data-ttu-id="3bd11-175">Однако он поддерживает добавление команд для отдельных проектов, которые можно вызывать с помощью привычного синтаксиса `dotnet <command>`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-175">It does, however, support the concept of adding per-project commands that can be invoked using the familiar `dotnet <command>` syntax.</span></span>

### <a name="installing-dependencies"></a><span data-ttu-id="3bd11-176">Установка зависимостей</span><span class="sxs-lookup"><span data-stu-id="3bd11-176">Installing dependencies</span></span>
<span data-ttu-id="3bd11-177">Начиная с версии 1, в средствах CLI .NET Core нет команды `install` для установки зависимостей.</span><span class="sxs-lookup"><span data-stu-id="3bd11-177">As of v1, the .NET Core CLI tools don't have an `install` command for installing dependencies.</span></span> <span data-ttu-id="3bd11-178">Чтобы установить пакет из NuGet, его нужно добавить как зависимость в файл `project.json`, а затем выполнить команду `dotnet restore` ([см. примечание](#dotnet-restore-note)).</span><span class="sxs-lookup"><span data-stu-id="3bd11-178">In order to install a package from NuGet, you would need to add it as a dependency to your `project.json` file and then run `dotnet restore` ([see note](#dotnet-restore-note)).</span></span>

### <a name="running-your-code"></a><span data-ttu-id="3bd11-179">Выполнение кода</span><span class="sxs-lookup"><span data-stu-id="3bd11-179">Running your code</span></span>
<span data-ttu-id="3bd11-180">Выполнять код можно двумя основными способами.</span><span class="sxs-lookup"><span data-stu-id="3bd11-180">There are two main ways to run your code.</span></span> <span data-ttu-id="3bd11-181">Один из них — выполнение из источника с помощью команды `dotnet run`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-181">One is from source, with `dotnet run`.</span></span> <span data-ttu-id="3bd11-182">В отличие от команды `dnx run`, компиляция в памяти при этом не производится.</span><span class="sxs-lookup"><span data-stu-id="3bd11-182">Unlike `dnx run`, this will not do any in-memory compilation.</span></span> <span data-ttu-id="3bd11-183">Эта команда вызывает `dotnet build` для сборки кода, а затем запускает собранный двоичный файл.</span><span class="sxs-lookup"><span data-stu-id="3bd11-183">It will actually invoke `dotnet build` to build your code and then run the built binary.</span></span>

<span data-ttu-id="3bd11-184">Другой способ — использовать сам драйвер `dotnet` для выполнения кода.</span><span class="sxs-lookup"><span data-stu-id="3bd11-184">Another way is using the `dotnet` itself to run your code.</span></span> <span data-ttu-id="3bd11-185">Для этого нужно указать путь к сборке: `dotnet path/to/an/assembly.dll`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-185">This is done by providing a path to your assembly: `dotnet path/to/an/assembly.dll`.</span></span>

## <a name="migrating-your-dnx-project-to-net-core-cli"></a><span data-ttu-id="3bd11-186">Перенос проекта DNX в CLI .NET Core</span><span class="sxs-lookup"><span data-stu-id="3bd11-186">Migrating your DNX project to .NET Core CLI</span></span>
<span data-ttu-id="3bd11-187">Помимо использования новых команд для работы с кодом, переход с DNX также требует выполнения еще трех важных действий:</span><span class="sxs-lookup"><span data-stu-id="3bd11-187">In addition to using new commands when working with your code, there are three major things left in migrating from DNX:</span></span>

1. <span data-ttu-id="3bd11-188">перенос файла `global.json`, если он должен использовать CLI;</span><span class="sxs-lookup"><span data-stu-id="3bd11-188">Migrate the `global.json` file if you have it to be able to use CLI.</span></span>
2. <span data-ttu-id="3bd11-189">перенос самого файла проекта (`project.json`) в инструментарий CLI;</span><span class="sxs-lookup"><span data-stu-id="3bd11-189">Migrating the project file (`project.json`) itself to the CLI tooling.</span></span>
3. <span data-ttu-id="3bd11-190">переход с интерфейсов API среды DNX на их аналоги в BCL.</span><span class="sxs-lookup"><span data-stu-id="3bd11-190">Migrating off of any DNX APIs to their BCL counterparts.</span></span>

### <a name="changing-the-globaljson-file"></a><span data-ttu-id="3bd11-191">Изменение файла global.json</span><span class="sxs-lookup"><span data-stu-id="3bd11-191">Changing the global.json file</span></span>
<span data-ttu-id="3bd11-192">Файл `global.json` выступает в роли файла решения как для проектов версии-кандидата 1, так и для проектов версии-кандидата 2 (или более поздней версии).</span><span class="sxs-lookup"><span data-stu-id="3bd11-192">The `global.json` file acts like a solution file for both the RC1 and RC2 (or later) projects.</span></span> <span data-ttu-id="3bd11-193">Для различения проектов версии-кандидата 1 и проектов более поздних версий средства CLI (а также Visual Studio) используют свойство `"sdk": { "version" }`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-193">In order for the CLI tools (as well as Visual Studio) to differentiate between RC1 and later versions, they use the `"sdk": { "version" }` property to make the distinction which project is RC1 or later.</span></span> <span data-ttu-id="3bd11-194">Если в файле `global.json` вообще нет этого узла, предполагается, что проект относится к последней версии.</span><span class="sxs-lookup"><span data-stu-id="3bd11-194">If `global.json` doesn't have this node at all, it is assumed to be the latest.</span></span>

<span data-ttu-id="3bd11-195">Чтобы обновить файл `global.json`, удалите это свойство или задайте в качестве его значения точную версию средств, которую необходимо использовать. В данном случае это версия **1.0.0-preview2-003121**:</span><span class="sxs-lookup"><span data-stu-id="3bd11-195">In order to update the `global.json` file, either remove the property or set it to the exact version of the tools that you wish to use, in this case **1.0.0-preview2-003121**:</span></span>

```json
{
    "sdk": {
        "version": "1.0.0-preview2-003121"
    }
}
```

### <a name="migrating-the-project-file"></a><span data-ttu-id="3bd11-196">Перенос файл проекта</span><span class="sxs-lookup"><span data-stu-id="3bd11-196">Migrating the project file</span></span>

<span data-ttu-id="3bd11-197">Интерфейс CLI и среда DNX используют одну и ту же базовую систему проектов, основанную на файле `project.json`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-197">The CLI and DNX both use the same basic project system based on `project.json` file.</span></span> <span data-ttu-id="3bd11-198">Синтаксис и семантика файла проекта в целом совпадают, за небольшими исключениями в некоторых ситуациях.</span><span class="sxs-lookup"><span data-stu-id="3bd11-198">The syntax and the semantics of the project file are pretty much the same, with small differences based on the scenarios.</span></span> <span data-ttu-id="3bd11-199">В схеме есть небольшие изменения. С ними можно ознакомиться в [файле схемы](http://json.schemastore.org/project).</span><span class="sxs-lookup"><span data-stu-id="3bd11-199">There are also some changes to the schema which you can see in the [schema file](http://json.schemastore.org/project).</span></span>

<span data-ttu-id="3bd11-200">Если вы создаете консольное приложение, в файл проекта нужно добавить следующий фрагмент кода:</span><span class="sxs-lookup"><span data-stu-id="3bd11-200">If you are building a console application, you need to add the following snippet to your project file:</span></span>

```json
"buildOptions": {
    "emitEntryPoint": true
}
```

<span data-ttu-id="3bd11-201">Он предписывает команде `dotnet build` создать точку входа для приложения, что делает код готовым к выполнению.</span><span class="sxs-lookup"><span data-stu-id="3bd11-201">This instructs `dotnet build` to emit an entry point for your application, effectively making your code runnable.</span></span> <span data-ttu-id="3bd11-202">Если вы создаете библиотеку классов, просто опустите приведенный выше раздел.</span><span class="sxs-lookup"><span data-stu-id="3bd11-202">If you are building a class library, simply omit the above section.</span></span> <span data-ttu-id="3bd11-203">Само собой, после добавления приведенного выше фрагмента в файл `project.json` необходимо добавить статическую точку входа.</span><span class="sxs-lookup"><span data-stu-id="3bd11-203">Of course, once you add the above snippet to your `project.json` file, you need to add a static entry point.</span></span> <span data-ttu-id="3bd11-204">После перехода с DNX предоставляемые этой средой службы DI становятся недоступны, поэтому это должна быть базовая точка входа .NET: `static void Main()`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-204">With the move off DNX, the DI services it provided are no longer available and thus this needs to be a basic .NET entry point: `static void Main()`.</span></span>

<span data-ttu-id="3bd11-205">Если в файле `project.json` есть раздел commands, его можно удалить.</span><span class="sxs-lookup"><span data-stu-id="3bd11-205">If you have a "commands" section in your `project.json`, you can remove it.</span></span> <span data-ttu-id="3bd11-206">Некоторые команды, которые существовали как команды DNU, например команды интерфейса CLI для Entity Framework, переносятся в CLI как расширения на уровне отдельных проектов.</span><span class="sxs-lookup"><span data-stu-id="3bd11-206">Some of the commands that used to exist as DNU commands, such as Entity Framework CLI commands, are being ported to be per-project extensions to the CLI.</span></span> <span data-ttu-id="3bd11-207">Если вы создали собственные команды, которые используете в проектах, то их надо заменить на расширения CLI.</span><span class="sxs-lookup"><span data-stu-id="3bd11-207">If you built your own commands that you are using in your projects, you need to replace them with CLI extensions.</span></span> <span data-ttu-id="3bd11-208">В этом случае узел `commands` в файле `project.json` нужно заменить на узел `tools`, в котором должны быть перечислены зависимости средств.</span><span class="sxs-lookup"><span data-stu-id="3bd11-208">In this case, the `commands` node in `project.json` needs to be replaced by the `tools` node and it needs to list the tools dependencies.</span></span>

<span data-ttu-id="3bd11-209">После выполнения этих действий необходимо решить, какой тип переносимости требуется для приложения.</span><span class="sxs-lookup"><span data-stu-id="3bd11-209">After these things are done, you need to decide which type of portability you wish for you app.</span></span> <span data-ttu-id="3bd11-210">В .NET Core мы реализовали целый спектр вариантов переносимости.</span><span class="sxs-lookup"><span data-stu-id="3bd11-210">With .NET Core, we have invested into providing a spectrum of portability options that you can choose from.</span></span> <span data-ttu-id="3bd11-211">Например, приложение может быть полностью *переносимым* или *автономным*.</span><span class="sxs-lookup"><span data-stu-id="3bd11-211">For instance, you may want to have a fully *portable* application or you may want to have a *self-contained* application.</span></span> <span data-ttu-id="3bd11-212">Переносимое приложение работает примерно так же, как приложение .NET Framework: ему требуется общий компонент для выполнения на целевом компьютере (.NET Core).</span><span class="sxs-lookup"><span data-stu-id="3bd11-212">The portable application option is more like .NET Framework applications work: it needs a shared component to execute it on the target machine (.NET Core).</span></span> <span data-ttu-id="3bd11-213">Автономное приложение не требует установки среды .NET Core на целевом компьютере, но для каждой поддерживаемой ОС необходимо создать отдельное приложение.</span><span class="sxs-lookup"><span data-stu-id="3bd11-213">The self-contained application doesn't require .NET Core to be installed on the target, but you have to produce one application for each OS you wish to support.</span></span> <span data-ttu-id="3bd11-214">Эти и другие типы переносимости рассматриваются в документе, посвященном [типам переносимости приложений](../deploying/index.md).</span><span class="sxs-lookup"><span data-stu-id="3bd11-214">These portability types and more are discussed in the [application portability type](../deploying/index.md) document.</span></span>

<span data-ttu-id="3bd11-215">Выбрав нужный тип переносимости, необходимо изменить целевые платформы.</span><span class="sxs-lookup"><span data-stu-id="3bd11-215">Once you make a call on what type of portability you want, you need to change your targeted framework(s).</span></span> <span data-ttu-id="3bd11-216">Если вы создавали приложения для .NET Core, то, скорее всего, использовали `dnxcore50` в качестве целевой платформы.</span><span class="sxs-lookup"><span data-stu-id="3bd11-216">If you were writing applications for .NET Core, you were most likely using `dnxcore50` as  your targeted framework.</span></span> <span data-ttu-id="3bd11-217">В контексте CLI и изменений, связанных с библиотекой [.NET Standard](../../standard/net-standard.md), необходимо использовать одну из следующих платформ:</span><span class="sxs-lookup"><span data-stu-id="3bd11-217">With the CLI and the changes that the new [.NET Standard](../../standard/net-standard.md) brought, the framework needs to be one of the following:</span></span>

1. `netcoreapp1.0` <span data-ttu-id="3bd11-218">— если вы создаете приложения в .NET (включая приложения ASP.NET Core);</span><span class="sxs-lookup"><span data-stu-id="3bd11-218">- if you are writing applications on .NET Core (including ASP.NET Core applications)</span></span>
2. `netstandard1.6` <span data-ttu-id="3bd11-219">— если вы создаете библиотеки классов для .NET Core.</span><span class="sxs-lookup"><span data-stu-id="3bd11-219">- if you are writing class libraries for .NET Core</span></span>

<span data-ttu-id="3bd11-220">При использовании других целевых платформ `dnx`, например `dnx451`, их также необходимо изменить.</span><span class="sxs-lookup"><span data-stu-id="3bd11-220">If you are using other `dnx` targets, like `dnx451` you will need to change those as well.</span></span> `dnx451` <span data-ttu-id="3bd11-221">следует изменить на `net451`.</span><span class="sxs-lookup"><span data-stu-id="3bd11-221">should be changed to `net451`.</span></span>
<span data-ttu-id="3bd11-222">Дополнительные сведения см. в разделе о [.NET Standard](../../standard/net-standard.md).</span><span class="sxs-lookup"><span data-stu-id="3bd11-222">Please refer to the [.NET Standard](../../standard/net-standard.md) topic for more information.</span></span>

<span data-ttu-id="3bd11-223">Ваш файл `project.json` в основном готов.</span><span class="sxs-lookup"><span data-stu-id="3bd11-223">Your `project.json` is now mostly ready.</span></span> <span data-ttu-id="3bd11-224">Теперь нужно проверить список зависимостей и обновить их до более новых версий, особенно если вы используете зависимости ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="3bd11-224">You need to go through your dependencies list and update the dependencies to their newer versions, especially if you are using ASP.NET Core dependencies.</span></span> <span data-ttu-id="3bd11-225">Если вы применяли отдельные пакеты для интерфейсов API BCL, то можете использовать пакет среды выполнения, как описано в документе, посвященном [типам переносимости приложений](../deploying/index.md).</span><span class="sxs-lookup"><span data-stu-id="3bd11-225">If you were using separate packages for BCL APIs, you can use the runtime package as explained in the [application portability type](../deploying/index.md) document.</span></span>

<span data-ttu-id="3bd11-226">Когда вы будете готовы, можно попробовать выполнить восстановление с помощью команды `dotnet restore` ([см. примечание](#dotnet-restore-note)).</span><span class="sxs-lookup"><span data-stu-id="3bd11-226">Once you are ready, you can try restoring with `dotnet restore` ([see note](#dotnet-restore-note)).</span></span> <span data-ttu-id="3bd11-227">В зависимости от версии зависимостей могут возникнуть ошибки, если системе NuGet не удастся разрешить зависимости для одной из перечисленных выше целевых платформ.</span><span class="sxs-lookup"><span data-stu-id="3bd11-227">Depending on the version of your dependencies, you may encounter errors if NuGet cannot resolve the dependencies for one of the targeted frameworks above.</span></span> <span data-ttu-id="3bd11-228">Это временная проблема: со временем все большее число пакетов будет поддерживать эти платформы.</span><span class="sxs-lookup"><span data-stu-id="3bd11-228">This is a "point-in-time" problem; as time progresses, more and more packages will include support for these frameworks.</span></span> <span data-ttu-id="3bd11-229">Пока же вы можете использовать оператор `imports` в узле `framework`, чтобы сообщить системе NuGet, что она может восстановить указанные в этом операторе пакеты, предназначенные для соответствующей платформы.</span><span class="sxs-lookup"><span data-stu-id="3bd11-229">For now, if you run into this, you can use the `imports` statement within the `framework` node to specify to NuGet that it can restore the packages targeting the framework within the "imports" statement.</span></span>
<span data-ttu-id="3bd11-230">В этом случае при возникновении ошибок восстановления вы должны получить достаточно информации, чтобы понять, какие платформы следует импортировать.</span><span class="sxs-lookup"><span data-stu-id="3bd11-230">The restoring errors you get in this case should provide enough information to tell you which frameworks you need to import.</span></span> <span data-ttu-id="3bd11-231">Если вы немного запутались в этом, то просто помните, что, как правило, указание платформ `dnxcore50` и `portable-net45+win8` в операторе `imports` позволяет добиться желаемого результата.</span><span class="sxs-lookup"><span data-stu-id="3bd11-231">If you are slightly lost or new to this, in general, specifying `dnxcore50` and `portable-net45+win8` in the `imports` statement should do the trick.</span></span> <span data-ttu-id="3bd11-232">В приведенном ниже фрагменте кода в формате JSON показано, как это должно выглядеть.</span><span class="sxs-lookup"><span data-stu-id="3bd11-232">The JSON snippet below shows how this looks like:</span></span>

```json
    "frameworks": {
        "netcoreapp1.0": {
            "imports": ["dnxcore50", "portable-net45+win8"]
        }
    }
```

<span data-ttu-id="3bd11-233">При выполнении `dotnet build` будут выведены все итоговые ошибки сборки, хотя их не должно быть много.</span><span class="sxs-lookup"><span data-stu-id="3bd11-233">Running `dotnet build` will show any eventual build errors, though there shouldn't be too many of them.</span></span> <span data-ttu-id="3bd11-234">После того как код будет собран и будет правильно выполняться, вы можете протестировать его с помощью средства запуска.</span><span class="sxs-lookup"><span data-stu-id="3bd11-234">After your code is building and running properly, you can test it out with the runner.</span></span> <span data-ttu-id="3bd11-235">Выполните команду `dotnet <path-to-your-assembly>` и понаблюдайте за выполнением.</span><span class="sxs-lookup"><span data-stu-id="3bd11-235">Execute `dotnet <path-to-your-assembly>` and see it run.</span></span>

<a name="dotnet-restore-note"></a>

[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
