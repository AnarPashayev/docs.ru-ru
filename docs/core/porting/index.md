---
title: Перенос кода в .NET Core из .NET Framework
description: Общие сведения о процессе переноса и инструментах, которые могут оказаться полезными при переносе проектов .NET Framework в .NET Core.
author: cartermp
ms.date: 09/13/2019
ms.custom: seodec18
ms.openlocfilehash: b6c02932b5d9c7ccc2743dd38dddf2904f9c24e4
ms.sourcegitcommit: 289e06e904b72f34ac717dbcc5074239b977e707
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/17/2019
ms.locfileid: "71039666"
---
# <a name="port-your-code-from-net-framework-to-net-core"></a><span data-ttu-id="21dff-103">Перенос кода в .NET Core из .NET Framework</span><span class="sxs-lookup"><span data-stu-id="21dff-103">Port your code from .NET Framework to .NET Core</span></span>

<span data-ttu-id="21dff-104">Если у вас есть код, выполняющийся в .NET Framework, возможно, вам будет интересно запустить его и в .NET Core.</span><span class="sxs-lookup"><span data-stu-id="21dff-104">If you've got code that runs on the .NET Framework, you may be interested in running your code on .NET Core, too.</span></span> <span data-ttu-id="21dff-105">В этой статье приводятся общие сведения о процессе переноса и перечислены средства, которые могут оказаться полезными при переносе кода в .NET Core.</span><span class="sxs-lookup"><span data-stu-id="21dff-105">Here's an overview of the porting process and a list of the tools you may find helpful when porting your code to .NET Core.</span></span>

## <a name="overview-of-the-porting-process"></a><span data-ttu-id="21dff-106">Общие сведения о переносе</span><span class="sxs-lookup"><span data-stu-id="21dff-106">Overview of the porting process</span></span>

<span data-ttu-id="21dff-107">Этот процесс мы рекомендуем для переноса проекта в .NET Core.</span><span class="sxs-lookup"><span data-stu-id="21dff-107">This is the process we recommend you take when porting your project to .NET Core.</span></span> <span data-ttu-id="21dff-108">Каждый из этапов более подробно рассматривается в последующих статьях.</span><span class="sxs-lookup"><span data-stu-id="21dff-108">Each step of the process is covered in more detail in further articles.</span></span>

1. <span data-ttu-id="21dff-109">Определите и проанализируйте зависимости сторонних разработчиков.</span><span class="sxs-lookup"><span data-stu-id="21dff-109">Identify and account for your third-party dependencies.</span></span>

   <span data-ttu-id="21dff-110">Вам нужно узнать, какие зависимости сторонних разработчиков доступны, как они используются, как проверить, можно ли использовать их в .NET Core, и что нужно сделать, если нет.</span><span class="sxs-lookup"><span data-stu-id="21dff-110">This step involves understanding what your third-party dependencies are, how you depend on them, how to check if they also run on .NET Core, and steps you can take if they don't.</span></span> <span data-ttu-id="21dff-111">В статье также описано, как вы можете преобразовать зависимости в формат [PackageReference](/nuget/consume-packages/package-references-in-project-files), используемый в .NET Core.</span><span class="sxs-lookup"><span data-stu-id="21dff-111">It also covers how you can migrate your dependencies over to the [PackageReference](/nuget/consume-packages/package-references-in-project-files) format that is used in .NET Core.</span></span>

2. <span data-ttu-id="21dff-112">Переопределите все проекты для переноса в .NET Framework версии 4.7.2 и выше.</span><span class="sxs-lookup"><span data-stu-id="21dff-112">Retarget all projects you wish to port to target the .NET Framework 4.7.2 or higher.</span></span>

   <span data-ttu-id="21dff-113">Так вы сможете использовать альтернативные API для целевых платформ .NET Framework в случае, если платформа .NET Core не поддерживает определенный API.</span><span class="sxs-lookup"><span data-stu-id="21dff-113">This step ensures that you can use API alternatives for .NET Framework-specific targets when .NET Core doesn't support a particular API.</span></span>

3. <span data-ttu-id="21dff-114">Используйте средство [Анализатор переносимости .NET](../../standard/analyzers/portability-analyzer.md) для анализа сборок и разработки плана переноса на основе полученных результатов.</span><span class="sxs-lookup"><span data-stu-id="21dff-114">Use the [.NET Portability Analyzer](../../standard/analyzers/portability-analyzer.md) to analyze your assemblies and develop a plan to port based on its results.</span></span>

   <span data-ttu-id="21dff-115">Анализатор переносимости API анализирует скомпилированные сборки и создает отчет, в котором приводятся обобщенные сведения о переносимости, а также информация с разбивкой по каждому используемому API, которые недоступны в общедоступной области целевой платформы .NET.</span><span class="sxs-lookup"><span data-stu-id="21dff-115">The API Portability Analyzer tool analyzes your compiled assemblies and generates a report that shows a high-level portability summary and a breakdown of each API you're using that isn't available on targeted .NET Core platform public surface.</span></span> <span data-ttu-id="21dff-116">Этот отчет можно использовать вместе с результатами анализа базы кода для составления плана переноса кода.</span><span class="sxs-lookup"><span data-stu-id="21dff-116">You can use this report alongside an analysis of your codebase to develop a plan for how you'll port your code over.</span></span>

4. <span data-ttu-id="21dff-117">После преобразования файла проекта в целевую версию .NET Core можно использовать [анализатор .NET API](../../standard/analyzers/api-analyzer.md) на основе Roslyn для определения API, вызывающих <xref:System.PlatformNotSupportedException>, на некоторых платформах, а также некоторых других потенциальных проблем совместимости.</span><span class="sxs-lookup"><span data-stu-id="21dff-117">Once you have your project file converted to your targeted .NET Core version, you can use Roslyn based [.NET API analyzer](../../standard/analyzers/api-analyzer.md) to identify APIs throwing <xref:System.PlatformNotSupportedException> on some platforms and some other potential compatibility issues.</span></span>

5. <span data-ttu-id="21dff-118">Перенести код тестов.</span><span class="sxs-lookup"><span data-stu-id="21dff-118">Port your tests code.</span></span>

   <span data-ttu-id="21dff-119">Так как перенос в .NET Core является важным изменением базы кода, мы настоятельно рекомендуем перенести тесты, чтобы можно было выполнять их при переносе кода.</span><span class="sxs-lookup"><span data-stu-id="21dff-119">Because porting to .NET Core is such a significant change to your codebase, it's highly recommended to get your tests ported, so that you can run tests as you port your code over.</span></span> <span data-ttu-id="21dff-120">.NET Core поддерживают все основные платформы: MSTest, xUnit и NUnit.</span><span class="sxs-lookup"><span data-stu-id="21dff-120">MSTest, xUnit, and NUnit all support .NET Core.</span></span>

6. <span data-ttu-id="21dff-121">Выполните план переноса.</span><span class="sxs-lookup"><span data-stu-id="21dff-121">Execute your plan for porting!</span></span>

<span data-ttu-id="21dff-122">Ниже перечислены средства, которые могут оказаться полезными при переносе.</span><span class="sxs-lookup"><span data-stu-id="21dff-122">The following list shows tools you might find helpful to use during the porting process:</span></span>

* <span data-ttu-id="21dff-123">Анализатор переносимости API — [программа командной строки](https://github.com/Microsoft/dotnet-apiport/releases) или [расширение для Visual Studio Extension](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer) — инструмент для создания отчетов о переносимости кода между .NET Framework и целевой платформой .NET Core.</span><span class="sxs-lookup"><span data-stu-id="21dff-123">.NET Portability Analyzer - [command line tool](https://github.com/Microsoft/dotnet-apiport/releases) or [Visual Studio Extension](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer), a tool that can generate a report of how portable your code is between .NET Framework and your target .NET Core platform.</span></span> <span data-ttu-id="21dff-124">Отчет содержит разбивку по сборкам для отсутствующих API и типа в целевой платформе .NET Core.</span><span class="sxs-lookup"><span data-stu-id="21dff-124">The report contains an assembly-by-assembly breakdown of the Type and APIs missing on the target .NET Core platform.</span></span> <span data-ttu-id="21dff-125">См. дополнительные сведения об [анализаторе переносимости .NET](../../standard/analyzers/portability-analyzer.md).</span><span class="sxs-lookup"><span data-stu-id="21dff-125">For more information, see [.NET Portability Analyzer](../../standard/analyzers/portability-analyzer.md).</span></span> <span data-ttu-id="21dff-126">Рекомендуется запустить Анализатор переносимости .NET, прежде чем начать перенос, так как это поможет вам найти все пробелы в отсутствующих API в общедоступной области конкретной целевой платформы .NET.</span><span class="sxs-lookup"><span data-stu-id="21dff-126">It is recommended to run the .NET Portability Analyzer tool before you start porting, as it will help you identify any gaps in missing APIs in specific targeted .NET platform public surface.</span></span>
* <span data-ttu-id="21dff-127">Анализатор API .NET — анализатор на основе Roslyn, который обнаруживает API .NET Standard, создающий исключение <xref:System.PlatformNotSupportedException> на некоторых платформах, отслеживает вызовы к устаревшим API и выявляет риски совместимости для API на языке C# на разных платформах.</span><span class="sxs-lookup"><span data-stu-id="21dff-127">.NET API Analyzer - A Roslyn analyzer that discovers .NET Standard API that throws <xref:System.PlatformNotSupportedException> on some platforms, detects calls to deprecated APIs, and discovers some other potential compatibility risks for C# APIs on different platforms.</span></span> <span data-ttu-id="21dff-128">См. дополнительные сведения об [анализаторе API .NET](../../standard/analyzers/api-analyzer.md).</span><span class="sxs-lookup"><span data-stu-id="21dff-128">For more information, see [.NET API analyzer](../../standard/analyzers/api-analyzer.md).</span></span> <span data-ttu-id="21dff-129">Этот анализатор полезно использовать, если вы уже создали проект .NET Core для определения различий в поведении в среде выполнения на разных платформах.</span><span class="sxs-lookup"><span data-stu-id="21dff-129">This analyzer is helpful after you already created your .NET Core project to identify runtime behavior differences on different platforms.</span></span>
* <span data-ttu-id="21dff-130">Reverse Package Search — [полезная веб-служба](https://packagesearch.azurewebsites.net), которая позволяет выполнять поиск типа и находить пакеты, содержащие его.</span><span class="sxs-lookup"><span data-stu-id="21dff-130">Reverse Package Search - A [useful web service](https://packagesearch.azurewebsites.net) that allows you to search for a type and find packages containing that type.</span></span>

<span data-ttu-id="21dff-131">Кроме того, можно попытаться перенести более мелкие решения или отдельные проекты в формат файла проекта .NET Core с помощью средства [CsprojToVs2017](https://github.com/hvanbakel/CsprojToVs2017).</span><span class="sxs-lookup"><span data-stu-id="21dff-131">Additionally, you can attempt to port smaller solutions or individual projects to the .NET Core project file format with the [CsprojToVs2017](https://github.com/hvanbakel/CsprojToVs2017) tool.</span></span>

> [!WARNING]
> <span data-ttu-id="21dff-132">CsprojToVs2017 — это стороннее средство.</span><span class="sxs-lookup"><span data-stu-id="21dff-132">CsprojToVs2017 is a third-party tool.</span></span> <span data-ttu-id="21dff-133">Нет никакой гарантии, что оно будет поддерживать все проекты. Кроме того, оно может вызвать незначительные изменения в ожидаемом поведении.</span><span class="sxs-lookup"><span data-stu-id="21dff-133">There is no guarantee that it will work for all of your projects, and it may cause subtle changes in behavior that you depend on.</span></span> <span data-ttu-id="21dff-134">CsprojToVs2017 следует использовать в качестве _начальной точки_, которая автоматизирует соответствующие основные процессы.</span><span class="sxs-lookup"><span data-stu-id="21dff-134">CsprojToVs2017 should be used as a _starting point_ that automates the basic things that can be automated.</span></span> <span data-ttu-id="21dff-135">Это решение не может гарантировать перенос форматов файлов проекта.</span><span class="sxs-lookup"><span data-stu-id="21dff-135">It is not a guaranteed solution to migrating project file formats.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="21dff-136">Вперед</span><span class="sxs-lookup"><span data-stu-id="21dff-136">Next</span></span>](net-framework-tech-unavailable.md)
