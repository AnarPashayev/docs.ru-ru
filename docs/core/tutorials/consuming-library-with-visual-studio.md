---
title: Использование библиотеки .NET Standard в Visual Studio 2017
description: Создайте приложение .NET Core, которое вызывает члены из другой библиотеки классов, в Visual Studio 2017.
author: BillWagner
ms.author: wiwagn
ms.date: 06/05/2018
ms.custom: vs-dotnet, seodec18
ms.openlocfilehash: cfceb7ba384a28a09f172032f6edb6f5e495e9c0
ms.sourcegitcommit: 14ad34f7c4564ee0f009acb8bfc0ea7af3bc9541
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/01/2019
ms.locfileid: "73420901"
---
# <a name="consume-a-net-standard-library-in-visual-studio-2017"></a>Использование библиотеки .NET Standard в Visual Studio 2017

Итак, вы создали библиотеку классов .NET Standard, проделав шаги, описанные в статье [Создание библиотеки классов с помощью C# и .NET Core в Visual Studio 2017](./library-with-visual-studio.md) или [Создание библиотеки классов с помощью Visual Basic и .NET Core в Visual Studio 2017](vb-library-with-visual-studio.md), протестировали ее по инструкциям из статьи [Тестирование библиотеки классов с помощью .NET Core в Visual Studio 2017](testing-library-with-visual-studio.md), а затем создали версию выпуска этой библиотеки. Теперь пора предоставить ее для использования вызывающим объектам. Для этого существуют два способа:

* Если вся библиотека будет использоваться в одном решении (например, она является компонентом крупного приложения), достаточно включить библиотеку в проект этого решения.

* Если же библиотеку нужно сделать общедоступной, ее следует предоставлять как пакет NuGet.

## <a name="including-a-library-as-a-project-in-a-solution"></a>Включение библиотеки в решение в качестве проекта

Ранее вы включали модульные тесты в решение библиотеки классов. Теперь можно точно так же включить в это решение новое приложение. Например, библиотеку классов можно использовать в консольном приложении, которое будет предлагать пользователю ввести строку и определять, является ли первый символ этой строки символом верхнего регистра:

<!-- markdownlint-disable MD025 -->

# <a name="ctabcsharp"></a>[C#](#tab/csharp)

1. Откройте решение `ClassLibraryProjects`, созданное в рамках статьи [Создание библиотеки классов с помощью C# и .NET Core в Visual Studio 2017](./library-with-visual-studio.md). В **обозревателе решений** щелкните правой кнопкой мыши решение **ClassLibraryProjects** и в контекстном меню выберите **Добавить** > **Новый проект**.

1. В диалоговом окне **Добавление нового проекта** разверните узел **Visual C#** , выберите узел **.NET Core**, а затем — шаблон проекта **Консольное приложение (.NET Core)** . В текстовом поле **Имя** введите "ShowCase", а затем нажмите кнопку **ОК**.

   ![Диалоговое окно "Добавление нового проекта" в Visual Studio (C#)](./media/consuming-library-with-visual-studio/add-new-project-dialog.png)

1. В окне **Обозреватель решений** щелкните правой кнопкой мыши проект **ShowCase** и выберите команду **Назначить запускаемым проектом**.

   ![Контекстное меню проекта с пунктом "Назначить запускаемым проектом" в Visual Studio (C#)](./media/consuming-library-with-visual-studio/set-startup-project-context-menu.png)

1. Изначально у этого проекта нет доступа к библиотеке классов. Чтобы позволить приложению вызывать методы из библиотеки классов, создайте ссылку на библиотеку классов. В окне **Обозреватель решений** щелкните правой кнопкой мыши узел **Зависимости** проекта `ShowCase` и выберите команду **Добавить ссылку**.

   ![Контекстное меню проекта с пунктом "Добавить ссылку" в Visual Studio (C#)](./media/consuming-library-with-visual-studio/add-reference-context-menu.png)

1. В диалоговом окне **Диспетчер ссылок** выберите проект библиотеки классов **StringLibrary**, а затем нажмите кнопку **ОК**.

   ![Диалоговое окно "Диспетчер ссылок" в Visual Studio (C#)](./media/consuming-library-with-visual-studio/manage-project-references.png)

1. В окне кода замените весь код файла *Program.cs* следующим текстом:

   [!CODE-csharp[UsingClassLib#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/showcase.cs)]

   В этом коде используется переменная `row` для сохранения количества строк данных, записываемых в окно консоли. Всякий раз, когда оно достигает значения 25 или превышает его, код очищает окно консоли и отображается сообщение для пользователя.

   Сама программа предлагает пользователю ввести строку. Она сообщает, начинается ли строка с символа верхнего регистра. Если пользователь нажимает клавишу ВВОД, не введя никакой строки, приложение завершает свою работу и окно консоли закрывается.

1. При необходимости можно изменить режим на панели инструментов, чтобы скомпилировать **отладочную** версию проекта `ShowCase`. Скомпилируйте и запустите программу, нажав зеленую стрелку на кнопке **ShowCase**.

   ![Панель инструментов проекта в Visual Studio с кнопкой отладки (C#)](./media/consuming-library-with-visual-studio/visual-studio-project-toolbar.png)

# <a name="visual-basictabvb"></a>[Visual Basic](#tab/vb)

1. Откройте решение `ClassLibraryProjects`, созданное в рамках статьи [Создание библиотеки классов на Visual Basic с помощью .NET Core в Visual Studio 2017](vb-library-with-visual-studio.md). В **обозревателе решений** щелкните правой кнопкой мыши решение **ClassLibraryProjects** и в контекстном меню выберите **Добавить** > **Новый проект**.

1. В диалоговом окне **Добавление нового проекта** разверните узел **Visual Basic**, выберите узел **.NET Core**, а затем — шаблон проекта **Консольное приложение (.NET Core)** . В текстовом поле **Имя** введите "ShowCase", а затем нажмите кнопку **ОК**.

   ![Диалоговое окно "Добавление нового проекта" в Visual Studio (Visual Basic)](./media/consuming-library-with-visual-studio/add-new-vb-project-dialog.png)

1. В окне **Обозреватель решений** щелкните правой кнопкой мыши проект **ShowCase** и выберите команду **Назначить запускаемым проектом**. 

   ![Контекстное меню проекта с пунктом "Назначить запускаемым проектом" в Visual Studio (Visual Basic)](./media/consuming-library-with-visual-studio/set-startup-project-context-menu.png)

1. Изначально у этого проекта нет доступа к библиотеке классов. Чтобы позволить приложению вызывать методы из библиотеки классов, создайте ссылку на библиотеку классов. В окне **Обозреватель решений** щелкните правой кнопкой мыши узел **Зависимости** проекта `ShowCase` и выберите команду **Добавить ссылку**.

   ![Контекстное меню проекта с пунктом "Добавить ссылку" в Visual Studio (Visual Basic)](./media/consuming-library-with-visual-studio/add-reference-context-menu.png)

1. В диалоговом окне **Диспетчер ссылок** выберите проект библиотеки классов **StringLibrary**, а затем нажмите кнопку **ОК**.

   ![Диалоговое окно "Диспетчер ссылок" в Visual Studio (Visual Basic)](./media/consuming-library-with-visual-studio/manage-project-references.png)

1. В окне кода замените весь код файла *Program.vb* следующим текстом:

    [!CODE-vb[UsingClassLib#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/showcase.vb)]

   В этом коде используется переменная `row` для сохранения количества строк данных, записываемых в окно консоли. Всякий раз, когда оно достигает значения 25 или превышает его, код очищает окно консоли и отображается сообщение для пользователя.

   Сама программа предлагает пользователю ввести строку. Она сообщает, начинается ли строка с символа верхнего регистра. Если пользователь нажимает клавишу ВВОД, не введя никакой строки, приложение завершает свою работу и окно консоли закрывается.

1. При необходимости можно изменить режим на панели инструментов, чтобы скомпилировать **отладочную** версию проекта `ShowCase`. Скомпилируйте и запустите программу, нажав зеленую стрелку на кнопке **ShowCase**.

   ![Режим отладки на панели инструментов (Visual Basic)](./media/consuming-library-with-visual-studio/visual-studio-project-toolbar.png)

---

Чтобы отладить и опубликовать приложение, которое использует эту библиотеку, выполните действия из статей [Отладка приложения Hello World в Visual Studio 2017](debugging-with-visual-studio.md) и [Публикация приложения Hello World в Visual Studio 2017](publishing-with-visual-studio.md).

## <a name="distributing-the-library-in-a-nuget-package"></a>Распространение библиотеки в виде пакета NuGet

Библиотеку классов можно распространить и для других разработчиков, опубликовав ее в виде пакета NuGet. Visual Studio не поддерживает создание пакетов NuGet. Для создания пакета используйте [служебную программу командной строки](../tools/dotnet.md) `dotnet` следующим образом:

1. Откройте окно консоли. Например, в текстовом поле **Задайте любой вопрос** на панели задач Windows введите `Command Prompt` (или `cmd` для краткости), а затем откройте окно консоли с помощью приложения **командной строки** или клавиши ВВОД, если оно выделено в результатах поиска.

1. Перейдите в каталог с проектом библиотеки. Если вы не меняли расположение файлов, проект размещается в каталоге *Documents\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary*. Этот каталог содержит исходный код и файл проекта (*StringLibrary.csproj*).

1. Выполните команду `dotnet pack --no-build`. Служебная программа `dotnet` создаст пакет с расширением *.nupkg*.

   > [!TIP]
   > Если каталог, содержащий *dotnet.exe*, не находится в системном пути, найдите расположение этого файла, введя `where dotnet.exe` в окне консоли.

Дополнительные сведения о создании пакетов NuGet см. в статье [How to Create a NuGet Package with Cross Platform Tools](../deploying/creating-nuget-packages.md) (Создание пакета NuGet с помощью кроссплатформенных средств).
