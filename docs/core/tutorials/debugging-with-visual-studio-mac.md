---
title: Отладка консольного приложения .NET с помощью Visual Studio для Mac
description: Узнайте, как выполнить отладку консольного приложения .NET с помощью Visual Studio для Mac.
ms.date: 11/30/2020
ms.openlocfilehash: e35bbef5582b6eec00ee48669a0f5d028eb051fb
ms.sourcegitcommit: 9d525bb8109216ca1dc9e39c149d4902f4b43da5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2020
ms.locfileid: "96599620"
---
# <a name="tutorial-debug-a-net-console-application-using-visual-studio-for-mac"></a>Учебник. Отладка консольного приложения .NET с помощью Visual Studio для Mac

В этом учебнике представлены средства отладки, доступные в Visual Studio для Mac.

## <a name="prerequisites"></a>Предварительные требования

- В этом руководстве используется консольное приложение, созданное по инструкциям из статьи [Создание консольного приложения .NET с помощью Visual Studio для Mac](with-visual-studio-mac.md).

## <a name="use-debug-build-configuration"></a>Использование конфигурации отладочной сборки

В Visual Studio используются две встроенные конфигурации сборки — *Отладка* и *Выпуск*. Вы воспользуетесь отладочной конфигурацией сборки для отладки и конфигурацией для выпуска для окончательного выпуска программы.

В отладочной конфигурации программы компилируется с полной символической отладочной информацией и без оптимизации. Оптимизация усложняет отладку, поскольку усложняется связь между исходным кодом и сгенерированными инструкциями. Конфигурация для выпуска полностью оптимизирована и не содержит символической отладочной информации.

По умолчанию Visual Studio для Mac использует отладочную конфигурацию сборки, поэтому ее не нужно изменять перед отладкой.

1. Запустите Visual Studio для Mac.

1. Откройте проект, созданный по инструкциям из статьи [Создание консольного приложения .NET с помощью Visual Studio для Mac](with-visual-studio-mac.md).

   Используемая конфигурация сборки отображается на панели инструментов. На следующем изображении панели инструментов показано, что служба Visual Studio настроена для компиляции отладочной версии приложения:

   :::image type="content" source="media/debugging-with-visual-studio-mac/visual-studio-toolbar-debug.png" alt-text="Панель инструментов Visual Studio с выделенным режимом отладки":::

## <a name="set-a-breakpoint"></a>Установка точки останова

*Точка останова* приостанавливает выполнение приложения на инструкции, предшествующей той строке, в которой установлена точка останова.

1. Установите точку останова в строке, где отображается имя, дата и время. Для этого поместите курсор в строку кода и нажмите клавиши <kbd>⌘</kbd><kbd>\\</kbd> (<kbd>Command</kbd>+<kbd>\\</kbd>). Другой способ добавить точку останова — выбрать в меню **Выполнить** > **Перейти к следующей точке останова**.

   Подсветка текста и красная точка в левом поле обозначает строку с точкой останова Visual Studio.

   :::image type="content" source="media/debugging-with-visual-studio-mac/set-breakpoint-in-editor.png" alt-text="Окно приложения Visual Studio с установленной точкой останова":::

1. Чтобы запустить программу в режиме отладки, нажмите клавиши <kbd>⌘</kbd><kbd>↵</kbd> (<kbd>Command</kbd>+<kbd>ВВОД</kbd>). Еще один способ запуска отладки — выбрать в меню параметры **Запуск** > **Начать отладку**.

1. Когда программа запросит имя, введите любую строку в окне терминала и нажмите клавишу <kbd>ВВОД</kbd>.

1. Выполнение программы остановится, когда будет достигнута точка останова, то есть перед выполнением метода `Console.WriteLine`.

   :::image type="content" source="media/debugging-with-visual-studio-mac/breakpoint-hit.png" alt-text="Снимок экрана с точкой останова в Visual Studio":::

## <a name="use-the-immediate-window"></a>Использование окна "Интерпретация"

Окно **Интерпретация** позволяет взаимодействовать с приложением, которое вы отлаживаете. Вы можете интерактивно изменить значения переменных и посмотреть, как это повлияет на работу программы.

1. Если окно **Интерпретация** не отображается, откройте его, выбрав **Вид** > **Панели отладки** > **Интерпретация**.

1. Введите `name = "Gracie"` в окне **Интерпретация** и нажмите клавишу <kbd>ВВОД</kbd>.

1. Введите `date = date.AddDays(1)` в окне **Интерпретация** и нажмите клавишу <kbd>ВВОД</kbd>.

   В окне **Интерпретация** отображается новое значение переменной строки и свойства значения <xref:System.DateTime>.

   :::image type="content" source="media/debugging-with-visual-studio-mac/immediate-window.png" alt-text="Окно Интерпретация в Visual Studio":::

   В окне **Локальные** отображаются значения переменных, которые определены в текущем выполняемом методе. Значения переменных, которые вы только что изменили, обновляются в окне **Локальные**.

   :::image type="content" source="media/debugging-with-visual-studio-mac/locals-window.png" alt-text="Окно Локальные в Visual Studio":::

1. Чтобы продолжить отладку, нажмите клавиши <kbd>⌘</kbd><kbd>↵</kbd> (<kbd>Command</kbd>+<kbd>ВВОД</kbd>).

   Значения, отображаемые в терминале, соответствуют изменениям, произведенным в окне **Интерпретация**.

   Если окно терминала не отображается, выберите **Terminal - HelloWorld** (Терминал — HelloWorld) в нижней панели навигации.

   :::image type="content" source="media/debugging-with-visual-studio-mac/terminal-hello-world.png" alt-text="Terminal - Hello World (Терминал — Hello World) в нижней панели навигации":::

1. Нажмите любую клавишу для выхода из программы.

1. Закройте окно терминала.

## <a name="set-a-conditional-breakpoint"></a>Установка условной точки останова

Программа отображает строку, которую вводит пользователь. Что произойдет, если пользователь ничего не введет? Это можно проверить с помощью полезной функции отладки, которая называется *условной точкой останова*.

1. Удерживая нажатой клавишу <kbd>CTRL</kbd>, щелкните красную точку, представляющую точку останова. В контекстном меню выберите **Изменить точку останова**.

1. В диалоговом окне **Изменить точку останова** введите код в поле, следующее за полем **И выполняется следующее условие** и выберите **Применить**.

   ```csharp
   String.IsNullOrEmpty(name)
   ```

   :::image type="content" source="media/debugging-with-visual-studio-mac/breakpoint-settings.png" alt-text="Редактор параметров точки останова":::

   При каждом достижении точки останова отладчик вызывает метод `String.IsNullOrEmpty(name)` и останавливается на этой строке только в том случае, если вызов метода возвращает `true`.

   Вместо условного выражения можно указать *количество обращений* (выполнение программы будет прервано, пока инструкция не будет выполнена указанное количество раз).

1. Чтобы начать отладку, нажмите клавиши <kbd>⌘</kbd><kbd>↵</kbd> (<kbd>Command</kbd>+<kbd>ВВОД</kbd>).

1. Когда в окне терминала появится предложение ввести имя, нажмите клавишу <kbd>ВВОД</kbd>.

   Так как указанное вами условие соблюдается (`name` имеет значение `null` или <xref:System.String.Empty?displayProperty=nameWithType>), выполнение программы будет остановлено при достижении точки останова.

1. Выберите окно **Локальные**, в котором отображаются значения локальных переменных для текущего выполняемого метода. В нашем примере этим методом является `Main`. Обратите внимание, что переменная `name` имеет значение `""`, то есть <xref:System.String.Empty?displayProperty=nameWithType>.

1. Можно также увидеть, что переменная содержит пустую строку, введя имя переменной `name` в окне **Интерпретация** и нажав клавишу <kbd>ВВОД</kbd>.

   :::image type="content" source="media/debugging-with-visual-studio-mac/immediate-window-output.png" alt-text="Окно интерпретации, отображающее имя, которое является пустой строкой":::

1. Чтобы продолжить отладку, нажмите клавиши <kbd>⌘</kbd><kbd>↵</kbd> (<kbd>Command</kbd>+<kbd>ВВОД</kbd>).

1. В окне терминала нажмите любую клавишу, чтобы выйти из программы.

1. Закройте окно терминала.

1. Очистите точку останова. Для этого щелкните красную точку в левом поле окна с кодом. Или выберите **Выполнить > Перейти к следующей точке останова** при выбранной строке кода.

## <a name="step-through-a-program"></a>Пошаговое выполнение программы

Visual Studio позволяет выполнять программу пошагово, отслеживая результат ее выполнения. Для этого обычно задают точку останова и запускают программу в небольшой части ее кода. Поскольку наша программа невелика, давайте выполним ее пошагово.

1. Установите точку останова на фигурной скобке, обозначающей начало метода `Main` (нажмите клавишу <kbd>Command</kbd>+<kbd>\\</kbd>).

1. Чтобы начать отладку, нажмите клавиши <kbd>⌘</kbd><kbd>↵</kbd> (<kbd>Command</kbd>+<kbd>ВВОД</kbd>).

   Visual Studio останавливается в строке с точкой останова.

1. Нажмите клавиши <kbd>⇧</kbd><kbd>⌘</kbd><kbd>I</kbd> (<kbd>SHIFT</kbd>+<kbd>Command</kbd>+<kbd>I</kbd>) или выберите **Выполнить** > **Шаг с заходом**, чтобы перейти на следующую строку.

   Следующая выполняемая строка будет выделена, и рядом с ней появится стрелка.

   :::image type="content" source="media/debugging-with-visual-studio-mac/step-into-method.png" alt-text="Метод выполнения по шагам в Visual Studio":::

   На этом этапе в окне **Локальные** показано, что массив `args` пуст, а `name` и `date` имеют значения по умолчанию. Кроме того, в Visual Studio открылся пустой терминал.

1. Нажмите клавиши <kbd>⇧</kbd><kbd>⌘</kbd><kbd>I</kbd> (<kbd>SHIFT</kbd>+<kbd>Command</kbd>+<kbd>I</kbd>).

   Visual Studio подсвечивает инструкцию, которая содержит присваивание значения переменной `name`. В окне **Локальные** отображается, что `name` имеет значение `null`, а в терминале появилась строка "What is your name?" (Введите имя:).

1. Ответьте на этот запрос, введя строку в окно консоли и нажав клавишу <kbd>ВВОД</kbd>.

1. Нажмите клавиши <kbd>⇧</kbd><kbd>⌘</kbd><kbd>I</kbd> (<kbd>SHIFT</kbd>+<kbd>Command</kbd>+<kbd>I</kbd>).

   Visual Studio подсвечивает инструкцию, которая содержит присваивание значения переменной `date`. В окне **Локальные** отображается значение, полученное в результате вызова метода <xref:System.Console.ReadLine%2A?displayProperty=nameWithType>. В терминале также отображается строка, указанная в командной строке.

1. Нажмите клавиши <kbd>⇧</kbd><kbd>⌘</kbd><kbd>I</kbd> (<kbd>SHIFT</kbd>+<kbd>Command</kbd>+<kbd>I</kbd>).

   В окне **Локальные** отображается значение переменной `date`, которому было присвоено свойство <xref:System.DateTime.Now?displayProperty=nameWithType>. Терминал остается без изменений.

1. Нажмите клавиши <kbd>⇧</kbd><kbd>⌘</kbd><kbd>I</kbd> (<kbd>SHIFT</kbd>+<kbd>Command</kbd>+<kbd>I</kbd>).

   Visual Studio вызывает метод <xref:System.Console.WriteLine(System.String,System.Object,System.Object)?displayProperty=nameWithType>. В терминале отображается форматированная строка.

1. Нажмите клавиши <kbd>⇧</kbd><kbd>⌘</kbd><kbd>U</kbd> (<kbd>SHIFT</kbd>+<kbd>Command</kbd>+<kbd>U</kbd>) или выберите **Выполнить** > **Шаг с выходом**.

   В терминале отображается сообщение с предложением нажать любую клавишу для выхода.

1. Нажмите любую клавишу для выхода из программы.

## <a name="use-release-build-configuration"></a>Использование конфигурации сборки для выпуска

После тестирования отладочной версии приложения следует скомпилировать и протестировать версию в режиме выпуска. При сборке в режиме выпуска компилятор использует методы оптимизации, которые могут негативно повлиять на поведение приложения. Например, оптимизации компилятора для повышения производительности могут привести к состоянию конкуренции в многопоточных приложениях.

Чтобы создать и протестировать окончательную версию консольного приложения, сделайте следующее:

1. Измените конфигурацию сборки на панели инструментов, указав конфигурацию **Выпуск** вместо конфигурации **Отладка**.

   :::image type="content" source="media/debugging-with-visual-studio-mac/visual-studio-toolbar-release.png" alt-text="Панель инструментов Visual Studio по умолчанию с выделенным режимом отладки":::

1. Чтобы запустить без отладки, нажмите клавиши <kbd>⌥</kbd><kbd>⌘</kbd><kbd>↵</kbd> (<kbd>Option</kbd>+<kbd>Command</kbd>+<kbd>ВВОД</kbd>).

## <a name="next-steps"></a>Следующие шаги

В этом руководстве вы использовали средства отладки Visual Studio. В следующем руководстве вы опубликуете развертываемую версию приложения.

> [!div class="nextstepaction"]
> [Публикация консольного приложения .NET с помощью Visual Studio для Mac](publishing-with-visual-studio-mac.md)
