---
title: Создание библиотеки классов .NET с помощью Visual Studio
description: Сведения о создании библиотеки классов .NET с помощью Visual Studio.
ms.date: 08/07/2020
dev_langs:
- csharp
- vb
ms.custom: vs-dotnet,contperf-fy21q1
ms.openlocfilehash: 2d9b02a155c950b77565a66417948568f5fa039f
ms.sourcegitcommit: d0990c1c1ab2f81908360f47eafa8db9aa165137
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/15/2020
ms.locfileid: "97513124"
---
# <a name="tutorial-create-a-net-class-library-using-visual-studio"></a>Учебник. Создание библиотеки классов .NET с помощью Visual Studio

В этом учебнике вы создадите простую библиотеку классов с одним методом для обработки строк.

*Библиотека классов* определяет типы и методы, которые могут быть вызваны из любого приложения. Если библиотека предназначена для .NET Standard 2.0, она может быть вызвана любой реализацией .NET (включая .NET Framework), которая поддерживает .NET Standard 2.0. Если библиотека предназначена для .NET 5, ее можно вызвать с помощью любого приложения, предназначенного для .NET 5. В этом учебнике показано, как ориентироваться на .NET 5.

Когда вы завершите создание библиотеки классов, можете распространить ее как пакет NuGet или включить как компонент в состав приложения, в котором она используется.

## <a name="prerequisites"></a>Предварительные условия

- [Visual Studio 2019 версии 16.8 или более поздней](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019) с установленной рабочей нагрузкой **Кроссплатформенная разработка .NET Core**. Пакет SDK для .NET 5.0 устанавливается автоматически при выборе этой рабочей нагрузки. В этом учебнике предполагается, что вы включили параметр **Показать все шаблоны .NET Core в новом проекте**, как показано в статье [Учебник. Создание консольного приложения .NET в Visual Studio](with-visual-studio.md).

## <a name="create-a-solution"></a>Создание решения

Начните с создания пустого решения для размещения проекта библиотеки классов. Решение Visual Studio служит контейнером для одного или нескольких проектов. Вы будете добавлять дополнительные связанные проекты в одно решение.

Чтобы создать пустое решение, сделайте следующее:

1. Запустите Visual Studio.

2. На начальном экране выберите **Создать проект**.

3. В поле поиска на странице **Создание проекта** введите **решение**. Выберите шаблон **Пустое решение** и нажмите кнопку **Далее**.

   :::image type="content" source="media/library-with-visual-studio/blank-solution.png" alt-text="Шаблон пустого решения в Visual Studio":::

4. На странице **настройки нового проекта** введите **ClassLibraryProjects** в поле **Имя проекта**. Затем нажмите кнопку **Создать**.

## <a name="create-a-class-library-project"></a>Создание проекта библиотеки классов

1. Добавьте в решение новый проект библиотеки классов .NET с именем "StringLibrary".

   1. Щелкните решение в **обозревателе решений** правой кнопкой мыши и выберите **Добавить** > **Новый проект**.

   1. На странице **добавления нового проекта** введите в поле поиска **библиотека**. Выберите **C#** или **Visual Basic** из списка языков, а затем — **Все платформы** из списка платформ. Выберите шаблон **Библиотека классов**, а затем нажмите кнопку **Далее**.

   1. На странице **настройки нового проекта** введите **StringLibrary** в поле **Имя проекта**, а затем нажмите **Далее**.

   1. На странице **Дополнительные сведения** выберите **.NET 5.0 (текущая)** , а затем нажмите **Создать**.

1. Проверьте, предназначена ли библиотека для правильной версии .NET. В **обозревателе решений** щелкните проект библиотеки правой кнопкой мыши и выберите пункт **Свойства**. В текстовом поле **Целевая платформа** указано, что целевой платформой проекта является .NET 5.0.

1. Если вы используете Visual Basic, удалите текст в поле **Корневое пространство имен**.

   :::image type="content" source="./media/library-with-visual-studio/vb/library-project-properties.png" alt-text="Свойства проекта для библиотеки классов":::

   Для каждого проекта Visual Basic автоматически создает пространство имен, соответствующее имени проекта. В этом учебнике вы определите пространство имен верхнего уровня с помощью ключевого слова [`namespace`](../../visual-basic/language-reference/statements/namespace-statement.md) в файле кода.

1. Замените код, отображаемый в окне кода, для *Class1.cs* или *Class1.vb* следующим текстом, а затем сохраните файл. Если нужный язык не отображается, измените выбор языка в верхней части страницы.

   :::code language="csharp" source="./snippets/library-with-visual-studio/csharp/StringLibrary/Class1.cs":::
   :::code language="vb" source="./snippets/library-with-visual-studio/vb/StringLibrary/Class1.vb":::

   Библиотека классов `UtilityLibraries.StringLibrary` содержит метод `StartsWithUpper`, который возвращает значение <xref:System.Boolean>, указывающее, является ли первым символом текущего экземпляра строки символ верхнего регистра. Символы верхнего регистра определяются по стандарту Юникод. Метод <xref:System.Char.IsUpper(System.Char)?displayProperty=nameWithType> возвращает `true`, если символ является символом верхнего регистра.

   Метод `StartsWithUpper` реализуется как [метод расширения](../../csharp/programming-guide/classes-and-structs/extension-methods.md), чтобы вызывать его можно было так же, как любой член класса <xref:System.String>.

1. В строке меню выберите **Сборка** > **Собрать решение** или нажмите клавиши <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>B</kbd>, чтобы убедиться, что проект компилируется без ошибок.

## <a name="add-a-console-app-to-the-solution"></a>Добавление консольного приложения в решение

Добавьте консольное приложение, использующее библиотеку классов. В приложении пользователю будет предложено ввести строку и сообщить, начинается ли строка с символа верхнего регистра.

1. Добавьте к решению новое консольное приложение .NET под названием "Демонстрация".

   1. Щелкните решение в **Обозревателе решений** правой кнопкой мыши и выберите **Добавить** > **Новый проект**.

   1. На странице **Добавить новый проект** введите в поле поиска **консоль**. Выберите **C#** или **Visual Basic** из списка языков, а затем — **Все платформы** из списка платформ.

   1. Выберите шаблон **Консольное приложение** и нажмите **Далее**.

   1. На странице **Настроить новый проект** введите **Демонстрация** в поле **Имя проекта**. Нажмите кнопку **Далее**.

   1. На странице **Дополнительные сведения** выберите **.NET 5.0 (текущая)** в поле **Целевая платформа**. Затем нажмите кнопку **Создать**.

1. В окне кода замените весь код файла *Program.cs* или *Program.vb* следующим текстом.

   :::code language="csharp" source="./snippets/library-with-visual-studio/csharp/ShowCase/Program.cs":::
   :::code language="vb" source="./snippets/library-with-visual-studio/vb/ShowCase/Program.vb":::

   В этом коде используется переменная `row` для сохранения количества строк данных, записываемых в окно консоли. Всякий раз, когда оно достигает значения 25 или превышает его, код очищает окно консоли и отображается сообщение для пользователя.

   Сама программа предлагает пользователю ввести строку. Она сообщает, начинается ли строка с символа верхнего регистра. Если пользователь нажимает клавишу <kbd>ВВОД</kbd>, не введя никакой строки, приложение завершает свою работу и окно консоли закрывается.

## <a name="add-a-project-reference"></a>Добавление ссылки на проект

Изначально новый проект консольного приложения не имеет доступа к библиотеке классов. Чтобы позволить приложению вызывать методы из библиотеки классов, создайте в проекте ссылку на проект библиотеки классов.

1. В **обозревателе решений** щелкните правой кнопкой мыши узел **Зависимости** проекта `ShowCase` и выберите команду **Добавить ссылку на проект**.

   :::image type="content" source="media/library-with-visual-studio/add-reference-context-menu.png" alt-text="Контекстное меню с пунктом &quot;Добавить ссылку&quot; в Visual Studio":::

1. В диалоговом окне **Диспетчер ссылок** выберите проект **StringLibrary**, а затем нажмите кнопку **ОК**.

   :::image type="content" source="media/library-with-visual-studio/manage-project-references.png" alt-text="Диалоговое окно &quot;Диспетчер ссылок&quot; с выбранной StringLibrary":::

## <a name="run-the-app"></a>Запуск приложения

1. В окне **Обозреватель решений** щелкните правой кнопкой мыши проект **ShowCase** и выберите команду **Назначить запускаемым проектом**.

   :::image type="content" source="media/library-with-visual-studio/set-startup-project-context-menu.png" alt-text="Контекстное меню проекта с пунктом &quot;Назначить запускаемым проектом&quot; в Visual Studio":::

1. Нажмите клавиши <kbd>CTRL</kbd>+<kbd>F5</kbd>, чтобы скомпилировать и запустить программу без отладки.

   :::image type="content" source="media/library-with-visual-studio/visual-studio-project-toolbar.png" alt-text="Панель инструментов проекта в Visual Studio c кнопкой отладки":::

1. Проверьте, как работает программа: вводите строки и нажимайте клавишу <kbd>ВВОД</kbd>. Чтобы выйти, нажмите клавишу <kbd>ВВОД</kbd>.

   :::image type="content" source="media/library-with-visual-studio/run-showcase.png" alt-text="Окно консоли с запущенным демонстрационным проектом ShowCase":::

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Разработка библиотек с помощью .NET CLI](libraries.md)
* [Список версий .NET Standard и поддерживаемых ими платформ](../../standard/net-standard.md)

## <a name="next-steps"></a>Следующие шаги

В этом руководстве вы создали библиотеку классов. В следующем руководстве вы узнаете, как выполнять модульное тестирование библиотеки классов.

> [!div class="nextstepaction"]
> [Модульное тестирование библиотеки классов .NET с помощью Visual Studio](testing-library-with-visual-studio.md)

Вы также можете пропустить автоматическое модульное тестирование и узнать, как можно распространить библиотеку, создав пакет NuGet:

> [!div class="nextstepaction"]
> [Создание и публикация пакета с помощью Visual Studio](/nuget/quickstart/create-and-publish-a-package-using-visual-studio)

Либо узнайте, как опубликовать консольное приложение. При публикации консольного приложения из решения, созданного в этом руководстве, библиотека классов публикуется вместе с ним в виде файла *DLL*.

> [!div class="nextstepaction"]
> [Публикация консольного приложения .NET с помощью Visual Studio](publishing-with-visual-studio.md)
