---
title: Ссылочные ячейки
description: Узнайте, F# как ссылочные ячейки — это места хранения, которые позволяют создавать изменяемые значения с семантикой ссылок.
ms.date: 05/16/2016
ms.openlocfilehash: 2bca7797b272c0e7d5bf54df07041dc08e33709a
ms.sourcegitcommit: 56f1d1203d0075a461a10a301459d3aa452f4f47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2019
ms.locfileid: "71216780"
---
# <a name="reference-cells"></a>Ссылочные ячейки

*Ссылочные ячейки* — это места хранения, которые позволяют создавать изменяемые значения с семантикой ссылок.

## <a name="syntax"></a>Синтаксис

```fsharp
ref expression
```

## <a name="remarks"></a>Примечания

Для создания новой ссылочной ячейки, инкапсулирующей значение, перед значением ставится оператор `ref`. Базовое значение затем можно изменить, так как оно является изменяемым.

Ссылочная ячейка содержит фактическое значение; это не просто адрес. При создании ссылочной ячейки с помощью оператора `ref` создается копия базового значения в качестве инкапсулированного изменяемого значения.

Разыменовать ссылочную ячейку можно с помощью оператора `!` (восклицательного знака).

Следующий пример кода иллюстрирует объявление и использование ссылочных ячеек.

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-1/snippet2201.fs)]

В результате получается `50`.

Ссылочные ячейки являются экземплярами универсального типа записей `Ref`, который объявляется следующим образом.

```fsharp
type Ref<'a> =
{ mutable contents: 'a }
```

Тип `'a ref` является синонимом `Ref<'a>`. В интегрированной среде разработки в компиляторе и в IntelliSense отображается первое обозначение данного типа, однако базовым определением является второе.

Оператор `ref` создает новую ссылочную ячейку. Следующий код представляет собой объявление оператора `ref`.

```fsharp
let ref x = { contents = x }
```

В следующей таблице перечислены возможности, доступные для ссылочной ячейки.

|Оператор, член или поле|Описание|Тип|Определение|
|--------------------------|-----------|----|----------|
|`!` (оператор разыменования)|Возвращает базовое значение.|`'a ref -> 'a`|`let (!) r = r.contents`|
|`:=` (оператор присваивания)|Изменяет базовое значение.|`'a ref -> 'a -> unit`|`let (:=) r x = r.contents <- x`|
|`ref` (оператор)|Инкапсулирует значение в новую ссылочную ячейку.|`'a -> 'a ref`|`let ref x = { contents = x }`|
|`Value` (свойство)|Получает или задает базовое значение.|`unit -> 'a`|`member x.Value = x.contents`|
|`contents` (поле записи)|Получает или задает базовое значение.|`'a`|`let ref x = { contents = x }`|

Существует несколько способов доступа к базовому значению. Значение, возвращаемое оператором разыменования (`!`), не является присваиваемым значением. Следовательно, при изменении базового значения нужно вместо этого оператора использовать оператор присваивания (`:=`).

И свойство `Value`, и поле `contents` являются присваиваемыми значениями. Следовательно, их можно использовать для доступа к базовому значению или его изменения, как показано в следующем коде.

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-1/snippet2203.fs)]

Выходные данные выглядят следующим образом.

```console
10
10
11
12
```

Поле `contents` предусмотрено для совместимости с другими версиями языка ML, и его наличие приводит к выводу предупреждения в процессе компиляции. Для отключения этого предупреждения используется параметр компилятора `--mlcompatibility`. Дополнительные сведения см. в разделе [Параметры компилятора](compiler-options.md).

C#программистам следует помнить `ref` , C# что в не `ref` то же самое, F#что и в. Эквивалентными конструкциями в F# являются [ByRef](byrefs.md), которые являются разными концепциями из ссылочных ячеек.

Значения, помеченные как, `mutable`могут быть автоматически повышены до `'a ref` , если захватывается замыканием; см. [значения](./values/index.md).

## <a name="see-also"></a>См. также

- [Справочник по языку F#](index.md)
- [Параметры и аргументы](parameters-and-arguments.md)
- [Справочник символов и операторов](./symbol-and-operator-reference/index.md)
- [Значения](./values/index.md)
