---
title: Активные шаблоны
description: Узнайте, как использовать активные шаблоны для определять именованные разделы, на которые подразделяются входные данные в F# языка программирования.
ms.date: 05/16/2016
ms.openlocfilehash: 0f1f57de425836738201d2d8f84ab67a0df142ee
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61772756"
---
# <a name="active-patterns"></a>Активные шаблоны

*Активные шаблоны* позволяют определять именованные разделы, которые подразделяются входные данные, таким образом, эти имена можно использовать в выражении шаблона так же, как и для размеченного объединения. Активные шаблоны можно использовать для разложения данных в настраиваемом порядке для каждого раздела.

## <a name="syntax"></a>Синтаксис

```fsharp
// Complete active pattern definition.
let (|identifer1|identifier2|...|) [ arguments ] = expression
// Partial active pattern definition.
let (|identifier|_|) [ arguments ] = expression
```

## <a name="remarks"></a>Примечания

В приведенном выше синтаксисе идентификаторы — это имена разделов входных данных, представленного *аргументы*, или, другими словами, имена подмножеств набора значений всех аргументов. В определении активный шаблон может быть до семи разделов. *Выражение* описывает форму для разложения данных. Определение активный шаблон можно использовать для определения правила определения, какие из именованных секций значения, заданного в качестве аргументы принадлежат. (| И |) символы называются *скобками с вертикальной чертой* и вызывается функция, созданная этим типом привязки let *active распознаватель*.

Например рассмотрим следующий активный шаблон с аргументом.

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet5001.fs)]

Активный шаблон можно использовать в выражении шаблона, как показано в следующем примере.

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet5002.fs)]

Выходные данные этой программы выглядит следующим образом:

```
7 is odd
11 is odd
32 is even
```

Другой активных шаблонов используется для разложения типов данных несколькими способами, например, когда те же базовые данные имеют несколько возможных представлений. Например `Color` объект можно разложить на представления RGB или HSB.

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-2/snippet5003.fs)]

Выходные данные выше программы выглядит следующим образом:

```
Red
 Red: 255 Green: 0 Blue: 0
 Hue: 360.000000 Saturation: 1.000000 Brightness: 0.500000
Black
 Red: 0 Green: 0 Blue: 0
 Hue: 0.000000 Saturation: 0.000000 Brightness: 0.000000
White
 Red: 255 Green: 255 Blue: 255
 Hue: 0.000000 Saturation: 0.000000 Brightness: 1.000000
Gray
 Red: 128 Green: 128 Blue: 128
 Hue: 0.000000 Saturation: 0.000000 Brightness: 0.501961
BlanchedAlmond
 Red: 255 Green: 235 Blue: 205
 Hue: 36.000000 Saturation: 1.000000 Brightness: 0.901961
```

В сочетании эти два способа использования активные шаблоны позволяют создавать секции и разложения данных на нужной форме и выполните соответствующие вычисления на соответствующие данные в форме, наиболее удобным для вычисления.

Результирующее выражения сопоставления шаблонов включают данные будут записываться в удобный способ, который является очень удобным для чтения, упрощая потенциально сложное ветвление и код анализа данных.

## <a name="partial-active-patterns"></a>Частичные активные шаблоны

В некоторых случаях необходимо секционировать только часть пространства входных данных. В этом случае набор частичных шаблонов записи из которых соответствует некоторых входных данных, но не соответствует других входных данных. Активные шаблоны, которые не всегда производят значение называются *частичные активные шаблоны*; они имеют возвращаемое значение, которое имеет тип option. Для определения частичной активный шаблон, можно использовать подстановочный знак (\_) в конце списка шаблонов скобками с вертикальной чертой. Следующий код иллюстрирует использование частичного активного шаблона.

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-2/snippet5004.fs)]

Выходные данные приведенного выше примера выглядит следующим образом:

```
1.100000 : Floating point
0 : Integer
0.000000 : Floating point
10 : Integer
Something else : Not matched.
```

При использовании частичной активные шаблоны, иногда отдельные параметры могут быть несвязанными или взаимно исключают друг друга, но не обязательно. В следующем примере шаблон квадрата и куба шаблон связаны между собой, так как некоторые числа квадраты и кубов, например 64. Следующая программа использует шаблона для объединения шаблоны квадрата и куба. Распечатать все целые числа до 1000, как квадраты и кубы, а также те, которые только в кубах. 

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-2/snippet5005.fs)]

Выходные данные выглядят следующим образом:

```
1 is a cube and a square
8 is a cube
27 is a cube
64 is a cube and a square
125 is a cube
216 is a cube
343 is a cube
512 is a cube
729 is a cube and a square
1000 is a cube
```

## <a name="parameterized-active-patterns"></a>Параметризованные активные шаблоны

Активные шаблоны всегда имеют по крайней мере один аргумент для сопоставляемого элемента, но могут стать дополнительные аргументы, в этом случае имя *параметризованный активный шаблон* применяется. Дополнительные аргументы позволяют общий шаблон, который специализации. Например, активные шаблоны, которые используют регулярные выражения для анализа строк, часто включают регулярное выражение в качестве дополнительного параметра, как в следующем коде, который также использует частичного активный шаблон `Integer` определенный в предыдущем примере кода. В этом примере строки, которые используют регулярные выражения для различных форматов даты, предоставленные настроить общий активный шаблон ParseRegex. Активный шаблон целое число используется для преобразования соответствующие строки в целые числа, которые могут быть переданы в конструктор даты и времени.

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-2/snippet5006.fs)]

Результат выполнения предыдущего кода выглядит следующим образом:

```
12/22/2008 12:00:00 AM 1/1/2009 12:00:00 AM 1/15/2008 12:00:00 AM 12/28/1995 12:00:00 AM
```

Активные шаблоны не ограничиваются только выражения сопоставления шаблонов, их также можно использовать в привязках let.

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-2/snippet5007.fs)]

Результат выполнения предыдущего кода выглядит следующим образом:

```
Hello, random citizen!
Hello, George!
```

## <a name="see-also"></a>См. также

- [Справочник по языку F#](index.md)
- [Выражения match](match-expressions.md)
